/*! For license information please see main.699a9d22.js.LICENSE.txt */
(()=>{var e={695:e=>{function t(e,t,n){var i,r,s,o,a;function l(){var c=Date.now()-o;c<t&&c>=0?i=setTimeout(l,t-c):(i=null,n||(a=e.apply(s,r),s=r=null))}null==t&&(t=100);var c=function(){s=this,r=arguments,o=Date.now();var c=n&&!i;return i||(i=setTimeout(l,t)),c&&(a=e.apply(s,r),s=r=null),a};return c.clear=function(){i&&(clearTimeout(i),i=null)},c.flush=function(){i&&(a=e.apply(s,r),s=r=null,clearTimeout(i),i=null)},c}t.debounce=t,e.exports=t},403:e=>{var t=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=/\n/g,i=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,s=/^:\s*/,o=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,a=/^[;\s]*/,l=/^\s+|\s+$/g,c="";function g(e){return e?e.replace(l,c):c}e.exports=function(e,l){if("string"!==typeof e)throw new TypeError("First argument must be a string");if(!e)return[];l=l||{};var u=1,A=1;function d(e){var t=e.match(n);t&&(u+=t.length);var i=e.lastIndexOf("\n");A=~i?e.length-i:A+e.length}function h(){var e={line:u,column:A};return function(t){return t.position=new I(e),f(),t}}function I(e){this.start=e,this.end={line:u,column:A},this.source=l.source}I.prototype.content=e;var p=[];function C(t){var n=new Error(l.source+":"+u+":"+A+": "+t);if(n.reason=t,n.filename=l.source,n.line=u,n.column=A,n.source=e,!l.silent)throw n;p.push(n)}function m(t){var n=t.exec(e);if(n){var i=n[0];return d(i),e=e.slice(i.length),n}}function f(){m(i)}function y(e){var t;for(e=e||[];t=b();)!1!==t&&e.push(t);return e}function b(){var t=h();if("/"==e.charAt(0)&&"*"==e.charAt(1)){for(var n=2;c!=e.charAt(n)&&("*"!=e.charAt(n)||"/"!=e.charAt(n+1));)++n;if(n+=2,c===e.charAt(n-1))return C("End of comment missing");var i=e.slice(2,n-2);return A+=2,d(i),e=e.slice(n),A+=2,t({type:"comment",comment:i})}}function B(){var e=h(),n=m(r);if(n){if(b(),!m(s))return C("property missing ':'");var i=m(o),l=e({type:"declaration",property:g(n[0].replace(t,c)),value:i?g(i[0].replace(t,c)):c});return m(a),l}}return f(),function(){var e,t=[];for(y(t);e=B();)!1!==e&&(t.push(e),y(t));return t}()}},840:(e,t,n)=>{var i,r,s,o,a,l=n(166).default;e.exports=function(){var e=function(){"use strict";var t=Object.create,n=Object.defineProperty,c=Object.getOwnPropertyDescriptor,g=Object.getOwnPropertyNames,u=Object.getPrototypeOf,A=Object.prototype.hasOwnProperty,d=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),h=(e,t)=>{for(var i in t)n(e,i,{get:t[i],enumerable:!0})},I=(e,t,i,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let s of g(t))!A.call(e,s)&&s!==i&&n(e,s,{get:()=>t[s],enumerable:!(r=c(t,s))||r.enumerable});return e},p=(e,i,r)=>(r=null!=e?t(u(e)):{},I(!i&&e&&e.__esModule?r:n(r,"default",{value:e,enumerable:!0}),e)),C=e=>I(n({},"__esModule",{value:!0}),e),m=d((t=>{function n(e,t){if(null==e)return{};var n,i,r={},s=Object.keys(e);for(i=0;i<s.length;i++)n=s[i],!(t.indexOf(n)>=0)&&(r[n]=e[n]);return r}Object.defineProperty(t,"__esModule",{value:!0});var c=class{constructor(e,t,n){this.line=void 0,this.column=void 0,this.index=void 0,this.line=e,this.column=t,this.index=n}},g=class{constructor(e,t){this.start=void 0,this.end=void 0,this.filename=void 0,this.identifierName=void 0,this.start=e,this.end=t}};function u(e,t){let{line:n,column:i,index:r}=e;return new c(n,i+t,r+t)}var A="BABEL_PARSER_SOURCETYPE_MODULE_REQUIRED",d={ImportMetaOutsideModule:{message:"import.meta may appear only with 'sourceType: \"module\"'",code:A},ImportOutsideModule:{message:"'import' and 'export' may appear only with 'sourceType: \"module\"'",code:A}},h={ArrayPattern:"array destructuring pattern",AssignmentExpression:"assignment expression",AssignmentPattern:"assignment expression",ArrowFunctionExpression:"arrow function expression",ConditionalExpression:"conditional expression",CatchClause:"catch clause",ForOfStatement:"for-of statement",ForInStatement:"for-in statement",ForStatement:"for-loop",FormalParameters:"function parameter list",Identifier:"identifier",ImportSpecifier:"import specifier",ImportDefaultSpecifier:"import default specifier",ImportNamespaceSpecifier:"import namespace specifier",ObjectPattern:"object destructuring pattern",ParenthesizedExpression:"parenthesized expression",RestElement:"rest element",UpdateExpression:{true:"prefix operation",false:"postfix operation"},VariableDeclarator:"variable declaration",YieldExpression:"yield expression"},I=e=>"UpdateExpression"===e.type?h.UpdateExpression["".concat(e.prefix)]:h[e.type],p={AccessorIsGenerator:e=>{let{kind:t}=e;return"A ".concat(t,"ter cannot be a generator.")},ArgumentsInClass:"'arguments' is only allowed in functions and class methods.",AsyncFunctionInSingleStatementContext:"Async functions can only be declared at the top level or inside a block.",AwaitBindingIdentifier:"Can not use 'await' as identifier inside an async function.",AwaitBindingIdentifierInStaticBlock:"Can not use 'await' as identifier inside a static block.",AwaitExpressionFormalParameter:"'await' is not allowed in async function parameters.",AwaitUsingNotInAsyncContext:"'await using' is only allowed within async functions and at the top levels of modules.",AwaitNotInAsyncContext:"'await' is only allowed within async functions and at the top levels of modules.",AwaitNotInAsyncFunction:"'await' is only allowed within async functions.",BadGetterArity:"A 'get' accessor must not have any formal parameters.",BadSetterArity:"A 'set' accessor must have exactly one formal parameter.",BadSetterRestParameter:"A 'set' accessor function argument must not be a rest parameter.",ConstructorClassField:"Classes may not have a field named 'constructor'.",ConstructorClassPrivateField:"Classes may not have a private field named '#constructor'.",ConstructorIsAccessor:"Class constructor may not be an accessor.",ConstructorIsAsync:"Constructor can't be an async function.",ConstructorIsGenerator:"Constructor can't be a generator.",DeclarationMissingInitializer:e=>{let{kind:t}=e;return"Missing initializer in ".concat(t," declaration.")},DecoratorArgumentsOutsideParentheses:"Decorator arguments must be moved inside parentheses: use '@(decorator(args))' instead of '@(decorator)(args)'.",DecoratorBeforeExport:"Decorators must be placed *before* the 'export' keyword. Remove the 'decoratorsBeforeExport: true' option to use the 'export @decorator class {}' syntax.",DecoratorsBeforeAfterExport:"Decorators can be placed *either* before or after the 'export' keyword, but not in both locations at the same time.",DecoratorConstructor:"Decorators can't be used with a constructor. Did you mean '@dec class { ... }'?",DecoratorExportClass:"Decorators must be placed *after* the 'export' keyword. Remove the 'decoratorsBeforeExport: false' option to use the '@decorator export class {}' syntax.",DecoratorSemicolon:"Decorators must not be followed by a semicolon.",DecoratorStaticBlock:"Decorators can't be used with a static block.",DeferImportRequiresNamespace:'Only `import defer * as x from "./module"` is valid.',DeletePrivateField:"Deleting a private field is not allowed.",DestructureNamedImport:"ES2015 named imports do not destructure. Use another statement for destructuring after the import.",DuplicateConstructor:"Duplicate constructor in the same class.",DuplicateDefaultExport:"Only one default export allowed per module.",DuplicateExport:e=>{let{exportName:t}=e;return"`".concat(t,"` has already been exported. Exported identifiers must be unique.")},DuplicateProto:"Redefinition of __proto__ property.",DuplicateRegExpFlags:"Duplicate regular expression flag.",DynamicImportPhaseRequiresImportExpressions:e=>{let{phase:t}=e;return"'import.".concat(t,"(...)' can only be parsed when using the 'createImportExpressions' option.")},ElementAfterRest:"Rest element must be last element.",EscapedCharNotAnIdentifier:"Invalid Unicode escape.",ExportBindingIsString:e=>{let{localName:t,exportName:n}=e;return"A string literal cannot be used as an exported binding without `from`.\n- Did you mean `export { '".concat(t,"' as '").concat(n,"' } from 'some-module'`?")},ExportDefaultFromAsIdentifier:"'from' is not allowed as an identifier after 'export default'.",ForInOfLoopInitializer:e=>{let{type:t}=e;return"'".concat("ForInStatement"===t?"for-in":"for-of","' loop variable declaration may not have an initializer.")},ForInUsing:"For-in loop may not start with 'using' declaration.",ForOfAsync:"The left-hand side of a for-of loop may not be 'async'.",ForOfLet:"The left-hand side of a for-of loop may not start with 'let'.",GeneratorInSingleStatementContext:"Generators can only be declared at the top level or inside a block.",IllegalBreakContinue:e=>{let{type:t}=e;return"Unsyntactic ".concat("BreakStatement"===t?"break":"continue",".")},IllegalLanguageModeDirective:"Illegal 'use strict' directive in function with non-simple parameter list.",IllegalReturn:"'return' outside of function.",ImportAttributesUseAssert:"The `assert` keyword in import attributes is deprecated and it has been replaced by the `with` keyword. You can enable the `deprecatedAssertSyntax: true` option in the import attributes plugin to suppress this error.",ImportBindingIsString:e=>{let{importName:t}=e;return'A string literal cannot be used as an imported binding.\n- Did you mean `import { "'.concat(t,'" as foo }`?')},ImportCallArgumentTrailingComma:"Trailing comma is disallowed inside import(...) arguments.",ImportCallArity:e=>{let{maxArgumentCount:t}=e;return"`import()` requires exactly ".concat(1===t?"one argument":"one or two arguments",".")},ImportCallNotNewExpression:"Cannot use new with import(...).",ImportCallSpreadArgument:"`...` is not allowed in `import()`.",ImportJSONBindingNotDefault:"A JSON module can only be imported with `default`.",ImportReflectionHasAssertion:"`import module x` cannot have assertions.",ImportReflectionNotBinding:'Only `import module x from "./module"` is valid.',IncompatibleRegExpUVFlags:"The 'u' and 'v' regular expression flags cannot be enabled at the same time.",InvalidBigIntLiteral:"Invalid BigIntLiteral.",InvalidCodePoint:"Code point out of bounds.",InvalidCoverInitializedName:"Invalid shorthand property initializer.",InvalidDecimal:"Invalid decimal.",InvalidDigit:e=>{let{radix:t}=e;return"Expected number in radix ".concat(t,".")},InvalidEscapeSequence:"Bad character escape sequence.",InvalidEscapeSequenceTemplate:"Invalid escape sequence in template.",InvalidEscapedReservedWord:e=>{let{reservedWord:t}=e;return"Escape sequence in keyword ".concat(t,".")},InvalidIdentifier:e=>{let{identifierName:t}=e;return"Invalid identifier ".concat(t,".")},InvalidLhs:e=>{let{ancestor:t}=e;return"Invalid left-hand side in ".concat(I(t),".")},InvalidLhsBinding:e=>{let{ancestor:t}=e;return"Binding invalid left-hand side in ".concat(I(t),".")},InvalidLhsOptionalChaining:e=>{let{ancestor:t}=e;return"Invalid optional chaining in the left-hand side of ".concat(I(t),".")},InvalidNumber:"Invalid number.",InvalidOrMissingExponent:"Floating-point numbers require a valid exponent after the 'e'.",InvalidOrUnexpectedToken:e=>{let{unexpected:t}=e;return"Unexpected character '".concat(t,"'.")},InvalidParenthesizedAssignment:"Invalid parenthesized assignment pattern.",InvalidPrivateFieldResolution:e=>{let{identifierName:t}=e;return"Private name #".concat(t," is not defined.")},InvalidPropertyBindingPattern:"Binding member expression.",InvalidRecordProperty:"Only properties and spread elements are allowed in record definitions.",InvalidRestAssignmentPattern:"Invalid rest operator's argument.",LabelRedeclaration:e=>{let{labelName:t}=e;return"Label '".concat(t,"' is already declared.")},LetInLexicalBinding:"'let' is disallowed as a lexically bound name.",LineTerminatorBeforeArrow:"No line break is allowed before '=>'.",MalformedRegExpFlags:"Invalid regular expression flag.",MissingClassName:"A class name is required.",MissingEqInAssignment:"Only '=' operator can be used for specifying default value.",MissingSemicolon:"Missing semicolon.",MissingPlugin:e=>{let{missingPlugin:t}=e;return"This experimental syntax requires enabling the parser plugin: ".concat(t.map((e=>JSON.stringify(e))).join(", "),".")},MissingOneOfPlugins:e=>{let{missingPlugin:t}=e;return"This experimental syntax requires enabling one of the following parser plugin(s): ".concat(t.map((e=>JSON.stringify(e))).join(", "),".")},MissingUnicodeEscape:"Expecting Unicode escape sequence \\uXXXX.",MixingCoalesceWithLogical:"Nullish coalescing operator(??) requires parens when mixing with logical operators.",ModuleAttributeDifferentFromType:"The only accepted module attribute is `type`.",ModuleAttributeInvalidValue:"Only string literals are allowed as module attribute values.",ModuleAttributesWithDuplicateKeys:e=>{let{key:t}=e;return'Duplicate key "'.concat(t,'" is not allowed in module attributes.')},ModuleExportNameHasLoneSurrogate:e=>{let{surrogateCharCode:t}=e;return"An export name cannot include a lone surrogate, found '\\u".concat(t.toString(16),"'.")},ModuleExportUndefined:e=>{let{localName:t}=e;return"Export '".concat(t,"' is not defined.")},MultipleDefaultsInSwitch:"Multiple default clauses.",NewlineAfterThrow:"Illegal newline after throw.",NoCatchOrFinally:"Missing catch or finally clause.",NumberIdentifier:"Identifier directly after number.",NumericSeparatorInEscapeSequence:"Numeric separators are not allowed inside unicode escape sequences or hex escape sequences.",ObsoleteAwaitStar:"'await*' has been removed from the async functions proposal. Use Promise.all() instead.",OptionalChainingNoNew:"Constructors in/after an Optional Chain are not allowed.",OptionalChainingNoTemplate:"Tagged Template Literals are not allowed in optionalChain.",OverrideOnConstructor:"'override' modifier cannot appear on a constructor declaration.",ParamDupe:"Argument name clash.",PatternHasAccessor:"Object pattern can't contain getter or setter.",PatternHasMethod:"Object pattern can't contain methods.",PrivateInExpectedIn:e=>{let{identifierName:t}=e;return"Private names are only allowed in property accesses (`obj.#".concat(t,"`) or in `in` expressions (`#").concat(t," in obj`).")},PrivateNameRedeclaration:e=>{let{identifierName:t}=e;return"Duplicate private name #".concat(t,".")},RecordExpressionBarIncorrectEndSyntaxType:"Record expressions ending with '|}' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'bar'.",RecordExpressionBarIncorrectStartSyntaxType:"Record expressions starting with '{|' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'bar'.",RecordExpressionHashIncorrectStartSyntaxType:"Record expressions starting with '#{' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'hash'.",RecordNoProto:"'__proto__' is not allowed in Record expressions.",RestTrailingComma:"Unexpected trailing comma after rest element.",SloppyFunction:"In non-strict mode code, functions can only be declared at top level or inside a block.",SloppyFunctionAnnexB:"In non-strict mode code, functions can only be declared at top level, inside a block, or as the body of an if statement.",SourcePhaseImportRequiresDefault:'Only `import source x from "./module"` is valid.',StaticPrototype:"Classes may not have static property named prototype.",SuperNotAllowed:"`super()` is only valid inside a class constructor of a subclass. Maybe a typo in the method name ('constructor') or not extending another class?",SuperPrivateField:"Private fields can't be accessed on super.",TrailingDecorator:"Decorators must be attached to a class element.",TupleExpressionBarIncorrectEndSyntaxType:"Tuple expressions ending with '|]' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'bar'.",TupleExpressionBarIncorrectStartSyntaxType:"Tuple expressions starting with '[|' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'bar'.",TupleExpressionHashIncorrectStartSyntaxType:"Tuple expressions starting with '#[' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'hash'.",UnexpectedArgumentPlaceholder:"Unexpected argument placeholder.",UnexpectedAwaitAfterPipelineBody:'Unexpected "await" after pipeline body; await must have parentheses in minimal proposal.',UnexpectedDigitAfterHash:"Unexpected digit after hash token.",UnexpectedImportExport:"'import' and 'export' may only appear at the top level.",UnexpectedKeyword:e=>{let{keyword:t}=e;return"Unexpected keyword '".concat(t,"'.")},UnexpectedLeadingDecorator:"Leading decorators must be attached to a class declaration.",UnexpectedLexicalDeclaration:"Lexical declaration cannot appear in a single-statement context.",UnexpectedNewTarget:"`new.target` can only be used in functions or class properties.",UnexpectedNumericSeparator:"A numeric separator is only allowed between two digits.",UnexpectedPrivateField:"Unexpected private name.",UnexpectedReservedWord:e=>{let{reservedWord:t}=e;return"Unexpected reserved word '".concat(t,"'.")},UnexpectedSuper:"'super' is only allowed in object methods and classes.",UnexpectedToken:e=>{let{expected:t,unexpected:n}=e;return"Unexpected token".concat(n?" '".concat(n,"'."):"").concat(t?', expected "'.concat(t,'"'):"")},UnexpectedTokenUnaryExponentiation:"Illegal expression. Wrap left hand side or entire exponentiation in parentheses.",UnexpectedUsingDeclaration:"Using declaration cannot appear in the top level when source type is `script`.",UnsupportedBind:"Binding should be performed on object property.",UnsupportedDecoratorExport:"A decorated export must export a class declaration.",UnsupportedDefaultExport:"Only expressions, functions or classes are allowed as the `default` export.",UnsupportedImport:"`import` can only be used in `import()` or `import.meta`.",UnsupportedMetaProperty:e=>{let{target:t,onlyValidPropertyName:n}=e;return"The only valid meta property for ".concat(t," is ").concat(t,".").concat(n,".")},UnsupportedParameterDecorator:"Decorators cannot be used to decorate parameters.",UnsupportedPropertyDecorator:"Decorators cannot be used to decorate object literal properties.",UnsupportedSuper:"'super' can only be used with function calls (i.e. super()) or in property accesses (i.e. super.prop or super[prop]).",UnterminatedComment:"Unterminated comment.",UnterminatedRegExp:"Unterminated regular expression.",UnterminatedString:"Unterminated string constant.",UnterminatedTemplate:"Unterminated template.",UsingDeclarationExport:"Using declaration cannot be exported.",UsingDeclarationHasBindingPattern:"Using declaration cannot have destructuring patterns.",VarRedeclaration:e=>{let{identifierName:t}=e;return"Identifier '".concat(t,"' has already been declared.")},YieldBindingIdentifier:"Can not use 'yield' as identifier inside a generator.",YieldInParameter:"Yield expression is not allowed in formal parameters.",ZeroDigitNumericSeparator:"Numeric separator can not be used after leading 0."},C={StrictDelete:"Deleting local variable in strict mode.",StrictEvalArguments:e=>{let{referenceName:t}=e;return"Assigning to '".concat(t,"' in strict mode.")},StrictEvalArgumentsBinding:e=>{let{bindingName:t}=e;return"Binding '".concat(t,"' in strict mode.")},StrictFunction:"In strict mode code, functions can only be declared at top level or inside a block.",StrictNumericEscape:"The only valid numeric escape in strict mode is '\\0'.",StrictOctalLiteral:"Legacy octal literals are not allowed in strict mode.",StrictWith:"'with' in strict mode."},m=new Set(["ArrowFunctionExpression","AssignmentExpression","ConditionalExpression","YieldExpression"]),f={PipeBodyIsTighter:"Unexpected yield after pipeline body; any yield expression acting as Hack-style pipe body must be parenthesized due to its loose operator precedence.",PipeTopicRequiresHackPipes:'Topic reference is used, but the pipelineOperator plugin was not passed a "proposal": "hack" or "smart" option.',PipeTopicUnbound:"Topic reference is unbound; it must be inside a pipe body.",PipeTopicUnconfiguredToken:e=>{let{token:t}=e;return"Invalid topic token ".concat(t,". In order to use ").concat(t,' as a topic reference, the pipelineOperator plugin must be configured with { "proposal": "hack", "topicToken": "').concat(t,'" }.')},PipeTopicUnused:"Hack-style pipe body does not contain a topic reference; Hack-style pipes must use topic at least once.",PipeUnparenthesizedBody:e=>{let{type:t}=e;return"Hack-style pipe body cannot be an unparenthesized ".concat(I({type:t}),"; please wrap it in parentheses.")},PipelineBodyNoArrow:'Unexpected arrow "=>" after pipeline body; arrow function in pipeline body must be parenthesized.',PipelineBodySequenceExpression:"Pipeline body may not be a comma-separated sequence expression.",PipelineHeadSequenceExpression:"Pipeline head should not be a comma-separated sequence expression.",PipelineTopicUnused:"Pipeline is in topic style but does not use topic reference.",PrimaryTopicNotAllowed:"Topic reference was used in a lexical context without topic binding.",PrimaryTopicRequiresSmartPipeline:'Topic reference is used, but the pipelineOperator plugin was not passed a "proposal": "hack" or "smart" option.'},y=["toMessage"],b=["message"];function B(e,t,n){Object.defineProperty(e,t,{enumerable:!1,configurable:!0,value:n})}function v(e){let{toMessage:t}=e,i=n(e,y);return function e(n,r){let s=new SyntaxError;return Object.assign(s,i,{loc:n,pos:n.index}),"missingPlugin"in r&&Object.assign(s,{missingPlugin:r.missingPlugin}),B(s,"clone",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var i;let{line:s,column:o,index:a}=null!=(i=t.loc)?i:n;return e(new c(s,o,a),Object.assign({},r,t.details))})),B(s,"details",r),Object.defineProperty(s,"message",{configurable:!0,get(){let e="".concat(t(r)," (").concat(n.line,":").concat(n.column,")");return this.message=e,e},set(e){Object.defineProperty(this,"message",{value:e,writable:!0})}}),s}}function w(e,t){if(Array.isArray(e))return t=>w(t,e[0]);let i={};for(let r of Object.keys(e)){let s=e[r],o="string"==typeof s?{message:()=>s}:"function"==typeof s?{message:s}:s,{message:a}=o,l=n(o,b),c="string"==typeof a?()=>a:a;i[r]=v(Object.assign({code:"BABEL_PARSER_SYNTAX_ERROR",reasonCode:r,toMessage:c},t?{syntaxPlugin:t}:{},l))}return i}var G=Object.assign({},w(d),w(p),w(C),w(i||(i=l(["pipelineOperator"])))(f)),{defineProperty:E}=Object,x=(e,t)=>{e&&E(e,t,{enumerable:!1,value:e[t]})};function S(e){return x(e.loc.start,"index"),x(e.loc.end,"index"),e}var R=e=>class extends e{parse(){let e=S(super.parse());return this.options.tokens&&(e.tokens=e.tokens.map(S)),e}parseRegExpLiteral(e){let{pattern:t,flags:n}=e,i=null;try{i=new RegExp(t,n)}catch{}let r=this.estreeParseLiteral(i);return r.regex={pattern:t,flags:n},r}parseBigIntLiteral(e){let t;try{t=BigInt(e)}catch{t=null}let n=this.estreeParseLiteral(t);return n.bigint=String(n.value||e),n}parseDecimalLiteral(e){let t=this.estreeParseLiteral(null);return t.decimal=String(t.value||e),t}estreeParseLiteral(e){return this.parseLiteral(e,"Literal")}parseStringLiteral(e){return this.estreeParseLiteral(e)}parseNumericLiteral(e){return this.estreeParseLiteral(e)}parseNullLiteral(){return this.estreeParseLiteral(null)}parseBooleanLiteral(e){return this.estreeParseLiteral(e)}directiveToStmt(e){let t=e.value;delete e.value,t.type="Literal",t.raw=t.extra.raw,t.value=t.extra.expressionValue;let n=e;return n.type="ExpressionStatement",n.expression=t,n.directive=t.extra.rawValue,delete t.extra,n}initFunction(e,t){super.initFunction(e,t),e.expression=!1}checkDeclaration(e){null!=e&&this.isObjectProperty(e)?this.checkDeclaration(e.value):super.checkDeclaration(e)}getObjectOrClassMethodParams(e){return e.value.params}isValidDirective(e){var t;return"ExpressionStatement"===e.type&&"Literal"===e.expression.type&&"string"==typeof e.expression.value&&!(null!=(t=e.expression.extra)&&t.parenthesized)}parseBlockBody(e,t,n,i,r){super.parseBlockBody(e,t,n,i,r);let s=e.directives.map((e=>this.directiveToStmt(e)));e.body=s.concat(e.body),delete e.directives}pushClassMethod(e,t,n,i,r,s){this.parseMethod(t,n,i,r,s,"ClassMethod",!0),t.typeParameters&&(t.value.typeParameters=t.typeParameters,delete t.typeParameters),e.body.push(t)}parsePrivateName(){let e=super.parsePrivateName();return this.getPluginOption("estree","classFeatures")?this.convertPrivateNameToPrivateIdentifier(e):e}convertPrivateNameToPrivateIdentifier(e){let t=super.getPrivateNameSV(e);return delete e.id,e.name=t,e.type="PrivateIdentifier",e}isPrivateName(e){return this.getPluginOption("estree","classFeatures")?"PrivateIdentifier"===e.type:super.isPrivateName(e)}getPrivateNameSV(e){return this.getPluginOption("estree","classFeatures")?e.name:super.getPrivateNameSV(e)}parseLiteral(e,t){let n=super.parseLiteral(e,t);return n.raw=n.extra.raw,delete n.extra,n}parseFunctionBody(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super.parseFunctionBody(e,t,n),e.expression="BlockStatement"!==e.body.type}parseMethod(e,t,n,i,r,s){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=this.startNode();return a.kind=e.kind,a=super.parseMethod(a,t,n,i,r,s,o),a.type="FunctionExpression",delete a.kind,e.value=a,"ClassPrivateMethod"===s&&(e.computed=!1),this.finishNode(e,"MethodDefinition")}nameIsConstructor(e){return"Literal"===e.type?"constructor"===e.value:super.nameIsConstructor(e)}parseClassProperty(){let e=super.parseClassProperty(...arguments);return this.getPluginOption("estree","classFeatures")&&(e.type="PropertyDefinition"),e}parseClassPrivateProperty(){let e=super.parseClassPrivateProperty(...arguments);return this.getPluginOption("estree","classFeatures")&&(e.type="PropertyDefinition",e.computed=!1),e}parseObjectMethod(e,t,n,i,r){let s=super.parseObjectMethod(e,t,n,i,r);return s&&(s.type="Property","method"===s.kind&&(s.kind="init"),s.shorthand=!1),s}parseObjectProperty(e,t,n,i){let r=super.parseObjectProperty(e,t,n,i);return r&&(r.kind="init",r.type="Property"),r}isValidLVal(e,t,n){return"Property"===e?"value":super.isValidLVal(e,t,n)}isAssignable(e,t){return null!=e&&this.isObjectProperty(e)?this.isAssignable(e.value,t):super.isAssignable(e,t)}toAssignable(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null!=e&&this.isObjectProperty(e)){let{key:n,value:i}=e;this.isPrivateName(n)&&this.classScope.usePrivateName(this.getPrivateNameSV(n),n.loc.start),this.toAssignable(i,t)}else super.toAssignable(e,t)}toAssignableObjectExpressionProp(e,t,n){"Property"!==e.type||"get"!==e.kind&&"set"!==e.kind?"Property"===e.type&&e.method?this.raise(G.PatternHasMethod,e.key):super.toAssignableObjectExpressionProp(e,t,n):this.raise(G.PatternHasAccessor,e.key)}finishCallExpression(e,t){let n=super.finishCallExpression(e,t);var i,r;"Import"===n.callee.type&&(n.type="ImportExpression",n.source=n.arguments[0],(this.hasPlugin("importAttributes")||this.hasPlugin("importAssertions"))&&(n.options=null!=(i=n.arguments[1])?i:null,n.attributes=null!=(r=n.arguments[1])?r:null),delete n.arguments,delete n.callee);return n}toReferencedArguments(e){"ImportExpression"!==e.type&&super.toReferencedArguments(e)}parseExport(e,t){let n=this.state.lastTokStartLoc,i=super.parseExport(e,t);switch(i.type){case"ExportAllDeclaration":i.exported=null;break;case"ExportNamedDeclaration":1===i.specifiers.length&&"ExportNamespaceSpecifier"===i.specifiers[0].type&&(i.type="ExportAllDeclaration",i.exported=i.specifiers[0].exported,delete i.specifiers);case"ExportDefaultDeclaration":{var r;let{declaration:e}=i;"ClassDeclaration"===(null==e?void 0:e.type)&&(null==(r=e.decorators)?void 0:r.length)>0&&e.start===i.start&&this.resetStartLocation(i,n)}}return i}parseSubscript(e,t,n,i){let r=super.parseSubscript(e,t,n,i);if(i.optionalChainMember){if(("OptionalMemberExpression"===r.type||"OptionalCallExpression"===r.type)&&(r.type=r.type.substring(8)),i.stop){let e=this.startNodeAtNode(r);return e.expression=r,this.finishNode(e,"ChainExpression")}}else("MemberExpression"===r.type||"CallExpression"===r.type)&&(r.optional=!1);return r}isOptionalMemberExpression(e){return"ChainExpression"===e.type?"MemberExpression"===e.expression.type:super.isOptionalMemberExpression(e)}hasPropertyAsPrivateName(e){return"ChainExpression"===e.type&&(e=e.expression),super.hasPropertyAsPrivateName(e)}isObjectProperty(e){return"Property"===e.type&&"init"===e.kind&&!e.method}isObjectMethod(e){return"Property"===e.type&&(e.method||"get"===e.kind||"set"===e.kind)}finishNodeAt(e,t,n){return S(super.finishNodeAt(e,t,n))}resetStartLocation(e,t){super.resetStartLocation(e,t),S(e)}resetEndLocation(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state.lastTokEndLoc;super.resetEndLocation(e,t),S(e)}},Z=class{constructor(e,t){this.token=void 0,this.preserveSpace=void 0,this.token=e,this.preserveSpace=!!t}},D={brace:new Z("{"),j_oTag:new Z("<tag"),j_cTag:new Z("</tag"),j_expr:new Z("<tag>...</tag>",!0)};D.template=new Z("`",!0);var F=!0,N=!0,M=!0,W=!0,k=!0,T=!0,V=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.label=void 0,this.keyword=void 0,this.beforeExpr=void 0,this.startsExpr=void 0,this.rightAssociative=void 0,this.isLoop=void 0,this.isAssign=void 0,this.prefix=void 0,this.postfix=void 0,this.binop=void 0,this.label=e,this.keyword=t.keyword,this.beforeExpr=!!t.beforeExpr,this.startsExpr=!!t.startsExpr,this.rightAssociative=!!t.rightAssociative,this.isLoop=!!t.isLoop,this.isAssign=!!t.isAssign,this.prefix=!!t.prefix,this.postfix=!!t.postfix,this.binop=null!=t.binop?t.binop:null,this.updateContext=null}},L=new Map;function H(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.keyword=e;let n=O(e,t);return L.set(e,n),n}function Q(e,t){return O(e,{beforeExpr:F,binop:t})}var K=-1,X=[],Y=[],z=[],P=[],U=[],_=[];function O(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,i,r,s;return++K,Y.push(e),z.push(null!=(n=t.binop)?n:-1),P.push(null!=(i=t.beforeExpr)&&i),U.push(null!=(r=t.startsExpr)&&r),_.push(null!=(s=t.prefix)&&s),X.push(new V(e,t)),K}function J(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,i,r,s;return++K,L.set(e,K),Y.push(e),z.push(null!=(n=t.binop)?n:-1),P.push(null!=(i=t.beforeExpr)&&i),U.push(null!=(r=t.startsExpr)&&r),_.push(null!=(s=t.prefix)&&s),X.push(new V("name",t)),K}var j={bracketL:O("[",{beforeExpr:F,startsExpr:N}),bracketHashL:O("#[",{beforeExpr:F,startsExpr:N}),bracketBarL:O("[|",{beforeExpr:F,startsExpr:N}),bracketR:O("]"),bracketBarR:O("|]"),braceL:O("{",{beforeExpr:F,startsExpr:N}),braceBarL:O("{|",{beforeExpr:F,startsExpr:N}),braceHashL:O("#{",{beforeExpr:F,startsExpr:N}),braceR:O("}"),braceBarR:O("|}"),parenL:O("(",{beforeExpr:F,startsExpr:N}),parenR:O(")"),comma:O(",",{beforeExpr:F}),semi:O(";",{beforeExpr:F}),colon:O(":",{beforeExpr:F}),doubleColon:O("::",{beforeExpr:F}),dot:O("."),question:O("?",{beforeExpr:F}),questionDot:O("?."),arrow:O("=>",{beforeExpr:F}),template:O("template"),ellipsis:O("...",{beforeExpr:F}),backQuote:O("`",{startsExpr:N}),dollarBraceL:O("${",{beforeExpr:F,startsExpr:N}),templateTail:O("...`",{startsExpr:N}),templateNonTail:O("...${",{beforeExpr:F,startsExpr:N}),at:O("@"),hash:O("#",{startsExpr:N}),interpreterDirective:O("#!..."),eq:O("=",{beforeExpr:F,isAssign:W}),assign:O("_=",{beforeExpr:F,isAssign:W}),slashAssign:O("_=",{beforeExpr:F,isAssign:W}),xorAssign:O("_=",{beforeExpr:F,isAssign:W}),moduloAssign:O("_=",{beforeExpr:F,isAssign:W}),incDec:O("++/--",{prefix:k,postfix:T,startsExpr:N}),bang:O("!",{beforeExpr:F,prefix:k,startsExpr:N}),tilde:O("~",{beforeExpr:F,prefix:k,startsExpr:N}),doubleCaret:O("^^",{startsExpr:N}),doubleAt:O("@@",{startsExpr:N}),pipeline:Q("|>",0),nullishCoalescing:Q("??",1),logicalOR:Q("||",1),logicalAND:Q("&&",2),bitwiseOR:Q("|",3),bitwiseXOR:Q("^",4),bitwiseAND:Q("&",5),equality:Q("==/!=/===/!==",6),lt:Q("</>/<=/>=",7),gt:Q("</>/<=/>=",7),relational:Q("</>/<=/>=",7),bitShift:Q("<</>>/>>>",8),bitShiftL:Q("<</>>/>>>",8),bitShiftR:Q("<</>>/>>>",8),plusMin:O("+/-",{beforeExpr:F,binop:9,prefix:k,startsExpr:N}),modulo:O("%",{binop:10,startsExpr:N}),star:O("*",{binop:10}),slash:Q("/",10),exponent:O("**",{beforeExpr:F,binop:11,rightAssociative:!0}),_in:H("in",{beforeExpr:F,binop:7}),_instanceof:H("instanceof",{beforeExpr:F,binop:7}),_break:H("break"),_case:H("case",{beforeExpr:F}),_catch:H("catch"),_continue:H("continue"),_debugger:H("debugger"),_default:H("default",{beforeExpr:F}),_else:H("else",{beforeExpr:F}),_finally:H("finally"),_function:H("function",{startsExpr:N}),_if:H("if"),_return:H("return",{beforeExpr:F}),_switch:H("switch"),_throw:H("throw",{beforeExpr:F,prefix:k,startsExpr:N}),_try:H("try"),_var:H("var"),_const:H("const"),_with:H("with"),_new:H("new",{beforeExpr:F,startsExpr:N}),_this:H("this",{startsExpr:N}),_super:H("super",{startsExpr:N}),_class:H("class",{startsExpr:N}),_extends:H("extends",{beforeExpr:F}),_export:H("export"),_import:H("import",{startsExpr:N}),_null:H("null",{startsExpr:N}),_true:H("true",{startsExpr:N}),_false:H("false",{startsExpr:N}),_typeof:H("typeof",{beforeExpr:F,prefix:k,startsExpr:N}),_void:H("void",{beforeExpr:F,prefix:k,startsExpr:N}),_delete:H("delete",{beforeExpr:F,prefix:k,startsExpr:N}),_do:H("do",{isLoop:M,beforeExpr:F}),_for:H("for",{isLoop:M}),_while:H("while",{isLoop:M}),_as:J("as",{startsExpr:N}),_assert:J("assert",{startsExpr:N}),_async:J("async",{startsExpr:N}),_await:J("await",{startsExpr:N}),_defer:J("defer",{startsExpr:N}),_from:J("from",{startsExpr:N}),_get:J("get",{startsExpr:N}),_let:J("let",{startsExpr:N}),_meta:J("meta",{startsExpr:N}),_of:J("of",{startsExpr:N}),_sent:J("sent",{startsExpr:N}),_set:J("set",{startsExpr:N}),_source:J("source",{startsExpr:N}),_static:J("static",{startsExpr:N}),_using:J("using",{startsExpr:N}),_yield:J("yield",{startsExpr:N}),_asserts:J("asserts",{startsExpr:N}),_checks:J("checks",{startsExpr:N}),_exports:J("exports",{startsExpr:N}),_global:J("global",{startsExpr:N}),_implements:J("implements",{startsExpr:N}),_intrinsic:J("intrinsic",{startsExpr:N}),_infer:J("infer",{startsExpr:N}),_is:J("is",{startsExpr:N}),_mixins:J("mixins",{startsExpr:N}),_proto:J("proto",{startsExpr:N}),_require:J("require",{startsExpr:N}),_satisfies:J("satisfies",{startsExpr:N}),_keyof:J("keyof",{startsExpr:N}),_readonly:J("readonly",{startsExpr:N}),_unique:J("unique",{startsExpr:N}),_abstract:J("abstract",{startsExpr:N}),_declare:J("declare",{startsExpr:N}),_enum:J("enum",{startsExpr:N}),_module:J("module",{startsExpr:N}),_namespace:J("namespace",{startsExpr:N}),_interface:J("interface",{startsExpr:N}),_type:J("type",{startsExpr:N}),_opaque:J("opaque",{startsExpr:N}),name:O("name",{startsExpr:N}),string:O("string",{startsExpr:N}),num:O("num",{startsExpr:N}),bigint:O("bigint",{startsExpr:N}),decimal:O("decimal",{startsExpr:N}),regexp:O("regexp",{startsExpr:N}),privateName:O("#name",{startsExpr:N}),eof:O("eof"),jsxName:O("jsxName"),jsxText:O("jsxText",{beforeExpr:!0}),jsxTagStart:O("jsxTagStart",{startsExpr:!0}),jsxTagEnd:O("jsxTagEnd"),placeholder:O("%%",{startsExpr:!0})};function q(e){return e>=93&&e<=132}function $(e){return e<=92}function ee(e){return e>=58&&e<=132}function te(e){return e>=58&&e<=136}function ne(e){return P[e]}function ie(e){return U[e]}function re(e){return e>=29&&e<=33}function se(e){return e>=129&&e<=131}function oe(e){return e>=90&&e<=92}function ae(e){return e>=58&&e<=92}function le(e){return e>=39&&e<=59}function ce(e){return 34===e}function ge(e){return _[e]}function ue(e){return e>=121&&e<=123}function Ae(e){return e>=124&&e<=130}function de(e){return Y[e]}function he(e){return z[e]}function Ie(e){return 57===e}function pe(e){return e>=24&&e<=25}function Ce(e){return X[e]}X[8].updateContext=e=>{e.pop()},X[5].updateContext=X[7].updateContext=X[23].updateContext=e=>{e.push(D.brace)},X[22].updateContext=e=>{e[e.length-1]===D.template?e.pop():e.push(D.template)},X[142].updateContext=e=>{e.push(D.j_expr,D.j_oTag)};var me="\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u052f\u0531-\u0556\u0559\u0560-\u0588\u05d0-\u05ea\u05ef-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u0860-\u086a\u0870-\u0887\u0889-\u088e\u08a0-\u08c9\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u09fc\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0af9\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c58-\u0c5a\u0c5d\u0c60\u0c61\u0c80\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cdd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d04-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d54-\u0d56\u0d5f-\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e86-\u0e8a\u0e8c-\u0ea3\u0ea5\u0ea7-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f5\u13f8-\u13fd\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u1711\u171f-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1878\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4c\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1c80-\u1c88\u1c90-\u1cba\u1cbd-\u1cbf\u1ce9-\u1cec\u1cee-\u1cf3\u1cf5\u1cf6\u1cfa\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2118-\u211d\u2124\u2126\u2128\u212a-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309b-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312f\u3131-\u318e\u31a0-\u31bf\u31f0-\u31ff\u3400-\u4dbf\u4e00-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua69d\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua7ca\ua7d0\ua7d1\ua7d3\ua7d5-\ua7d9\ua7f2-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua8fd\ua8fe\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\ua9e0-\ua9e4\ua9e6-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa7e-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab69\uab70-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc",fe="\u200c\u200d\xb7\u0300-\u036f\u0387\u0483-\u0487\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u0669\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7\u06e8\u06ea-\u06ed\u06f0-\u06f9\u0711\u0730-\u074a\u07a6-\u07b0\u07c0-\u07c9\u07eb-\u07f3\u07fd\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0859-\u085b\u0898-\u089f\u08ca-\u08e1\u08e3-\u0903\u093a-\u093c\u093e-\u094f\u0951-\u0957\u0962\u0963\u0966-\u096f\u0981-\u0983\u09bc\u09be-\u09c4\u09c7\u09c8\u09cb-\u09cd\u09d7\u09e2\u09e3\u09e6-\u09ef\u09fe\u0a01-\u0a03\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a66-\u0a71\u0a75\u0a81-\u0a83\u0abc\u0abe-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ae2\u0ae3\u0ae6-\u0aef\u0afa-\u0aff\u0b01-\u0b03\u0b3c\u0b3e-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b55-\u0b57\u0b62\u0b63\u0b66-\u0b6f\u0b82\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd7\u0be6-\u0bef\u0c00-\u0c04\u0c3c\u0c3e-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0c66-\u0c6f\u0c81-\u0c83\u0cbc\u0cbe-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0ce6-\u0cef\u0cf3\u0d00-\u0d03\u0d3b\u0d3c\u0d3e-\u0d44\u0d46-\u0d48\u0d4a-\u0d4d\u0d57\u0d62\u0d63\u0d66-\u0d6f\u0d81-\u0d83\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0de6-\u0def\u0df2\u0df3\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0e50-\u0e59\u0eb1\u0eb4-\u0ebc\u0ec8-\u0ece\u0ed0-\u0ed9\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e\u0f3f\u0f71-\u0f84\u0f86\u0f87\u0f8d-\u0f97\u0f99-\u0fbc\u0fc6\u102b-\u103e\u1040-\u1049\u1056-\u1059\u105e-\u1060\u1062-\u1064\u1067-\u106d\u1071-\u1074\u1082-\u108d\u108f-\u109d\u135d-\u135f\u1369-\u1371\u1712-\u1715\u1732-\u1734\u1752\u1753\u1772\u1773\u17b4-\u17d3\u17dd\u17e0-\u17e9\u180b-\u180d\u180f-\u1819\u18a9\u1920-\u192b\u1930-\u193b\u1946-\u194f\u19d0-\u19da\u1a17-\u1a1b\u1a55-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1ab0-\u1abd\u1abf-\u1ace\u1b00-\u1b04\u1b34-\u1b44\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1b82\u1ba1-\u1bad\u1bb0-\u1bb9\u1be6-\u1bf3\u1c24-\u1c37\u1c40-\u1c49\u1c50-\u1c59\u1cd0-\u1cd2\u1cd4-\u1ce8\u1ced\u1cf4\u1cf7-\u1cf9\u1dc0-\u1dff\u200c\u200d\u203f\u2040\u2054\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2cef-\u2cf1\u2d7f\u2de0-\u2dff\u302a-\u302f\u3099\u309a\u30fb\ua620-\ua629\ua66f\ua674-\ua67d\ua69e\ua69f\ua6f0\ua6f1\ua802\ua806\ua80b\ua823-\ua827\ua82c\ua880\ua881\ua8b4-\ua8c5\ua8d0-\ua8d9\ua8e0-\ua8f1\ua8ff-\ua909\ua926-\ua92d\ua947-\ua953\ua980-\ua983\ua9b3-\ua9c0\ua9d0-\ua9d9\ua9e5\ua9f0-\ua9f9\uaa29-\uaa36\uaa43\uaa4c\uaa4d\uaa50-\uaa59\uaa7b-\uaa7d\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uaaeb-\uaaef\uaaf5\uaaf6\uabe3-\uabea\uabec\uabed\uabf0-\uabf9\ufb1e\ufe00-\ufe0f\ufe20-\ufe2f\ufe33\ufe34\ufe4d-\ufe4f\uff10-\uff19\uff3f\uff65",ye=new RegExp("["+me+"]"),be=new RegExp("["+me+fe+"]");me=fe=null;var Be=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,68,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,4026,582,8634,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,757,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],ve=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,81,2,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,9,5351,0,7,14,13835,9,87,9,39,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,4706,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,983,6,110,6,6,9,4759,9,787719,239];function we(e,t){let n=65536;for(let i=0,r=t.length;i<r;i+=2){if(n+=t[i],n>e)return!1;if(n+=t[i+1],n>=e)return!0}return!1}function Ge(e){return e<65?36===e:e<=90||(e<97?95===e:e<=122||(e<=65535?e>=170&&ye.test(String.fromCharCode(e)):we(e,Be)))}function Ee(e){return e<48?36===e:e<58||!(e<65)&&(e<=90||(e<97?95===e:e<=122||(e<=65535?e>=170&&be.test(String.fromCharCode(e)):we(e,Be)||we(e,ve))))}var xe={keyword:["break","case","catch","continue","debugger","default","do","else","finally","for","function","if","return","switch","throw","try","var","const","while","with","new","this","super","class","extends","export","import","null","true","false","in","instanceof","typeof","void","delete"],strict:["implements","interface","let","package","private","protected","public","static","yield"],strictBind:["eval","arguments"]},Se=new Set(xe.keyword),Re=new Set(xe.strict),Ze=new Set(xe.strictBind);function De(e,t){return t&&"await"===e||"enum"===e}function Fe(e,t){return De(e,t)||Re.has(e)}function Ne(e){return Ze.has(e)}function Me(e,t){return Fe(e,t)||Ne(e)}function We(e){return Se.has(e)}function ke(e,t,n){return 64===e&&64===t&&Ge(n)}var Te=new Set(["break","case","catch","continue","debugger","default","do","else","finally","for","function","if","return","switch","throw","try","var","const","while","with","new","this","super","class","extends","export","import","null","true","false","in","instanceof","typeof","void","delete","implements","interface","let","package","private","protected","public","static","yield","eval","arguments","enum","await"]);function Ve(e){return Te.has(e)}var Le=class{constructor(e){this.flags=0,this.names=new Map,this.firstLexicalName="",this.flags=e}},He=class{constructor(e,t){this.parser=void 0,this.scopeStack=[],this.inModule=void 0,this.undefinedExports=new Map,this.parser=e,this.inModule=t}get inTopLevel(){return(1&this.currentScope().flags)>0}get inFunction(){return(2&this.currentVarScopeFlags())>0}get allowSuper(){return(16&this.currentThisScopeFlags())>0}get allowDirectSuper(){return(32&this.currentThisScopeFlags())>0}get inClass(){return(64&this.currentThisScopeFlags())>0}get inClassAndNotInNonArrowFunction(){let e=this.currentThisScopeFlags();return(64&e)>0&&0===(2&e)}get inStaticBlock(){for(let e=this.scopeStack.length-1;;e--){let{flags:t}=this.scopeStack[e];if(128&t)return!0;if(451&t)return!1}}get inNonArrowFunction(){return(2&this.currentThisScopeFlags())>0}get treatFunctionsAsVar(){return this.treatFunctionsAsVarInScope(this.currentScope())}createScope(e){return new Le(e)}enter(e){this.scopeStack.push(this.createScope(e))}exit(){return this.scopeStack.pop().flags}treatFunctionsAsVarInScope(e){return!!(130&e.flags||!this.parser.inModule&&1&e.flags)}declareName(e,t,n){let i=this.currentScope();if(8&t||16&t){this.checkRedeclarationInScope(i,e,t,n);let r=i.names.get(e)||0;16&t?r|=4:(i.firstLexicalName||(i.firstLexicalName=e),r|=2),i.names.set(e,r),8&t&&this.maybeExportDefined(i,e)}else if(4&t)for(let r=this.scopeStack.length-1;r>=0&&(i=this.scopeStack[r],this.checkRedeclarationInScope(i,e,t,n),i.names.set(e,1|(i.names.get(e)||0)),this.maybeExportDefined(i,e),!(387&i.flags));--r);this.parser.inModule&&1&i.flags&&this.undefinedExports.delete(e)}maybeExportDefined(e,t){this.parser.inModule&&1&e.flags&&this.undefinedExports.delete(t)}checkRedeclarationInScope(e,t,n,i){this.isRedeclaredInScope(e,t,n)&&this.parser.raise(G.VarRedeclaration,i,{identifierName:t})}isRedeclaredInScope(e,t,n){if(!(1&n))return!1;if(8&n)return e.names.has(t);let i=e.names.get(t);return 16&n?(2&i)>0||!this.treatFunctionsAsVarInScope(e)&&(1&i)>0:(2&i)>0&&!(8&e.flags&&e.firstLexicalName===t)||!this.treatFunctionsAsVarInScope(e)&&(4&i)>0}checkLocalExport(e){let{name:t}=e;this.scopeStack[0].names.has(t)||this.undefinedExports.set(t,e.loc.start)}currentScope(){return this.scopeStack[this.scopeStack.length-1]}currentVarScopeFlags(){for(let e=this.scopeStack.length-1;;e--){let{flags:t}=this.scopeStack[e];if(387&t)return t}}currentThisScopeFlags(){for(let e=this.scopeStack.length-1;;e--){let{flags:t}=this.scopeStack[e];if(451&t&&!(4&t))return t}}},Qe=class extends Le{constructor(){super(...arguments),this.declareFunctions=new Set}},Ke=class extends He{createScope(e){return new Qe(e)}declareName(e,t,n){let i=this.currentScope();if(2048&t)return this.checkRedeclarationInScope(i,e,t,n),this.maybeExportDefined(i,e),void i.declareFunctions.add(e);super.declareName(e,t,n)}isRedeclaredInScope(e,t,n){if(super.isRedeclaredInScope(e,t,n))return!0;if(2048&n&&!e.declareFunctions.has(t)){let n=e.names.get(t);return(4&n)>0||(2&n)>0}return!1}checkLocalExport(e){this.scopeStack[0].declareFunctions.has(e.name)||super.checkLocalExport(e)}},Xe=class{constructor(){this.sawUnambiguousESM=!1,this.ambiguousScriptDifferentAst=!1}hasPlugin(e){if("string"==typeof e)return this.plugins.has(e);{let[t,n]=e;if(!this.hasPlugin(t))return!1;let i=this.plugins.get(t);for(let e of Object.keys(n))if((null==i?void 0:i[e])!==n[e])return!1;return!0}}getPluginOption(e,t){var n;return null==(n=this.plugins.get(e))?void 0:n[t]}};function Ye(e,t){void 0===e.trailingComments?e.trailingComments=t:e.trailingComments.unshift(...t)}function ze(e,t){void 0===e.leadingComments?e.leadingComments=t:e.leadingComments.unshift(...t)}function Pe(e,t){void 0===e.innerComments?e.innerComments=t:e.innerComments.unshift(...t)}function Ue(e,t,n){let i=null,r=t.length;for(;null===i&&r>0;)i=t[--r];null===i||i.start>n.start?Pe(e,n.comments):Ye(i,n.comments)}var _e=class extends Xe{addComment(e){this.filename&&(e.loc.filename=this.filename);let{commentsLen:t}=this.state;this.comments.length!==t&&(this.comments.length=t),this.comments.push(e),this.state.commentsLen++}processComment(e){let{commentStack:t}=this.state,n=t.length;if(0===n)return;let i=n-1,r=t[i];r.start===e.end&&(r.leadingNode=e,i--);let{start:s}=e;for(;i>=0;i--){let n=t[i],r=n.end;if(!(r>s)){r===s&&(n.trailingNode=e);break}n.containingNode=e,this.finalizeComment(n),t.splice(i,1)}}finalizeComment(e){let{comments:t}=e;if(null!==e.leadingNode||null!==e.trailingNode)null!==e.leadingNode&&Ye(e.leadingNode,t),null!==e.trailingNode&&ze(e.trailingNode,t);else{let{containingNode:n,start:i}=e;if(44===this.input.charCodeAt(i-1))switch(n.type){case"ObjectExpression":case"ObjectPattern":case"RecordExpression":Ue(n,n.properties,e);break;case"CallExpression":case"OptionalCallExpression":Ue(n,n.arguments,e);break;case"FunctionDeclaration":case"FunctionExpression":case"ArrowFunctionExpression":case"ObjectMethod":case"ClassMethod":case"ClassPrivateMethod":Ue(n,n.params,e);break;case"ArrayExpression":case"ArrayPattern":case"TupleExpression":Ue(n,n.elements,e);break;case"ExportNamedDeclaration":case"ImportDeclaration":Ue(n,n.specifiers,e);break;default:Pe(n,t)}else Pe(n,t)}}finalizeRemainingComments(){let{commentStack:e}=this.state;for(let t=e.length-1;t>=0;t--)this.finalizeComment(e[t]);this.state.commentStack=[]}resetPreviousNodeTrailingComments(e){let{commentStack:t}=this.state,{length:n}=t;if(0===n)return;let i=t[n-1];i.leadingNode===e&&(i.leadingNode=null)}resetPreviousIdentifierLeadingComments(e){let{commentStack:t}=this.state,{length:n}=t;0!==n&&(t[n-1].trailingNode===e?t[n-1].trailingNode=null:n>=2&&t[n-2].trailingNode===e&&(t[n-2].trailingNode=null))}takeSurroundingComments(e,t,n){let{commentStack:i}=this.state,r=i.length;if(0===r)return;let s=r-1;for(;s>=0;s--){let r=i[s],o=r.end;if(r.start===n)r.leadingNode=e;else if(o===t)r.trailingNode=e;else if(o<t)break}}},Oe=/\r\n?|[\n\u2028\u2029]/,Je=new RegExp(Oe.source,"g");function je(e){switch(e){case 10:case 13:case 8232:case 8233:return!0;default:return!1}}var qe=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,$e=/(?:[^\S\n\r\u2028\u2029]|\/\/.*|\/\*.*?\*\/)*/g,et=new RegExp("(?=("+$e.source+"))\\1"+/(?=[\n\r\u2028\u2029]|\/\*(?!.*?\*\/)|$)/.source,"y");function tt(e){switch(e){case 9:case 11:case 12:case 32:case 160:case 5760:case 8192:case 8193:case 8194:case 8195:case 8196:case 8197:case 8198:case 8199:case 8200:case 8201:case 8202:case 8239:case 8287:case 12288:case 65279:return!0;default:return!1}}var nt=class e{constructor(){this.flags=1024,this.curLine=void 0,this.lineStart=void 0,this.startLoc=void 0,this.endLoc=void 0,this.errors=[],this.potentialArrowAt=-1,this.noArrowAt=[],this.noArrowParamsConversionAt=[],this.topicContext={maxNumOfResolvableTopics:0,maxTopicIndex:null},this.labels=[],this.commentsLen=0,this.commentStack=[],this.pos=0,this.type=139,this.value=null,this.start=0,this.end=0,this.lastTokEndLoc=null,this.lastTokStartLoc=null,this.context=[D.brace],this.firstInvalidTemplateEscapePos=null,this.strictErrors=new Map,this.tokensLength=0}get strict(){return(1&this.flags)>0}set strict(e){e?this.flags|=1:this.flags&=-2}init(e){let{strictMode:t,sourceType:n,startLine:i,startColumn:r}=e;this.strict=!1!==t&&(!0===t||"module"===n),this.curLine=i,this.lineStart=-r,this.startLoc=this.endLoc=new c(i,r,0)}get maybeInArrowParameters(){return(2&this.flags)>0}set maybeInArrowParameters(e){e?this.flags|=2:this.flags&=-3}get inType(){return(4&this.flags)>0}set inType(e){e?this.flags|=4:this.flags&=-5}get noAnonFunctionType(){return(8&this.flags)>0}set noAnonFunctionType(e){e?this.flags|=8:this.flags&=-9}get hasFlowComment(){return(16&this.flags)>0}set hasFlowComment(e){e?this.flags|=16:this.flags&=-17}get isAmbientContext(){return(32&this.flags)>0}set isAmbientContext(e){e?this.flags|=32:this.flags&=-33}get inAbstractClass(){return(64&this.flags)>0}set inAbstractClass(e){e?this.flags|=64:this.flags&=-65}get inDisallowConditionalTypesContext(){return(128&this.flags)>0}set inDisallowConditionalTypesContext(e){e?this.flags|=128:this.flags&=-129}get soloAwait(){return(256&this.flags)>0}set soloAwait(e){e?this.flags|=256:this.flags&=-257}get inFSharpPipelineDirectBody(){return(512&this.flags)>0}set inFSharpPipelineDirectBody(e){e?this.flags|=512:this.flags&=-513}get canStartJSXElement(){return(1024&this.flags)>0}set canStartJSXElement(e){e?this.flags|=1024:this.flags&=-1025}get containsEsc(){return(2048&this.flags)>0}set containsEsc(e){e?this.flags|=2048:this.flags&=-2049}curPosition(){return new c(this.curLine,this.pos-this.lineStart,this.pos)}clone(){let t=new e;return t.flags=this.flags,t.curLine=this.curLine,t.lineStart=this.lineStart,t.startLoc=this.startLoc,t.endLoc=this.endLoc,t.errors=this.errors.slice(),t.potentialArrowAt=this.potentialArrowAt,t.noArrowAt=this.noArrowAt.slice(),t.noArrowParamsConversionAt=this.noArrowParamsConversionAt.slice(),t.topicContext=this.topicContext,t.labels=this.labels.slice(),t.commentsLen=this.commentsLen,t.commentStack=this.commentStack.slice(),t.pos=this.pos,t.type=this.type,t.value=this.value,t.start=this.start,t.end=this.end,t.lastTokEndLoc=this.lastTokEndLoc,t.lastTokStartLoc=this.lastTokStartLoc,t.context=this.context.slice(),t.firstInvalidTemplateEscapePos=this.firstInvalidTemplateEscapePos,t.strictErrors=this.strictErrors,t.tokensLength=this.tokensLength,t}},it=function(e){return e>=48&&e<=57},rt={decBinOct:new Set([46,66,69,79,95,98,101,111]),hex:new Set([46,88,95,120])},st={bin:e=>48===e||49===e,oct:e=>e>=48&&e<=55,dec:e=>e>=48&&e<=57,hex:e=>e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102};function ot(e,t,n,i,r,s){let o=n,a=i,l=r,c="",g=null,u=n,{length:A}=t;for(;;){if(n>=A){s.unterminated(o,a,l),c+=t.slice(u,n);break}let d=t.charCodeAt(n);if(at(e,d,t,n)){c+=t.slice(u,n);break}if(92===d){c+=t.slice(u,n);let o=lt(t,n,i,r,"template"===e,s);null!==o.ch||g?c+=o.ch:g={pos:n,lineStart:i,curLine:r},({pos:n,lineStart:i,curLine:r}=o),u=n}else 8232===d||8233===d?(++r,i=++n):10===d||13===d?"template"===e?(c+=t.slice(u,n)+"\n",++n,13===d&&10===t.charCodeAt(n)&&++n,++r,u=i=n):s.unterminated(o,a,l):++n}return{pos:n,str:c,firstInvalidLoc:g,lineStart:i,curLine:r,containsInvalid:!!g}}function at(e,t,n,i){return"template"===e?96===t||36===t&&123===n.charCodeAt(i+1):t===("double"===e?34:39)}function lt(e,t,n,i,r,s){let o=!r;t++;let a=e=>({pos:t,ch:e,lineStart:n,curLine:i}),l=e.charCodeAt(t++);switch(l){case 110:return a("\n");case 114:return a("\r");case 120:{let r;return({code:r,pos:t}=ct(e,t,n,i,2,!1,o,s)),a(null===r?null:String.fromCharCode(r))}case 117:{let r;return({code:r,pos:t}=ut(e,t,n,i,o,s)),a(null===r?null:String.fromCodePoint(r))}case 116:return a("\t");case 98:return a("\b");case 118:return a("\v");case 102:return a("\f");case 13:10===e.charCodeAt(t)&&++t;case 10:n=t,++i;case 8232:case 8233:return a("");case 56:case 57:if(r)return a(null);s.strictNumericEscape(t-1,n,i);default:if(l>=48&&l<=55){let o=t-1,l=/^[0-7]+/.exec(e.slice(o,t+2))[0],c=parseInt(l,8);c>255&&(l=l.slice(0,-1),c=parseInt(l,8)),t+=l.length-1;let g=e.charCodeAt(t);if("0"!==l||56===g||57===g){if(r)return a(null);s.strictNumericEscape(o,n,i)}return a(String.fromCharCode(c))}return a(String.fromCharCode(l))}}function ct(e,t,n,i,r,s,o,a){let l,c=t;return({n:l,pos:t}=gt(e,t,n,i,16,r,s,!1,a,!o)),null===l&&(o?a.invalidEscapeSequence(c,n,i):t=c-1),{code:l,pos:t}}function gt(e,t,n,i,r,s,o,a,l,c){let g=t,u=16===r?rt.hex:rt.decBinOct,A=16===r?st.hex:10===r?st.dec:8===r?st.oct:st.bin,d=!1,h=0;for(let I=0,p=null!==s&&void 0!==s?s:1/0;I<p;++I){let s,g=e.charCodeAt(t);if(95!==g||"bail"===a){if(s=g>=97?g-97+10:g>=65?g-65+10:it(g)?g-48:1/0,s>=r){if(s<=9&&c)return{n:null,pos:t};if(s<=9&&l.invalidDigit(t,n,i,r))s=0;else{if(!o)break;s=0,d=!0}}++t,h=h*r+s}else{let r=e.charCodeAt(t-1),s=e.charCodeAt(t+1);if(a){if(Number.isNaN(s)||!A(s)||u.has(r)||u.has(s)){if(c)return{n:null,pos:t};l.unexpectedNumericSeparator(t,n,i)}}else{if(c)return{n:null,pos:t};l.numericSeparatorInEscapeSequence(t,n,i)}++t}}return t===g||null!=s&&t-g!==s||d?{n:null,pos:t}:{n:h,pos:t}}function ut(e,t,n,i,r,s){let o;if(123===e.charCodeAt(t)){if(++t,({code:o,pos:t}=ct(e,t,n,i,e.indexOf("}",t)-t,!0,r,s)),++t,null!==o&&o>1114111){if(!r)return{code:null,pos:t};s.invalidCodePoint(t,n,i)}}else({code:o,pos:t}=ct(e,t,n,i,4,!1,r,s));return{code:o,pos:t}}function At(e,t,n){return new c(n,e-t,e)}var dt=new Set([103,109,115,105,121,117,100,118]),ht=class{constructor(e){this.type=e.type,this.value=e.value,this.start=e.start,this.end=e.end,this.loc=new g(e.startLoc,e.endLoc)}},It=class extends _e{constructor(e,t){super(),this.isLookahead=void 0,this.tokens=[],this.errorHandlers_readInt={invalidDigit:(e,t,n,i)=>!!this.options.errorRecovery&&(this.raise(G.InvalidDigit,At(e,t,n),{radix:i}),!0),numericSeparatorInEscapeSequence:this.errorBuilder(G.NumericSeparatorInEscapeSequence),unexpectedNumericSeparator:this.errorBuilder(G.UnexpectedNumericSeparator)},this.errorHandlers_readCodePoint=Object.assign({},this.errorHandlers_readInt,{invalidEscapeSequence:this.errorBuilder(G.InvalidEscapeSequence),invalidCodePoint:this.errorBuilder(G.InvalidCodePoint)}),this.errorHandlers_readStringContents_string=Object.assign({},this.errorHandlers_readCodePoint,{strictNumericEscape:(e,t,n)=>{this.recordStrictModeErrors(G.StrictNumericEscape,At(e,t,n))},unterminated:(e,t,n)=>{throw this.raise(G.UnterminatedString,At(e-1,t,n))}}),this.errorHandlers_readStringContents_template=Object.assign({},this.errorHandlers_readCodePoint,{strictNumericEscape:this.errorBuilder(G.StrictNumericEscape),unterminated:(e,t,n)=>{throw this.raise(G.UnterminatedTemplate,At(e,t,n))}}),this.state=new nt,this.state.init(e),this.input=t,this.length=t.length,this.comments=[],this.isLookahead=!1}pushToken(e){this.tokens.length=this.state.tokensLength,this.tokens.push(e),++this.state.tokensLength}next(){this.checkKeywordEscapes(),this.options.tokens&&this.pushToken(new ht(this.state)),this.state.lastTokEndLoc=this.state.endLoc,this.state.lastTokStartLoc=this.state.startLoc,this.nextToken()}eat(e){return!!this.match(e)&&(this.next(),!0)}match(e){return this.state.type===e}createLookaheadState(e){return{pos:e.pos,value:null,type:e.type,start:e.start,end:e.end,context:[this.curContext()],inType:e.inType,startLoc:e.startLoc,lastTokEndLoc:e.lastTokEndLoc,curLine:e.curLine,lineStart:e.lineStart,curPosition:e.curPosition}}lookahead(){let e=this.state;this.state=this.createLookaheadState(e),this.isLookahead=!0,this.nextToken(),this.isLookahead=!1;let t=this.state;return this.state=e,t}nextTokenStart(){return this.nextTokenStartSince(this.state.pos)}nextTokenStartSince(e){return qe.lastIndex=e,qe.test(this.input)?qe.lastIndex:e}lookaheadCharCode(){return this.input.charCodeAt(this.nextTokenStart())}nextTokenInLineStart(){return this.nextTokenInLineStartSince(this.state.pos)}nextTokenInLineStartSince(e){return $e.lastIndex=e,$e.test(this.input)?$e.lastIndex:e}lookaheadInLineCharCode(){return this.input.charCodeAt(this.nextTokenInLineStart())}codePointAtPos(e){let t=this.input.charCodeAt(e);if(55296===(64512&t)&&++e<this.input.length){let n=this.input.charCodeAt(e);56320===(64512&n)&&(t=65536+((1023&t)<<10)+(1023&n))}return t}setStrict(e){this.state.strict=e,e&&(this.state.strictErrors.forEach((e=>{let[t,n]=e;return this.raise(t,n)})),this.state.strictErrors.clear())}curContext(){return this.state.context[this.state.context.length-1]}nextToken(){this.skipSpace(),this.state.start=this.state.pos,this.isLookahead||(this.state.startLoc=this.state.curPosition()),this.state.pos>=this.length?this.finishToken(139):this.getTokenFromCode(this.codePointAtPos(this.state.pos))}skipBlockComment(e){let t;this.isLookahead||(t=this.state.curPosition());let n=this.state.pos,i=this.input.indexOf(e,n+2);if(-1===i)throw this.raise(G.UnterminatedComment,this.state.curPosition());for(this.state.pos=i+e.length,Je.lastIndex=n+2;Je.test(this.input)&&Je.lastIndex<=i;)++this.state.curLine,this.state.lineStart=Je.lastIndex;if(this.isLookahead)return;let r={type:"CommentBlock",value:this.input.slice(n+2,i),start:n,end:i+e.length,loc:new g(t,this.state.curPosition())};return this.options.tokens&&this.pushToken(r),r}skipLineComment(e){let t,n=this.state.pos;this.isLookahead||(t=this.state.curPosition());let i=this.input.charCodeAt(this.state.pos+=e);if(this.state.pos<this.length)for(;!je(i)&&++this.state.pos<this.length;)i=this.input.charCodeAt(this.state.pos);if(this.isLookahead)return;let r=this.state.pos,s={type:"CommentLine",value:this.input.slice(n+e,r),start:n,end:r,loc:new g(t,this.state.curPosition())};return this.options.tokens&&this.pushToken(s),s}skipSpace(){let e=this.state.pos,t=[];e:for(;this.state.pos<this.length;){let n=this.input.charCodeAt(this.state.pos);switch(n){case 32:case 160:case 9:++this.state.pos;break;case 13:10===this.input.charCodeAt(this.state.pos+1)&&++this.state.pos;case 10:case 8232:case 8233:++this.state.pos,++this.state.curLine,this.state.lineStart=this.state.pos;break;case 47:switch(this.input.charCodeAt(this.state.pos+1)){case 42:{let e=this.skipBlockComment("*/");void 0!==e&&(this.addComment(e),this.options.attachComment&&t.push(e));break}case 47:{let e=this.skipLineComment(2);void 0!==e&&(this.addComment(e),this.options.attachComment&&t.push(e));break}default:break e}break;default:if(tt(n))++this.state.pos;else if(45===n&&!this.inModule&&this.options.annexB){let n=this.state.pos;if(45!==this.input.charCodeAt(n+1)||62!==this.input.charCodeAt(n+2)||!(0===e||this.state.lineStart>e))break e;{let e=this.skipLineComment(3);void 0!==e&&(this.addComment(e),this.options.attachComment&&t.push(e))}}else{if(60!==n||this.inModule||!this.options.annexB)break e;{let e=this.state.pos;if(33!==this.input.charCodeAt(e+1)||45!==this.input.charCodeAt(e+2)||45!==this.input.charCodeAt(e+3))break e;{let e=this.skipLineComment(4);void 0!==e&&(this.addComment(e),this.options.attachComment&&t.push(e))}}}}}if(t.length>0){let n={start:e,end:this.state.pos,comments:t,leadingNode:null,trailingNode:null,containingNode:null};this.state.commentStack.push(n)}}finishToken(e,t){this.state.end=this.state.pos,this.state.endLoc=this.state.curPosition();let n=this.state.type;this.state.type=e,this.state.value=t,this.isLookahead||this.updateContext(n)}replaceToken(e){this.state.type=e,this.updateContext()}readToken_numberSign(){if(0===this.state.pos&&this.readToken_interpreter())return;let e=this.state.pos+1,t=this.codePointAtPos(e);if(t>=48&&t<=57)throw this.raise(G.UnexpectedDigitAfterHash,this.state.curPosition());if(123===t||91===t&&this.hasPlugin("recordAndTuple")){if(this.expectPlugin("recordAndTuple"),"bar"===this.getPluginOption("recordAndTuple","syntaxType"))throw this.raise(123===t?G.RecordExpressionHashIncorrectStartSyntaxType:G.TupleExpressionHashIncorrectStartSyntaxType,this.state.curPosition());this.state.pos+=2,123===t?this.finishToken(7):this.finishToken(1)}else Ge(t)?(++this.state.pos,this.finishToken(138,this.readWord1(t))):92===t?(++this.state.pos,this.finishToken(138,this.readWord1())):this.finishOp(27,1)}readToken_dot(){let e=this.input.charCodeAt(this.state.pos+1);e>=48&&e<=57?this.readNumber(!0):46===e&&46===this.input.charCodeAt(this.state.pos+2)?(this.state.pos+=3,this.finishToken(21)):(++this.state.pos,this.finishToken(16))}readToken_slash(){61===this.input.charCodeAt(this.state.pos+1)?this.finishOp(31,2):this.finishOp(56,1)}readToken_interpreter(){if(0!==this.state.pos||this.length<2)return!1;let e=this.input.charCodeAt(this.state.pos+1);if(33!==e)return!1;let t=this.state.pos;for(this.state.pos+=1;!je(e)&&++this.state.pos<this.length;)e=this.input.charCodeAt(this.state.pos);let n=this.input.slice(t+2,this.state.pos);return this.finishToken(28,n),!0}readToken_mult_modulo(e){let t=42===e?55:54,n=1,i=this.input.charCodeAt(this.state.pos+1);42===e&&42===i&&(n++,i=this.input.charCodeAt(this.state.pos+2),t=57),61===i&&!this.state.inType&&(n++,t=37===e?33:30),this.finishOp(t,n)}readToken_pipe_amp(e){let t=this.input.charCodeAt(this.state.pos+1);if(t!==e){if(124===e){if(62===t)return void this.finishOp(39,2);if(this.hasPlugin("recordAndTuple")&&125===t){if("bar"!==this.getPluginOption("recordAndTuple","syntaxType"))throw this.raise(G.RecordExpressionBarIncorrectEndSyntaxType,this.state.curPosition());return this.state.pos+=2,void this.finishToken(9)}if(this.hasPlugin("recordAndTuple")&&93===t){if("bar"!==this.getPluginOption("recordAndTuple","syntaxType"))throw this.raise(G.TupleExpressionBarIncorrectEndSyntaxType,this.state.curPosition());return this.state.pos+=2,void this.finishToken(4)}}61!==t?this.finishOp(124===e?43:45,1):this.finishOp(30,2)}else 61===this.input.charCodeAt(this.state.pos+2)?this.finishOp(30,3):this.finishOp(124===e?41:42,2)}readToken_caret(){let e=this.input.charCodeAt(this.state.pos+1);61!==e||this.state.inType?94===e&&this.hasPlugin(["pipelineOperator",{proposal:"hack",topicToken:"^^"}])?(this.finishOp(37,2),94===this.input.codePointAt(this.state.pos)&&this.unexpected()):this.finishOp(44,1):this.finishOp(32,2)}readToken_atSign(){64===this.input.charCodeAt(this.state.pos+1)&&this.hasPlugin(["pipelineOperator",{proposal:"hack",topicToken:"@@"}])?this.finishOp(38,2):this.finishOp(26,1)}readToken_plus_min(e){let t=this.input.charCodeAt(this.state.pos+1);t!==e?61===t?this.finishOp(30,2):this.finishOp(53,1):this.finishOp(34,2)}readToken_lt(){let{pos:e}=this.state,t=this.input.charCodeAt(e+1);if(60===t)return 61===this.input.charCodeAt(e+2)?void this.finishOp(30,3):void this.finishOp(51,2);61!==t?this.finishOp(47,1):this.finishOp(49,2)}readToken_gt(){let{pos:e}=this.state,t=this.input.charCodeAt(e+1);if(62===t){let t=62===this.input.charCodeAt(e+2)?3:2;return 61===this.input.charCodeAt(e+t)?void this.finishOp(30,t+1):void this.finishOp(52,t)}61!==t?this.finishOp(48,1):this.finishOp(49,2)}readToken_eq_excl(e){let t=this.input.charCodeAt(this.state.pos+1);if(61!==t)return 61===e&&62===t?(this.state.pos+=2,void this.finishToken(19)):void this.finishOp(61===e?29:35,1);this.finishOp(46,61===this.input.charCodeAt(this.state.pos+2)?3:2)}readToken_question(){let e=this.input.charCodeAt(this.state.pos+1),t=this.input.charCodeAt(this.state.pos+2);63===e?61===t?this.finishOp(30,3):this.finishOp(40,2):46!==e||t>=48&&t<=57?(++this.state.pos,this.finishToken(17)):(this.state.pos+=2,this.finishToken(18))}getTokenFromCode(e){switch(e){case 46:return void this.readToken_dot();case 40:return++this.state.pos,void this.finishToken(10);case 41:return++this.state.pos,void this.finishToken(11);case 59:return++this.state.pos,void this.finishToken(13);case 44:return++this.state.pos,void this.finishToken(12);case 91:if(this.hasPlugin("recordAndTuple")&&124===this.input.charCodeAt(this.state.pos+1)){if("bar"!==this.getPluginOption("recordAndTuple","syntaxType"))throw this.raise(G.TupleExpressionBarIncorrectStartSyntaxType,this.state.curPosition());this.state.pos+=2,this.finishToken(2)}else++this.state.pos,this.finishToken(0);return;case 93:return++this.state.pos,void this.finishToken(3);case 123:if(this.hasPlugin("recordAndTuple")&&124===this.input.charCodeAt(this.state.pos+1)){if("bar"!==this.getPluginOption("recordAndTuple","syntaxType"))throw this.raise(G.RecordExpressionBarIncorrectStartSyntaxType,this.state.curPosition());this.state.pos+=2,this.finishToken(6)}else++this.state.pos,this.finishToken(5);return;case 125:return++this.state.pos,void this.finishToken(8);case 58:return void(this.hasPlugin("functionBind")&&58===this.input.charCodeAt(this.state.pos+1)?this.finishOp(15,2):(++this.state.pos,this.finishToken(14)));case 63:return void this.readToken_question();case 96:return void this.readTemplateToken();case 48:{let e=this.input.charCodeAt(this.state.pos+1);if(120===e||88===e)return void this.readRadixNumber(16);if(111===e||79===e)return void this.readRadixNumber(8);if(98===e||66===e)return void this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return void this.readNumber(!1);case 34:case 39:return void this.readString(e);case 47:return void this.readToken_slash();case 37:case 42:return void this.readToken_mult_modulo(e);case 124:case 38:return void this.readToken_pipe_amp(e);case 94:return void this.readToken_caret();case 43:case 45:return void this.readToken_plus_min(e);case 60:return void this.readToken_lt();case 62:return void this.readToken_gt();case 61:case 33:return void this.readToken_eq_excl(e);case 126:return void this.finishOp(36,1);case 64:return void this.readToken_atSign();case 35:return void this.readToken_numberSign();case 92:return void this.readWord();default:if(Ge(e))return void this.readWord(e)}throw this.raise(G.InvalidOrUnexpectedToken,this.state.curPosition(),{unexpected:String.fromCodePoint(e)})}finishOp(e,t){let n=this.input.slice(this.state.pos,this.state.pos+t);this.state.pos+=t,this.finishToken(e,n)}readRegexp(){let e,t,n=this.state.startLoc,i=this.state.start+1,{pos:r}=this.state;for(;;++r){if(r>=this.length)throw this.raise(G.UnterminatedRegExp,u(n,1));let i=this.input.charCodeAt(r);if(je(i))throw this.raise(G.UnterminatedRegExp,u(n,1));if(e)e=!1;else{if(91===i)t=!0;else if(93===i&&t)t=!1;else if(47===i&&!t)break;e=92===i}}let s=this.input.slice(i,r);++r;let o="",a=()=>u(n,r+2-i);for(;r<this.length;){let e=this.codePointAtPos(r),t=String.fromCharCode(e);if(dt.has(e))118===e?o.includes("u")&&this.raise(G.IncompatibleRegExpUVFlags,a()):117===e&&o.includes("v")&&this.raise(G.IncompatibleRegExpUVFlags,a()),o.includes(t)&&this.raise(G.DuplicateRegExpFlags,a());else{if(!Ee(e)&&92!==e)break;this.raise(G.MalformedRegExpFlags,a())}++r,o+=t}this.state.pos=r,this.finishToken(137,{pattern:s,flags:o})}readInt(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],{n:r,pos:s}=gt(this.input,this.state.pos,this.state.lineStart,this.state.curLine,e,t,n,i,this.errorHandlers_readInt,!1);return this.state.pos=s,r}readRadixNumber(e){let t=this.state.curPosition(),n=!1;this.state.pos+=2;let i=this.readInt(e);null==i&&this.raise(G.InvalidDigit,u(t,2),{radix:e});let r=this.input.charCodeAt(this.state.pos);if(110===r)++this.state.pos,n=!0;else if(109===r)throw this.raise(G.InvalidDecimal,t);if(Ge(this.codePointAtPos(this.state.pos)))throw this.raise(G.NumberIdentifier,this.state.curPosition());if(n){let e=this.input.slice(t.index,this.state.pos).replace(/[_n]/g,"");this.finishToken(135,e)}else this.finishToken(134,i)}readNumber(e){let t=this.state.pos,n=this.state.curPosition(),i=!1,r=!1,s=!1,o=!1,a=!1;!e&&null===this.readInt(10)&&this.raise(G.InvalidNumber,this.state.curPosition());let l=this.state.pos-t>=2&&48===this.input.charCodeAt(t);if(l){let e=this.input.slice(t,this.state.pos);if(this.recordStrictModeErrors(G.StrictOctalLiteral,n),!this.state.strict){let t=e.indexOf("_");t>0&&this.raise(G.ZeroDigitNumericSeparator,u(n,t))}a=l&&!/[89]/.test(e)}let c=this.input.charCodeAt(this.state.pos);if(46===c&&!a&&(++this.state.pos,this.readInt(10),i=!0,c=this.input.charCodeAt(this.state.pos)),(69===c||101===c)&&!a&&(c=this.input.charCodeAt(++this.state.pos),(43===c||45===c)&&++this.state.pos,null===this.readInt(10)&&this.raise(G.InvalidOrMissingExponent,n),i=!0,o=!0,c=this.input.charCodeAt(this.state.pos)),110===c&&((i||l)&&this.raise(G.InvalidBigIntLiteral,n),++this.state.pos,r=!0),109===c&&(this.expectPlugin("decimal",this.state.curPosition()),(o||l)&&this.raise(G.InvalidDecimal,n),++this.state.pos,s=!0),Ge(this.codePointAtPos(this.state.pos)))throw this.raise(G.NumberIdentifier,this.state.curPosition());let g=this.input.slice(t,this.state.pos).replace(/[_mn]/g,"");if(r)return void this.finishToken(135,g);if(s)return void this.finishToken(136,g);let A=a?parseInt(g,8):parseFloat(g);this.finishToken(134,A)}readCodePoint(e){let{code:t,pos:n}=ut(this.input,this.state.pos,this.state.lineStart,this.state.curLine,e,this.errorHandlers_readCodePoint);return this.state.pos=n,t}readString(e){let{str:t,pos:n,curLine:i,lineStart:r}=ot(34===e?"double":"single",this.input,this.state.pos+1,this.state.lineStart,this.state.curLine,this.errorHandlers_readStringContents_string);this.state.pos=n+1,this.state.lineStart=r,this.state.curLine=i,this.finishToken(133,t)}readTemplateContinuation(){this.match(8)||this.unexpected(null,8),this.state.pos--,this.readTemplateToken()}readTemplateToken(){let e=this.input[this.state.pos],{str:t,firstInvalidLoc:n,pos:i,curLine:r,lineStart:s}=ot("template",this.input,this.state.pos+1,this.state.lineStart,this.state.curLine,this.errorHandlers_readStringContents_template);this.state.pos=i+1,this.state.lineStart=s,this.state.curLine=r,n&&(this.state.firstInvalidTemplateEscapePos=new c(n.curLine,n.pos-n.lineStart,n.pos)),96===this.input.codePointAt(i)?this.finishToken(24,n?null:e+t+"`"):(this.state.pos++,this.finishToken(25,n?null:e+t+"${"))}recordStrictModeErrors(e,t){let n=t.index;this.state.strict&&!this.state.strictErrors.has(n)?this.raise(e,t):this.state.strictErrors.set(n,[e,t])}readWord1(e){this.state.containsEsc=!1;let t="",n=this.state.pos,i=this.state.pos;for(void 0!==e&&(this.state.pos+=e<=65535?1:2);this.state.pos<this.length;){let e=this.codePointAtPos(this.state.pos);if(Ee(e))this.state.pos+=e<=65535?1:2;else{if(92!==e)break;{this.state.containsEsc=!0,t+=this.input.slice(i,this.state.pos);let e=this.state.curPosition(),r=this.state.pos===n?Ge:Ee;if(117!==this.input.charCodeAt(++this.state.pos)){this.raise(G.MissingUnicodeEscape,this.state.curPosition()),i=this.state.pos-1;continue}++this.state.pos;let s=this.readCodePoint(!0);null!==s&&(r(s)||this.raise(G.EscapedCharNotAnIdentifier,e),t+=String.fromCodePoint(s)),i=this.state.pos}}}return t+this.input.slice(i,this.state.pos)}readWord(e){let t=this.readWord1(e),n=L.get(t);void 0!==n?this.finishToken(n,de(n)):this.finishToken(132,t)}checkKeywordEscapes(){let{type:e}=this.state;ae(e)&&this.state.containsEsc&&this.raise(G.InvalidEscapedReservedWord,this.state.startLoc,{reservedWord:de(e)})}raise(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=e(t instanceof c?t:t.loc.start,n);if(!this.options.errorRecovery)throw i;return this.isLookahead||this.state.errors.push(i),i}raiseOverwrite(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=t instanceof c?t:t.loc.start,r=i.index,s=this.state.errors;for(let o=s.length-1;o>=0;o--){let t=s[o];if(t.loc.index===r)return s[o]=e(i,n);if(t.loc.index<r)break}return this.raise(e,t,n)}updateContext(e){}unexpected(e,t){throw this.raise(G.UnexpectedToken,null!==e&&void 0!==e?e:this.state.startLoc,{expected:t?de(t):null})}expectPlugin(e,t){if(this.hasPlugin(e))return!0;throw this.raise(G.MissingPlugin,null!==t&&void 0!==t?t:this.state.startLoc,{missingPlugin:[e]})}expectOnePlugin(e){if(!e.some((e=>this.hasPlugin(e))))throw this.raise(G.MissingOneOfPlugins,this.state.startLoc,{missingPlugin:e})}errorBuilder(e){return(t,n,i)=>{this.raise(e,At(t,n,i))}}},pt=class{constructor(){this.privateNames=new Set,this.loneAccessors=new Map,this.undefinedPrivateNames=new Map}},Ct=class{constructor(e){this.parser=void 0,this.stack=[],this.undefinedPrivateNames=new Map,this.parser=e}current(){return this.stack[this.stack.length-1]}enter(){this.stack.push(new pt)}exit(){let e=this.stack.pop(),t=this.current();for(let[n,i]of Array.from(e.undefinedPrivateNames))t?t.undefinedPrivateNames.has(n)||t.undefinedPrivateNames.set(n,i):this.parser.raise(G.InvalidPrivateFieldResolution,i,{identifierName:n})}declarePrivateName(e,t,n){let{privateNames:i,loneAccessors:r,undefinedPrivateNames:s}=this.current(),o=i.has(e);if(3&t){let n=o&&r.get(e);n?(o=(3&n)===(3&t)||(4&n)!==(4&t),o||r.delete(e)):o||r.set(e,t)}o&&this.parser.raise(G.PrivateNameRedeclaration,n,{identifierName:e}),i.add(e),s.delete(e)}usePrivateName(e,t){let n;for(n of this.stack)if(n.privateNames.has(e))return;n?n.undefinedPrivateNames.set(e,t):this.parser.raise(G.InvalidPrivateFieldResolution,t,{identifierName:e})}},mt=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.type=e}canBeArrowParameterDeclaration(){return 2===this.type||1===this.type}isCertainlyParameterDeclaration(){return 3===this.type}},ft=class extends mt{constructor(e){super(e),this.declarationErrors=new Map}recordDeclarationError(e,t){let n=t.index;this.declarationErrors.set(n,[e,t])}clearDeclarationError(e){this.declarationErrors.delete(e)}iterateErrors(e){this.declarationErrors.forEach(e)}},yt=class{constructor(e){this.parser=void 0,this.stack=[new mt],this.parser=e}enter(e){this.stack.push(e)}exit(){this.stack.pop()}recordParameterInitializerError(e,t){let n=t.loc.start,{stack:i}=this,r=i.length-1,s=i[r];for(;!s.isCertainlyParameterDeclaration();){if(!s.canBeArrowParameterDeclaration())return;s.recordDeclarationError(e,n),s=i[--r]}this.parser.raise(e,n)}recordArrowParameterBindingError(e,t){let{stack:n}=this,i=n[n.length-1],r=t.loc.start;if(i.isCertainlyParameterDeclaration())this.parser.raise(e,r);else{if(!i.canBeArrowParameterDeclaration())return;i.recordDeclarationError(e,r)}}recordAsyncArrowParametersError(e){let{stack:t}=this,n=t.length-1,i=t[n];for(;i.canBeArrowParameterDeclaration();)2===i.type&&i.recordDeclarationError(G.AwaitBindingIdentifier,e),i=t[--n]}validateAsPattern(){let{stack:e}=this,t=e[e.length-1];t.canBeArrowParameterDeclaration()&&t.iterateErrors((t=>{let[n,i]=t;this.parser.raise(n,i);let r=e.length-2,s=e[r];for(;s.canBeArrowParameterDeclaration();)s.clearDeclarationError(i.index),s=e[--r]}))}};function bt(){return new mt(3)}function Bt(){return new ft(1)}function vt(){return new ft(2)}function wt(){return new mt}var Gt=class{constructor(){this.stacks=[]}enter(e){this.stacks.push(e)}exit(){this.stacks.pop()}currentFlags(){return this.stacks[this.stacks.length-1]}get hasAwait(){return(2&this.currentFlags())>0}get hasYield(){return(1&this.currentFlags())>0}get hasReturn(){return(4&this.currentFlags())>0}get hasIn(){return(8&this.currentFlags())>0}};function Et(e,t){return(e?2:0)|(t?1:0)}var xt=class extends It{addExtra(e,t,n){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!e)return;let r=e.extra=e.extra||{};i?r[t]=n:Object.defineProperty(r,t,{enumerable:i,value:n})}isContextual(e){return this.state.type===e&&!this.state.containsEsc}isUnparsedContextual(e,t){let n=e+t.length;if(this.input.slice(e,n)===t){let e=this.input.charCodeAt(n);return!(Ee(e)||55296===(64512&e))}return!1}isLookaheadContextual(e){let t=this.nextTokenStart();return this.isUnparsedContextual(t,e)}eatContextual(e){return!!this.isContextual(e)&&(this.next(),!0)}expectContextual(e,t){if(!this.eatContextual(e)){if(null!=t)throw this.raise(t,this.state.startLoc);this.unexpected(null,e)}}canInsertSemicolon(){return this.match(139)||this.match(8)||this.hasPrecedingLineBreak()}hasPrecedingLineBreak(){return Oe.test(this.input.slice(this.state.lastTokEndLoc.index,this.state.start))}hasFollowingLineBreak(){return et.lastIndex=this.state.end,et.test(this.input)}isLineTerminator(){return this.eat(13)||this.canInsertSemicolon()}semicolon(){(arguments.length>0&&void 0!==arguments[0]&&!arguments[0]?this.eat(13):this.isLineTerminator())||this.raise(G.MissingSemicolon,this.state.lastTokEndLoc)}expect(e,t){this.eat(e)||this.unexpected(t,e)}tryParse(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state.clone(),i={node:null};try{let e=t((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;throw i.node=e,i}));if(this.state.errors.length>n.errors.length){let t=this.state;return this.state=n,this.state.tokensLength=t.tokensLength,{node:e,error:t.errors[n.errors.length],thrown:!1,aborted:!1,failState:t}}return{node:e,error:null,thrown:!1,aborted:!1,failState:null}}catch(e){let r=this.state;if(this.state=n,e instanceof SyntaxError)return{node:null,error:e,thrown:!0,aborted:!1,failState:r};if(e===i)return{node:i.node,error:null,thrown:!1,aborted:!0,failState:r};throw e}}checkExpressionErrors(e,t){if(!e)return!1;let{shorthandAssignLoc:n,doubleProtoLoc:i,privateKeyLoc:r,optionalParametersLoc:s}=e;if(!t)return!!n||!!i||!!s||!!r;null!=n&&this.raise(G.InvalidCoverInitializedName,n),null!=i&&this.raise(G.DuplicateProto,i),null!=r&&this.raise(G.UnexpectedPrivateField,r),null!=s&&this.unexpected(s)}isLiteralPropertyName(){return te(this.state.type)}isPrivateName(e){return"PrivateName"===e.type}getPrivateNameSV(e){return e.id.name}hasPropertyAsPrivateName(e){return("MemberExpression"===e.type||"OptionalMemberExpression"===e.type)&&this.isPrivateName(e.property)}isObjectProperty(e){return"ObjectProperty"===e.type}isObjectMethod(e){return"ObjectMethod"===e.type}initializeScopes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"module"===this.options.sourceType,t=this.state.labels;this.state.labels=[];let n=this.exportedIdentifiers;this.exportedIdentifiers=new Set;let i=this.inModule;this.inModule=e;let r=this.scope,s=this.getScopeHandler();this.scope=new s(this,e);let o=this.prodParam;this.prodParam=new Gt;let a=this.classScope;this.classScope=new Ct(this);let l=this.expressionScope;return this.expressionScope=new yt(this),()=>{this.state.labels=t,this.exportedIdentifiers=n,this.inModule=i,this.scope=r,this.prodParam=o,this.classScope=a,this.expressionScope=l}}enterInitialScopes(){let e=0;this.inModule&&(e|=2),this.scope.enter(1),this.prodParam.enter(e)}checkDestructuringPrivate(e){let{privateKeyLoc:t}=e;null!==t&&this.expectPlugin("destructuringPrivate",t)}},St=class{constructor(){this.shorthandAssignLoc=null,this.doubleProtoLoc=null,this.privateKeyLoc=null,this.optionalParametersLoc=null}},Rt=class{constructor(e,t,n){this.type="",this.start=t,this.end=0,this.loc=new g(n),null!=e&&e.options.ranges&&(this.range=[t,0]),null!=e&&e.filename&&(this.loc.filename=e.filename)}},Zt=Rt.prototype;function Dt(e){return Ft(e)}function Ft(e){let{type:t,start:n,end:i,loc:r,range:s,extra:o,name:a}=e,l=Object.create(Zt);return l.type=t,l.start=n,l.end=i,l.loc=r,l.range=s,l.extra=o,l.name=a,"Placeholder"===t&&(l.expectedNode=e.expectedNode),l}function Nt(e){let{type:t,start:n,end:i,loc:r,range:s,extra:o}=e;if("Placeholder"===t)return Dt(e);let a=Object.create(Zt);return a.type=t,a.start=n,a.end=i,a.loc=r,a.range=s,void 0!==e.raw?a.raw=e.raw:a.extra=o,a.value=e.value,a}Zt.__clone=function(){let e=new Rt(void 0,this.start,this.loc.start),t=Object.keys(this);for(let n=0,i=t.length;n<i;n++){let i=t[n];"leadingComments"!==i&&"trailingComments"!==i&&"innerComments"!==i&&(e[i]=this[i])}return e};var Mt=class extends xt{startNode(){let e=this.state.startLoc;return new Rt(this,e.index,e)}startNodeAt(e){return new Rt(this,e.index,e)}startNodeAtNode(e){return this.startNodeAt(e.loc.start)}finishNode(e,t){return this.finishNodeAt(e,t,this.state.lastTokEndLoc)}finishNodeAt(e,t,n){return e.type=t,e.end=n.index,e.loc.end=n,this.options.ranges&&(e.range[1]=n.index),this.options.attachComment&&this.processComment(e),e}resetStartLocation(e,t){e.start=t.index,e.loc.start=t,this.options.ranges&&(e.range[0]=t.index)}resetEndLocation(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state.lastTokEndLoc;e.end=t.index,e.loc.end=t,this.options.ranges&&(e.range[1]=t.index)}resetStartLocationFromNode(e,t){this.resetStartLocation(e,t.loc.start)}},Wt=new Set(["_","any","bool","boolean","empty","extends","false","interface","mixed","null","number","static","string","true","typeof","void"]),kt=w(r||(r=l(["flow"])))({AmbiguousConditionalArrow:"Ambiguous expression: wrap the arrow functions in parentheses to disambiguate.",AmbiguousDeclareModuleKind:"Found both `declare module.exports` and `declare export` in the same module. Modules can only have 1 since they are either an ES module or they are a CommonJS module.",AssignReservedType:e=>{let{reservedType:t}=e;return"Cannot overwrite reserved type ".concat(t,".")},DeclareClassElement:"The `declare` modifier can only appear on class fields.",DeclareClassFieldInitializer:"Initializers are not allowed in fields with the `declare` modifier.",DuplicateDeclareModuleExports:"Duplicate `declare module.exports` statement.",EnumBooleanMemberNotInitialized:e=>{let{memberName:t,enumName:n}=e;return"Boolean enum members need to be initialized. Use either `".concat(t," = true,` or `").concat(t," = false,` in enum `").concat(n,"`.")},EnumDuplicateMemberName:e=>{let{memberName:t,enumName:n}=e;return"Enum member names need to be unique, but the name `".concat(t,"` has already been used before in enum `").concat(n,"`.")},EnumInconsistentMemberValues:e=>{let{enumName:t}=e;return"Enum `".concat(t,"` has inconsistent member initializers. Either use no initializers, or consistently use literals (either booleans, numbers, or strings) for all member initializers.")},EnumInvalidExplicitType:e=>{let{invalidEnumType:t,enumName:n}=e;return"Enum type `".concat(t,"` is not valid. Use one of `boolean`, `number`, `string`, or `symbol` in enum `").concat(n,"`.")},EnumInvalidExplicitTypeUnknownSupplied:e=>{let{enumName:t}=e;return"Supplied enum type is not valid. Use one of `boolean`, `number`, `string`, or `symbol` in enum `".concat(t,"`.")},EnumInvalidMemberInitializerPrimaryType:e=>{let{enumName:t,memberName:n,explicitType:i}=e;return"Enum `".concat(t,"` has type `").concat(i,"`, so the initializer of `").concat(n,"` needs to be a ").concat(i," literal.")},EnumInvalidMemberInitializerSymbolType:e=>{let{enumName:t,memberName:n}=e;return"Symbol enum members cannot be initialized. Use `".concat(n,",` in enum `").concat(t,"`.")},EnumInvalidMemberInitializerUnknownType:e=>{let{enumName:t,memberName:n}=e;return"The enum member initializer for `".concat(n,"` needs to be a literal (either a boolean, number, or string) in enum `").concat(t,"`.")},EnumInvalidMemberName:e=>{let{enumName:t,memberName:n,suggestion:i}=e;return"Enum member names cannot start with lowercase 'a' through 'z'. Instead of using `".concat(n,"`, consider using `").concat(i,"`, in enum `").concat(t,"`.")},EnumNumberMemberNotInitialized:e=>{let{enumName:t,memberName:n}=e;return"Number enum members need to be initialized, e.g. `".concat(n," = 1` in enum `").concat(t,"`.")},EnumStringMemberInconsistentlyInitialized:e=>{let{enumName:t}=e;return"String enum members need to consistently either all use initializers, or use no initializers, in enum `".concat(t,"`.")},GetterMayNotHaveThisParam:"A getter cannot have a `this` parameter.",ImportReflectionHasImportType:"An `import module` declaration can not use `type` or `typeof` keyword.",ImportTypeShorthandOnlyInPureImport:"The `type` and `typeof` keywords on named imports can only be used on regular `import` statements. It cannot be used with `import type` or `import typeof` statements.",InexactInsideExact:"Explicit inexact syntax cannot appear inside an explicit exact object type.",InexactInsideNonObject:"Explicit inexact syntax cannot appear in class or interface definitions.",InexactVariance:"Explicit inexact syntax cannot have variance.",InvalidNonTypeImportInDeclareModule:"Imports within a `declare module` body must always be `import type` or `import typeof`.",MissingTypeParamDefault:"Type parameter declaration needs a default, since a preceding type parameter declaration has a default.",NestedDeclareModule:"`declare module` cannot be used inside another `declare module`.",NestedFlowComment:"Cannot have a flow comment inside another flow comment.",PatternIsOptional:Object.assign({message:"A binding pattern parameter cannot be optional in an implementation signature."},{reasonCode:"OptionalBindingPattern"}),SetterMayNotHaveThisParam:"A setter cannot have a `this` parameter.",SpreadVariance:"Spread properties cannot have variance.",ThisParamAnnotationRequired:"A type annotation is required for the `this` parameter.",ThisParamBannedInConstructor:"Constructors cannot have a `this` parameter; constructors don't bind `this` like other functions.",ThisParamMayNotBeOptional:"The `this` parameter cannot be optional.",ThisParamMustBeFirst:"The `this` parameter must be the first function parameter.",ThisParamNoDefault:"The `this` parameter may not have a default value.",TypeBeforeInitializer:"Type annotations must come before default assignments, e.g. instead of `age = 25: number` use `age: number = 25`.",TypeCastInPattern:"The type cast expression is expected to be wrapped with parenthesis.",UnexpectedExplicitInexactInObject:"Explicit inexact syntax must appear at the end of an inexact object.",UnexpectedReservedType:e=>{let{reservedType:t}=e;return"Unexpected reserved type ".concat(t,".")},UnexpectedReservedUnderscore:"`_` is only allowed as a type argument to call or new.",UnexpectedSpaceBetweenModuloChecks:"Spaces between `%` and `checks` are not allowed here.",UnexpectedSpreadType:"Spread operator cannot appear in class or interface definitions.",UnexpectedSubtractionOperand:'Unexpected token, expected "number" or "bigint".',UnexpectedTokenAfterTypeParameter:"Expected an arrow function after this type parameter declaration.",UnexpectedTypeParameterBeforeAsyncArrowFunction:"Type parameters must come after the async keyword, e.g. instead of `<T> async () => {}`, use `async <T>() => {}`.",UnsupportedDeclareExportKind:e=>{let{unsupportedExportKind:t,suggestion:n}=e;return"`declare export ".concat(t,"` is not supported. Use `").concat(n,"` instead.")},UnsupportedStatementInDeclareModule:"Only declares and type imports are allowed inside declare module.",UnterminatedFlowComment:"Unterminated flow-comment."});function Tt(e){return"DeclareExportAllDeclaration"===e.type||"DeclareExportDeclaration"===e.type&&(!e.declaration||"TypeAlias"!==e.declaration.type&&"InterfaceDeclaration"!==e.declaration.type)}function Vt(e){return"type"===e.importKind||"typeof"===e.importKind}var Lt={const:"declare export var",let:"declare export var",type:"export type",interface:"export interface"};function Ht(e,t){let n=[],i=[];for(let r=0;r<e.length;r++)(t(e[r],r,e)?n:i).push(e[r]);return[n,i]}var Qt=/\*?\s*@((?:no)?flow)\b/,Kt=e=>class extends e{constructor(){super(...arguments),this.flowPragma=void 0}getScopeHandler(){return Ke}shouldParseTypes(){return this.getPluginOption("flow","all")||"flow"===this.flowPragma}shouldParseEnums(){return!!this.getPluginOption("flow","enums")}finishToken(e,t){133!==e&&13!==e&&28!==e&&void 0===this.flowPragma&&(this.flowPragma=null),super.finishToken(e,t)}addComment(e){if(void 0===this.flowPragma){let t=Qt.exec(e.value);if(t)if("flow"===t[1])this.flowPragma="flow";else{if("noflow"!==t[1])throw new Error("Unexpected flow pragma");this.flowPragma="noflow"}}super.addComment(e)}flowParseTypeInitialiser(e){let t=this.state.inType;this.state.inType=!0,this.expect(e||14);let n=this.flowParseType();return this.state.inType=t,n}flowParsePredicate(){let e=this.startNode(),t=this.state.startLoc;return this.next(),this.expectContextual(110),this.state.lastTokStartLoc.index>t.index+1&&this.raise(kt.UnexpectedSpaceBetweenModuloChecks,t),this.eat(10)?(e.value=super.parseExpression(),this.expect(11),this.finishNode(e,"DeclaredPredicate")):this.finishNode(e,"InferredPredicate")}flowParseTypeAndPredicateInitialiser(){let e=this.state.inType;this.state.inType=!0,this.expect(14);let t=null,n=null;return this.match(54)?(this.state.inType=e,n=this.flowParsePredicate()):(t=this.flowParseType(),this.state.inType=e,this.match(54)&&(n=this.flowParsePredicate())),[t,n]}flowParseDeclareClass(e){return this.next(),this.flowParseInterfaceish(e,!0),this.finishNode(e,"DeclareClass")}flowParseDeclareFunction(e){this.next();let t=e.id=this.parseIdentifier(),n=this.startNode(),i=this.startNode();this.match(47)?n.typeParameters=this.flowParseTypeParameterDeclaration():n.typeParameters=null,this.expect(10);let r=this.flowParseFunctionTypeParams();return n.params=r.params,n.rest=r.rest,n.this=r._this,this.expect(11),[n.returnType,e.predicate]=this.flowParseTypeAndPredicateInitialiser(),i.typeAnnotation=this.finishNode(n,"FunctionTypeAnnotation"),t.typeAnnotation=this.finishNode(i,"TypeAnnotation"),this.resetEndLocation(t),this.semicolon(),this.scope.declareName(e.id.name,2048,e.id.loc.start),this.finishNode(e,"DeclareFunction")}flowParseDeclare(e,t){return this.match(80)?this.flowParseDeclareClass(e):this.match(68)?this.flowParseDeclareFunction(e):this.match(74)?this.flowParseDeclareVariable(e):this.eatContextual(127)?this.match(16)?this.flowParseDeclareModuleExports(e):(t&&this.raise(kt.NestedDeclareModule,this.state.lastTokStartLoc),this.flowParseDeclareModule(e)):this.isContextual(130)?this.flowParseDeclareTypeAlias(e):this.isContextual(131)?this.flowParseDeclareOpaqueType(e):this.isContextual(129)?this.flowParseDeclareInterface(e):this.match(82)?this.flowParseDeclareExportDeclaration(e,t):void this.unexpected()}flowParseDeclareVariable(e){return this.next(),e.id=this.flowParseTypeAnnotatableIdentifier(!0),this.scope.declareName(e.id.name,5,e.id.loc.start),this.semicolon(),this.finishNode(e,"DeclareVariable")}flowParseDeclareModule(e){this.scope.enter(0),this.match(133)?e.id=super.parseExprAtom():e.id=this.parseIdentifier();let t=e.body=this.startNode(),n=t.body=[];for(this.expect(5);!this.match(8);){let e=this.startNode();this.match(83)?(this.next(),!this.isContextual(130)&&!this.match(87)&&this.raise(kt.InvalidNonTypeImportInDeclareModule,this.state.lastTokStartLoc),super.parseImport(e)):(this.expectContextual(125,kt.UnsupportedStatementInDeclareModule),e=this.flowParseDeclare(e,!0)),n.push(e)}this.scope.exit(),this.expect(8),this.finishNode(t,"BlockStatement");let i=null,r=!1;return n.forEach((e=>{Tt(e)?("CommonJS"===i&&this.raise(kt.AmbiguousDeclareModuleKind,e),i="ES"):"DeclareModuleExports"===e.type&&(r&&this.raise(kt.DuplicateDeclareModuleExports,e),"ES"===i&&this.raise(kt.AmbiguousDeclareModuleKind,e),i="CommonJS",r=!0)})),e.kind=i||"CommonJS",this.finishNode(e,"DeclareModule")}flowParseDeclareExportDeclaration(e,t){if(this.expect(82),this.eat(65))return this.match(68)||this.match(80)?e.declaration=this.flowParseDeclare(this.startNode()):(e.declaration=this.flowParseType(),this.semicolon()),e.default=!0,this.finishNode(e,"DeclareExportDeclaration");if(this.match(75)||this.isLet()||(this.isContextual(130)||this.isContextual(129))&&!t){let e=this.state.value;throw this.raise(kt.UnsupportedDeclareExportKind,this.state.startLoc,{unsupportedExportKind:e,suggestion:Lt[e]})}return this.match(74)||this.match(68)||this.match(80)||this.isContextual(131)?(e.declaration=this.flowParseDeclare(this.startNode()),e.default=!1,this.finishNode(e,"DeclareExportDeclaration")):this.match(55)||this.match(5)||this.isContextual(129)||this.isContextual(130)||this.isContextual(131)?("ExportNamedDeclaration"===(e=this.parseExport(e,null)).type&&(e.type="ExportDeclaration",e.default=!1,delete e.exportKind),e.type="Declare"+e.type,e):void this.unexpected()}flowParseDeclareModuleExports(e){return this.next(),this.expectContextual(111),e.typeAnnotation=this.flowParseTypeAnnotation(),this.semicolon(),this.finishNode(e,"DeclareModuleExports")}flowParseDeclareTypeAlias(e){this.next();let t=this.flowParseTypeAlias(e);return t.type="DeclareTypeAlias",t}flowParseDeclareOpaqueType(e){this.next();let t=this.flowParseOpaqueType(e,!0);return t.type="DeclareOpaqueType",t}flowParseDeclareInterface(e){return this.next(),this.flowParseInterfaceish(e,!1),this.finishNode(e,"DeclareInterface")}flowParseInterfaceish(e,t){if(e.id=this.flowParseRestrictedIdentifier(!t,!0),this.scope.declareName(e.id.name,t?17:8201,e.id.loc.start),this.match(47)?e.typeParameters=this.flowParseTypeParameterDeclaration():e.typeParameters=null,e.extends=[],this.eat(81))do{e.extends.push(this.flowParseInterfaceExtends())}while(!t&&this.eat(12));if(t){if(e.implements=[],e.mixins=[],this.eatContextual(117))do{e.mixins.push(this.flowParseInterfaceExtends())}while(this.eat(12));if(this.eatContextual(113))do{e.implements.push(this.flowParseInterfaceExtends())}while(this.eat(12))}e.body=this.flowParseObjectType({allowStatic:t,allowExact:!1,allowSpread:!1,allowProto:t,allowInexact:!1})}flowParseInterfaceExtends(){let e=this.startNode();return e.id=this.flowParseQualifiedTypeIdentifier(),this.match(47)?e.typeParameters=this.flowParseTypeParameterInstantiation():e.typeParameters=null,this.finishNode(e,"InterfaceExtends")}flowParseInterface(e){return this.flowParseInterfaceish(e,!1),this.finishNode(e,"InterfaceDeclaration")}checkNotUnderscore(e){"_"===e&&this.raise(kt.UnexpectedReservedUnderscore,this.state.startLoc)}checkReservedType(e,t,n){Wt.has(e)&&this.raise(n?kt.AssignReservedType:kt.UnexpectedReservedType,t,{reservedType:e})}flowParseRestrictedIdentifier(e,t){return this.checkReservedType(this.state.value,this.state.startLoc,t),this.parseIdentifier(e)}flowParseTypeAlias(e){return e.id=this.flowParseRestrictedIdentifier(!1,!0),this.scope.declareName(e.id.name,8201,e.id.loc.start),this.match(47)?e.typeParameters=this.flowParseTypeParameterDeclaration():e.typeParameters=null,e.right=this.flowParseTypeInitialiser(29),this.semicolon(),this.finishNode(e,"TypeAlias")}flowParseOpaqueType(e,t){return this.expectContextual(130),e.id=this.flowParseRestrictedIdentifier(!0,!0),this.scope.declareName(e.id.name,8201,e.id.loc.start),this.match(47)?e.typeParameters=this.flowParseTypeParameterDeclaration():e.typeParameters=null,e.supertype=null,this.match(14)&&(e.supertype=this.flowParseTypeInitialiser(14)),e.impltype=null,t||(e.impltype=this.flowParseTypeInitialiser(29)),this.semicolon(),this.finishNode(e,"OpaqueType")}flowParseTypeParameter(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.state.startLoc,n=this.startNode(),i=this.flowParseVariance(),r=this.flowParseTypeAnnotatableIdentifier();return n.name=r.name,n.variance=i,n.bound=r.typeAnnotation,this.match(29)?(this.eat(29),n.default=this.flowParseType()):e&&this.raise(kt.MissingTypeParamDefault,t),this.finishNode(n,"TypeParameter")}flowParseTypeParameterDeclaration(){let e=this.state.inType,t=this.startNode();t.params=[],this.state.inType=!0,this.match(47)||this.match(142)?this.next():this.unexpected();let n=!1;do{let e=this.flowParseTypeParameter(n);t.params.push(e),e.default&&(n=!0),this.match(48)||this.expect(12)}while(!this.match(48));return this.expect(48),this.state.inType=e,this.finishNode(t,"TypeParameterDeclaration")}flowParseTypeParameterInstantiation(){let e=this.startNode(),t=this.state.inType;e.params=[],this.state.inType=!0,this.expect(47);let n=this.state.noAnonFunctionType;for(this.state.noAnonFunctionType=!1;!this.match(48);)e.params.push(this.flowParseType()),this.match(48)||this.expect(12);return this.state.noAnonFunctionType=n,this.expect(48),this.state.inType=t,this.finishNode(e,"TypeParameterInstantiation")}flowParseTypeParameterInstantiationCallOrNew(){let e=this.startNode(),t=this.state.inType;for(e.params=[],this.state.inType=!0,this.expect(47);!this.match(48);)e.params.push(this.flowParseTypeOrImplicitInstantiation()),this.match(48)||this.expect(12);return this.expect(48),this.state.inType=t,this.finishNode(e,"TypeParameterInstantiation")}flowParseInterfaceType(){let e=this.startNode();if(this.expectContextual(129),e.extends=[],this.eat(81))do{e.extends.push(this.flowParseInterfaceExtends())}while(this.eat(12));return e.body=this.flowParseObjectType({allowStatic:!1,allowExact:!1,allowSpread:!1,allowProto:!1,allowInexact:!1}),this.finishNode(e,"InterfaceTypeAnnotation")}flowParseObjectPropertyKey(){return this.match(134)||this.match(133)?super.parseExprAtom():this.parseIdentifier(!0)}flowParseObjectTypeIndexer(e,t,n){return e.static=t,14===this.lookahead().type?(e.id=this.flowParseObjectPropertyKey(),e.key=this.flowParseTypeInitialiser()):(e.id=null,e.key=this.flowParseType()),this.expect(3),e.value=this.flowParseTypeInitialiser(),e.variance=n,this.finishNode(e,"ObjectTypeIndexer")}flowParseObjectTypeInternalSlot(e,t){return e.static=t,e.id=this.flowParseObjectPropertyKey(),this.expect(3),this.expect(3),this.match(47)||this.match(10)?(e.method=!0,e.optional=!1,e.value=this.flowParseObjectTypeMethodish(this.startNodeAt(e.loc.start))):(e.method=!1,this.eat(17)&&(e.optional=!0),e.value=this.flowParseTypeInitialiser()),this.finishNode(e,"ObjectTypeInternalSlot")}flowParseObjectTypeMethodish(e){for(e.params=[],e.rest=null,e.typeParameters=null,e.this=null,this.match(47)&&(e.typeParameters=this.flowParseTypeParameterDeclaration()),this.expect(10),this.match(78)&&(e.this=this.flowParseFunctionTypeParam(!0),e.this.name=null,this.match(11)||this.expect(12));!this.match(11)&&!this.match(21);)e.params.push(this.flowParseFunctionTypeParam(!1)),this.match(11)||this.expect(12);return this.eat(21)&&(e.rest=this.flowParseFunctionTypeParam(!1)),this.expect(11),e.returnType=this.flowParseTypeInitialiser(),this.finishNode(e,"FunctionTypeAnnotation")}flowParseObjectTypeCallProperty(e,t){let n=this.startNode();return e.static=t,e.value=this.flowParseObjectTypeMethodish(n),this.finishNode(e,"ObjectTypeCallProperty")}flowParseObjectType(e){let{allowStatic:t,allowExact:n,allowSpread:i,allowProto:r,allowInexact:s}=e,o=this.state.inType;this.state.inType=!0;let a=this.startNode();a.callProperties=[],a.properties=[],a.indexers=[],a.internalSlots=[];let l,c,g=!1;for(n&&this.match(6)?(this.expect(6),l=9,c=!0):(this.expect(5),l=8,c=!1),a.exact=c;!this.match(l);){let e=!1,n=null,o=null,l=this.startNode();if(r&&this.isContextual(118)){let e=this.lookahead();14!==e.type&&17!==e.type&&(this.next(),n=this.state.startLoc,t=!1)}if(t&&this.isContextual(106)){let t=this.lookahead();14!==t.type&&17!==t.type&&(this.next(),e=!0)}let u=this.flowParseVariance();if(this.eat(0))null!=n&&this.unexpected(n),this.eat(0)?(u&&this.unexpected(u.loc.start),a.internalSlots.push(this.flowParseObjectTypeInternalSlot(l,e))):a.indexers.push(this.flowParseObjectTypeIndexer(l,e,u));else if(this.match(10)||this.match(47))null!=n&&this.unexpected(n),u&&this.unexpected(u.loc.start),a.callProperties.push(this.flowParseObjectTypeCallProperty(l,e));else{let t="init";(this.isContextual(99)||this.isContextual(104))&&te(this.lookahead().type)&&(t=this.state.value,this.next());let r=this.flowParseObjectTypeProperty(l,e,n,u,t,i,null!==s&&void 0!==s?s:!c);null===r?(g=!0,o=this.state.lastTokStartLoc):a.properties.push(r)}this.flowObjectTypeSemicolon(),o&&!this.match(8)&&!this.match(9)&&this.raise(kt.UnexpectedExplicitInexactInObject,o)}this.expect(l),i&&(a.inexact=g);let u=this.finishNode(a,"ObjectTypeAnnotation");return this.state.inType=o,u}flowParseObjectTypeProperty(e,t,n,i,r,s,o){if(this.eat(21))return this.match(12)||this.match(13)||this.match(8)||this.match(9)?(s?o||this.raise(kt.InexactInsideExact,this.state.lastTokStartLoc):this.raise(kt.InexactInsideNonObject,this.state.lastTokStartLoc),i&&this.raise(kt.InexactVariance,i),null):(s||this.raise(kt.UnexpectedSpreadType,this.state.lastTokStartLoc),null!=n&&this.unexpected(n),i&&this.raise(kt.SpreadVariance,i),e.argument=this.flowParseType(),this.finishNode(e,"ObjectTypeSpreadProperty"));{e.key=this.flowParseObjectPropertyKey(),e.static=t,e.proto=null!=n,e.kind=r;let o=!1;return this.match(47)||this.match(10)?(e.method=!0,null!=n&&this.unexpected(n),i&&this.unexpected(i.loc.start),e.value=this.flowParseObjectTypeMethodish(this.startNodeAt(e.loc.start)),("get"===r||"set"===r)&&this.flowCheckGetterSetterParams(e),!s&&"constructor"===e.key.name&&e.value.this&&this.raise(kt.ThisParamBannedInConstructor,e.value.this)):("init"!==r&&this.unexpected(),e.method=!1,this.eat(17)&&(o=!0),e.value=this.flowParseTypeInitialiser(),e.variance=i),e.optional=o,this.finishNode(e,"ObjectTypeProperty")}}flowCheckGetterSetterParams(e){let t="get"===e.kind?0:1,n=e.value.params.length+(e.value.rest?1:0);e.value.this&&this.raise("get"===e.kind?kt.GetterMayNotHaveThisParam:kt.SetterMayNotHaveThisParam,e.value.this),n!==t&&this.raise("get"===e.kind?G.BadGetterArity:G.BadSetterArity,e),"set"===e.kind&&e.value.rest&&this.raise(G.BadSetterRestParameter,e)}flowObjectTypeSemicolon(){!this.eat(13)&&!this.eat(12)&&!this.match(8)&&!this.match(9)&&this.unexpected()}flowParseQualifiedTypeIdentifier(e,t){null!=e||(e=this.state.startLoc);let n=t||this.flowParseRestrictedIdentifier(!0);for(;this.eat(16);){let t=this.startNodeAt(e);t.qualification=n,t.id=this.flowParseRestrictedIdentifier(!0),n=this.finishNode(t,"QualifiedTypeIdentifier")}return n}flowParseGenericType(e,t){let n=this.startNodeAt(e);return n.typeParameters=null,n.id=this.flowParseQualifiedTypeIdentifier(e,t),this.match(47)&&(n.typeParameters=this.flowParseTypeParameterInstantiation()),this.finishNode(n,"GenericTypeAnnotation")}flowParseTypeofType(){let e=this.startNode();return this.expect(87),e.argument=this.flowParsePrimaryType(),this.finishNode(e,"TypeofTypeAnnotation")}flowParseTupleType(){let e=this.startNode();for(e.types=[],this.expect(0);this.state.pos<this.length&&!this.match(3)&&(e.types.push(this.flowParseType()),!this.match(3));)this.expect(12);return this.expect(3),this.finishNode(e,"TupleTypeAnnotation")}flowParseFunctionTypeParam(e){let t=null,n=!1,i=null,r=this.startNode(),s=this.lookahead(),o=78===this.state.type;return 14===s.type||17===s.type?(o&&!e&&this.raise(kt.ThisParamMustBeFirst,r),t=this.parseIdentifier(o),this.eat(17)&&(n=!0,o&&this.raise(kt.ThisParamMayNotBeOptional,r)),i=this.flowParseTypeInitialiser()):i=this.flowParseType(),r.name=t,r.optional=n,r.typeAnnotation=i,this.finishNode(r,"FunctionTypeParam")}reinterpretTypeAsFunctionTypeParam(e){let t=this.startNodeAt(e.loc.start);return t.name=null,t.optional=!1,t.typeAnnotation=e,this.finishNode(t,"FunctionTypeParam")}flowParseFunctionTypeParams(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=null,n=null;for(this.match(78)&&(n=this.flowParseFunctionTypeParam(!0),n.name=null,this.match(11)||this.expect(12));!this.match(11)&&!this.match(21);)e.push(this.flowParseFunctionTypeParam(!1)),this.match(11)||this.expect(12);return this.eat(21)&&(t=this.flowParseFunctionTypeParam(!1)),{params:e,rest:t,_this:n}}flowIdentToTypeAnnotation(e,t,n){switch(n.name){case"any":return this.finishNode(t,"AnyTypeAnnotation");case"bool":case"boolean":return this.finishNode(t,"BooleanTypeAnnotation");case"mixed":return this.finishNode(t,"MixedTypeAnnotation");case"empty":return this.finishNode(t,"EmptyTypeAnnotation");case"number":return this.finishNode(t,"NumberTypeAnnotation");case"string":return this.finishNode(t,"StringTypeAnnotation");case"symbol":return this.finishNode(t,"SymbolTypeAnnotation");default:return this.checkNotUnderscore(n.name),this.flowParseGenericType(e,n)}}flowParsePrimaryType(){let e,t,n=this.state.startLoc,i=this.startNode(),r=!1,s=this.state.noAnonFunctionType;switch(this.state.type){case 5:return this.flowParseObjectType({allowStatic:!1,allowExact:!1,allowSpread:!0,allowProto:!1,allowInexact:!0});case 6:return this.flowParseObjectType({allowStatic:!1,allowExact:!0,allowSpread:!0,allowProto:!1,allowInexact:!1});case 0:return this.state.noAnonFunctionType=!1,t=this.flowParseTupleType(),this.state.noAnonFunctionType=s,t;case 47:{let t=this.startNode();return t.typeParameters=this.flowParseTypeParameterDeclaration(),this.expect(10),e=this.flowParseFunctionTypeParams(),t.params=e.params,t.rest=e.rest,t.this=e._this,this.expect(11),this.expect(19),t.returnType=this.flowParseType(),this.finishNode(t,"FunctionTypeAnnotation")}case 10:{let n=this.startNode();if(this.next(),!this.match(11)&&!this.match(21))if(q(this.state.type)||this.match(78)){let e=this.lookahead().type;r=17!==e&&14!==e}else r=!0;if(r){if(this.state.noAnonFunctionType=!1,t=this.flowParseType(),this.state.noAnonFunctionType=s,this.state.noAnonFunctionType||!(this.match(12)||this.match(11)&&19===this.lookahead().type))return this.expect(11),t;this.eat(12)}return e=t?this.flowParseFunctionTypeParams([this.reinterpretTypeAsFunctionTypeParam(t)]):this.flowParseFunctionTypeParams(),n.params=e.params,n.rest=e.rest,n.this=e._this,this.expect(11),this.expect(19),n.returnType=this.flowParseType(),n.typeParameters=null,this.finishNode(n,"FunctionTypeAnnotation")}case 133:return this.parseLiteral(this.state.value,"StringLiteralTypeAnnotation");case 85:case 86:return i.value=this.match(85),this.next(),this.finishNode(i,"BooleanLiteralTypeAnnotation");case 53:if("-"===this.state.value){if(this.next(),this.match(134))return this.parseLiteralAtNode(-this.state.value,"NumberLiteralTypeAnnotation",i);if(this.match(135))return this.parseLiteralAtNode(-this.state.value,"BigIntLiteralTypeAnnotation",i);throw this.raise(kt.UnexpectedSubtractionOperand,this.state.startLoc)}return void this.unexpected();case 134:return this.parseLiteral(this.state.value,"NumberLiteralTypeAnnotation");case 135:return this.parseLiteral(this.state.value,"BigIntLiteralTypeAnnotation");case 88:return this.next(),this.finishNode(i,"VoidTypeAnnotation");case 84:return this.next(),this.finishNode(i,"NullLiteralTypeAnnotation");case 78:return this.next(),this.finishNode(i,"ThisTypeAnnotation");case 55:return this.next(),this.finishNode(i,"ExistsTypeAnnotation");case 87:return this.flowParseTypeofType();default:if(ae(this.state.type)){let e=de(this.state.type);return this.next(),super.createIdentifier(i,e)}if(q(this.state.type))return this.isContextual(129)?this.flowParseInterfaceType():this.flowIdentToTypeAnnotation(n,i,this.parseIdentifier())}this.unexpected()}flowParsePostfixType(){let e=this.state.startLoc,t=this.flowParsePrimaryType(),n=!1;for(;(this.match(0)||this.match(18))&&!this.canInsertSemicolon();){let i=this.startNodeAt(e),r=this.eat(18);n=n||r,this.expect(0),!r&&this.match(3)?(i.elementType=t,this.next(),t=this.finishNode(i,"ArrayTypeAnnotation")):(i.objectType=t,i.indexType=this.flowParseType(),this.expect(3),n?(i.optional=r,t=this.finishNode(i,"OptionalIndexedAccessType")):t=this.finishNode(i,"IndexedAccessType"))}return t}flowParsePrefixType(){let e=this.startNode();return this.eat(17)?(e.typeAnnotation=this.flowParsePrefixType(),this.finishNode(e,"NullableTypeAnnotation")):this.flowParsePostfixType()}flowParseAnonFunctionWithoutParens(){let e=this.flowParsePrefixType();if(!this.state.noAnonFunctionType&&this.eat(19)){let t=this.startNodeAt(e.loc.start);return t.params=[this.reinterpretTypeAsFunctionTypeParam(e)],t.rest=null,t.this=null,t.returnType=this.flowParseType(),t.typeParameters=null,this.finishNode(t,"FunctionTypeAnnotation")}return e}flowParseIntersectionType(){let e=this.startNode();this.eat(45);let t=this.flowParseAnonFunctionWithoutParens();for(e.types=[t];this.eat(45);)e.types.push(this.flowParseAnonFunctionWithoutParens());return 1===e.types.length?t:this.finishNode(e,"IntersectionTypeAnnotation")}flowParseUnionType(){let e=this.startNode();this.eat(43);let t=this.flowParseIntersectionType();for(e.types=[t];this.eat(43);)e.types.push(this.flowParseIntersectionType());return 1===e.types.length?t:this.finishNode(e,"UnionTypeAnnotation")}flowParseType(){let e=this.state.inType;this.state.inType=!0;let t=this.flowParseUnionType();return this.state.inType=e,t}flowParseTypeOrImplicitInstantiation(){if(132===this.state.type&&"_"===this.state.value){let e=this.state.startLoc,t=this.parseIdentifier();return this.flowParseGenericType(e,t)}return this.flowParseType()}flowParseTypeAnnotation(){let e=this.startNode();return e.typeAnnotation=this.flowParseTypeInitialiser(),this.finishNode(e,"TypeAnnotation")}flowParseTypeAnnotatableIdentifier(e){let t=e?this.parseIdentifier():this.flowParseRestrictedIdentifier();return this.match(14)&&(t.typeAnnotation=this.flowParseTypeAnnotation(),this.resetEndLocation(t)),t}typeCastToParameter(e){return e.expression.typeAnnotation=e.typeAnnotation,this.resetEndLocation(e.expression,e.typeAnnotation.loc.end),e.expression}flowParseVariance(){let e=null;return this.match(53)?(e=this.startNode(),"+"===this.state.value?e.kind="plus":e.kind="minus",this.next(),this.finishNode(e,"Variance")):e}parseFunctionBody(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t?this.forwardNoArrowParamsConversionAt(e,(()=>super.parseFunctionBody(e,!0,n))):super.parseFunctionBody(e,!1,n)}parseFunctionBodyAndFinish(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.match(14)){let t=this.startNode();[t.typeAnnotation,e.predicate]=this.flowParseTypeAndPredicateInitialiser(),e.returnType=t.typeAnnotation?this.finishNode(t,"TypeAnnotation"):null}return super.parseFunctionBodyAndFinish(e,t,n)}parseStatementLike(e){if(this.state.strict&&this.isContextual(129)){if(ee(this.lookahead().type)){let e=this.startNode();return this.next(),this.flowParseInterface(e)}}else if(this.shouldParseEnums()&&this.isContextual(126)){let e=this.startNode();return this.next(),this.flowParseEnumDeclaration(e)}let t=super.parseStatementLike(e);return void 0===this.flowPragma&&!this.isValidDirective(t)&&(this.flowPragma=null),t}parseExpressionStatement(e,t,n){if("Identifier"===t.type)if("declare"===t.name){if(this.match(80)||q(this.state.type)||this.match(68)||this.match(74)||this.match(82))return this.flowParseDeclare(e)}else if(q(this.state.type)){if("interface"===t.name)return this.flowParseInterface(e);if("type"===t.name)return this.flowParseTypeAlias(e);if("opaque"===t.name)return this.flowParseOpaqueType(e,!1)}return super.parseExpressionStatement(e,t,n)}shouldParseExportDeclaration(){let{type:e}=this.state;return se(e)||this.shouldParseEnums()&&126===e?!this.state.containsEsc:super.shouldParseExportDeclaration()}isExportDefaultSpecifier(){let{type:e}=this.state;return se(e)||this.shouldParseEnums()&&126===e?this.state.containsEsc:super.isExportDefaultSpecifier()}parseExportDefaultExpression(){if(this.shouldParseEnums()&&this.isContextual(126)){let e=this.startNode();return this.next(),this.flowParseEnumDeclaration(e)}return super.parseExportDefaultExpression()}parseConditional(e,t,n){if(!this.match(17))return e;if(this.state.maybeInArrowParameters){let t=this.lookaheadCharCode();if(44===t||61===t||58===t||41===t)return this.setOptionalParametersError(n),e}this.expect(17);let i=this.state.clone(),r=this.state.noArrowAt,s=this.startNodeAt(t),{consequent:o,failed:a}=this.tryParseConditionalConsequent(),[l,c]=this.getArrowLikeExpressions(o);if(a||c.length>0){let e=[...r];if(c.length>0){this.state=i,this.state.noArrowAt=e;for(let t=0;t<c.length;t++)e.push(c[t].start);({consequent:o,failed:a}=this.tryParseConditionalConsequent()),[l,c]=this.getArrowLikeExpressions(o)}a&&l.length>1&&this.raise(kt.AmbiguousConditionalArrow,i.startLoc),a&&1===l.length&&(this.state=i,e.push(l[0].start),this.state.noArrowAt=e,({consequent:o,failed:a}=this.tryParseConditionalConsequent()))}return this.getArrowLikeExpressions(o,!0),this.state.noArrowAt=r,this.expect(14),s.test=e,s.consequent=o,s.alternate=this.forwardNoArrowParamsConversionAt(s,(()=>this.parseMaybeAssign(void 0,void 0))),this.finishNode(s,"ConditionalExpression")}tryParseConditionalConsequent(){this.state.noArrowParamsConversionAt.push(this.state.start);let e=this.parseMaybeAssignAllowIn(),t=!this.match(14);return this.state.noArrowParamsConversionAt.pop(),{consequent:e,failed:t}}getArrowLikeExpressions(e,t){let n=[e],i=[];for(;0!==n.length;){let e=n.pop();"ArrowFunctionExpression"===e.type&&"BlockStatement"!==e.body.type?(e.typeParameters||!e.returnType?this.finishArrowValidation(e):i.push(e),n.push(e.body)):"ConditionalExpression"===e.type&&(n.push(e.consequent),n.push(e.alternate))}return t?(i.forEach((e=>this.finishArrowValidation(e))),[i,[]]):Ht(i,(e=>e.params.every((e=>this.isAssignable(e,!0)))))}finishArrowValidation(e){var t;this.toAssignableList(e.params,null==(t=e.extra)?void 0:t.trailingCommaLoc,!1),this.scope.enter(6),super.checkParams(e,!1,!0),this.scope.exit()}forwardNoArrowParamsConversionAt(e,t){let n;return this.state.noArrowParamsConversionAt.includes(e.start)?(this.state.noArrowParamsConversionAt.push(this.state.start),n=t(),this.state.noArrowParamsConversionAt.pop()):n=t(),n}parseParenItem(e,t){let n=super.parseParenItem(e,t);if(this.eat(17)&&(n.optional=!0,this.resetEndLocation(e)),this.match(14)){let e=this.startNodeAt(t);return e.expression=n,e.typeAnnotation=this.flowParseTypeAnnotation(),this.finishNode(e,"TypeCastExpression")}return n}assertModuleNodeAllowed(e){"ImportDeclaration"===e.type&&("type"===e.importKind||"typeof"===e.importKind)||"ExportNamedDeclaration"===e.type&&"type"===e.exportKind||"ExportAllDeclaration"===e.type&&"type"===e.exportKind||super.assertModuleNodeAllowed(e)}parseExportDeclaration(e){if(this.isContextual(130)){e.exportKind="type";let t=this.startNode();return this.next(),this.match(5)?(e.specifiers=this.parseExportSpecifiers(!0),super.parseExportFrom(e),null):this.flowParseTypeAlias(t)}if(this.isContextual(131)){e.exportKind="type";let t=this.startNode();return this.next(),this.flowParseOpaqueType(t,!1)}if(this.isContextual(129)){e.exportKind="type";let t=this.startNode();return this.next(),this.flowParseInterface(t)}if(this.shouldParseEnums()&&this.isContextual(126)){e.exportKind="value";let t=this.startNode();return this.next(),this.flowParseEnumDeclaration(t)}return super.parseExportDeclaration(e)}eatExportStar(e){return!!super.eatExportStar(e)||!(!this.isContextual(130)||55!==this.lookahead().type)&&(e.exportKind="type",this.next(),this.next(),!0)}maybeParseExportNamespaceSpecifier(e){let{startLoc:t}=this.state,n=super.maybeParseExportNamespaceSpecifier(e);return n&&"type"===e.exportKind&&this.unexpected(t),n}parseClassId(e,t,n){super.parseClassId(e,t,n),this.match(47)&&(e.typeParameters=this.flowParseTypeParameterDeclaration())}parseClassMember(e,t,n){let{startLoc:i}=this.state;if(this.isContextual(125)){if(super.parseClassMemberFromModifier(e,t))return;t.declare=!0}super.parseClassMember(e,t,n),t.declare&&("ClassProperty"!==t.type&&"ClassPrivateProperty"!==t.type&&"PropertyDefinition"!==t.type?this.raise(kt.DeclareClassElement,i):t.value&&this.raise(kt.DeclareClassFieldInitializer,t.value))}isIterator(e){return"iterator"===e||"asyncIterator"===e}readIterator(){let e=super.readWord1(),t="@@"+e;(!this.isIterator(e)||!this.state.inType)&&this.raise(G.InvalidIdentifier,this.state.curPosition(),{identifierName:t}),this.finishToken(132,t)}getTokenFromCode(e){let t=this.input.charCodeAt(this.state.pos+1);123===e&&124===t?this.finishOp(6,2):!this.state.inType||62!==e&&60!==e?this.state.inType&&63===e?46===t?this.finishOp(18,2):this.finishOp(17,1):ke(e,t,this.input.charCodeAt(this.state.pos+2))?(this.state.pos+=2,this.readIterator()):super.getTokenFromCode(e):this.finishOp(62===e?48:47,1)}isAssignable(e,t){return"TypeCastExpression"===e.type?this.isAssignable(e.expression,t):super.isAssignable(e,t)}toAssignable(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!t&&"AssignmentExpression"===e.type&&"TypeCastExpression"===e.left.type&&(e.left=this.typeCastToParameter(e.left)),super.toAssignable(e,t)}toAssignableList(e,t,n){for(let i=0;i<e.length;i++){let t=e[i];"TypeCastExpression"===(null==t?void 0:t.type)&&(e[i]=this.typeCastToParameter(t))}super.toAssignableList(e,t,n)}toReferencedList(e,t){for(let i=0;i<e.length;i++){var n;let r=e[i];r&&"TypeCastExpression"===r.type&&(null==(n=r.extra)||!n.parenthesized)&&(e.length>1||!t)&&this.raise(kt.TypeCastInPattern,r.typeAnnotation)}return e}parseArrayLike(e,t,n,i){let r=super.parseArrayLike(e,t,n,i);return t&&!this.state.maybeInArrowParameters&&this.toReferencedList(r.elements),r}isValidLVal(e,t,n){return"TypeCastExpression"===e||super.isValidLVal(e,t,n)}parseClassProperty(e){return this.match(14)&&(e.typeAnnotation=this.flowParseTypeAnnotation()),super.parseClassProperty(e)}parseClassPrivateProperty(e){return this.match(14)&&(e.typeAnnotation=this.flowParseTypeAnnotation()),super.parseClassPrivateProperty(e)}isClassMethod(){return this.match(47)||super.isClassMethod()}isClassProperty(){return this.match(14)||super.isClassProperty()}isNonstaticConstructor(e){return!this.match(14)&&super.isNonstaticConstructor(e)}pushClassMethod(e,t,n,i,r,s){if(t.variance&&this.unexpected(t.variance.loc.start),delete t.variance,this.match(47)&&(t.typeParameters=this.flowParseTypeParameterDeclaration()),super.pushClassMethod(e,t,n,i,r,s),t.params&&r){let e=t.params;e.length>0&&this.isThisParam(e[0])&&this.raise(kt.ThisParamBannedInConstructor,t)}else if("MethodDefinition"===t.type&&r&&t.value.params){let e=t.value.params;e.length>0&&this.isThisParam(e[0])&&this.raise(kt.ThisParamBannedInConstructor,t)}}pushClassPrivateMethod(e,t,n,i){t.variance&&this.unexpected(t.variance.loc.start),delete t.variance,this.match(47)&&(t.typeParameters=this.flowParseTypeParameterDeclaration()),super.pushClassPrivateMethod(e,t,n,i)}parseClassSuper(e){if(super.parseClassSuper(e),e.superClass&&this.match(47)&&(e.superTypeParameters=this.flowParseTypeParameterInstantiation()),this.isContextual(113)){this.next();let t=e.implements=[];do{let e=this.startNode();e.id=this.flowParseRestrictedIdentifier(!0),this.match(47)?e.typeParameters=this.flowParseTypeParameterInstantiation():e.typeParameters=null,t.push(this.finishNode(e,"ClassImplements"))}while(this.eat(12))}}checkGetterSetterParams(e){super.checkGetterSetterParams(e);let t=this.getObjectOrClassMethodParams(e);if(t.length>0){let n=t[0];this.isThisParam(n)&&"get"===e.kind?this.raise(kt.GetterMayNotHaveThisParam,n):this.isThisParam(n)&&this.raise(kt.SetterMayNotHaveThisParam,n)}}parsePropertyNamePrefixOperator(e){e.variance=this.flowParseVariance()}parseObjPropValue(e,t,n,i,r,s,o){let a;e.variance&&this.unexpected(e.variance.loc.start),delete e.variance,this.match(47)&&!s&&(a=this.flowParseTypeParameterDeclaration(),this.match(10)||this.unexpected());let l=super.parseObjPropValue(e,t,n,i,r,s,o);return a&&((l.value||l).typeParameters=a),l}parseAssignableListItemTypes(e){return this.eat(17)&&("Identifier"!==e.type&&this.raise(kt.PatternIsOptional,e),this.isThisParam(e)&&this.raise(kt.ThisParamMayNotBeOptional,e),e.optional=!0),this.match(14)?e.typeAnnotation=this.flowParseTypeAnnotation():this.isThisParam(e)&&this.raise(kt.ThisParamAnnotationRequired,e),this.match(29)&&this.isThisParam(e)&&this.raise(kt.ThisParamNoDefault,e),this.resetEndLocation(e),e}parseMaybeDefault(e,t){let n=super.parseMaybeDefault(e,t);return"AssignmentPattern"===n.type&&n.typeAnnotation&&n.right.start<n.typeAnnotation.start&&this.raise(kt.TypeBeforeInitializer,n.typeAnnotation),n}checkImportReflection(e){super.checkImportReflection(e),e.module&&"value"!==e.importKind&&this.raise(kt.ImportReflectionHasImportType,e.specifiers[0].loc.start)}parseImportSpecifierLocal(e,t,n){t.local=Vt(e)?this.flowParseRestrictedIdentifier(!0,!0):this.parseIdentifier(),e.specifiers.push(this.finishImportSpecifier(t,n))}isPotentialImportPhase(e){if(super.isPotentialImportPhase(e))return!0;if(this.isContextual(130)){if(!e)return!0;let t=this.lookaheadCharCode();return 123===t||42===t}return!e&&this.isContextual(87)}applyImportPhase(e,t,n,i){if(super.applyImportPhase(e,t,n,i),t){if(!n&&this.match(65))return;e.exportKind="type"===n?n:"value"}else"type"===n&&this.match(55)&&this.unexpected(),e.importKind="type"===n||"typeof"===n?n:"value"}parseImportSpecifier(e,t,n,i,r){let s=e.imported,o=null;"Identifier"===s.type&&("type"===s.name?o="type":"typeof"===s.name&&(o="typeof"));let a=!1;if(this.isContextual(93)&&!this.isLookaheadContextual("as")){let t=this.parseIdentifier(!0);null===o||ee(this.state.type)?(e.imported=s,e.importKind=null,e.local=this.parseIdentifier()):(e.imported=t,e.importKind=o,e.local=Ft(t))}else{if(null!==o&&ee(this.state.type))e.imported=this.parseIdentifier(!0),e.importKind=o;else{if(t)throw this.raise(G.ImportBindingIsString,e,{importName:s.value});e.imported=s,e.importKind=null}this.eatContextual(93)?e.local=this.parseIdentifier():(a=!0,e.local=Ft(e.imported))}let l=Vt(e);return n&&l&&this.raise(kt.ImportTypeShorthandOnlyInPureImport,e),(n||l)&&this.checkReservedType(e.local.name,e.local.loc.start,!0),a&&!n&&!l&&this.checkReservedWord(e.local.name,e.loc.start,!0,!0),this.finishImportSpecifier(e,"ImportSpecifier")}parseBindingAtom(){return 78===this.state.type?this.parseIdentifier(!0):super.parseBindingAtom()}parseFunctionParams(e,t){let n=e.kind;"get"!==n&&"set"!==n&&this.match(47)&&(e.typeParameters=this.flowParseTypeParameterDeclaration()),super.parseFunctionParams(e,t)}parseVarId(e,t){super.parseVarId(e,t),this.match(14)&&(e.id.typeAnnotation=this.flowParseTypeAnnotation(),this.resetEndLocation(e.id))}parseAsyncArrowFromCallExpression(e,t){if(this.match(14)){let t=this.state.noAnonFunctionType;this.state.noAnonFunctionType=!0,e.returnType=this.flowParseTypeAnnotation(),this.state.noAnonFunctionType=t}return super.parseAsyncArrowFromCallExpression(e,t)}shouldParseAsyncArrow(){return this.match(14)||super.shouldParseAsyncArrow()}parseMaybeAssign(e,t){var n;let i,r=null;if(this.hasPlugin("jsx")&&(this.match(142)||this.match(47))){if(r=this.state.clone(),i=this.tryParse((()=>super.parseMaybeAssign(e,t)),r),!i.error)return i.node;let{context:n}=this.state,s=n[n.length-1];(s===D.j_oTag||s===D.j_expr)&&n.pop()}if(null!=(n=i)&&n.error||this.match(47)){var s,o;r=r||this.state.clone();let n,a=this.tryParse((i=>{var r;n=this.flowParseTypeParameterDeclaration();let s=this.forwardNoArrowParamsConversionAt(n,(()=>{let i=super.parseMaybeAssign(e,t);return this.resetStartLocationFromNode(i,n),i}));null!=(r=s.extra)&&r.parenthesized&&i();let o=this.maybeUnwrapTypeCastExpression(s);return"ArrowFunctionExpression"!==o.type&&i(),o.typeParameters=n,this.resetStartLocationFromNode(o,n),s}),r),l=null;if(a.node&&"ArrowFunctionExpression"===this.maybeUnwrapTypeCastExpression(a.node).type){if(!a.error&&!a.aborted)return a.node.async&&this.raise(kt.UnexpectedTypeParameterBeforeAsyncArrowFunction,n),a.node;l=a.node}if(null!=(s=i)&&s.node)return this.state=i.failState,i.node;if(l)return this.state=a.failState,l;throw null!=(o=i)&&o.thrown?i.error:a.thrown?a.error:this.raise(kt.UnexpectedTokenAfterTypeParameter,n)}return super.parseMaybeAssign(e,t)}parseArrow(e){if(this.match(14)){let t=this.tryParse((()=>{let t=this.state.noAnonFunctionType;this.state.noAnonFunctionType=!0;let n=this.startNode();return[n.typeAnnotation,e.predicate]=this.flowParseTypeAndPredicateInitialiser(),this.state.noAnonFunctionType=t,this.canInsertSemicolon()&&this.unexpected(),this.match(19)||this.unexpected(),n}));if(t.thrown)return null;t.error&&(this.state=t.failState),e.returnType=t.node.typeAnnotation?this.finishNode(t.node,"TypeAnnotation"):null}return super.parseArrow(e)}shouldParseArrow(e){return this.match(14)||super.shouldParseArrow(e)}setArrowFunctionParameters(e,t){this.state.noArrowParamsConversionAt.includes(e.start)?e.params=t:super.setArrowFunctionParameters(e,t)}checkParams(e,t,n){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!n||!this.state.noArrowParamsConversionAt.includes(e.start)){for(let t=0;t<e.params.length;t++)this.isThisParam(e.params[t])&&t>0&&this.raise(kt.ThisParamMustBeFirst,e.params[t]);super.checkParams(e,t,n,i)}}parseParenAndDistinguishExpression(e){return super.parseParenAndDistinguishExpression(e&&!this.state.noArrowAt.includes(this.state.start))}parseSubscripts(e,t,n){if("Identifier"===e.type&&"async"===e.name&&this.state.noArrowAt.includes(t.index)){this.next();let n=this.startNodeAt(t);n.callee=e,n.arguments=super.parseCallExpressionArguments(11,!1),e=this.finishNode(n,"CallExpression")}else if("Identifier"===e.type&&"async"===e.name&&this.match(47)){let i=this.state.clone(),r=this.tryParse((e=>this.parseAsyncArrowWithTypeParameters(t)||e()),i);if(!r.error&&!r.aborted)return r.node;let s=this.tryParse((()=>super.parseSubscripts(e,t,n)),i);if(s.node&&!s.error)return s.node;if(r.node)return this.state=r.failState,r.node;if(s.node)return this.state=s.failState,s.node;throw r.error||s.error}return super.parseSubscripts(e,t,n)}parseSubscript(e,t,n,i){if(this.match(18)&&this.isLookaheadToken_lt()){if(i.optionalChainMember=!0,n)return i.stop=!0,e;this.next();let r=this.startNodeAt(t);return r.callee=e,r.typeArguments=this.flowParseTypeParameterInstantiation(),this.expect(10),r.arguments=this.parseCallExpressionArguments(11,!1),r.optional=!0,this.finishCallExpression(r,!0)}if(!n&&this.shouldParseTypes()&&this.match(47)){let n=this.startNodeAt(t);n.callee=e;let r=this.tryParse((()=>(n.typeArguments=this.flowParseTypeParameterInstantiationCallOrNew(),this.expect(10),n.arguments=super.parseCallExpressionArguments(11,!1),i.optionalChainMember&&(n.optional=!1),this.finishCallExpression(n,i.optionalChainMember))));if(r.node)return r.error&&(this.state=r.failState),r.node}return super.parseSubscript(e,t,n,i)}parseNewCallee(e){super.parseNewCallee(e);let t=null;this.shouldParseTypes()&&this.match(47)&&(t=this.tryParse((()=>this.flowParseTypeParameterInstantiationCallOrNew())).node),e.typeArguments=t}parseAsyncArrowWithTypeParameters(e){let t=this.startNodeAt(e);if(this.parseFunctionParams(t,!1),this.parseArrow(t))return super.parseArrowExpression(t,void 0,!0)}readToken_mult_modulo(e){let t=this.input.charCodeAt(this.state.pos+1);if(42===e&&47===t&&this.state.hasFlowComment)return this.state.hasFlowComment=!1,this.state.pos+=2,void this.nextToken();super.readToken_mult_modulo(e)}readToken_pipe_amp(e){let t=this.input.charCodeAt(this.state.pos+1);124!==e||125!==t?super.readToken_pipe_amp(e):this.finishOp(9,2)}parseTopLevel(e,t){let n=super.parseTopLevel(e,t);return this.state.hasFlowComment&&this.raise(kt.UnterminatedFlowComment,this.state.curPosition()),n}skipBlockComment(){if(!this.hasPlugin("flowComments")||!this.skipFlowComment())return super.skipBlockComment(this.state.hasFlowComment?"*-/":"*/");{if(this.state.hasFlowComment)throw this.raise(kt.NestedFlowComment,this.state.startLoc);this.hasFlowCommentCompletion();let e=this.skipFlowComment();e&&(this.state.pos+=e,this.state.hasFlowComment=!0)}}skipFlowComment(){let{pos:e}=this.state,t=2;for(;[32,9].includes(this.input.charCodeAt(e+t));)t++;let n=this.input.charCodeAt(t+e),i=this.input.charCodeAt(t+e+1);return 58===n&&58===i?t+2:"flow-include"===this.input.slice(t+e,t+e+12)?t+12:58===n&&58!==i&&t}hasFlowCommentCompletion(){if(-1===this.input.indexOf("*/",this.state.pos))throw this.raise(G.UnterminatedComment,this.state.curPosition())}flowEnumErrorBooleanMemberNotInitialized(e,t){let{enumName:n,memberName:i}=t;this.raise(kt.EnumBooleanMemberNotInitialized,e,{memberName:i,enumName:n})}flowEnumErrorInvalidMemberInitializer(e,t){return this.raise(t.explicitType?"symbol"===t.explicitType?kt.EnumInvalidMemberInitializerSymbolType:kt.EnumInvalidMemberInitializerPrimaryType:kt.EnumInvalidMemberInitializerUnknownType,e,t)}flowEnumErrorNumberMemberNotInitialized(e,t){this.raise(kt.EnumNumberMemberNotInitialized,e,t)}flowEnumErrorStringMemberInconsistentlyInitialized(e,t){this.raise(kt.EnumStringMemberInconsistentlyInitialized,e,t)}flowEnumMemberInit(){let e=this.state.startLoc,t=()=>this.match(12)||this.match(8);switch(this.state.type){case 134:{let n=this.parseNumericLiteral(this.state.value);return t()?{type:"number",loc:n.loc.start,value:n}:{type:"invalid",loc:e}}case 133:{let n=this.parseStringLiteral(this.state.value);return t()?{type:"string",loc:n.loc.start,value:n}:{type:"invalid",loc:e}}case 85:case 86:{let n=this.parseBooleanLiteral(this.match(85));return t()?{type:"boolean",loc:n.loc.start,value:n}:{type:"invalid",loc:e}}default:return{type:"invalid",loc:e}}}flowEnumMemberRaw(){let e=this.state.startLoc;return{id:this.parseIdentifier(!0),init:this.eat(29)?this.flowEnumMemberInit():{type:"none",loc:e}}}flowEnumCheckExplicitTypeMismatch(e,t,n){let{explicitType:i}=t;null!==i&&i!==n&&this.flowEnumErrorInvalidMemberInitializer(e,t)}flowEnumMembers(e){let{enumName:t,explicitType:n}=e,i=new Set,r={booleanMembers:[],numberMembers:[],stringMembers:[],defaultedMembers:[]},s=!1;for(;!this.match(8);){if(this.eat(21)){s=!0;break}let e=this.startNode(),{id:o,init:a}=this.flowEnumMemberRaw(),l=o.name;if(""===l)continue;/^[a-z]/.test(l)&&this.raise(kt.EnumInvalidMemberName,o,{memberName:l,suggestion:l[0].toUpperCase()+l.slice(1),enumName:t}),i.has(l)&&this.raise(kt.EnumDuplicateMemberName,o,{memberName:l,enumName:t}),i.add(l);let c={enumName:t,explicitType:n,memberName:l};switch(e.id=o,a.type){case"boolean":this.flowEnumCheckExplicitTypeMismatch(a.loc,c,"boolean"),e.init=a.value,r.booleanMembers.push(this.finishNode(e,"EnumBooleanMember"));break;case"number":this.flowEnumCheckExplicitTypeMismatch(a.loc,c,"number"),e.init=a.value,r.numberMembers.push(this.finishNode(e,"EnumNumberMember"));break;case"string":this.flowEnumCheckExplicitTypeMismatch(a.loc,c,"string"),e.init=a.value,r.stringMembers.push(this.finishNode(e,"EnumStringMember"));break;case"invalid":throw this.flowEnumErrorInvalidMemberInitializer(a.loc,c);case"none":switch(n){case"boolean":this.flowEnumErrorBooleanMemberNotInitialized(a.loc,c);break;case"number":this.flowEnumErrorNumberMemberNotInitialized(a.loc,c);break;default:r.defaultedMembers.push(this.finishNode(e,"EnumDefaultedMember"))}}this.match(8)||this.expect(12)}return{members:r,hasUnknownMembers:s}}flowEnumStringMembers(e,t,n){let{enumName:i}=n;if(0===e.length)return t;if(0===t.length)return e;if(t.length>e.length){for(let t of e)this.flowEnumErrorStringMemberInconsistentlyInitialized(t,{enumName:i});return t}for(let r of t)this.flowEnumErrorStringMemberInconsistentlyInitialized(r,{enumName:i});return e}flowEnumParseExplicitType(e){let{enumName:t}=e;if(!this.eatContextual(102))return null;if(!q(this.state.type))throw this.raise(kt.EnumInvalidExplicitTypeUnknownSupplied,this.state.startLoc,{enumName:t});let{value:n}=this.state;return this.next(),"boolean"!==n&&"number"!==n&&"string"!==n&&"symbol"!==n&&this.raise(kt.EnumInvalidExplicitType,this.state.startLoc,{enumName:t,invalidEnumType:n}),n}flowEnumBody(e,t){let n=t.name,i=t.loc.start,r=this.flowEnumParseExplicitType({enumName:n});this.expect(5);let{members:s,hasUnknownMembers:o}=this.flowEnumMembers({enumName:n,explicitType:r});switch(e.hasUnknownMembers=o,r){case"boolean":return e.explicitType=!0,e.members=s.booleanMembers,this.expect(8),this.finishNode(e,"EnumBooleanBody");case"number":return e.explicitType=!0,e.members=s.numberMembers,this.expect(8),this.finishNode(e,"EnumNumberBody");case"string":return e.explicitType=!0,e.members=this.flowEnumStringMembers(s.stringMembers,s.defaultedMembers,{enumName:n}),this.expect(8),this.finishNode(e,"EnumStringBody");case"symbol":return e.members=s.defaultedMembers,this.expect(8),this.finishNode(e,"EnumSymbolBody");default:{let t=()=>(e.members=[],this.expect(8),this.finishNode(e,"EnumStringBody"));e.explicitType=!1;let r=s.booleanMembers.length,o=s.numberMembers.length,a=s.stringMembers.length,l=s.defaultedMembers.length;if(!r&&!o&&!a&&!l)return t();if(!r&&!o)return e.members=this.flowEnumStringMembers(s.stringMembers,s.defaultedMembers,{enumName:n}),this.expect(8),this.finishNode(e,"EnumStringBody");if(!o&&!a&&r>=l){for(let e of s.defaultedMembers)this.flowEnumErrorBooleanMemberNotInitialized(e.loc.start,{enumName:n,memberName:e.id.name});return e.members=s.booleanMembers,this.expect(8),this.finishNode(e,"EnumBooleanBody")}if(!r&&!a&&o>=l){for(let e of s.defaultedMembers)this.flowEnumErrorNumberMemberNotInitialized(e.loc.start,{enumName:n,memberName:e.id.name});return e.members=s.numberMembers,this.expect(8),this.finishNode(e,"EnumNumberBody")}return this.raise(kt.EnumInconsistentMemberValues,i,{enumName:n}),t()}}}flowParseEnumDeclaration(e){let t=this.parseIdentifier();return e.id=t,e.body=this.flowEnumBody(this.startNode(),t),this.finishNode(e,"EnumDeclaration")}isLookaheadToken_lt(){let e=this.nextTokenStart();if(60===this.input.charCodeAt(e)){let t=this.input.charCodeAt(e+1);return 60!==t&&61!==t}return!1}maybeUnwrapTypeCastExpression(e){return"TypeCastExpression"===e.type?e.expression:e}},Xt=w(s||(s=l(["jsx"])))({AttributeIsEmpty:"JSX attributes must only be assigned a non-empty expression.",MissingClosingTagElement:e=>{let{openingTagName:t}=e;return"Expected corresponding JSX closing tag for <".concat(t,">.")},MissingClosingTagFragment:"Expected corresponding JSX closing tag for <>.",UnexpectedSequenceExpression:"Sequence expressions cannot be directly nested inside JSX. Did you mean to wrap it in parentheses (...)?",UnexpectedToken:e=>{let{unexpected:t,HTMLEntity:n}=e;return"Unexpected token `".concat(t,"`. Did you mean `").concat(n,"` or `{'").concat(t,"'}`?")},UnsupportedJsxValue:"JSX value should be either an expression or a quoted JSX text.",UnterminatedJsxContent:"Unterminated JSX contents.",UnwrappedAdjacentJSXElements:"Adjacent JSX elements must be wrapped in an enclosing tag. Did you want a JSX fragment <>...</>?"});function Yt(e){return!!e&&("JSXOpeningFragment"===e.type||"JSXClosingFragment"===e.type)}function zt(e){if("JSXIdentifier"===e.type)return e.name;if("JSXNamespacedName"===e.type)return e.namespace.name+":"+e.name.name;if("JSXMemberExpression"===e.type)return zt(e.object)+"."+zt(e.property);throw new Error("Node had unexpected type: "+e.type)}var Pt=e=>class extends e{jsxReadToken(){let e="",t=this.state.pos;for(;;){if(this.state.pos>=this.length)throw this.raise(Xt.UnterminatedJsxContent,this.state.startLoc);let n=this.input.charCodeAt(this.state.pos);switch(n){case 60:case 123:return this.state.pos===this.state.start?void(60===n&&this.state.canStartJSXElement?(++this.state.pos,this.finishToken(142)):super.getTokenFromCode(n)):(e+=this.input.slice(t,this.state.pos),void this.finishToken(141,e));case 38:e+=this.input.slice(t,this.state.pos),e+=this.jsxReadEntity(),t=this.state.pos;break;default:je(n)?(e+=this.input.slice(t,this.state.pos),e+=this.jsxReadNewLine(!0),t=this.state.pos):++this.state.pos}}}jsxReadNewLine(e){let t,n=this.input.charCodeAt(this.state.pos);return++this.state.pos,13===n&&10===this.input.charCodeAt(this.state.pos)?(++this.state.pos,t=e?"\n":"\r\n"):t=String.fromCharCode(n),++this.state.curLine,this.state.lineStart=this.state.pos,t}jsxReadString(e){let t="",n=++this.state.pos;for(;;){if(this.state.pos>=this.length)throw this.raise(G.UnterminatedString,this.state.startLoc);let i=this.input.charCodeAt(this.state.pos);if(i===e)break;38===i?(t+=this.input.slice(n,this.state.pos),t+=this.jsxReadEntity(),n=this.state.pos):je(i)?(t+=this.input.slice(n,this.state.pos),t+=this.jsxReadNewLine(!1),n=this.state.pos):++this.state.pos}t+=this.input.slice(n,this.state.pos++),this.finishToken(133,t)}jsxReadEntity(){let e=++this.state.pos;if(35===this.codePointAtPos(this.state.pos)){++this.state.pos;let e=10;120===this.codePointAtPos(this.state.pos)&&(e=16,++this.state.pos);let t=this.readInt(e,void 0,!1,"bail");if(null!==t&&59===this.codePointAtPos(this.state.pos))return++this.state.pos,String.fromCodePoint(t)}else{let t=0,n=!1;for(;t++<10&&this.state.pos<this.length&&!(n=59===this.codePointAtPos(this.state.pos));)++this.state.pos;if(n){let t;if(this.input.slice(e,this.state.pos),++this.state.pos,t)return t}}return this.state.pos=e,"&"}jsxReadWord(){let e,t=this.state.pos;do{e=this.input.charCodeAt(++this.state.pos)}while(Ee(e)||45===e);this.finishToken(140,this.input.slice(t,this.state.pos))}jsxParseIdentifier(){let e=this.startNode();return this.match(140)?e.name=this.state.value:ae(this.state.type)?e.name=de(this.state.type):this.unexpected(),this.next(),this.finishNode(e,"JSXIdentifier")}jsxParseNamespacedName(){let e=this.state.startLoc,t=this.jsxParseIdentifier();if(!this.eat(14))return t;let n=this.startNodeAt(e);return n.namespace=t,n.name=this.jsxParseIdentifier(),this.finishNode(n,"JSXNamespacedName")}jsxParseElementName(){let e=this.state.startLoc,t=this.jsxParseNamespacedName();if("JSXNamespacedName"===t.type)return t;for(;this.eat(16);){let n=this.startNodeAt(e);n.object=t,n.property=this.jsxParseIdentifier(),t=this.finishNode(n,"JSXMemberExpression")}return t}jsxParseAttributeValue(){let e;switch(this.state.type){case 5:return e=this.startNode(),this.setContext(D.brace),this.next(),e=this.jsxParseExpressionContainer(e,D.j_oTag),"JSXEmptyExpression"===e.expression.type&&this.raise(Xt.AttributeIsEmpty,e),e;case 142:case 133:return this.parseExprAtom();default:throw this.raise(Xt.UnsupportedJsxValue,this.state.startLoc)}}jsxParseEmptyExpression(){let e=this.startNodeAt(this.state.lastTokEndLoc);return this.finishNodeAt(e,"JSXEmptyExpression",this.state.startLoc)}jsxParseSpreadChild(e){return this.next(),e.expression=this.parseExpression(),this.setContext(D.j_expr),this.state.canStartJSXElement=!0,this.expect(8),this.finishNode(e,"JSXSpreadChild")}jsxParseExpressionContainer(e,t){if(this.match(8))e.expression=this.jsxParseEmptyExpression();else{let t=this.parseExpression();e.expression=t}return this.setContext(t),this.state.canStartJSXElement=!0,this.expect(8),this.finishNode(e,"JSXExpressionContainer")}jsxParseAttribute(){let e=this.startNode();return this.match(5)?(this.setContext(D.brace),this.next(),this.expect(21),e.argument=this.parseMaybeAssignAllowIn(),this.setContext(D.j_oTag),this.state.canStartJSXElement=!0,this.expect(8),this.finishNode(e,"JSXSpreadAttribute")):(e.name=this.jsxParseNamespacedName(),e.value=this.eat(29)?this.jsxParseAttributeValue():null,this.finishNode(e,"JSXAttribute"))}jsxParseOpeningElementAt(e){let t=this.startNodeAt(e);return this.eat(143)?this.finishNode(t,"JSXOpeningFragment"):(t.name=this.jsxParseElementName(),this.jsxParseOpeningElementAfterName(t))}jsxParseOpeningElementAfterName(e){let t=[];for(;!this.match(56)&&!this.match(143);)t.push(this.jsxParseAttribute());return e.attributes=t,e.selfClosing=this.eat(56),this.expect(143),this.finishNode(e,"JSXOpeningElement")}jsxParseClosingElementAt(e){let t=this.startNodeAt(e);return this.eat(143)?this.finishNode(t,"JSXClosingFragment"):(t.name=this.jsxParseElementName(),this.expect(143),this.finishNode(t,"JSXClosingElement"))}jsxParseElementAt(e){let t=this.startNodeAt(e),n=[],i=this.jsxParseOpeningElementAt(e),r=null;if(!i.selfClosing){e:for(;;)switch(this.state.type){case 142:if(e=this.state.startLoc,this.next(),this.eat(56)){r=this.jsxParseClosingElementAt(e);break e}n.push(this.jsxParseElementAt(e));break;case 141:n.push(this.parseLiteral(this.state.value,"JSXText"));break;case 5:{let e=this.startNode();this.setContext(D.brace),this.next(),this.match(21)?n.push(this.jsxParseSpreadChild(e)):n.push(this.jsxParseExpressionContainer(e,D.j_expr));break}default:this.unexpected()}Yt(i)&&!Yt(r)&&null!==r?this.raise(Xt.MissingClosingTagFragment,r):(!Yt(i)&&Yt(r)||!Yt(i)&&!Yt(r)&&zt(r.name)!==zt(i.name))&&this.raise(Xt.MissingClosingTagElement,r,{openingTagName:zt(i.name)})}if(Yt(i)?(t.openingFragment=i,t.closingFragment=r):(t.openingElement=i,t.closingElement=r),t.children=n,this.match(47))throw this.raise(Xt.UnwrappedAdjacentJSXElements,this.state.startLoc);return Yt(i)?this.finishNode(t,"JSXFragment"):this.finishNode(t,"JSXElement")}jsxParseElement(){let e=this.state.startLoc;return this.next(),this.jsxParseElementAt(e)}setContext(e){let{context:t}=this.state;t[t.length-1]=e}parseExprAtom(e){return this.match(142)?this.jsxParseElement():this.match(47)&&33!==this.input.charCodeAt(this.state.pos)?(this.replaceToken(142),this.jsxParseElement()):super.parseExprAtom(e)}skipSpace(){this.curContext().preserveSpace||super.skipSpace()}getTokenFromCode(e){let t=this.curContext();if(t!==D.j_expr){if(t===D.j_oTag||t===D.j_cTag){if(Ge(e))return void this.jsxReadWord();if(62===e)return++this.state.pos,void this.finishToken(143);if((34===e||39===e)&&t===D.j_oTag)return void this.jsxReadString(e)}if(60===e&&this.state.canStartJSXElement&&33!==this.input.charCodeAt(this.state.pos+1))return++this.state.pos,void this.finishToken(142);super.getTokenFromCode(e)}else this.jsxReadToken()}updateContext(e){let{context:t,type:n}=this.state;if(56===n&&142===e)t.splice(-2,2,D.j_cTag),this.state.canStartJSXElement=!1;else if(142===n)t.push(D.j_oTag);else if(143===n){let n=t[t.length-1];n===D.j_oTag&&56===e||n===D.j_cTag?(t.pop(),this.state.canStartJSXElement=t[t.length-1]===D.j_expr):(this.setContext(D.j_expr),this.state.canStartJSXElement=!0)}else this.state.canStartJSXElement=ne(n)}},Ut=class extends Le{constructor(){super(...arguments),this.tsNames=new Map}},_t=class extends He{constructor(){super(...arguments),this.importsStack=[]}createScope(e){return this.importsStack.push(new Set),new Ut(e)}enter(e){256===e&&this.importsStack.push(new Set),super.enter(e)}exit(){let e=super.exit();return 256===e&&this.importsStack.pop(),e}hasImport(e,t){let n=this.importsStack.length;if(this.importsStack[n-1].has(e))return!0;if(!t&&n>1)for(let i=0;i<n-1;i++)if(this.importsStack[i].has(e))return!0;return!1}declareName(e,t,n){if(4096&t)return this.hasImport(e,!0)&&this.parser.raise(G.VarRedeclaration,n,{identifierName:e}),void this.importsStack[this.importsStack.length-1].add(e);let i=this.currentScope(),r=i.tsNames.get(e)||0;if(1024&t)return this.maybeExportDefined(i,e),void i.tsNames.set(e,16|r);super.declareName(e,t,n),2&t&&(1&t||(this.checkRedeclarationInScope(i,e,t,n),this.maybeExportDefined(i,e)),r|=1),256&t&&(r|=2),512&t&&(r|=4),128&t&&(r|=8),r&&i.tsNames.set(e,r)}isRedeclaredInScope(e,t,n){let i=e.tsNames.get(t);return(2&i)>0?!(256&n)||!!(512&n)!==(4&i)>0:128&n&&(8&i)>0?!!(2&e.names.get(t))&&!!(1&n):!!(2&n&&(1&i)>0)||super.isRedeclaredInScope(e,t,n)}checkLocalExport(e){let{name:t}=e;if(!this.hasImport(t)){for(let e=this.scopeStack.length-1;e>=0;e--){let n=this.scopeStack[e].tsNames.get(t);if((1&n)>0||(16&n)>0)return}super.checkLocalExport(e)}}},Ot=(e,t)=>hasOwnProperty.call(e,t)&&e[t],Jt=e=>"ParenthesizedExpression"===e.type?Jt(e.expression):e,jt=class extends Mt{toAssignable(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var n,i;let r;switch(("ParenthesizedExpression"===e.type||null!=(n=e.extra)&&n.parenthesized)&&(r=Jt(e),t?"Identifier"===r.type?this.expressionScope.recordArrowParameterBindingError(G.InvalidParenthesizedAssignment,e):"MemberExpression"!==r.type&&!this.isOptionalMemberExpression(r)&&this.raise(G.InvalidParenthesizedAssignment,e):this.raise(G.InvalidParenthesizedAssignment,e)),e.type){case"Identifier":case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":e.type="ObjectPattern";for(let n=0,i=e.properties.length,r=i-1;n<i;n++){var s;let i=e.properties[n],o=n===r;this.toAssignableObjectExpressionProp(i,o,t),o&&"RestElement"===i.type&&null!=(s=e.extra)&&s.trailingCommaLoc&&this.raise(G.RestTrailingComma,e.extra.trailingCommaLoc)}break;case"ObjectProperty":{let{key:n,value:i}=e;this.isPrivateName(n)&&this.classScope.usePrivateName(this.getPrivateNameSV(n),n.loc.start),this.toAssignable(i,t);break}case"SpreadElement":throw new Error("Internal @babel/parser error (this is a bug, please report it). SpreadElement should be converted by .toAssignable's caller.");case"ArrayExpression":e.type="ArrayPattern",this.toAssignableList(e.elements,null==(i=e.extra)?void 0:i.trailingCommaLoc,t);break;case"AssignmentExpression":"="!==e.operator&&this.raise(G.MissingEqInAssignment,e.left.loc.end),e.type="AssignmentPattern",delete e.operator,this.toAssignable(e.left,t);break;case"ParenthesizedExpression":this.toAssignable(r,t)}}toAssignableObjectExpressionProp(e,t,n){if("ObjectMethod"===e.type)this.raise("get"===e.kind||"set"===e.kind?G.PatternHasAccessor:G.PatternHasMethod,e.key);else if("SpreadElement"===e.type){e.type="RestElement";let i=e.argument;this.checkToRestConversion(i,!1),this.toAssignable(i,n),t||this.raise(G.RestTrailingComma,e)}else this.toAssignable(e,n)}toAssignableList(e,t,n){let i=e.length-1;for(let r=0;r<=i;r++){let s=e[r];if(s){if("SpreadElement"===s.type){s.type="RestElement";let e=s.argument;this.checkToRestConversion(e,!0),this.toAssignable(e,n)}else this.toAssignable(s,n);"RestElement"===s.type&&(r<i?this.raise(G.RestTrailingComma,s):t&&this.raise(G.RestTrailingComma,t))}}}isAssignable(e,t){switch(e.type){case"Identifier":case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":return!0;case"ObjectExpression":{let t=e.properties.length-1;return e.properties.every(((e,n)=>"ObjectMethod"!==e.type&&(n===t||"SpreadElement"!==e.type)&&this.isAssignable(e)))}case"ObjectProperty":return this.isAssignable(e.value);case"SpreadElement":return this.isAssignable(e.argument);case"ArrayExpression":return e.elements.every((e=>null===e||this.isAssignable(e)));case"AssignmentExpression":return"="===e.operator;case"ParenthesizedExpression":return this.isAssignable(e.expression);case"MemberExpression":case"OptionalMemberExpression":return!t;default:return!1}}toReferencedList(e,t){return e}toReferencedListDeep(e,t){this.toReferencedList(e,t);for(let n of e)"ArrayExpression"===(null==n?void 0:n.type)&&this.toReferencedListDeep(n.elements)}parseSpread(e){let t=this.startNode();return this.next(),t.argument=this.parseMaybeAssignAllowIn(e,void 0),this.finishNode(t,"SpreadElement")}parseRestBinding(){let e=this.startNode();return this.next(),e.argument=this.parseBindingAtom(),this.finishNode(e,"RestElement")}parseBindingAtom(){switch(this.state.type){case 0:{let e=this.startNode();return this.next(),e.elements=this.parseBindingList(3,93,1),this.finishNode(e,"ArrayPattern")}case 5:return this.parseObjectLike(8,!0)}return this.parseIdentifier()}parseBindingList(e,t,n){let i=1&n,r=[],s=!0;for(;!this.eat(e);)if(s?s=!1:this.expect(12),i&&this.match(12))r.push(null);else{if(this.eat(e))break;if(this.match(21)){if(r.push(this.parseAssignableListItemTypes(this.parseRestBinding(),n)),!this.checkCommaAfterRest(t)){this.expect(e);break}}else{let e=[];for(this.match(26)&&this.hasPlugin("decorators")&&this.raise(G.UnsupportedParameterDecorator,this.state.startLoc);this.match(26);)e.push(this.parseDecorator());r.push(this.parseAssignableListItem(n,e))}}return r}parseBindingRestProperty(e){return this.next(),e.argument=this.parseIdentifier(),this.checkCommaAfterRest(125),this.finishNode(e,"RestElement")}parseBindingProperty(){let{type:e,startLoc:t}=this.state;if(21===e)return this.parseBindingRestProperty(this.startNode());let n=this.startNode();return 138===e?(this.expectPlugin("destructuringPrivate",t),this.classScope.usePrivateName(this.state.value,t),n.key=this.parsePrivateName()):this.parsePropertyName(n),n.method=!1,this.parseObjPropValue(n,t,!1,!1,!0,!1)}parseAssignableListItem(e,t){let n=this.parseMaybeDefault();this.parseAssignableListItemTypes(n,e);let i=this.parseMaybeDefault(n.loc.start,n);return t.length&&(n.decorators=t),i}parseAssignableListItemTypes(e,t){return e}parseMaybeDefault(e,t){var n;if(null!=e||(e=this.state.startLoc),t=null!=(n=t)?n:this.parseBindingAtom(),!this.eat(29))return t;let i=this.startNodeAt(e);return i.left=t,i.right=this.parseMaybeAssignAllowIn(),this.finishNode(i,"AssignmentPattern")}isValidLVal(e,t,n){return Ot({AssignmentPattern:"left",RestElement:"argument",ObjectProperty:"value",ParenthesizedExpression:"expression",ArrayPattern:"elements",ObjectPattern:"properties"},e)}isOptionalMemberExpression(e){return"OptionalMemberExpression"===e.type}checkLVal(e,t){let{in:n,binding:i=64,checkClashes:r=!1,strictModeChanged:s=!1,hasParenthesizedAncestor:o=!1}=t;var a;let l=e.type;if(this.isObjectMethod(e))return;let c=this.isOptionalMemberExpression(e);if(c||"MemberExpression"===l)return c&&(this.expectPlugin("optionalChainingAssign",e.loc.start),"AssignmentExpression"!==n.type&&this.raise(G.InvalidLhsOptionalChaining,e,{ancestor:n})),void(64!==i&&this.raise(G.InvalidPropertyBindingPattern,e));if("Identifier"===l){this.checkIdentifier(e,i,s);let{name:t}=e;return void(r&&(r.has(t)?this.raise(G.ParamDupe,e):r.add(t)))}let g=this.isValidLVal(l,!(o||null!=(a=e.extra)&&a.parenthesized)&&"AssignmentExpression"===n.type,i);if(!0===g)return;if(!1===g){let t=64===i?G.InvalidLhs:G.InvalidLhsBinding;return void this.raise(t,e,{ancestor:n})}let[u,A]=Array.isArray(g)?g:[g,"ParenthesizedExpression"===l],d="ArrayPattern"===l||"ObjectPattern"===l?{type:l}:n;for(let h of[].concat(e[u]))h&&this.checkLVal(h,{in:d,binding:i,checkClashes:r,strictModeChanged:s,hasParenthesizedAncestor:A})}checkIdentifier(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.state.strict&&(n?Me(e.name,this.inModule):Ne(e.name))&&(64===t?this.raise(G.StrictEvalArguments,e,{referenceName:e.name}):this.raise(G.StrictEvalArgumentsBinding,e,{bindingName:e.name})),8192&t&&"let"===e.name&&this.raise(G.LetInLexicalBinding,e),64&t||this.declareNameFromIdentifier(e,t)}declareNameFromIdentifier(e,t){this.scope.declareName(e.name,t,e.loc.start)}checkToRestConversion(e,t){switch(e.type){case"ParenthesizedExpression":this.checkToRestConversion(e.expression,t);break;case"Identifier":case"MemberExpression":break;case"ArrayExpression":case"ObjectExpression":if(t)break;default:this.raise(G.InvalidRestAssignmentPattern,e)}}checkCommaAfterRest(e){return!!this.match(12)&&(this.raise(this.lookaheadCharCode()===e?G.RestTrailingComma:G.ElementAfterRest,this.state.startLoc),!0)}},qt=(e,t)=>hasOwnProperty.call(e,t)&&e[t];function $t(e){if(null==e)throw new Error("Unexpected ".concat(e," value."));return e}function en(e){if(!e)throw new Error("Assert fail")}var tn=w(o||(o=l(["typescript"])))({AbstractMethodHasImplementation:e=>{let{methodName:t}=e;return"Method '".concat(t,"' cannot have an implementation because it is marked abstract.")},AbstractPropertyHasInitializer:e=>{let{propertyName:t}=e;return"Property '".concat(t,"' cannot have an initializer because it is marked abstract.")},AccesorCannotDeclareThisParameter:"'get' and 'set' accessors cannot declare 'this' parameters.",AccesorCannotHaveTypeParameters:"An accessor cannot have type parameters.",AccessorCannotBeOptional:"An 'accessor' property cannot be declared optional.",ClassMethodHasDeclare:"Class methods cannot have the 'declare' modifier.",ClassMethodHasReadonly:"Class methods cannot have the 'readonly' modifier.",ConstInitiailizerMustBeStringOrNumericLiteralOrLiteralEnumReference:"A 'const' initializer in an ambient context must be a string or numeric literal or literal enum reference.",ConstructorHasTypeParameters:"Type parameters cannot appear on a constructor declaration.",DeclareAccessor:e=>{let{kind:t}=e;return"'declare' is not allowed in ".concat(t,"ters.")},DeclareClassFieldHasInitializer:"Initializers are not allowed in ambient contexts.",DeclareFunctionHasImplementation:"An implementation cannot be declared in ambient contexts.",DuplicateAccessibilityModifier:e=>{let{modifier:t}=e;return"Accessibility modifier already seen."},DuplicateModifier:e=>{let{modifier:t}=e;return"Duplicate modifier: '".concat(t,"'.")},EmptyHeritageClauseType:e=>{let{token:t}=e;return"'".concat(t,"' list cannot be empty.")},EmptyTypeArguments:"Type argument list cannot be empty.",EmptyTypeParameters:"Type parameter list cannot be empty.",ExpectedAmbientAfterExportDeclare:"'export declare' must be followed by an ambient declaration.",ImportAliasHasImportType:"An import alias can not use 'import type'.",ImportReflectionHasImportType:"An `import module` declaration can not use `type` modifier",IncompatibleModifiers:e=>{let{modifiers:t}=e;return"'".concat(t[0],"' modifier cannot be used with '").concat(t[1],"' modifier.")},IndexSignatureHasAbstract:"Index signatures cannot have the 'abstract' modifier.",IndexSignatureHasAccessibility:e=>{let{modifier:t}=e;return"Index signatures cannot have an accessibility modifier ('".concat(t,"').")},IndexSignatureHasDeclare:"Index signatures cannot have the 'declare' modifier.",IndexSignatureHasOverride:"'override' modifier cannot appear on an index signature.",IndexSignatureHasStatic:"Index signatures cannot have the 'static' modifier.",InitializerNotAllowedInAmbientContext:"Initializers are not allowed in ambient contexts.",InvalidModifierOnTypeMember:e=>{let{modifier:t}=e;return"'".concat(t,"' modifier cannot appear on a type member.")},InvalidModifierOnTypeParameter:e=>{let{modifier:t}=e;return"'".concat(t,"' modifier cannot appear on a type parameter.")},InvalidModifierOnTypeParameterPositions:e=>{let{modifier:t}=e;return"'".concat(t,"' modifier can only appear on a type parameter of a class, interface or type alias.")},InvalidModifiersOrder:e=>{let{orderedModifiers:t}=e;return"'".concat(t[0],"' modifier must precede '").concat(t[1],"' modifier.")},InvalidPropertyAccessAfterInstantiationExpression:"Invalid property access after an instantiation expression. You can either wrap the instantiation expression in parentheses, or delete the type arguments.",InvalidTupleMemberLabel:"Tuple members must be labeled with a simple identifier.",MissingInterfaceName:"'interface' declarations must be followed by an identifier.",NonAbstractClassHasAbstractMethod:"Abstract methods can only appear within an abstract class.",NonClassMethodPropertyHasAbstractModifer:"'abstract' modifier can only appear on a class, method, or property declaration.",OptionalTypeBeforeRequired:"A required element cannot follow an optional element.",OverrideNotInSubClass:"This member cannot have an 'override' modifier because its containing class does not extend another class.",PatternIsOptional:"A binding pattern parameter cannot be optional in an implementation signature.",PrivateElementHasAbstract:"Private elements cannot have the 'abstract' modifier.",PrivateElementHasAccessibility:e=>{let{modifier:t}=e;return"Private elements cannot have an accessibility modifier ('".concat(t,"').")},ReadonlyForMethodSignature:"'readonly' modifier can only appear on a property declaration or index signature.",ReservedArrowTypeParam:"This syntax is reserved in files with the .mts or .cts extension. Add a trailing comma, as in `<T,>() => ...`.",ReservedTypeAssertion:"This syntax is reserved in files with the .mts or .cts extension. Use an `as` expression instead.",SetAccesorCannotHaveOptionalParameter:"A 'set' accessor cannot have an optional parameter.",SetAccesorCannotHaveRestParameter:"A 'set' accessor cannot have rest parameter.",SetAccesorCannotHaveReturnType:"A 'set' accessor cannot have a return type annotation.",SingleTypeParameterWithoutTrailingComma:e=>{let{typeParameterName:t}=e;return"Single type parameter ".concat(t," should have a trailing comma. Example usage: <").concat(t,",>.")},StaticBlockCannotHaveModifier:"Static class blocks cannot have any modifier.",TupleOptionalAfterType:"A labeled tuple optional element must be declared using a question mark after the name and before the colon (`name?: type`), rather than after the type (`name: type?`).",TypeAnnotationAfterAssign:"Type annotations must come before default assignments, e.g. instead of `age = 25: number` use `age: number = 25`.",TypeImportCannotSpecifyDefaultAndNamed:"A type-only import can specify a default import or named bindings, but not both.",TypeModifierIsUsedInTypeExports:"The 'type' modifier cannot be used on a named export when 'export type' is used on its export statement.",TypeModifierIsUsedInTypeImports:"The 'type' modifier cannot be used on a named import when 'import type' is used on its import statement.",UnexpectedParameterModifier:"A parameter property is only allowed in a constructor implementation.",UnexpectedReadonly:"'readonly' type modifier is only permitted on array and tuple literal types.",UnexpectedTypeAnnotation:"Did not expect a type annotation here.",UnexpectedTypeCastInParameter:"Unexpected type cast in parameter position.",UnsupportedImportTypeArgument:"Argument in a type import must be a string literal.",UnsupportedParameterPropertyKind:"A parameter property may not be declared using a binding pattern.",UnsupportedSignatureParameterKind:e=>{let{type:t}=e;return"Name in a signature must be an Identifier, ObjectPattern or ArrayPattern, instead got ".concat(t,".")}});function nn(e){switch(e){case"any":return"TSAnyKeyword";case"boolean":return"TSBooleanKeyword";case"bigint":return"TSBigIntKeyword";case"never":return"TSNeverKeyword";case"number":return"TSNumberKeyword";case"object":return"TSObjectKeyword";case"string":return"TSStringKeyword";case"symbol":return"TSSymbolKeyword";case"undefined":return"TSUndefinedKeyword";case"unknown":return"TSUnknownKeyword";default:return}}function rn(e){return"private"===e||"public"===e||"protected"===e}function sn(e){return"in"===e||"out"===e}var on=e=>class extends e{constructor(){super(...arguments),this.tsParseInOutModifiers=this.tsParseModifiers.bind(this,{allowedModifiers:["in","out"],disallowedModifiers:["const","public","private","protected","readonly","declare","abstract","override"],errorTemplate:tn.InvalidModifierOnTypeParameter}),this.tsParseConstModifier=this.tsParseModifiers.bind(this,{allowedModifiers:["const"],disallowedModifiers:["in","out"],errorTemplate:tn.InvalidModifierOnTypeParameterPositions}),this.tsParseInOutConstModifiers=this.tsParseModifiers.bind(this,{allowedModifiers:["in","out","const"],disallowedModifiers:["public","private","protected","readonly","declare","abstract","override"],errorTemplate:tn.InvalidModifierOnTypeParameter})}getScopeHandler(){return _t}tsIsIdentifier(){return q(this.state.type)}tsTokenCanFollowModifier(){return(this.match(0)||this.match(5)||this.match(55)||this.match(21)||this.match(138)||this.isLiteralPropertyName())&&!this.hasPrecedingLineBreak()}tsNextTokenCanFollowModifier(){return this.next(),this.tsTokenCanFollowModifier()}tsParseModifier(e,t){if(!q(this.state.type)&&58!==this.state.type&&75!==this.state.type)return;let n=this.state.value;if(e.includes(n)){if(t&&this.tsIsStartOfStaticBlocks())return;if(this.tsTryParse(this.tsNextTokenCanFollowModifier.bind(this)))return n}}tsParseModifiers(e,t){let{allowedModifiers:n,disallowedModifiers:i,stopOnStartOfClassStaticBlock:r,errorTemplate:s=tn.InvalidModifierOnTypeMember}=e,o=(e,n,i,r)=>{n===i&&t[r]&&this.raise(tn.InvalidModifiersOrder,e,{orderedModifiers:[i,r]})},a=(e,n,i,r)=>{(t[i]&&n===r||t[r]&&n===i)&&this.raise(tn.IncompatibleModifiers,e,{modifiers:[i,r]})};for(;;){let{startLoc:e}=this.state,l=this.tsParseModifier(n.concat(null!==i&&void 0!==i?i:[]),r);if(!l)break;rn(l)?t.accessibility?this.raise(tn.DuplicateAccessibilityModifier,e,{modifier:l}):(o(e,l,l,"override"),o(e,l,l,"static"),o(e,l,l,"readonly"),t.accessibility=l):sn(l)?(t[l]&&this.raise(tn.DuplicateModifier,e,{modifier:l}),t[l]=!0,o(e,l,"in","out")):(hasOwnProperty.call(t,l)?this.raise(tn.DuplicateModifier,e,{modifier:l}):(o(e,l,"static","readonly"),o(e,l,"static","override"),o(e,l,"override","readonly"),o(e,l,"abstract","override"),a(e,l,"declare","override"),a(e,l,"static","abstract")),t[l]=!0),null!=i&&i.includes(l)&&this.raise(s,e,{modifier:l})}}tsIsListTerminator(e){switch(e){case"EnumMembers":case"TypeMembers":return this.match(8);case"HeritageClauseElement":return this.match(5);case"TupleElementTypes":return this.match(3);case"TypeParametersOrArguments":return this.match(48)}}tsParseList(e,t){let n=[];for(;!this.tsIsListTerminator(e);)n.push(t());return n}tsParseDelimitedList(e,t,n){return $t(this.tsParseDelimitedListWorker(e,t,!0,n))}tsParseDelimitedListWorker(e,t,n,i){let r=[],s=-1;for(;!this.tsIsListTerminator(e);){s=-1;let i=t();if(null==i)return;if(r.push(i),!this.eat(12)){if(this.tsIsListTerminator(e))break;return void(n&&this.expect(12))}s=this.state.lastTokStartLoc.index}return i&&(i.value=s),r}tsParseBracketedList(e,t,n,i,r){i||(n?this.expect(0):this.expect(47));let s=this.tsParseDelimitedList(e,t,r);return n?this.expect(3):this.expect(48),s}tsParseImportType(){let e=this.startNode();return this.expect(83),this.expect(10),this.match(133)||this.raise(tn.UnsupportedImportTypeArgument,this.state.startLoc),e.argument=super.parseExprAtom(),(this.hasPlugin("importAttributes")||this.hasPlugin("importAssertions"))&&(e.options=null),this.eat(12)&&(this.expectImportAttributesPlugin(),this.match(11)||(e.options=super.parseMaybeAssignAllowIn(),this.eat(12))),this.expect(11),this.eat(16)&&(e.qualifier=this.tsParseEntityName()),this.match(47)&&(e.typeParameters=this.tsParseTypeArguments()),this.finishNode(e,"TSImportType")}tsParseEntityName(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.parseIdentifier(e);for(;this.eat(16);){let n=this.startNodeAtNode(t);n.left=t,n.right=this.parseIdentifier(e),t=this.finishNode(n,"TSQualifiedName")}return t}tsParseTypeReference(){let e=this.startNode();return e.typeName=this.tsParseEntityName(),!this.hasPrecedingLineBreak()&&this.match(47)&&(e.typeParameters=this.tsParseTypeArguments()),this.finishNode(e,"TSTypeReference")}tsParseThisTypePredicate(e){this.next();let t=this.startNodeAtNode(e);return t.parameterName=e,t.typeAnnotation=this.tsParseTypeAnnotation(!1),t.asserts=!1,this.finishNode(t,"TSTypePredicate")}tsParseThisTypeNode(){let e=this.startNode();return this.next(),this.finishNode(e,"TSThisType")}tsParseTypeQuery(){let e=this.startNode();return this.expect(87),this.match(83)?e.exprName=this.tsParseImportType():e.exprName=this.tsParseEntityName(),!this.hasPrecedingLineBreak()&&this.match(47)&&(e.typeParameters=this.tsParseTypeArguments()),this.finishNode(e,"TSTypeQuery")}tsParseTypeParameter(e){let t=this.startNode();return e(t),t.name=this.tsParseTypeParameterName(),t.constraint=this.tsEatThenParseType(81),t.default=this.tsEatThenParseType(29),this.finishNode(t,"TSTypeParameter")}tsTryParseTypeParameters(e){if(this.match(47))return this.tsParseTypeParameters(e)}tsParseTypeParameters(e){let t=this.startNode();this.match(47)||this.match(142)?this.next():this.unexpected();let n={value:-1};return t.params=this.tsParseBracketedList("TypeParametersOrArguments",this.tsParseTypeParameter.bind(this,e),!1,!0,n),0===t.params.length&&this.raise(tn.EmptyTypeParameters,t),-1!==n.value&&this.addExtra(t,"trailingComma",n.value),this.finishNode(t,"TSTypeParameterDeclaration")}tsFillSignature(e,t){let n=19===e,i="parameters",r="typeAnnotation";t.typeParameters=this.tsTryParseTypeParameters(this.tsParseConstModifier),this.expect(10),t[i]=this.tsParseBindingListForSignature(),(n||this.match(e))&&(t[r]=this.tsParseTypeOrTypePredicateAnnotation(e))}tsParseBindingListForSignature(){let e=super.parseBindingList(11,41,2);for(let t of e){let{type:e}=t;("AssignmentPattern"===e||"TSParameterProperty"===e)&&this.raise(tn.UnsupportedSignatureParameterKind,t,{type:e})}return e}tsParseTypeMemberSemicolon(){!this.eat(12)&&!this.isLineTerminator()&&this.expect(13)}tsParseSignatureMember(e,t){return this.tsFillSignature(14,t),this.tsParseTypeMemberSemicolon(),this.finishNode(t,e)}tsIsUnambiguouslyIndexSignature(){return this.next(),!!q(this.state.type)&&(this.next(),this.match(14))}tsTryParseIndexSignature(e){if(!this.match(0)||!this.tsLookAhead(this.tsIsUnambiguouslyIndexSignature.bind(this)))return;this.expect(0);let t=this.parseIdentifier();t.typeAnnotation=this.tsParseTypeAnnotation(),this.resetEndLocation(t),this.expect(3),e.parameters=[t];let n=this.tsTryParseTypeAnnotation();return n&&(e.typeAnnotation=n),this.tsParseTypeMemberSemicolon(),this.finishNode(e,"TSIndexSignature")}tsParsePropertyOrMethodSignature(e,t){this.eat(17)&&(e.optional=!0);let n=e;if(this.match(10)||this.match(47)){t&&this.raise(tn.ReadonlyForMethodSignature,e);let i=n;i.kind&&this.match(47)&&this.raise(tn.AccesorCannotHaveTypeParameters,this.state.curPosition()),this.tsFillSignature(14,i),this.tsParseTypeMemberSemicolon();let r="parameters",s="typeAnnotation";if("get"===i.kind)i[r].length>0&&(this.raise(G.BadGetterArity,this.state.curPosition()),this.isThisParam(i[r][0])&&this.raise(tn.AccesorCannotDeclareThisParameter,this.state.curPosition()));else if("set"===i.kind){if(1!==i[r].length)this.raise(G.BadSetterArity,this.state.curPosition());else{let e=i[r][0];this.isThisParam(e)&&this.raise(tn.AccesorCannotDeclareThisParameter,this.state.curPosition()),"Identifier"===e.type&&e.optional&&this.raise(tn.SetAccesorCannotHaveOptionalParameter,this.state.curPosition()),"RestElement"===e.type&&this.raise(tn.SetAccesorCannotHaveRestParameter,this.state.curPosition())}i[s]&&this.raise(tn.SetAccesorCannotHaveReturnType,i[s])}else i.kind="method";return this.finishNode(i,"TSMethodSignature")}{let e=n;t&&(e.readonly=!0);let i=this.tsTryParseTypeAnnotation();return i&&(e.typeAnnotation=i),this.tsParseTypeMemberSemicolon(),this.finishNode(e,"TSPropertySignature")}}tsParseTypeMember(){let e=this.startNode();if(this.match(10)||this.match(47))return this.tsParseSignatureMember("TSCallSignatureDeclaration",e);if(this.match(77)){let t=this.startNode();return this.next(),this.match(10)||this.match(47)?this.tsParseSignatureMember("TSConstructSignatureDeclaration",e):(e.key=this.createIdentifier(t,"new"),this.tsParsePropertyOrMethodSignature(e,!1))}return this.tsParseModifiers({allowedModifiers:["readonly"],disallowedModifiers:["declare","abstract","private","protected","public","static","override"]},e),this.tsTryParseIndexSignature(e)||(super.parsePropertyName(e),!e.computed&&"Identifier"===e.key.type&&("get"===e.key.name||"set"===e.key.name)&&this.tsTokenCanFollowModifier()&&(e.kind=e.key.name,super.parsePropertyName(e)),this.tsParsePropertyOrMethodSignature(e,!!e.readonly))}tsParseTypeLiteral(){let e=this.startNode();return e.members=this.tsParseObjectTypeMembers(),this.finishNode(e,"TSTypeLiteral")}tsParseObjectTypeMembers(){this.expect(5);let e=this.tsParseList("TypeMembers",this.tsParseTypeMember.bind(this));return this.expect(8),e}tsIsStartOfMappedType(){return this.next(),this.eat(53)?this.isContextual(122):(this.isContextual(122)&&this.next(),!(!this.match(0)||(this.next(),!this.tsIsIdentifier()))&&(this.next(),this.match(58)))}tsParseMappedTypeParameter(){let e=this.startNode();return e.name=this.tsParseTypeParameterName(),e.constraint=this.tsExpectThenParseType(58),this.finishNode(e,"TSTypeParameter")}tsParseMappedType(){let e=this.startNode();return this.expect(5),this.match(53)?(e.readonly=this.state.value,this.next(),this.expectContextual(122)):this.eatContextual(122)&&(e.readonly=!0),this.expect(0),e.typeParameter=this.tsParseMappedTypeParameter(),e.nameType=this.eatContextual(93)?this.tsParseType():null,this.expect(3),this.match(53)?(e.optional=this.state.value,this.next(),this.expect(17)):this.eat(17)&&(e.optional=!0),e.typeAnnotation=this.tsTryParseType(),this.semicolon(),this.expect(8),this.finishNode(e,"TSMappedType")}tsParseTupleType(){let e=this.startNode();e.elementTypes=this.tsParseBracketedList("TupleElementTypes",this.tsParseTupleElementType.bind(this),!0,!1);let t=!1;return e.elementTypes.forEach((e=>{let{type:n}=e;t&&"TSRestType"!==n&&"TSOptionalType"!==n&&!("TSNamedTupleMember"===n&&e.optional)&&this.raise(tn.OptionalTypeBeforeRequired,e),t||(t="TSNamedTupleMember"===n&&e.optional||"TSOptionalType"===n)})),this.finishNode(e,"TSTupleType")}tsParseTupleElementType(){let e,t,n,i,{startLoc:r}=this.state,s=this.eat(21),o=ee(this.state.type)?this.lookaheadCharCode():null;if(58===o)e=!0,n=!1,t=this.parseIdentifier(!0),this.expect(14),i=this.tsParseType();else if(63===o){n=!0;let r=this.state.startLoc,s=this.state.value,o=this.tsParseNonArrayType();58===this.lookaheadCharCode()?(e=!0,t=this.createIdentifier(this.startNodeAt(r),s),this.expect(17),this.expect(14),i=this.tsParseType()):(e=!1,i=o,this.expect(17))}else i=this.tsParseType(),n=this.eat(17),e=this.eat(14);if(e){let e;t?(e=this.startNodeAtNode(t),e.optional=n,e.label=t,e.elementType=i,this.eat(17)&&(e.optional=!0,this.raise(tn.TupleOptionalAfterType,this.state.lastTokStartLoc))):(e=this.startNodeAtNode(i),e.optional=n,this.raise(tn.InvalidTupleMemberLabel,i),e.label=i,e.elementType=this.tsParseType()),i=this.finishNode(e,"TSNamedTupleMember")}else if(n){let e=this.startNodeAtNode(i);e.typeAnnotation=i,i=this.finishNode(e,"TSOptionalType")}if(s){let e=this.startNodeAt(r);e.typeAnnotation=i,i=this.finishNode(e,"TSRestType")}return i}tsParseParenthesizedType(){let e=this.startNode();return this.expect(10),e.typeAnnotation=this.tsParseType(),this.expect(11),this.finishNode(e,"TSParenthesizedType")}tsParseFunctionOrConstructorType(e,t){let n=this.startNode();return"TSConstructorType"===e&&(n.abstract=!!t,t&&this.next(),this.next()),this.tsInAllowConditionalTypesContext((()=>this.tsFillSignature(19,n))),this.finishNode(n,e)}tsParseLiteralTypeNode(){let e=this.startNode();switch(this.state.type){case 134:case 135:case 133:case 85:case 86:e.literal=super.parseExprAtom();break;default:this.unexpected()}return this.finishNode(e,"TSLiteralType")}tsParseTemplateLiteralType(){let e=this.startNode();return e.literal=super.parseTemplate(!1),this.finishNode(e,"TSLiteralType")}parseTemplateSubstitution(){return this.state.inType?this.tsParseType():super.parseTemplateSubstitution()}tsParseThisTypeOrThisTypePredicate(){let e=this.tsParseThisTypeNode();return this.isContextual(116)&&!this.hasPrecedingLineBreak()?this.tsParseThisTypePredicate(e):e}tsParseNonArrayType(){switch(this.state.type){case 133:case 134:case 135:case 85:case 86:return this.tsParseLiteralTypeNode();case 53:if("-"===this.state.value){let e=this.startNode(),t=this.lookahead();return 134!==t.type&&135!==t.type&&this.unexpected(),e.literal=this.parseMaybeUnary(),this.finishNode(e,"TSLiteralType")}break;case 78:return this.tsParseThisTypeOrThisTypePredicate();case 87:return this.tsParseTypeQuery();case 83:return this.tsParseImportType();case 5:return this.tsLookAhead(this.tsIsStartOfMappedType.bind(this))?this.tsParseMappedType():this.tsParseTypeLiteral();case 0:return this.tsParseTupleType();case 10:return this.tsParseParenthesizedType();case 25:case 24:return this.tsParseTemplateLiteralType();default:{let{type:e}=this.state;if(q(e)||88===e||84===e){let t=88===e?"TSVoidKeyword":84===e?"TSNullKeyword":nn(this.state.value);if(void 0!==t&&46!==this.lookaheadCharCode()){let e=this.startNode();return this.next(),this.finishNode(e,t)}return this.tsParseTypeReference()}}}this.unexpected()}tsParseArrayTypeOrHigher(){let e=this.tsParseNonArrayType();for(;!this.hasPrecedingLineBreak()&&this.eat(0);)if(this.match(3)){let t=this.startNodeAtNode(e);t.elementType=e,this.expect(3),e=this.finishNode(t,"TSArrayType")}else{let t=this.startNodeAtNode(e);t.objectType=e,t.indexType=this.tsParseType(),this.expect(3),e=this.finishNode(t,"TSIndexedAccessType")}return e}tsParseTypeOperator(){let e=this.startNode(),t=this.state.value;return this.next(),e.operator=t,e.typeAnnotation=this.tsParseTypeOperatorOrHigher(),"readonly"===t&&this.tsCheckTypeAnnotationForReadOnly(e),this.finishNode(e,"TSTypeOperator")}tsCheckTypeAnnotationForReadOnly(e){switch(e.typeAnnotation.type){case"TSTupleType":case"TSArrayType":return;default:this.raise(tn.UnexpectedReadonly,e)}}tsParseInferType(){let e=this.startNode();this.expectContextual(115);let t=this.startNode();return t.name=this.tsParseTypeParameterName(),t.constraint=this.tsTryParse((()=>this.tsParseConstraintForInferType())),e.typeParameter=this.finishNode(t,"TSTypeParameter"),this.finishNode(e,"TSInferType")}tsParseConstraintForInferType(){if(this.eat(81)){let e=this.tsInDisallowConditionalTypesContext((()=>this.tsParseType()));if(this.state.inDisallowConditionalTypesContext||!this.match(17))return e}}tsParseTypeOperatorOrHigher(){return ue(this.state.type)&&!this.state.containsEsc?this.tsParseTypeOperator():this.isContextual(115)?this.tsParseInferType():this.tsInAllowConditionalTypesContext((()=>this.tsParseArrayTypeOrHigher()))}tsParseUnionOrIntersectionType(e,t,n){let i=this.startNode(),r=this.eat(n),s=[];do{s.push(t())}while(this.eat(n));return 1!==s.length||r?(i.types=s,this.finishNode(i,e)):s[0]}tsParseIntersectionTypeOrHigher(){return this.tsParseUnionOrIntersectionType("TSIntersectionType",this.tsParseTypeOperatorOrHigher.bind(this),45)}tsParseUnionTypeOrHigher(){return this.tsParseUnionOrIntersectionType("TSUnionType",this.tsParseIntersectionTypeOrHigher.bind(this),43)}tsIsStartOfFunctionType(){return!!this.match(47)||this.match(10)&&this.tsLookAhead(this.tsIsUnambiguouslyStartOfFunctionType.bind(this))}tsSkipParameterStart(){if(q(this.state.type)||this.match(78))return this.next(),!0;if(this.match(5)){let{errors:e}=this.state,t=e.length;try{return this.parseObjectLike(8,!0),e.length===t}catch{return!1}}if(this.match(0)){this.next();let{errors:e}=this.state,t=e.length;try{return super.parseBindingList(3,93,1),e.length===t}catch{return!1}}return!1}tsIsUnambiguouslyStartOfFunctionType(){return this.next(),!!(this.match(11)||this.match(21)||this.tsSkipParameterStart()&&(this.match(14)||this.match(12)||this.match(17)||this.match(29)||this.match(11)&&(this.next(),this.match(19))))}tsParseTypeOrTypePredicateAnnotation(e){return this.tsInType((()=>{let t=this.startNode();this.expect(e);let n=this.startNode(),i=!!this.tsTryParse(this.tsParseTypePredicateAsserts.bind(this));if(i&&this.match(78)){let e=this.tsParseThisTypeOrThisTypePredicate();return"TSThisType"===e.type?(n.parameterName=e,n.asserts=!0,n.typeAnnotation=null,e=this.finishNode(n,"TSTypePredicate")):(this.resetStartLocationFromNode(e,n),e.asserts=!0),t.typeAnnotation=e,this.finishNode(t,"TSTypeAnnotation")}let r=this.tsIsIdentifier()&&this.tsTryParse(this.tsParseTypePredicatePrefix.bind(this));if(!r)return i?(n.parameterName=this.parseIdentifier(),n.asserts=i,n.typeAnnotation=null,t.typeAnnotation=this.finishNode(n,"TSTypePredicate"),this.finishNode(t,"TSTypeAnnotation")):this.tsParseTypeAnnotation(!1,t);let s=this.tsParseTypeAnnotation(!1);return n.parameterName=r,n.typeAnnotation=s,n.asserts=i,t.typeAnnotation=this.finishNode(n,"TSTypePredicate"),this.finishNode(t,"TSTypeAnnotation")}))}tsTryParseTypeOrTypePredicateAnnotation(){if(this.match(14))return this.tsParseTypeOrTypePredicateAnnotation(14)}tsTryParseTypeAnnotation(){if(this.match(14))return this.tsParseTypeAnnotation()}tsTryParseType(){return this.tsEatThenParseType(14)}tsParseTypePredicatePrefix(){let e=this.parseIdentifier();if(this.isContextual(116)&&!this.hasPrecedingLineBreak())return this.next(),e}tsParseTypePredicateAsserts(){if(109!==this.state.type)return!1;let e=this.state.containsEsc;return this.next(),!(!q(this.state.type)&&!this.match(78))&&(e&&this.raise(G.InvalidEscapedReservedWord,this.state.lastTokStartLoc,{reservedWord:"asserts"}),!0)}tsParseTypeAnnotation(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.startNode();return this.tsInType((()=>{e&&this.expect(14),t.typeAnnotation=this.tsParseType()})),this.finishNode(t,"TSTypeAnnotation")}tsParseType(){en(this.state.inType);let e=this.tsParseNonConditionalType();if(this.state.inDisallowConditionalTypesContext||this.hasPrecedingLineBreak()||!this.eat(81))return e;let t=this.startNodeAtNode(e);return t.checkType=e,t.extendsType=this.tsInDisallowConditionalTypesContext((()=>this.tsParseNonConditionalType())),this.expect(17),t.trueType=this.tsInAllowConditionalTypesContext((()=>this.tsParseType())),this.expect(14),t.falseType=this.tsInAllowConditionalTypesContext((()=>this.tsParseType())),this.finishNode(t,"TSConditionalType")}isAbstractConstructorSignature(){return this.isContextual(124)&&77===this.lookahead().type}tsParseNonConditionalType(){return this.tsIsStartOfFunctionType()?this.tsParseFunctionOrConstructorType("TSFunctionType"):this.match(77)?this.tsParseFunctionOrConstructorType("TSConstructorType"):this.isAbstractConstructorSignature()?this.tsParseFunctionOrConstructorType("TSConstructorType",!0):this.tsParseUnionTypeOrHigher()}tsParseTypeAssertion(){this.getPluginOption("typescript","disallowAmbiguousJSXLike")&&this.raise(tn.ReservedTypeAssertion,this.state.startLoc);let e=this.startNode();return e.typeAnnotation=this.tsInType((()=>(this.next(),this.match(75)?this.tsParseTypeReference():this.tsParseType()))),this.expect(48),e.expression=this.parseMaybeUnary(),this.finishNode(e,"TSTypeAssertion")}tsParseHeritageClause(e){let t=this.state.startLoc,n=this.tsParseDelimitedList("HeritageClauseElement",(()=>{let e=this.startNode();return e.expression=this.tsParseEntityName(),this.match(47)&&(e.typeParameters=this.tsParseTypeArguments()),this.finishNode(e,"TSExpressionWithTypeArguments")}));return n.length||this.raise(tn.EmptyHeritageClauseType,t,{token:e}),n}tsParseInterfaceDeclaration(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.hasFollowingLineBreak())return null;this.expectContextual(129),t.declare&&(e.declare=!0),q(this.state.type)?(e.id=this.parseIdentifier(),this.checkIdentifier(e.id,130)):(e.id=null,this.raise(tn.MissingInterfaceName,this.state.startLoc)),e.typeParameters=this.tsTryParseTypeParameters(this.tsParseInOutConstModifiers),this.eat(81)&&(e.extends=this.tsParseHeritageClause("extends"));let n=this.startNode();return n.body=this.tsInType(this.tsParseObjectTypeMembers.bind(this)),e.body=this.finishNode(n,"TSInterfaceBody"),this.finishNode(e,"TSInterfaceDeclaration")}tsParseTypeAliasDeclaration(e){return e.id=this.parseIdentifier(),this.checkIdentifier(e.id,2),e.typeAnnotation=this.tsInType((()=>{if(e.typeParameters=this.tsTryParseTypeParameters(this.tsParseInOutModifiers),this.expect(29),this.isContextual(114)&&16!==this.lookahead().type){let e=this.startNode();return this.next(),this.finishNode(e,"TSIntrinsicKeyword")}return this.tsParseType()})),this.semicolon(),this.finishNode(e,"TSTypeAliasDeclaration")}tsInNoContext(e){let t=this.state.context;this.state.context=[t[0]];try{return e()}finally{this.state.context=t}}tsInType(e){let t=this.state.inType;this.state.inType=!0;try{return e()}finally{this.state.inType=t}}tsInDisallowConditionalTypesContext(e){let t=this.state.inDisallowConditionalTypesContext;this.state.inDisallowConditionalTypesContext=!0;try{return e()}finally{this.state.inDisallowConditionalTypesContext=t}}tsInAllowConditionalTypesContext(e){let t=this.state.inDisallowConditionalTypesContext;this.state.inDisallowConditionalTypesContext=!1;try{return e()}finally{this.state.inDisallowConditionalTypesContext=t}}tsEatThenParseType(e){if(this.match(e))return this.tsNextThenParseType()}tsExpectThenParseType(e){return this.tsInType((()=>(this.expect(e),this.tsParseType())))}tsNextThenParseType(){return this.tsInType((()=>(this.next(),this.tsParseType())))}tsParseEnumMember(){let e=this.startNode();return e.id=this.match(133)?super.parseStringLiteral(this.state.value):this.parseIdentifier(!0),this.eat(29)&&(e.initializer=super.parseMaybeAssignAllowIn()),this.finishNode(e,"TSEnumMember")}tsParseEnumDeclaration(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.const&&(e.const=!0),t.declare&&(e.declare=!0),this.expectContextual(126),e.id=this.parseIdentifier(),this.checkIdentifier(e.id,e.const?8971:8459),this.expect(5),e.members=this.tsParseDelimitedList("EnumMembers",this.tsParseEnumMember.bind(this)),this.expect(8),this.finishNode(e,"TSEnumDeclaration")}tsParseModuleBlock(){let e=this.startNode();return this.scope.enter(0),this.expect(5),super.parseBlockOrModuleBlockBody(e.body=[],void 0,!0,8),this.scope.exit(),this.finishNode(e,"TSModuleBlock")}tsParseModuleOrNamespaceDeclaration(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.id=this.parseIdentifier(),t||this.checkIdentifier(e.id,1024),this.eat(16)){let t=this.startNode();this.tsParseModuleOrNamespaceDeclaration(t,!0),e.body=t}else this.scope.enter(256),this.prodParam.enter(0),e.body=this.tsParseModuleBlock(),this.prodParam.exit(),this.scope.exit();return this.finishNode(e,"TSModuleDeclaration")}tsParseAmbientExternalModuleDeclaration(e){return this.isContextual(112)?(e.global=!0,e.id=this.parseIdentifier()):this.match(133)?e.id=super.parseStringLiteral(this.state.value):this.unexpected(),this.match(5)?(this.scope.enter(256),this.prodParam.enter(0),e.body=this.tsParseModuleBlock(),this.prodParam.exit(),this.scope.exit()):this.semicolon(),this.finishNode(e,"TSModuleDeclaration")}tsParseImportEqualsDeclaration(e,t,n){e.isExport=n||!1,e.id=t||this.parseIdentifier(),this.checkIdentifier(e.id,4096),this.expect(29);let i=this.tsParseModuleReference();return"type"===e.importKind&&"TSExternalModuleReference"!==i.type&&this.raise(tn.ImportAliasHasImportType,i),e.moduleReference=i,this.semicolon(),this.finishNode(e,"TSImportEqualsDeclaration")}tsIsExternalModuleReference(){return this.isContextual(119)&&40===this.lookaheadCharCode()}tsParseModuleReference(){return this.tsIsExternalModuleReference()?this.tsParseExternalModuleReference():this.tsParseEntityName(!1)}tsParseExternalModuleReference(){let e=this.startNode();return this.expectContextual(119),this.expect(10),this.match(133)||this.unexpected(),e.expression=super.parseExprAtom(),this.expect(11),this.sawUnambiguousESM=!0,this.finishNode(e,"TSExternalModuleReference")}tsLookAhead(e){let t=this.state.clone(),n=e();return this.state=t,n}tsTryParseAndCatch(e){let t=this.tryParse((t=>e()||t()));if(!t.aborted&&t.node)return t.error&&(this.state=t.failState),t.node}tsTryParse(e){let t=this.state.clone(),n=e();if(void 0!==n&&!1!==n)return n;this.state=t}tsTryParseDeclare(e){if(this.isLineTerminator())return;let t,n=this.state.type;return this.isContextual(100)&&(n=74,t="let"),this.tsInAmbientContext((()=>{switch(n){case 68:return e.declare=!0,super.parseFunctionStatement(e,!1,!1);case 80:return e.declare=!0,this.parseClass(e,!0,!1);case 126:return this.tsParseEnumDeclaration(e,{declare:!0});case 112:return this.tsParseAmbientExternalModuleDeclaration(e);case 75:case 74:return this.match(75)&&this.isLookaheadContextual("enum")?(this.expect(75),this.tsParseEnumDeclaration(e,{const:!0,declare:!0})):(e.declare=!0,this.parseVarStatement(e,t||this.state.value,!0));case 129:{let t=this.tsParseInterfaceDeclaration(e,{declare:!0});if(t)return t}default:if(q(n))return this.tsParseDeclaration(e,this.state.value,!0,null)}}))}tsTryParseExportDeclaration(){return this.tsParseDeclaration(this.startNode(),this.state.value,!0,null)}tsParseExpressionStatement(e,t,n){switch(t.name){case"declare":{let t=this.tsTryParseDeclare(e);return t&&(t.declare=!0),t}case"global":if(this.match(5)){this.scope.enter(256),this.prodParam.enter(0);let n=e;return n.global=!0,n.id=t,n.body=this.tsParseModuleBlock(),this.scope.exit(),this.prodParam.exit(),this.finishNode(n,"TSModuleDeclaration")}break;default:return this.tsParseDeclaration(e,t.name,!1,n)}}tsParseDeclaration(e,t,n,i){switch(t){case"abstract":if(this.tsCheckLineTerminator(n)&&(this.match(80)||q(this.state.type)))return this.tsParseAbstractDeclaration(e,i);break;case"module":if(this.tsCheckLineTerminator(n)){if(this.match(133))return this.tsParseAmbientExternalModuleDeclaration(e);if(q(this.state.type))return this.tsParseModuleOrNamespaceDeclaration(e)}break;case"namespace":if(this.tsCheckLineTerminator(n)&&q(this.state.type))return this.tsParseModuleOrNamespaceDeclaration(e);break;case"type":if(this.tsCheckLineTerminator(n)&&q(this.state.type))return this.tsParseTypeAliasDeclaration(e)}}tsCheckLineTerminator(e){return e?!this.hasFollowingLineBreak()&&(this.next(),!0):!this.isLineTerminator()}tsTryParseGenericAsyncArrowFunction(e){if(!this.match(47))return;let t=this.state.maybeInArrowParameters;this.state.maybeInArrowParameters=!0;let n=this.tsTryParseAndCatch((()=>{let t=this.startNodeAt(e);return t.typeParameters=this.tsParseTypeParameters(this.tsParseConstModifier),super.parseFunctionParams(t),t.returnType=this.tsTryParseTypeOrTypePredicateAnnotation(),this.expect(19),t}));return this.state.maybeInArrowParameters=t,n?super.parseArrowExpression(n,null,!0):void 0}tsParseTypeArgumentsInExpression(){if(47===this.reScan_lt())return this.tsParseTypeArguments()}tsParseTypeArguments(){let e=this.startNode();return e.params=this.tsInType((()=>this.tsInNoContext((()=>(this.expect(47),this.tsParseDelimitedList("TypeParametersOrArguments",this.tsParseType.bind(this))))))),0===e.params.length?this.raise(tn.EmptyTypeArguments,e):!this.state.inType&&this.curContext()===D.brace&&this.reScan_lt_gt(),this.expect(48),this.finishNode(e,"TSTypeParameterInstantiation")}tsIsDeclarationStart(){return Ae(this.state.type)}isExportDefaultSpecifier(){return!this.tsIsDeclarationStart()&&super.isExportDefaultSpecifier()}parseAssignableListItem(e,t){let n=this.state.startLoc,i={};this.tsParseModifiers({allowedModifiers:["public","private","protected","override","readonly"]},i);let r=i.accessibility,s=i.override,o=i.readonly;!(4&e)&&(r||o||s)&&this.raise(tn.UnexpectedParameterModifier,n);let a=this.parseMaybeDefault();this.parseAssignableListItemTypes(a,e);let l=this.parseMaybeDefault(a.loc.start,a);if(r||o||s){let e=this.startNodeAt(n);return t.length&&(e.decorators=t),r&&(e.accessibility=r),o&&(e.readonly=o),s&&(e.override=s),"Identifier"!==l.type&&"AssignmentPattern"!==l.type&&this.raise(tn.UnsupportedParameterPropertyKind,e),e.parameter=l,this.finishNode(e,"TSParameterProperty")}return t.length&&(a.decorators=t),l}isSimpleParameter(e){return"TSParameterProperty"===e.type&&super.isSimpleParameter(e.parameter)||super.isSimpleParameter(e)}tsDisallowOptionalPattern(e){for(let t of e.params)"Identifier"!==t.type&&t.optional&&!this.state.isAmbientContext&&this.raise(tn.PatternIsOptional,t)}setArrowFunctionParameters(e,t,n){super.setArrowFunctionParameters(e,t,n),this.tsDisallowOptionalPattern(e)}parseFunctionBodyAndFinish(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.match(14)&&(e.returnType=this.tsParseTypeOrTypePredicateAnnotation(14));let i="FunctionDeclaration"===t?"TSDeclareFunction":"ClassMethod"===t||"ClassPrivateMethod"===t?"TSDeclareMethod":void 0;return i&&!this.match(5)&&this.isLineTerminator()?this.finishNode(e,i):"TSDeclareFunction"===i&&this.state.isAmbientContext&&(this.raise(tn.DeclareFunctionHasImplementation,e),e.declare)?super.parseFunctionBodyAndFinish(e,i,n):(this.tsDisallowOptionalPattern(e),super.parseFunctionBodyAndFinish(e,t,n))}registerFunctionStatementId(e){!e.body&&e.id?this.checkIdentifier(e.id,1024):super.registerFunctionStatementId(e)}tsCheckForInvalidTypeCasts(e){e.forEach((e=>{"TSTypeCastExpression"===(null==e?void 0:e.type)&&this.raise(tn.UnexpectedTypeAnnotation,e.typeAnnotation)}))}toReferencedList(e,t){return this.tsCheckForInvalidTypeCasts(e),e}parseArrayLike(e,t,n,i){let r=super.parseArrayLike(e,t,n,i);return"ArrayExpression"===r.type&&this.tsCheckForInvalidTypeCasts(r.elements),r}parseSubscript(e,t,n,i){if(!this.hasPrecedingLineBreak()&&this.match(35)){this.state.canStartJSXElement=!1,this.next();let n=this.startNodeAt(t);return n.expression=e,this.finishNode(n,"TSNonNullExpression")}let r=!1;if(this.match(18)&&60===this.lookaheadCharCode()){if(n)return i.stop=!0,e;i.optionalChainMember=r=!0,this.next()}if(this.match(47)||this.match(51)){let s,o=this.tsTryParseAndCatch((()=>{if(!n&&this.atPossibleAsyncArrow(e)){let e=this.tsTryParseGenericAsyncArrowFunction(t);if(e)return e}let o=this.tsParseTypeArgumentsInExpression();if(!o)return;if(r&&!this.match(10))return void(s=this.state.curPosition());if(pe(this.state.type)){let n=super.parseTaggedTemplateExpression(e,t,i);return n.typeParameters=o,n}if(!n&&this.eat(10)){let n=this.startNodeAt(t);return n.callee=e,n.arguments=this.parseCallExpressionArguments(11,!1),this.tsCheckForInvalidTypeCasts(n.arguments),n.typeParameters=o,i.optionalChainMember&&(n.optional=r),this.finishCallExpression(n,i.optionalChainMember)}let a=this.state.type;if(48===a||52===a||10!==a&&ie(a)&&!this.hasPrecedingLineBreak())return;let l=this.startNodeAt(t);return l.expression=e,l.typeParameters=o,this.finishNode(l,"TSInstantiationExpression")}));if(s&&this.unexpected(s,10),o)return"TSInstantiationExpression"===o.type&&(this.match(16)||this.match(18)&&40!==this.lookaheadCharCode())&&this.raise(tn.InvalidPropertyAccessAfterInstantiationExpression,this.state.startLoc),o}return super.parseSubscript(e,t,n,i)}parseNewCallee(e){var t;super.parseNewCallee(e);let{callee:n}=e;"TSInstantiationExpression"===n.type&&(null==(t=n.extra)||!t.parenthesized)&&(e.typeParameters=n.typeParameters,e.callee=n.expression)}parseExprOp(e,t,n){let i;if(he(58)>n&&!this.hasPrecedingLineBreak()&&(this.isContextual(93)||(i=this.isContextual(120)))){let r=this.startNodeAt(t);return r.expression=e,r.typeAnnotation=this.tsInType((()=>(this.next(),this.match(75)?(i&&this.raise(G.UnexpectedKeyword,this.state.startLoc,{keyword:"const"}),this.tsParseTypeReference()):this.tsParseType()))),this.finishNode(r,i?"TSSatisfiesExpression":"TSAsExpression"),this.reScan_lt_gt(),this.parseExprOp(r,t,n)}return super.parseExprOp(e,t,n)}checkReservedWord(e,t,n,i){this.state.isAmbientContext||super.checkReservedWord(e,t,n,i)}checkImportReflection(e){super.checkImportReflection(e),e.module&&"value"!==e.importKind&&this.raise(tn.ImportReflectionHasImportType,e.specifiers[0].loc.start)}checkDuplicateExports(){}isPotentialImportPhase(e){if(super.isPotentialImportPhase(e))return!0;if(this.isContextual(130)){let t=this.lookaheadCharCode();return e?123===t||42===t:61!==t}return!e&&this.isContextual(87)}applyImportPhase(e,t,n,i){super.applyImportPhase(e,t,n,i),t?e.exportKind="type"===n?"type":"value":e.importKind="type"===n||"typeof"===n?n:"value"}parseImport(e){if(this.match(133))return e.importKind="value",super.parseImport(e);let t;if(q(this.state.type)&&61===this.lookaheadCharCode())return e.importKind="value",this.tsParseImportEqualsDeclaration(e);if(this.isContextual(130)){let n=this.parseMaybeImportPhase(e,!1);if(61===this.lookaheadCharCode())return this.tsParseImportEqualsDeclaration(e,n);t=super.parseImportSpecifiersAndAfter(e,n)}else t=super.parseImport(e);return"type"===t.importKind&&t.specifiers.length>1&&"ImportDefaultSpecifier"===t.specifiers[0].type&&this.raise(tn.TypeImportCannotSpecifyDefaultAndNamed,t),t}parseExport(e,t){if(this.match(83)){this.next();let t=e,n=null;return this.isContextual(130)&&this.isPotentialImportPhase(!1)?n=this.parseMaybeImportPhase(t,!1):t.importKind="value",this.tsParseImportEqualsDeclaration(t,n,!0)}if(this.eat(29)){let t=e;return t.expression=super.parseExpression(),this.semicolon(),this.sawUnambiguousESM=!0,this.finishNode(t,"TSExportAssignment")}if(this.eatContextual(93)){let t=e;return this.expectContextual(128),t.id=this.parseIdentifier(),this.semicolon(),this.finishNode(t,"TSNamespaceExportDeclaration")}return super.parseExport(e,t)}isAbstractClass(){return this.isContextual(124)&&80===this.lookahead().type}parseExportDefaultExpression(){if(this.isAbstractClass()){let e=this.startNode();return this.next(),e.abstract=!0,this.parseClass(e,!0,!0)}if(this.match(129)){let e=this.tsParseInterfaceDeclaration(this.startNode());if(e)return e}return super.parseExportDefaultExpression()}parseVarStatement(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{isAmbientContext:i}=this.state,r=super.parseVarStatement(e,t,n||i);if(!i)return r;for(let{id:s,init:o}of r.declarations)o&&("const"!==t||s.typeAnnotation?this.raise(tn.InitializerNotAllowedInAmbientContext,o):ln(o,this.hasPlugin("estree"))||this.raise(tn.ConstInitiailizerMustBeStringOrNumericLiteralOrLiteralEnumReference,o));return r}parseStatementContent(e,t){if(this.match(75)&&this.isLookaheadContextual("enum")){let e=this.startNode();return this.expect(75),this.tsParseEnumDeclaration(e,{const:!0})}if(this.isContextual(126))return this.tsParseEnumDeclaration(this.startNode());if(this.isContextual(129)){let e=this.tsParseInterfaceDeclaration(this.startNode());if(e)return e}return super.parseStatementContent(e,t)}parseAccessModifier(){return this.tsParseModifier(["public","protected","private"])}tsHasSomeModifiers(e,t){return t.some((t=>rn(t)?e.accessibility===t:!!e[t]))}tsIsStartOfStaticBlocks(){return this.isContextual(106)&&123===this.lookaheadCharCode()}parseClassMember(e,t,n){let i=["declare","private","public","protected","override","abstract","readonly","static"];this.tsParseModifiers({allowedModifiers:i,disallowedModifiers:["in","out"],stopOnStartOfClassStaticBlock:!0,errorTemplate:tn.InvalidModifierOnTypeParameterPositions},t);let r=()=>{this.tsIsStartOfStaticBlocks()?(this.next(),this.next(),this.tsHasSomeModifiers(t,i)&&this.raise(tn.StaticBlockCannotHaveModifier,this.state.curPosition()),super.parseClassStaticBlock(e,t)):this.parseClassMemberWithIsStatic(e,t,n,!!t.static)};t.declare?this.tsInAmbientContext(r):r()}parseClassMemberWithIsStatic(e,t,n,i){let r=this.tsTryParseIndexSignature(t);if(r)return e.body.push(r),t.abstract&&this.raise(tn.IndexSignatureHasAbstract,t),t.accessibility&&this.raise(tn.IndexSignatureHasAccessibility,t,{modifier:t.accessibility}),t.declare&&this.raise(tn.IndexSignatureHasDeclare,t),void(t.override&&this.raise(tn.IndexSignatureHasOverride,t));!this.state.inAbstractClass&&t.abstract&&this.raise(tn.NonAbstractClassHasAbstractMethod,t),t.override&&(n.hadSuperClass||this.raise(tn.OverrideNotInSubClass,t)),super.parseClassMemberWithIsStatic(e,t,n,i)}parsePostMemberNameModifiers(e){this.eat(17)&&(e.optional=!0),e.readonly&&this.match(10)&&this.raise(tn.ClassMethodHasReadonly,e),e.declare&&this.match(10)&&this.raise(tn.ClassMethodHasDeclare,e)}parseExpressionStatement(e,t,n){return("Identifier"===t.type?this.tsParseExpressionStatement(e,t,n):void 0)||super.parseExpressionStatement(e,t,n)}shouldParseExportDeclaration(){return!!this.tsIsDeclarationStart()||super.shouldParseExportDeclaration()}parseConditional(e,t,n){if(!this.state.maybeInArrowParameters||!this.match(17))return super.parseConditional(e,t,n);let i=this.tryParse((()=>super.parseConditional(e,t)));return i.node?(i.error&&(this.state=i.failState),i.node):(i.error&&super.setOptionalParametersError(n,i.error),e)}parseParenItem(e,t){let n=super.parseParenItem(e,t);if(this.eat(17)&&(n.optional=!0,this.resetEndLocation(e)),this.match(14)){let n=this.startNodeAt(t);return n.expression=e,n.typeAnnotation=this.tsParseTypeAnnotation(),this.finishNode(n,"TSTypeCastExpression")}return e}parseExportDeclaration(e){if(!this.state.isAmbientContext&&this.isContextual(125))return this.tsInAmbientContext((()=>this.parseExportDeclaration(e)));let t=this.state.startLoc,n=this.eatContextual(125);if(n&&(this.isContextual(125)||!this.shouldParseExportDeclaration()))throw this.raise(tn.ExpectedAmbientAfterExportDeclare,this.state.startLoc);let i=q(this.state.type)&&this.tsTryParseExportDeclaration()||super.parseExportDeclaration(e);return i?(("TSInterfaceDeclaration"===i.type||"TSTypeAliasDeclaration"===i.type||n)&&(e.exportKind="type"),n&&(this.resetStartLocation(i,t),i.declare=!0),i):null}parseClassId(e,t,n,i){if((!t||n)&&this.isContextual(113))return;super.parseClassId(e,t,n,e.declare?1024:8331);let r=this.tsTryParseTypeParameters(this.tsParseInOutConstModifiers);r&&(e.typeParameters=r)}parseClassPropertyAnnotation(e){e.optional||(this.eat(35)?e.definite=!0:this.eat(17)&&(e.optional=!0));let t=this.tsTryParseTypeAnnotation();t&&(e.typeAnnotation=t)}parseClassProperty(e){if(this.parseClassPropertyAnnotation(e),this.state.isAmbientContext&&!(e.readonly&&!e.typeAnnotation)&&this.match(29)&&this.raise(tn.DeclareClassFieldHasInitializer,this.state.startLoc),e.abstract&&this.match(29)){let{key:t}=e;this.raise(tn.AbstractPropertyHasInitializer,this.state.startLoc,{propertyName:"Identifier"!==t.type||e.computed?"[".concat(this.input.slice(t.start,t.end),"]"):t.name})}return super.parseClassProperty(e)}parseClassPrivateProperty(e){return e.abstract&&this.raise(tn.PrivateElementHasAbstract,e),e.accessibility&&this.raise(tn.PrivateElementHasAccessibility,e,{modifier:e.accessibility}),this.parseClassPropertyAnnotation(e),super.parseClassPrivateProperty(e)}parseClassAccessorProperty(e){return this.parseClassPropertyAnnotation(e),e.optional&&this.raise(tn.AccessorCannotBeOptional,e),super.parseClassAccessorProperty(e)}pushClassMethod(e,t,n,i,r,s){let o=this.tsTryParseTypeParameters(this.tsParseConstModifier);o&&r&&this.raise(tn.ConstructorHasTypeParameters,o);let{declare:a=!1,kind:l}=t;a&&("get"===l||"set"===l)&&this.raise(tn.DeclareAccessor,t,{kind:l}),o&&(t.typeParameters=o),super.pushClassMethod(e,t,n,i,r,s)}pushClassPrivateMethod(e,t,n,i){let r=this.tsTryParseTypeParameters(this.tsParseConstModifier);r&&(t.typeParameters=r),super.pushClassPrivateMethod(e,t,n,i)}declareClassPrivateMethodInScope(e,t){"TSDeclareMethod"!==e.type&&("MethodDefinition"===e.type&&!hasOwnProperty.call(e.value,"body")||super.declareClassPrivateMethodInScope(e,t))}parseClassSuper(e){super.parseClassSuper(e),e.superClass&&(this.match(47)||this.match(51))&&(e.superTypeParameters=this.tsParseTypeArgumentsInExpression()),this.eatContextual(113)&&(e.implements=this.tsParseHeritageClause("implements"))}parseObjPropValue(e,t,n,i,r,s,o){let a=this.tsTryParseTypeParameters(this.tsParseConstModifier);return a&&(e.typeParameters=a),super.parseObjPropValue(e,t,n,i,r,s,o)}parseFunctionParams(e,t){let n=this.tsTryParseTypeParameters(this.tsParseConstModifier);n&&(e.typeParameters=n),super.parseFunctionParams(e,t)}parseVarId(e,t){super.parseVarId(e,t),"Identifier"===e.id.type&&!this.hasPrecedingLineBreak()&&this.eat(35)&&(e.definite=!0);let n=this.tsTryParseTypeAnnotation();n&&(e.id.typeAnnotation=n,this.resetEndLocation(e.id))}parseAsyncArrowFromCallExpression(e,t){return this.match(14)&&(e.returnType=this.tsParseTypeAnnotation()),super.parseAsyncArrowFromCallExpression(e,t)}parseMaybeAssign(e,t){var n,i,r,s,o;let a,l,c;if(this.hasPlugin("jsx")&&(this.match(142)||this.match(47))){if(a=this.state.clone(),l=this.tryParse((()=>super.parseMaybeAssign(e,t)),a),!l.error)return l.node;let{context:n}=this.state,i=n[n.length-1];(i===D.j_oTag||i===D.j_expr)&&n.pop()}if((null==(n=l)||!n.error)&&!this.match(47))return super.parseMaybeAssign(e,t);(!a||a===this.state)&&(a=this.state.clone());let g,u=this.tryParse((n=>{var i,r;g=this.tsParseTypeParameters(this.tsParseConstModifier);let s=super.parseMaybeAssign(e,t);return("ArrowFunctionExpression"!==s.type||null!=(i=s.extra)&&i.parenthesized)&&n(),0!==(null==(r=g)?void 0:r.params.length)&&this.resetStartLocationFromNode(s,g),s.typeParameters=g,s}),a);if(!u.error&&!u.aborted)return g&&this.reportReservedArrowTypeParam(g),u.node;if(!l&&(en(!this.hasPlugin("jsx")),c=this.tryParse((()=>super.parseMaybeAssign(e,t)),a),!c.error))return c.node;if(null!=(i=l)&&i.node)return this.state=l.failState,l.node;if(u.node)return this.state=u.failState,g&&this.reportReservedArrowTypeParam(g),u.node;if(null!=(r=c)&&r.node)return this.state=c.failState,c.node;throw(null==(s=l)?void 0:s.error)||u.error||(null==(o=c)?void 0:o.error)}reportReservedArrowTypeParam(e){var t;1===e.params.length&&!e.params[0].constraint&&(null==(t=e.extra)||!t.trailingComma)&&this.getPluginOption("typescript","disallowAmbiguousJSXLike")&&this.raise(tn.ReservedArrowTypeParam,e)}parseMaybeUnary(e,t){return!this.hasPlugin("jsx")&&this.match(47)?this.tsParseTypeAssertion():super.parseMaybeUnary(e,t)}parseArrow(e){if(this.match(14)){let t=this.tryParse((e=>{let t=this.tsParseTypeOrTypePredicateAnnotation(14);return(this.canInsertSemicolon()||!this.match(19))&&e(),t}));if(t.aborted)return;t.thrown||(t.error&&(this.state=t.failState),e.returnType=t.node)}return super.parseArrow(e)}parseAssignableListItemTypes(e,t){if(!(2&t))return e;this.eat(17)&&(e.optional=!0);let n=this.tsTryParseTypeAnnotation();return n&&(e.typeAnnotation=n),this.resetEndLocation(e),e}isAssignable(e,t){switch(e.type){case"TSTypeCastExpression":return this.isAssignable(e.expression,t);case"TSParameterProperty":return!0;default:return super.isAssignable(e,t)}}toAssignable(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(e.type){case"ParenthesizedExpression":this.toAssignableParenthesizedExpression(e,t);break;case"TSAsExpression":case"TSSatisfiesExpression":case"TSNonNullExpression":case"TSTypeAssertion":t?this.expressionScope.recordArrowParameterBindingError(tn.UnexpectedTypeCastInParameter,e):this.raise(tn.UnexpectedTypeCastInParameter,e),this.toAssignable(e.expression,t);break;case"AssignmentExpression":!t&&"TSTypeCastExpression"===e.left.type&&(e.left=this.typeCastToParameter(e.left));default:super.toAssignable(e,t)}}toAssignableParenthesizedExpression(e,t){switch(e.expression.type){case"TSAsExpression":case"TSSatisfiesExpression":case"TSNonNullExpression":case"TSTypeAssertion":case"ParenthesizedExpression":this.toAssignable(e.expression,t);break;default:super.toAssignable(e,t)}}checkToRestConversion(e,t){switch(e.type){case"TSAsExpression":case"TSSatisfiesExpression":case"TSTypeAssertion":case"TSNonNullExpression":this.checkToRestConversion(e.expression,!1);break;default:super.checkToRestConversion(e,t)}}isValidLVal(e,t,n){return qt({TSTypeCastExpression:!0,TSParameterProperty:"parameter",TSNonNullExpression:"expression",TSInstantiationExpression:"expression",TSAsExpression:(64!==n||!t)&&["expression",!0],TSSatisfiesExpression:(64!==n||!t)&&["expression",!0],TSTypeAssertion:(64!==n||!t)&&["expression",!0]},e)||super.isValidLVal(e,t,n)}parseBindingAtom(){return 78===this.state.type?this.parseIdentifier(!0):super.parseBindingAtom()}parseMaybeDecoratorArguments(e){if(this.match(47)||this.match(51)){let t=this.tsParseTypeArgumentsInExpression();if(this.match(10)){let n=super.parseMaybeDecoratorArguments(e);return n.typeParameters=t,n}this.unexpected(null,10)}return super.parseMaybeDecoratorArguments(e)}checkCommaAfterRest(e){return this.state.isAmbientContext&&this.match(12)&&this.lookaheadCharCode()===e?(this.next(),!1):super.checkCommaAfterRest(e)}isClassMethod(){return this.match(47)||super.isClassMethod()}isClassProperty(){return this.match(35)||this.match(14)||super.isClassProperty()}parseMaybeDefault(e,t){let n=super.parseMaybeDefault(e,t);return"AssignmentPattern"===n.type&&n.typeAnnotation&&n.right.start<n.typeAnnotation.start&&this.raise(tn.TypeAnnotationAfterAssign,n.typeAnnotation),n}getTokenFromCode(e){if(this.state.inType){if(62===e)return void this.finishOp(48,1);if(60===e)return void this.finishOp(47,1)}super.getTokenFromCode(e)}reScan_lt_gt(){let{type:e}=this.state;47===e?(this.state.pos-=1,this.readToken_lt()):48===e&&(this.state.pos-=1,this.readToken_gt())}reScan_lt(){let{type:e}=this.state;return 51===e?(this.state.pos-=2,this.finishOp(47,1),47):e}toAssignableList(e,t,n){for(let i=0;i<e.length;i++){let t=e[i];"TSTypeCastExpression"===(null==t?void 0:t.type)&&(e[i]=this.typeCastToParameter(t))}super.toAssignableList(e,t,n)}typeCastToParameter(e){return e.expression.typeAnnotation=e.typeAnnotation,this.resetEndLocation(e.expression,e.typeAnnotation.loc.end),e.expression}shouldParseArrow(e){return this.match(14)?e.every((e=>this.isAssignable(e,!0))):super.shouldParseArrow(e)}shouldParseAsyncArrow(){return this.match(14)||super.shouldParseAsyncArrow()}canHaveLeadingDecorator(){return super.canHaveLeadingDecorator()||this.isAbstractClass()}jsxParseOpeningElementAfterName(e){if(this.match(47)||this.match(51)){let t=this.tsTryParseAndCatch((()=>this.tsParseTypeArgumentsInExpression()));t&&(e.typeParameters=t)}return super.jsxParseOpeningElementAfterName(e)}getGetterSetterExpectedParamCount(e){let t=super.getGetterSetterExpectedParamCount(e),n=this.getObjectOrClassMethodParams(e)[0];return n&&this.isThisParam(n)?t+1:t}parseCatchClauseParam(){let e=super.parseCatchClauseParam(),t=this.tsTryParseTypeAnnotation();return t&&(e.typeAnnotation=t,this.resetEndLocation(e)),e}tsInAmbientContext(e){let{isAmbientContext:t,strict:n}=this.state;this.state.isAmbientContext=!0,this.state.strict=!1;try{return e()}finally{this.state.isAmbientContext=t,this.state.strict=n}}parseClass(e,t,n){let i=this.state.inAbstractClass;this.state.inAbstractClass=!!e.abstract;try{return super.parseClass(e,t,n)}finally{this.state.inAbstractClass=i}}tsParseAbstractDeclaration(e,t){if(this.match(80))return e.abstract=!0,this.maybeTakeDecorators(t,this.parseClass(e,!0,!1));if(this.isContextual(129)){if(!this.hasFollowingLineBreak())return e.abstract=!0,this.raise(tn.NonClassMethodPropertyHasAbstractModifer,e),this.tsParseInterfaceDeclaration(e)}else this.unexpected(null,80)}parseMethod(e,t,n,i,r,s,o){let a=super.parseMethod(e,t,n,i,r,s,o);if(a.abstract&&(this.hasPlugin("estree")?a.value.body:a.body)){let{key:e}=a;this.raise(tn.AbstractMethodHasImplementation,a,{methodName:"Identifier"!==e.type||a.computed?"[".concat(this.input.slice(e.start,e.end),"]"):e.name})}return a}tsParseTypeParameterName(){return this.parseIdentifier().name}shouldParseAsAmbientContext(){return!!this.getPluginOption("typescript","dts")}parse(){return this.shouldParseAsAmbientContext()&&(this.state.isAmbientContext=!0),super.parse()}getExpression(){return this.shouldParseAsAmbientContext()&&(this.state.isAmbientContext=!0),super.getExpression()}parseExportSpecifier(e,t,n,i){return!t&&i?(this.parseTypeOnlyImportExportSpecifier(e,!1,n),this.finishNode(e,"ExportSpecifier")):(e.exportKind="value",super.parseExportSpecifier(e,t,n,i))}parseImportSpecifier(e,t,n,i,r){return!t&&i?(this.parseTypeOnlyImportExportSpecifier(e,!0,n),this.finishNode(e,"ImportSpecifier")):(e.importKind="value",super.parseImportSpecifier(e,t,n,i,n?4098:4096))}parseTypeOnlyImportExportSpecifier(e,t,n){let i,r=t?"imported":"local",s=t?"local":"exported",o=e[r],a=!1,l=!0,c=o.loc.start;if(this.isContextual(93)){let e=this.parseIdentifier();if(this.isContextual(93)){let n=this.parseIdentifier();ee(this.state.type)?(a=!0,o=e,i=t?this.parseIdentifier():this.parseModuleExportName(),l=!1):(i=n,l=!1)}else ee(this.state.type)?(l=!1,i=t?this.parseIdentifier():this.parseModuleExportName()):(a=!0,o=e)}else ee(this.state.type)&&(a=!0,t?(o=this.parseIdentifier(!0),this.isContextual(93)||this.checkReservedWord(o.name,o.loc.start,!0,!0)):o=this.parseModuleExportName());a&&n&&this.raise(t?tn.TypeModifierIsUsedInTypeImports:tn.TypeModifierIsUsedInTypeExports,c),e[r]=o,e[s]=i,e[t?"importKind":"exportKind"]=a?"type":"value",l&&this.eatContextual(93)&&(e[s]=t?this.parseIdentifier():this.parseModuleExportName()),e[s]||(e[s]=Ft(e[r])),t&&this.checkIdentifier(e[s],a?4098:4096)}};function an(e){if("MemberExpression"!==e.type)return!1;let{computed:t,property:n}=e;return(!t||"StringLiteral"===n.type||!("TemplateLiteral"!==n.type||n.expressions.length>0))&&un(e.object)}function ln(e,t){var n;let{type:i}=e;if(null!=(n=e.extra)&&n.parenthesized)return!1;if(t){if("Literal"===i){let{value:t}=e;if("string"==typeof t||"boolean"==typeof t)return!0}}else if("StringLiteral"===i||"BooleanLiteral"===i)return!0;return!!(cn(e,t)||gn(e,t)||"TemplateLiteral"===i&&0===e.expressions.length||an(e))}function cn(e,t){return t?"Literal"===e.type&&("number"==typeof e.value||"bigint"in e):"NumericLiteral"===e.type||"BigIntLiteral"===e.type}function gn(e,t){if("UnaryExpression"===e.type){let{operator:n,argument:i}=e;if("-"===n&&cn(i,t))return!0}return!1}function un(e){return"Identifier"===e.type||"MemberExpression"===e.type&&!e.computed&&un(e.object)}var An=w(a||(a=l(["placeholders"])))({ClassNameIsRequired:"A class name is required.",UnexpectedSpace:"Unexpected space in placeholder."}),dn=e=>class extends e{parsePlaceholder(e){if(this.match(144)){let t=this.startNode();return this.next(),this.assertNoSpace(),t.name=super.parseIdentifier(!0),this.assertNoSpace(),this.expect(144),this.finishPlaceholder(t,e)}}finishPlaceholder(e,t){let n=e;return(!n.expectedNode||!n.type)&&(n=this.finishNode(n,"Placeholder")),n.expectedNode=t,n}getTokenFromCode(e){37===e&&37===this.input.charCodeAt(this.state.pos+1)?this.finishOp(144,2):super.getTokenFromCode(e)}parseExprAtom(e){return this.parsePlaceholder("Expression")||super.parseExprAtom(e)}parseIdentifier(e){return this.parsePlaceholder("Identifier")||super.parseIdentifier(e)}checkReservedWord(e,t,n,i){void 0!==e&&super.checkReservedWord(e,t,n,i)}parseBindingAtom(){return this.parsePlaceholder("Pattern")||super.parseBindingAtom()}isValidLVal(e,t,n){return"Placeholder"===e||super.isValidLVal(e,t,n)}toAssignable(e,t){e&&"Placeholder"===e.type&&"Expression"===e.expectedNode?e.expectedNode="Pattern":super.toAssignable(e,t)}chStartsBindingIdentifier(e,t){return!(!super.chStartsBindingIdentifier(e,t)&&144!==this.lookahead().type)}verifyBreakContinue(e,t){e.label&&"Placeholder"===e.label.type||super.verifyBreakContinue(e,t)}parseExpressionStatement(e,t){var n;if("Placeholder"!==t.type||null!=(n=t.extra)&&n.parenthesized)return super.parseExpressionStatement(e,t);if(this.match(14)){let n=e;return n.label=this.finishPlaceholder(t,"Identifier"),this.next(),n.body=super.parseStatementOrSloppyAnnexBFunctionDeclaration(),this.finishNode(n,"LabeledStatement")}this.semicolon();let i=e;return i.name=t.name,this.finishPlaceholder(i,"Statement")}parseBlock(e,t,n){return this.parsePlaceholder("BlockStatement")||super.parseBlock(e,t,n)}parseFunctionId(e){return this.parsePlaceholder("Identifier")||super.parseFunctionId(e)}parseClass(e,t,n){let i=t?"ClassDeclaration":"ClassExpression";this.next();let r=this.state.strict,s=this.parsePlaceholder("Identifier");if(s){if(!(this.match(81)||this.match(144)||this.match(5))){if(n||!t)return e.id=null,e.body=this.finishPlaceholder(s,"ClassBody"),this.finishNode(e,i);throw this.raise(An.ClassNameIsRequired,this.state.startLoc)}e.id=s}else this.parseClassId(e,t,n);return super.parseClassSuper(e),e.body=this.parsePlaceholder("ClassBody")||super.parseClassBody(!!e.superClass,r),this.finishNode(e,i)}parseExport(e,t){let n=this.parsePlaceholder("Identifier");if(!n)return super.parseExport(e,t);let i=e;if(!this.isContextual(98)&&!this.match(12))return i.specifiers=[],i.source=null,i.declaration=this.finishPlaceholder(n,"Declaration"),this.finishNode(i,"ExportNamedDeclaration");this.expectPlugin("exportDefaultFrom");let r=this.startNode();return r.exported=n,i.specifiers=[this.finishNode(r,"ExportDefaultSpecifier")],super.parseExport(i,t)}isExportDefaultSpecifier(){if(this.match(65)){let e=this.nextTokenStart();if(this.isUnparsedContextual(e,"from")&&this.input.startsWith(de(144),this.nextTokenStartSince(e+4)))return!0}return super.isExportDefaultSpecifier()}maybeParseExportDefaultSpecifier(e,t){var n;return!(null==(n=e.specifiers)||!n.length)||super.maybeParseExportDefaultSpecifier(e,t)}checkExport(e){let{specifiers:t}=e;null!=t&&t.length&&(e.specifiers=t.filter((e=>"Placeholder"===e.exported.type))),super.checkExport(e),e.specifiers=t}parseImport(e){let t=this.parsePlaceholder("Identifier");if(!t)return super.parseImport(e);if(e.specifiers=[],!this.isContextual(98)&&!this.match(12))return e.source=this.finishPlaceholder(t,"StringLiteral"),this.semicolon(),this.finishNode(e,"ImportDeclaration");let n=this.startNodeAtNode(t);return n.local=t,e.specifiers.push(this.finishNode(n,"ImportDefaultSpecifier")),this.eat(12)&&(this.maybeParseStarImportSpecifier(e)||this.parseNamedImportSpecifiers(e)),this.expectContextual(98),e.source=this.parseImportSource(),this.semicolon(),this.finishNode(e,"ImportDeclaration")}parseImportSource(){return this.parsePlaceholder("StringLiteral")||super.parseImportSource()}assertNoSpace(){this.state.start>this.state.lastTokEndLoc.index&&this.raise(An.UnexpectedSpace,this.state.lastTokEndLoc)}},hn=e=>class extends e{parseV8Intrinsic(){if(this.match(54)){let e=this.state.startLoc,t=this.startNode();if(this.next(),q(this.state.type)){let e=this.parseIdentifierName(),n=this.createIdentifier(t,e);if(n.type="V8IntrinsicIdentifier",this.match(10))return n}this.unexpected(e)}}parseExprAtom(e){return this.parseV8Intrinsic()||super.parseExprAtom(e)}};function In(e,t){let[n,i]="string"==typeof t?[t,{}]:t,r=Object.keys(i),s=0===r.length;return e.some((e=>{if("string"==typeof e)return s&&e===n;{let[t,s]=e;if(t!==n)return!1;for(let e of r)if(s[e]!==i[e])return!1;return!0}}))}function pn(e,t,n){let i=e.find((e=>Array.isArray(e)?e[0]===t:e===t));return i&&Array.isArray(i)&&i.length>1?i[1][n]:null}var Cn=["minimal","fsharp","hack","smart"],mn=["^^","@@","^","%","#"];function fn(e){if(In(e,"decorators")){if(In(e,"decorators-legacy"))throw new Error("Cannot use the decorators and decorators-legacy plugin together");let t=pn(e,"decorators","decoratorsBeforeExport");if(null!=t&&"boolean"!=typeof t)throw new Error("'decoratorsBeforeExport' must be a boolean, if specified.");let n=pn(e,"decorators","allowCallParenthesized");if(null!=n&&"boolean"!=typeof n)throw new Error("'allowCallParenthesized' must be a boolean.")}if(In(e,"flow")&&In(e,"typescript"))throw new Error("Cannot combine flow and typescript plugins.");if(In(e,"placeholders")&&In(e,"v8intrinsic"))throw new Error("Cannot combine placeholders and v8intrinsic plugins.");if(In(e,"pipelineOperator")){let t=pn(e,"pipelineOperator","proposal");if(!Cn.includes(t)){let e=Cn.map((e=>'"'.concat(e,'"'))).join(", ");throw new Error('"pipelineOperator" requires "proposal" option whose value must be one of: '.concat(e,"."))}let n=["recordAndTuple",{syntaxType:"hash"}],i=In(e,n);if("hack"===t){if(In(e,"placeholders"))throw new Error("Cannot combine placeholders plugin and Hack-style pipes.");if(In(e,"v8intrinsic"))throw new Error("Cannot combine v8intrinsic plugin and Hack-style pipes.");let t=pn(e,"pipelineOperator","topicToken");if(!mn.includes(t)){let e=mn.map((e=>'"'.concat(e,'"'))).join(", ");throw new Error('"pipelineOperator" in "proposal": "hack" mode also requires a "topicToken" option whose value must be one of: '.concat(e,"."))}if("#"===t&&i)throw new Error('Plugin conflict between `["pipelineOperator", { proposal: "hack", topicToken: "#" }]` and `'.concat(JSON.stringify(n),"`."))}else if("smart"===t&&i)throw new Error('Plugin conflict between `["pipelineOperator", { proposal: "smart" }]` and `'.concat(JSON.stringify(n),"`."))}if(In(e,"moduleAttributes")){if(In(e,"importAssertions")||In(e,"importAttributes"))throw new Error("Cannot combine importAssertions, importAttributes and moduleAttributes plugins.");if("may-2020"!==pn(e,"moduleAttributes","version"))throw new Error("The 'moduleAttributes' plugin requires a 'version' option, representing the last proposal update. Currently, the only supported value is 'may-2020'.")}if(In(e,"importAssertions")&&In(e,"importAttributes"))throw new Error("Cannot combine importAssertions and importAttributes plugins.");if(In(e,"recordAndTuple")){let t=pn(e,"recordAndTuple","syntaxType");if(null!=t){let e=["hash","bar"];if(!e.includes(t))throw new Error("The 'syntaxType' option of the 'recordAndTuple' plugin must be one of: "+e.map((e=>"'".concat(e,"'"))).join(", "))}}if(In(e,"asyncDoExpressions")&&!In(e,"doExpressions")){let e=new Error("'asyncDoExpressions' requires 'doExpressions', please add 'doExpressions' to parser plugins.");throw e.missingPlugins="doExpressions",e}if(In(e,"optionalChainingAssign")&&"2023-07"!==pn(e,"optionalChainingAssign","version"))throw new Error("The 'optionalChainingAssign' plugin requires a 'version' option, representing the last proposal update. Currently, the only supported value is '2023-07'.")}var yn={estree:R,jsx:Pt,flow:Kt,typescript:on,v8intrinsic:hn,placeholders:dn},bn=Object.keys(yn),Bn={sourceType:"script",sourceFilename:void 0,startColumn:0,startLine:1,allowAwaitOutsideFunction:!1,allowReturnOutsideFunction:!1,allowNewTargetOutsideFunction:!1,allowImportExportEverywhere:!1,allowSuperOutsideMethod:!1,allowUndeclaredExports:!1,plugins:[],strictMode:null,ranges:!1,tokens:!1,createImportExpressions:!1,createParenthesizedExpressions:!1,errorRecovery:!1,attachComment:!0,annexB:!0};function vn(e){if(null==e)return Object.assign({},Bn);if(null!=e.annexB&&!1!==e.annexB)throw new Error("The `annexB` option can only be set to `false`.");let t={};for(let i of Object.keys(Bn)){var n;t[i]=null!=(n=e[i])?n:Bn[i]}return t}var wn=class extends jt{checkProto(e,t,n,i){if("SpreadElement"===e.type||this.isObjectMethod(e)||e.computed||e.shorthand)return;let r=e.key;if("__proto__"===("Identifier"===r.type?r.name:r.value)){if(t)return void this.raise(G.RecordNoProto,r);n.used&&(i?null===i.doubleProtoLoc&&(i.doubleProtoLoc=r.loc.start):this.raise(G.DuplicateProto,r)),n.used=!0}}shouldExitDescending(e,t){return"ArrowFunctionExpression"===e.type&&e.start===t}getExpression(){this.enterInitialScopes(),this.nextToken();let e=this.parseExpression();return this.match(139)||this.unexpected(),this.finalizeRemainingComments(),e.comments=this.comments,e.errors=this.state.errors,this.options.tokens&&(e.tokens=this.tokens),e}parseExpression(e,t){return e?this.disallowInAnd((()=>this.parseExpressionBase(t))):this.allowInAnd((()=>this.parseExpressionBase(t)))}parseExpressionBase(e){let t=this.state.startLoc,n=this.parseMaybeAssign(e);if(this.match(12)){let i=this.startNodeAt(t);for(i.expressions=[n];this.eat(12);)i.expressions.push(this.parseMaybeAssign(e));return this.toReferencedList(i.expressions),this.finishNode(i,"SequenceExpression")}return n}parseMaybeAssignDisallowIn(e,t){return this.disallowInAnd((()=>this.parseMaybeAssign(e,t)))}parseMaybeAssignAllowIn(e,t){return this.allowInAnd((()=>this.parseMaybeAssign(e,t)))}setOptionalParametersError(e,t){var n;e.optionalParametersLoc=null!=(n=null==t?void 0:t.loc)?n:this.state.startLoc}parseMaybeAssign(e,t){let n,i=this.state.startLoc;if(this.isContextual(108)&&this.prodParam.hasYield){let e=this.parseYield();return t&&(e=t.call(this,e,i)),e}e?n=!1:(e=new St,n=!0);let{type:r}=this.state;(10===r||q(r))&&(this.state.potentialArrowAt=this.state.start);let s=this.parseMaybeConditional(e);if(t&&(s=t.call(this,s,i)),re(this.state.type)){let t=this.startNodeAt(i),n=this.state.value;if(t.operator=n,this.match(29)){this.toAssignable(s,!0),t.left=s;let n=i.index;null!=e.doubleProtoLoc&&e.doubleProtoLoc.index>=n&&(e.doubleProtoLoc=null),null!=e.shorthandAssignLoc&&e.shorthandAssignLoc.index>=n&&(e.shorthandAssignLoc=null),null!=e.privateKeyLoc&&e.privateKeyLoc.index>=n&&(this.checkDestructuringPrivate(e),e.privateKeyLoc=null)}else t.left=s;return this.next(),t.right=this.parseMaybeAssign(),this.checkLVal(s,{in:this.finishNode(t,"AssignmentExpression")}),t}return n&&this.checkExpressionErrors(e,!0),s}parseMaybeConditional(e){let t=this.state.startLoc,n=this.state.potentialArrowAt,i=this.parseExprOps(e);return this.shouldExitDescending(i,n)?i:this.parseConditional(i,t,e)}parseConditional(e,t,n){if(this.eat(17)){let n=this.startNodeAt(t);return n.test=e,n.consequent=this.parseMaybeAssignAllowIn(),this.expect(14),n.alternate=this.parseMaybeAssign(),this.finishNode(n,"ConditionalExpression")}return e}parseMaybeUnaryOrPrivate(e){return this.match(138)?this.parsePrivateName():this.parseMaybeUnary(e)}parseExprOps(e){let t=this.state.startLoc,n=this.state.potentialArrowAt,i=this.parseMaybeUnaryOrPrivate(e);return this.shouldExitDescending(i,n)?i:this.parseExprOp(i,t,-1)}parseExprOp(e,t,n){if(this.isPrivateName(e)){let t=this.getPrivateNameSV(e);(n>=he(58)||!this.prodParam.hasIn||!this.match(58))&&this.raise(G.PrivateInExpectedIn,e,{identifierName:t}),this.classScope.usePrivateName(t,e.loc.start)}let i=this.state.type;if(le(i)&&(this.prodParam.hasIn||!this.match(58))){let r=he(i);if(r>n){if(39===i){if(this.expectPlugin("pipelineOperator"),this.state.inFSharpPipelineDirectBody)return e;this.checkPipelineAtInfixOperator(e,t)}let s=this.startNodeAt(t);s.left=e,s.operator=this.state.value;let o=41===i||42===i,a=40===i;if(a&&(r=he(42)),this.next(),39===i&&this.hasPlugin(["pipelineOperator",{proposal:"minimal"}])&&96===this.state.type&&this.prodParam.hasAwait)throw this.raise(G.UnexpectedAwaitAfterPipelineBody,this.state.startLoc);s.right=this.parseExprOpRightExpr(i,r);let l=this.finishNode(s,o||a?"LogicalExpression":"BinaryExpression"),c=this.state.type;if(a&&(41===c||42===c)||o&&40===c)throw this.raise(G.MixingCoalesceWithLogical,this.state.startLoc);return this.parseExprOp(l,t,n)}}return e}parseExprOpRightExpr(e,t){let n=this.state.startLoc;if(39===e)switch(this.getPluginOption("pipelineOperator","proposal")){case"hack":return this.withTopicBindingContext((()=>this.parseHackPipeBody()));case"smart":return this.withTopicBindingContext((()=>{if(this.prodParam.hasYield&&this.isContextual(108))throw this.raise(G.PipeBodyIsTighter,this.state.startLoc);return this.parseSmartPipelineBodyInStyle(this.parseExprOpBaseRightExpr(e,t),n)}));case"fsharp":return this.withSoloAwaitPermittingContext((()=>this.parseFSharpPipelineBody(t)))}return this.parseExprOpBaseRightExpr(e,t)}parseExprOpBaseRightExpr(e,t){let n=this.state.startLoc;return this.parseExprOp(this.parseMaybeUnaryOrPrivate(),n,Ie(e)?t-1:t)}parseHackPipeBody(){var e;let{startLoc:t}=this.state,n=this.parseMaybeAssign();return m.has(n.type)&&!(null!=(e=n.extra)&&e.parenthesized)&&this.raise(G.PipeUnparenthesizedBody,t,{type:n.type}),this.topicReferenceWasUsedInCurrentContext()||this.raise(G.PipeTopicUnused,t),n}checkExponentialAfterUnary(e){this.match(57)&&this.raise(G.UnexpectedTokenUnaryExponentiation,e.argument)}parseMaybeUnary(e,t){let n=this.state.startLoc,i=this.isContextual(96);if(i&&this.isAwaitAllowed()){this.next();let e=this.parseAwait(n);return t||this.checkExponentialAfterUnary(e),e}let r=this.match(34),s=this.startNode();if(ge(this.state.type)){s.operator=this.state.value,s.prefix=!0,this.match(72)&&this.expectPlugin("throwExpressions");let n=this.match(89);if(this.next(),s.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(e,!0),this.state.strict&&n){let e=s.argument;"Identifier"===e.type?this.raise(G.StrictDelete,s):this.hasPropertyAsPrivateName(e)&&this.raise(G.DeletePrivateField,s)}if(!r)return t||this.checkExponentialAfterUnary(s),this.finishNode(s,"UnaryExpression")}let o=this.parseUpdate(s,r,e);if(i){let{type:e}=this.state;if((this.hasPlugin("v8intrinsic")?ie(e):ie(e)&&!this.match(54))&&!this.isAmbiguousAwait())return this.raiseOverwrite(G.AwaitNotInAsyncContext,n),this.parseAwait(n)}return o}parseUpdate(e,t,n){if(t){let t=e;return this.checkLVal(t.argument,{in:this.finishNode(t,"UpdateExpression")}),e}let i=this.state.startLoc,r=this.parseExprSubscripts(n);if(this.checkExpressionErrors(n,!1))return r;for(;ce(this.state.type)&&!this.canInsertSemicolon();){let e=this.startNodeAt(i);e.operator=this.state.value,e.prefix=!1,e.argument=r,this.next(),this.checkLVal(r,{in:r=this.finishNode(e,"UpdateExpression")})}return r}parseExprSubscripts(e){let t=this.state.startLoc,n=this.state.potentialArrowAt,i=this.parseExprAtom(e);return this.shouldExitDescending(i,n)?i:this.parseSubscripts(i,t)}parseSubscripts(e,t,n){let i={optionalChainMember:!1,maybeAsyncArrow:this.atPossibleAsyncArrow(e),stop:!1};do{e=this.parseSubscript(e,t,n,i),i.maybeAsyncArrow=!1}while(!i.stop);return e}parseSubscript(e,t,n,i){let{type:r}=this.state;if(!n&&15===r)return this.parseBind(e,t,n,i);if(pe(r))return this.parseTaggedTemplateExpression(e,t,i);let s=!1;if(18===r){if(n&&(this.raise(G.OptionalChainingNoNew,this.state.startLoc),40===this.lookaheadCharCode()))return i.stop=!0,e;i.optionalChainMember=s=!0,this.next()}if(!n&&this.match(10))return this.parseCoverCallAndAsyncArrowHead(e,t,i,s);{let n=this.eat(0);return n||s||this.eat(16)?this.parseMember(e,t,i,n,s):(i.stop=!0,e)}}parseMember(e,t,n,i,r){let s=this.startNodeAt(t);return s.object=e,s.computed=i,i?(s.property=this.parseExpression(),this.expect(3)):this.match(138)?("Super"===e.type&&this.raise(G.SuperPrivateField,t),this.classScope.usePrivateName(this.state.value,this.state.startLoc),s.property=this.parsePrivateName()):s.property=this.parseIdentifier(!0),n.optionalChainMember?(s.optional=r,this.finishNode(s,"OptionalMemberExpression")):this.finishNode(s,"MemberExpression")}parseBind(e,t,n,i){let r=this.startNodeAt(t);return r.object=e,this.next(),r.callee=this.parseNoCallExpr(),i.stop=!0,this.parseSubscripts(this.finishNode(r,"BindExpression"),t,n)}parseCoverCallAndAsyncArrowHead(e,t,n,i){let r=this.state.maybeInArrowParameters,s=null;this.state.maybeInArrowParameters=!0,this.next();let o=this.startNodeAt(t);o.callee=e;let{maybeAsyncArrow:a,optionalChainMember:l}=n;a&&(this.expressionScope.enter(vt()),s=new St),l&&(o.optional=i),o.arguments=i?this.parseCallExpressionArguments(11):this.parseCallExpressionArguments(11,"Import"===e.type,"Super"!==e.type,o,s);let c=this.finishCallExpression(o,l);return a&&this.shouldParseAsyncArrow()&&!i?(n.stop=!0,this.checkDestructuringPrivate(s),this.expressionScope.validateAsPattern(),this.expressionScope.exit(),c=this.parseAsyncArrowFromCallExpression(this.startNodeAt(t),c)):(a&&(this.checkExpressionErrors(s,!0),this.expressionScope.exit()),this.toReferencedArguments(c)),this.state.maybeInArrowParameters=r,c}toReferencedArguments(e,t){this.toReferencedListDeep(e.arguments,t)}parseTaggedTemplateExpression(e,t,n){let i=this.startNodeAt(t);return i.tag=e,i.quasi=this.parseTemplate(!0),n.optionalChainMember&&this.raise(G.OptionalChainingNoTemplate,t),this.finishNode(i,"TaggedTemplateExpression")}atPossibleAsyncArrow(e){return"Identifier"===e.type&&"async"===e.name&&this.state.lastTokEndLoc.index===e.end&&!this.canInsertSemicolon()&&e.end-e.start===5&&e.start===this.state.potentialArrowAt}expectImportAttributesPlugin(){this.hasPlugin("importAssertions")||this.expectPlugin("importAttributes")}finishCallExpression(e,t){if("Import"===e.callee.type)if(2===e.arguments.length&&(this.hasPlugin("moduleAttributes")||this.expectImportAttributesPlugin()),0===e.arguments.length||e.arguments.length>2)this.raise(G.ImportCallArity,e,{maxArgumentCount:this.hasPlugin("importAttributes")||this.hasPlugin("importAssertions")||this.hasPlugin("moduleAttributes")?2:1});else for(let n of e.arguments)"SpreadElement"===n.type&&this.raise(G.ImportCallSpreadArgument,n);return this.finishNode(e,t?"OptionalCallExpression":"CallExpression")}parseCallExpressionArguments(e,t,n,i,r){let s=[],o=!0,a=this.state.inFSharpPipelineDirectBody;for(this.state.inFSharpPipelineDirectBody=!1;!this.eat(e);){if(o)o=!1;else if(this.expect(12),this.match(e)){t&&!this.hasPlugin("importAttributes")&&!this.hasPlugin("importAssertions")&&!this.hasPlugin("moduleAttributes")&&this.raise(G.ImportCallArgumentTrailingComma,this.state.lastTokStartLoc),i&&this.addTrailingCommaExtraToNode(i),this.next();break}s.push(this.parseExprListItem(!1,r,n))}return this.state.inFSharpPipelineDirectBody=a,s}shouldParseAsyncArrow(){return this.match(19)&&!this.canInsertSemicolon()}parseAsyncArrowFromCallExpression(e,t){var n;return this.resetPreviousNodeTrailingComments(t),this.expect(19),this.parseArrowExpression(e,t.arguments,!0,null==(n=t.extra)?void 0:n.trailingCommaLoc),t.innerComments&&Pe(e,t.innerComments),t.callee.trailingComments&&Pe(e,t.callee.trailingComments),e}parseNoCallExpr(){let e=this.state.startLoc;return this.parseSubscripts(this.parseExprAtom(),e,!0)}parseExprAtom(e){let t,n=null,{type:i}=this.state;switch(i){case 79:return this.parseSuper();case 83:return t=this.startNode(),this.next(),this.match(16)?this.parseImportMetaProperty(t):this.match(10)?this.options.createImportExpressions?this.parseImportCall(t):this.finishNode(t,"Import"):(this.raise(G.UnsupportedImport,this.state.lastTokStartLoc),this.finishNode(t,"Import"));case 78:return t=this.startNode(),this.next(),this.finishNode(t,"ThisExpression");case 90:return this.parseDo(this.startNode(),!1);case 56:case 31:return this.readRegexp(),this.parseRegExpLiteral(this.state.value);case 134:return this.parseNumericLiteral(this.state.value);case 135:return this.parseBigIntLiteral(this.state.value);case 136:return this.parseDecimalLiteral(this.state.value);case 133:return this.parseStringLiteral(this.state.value);case 84:return this.parseNullLiteral();case 85:return this.parseBooleanLiteral(!0);case 86:return this.parseBooleanLiteral(!1);case 10:{let e=this.state.potentialArrowAt===this.state.start;return this.parseParenAndDistinguishExpression(e)}case 2:case 1:return this.parseArrayLike(2===this.state.type?4:3,!1,!0);case 0:return this.parseArrayLike(3,!0,!1,e);case 6:case 7:return this.parseObjectLike(6===this.state.type?9:8,!1,!0);case 5:return this.parseObjectLike(8,!1,!1,e);case 68:return this.parseFunctionOrFunctionSent();case 26:n=this.parseDecorators();case 80:return this.parseClass(this.maybeTakeDecorators(n,this.startNode()),!1);case 77:return this.parseNewOrNewTarget();case 25:case 24:return this.parseTemplate(!1);case 15:{t=this.startNode(),this.next(),t.object=null;let e=t.callee=this.parseNoCallExpr();if("MemberExpression"===e.type)return this.finishNode(t,"BindExpression");throw this.raise(G.UnsupportedBind,e)}case 138:return this.raise(G.PrivateInExpectedIn,this.state.startLoc,{identifierName:this.state.value}),this.parsePrivateName();case 33:return this.parseTopicReferenceThenEqualsSign(54,"%");case 32:return this.parseTopicReferenceThenEqualsSign(44,"^");case 37:case 38:return this.parseTopicReference("hack");case 44:case 54:case 27:{let e=this.getPluginOption("pipelineOperator","proposal");if(e)return this.parseTopicReference(e);this.unexpected();break}case 47:{let e=this.input.codePointAt(this.nextTokenStart());Ge(e)||62===e?this.expectOnePlugin(["jsx","flow","typescript"]):this.unexpected();break}default:if(q(i)){if(this.isContextual(127)&&123===this.lookaheadInLineCharCode())return this.parseModuleExpression();let e=this.state.potentialArrowAt===this.state.start,t=this.state.containsEsc,n=this.parseIdentifier();if(!t&&"async"===n.name&&!this.canInsertSemicolon()){let{type:e}=this.state;if(68===e)return this.resetPreviousNodeTrailingComments(n),this.next(),this.parseAsyncFunctionExpression(this.startNodeAtNode(n));if(q(e))return 61===this.lookaheadCharCode()?this.parseAsyncArrowUnaryFunction(this.startNodeAtNode(n)):n;if(90===e)return this.resetPreviousNodeTrailingComments(n),this.parseDo(this.startNodeAtNode(n),!0)}return e&&this.match(19)&&!this.canInsertSemicolon()?(this.next(),this.parseArrowExpression(this.startNodeAtNode(n),[n],!1)):n}this.unexpected()}}parseTopicReferenceThenEqualsSign(e,t){let n=this.getPluginOption("pipelineOperator","proposal");if(n)return this.state.type=e,this.state.value=t,this.state.pos--,this.state.end--,this.state.endLoc=u(this.state.endLoc,-1),this.parseTopicReference(n);this.unexpected()}parseTopicReference(e){let t=this.startNode(),n=this.state.startLoc,i=this.state.type;return this.next(),this.finishTopicReference(t,n,e,i)}finishTopicReference(e,t,n,i){if(this.testTopicReferenceConfiguration(n,t,i)){let i="smart"===n?"PipelinePrimaryTopicReference":"TopicReference";return this.topicReferenceIsAllowedInCurrentContext()||this.raise("smart"===n?G.PrimaryTopicNotAllowed:G.PipeTopicUnbound,t),this.registerTopicReference(),this.finishNode(e,i)}throw this.raise(G.PipeTopicUnconfiguredToken,t,{token:de(i)})}testTopicReferenceConfiguration(e,t,n){switch(e){case"hack":return this.hasPlugin(["pipelineOperator",{topicToken:de(n)}]);case"smart":return 27===n;default:throw this.raise(G.PipeTopicRequiresHackPipes,t)}}parseAsyncArrowUnaryFunction(e){this.prodParam.enter(Et(!0,this.prodParam.hasYield));let t=[this.parseIdentifier()];return this.prodParam.exit(),this.hasPrecedingLineBreak()&&this.raise(G.LineTerminatorBeforeArrow,this.state.curPosition()),this.expect(19),this.parseArrowExpression(e,t,!0)}parseDo(e,t){this.expectPlugin("doExpressions"),t&&this.expectPlugin("asyncDoExpressions"),e.async=t,this.next();let n=this.state.labels;return this.state.labels=[],t?(this.prodParam.enter(2),e.body=this.parseBlock(),this.prodParam.exit()):e.body=this.parseBlock(),this.state.labels=n,this.finishNode(e,"DoExpression")}parseSuper(){let e=this.startNode();return this.next(),!this.match(10)||this.scope.allowDirectSuper||this.options.allowSuperOutsideMethod?!this.scope.allowSuper&&!this.options.allowSuperOutsideMethod&&this.raise(G.UnexpectedSuper,e):this.raise(G.SuperNotAllowed,e),!this.match(10)&&!this.match(0)&&!this.match(16)&&this.raise(G.UnsupportedSuper,e),this.finishNode(e,"Super")}parsePrivateName(){let e=this.startNode(),t=this.startNodeAt(u(this.state.startLoc,1)),n=this.state.value;return this.next(),e.id=this.createIdentifier(t,n),this.finishNode(e,"PrivateName")}parseFunctionOrFunctionSent(){let e=this.startNode();if(this.next(),this.prodParam.hasYield&&this.match(16)){let t=this.createIdentifier(this.startNodeAtNode(e),"function");return this.next(),this.match(103)?this.expectPlugin("functionSent"):this.hasPlugin("functionSent")||this.unexpected(),this.parseMetaProperty(e,t,"sent")}return this.parseFunction(e)}parseMetaProperty(e,t,n){e.meta=t;let i=this.state.containsEsc;return e.property=this.parseIdentifier(!0),(e.property.name!==n||i)&&this.raise(G.UnsupportedMetaProperty,e.property,{target:t.name,onlyValidPropertyName:n}),this.finishNode(e,"MetaProperty")}parseImportMetaProperty(e){let t=this.createIdentifier(this.startNodeAtNode(e),"import");if(this.next(),this.isContextual(101))this.inModule||this.raise(G.ImportMetaOutsideModule,t),this.sawUnambiguousESM=!0;else if(this.isContextual(105)||this.isContextual(97)){let t=this.isContextual(105);if(t||this.unexpected(),this.expectPlugin(t?"sourcePhaseImports":"deferredImportEvaluation"),!this.options.createImportExpressions)throw this.raise(G.DynamicImportPhaseRequiresImportExpressions,this.state.startLoc,{phase:this.state.value});return this.next(),e.phase=t?"source":"defer",this.parseImportCall(e)}return this.parseMetaProperty(e,t,"meta")}parseLiteralAtNode(e,t,n){return this.addExtra(n,"rawValue",e),this.addExtra(n,"raw",this.input.slice(n.start,this.state.end)),n.value=e,this.next(),this.finishNode(n,t)}parseLiteral(e,t){let n=this.startNode();return this.parseLiteralAtNode(e,t,n)}parseStringLiteral(e){return this.parseLiteral(e,"StringLiteral")}parseNumericLiteral(e){return this.parseLiteral(e,"NumericLiteral")}parseBigIntLiteral(e){return this.parseLiteral(e,"BigIntLiteral")}parseDecimalLiteral(e){return this.parseLiteral(e,"DecimalLiteral")}parseRegExpLiteral(e){let t=this.startNode();return this.addExtra(t,"raw",this.input.slice(t.start,this.state.end)),t.pattern=e.pattern,t.flags=e.flags,this.next(),this.finishNode(t,"RegExpLiteral")}parseBooleanLiteral(e){let t=this.startNode();return t.value=e,this.next(),this.finishNode(t,"BooleanLiteral")}parseNullLiteral(){let e=this.startNode();return this.next(),this.finishNode(e,"NullLiteral")}parseParenAndDistinguishExpression(e){let t,n=this.state.startLoc;this.next(),this.expressionScope.enter(Bt());let i=this.state.maybeInArrowParameters,r=this.state.inFSharpPipelineDirectBody;this.state.maybeInArrowParameters=!0,this.state.inFSharpPipelineDirectBody=!1;let s,o,a=this.state.startLoc,l=[],c=new St,g=!0;for(;!this.match(11);){if(g)g=!1;else if(this.expect(12,null===c.optionalParametersLoc?null:c.optionalParametersLoc),this.match(11)){o=this.state.startLoc;break}if(this.match(21)){let e=this.state.startLoc;if(s=this.state.startLoc,l.push(this.parseParenItem(this.parseRestBinding(),e)),!this.checkCommaAfterRest(41))break}else l.push(this.parseMaybeAssignAllowIn(c,this.parseParenItem))}let u=this.state.lastTokEndLoc;this.expect(11),this.state.maybeInArrowParameters=i,this.state.inFSharpPipelineDirectBody=r;let A=this.startNodeAt(n);return e&&this.shouldParseArrow(l)&&(A=this.parseArrow(A))?(this.checkDestructuringPrivate(c),this.expressionScope.validateAsPattern(),this.expressionScope.exit(),this.parseArrowExpression(A,l,!1),A):(this.expressionScope.exit(),l.length||this.unexpected(this.state.lastTokStartLoc),o&&this.unexpected(o),s&&this.unexpected(s),this.checkExpressionErrors(c,!0),this.toReferencedListDeep(l,!0),l.length>1?(t=this.startNodeAt(a),t.expressions=l,this.finishNode(t,"SequenceExpression"),this.resetEndLocation(t,u)):t=l[0],this.wrapParenthesis(n,t))}wrapParenthesis(e,t){if(!this.options.createParenthesizedExpressions)return this.addExtra(t,"parenthesized",!0),this.addExtra(t,"parenStart",e.index),this.takeSurroundingComments(t,e.index,this.state.lastTokEndLoc.index),t;let n=this.startNodeAt(e);return n.expression=t,this.finishNode(n,"ParenthesizedExpression")}shouldParseArrow(e){return!this.canInsertSemicolon()}parseArrow(e){if(this.eat(19))return e}parseParenItem(e,t){return e}parseNewOrNewTarget(){let e=this.startNode();if(this.next(),this.match(16)){let t=this.createIdentifier(this.startNodeAtNode(e),"new");this.next();let n=this.parseMetaProperty(e,t,"target");return!this.scope.inNonArrowFunction&&!this.scope.inClass&&!this.options.allowNewTargetOutsideFunction&&this.raise(G.UnexpectedNewTarget,n),n}return this.parseNew(e)}parseNew(e){if(this.parseNewCallee(e),this.eat(10)){let t=this.parseExprList(11);this.toReferencedList(t),e.arguments=t}else e.arguments=[];return this.finishNode(e,"NewExpression")}parseNewCallee(e){let t=this.match(83),n=this.parseNoCallExpr();e.callee=n,t&&("Import"===n.type||"ImportExpression"===n.type)&&this.raise(G.ImportCallNotNewExpression,n)}parseTemplateElement(e){let{start:t,startLoc:n,end:i,value:r}=this.state,s=t+1,o=this.startNodeAt(u(n,1));null===r&&(e||this.raise(G.InvalidEscapeSequenceTemplate,u(this.state.firstInvalidTemplateEscapePos,1)));let a=this.match(24),l=a?-1:-2,c=i+l;o.value={raw:this.input.slice(s,c).replace(/\r\n?/g,"\n"),cooked:null===r?null:r.slice(1,l)},o.tail=a,this.next();let g=this.finishNode(o,"TemplateElement");return this.resetEndLocation(g,u(this.state.lastTokEndLoc,l)),g}parseTemplate(e){let t=this.startNode(),n=this.parseTemplateElement(e),i=[n],r=[];for(;!n.tail;)r.push(this.parseTemplateSubstitution()),this.readTemplateContinuation(),i.push(n=this.parseTemplateElement(e));return t.expressions=r,t.quasis=i,this.finishNode(t,"TemplateLiteral")}parseTemplateSubstitution(){return this.parseExpression()}parseObjectLike(e,t,n,i){n&&this.expectPlugin("recordAndTuple");let r=this.state.inFSharpPipelineDirectBody;this.state.inFSharpPipelineDirectBody=!1;let s=Object.create(null),o=!0,a=this.startNode();for(a.properties=[],this.next();!this.match(e);){if(o)o=!1;else if(this.expect(12),this.match(e)){this.addTrailingCommaExtraToNode(a);break}let r;t?r=this.parseBindingProperty():(r=this.parsePropertyDefinition(i),this.checkProto(r,n,s,i)),n&&!this.isObjectProperty(r)&&"SpreadElement"!==r.type&&this.raise(G.InvalidRecordProperty,r),r.shorthand&&this.addExtra(r,"shorthand",!0),a.properties.push(r)}this.next(),this.state.inFSharpPipelineDirectBody=r;let l="ObjectExpression";return t?l="ObjectPattern":n&&(l="RecordExpression"),this.finishNode(a,l)}addTrailingCommaExtraToNode(e){this.addExtra(e,"trailingComma",this.state.lastTokStartLoc.index),this.addExtra(e,"trailingCommaLoc",this.state.lastTokStartLoc,!1)}maybeAsyncOrAccessorProp(e){return!e.computed&&"Identifier"===e.key.type&&(this.isLiteralPropertyName()||this.match(0)||this.match(55))}parsePropertyDefinition(e){let t=[];if(this.match(26))for(this.hasPlugin("decorators")&&this.raise(G.UnsupportedPropertyDecorator,this.state.startLoc);this.match(26);)t.push(this.parseDecorator());let n,i=this.startNode(),r=!1,s=!1;if(this.match(21))return t.length&&this.unexpected(),this.parseSpread();t.length&&(i.decorators=t,t=[]),i.method=!1,e&&(n=this.state.startLoc);let o=this.eat(55);this.parsePropertyNamePrefixOperator(i);let a=this.state.containsEsc;if(this.parsePropertyName(i,e),!o&&!a&&this.maybeAsyncOrAccessorProp(i)){let{key:e}=i,t=e.name;"async"===t&&!this.hasPrecedingLineBreak()&&(r=!0,this.resetPreviousNodeTrailingComments(e),o=this.eat(55),this.parsePropertyName(i)),("get"===t||"set"===t)&&(s=!0,this.resetPreviousNodeTrailingComments(e),i.kind=t,this.match(55)&&(o=!0,this.raise(G.AccessorIsGenerator,this.state.curPosition(),{kind:t}),this.next()),this.parsePropertyName(i))}return this.parseObjPropValue(i,n,o,r,!1,s,e)}getGetterSetterExpectedParamCount(e){return"get"===e.kind?0:1}getObjectOrClassMethodParams(e){return e.params}checkGetterSetterParams(e){var t;let n=this.getGetterSetterExpectedParamCount(e),i=this.getObjectOrClassMethodParams(e);i.length!==n&&this.raise("get"===e.kind?G.BadGetterArity:G.BadSetterArity,e),"set"===e.kind&&"RestElement"===(null==(t=i[i.length-1])?void 0:t.type)&&this.raise(G.BadSetterRestParameter,e)}parseObjectMethod(e,t,n,i,r){if(r){let n=this.parseMethod(e,t,!1,!1,!1,"ObjectMethod");return this.checkGetterSetterParams(n),n}if(n||t||this.match(10))return i&&this.unexpected(),e.kind="method",e.method=!0,this.parseMethod(e,t,n,!1,!1,"ObjectMethod")}parseObjectProperty(e,t,n,i){if(e.shorthand=!1,this.eat(14))return e.value=n?this.parseMaybeDefault(this.state.startLoc):this.parseMaybeAssignAllowIn(i),this.finishNode(e,"ObjectProperty");if(!e.computed&&"Identifier"===e.key.type){if(this.checkReservedWord(e.key.name,e.key.loc.start,!0,!1),n)e.value=this.parseMaybeDefault(t,Ft(e.key));else if(this.match(29)){let n=this.state.startLoc;null!=i?null===i.shorthandAssignLoc&&(i.shorthandAssignLoc=n):this.raise(G.InvalidCoverInitializedName,n),e.value=this.parseMaybeDefault(t,Ft(e.key))}else e.value=Ft(e.key);return e.shorthand=!0,this.finishNode(e,"ObjectProperty")}}parseObjPropValue(e,t,n,i,r,s,o){let a=this.parseObjectMethod(e,n,i,r,s)||this.parseObjectProperty(e,t,r,o);return a||this.unexpected(),a}parsePropertyName(e,t){if(this.eat(0))e.computed=!0,e.key=this.parseMaybeAssignAllowIn(),this.expect(3);else{let n,{type:i,value:r}=this.state;if(ee(i))n=this.parseIdentifier(!0);else switch(i){case 134:n=this.parseNumericLiteral(r);break;case 133:n=this.parseStringLiteral(r);break;case 135:n=this.parseBigIntLiteral(r);break;case 136:n=this.parseDecimalLiteral(r);break;case 138:{let e=this.state.startLoc;null!=t?null===t.privateKeyLoc&&(t.privateKeyLoc=e):this.raise(G.UnexpectedPrivateField,e),n=this.parsePrivateName();break}default:this.unexpected()}e.key=n,138!==i&&(e.computed=!1)}}initFunction(e,t){e.id=null,e.generator=!1,e.async=t}parseMethod(e,t,n,i,r,s){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6];this.initFunction(e,n),e.generator=t,this.scope.enter(18|(o?64:0)|(r?32:0)),this.prodParam.enter(Et(n,e.generator)),this.parseFunctionParams(e,i);let a=this.parseFunctionBodyAndFinish(e,s,!0);return this.prodParam.exit(),this.scope.exit(),a}parseArrayLike(e,t,n,i){n&&this.expectPlugin("recordAndTuple");let r=this.state.inFSharpPipelineDirectBody;this.state.inFSharpPipelineDirectBody=!1;let s=this.startNode();return this.next(),s.elements=this.parseExprList(e,!n,i,s),this.state.inFSharpPipelineDirectBody=r,this.finishNode(s,n?"TupleExpression":"ArrayExpression")}parseArrowExpression(e,t,n,i){this.scope.enter(6);let r=Et(n,!1);!this.match(5)&&this.prodParam.hasIn&&(r|=8),this.prodParam.enter(r),this.initFunction(e,n);let s=this.state.maybeInArrowParameters;return t&&(this.state.maybeInArrowParameters=!0,this.setArrowFunctionParameters(e,t,i)),this.state.maybeInArrowParameters=!1,this.parseFunctionBody(e,!0),this.prodParam.exit(),this.scope.exit(),this.state.maybeInArrowParameters=s,this.finishNode(e,"ArrowFunctionExpression")}setArrowFunctionParameters(e,t,n){this.toAssignableList(t,n,!1),e.params=t}parseFunctionBodyAndFinish(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.parseFunctionBody(e,!1,n),this.finishNode(e,t)}parseFunctionBody(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=t&&!this.match(5);if(this.expressionScope.enter(wt()),i)e.body=this.parseMaybeAssign(),this.checkParams(e,!1,t,!1);else{let i=this.state.strict,r=this.state.labels;this.state.labels=[],this.prodParam.enter(4|this.prodParam.currentFlags()),e.body=this.parseBlock(!0,!1,(r=>{let s=!this.isSimpleParamList(e.params);r&&s&&this.raise(G.IllegalLanguageModeDirective,"method"!==e.kind&&"constructor"!==e.kind||!e.key?e:e.key.loc.end);let o=!i&&this.state.strict;this.checkParams(e,!this.state.strict&&!t&&!n&&!s,t,o),this.state.strict&&e.id&&this.checkIdentifier(e.id,65,o)})),this.prodParam.exit(),this.state.labels=r}this.expressionScope.exit()}isSimpleParameter(e){return"Identifier"===e.type}isSimpleParamList(e){for(let t=0,n=e.length;t<n;t++)if(!this.isSimpleParameter(e[t]))return!1;return!0}checkParams(e,t,n){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=!t&&new Set,s={type:"FormalParameters"};for(let o of e.params)this.checkLVal(o,{in:s,binding:5,checkClashes:r,strictModeChanged:i})}parseExprList(e,t,n,i){let r=[],s=!0;for(;!this.eat(e);){if(s)s=!1;else if(this.expect(12),this.match(e)){i&&this.addTrailingCommaExtraToNode(i),this.next();break}r.push(this.parseExprListItem(t,n))}return r}parseExprListItem(e,t,n){let i;if(this.match(12))e||this.raise(G.UnexpectedToken,this.state.curPosition(),{unexpected:","}),i=null;else if(this.match(21)){let e=this.state.startLoc;i=this.parseParenItem(this.parseSpread(t),e)}else if(this.match(17)){this.expectPlugin("partialApplication"),n||this.raise(G.UnexpectedArgumentPlaceholder,this.state.startLoc);let e=this.startNode();this.next(),i=this.finishNode(e,"ArgumentPlaceholder")}else i=this.parseMaybeAssignAllowIn(t,this.parseParenItem);return i}parseIdentifier(e){let t=this.startNode(),n=this.parseIdentifierName(e);return this.createIdentifier(t,n)}createIdentifier(e,t){return e.name=t,e.loc.identifierName=t,this.finishNode(e,"Identifier")}parseIdentifierName(e){let t,{startLoc:n,type:i}=this.state;ee(i)?t=this.state.value:this.unexpected();let r=$(i);return e?r&&this.replaceToken(132):this.checkReservedWord(t,n,r,!1),this.next(),t}checkReservedWord(e,t,n,i){if(!(e.length>10)&&Ve(e))if(n&&We(e))this.raise(G.UnexpectedKeyword,t,{keyword:e});else if((this.state.strict?i?Me:Fe:De)(e,this.inModule))this.raise(G.UnexpectedReservedWord,t,{reservedWord:e});else if("yield"===e){if(this.prodParam.hasYield)return void this.raise(G.YieldBindingIdentifier,t)}else if("await"===e){if(this.prodParam.hasAwait)return void this.raise(G.AwaitBindingIdentifier,t);if(this.scope.inStaticBlock)return void this.raise(G.AwaitBindingIdentifierInStaticBlock,t);this.expressionScope.recordAsyncArrowParametersError(t)}else if("arguments"===e&&this.scope.inClassAndNotInNonArrowFunction)return void this.raise(G.ArgumentsInClass,t)}isAwaitAllowed(){return!!(this.prodParam.hasAwait||this.options.allowAwaitOutsideFunction&&!this.scope.inFunction)}parseAwait(e){let t=this.startNodeAt(e);return this.expressionScope.recordParameterInitializerError(G.AwaitExpressionFormalParameter,t),this.eat(55)&&this.raise(G.ObsoleteAwaitStar,t),!this.scope.inFunction&&!this.options.allowAwaitOutsideFunction&&(this.isAmbiguousAwait()?this.ambiguousScriptDifferentAst=!0:this.sawUnambiguousESM=!0),this.state.soloAwait||(t.argument=this.parseMaybeUnary(null,!0)),this.finishNode(t,"AwaitExpression")}isAmbiguousAwait(){if(this.hasPrecedingLineBreak())return!0;let{type:e}=this.state;return 53===e||10===e||0===e||pe(e)||102===e&&!this.state.containsEsc||137===e||56===e||this.hasPlugin("v8intrinsic")&&54===e}parseYield(){let e=this.startNode();this.expressionScope.recordParameterInitializerError(G.YieldInParameter,e),this.next();let t=!1,n=null;if(!this.hasPrecedingLineBreak())switch(t=this.eat(55),this.state.type){case 13:case 139:case 8:case 11:case 3:case 9:case 14:case 12:if(!t)break;default:n=this.parseMaybeAssign()}return e.delegate=t,e.argument=n,this.finishNode(e,"YieldExpression")}parseImportCall(e){return this.next(),e.source=this.parseMaybeAssignAllowIn(),(this.hasPlugin("importAttributes")||this.hasPlugin("importAssertions"))&&(e.options=null),this.eat(12)&&(this.expectImportAttributesPlugin(),this.match(11)||(e.options=this.parseMaybeAssignAllowIn(),this.eat(12))),this.expect(11),this.finishNode(e,"ImportExpression")}checkPipelineAtInfixOperator(e,t){this.hasPlugin(["pipelineOperator",{proposal:"smart"}])&&"SequenceExpression"===e.type&&this.raise(G.PipelineHeadSequenceExpression,t)}parseSmartPipelineBodyInStyle(e,t){if(this.isSimpleReference(e)){let n=this.startNodeAt(t);return n.callee=e,this.finishNode(n,"PipelineBareFunction")}{let n=this.startNodeAt(t);return this.checkSmartPipeTopicBodyEarlyErrors(t),n.expression=e,this.finishNode(n,"PipelineTopicExpression")}}isSimpleReference(e){switch(e.type){case"MemberExpression":return!e.computed&&this.isSimpleReference(e.object);case"Identifier":return!0;default:return!1}}checkSmartPipeTopicBodyEarlyErrors(e){if(this.match(19))throw this.raise(G.PipelineBodyNoArrow,this.state.startLoc);this.topicReferenceWasUsedInCurrentContext()||this.raise(G.PipelineTopicUnused,e)}withTopicBindingContext(e){let t=this.state.topicContext;this.state.topicContext={maxNumOfResolvableTopics:1,maxTopicIndex:null};try{return e()}finally{this.state.topicContext=t}}withSmartMixTopicForbiddingContext(e){if(!this.hasPlugin(["pipelineOperator",{proposal:"smart"}]))return e();{let t=this.state.topicContext;this.state.topicContext={maxNumOfResolvableTopics:0,maxTopicIndex:null};try{return e()}finally{this.state.topicContext=t}}}withSoloAwaitPermittingContext(e){let t=this.state.soloAwait;this.state.soloAwait=!0;try{return e()}finally{this.state.soloAwait=t}}allowInAnd(e){let t=this.prodParam.currentFlags();if(8&~t){this.prodParam.enter(8|t);try{return e()}finally{this.prodParam.exit()}}return e()}disallowInAnd(e){let t=this.prodParam.currentFlags();if(8&t){this.prodParam.enter(-9&t);try{return e()}finally{this.prodParam.exit()}}return e()}registerTopicReference(){this.state.topicContext.maxTopicIndex=0}topicReferenceIsAllowedInCurrentContext(){return this.state.topicContext.maxNumOfResolvableTopics>=1}topicReferenceWasUsedInCurrentContext(){return null!=this.state.topicContext.maxTopicIndex&&this.state.topicContext.maxTopicIndex>=0}parseFSharpPipelineBody(e){let t=this.state.startLoc;this.state.potentialArrowAt=this.state.start;let n=this.state.inFSharpPipelineDirectBody;this.state.inFSharpPipelineDirectBody=!0;let i=this.parseExprOp(this.parseMaybeUnaryOrPrivate(),t,e);return this.state.inFSharpPipelineDirectBody=n,i}parseModuleExpression(){this.expectPlugin("moduleBlocks");let e=this.startNode();this.next(),this.match(5)||this.unexpected(null,5);let t=this.startNodeAt(this.state.endLoc);this.next();let n=this.initializeScopes(!0);this.enterInitialScopes();try{e.body=this.parseProgram(t,8,"module")}finally{n()}return this.finishNode(e,"ModuleExpression")}parsePropertyNamePrefixOperator(e){}},Gn={kind:1},En={kind:2},xn=/[\uD800-\uDFFF]/u,Sn=/in(?:stanceof)?/y;function Rn(e,t){for(let n=0;n<e.length;n++){let i=e[n],{type:r}=i;if("number"==typeof r){if(138===r){let{loc:t,start:r,value:s,end:o}=i,a=r+1,l=u(t.start,1);e.splice(n,1,new ht({type:Ce(27),value:"#",start:r,end:a,startLoc:t.start,endLoc:l}),new ht({type:Ce(132),value:s,start:a,end:o,startLoc:l,endLoc:t.end})),n++;continue}if(pe(r)){let s,o,a,l,c,{loc:g,start:A,value:d,end:h}=i,I=A+1,p=u(g.start,1);s=96===t.charCodeAt(A)?new ht({type:Ce(22),value:"`",start:A,end:I,startLoc:g.start,endLoc:p}):new ht({type:Ce(8),value:"}",start:A,end:I,startLoc:g.start,endLoc:p}),24===r?(a=h-1,l=u(g.end,-1),o=null===d?null:d.slice(1,-1),c=new ht({type:Ce(22),value:"`",start:a,end:h,startLoc:l,endLoc:g.end})):(a=h-2,l=u(g.end,-2),o=null===d?null:d.slice(1,-2),c=new ht({type:Ce(23),value:"${",start:a,end:h,startLoc:l,endLoc:g.end})),e.splice(n,1,s,new ht({type:Ce(20),value:o,start:I,end:a,startLoc:p,endLoc:l}),c),n+=2;continue}i.type=Ce(r)}}return e}var Zn=class extends wn{parseTopLevel(e,t){return e.program=this.parseProgram(t),e.comments=this.comments,this.options.tokens&&(e.tokens=Rn(this.tokens,this.input)),this.finishNode(e,"File")}parseProgram(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:139,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.options.sourceType;if(e.sourceType=i,e.interpreter=this.parseInterpreterDirective(),this.parseBlockBody(e,!0,!0,n),this.inModule&&!this.options.allowUndeclaredExports&&this.scope.undefinedExports.size>0)for(let[r,s]of Array.from(this.scope.undefinedExports))this.raise(G.ModuleExportUndefined,s,{localName:r});return t=139===n?this.finishNode(e,"Program"):this.finishNodeAt(e,"Program",u(this.state.startLoc,-1)),t}stmtToDirective(e){let t=e;t.type="Directive",t.value=t.expression,delete t.expression;let n=t.value,i=n.value,r=this.input.slice(n.start,n.end),s=n.value=r.slice(1,-1);return this.addExtra(n,"raw",r),this.addExtra(n,"rawValue",s),this.addExtra(n,"expressionValue",i),n.type="DirectiveLiteral",t}parseInterpreterDirective(){if(!this.match(28))return null;let e=this.startNode();return e.value=this.state.value,this.next(),this.finishNode(e,"InterpreterDirective")}isLet(){return!!this.isContextual(100)&&this.hasFollowingBindingAtom()}chStartsBindingIdentifier(e,t){if(Ge(e)){if(Sn.lastIndex=t,Sn.test(this.input)){let e=this.codePointAtPos(Sn.lastIndex);if(!Ee(e)&&92!==e)return!1}return!0}return 92===e}chStartsBindingPattern(e){return 91===e||123===e}hasFollowingBindingAtom(){let e=this.nextTokenStart(),t=this.codePointAtPos(e);return this.chStartsBindingPattern(t)||this.chStartsBindingIdentifier(t,e)}hasInLineFollowingBindingIdentifierOrBrace(){let e=this.nextTokenInLineStart(),t=this.codePointAtPos(e);return 123===t||this.chStartsBindingIdentifier(t,e)}startsUsingForOf(){let{type:e,containsEsc:t}=this.lookahead();return!(102===e&&!t)&&(q(e)&&!this.hasFollowingLineBreak()?(this.expectPlugin("explicitResourceManagement"),!0):void 0)}startsAwaitUsing(){let e=this.nextTokenInLineStart();if(this.isUnparsedContextual(e,"using")){e=this.nextTokenInLineStartSince(e+5);let t=this.codePointAtPos(e);if(this.chStartsBindingIdentifier(t,e))return this.expectPlugin("explicitResourceManagement"),!0}return!1}parseModuleItem(){return this.parseStatementLike(15)}parseStatementListItem(){return this.parseStatementLike(6|(!this.options.annexB||this.state.strict?0:8))}parseStatementOrSloppyAnnexBFunctionDeclaration(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return this.options.annexB&&!this.state.strict&&(t|=4,e&&(t|=8)),this.parseStatementLike(t)}parseStatement(){return this.parseStatementLike(0)}parseStatementLike(e){let t=null;return this.match(26)&&(t=this.parseDecorators(!0)),this.parseStatementContent(e,t)}parseStatementContent(e,t){let n=this.state.type,i=this.startNode(),r=!!(2&e),s=!!(4&e),o=1&e;switch(n){case 60:return this.parseBreakContinueStatement(i,!0);case 63:return this.parseBreakContinueStatement(i,!1);case 64:return this.parseDebuggerStatement(i);case 90:return this.parseDoWhileStatement(i);case 91:return this.parseForStatement(i);case 68:if(46===this.lookaheadCharCode())break;return s||this.raise(this.state.strict?G.StrictFunction:this.options.annexB?G.SloppyFunctionAnnexB:G.SloppyFunction,this.state.startLoc),this.parseFunctionStatement(i,!1,!r&&s);case 80:return r||this.unexpected(),this.parseClass(this.maybeTakeDecorators(t,i),!0);case 69:return this.parseIfStatement(i);case 70:return this.parseReturnStatement(i);case 71:return this.parseSwitchStatement(i);case 72:return this.parseThrowStatement(i);case 73:return this.parseTryStatement(i);case 96:if(!this.state.containsEsc&&this.startsAwaitUsing())return this.isAwaitAllowed()?r||this.raise(G.UnexpectedLexicalDeclaration,i):this.raise(G.AwaitUsingNotInAsyncContext,i),this.next(),this.parseVarStatement(i,"await using");break;case 107:if(this.state.containsEsc||!this.hasInLineFollowingBindingIdentifierOrBrace())break;return this.expectPlugin("explicitResourceManagement"),!this.scope.inModule&&this.scope.inTopLevel?this.raise(G.UnexpectedUsingDeclaration,this.state.startLoc):r||this.raise(G.UnexpectedLexicalDeclaration,this.state.startLoc),this.parseVarStatement(i,"using");case 100:{if(this.state.containsEsc)break;let e=this.nextTokenStart(),t=this.codePointAtPos(e);if(91!==t&&(!r&&this.hasFollowingLineBreak()||!this.chStartsBindingIdentifier(t,e)&&123!==t))break}case 75:r||this.raise(G.UnexpectedLexicalDeclaration,this.state.startLoc);case 74:{let e=this.state.value;return this.parseVarStatement(i,e)}case 92:return this.parseWhileStatement(i);case 76:return this.parseWithStatement(i);case 5:return this.parseBlock();case 13:return this.parseEmptyStatement(i);case 83:{let e=this.lookaheadCharCode();if(40===e||46===e)break}case 82:{let e;return!this.options.allowImportExportEverywhere&&!o&&this.raise(G.UnexpectedImportExport,this.state.startLoc),this.next(),83===n?(e=this.parseImport(i),"ImportDeclaration"===e.type&&(!e.importKind||"value"===e.importKind)&&(this.sawUnambiguousESM=!0)):(e=this.parseExport(i,t),("ExportNamedDeclaration"===e.type&&(!e.exportKind||"value"===e.exportKind)||"ExportAllDeclaration"===e.type&&(!e.exportKind||"value"===e.exportKind)||"ExportDefaultDeclaration"===e.type)&&(this.sawUnambiguousESM=!0)),this.assertModuleNodeAllowed(e),e}default:if(this.isAsyncFunction())return r||this.raise(G.AsyncFunctionInSingleStatementContext,this.state.startLoc),this.next(),this.parseFunctionStatement(i,!0,!r&&s)}let a=this.state.value,l=this.parseExpression();return q(n)&&"Identifier"===l.type&&this.eat(14)?this.parseLabeledStatement(i,a,l,e):this.parseExpressionStatement(i,l,t)}assertModuleNodeAllowed(e){!this.options.allowImportExportEverywhere&&!this.inModule&&this.raise(G.ImportOutsideModule,e)}decoratorsEnabledBeforeExport(){return!!this.hasPlugin("decorators-legacy")||this.hasPlugin("decorators")&&!1!==this.getPluginOption("decorators","decoratorsBeforeExport")}maybeTakeDecorators(e,t,n){return e&&(t.decorators&&t.decorators.length>0?("boolean"!=typeof this.getPluginOption("decorators","decoratorsBeforeExport")&&this.raise(G.DecoratorsBeforeAfterExport,t.decorators[0]),t.decorators.unshift(...e)):t.decorators=e,this.resetStartLocationFromNode(t,e[0]),n&&this.resetStartLocationFromNode(n,t)),t}canHaveLeadingDecorator(){return this.match(80)}parseDecorators(e){let t=[];do{t.push(this.parseDecorator())}while(this.match(26));if(this.match(82))e||this.unexpected(),this.decoratorsEnabledBeforeExport()||this.raise(G.DecoratorExportClass,this.state.startLoc);else if(!this.canHaveLeadingDecorator())throw this.raise(G.UnexpectedLeadingDecorator,this.state.startLoc);return t}parseDecorator(){this.expectOnePlugin(["decorators","decorators-legacy"]);let e=this.startNode();if(this.next(),this.hasPlugin("decorators")){let t,n=this.state.startLoc;if(this.match(10)){let n=this.state.startLoc;this.next(),t=this.parseExpression(),this.expect(11),t=this.wrapParenthesis(n,t);let i=this.state.startLoc;e.expression=this.parseMaybeDecoratorArguments(t),!1===this.getPluginOption("decorators","allowCallParenthesized")&&e.expression!==t&&this.raise(G.DecoratorArgumentsOutsideParentheses,i)}else{for(t=this.parseIdentifier(!1);this.eat(16);){let e=this.startNodeAt(n);e.object=t,this.match(138)?(this.classScope.usePrivateName(this.state.value,this.state.startLoc),e.property=this.parsePrivateName()):e.property=this.parseIdentifier(!0),e.computed=!1,t=this.finishNode(e,"MemberExpression")}e.expression=this.parseMaybeDecoratorArguments(t)}}else e.expression=this.parseExprSubscripts();return this.finishNode(e,"Decorator")}parseMaybeDecoratorArguments(e){if(this.eat(10)){let t=this.startNodeAtNode(e);return t.callee=e,t.arguments=this.parseCallExpressionArguments(11,!1),this.toReferencedList(t.arguments),this.finishNode(t,"CallExpression")}return e}parseBreakContinueStatement(e,t){return this.next(),this.isLineTerminator()?e.label=null:(e.label=this.parseIdentifier(),this.semicolon()),this.verifyBreakContinue(e,t),this.finishNode(e,t?"BreakStatement":"ContinueStatement")}verifyBreakContinue(e,t){let n;for(n=0;n<this.state.labels.length;++n){let i=this.state.labels[n];if((null==e.label||i.name===e.label.name)&&(null!=i.kind&&(t||1===i.kind)||e.label&&t))break}if(n===this.state.labels.length){let n=t?"BreakStatement":"ContinueStatement";this.raise(G.IllegalBreakContinue,e,{type:n})}}parseDebuggerStatement(e){return this.next(),this.semicolon(),this.finishNode(e,"DebuggerStatement")}parseHeaderExpression(){this.expect(10);let e=this.parseExpression();return this.expect(11),e}parseDoWhileStatement(e){return this.next(),this.state.labels.push(Gn),e.body=this.withSmartMixTopicForbiddingContext((()=>this.parseStatement())),this.state.labels.pop(),this.expect(92),e.test=this.parseHeaderExpression(),this.eat(13),this.finishNode(e,"DoWhileStatement")}parseForStatement(e){this.next(),this.state.labels.push(Gn);let t=null;if(this.isAwaitAllowed()&&this.eatContextual(96)&&(t=this.state.lastTokStartLoc),this.scope.enter(0),this.expect(10),this.match(13))return null!==t&&this.unexpected(t),this.parseFor(e,null);let n=this.isContextual(100);{let i=this.isContextual(96)&&this.startsAwaitUsing(),r=i||this.isContextual(107)&&this.startsUsingForOf(),s=n&&this.hasFollowingBindingAtom()||r;if(this.match(74)||this.match(75)||s){let n,s=this.startNode();i?(n="await using",this.isAwaitAllowed()||this.raise(G.AwaitUsingNotInAsyncContext,this.state.startLoc),this.next()):n=this.state.value,this.next(),this.parseVar(s,!0,n);let o=this.finishNode(s,"VariableDeclaration"),a=this.match(58);return a&&r&&this.raise(G.ForInUsing,o),(a||this.isContextual(102))&&1===o.declarations.length?this.parseForIn(e,o,t):(null!==t&&this.unexpected(t),this.parseFor(e,o))}}let i=this.isContextual(95),r=new St,s=this.parseExpression(!0,r),o=this.isContextual(102);if(o&&(n&&this.raise(G.ForOfLet,s),null===t&&i&&"Identifier"===s.type&&this.raise(G.ForOfAsync,s)),o||this.match(58)){this.checkDestructuringPrivate(r),this.toAssignable(s,!0);let n=o?"ForOfStatement":"ForInStatement";return this.checkLVal(s,{in:{type:n}}),this.parseForIn(e,s,t)}return this.checkExpressionErrors(r,!0),null!==t&&this.unexpected(t),this.parseFor(e,s)}parseFunctionStatement(e,t,n){return this.next(),this.parseFunction(e,1|(n?2:0)|(t?8:0))}parseIfStatement(e){return this.next(),e.test=this.parseHeaderExpression(),e.consequent=this.parseStatementOrSloppyAnnexBFunctionDeclaration(),e.alternate=this.eat(66)?this.parseStatementOrSloppyAnnexBFunctionDeclaration():null,this.finishNode(e,"IfStatement")}parseReturnStatement(e){return!this.prodParam.hasReturn&&!this.options.allowReturnOutsideFunction&&this.raise(G.IllegalReturn,this.state.startLoc),this.next(),this.isLineTerminator()?e.argument=null:(e.argument=this.parseExpression(),this.semicolon()),this.finishNode(e,"ReturnStatement")}parseSwitchStatement(e){this.next(),e.discriminant=this.parseHeaderExpression();let t,n=e.cases=[];this.expect(5),this.state.labels.push(En),this.scope.enter(0);for(let i;!this.match(8);)if(this.match(61)||this.match(65)){let e=this.match(61);t&&this.finishNode(t,"SwitchCase"),n.push(t=this.startNode()),t.consequent=[],this.next(),e?t.test=this.parseExpression():(i&&this.raise(G.MultipleDefaultsInSwitch,this.state.lastTokStartLoc),i=!0,t.test=null),this.expect(14)}else t?t.consequent.push(this.parseStatementListItem()):this.unexpected();return this.scope.exit(),t&&this.finishNode(t,"SwitchCase"),this.next(),this.state.labels.pop(),this.finishNode(e,"SwitchStatement")}parseThrowStatement(e){return this.next(),this.hasPrecedingLineBreak()&&this.raise(G.NewlineAfterThrow,this.state.lastTokEndLoc),e.argument=this.parseExpression(),this.semicolon(),this.finishNode(e,"ThrowStatement")}parseCatchClauseParam(){let e=this.parseBindingAtom();return this.scope.enter(this.options.annexB&&"Identifier"===e.type?8:0),this.checkLVal(e,{in:{type:"CatchClause"},binding:9}),e}parseTryStatement(e){if(this.next(),e.block=this.parseBlock(),e.handler=null,this.match(62)){let t=this.startNode();this.next(),this.match(10)?(this.expect(10),t.param=this.parseCatchClauseParam(),this.expect(11)):(t.param=null,this.scope.enter(0)),t.body=this.withSmartMixTopicForbiddingContext((()=>this.parseBlock(!1,!1))),this.scope.exit(),e.handler=this.finishNode(t,"CatchClause")}return e.finalizer=this.eat(67)?this.parseBlock():null,!e.handler&&!e.finalizer&&this.raise(G.NoCatchOrFinally,e),this.finishNode(e,"TryStatement")}parseVarStatement(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.next(),this.parseVar(e,!1,t,n),this.semicolon(),this.finishNode(e,"VariableDeclaration")}parseWhileStatement(e){return this.next(),e.test=this.parseHeaderExpression(),this.state.labels.push(Gn),e.body=this.withSmartMixTopicForbiddingContext((()=>this.parseStatement())),this.state.labels.pop(),this.finishNode(e,"WhileStatement")}parseWithStatement(e){return this.state.strict&&this.raise(G.StrictWith,this.state.startLoc),this.next(),e.object=this.parseHeaderExpression(),e.body=this.withSmartMixTopicForbiddingContext((()=>this.parseStatement())),this.finishNode(e,"WithStatement")}parseEmptyStatement(e){return this.next(),this.finishNode(e,"EmptyStatement")}parseLabeledStatement(e,t,n,i){for(let s of this.state.labels)s.name===t&&this.raise(G.LabelRedeclaration,n,{labelName:t});let r=oe(this.state.type)?1:this.match(71)?2:null;for(let s=this.state.labels.length-1;s>=0;s--){let t=this.state.labels[s];if(t.statementStart!==e.start)break;t.statementStart=this.state.start,t.kind=r}return this.state.labels.push({name:t,kind:r,statementStart:this.state.start}),e.body=8&i?this.parseStatementOrSloppyAnnexBFunctionDeclaration(!0):this.parseStatement(),this.state.labels.pop(),e.label=n,this.finishNode(e,"LabeledStatement")}parseExpressionStatement(e,t,n){return e.expression=t,this.semicolon(),this.finishNode(e,"ExpressionStatement")}parseBlock(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,i=this.startNode();return e&&this.state.strictErrors.clear(),this.expect(5),t&&this.scope.enter(0),this.parseBlockBody(i,e,!1,8,n),t&&this.scope.exit(),this.finishNode(i,"BlockStatement")}isValidDirective(e){return"ExpressionStatement"===e.type&&"StringLiteral"===e.expression.type&&!e.expression.extra.parenthesized}parseBlockBody(e,t,n,i,r){let s=e.body=[],o=e.directives=[];this.parseBlockOrModuleBlockBody(s,t?o:void 0,n,i,r)}parseBlockOrModuleBlockBody(e,t,n,i,r){let s=this.state.strict,o=!1,a=!1;for(;!this.match(i);){let i=n?this.parseModuleItem():this.parseStatementListItem();if(t&&!a){if(this.isValidDirective(i)){let e=this.stmtToDirective(i);t.push(e),!o&&"use strict"===e.value.value&&(o=!0,this.setStrict(!0));continue}a=!0,this.state.strictErrors.clear()}e.push(i)}null==r||r.call(this,o),s||this.setStrict(!1),this.next()}parseFor(e,t){return e.init=t,this.semicolon(!1),e.test=this.match(13)?null:this.parseExpression(),this.semicolon(!1),e.update=this.match(11)?null:this.parseExpression(),this.expect(11),e.body=this.withSmartMixTopicForbiddingContext((()=>this.parseStatement())),this.scope.exit(),this.state.labels.pop(),this.finishNode(e,"ForStatement")}parseForIn(e,t,n){let i=this.match(58);return this.next(),i?null!==n&&this.unexpected(n):e.await=null!==n,"VariableDeclaration"===t.type&&null!=t.declarations[0].init&&(!i||!this.options.annexB||this.state.strict||"var"!==t.kind||"Identifier"!==t.declarations[0].id.type)&&this.raise(G.ForInOfLoopInitializer,t,{type:i?"ForInStatement":"ForOfStatement"}),"AssignmentPattern"===t.type&&this.raise(G.InvalidLhs,t,{ancestor:{type:"ForStatement"}}),e.left=t,e.right=i?this.parseExpression():this.parseMaybeAssignAllowIn(),this.expect(11),e.body=this.withSmartMixTopicForbiddingContext((()=>this.parseStatement())),this.scope.exit(),this.state.labels.pop(),this.finishNode(e,i?"ForInStatement":"ForOfStatement")}parseVar(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=e.declarations=[];for(e.kind=n;;){let e=this.startNode();if(this.parseVarId(e,n),e.init=this.eat(29)?t?this.parseMaybeAssignDisallowIn():this.parseMaybeAssignAllowIn():null,null===e.init&&!i&&("Identifier"===e.id.type||t&&(this.match(58)||this.isContextual(102))?("const"===n||"using"===n||"await using"===n)&&!(this.match(58)||this.isContextual(102))&&this.raise(G.DeclarationMissingInitializer,this.state.lastTokEndLoc,{kind:n}):this.raise(G.DeclarationMissingInitializer,this.state.lastTokEndLoc,{kind:"destructuring"})),r.push(this.finishNode(e,"VariableDeclarator")),!this.eat(12))break}return e}parseVarId(e,t){let n=this.parseBindingAtom();("using"===t||"await using"===t)&&("ArrayPattern"===n.type||"ObjectPattern"===n.type)&&this.raise(G.UsingDeclarationHasBindingPattern,n.loc.start),this.checkLVal(n,{in:{type:"VariableDeclarator"},binding:"var"===t?5:8201}),e.id=n}parseAsyncFunctionExpression(e){return this.parseFunction(e,8)}parseFunction(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=2&t,i=!!(1&t),r=i&&!(4&t),s=!!(8&t);this.initFunction(e,s),this.match(55)&&(n&&this.raise(G.GeneratorInSingleStatementContext,this.state.startLoc),this.next(),e.generator=!0),i&&(e.id=this.parseFunctionId(r));let o=this.state.maybeInArrowParameters;return this.state.maybeInArrowParameters=!1,this.scope.enter(2),this.prodParam.enter(Et(s,e.generator)),i||(e.id=this.parseFunctionId()),this.parseFunctionParams(e,!1),this.withSmartMixTopicForbiddingContext((()=>{this.parseFunctionBodyAndFinish(e,i?"FunctionDeclaration":"FunctionExpression")})),this.prodParam.exit(),this.scope.exit(),i&&!n&&this.registerFunctionStatementId(e),this.state.maybeInArrowParameters=o,e}parseFunctionId(e){return e||q(this.state.type)?this.parseIdentifier():null}parseFunctionParams(e,t){this.expect(10),this.expressionScope.enter(bt()),e.params=this.parseBindingList(11,41,2|(t?4:0)),this.expressionScope.exit()}registerFunctionStatementId(e){e.id&&this.scope.declareName(e.id.name,!this.options.annexB||this.state.strict||e.generator||e.async?this.scope.treatFunctionsAsVar?5:8201:17,e.id.loc.start)}parseClass(e,t,n){this.next();let i=this.state.strict;return this.state.strict=!0,this.parseClassId(e,t,n),this.parseClassSuper(e),e.body=this.parseClassBody(!!e.superClass,i),this.finishNode(e,t?"ClassDeclaration":"ClassExpression")}isClassProperty(){return this.match(29)||this.match(13)||this.match(8)}isClassMethod(){return this.match(10)}nameIsConstructor(e){return"Identifier"===e.type&&"constructor"===e.name||"StringLiteral"===e.type&&"constructor"===e.value}isNonstaticConstructor(e){return!e.computed&&!e.static&&this.nameIsConstructor(e.key)}parseClassBody(e,t){this.classScope.enter();let n={hadConstructor:!1,hadSuperClass:e},i=[],r=this.startNode();if(r.body=[],this.expect(5),this.withSmartMixTopicForbiddingContext((()=>{for(;!this.match(8);){if(this.eat(13)){if(i.length>0)throw this.raise(G.DecoratorSemicolon,this.state.lastTokEndLoc);continue}if(this.match(26)){i.push(this.parseDecorator());continue}let e=this.startNode();i.length&&(e.decorators=i,this.resetStartLocationFromNode(e,i[0]),i=[]),this.parseClassMember(r,e,n),"constructor"===e.kind&&e.decorators&&e.decorators.length>0&&this.raise(G.DecoratorConstructor,e)}})),this.state.strict=t,this.next(),i.length)throw this.raise(G.TrailingDecorator,this.state.startLoc);return this.classScope.exit(),this.finishNode(r,"ClassBody")}parseClassMemberFromModifier(e,t){let n=this.parseIdentifier(!0);if(this.isClassMethod()){let i=t;return i.kind="method",i.computed=!1,i.key=n,i.static=!1,this.pushClassMethod(e,i,!1,!1,!1,!1),!0}if(this.isClassProperty()){let i=t;return i.computed=!1,i.key=n,i.static=!1,e.body.push(this.parseClassProperty(i)),!0}return this.resetPreviousNodeTrailingComments(n),!1}parseClassMember(e,t,n){let i=this.isContextual(106);if(i){if(this.parseClassMemberFromModifier(e,t))return;if(this.eat(5))return void this.parseClassStaticBlock(e,t)}this.parseClassMemberWithIsStatic(e,t,n,i)}parseClassMemberWithIsStatic(e,t,n,i){let r=t,s=t,o=t,a=t,l=t,c=r,g=r;if(t.static=i,this.parsePropertyNamePrefixOperator(t),this.eat(55)){c.kind="method";let t=this.match(138);return this.parseClassElementName(c),t?void this.pushClassPrivateMethod(e,s,!0,!1):(this.isNonstaticConstructor(r)&&this.raise(G.ConstructorIsGenerator,r.key),void this.pushClassMethod(e,r,!0,!1,!1,!1))}let u=!this.state.containsEsc&&q(this.state.type),A=this.parseClassElementName(t),d=u?A.name:null,h=this.isPrivateName(A),I=this.state.startLoc;if(this.parsePostMemberNameModifiers(g),this.isClassMethod()){if(c.kind="method",h)return void this.pushClassPrivateMethod(e,s,!1,!1);let i=this.isNonstaticConstructor(r),o=!1;i&&(r.kind="constructor",n.hadConstructor&&!this.hasPlugin("typescript")&&this.raise(G.DuplicateConstructor,A),i&&this.hasPlugin("typescript")&&t.override&&this.raise(G.OverrideOnConstructor,A),n.hadConstructor=!0,o=n.hadSuperClass),this.pushClassMethod(e,r,!1,!1,i,o)}else if(this.isClassProperty())h?this.pushClassPrivateProperty(e,a):this.pushClassProperty(e,o);else if("async"!==d||this.isLineTerminator())if("get"!==d&&"set"!==d||this.match(55)&&this.isLineTerminator())if("accessor"!==d||this.isLineTerminator())this.isLineTerminator()?h?this.pushClassPrivateProperty(e,a):this.pushClassProperty(e,o):this.unexpected();else{this.expectPlugin("decoratorAutoAccessors"),this.resetPreviousNodeTrailingComments(A);let t=this.match(138);this.parseClassElementName(o),this.pushClassAccessorProperty(e,l,t)}else{this.resetPreviousNodeTrailingComments(A),c.kind=d;let t=this.match(138);this.parseClassElementName(r),t?this.pushClassPrivateMethod(e,s,!1,!1):(this.isNonstaticConstructor(r)&&this.raise(G.ConstructorIsAccessor,r.key),this.pushClassMethod(e,r,!1,!1,!1,!1)),this.checkGetterSetterParams(r)}else{this.resetPreviousNodeTrailingComments(A);let t=this.eat(55);g.optional&&this.unexpected(I),c.kind="method";let n=this.match(138);this.parseClassElementName(c),this.parsePostMemberNameModifiers(g),n?this.pushClassPrivateMethod(e,s,t,!0):(this.isNonstaticConstructor(r)&&this.raise(G.ConstructorIsAsync,r.key),this.pushClassMethod(e,r,t,!0,!1,!1))}}parseClassElementName(e){let{type:t,value:n}=this.state;if((132===t||133===t)&&e.static&&"prototype"===n&&this.raise(G.StaticPrototype,this.state.startLoc),138===t){"constructor"===n&&this.raise(G.ConstructorClassPrivateField,this.state.startLoc);let t=this.parsePrivateName();return e.key=t,t}return this.parsePropertyName(e),e.key}parseClassStaticBlock(e,t){var n;this.scope.enter(208);let i=this.state.labels;this.state.labels=[],this.prodParam.enter(0);let r=t.body=[];this.parseBlockOrModuleBlockBody(r,void 0,!1,8),this.prodParam.exit(),this.scope.exit(),this.state.labels=i,e.body.push(this.finishNode(t,"StaticBlock")),null!=(n=t.decorators)&&n.length&&this.raise(G.DecoratorStaticBlock,t)}pushClassProperty(e,t){!t.computed&&this.nameIsConstructor(t.key)&&this.raise(G.ConstructorClassField,t.key),e.body.push(this.parseClassProperty(t))}pushClassPrivateProperty(e,t){let n=this.parseClassPrivateProperty(t);e.body.push(n),this.classScope.declarePrivateName(this.getPrivateNameSV(n.key),0,n.key.loc.start)}pushClassAccessorProperty(e,t,n){!n&&!t.computed&&this.nameIsConstructor(t.key)&&this.raise(G.ConstructorClassField,t.key);let i=this.parseClassAccessorProperty(t);e.body.push(i),n&&this.classScope.declarePrivateName(this.getPrivateNameSV(i.key),0,i.key.loc.start)}pushClassMethod(e,t,n,i,r,s){e.body.push(this.parseMethod(t,n,i,r,s,"ClassMethod",!0))}pushClassPrivateMethod(e,t,n,i){let r=this.parseMethod(t,n,i,!1,!1,"ClassPrivateMethod",!0);e.body.push(r);let s="get"===r.kind?r.static?6:2:"set"===r.kind?r.static?5:1:0;this.declareClassPrivateMethodInScope(r,s)}declareClassPrivateMethodInScope(e,t){this.classScope.declarePrivateName(this.getPrivateNameSV(e.key),t,e.key.loc.start)}parsePostMemberNameModifiers(e){}parseClassPrivateProperty(e){return this.parseInitializer(e),this.semicolon(),this.finishNode(e,"ClassPrivateProperty")}parseClassProperty(e){return this.parseInitializer(e),this.semicolon(),this.finishNode(e,"ClassProperty")}parseClassAccessorProperty(e){return this.parseInitializer(e),this.semicolon(),this.finishNode(e,"ClassAccessorProperty")}parseInitializer(e){this.scope.enter(80),this.expressionScope.enter(wt()),this.prodParam.enter(0),e.value=this.eat(29)?this.parseMaybeAssignAllowIn():null,this.expressionScope.exit(),this.prodParam.exit(),this.scope.exit()}parseClassId(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8331;if(q(this.state.type))e.id=this.parseIdentifier(),t&&this.declareNameFromIdentifier(e.id,i);else{if(!n&&t)throw this.raise(G.MissingClassName,this.state.startLoc);e.id=null}}parseClassSuper(e){e.superClass=this.eat(81)?this.parseExprSubscripts():null}parseExport(e,t){let n=this.parseMaybeImportPhase(e,!0),i=this.maybeParseExportDefaultSpecifier(e,n),r=!i||this.eat(12),s=r&&this.eatExportStar(e),o=s&&this.maybeParseExportNamespaceSpecifier(e),a=r&&(!o||this.eat(12)),l=i||s;if(s&&!o){if(i&&this.unexpected(),t)throw this.raise(G.UnsupportedDecoratorExport,e);return this.parseExportFrom(e,!0),this.finishNode(e,"ExportAllDeclaration")}let c,g=this.maybeParseExportNamedSpecifiers(e);if(i&&r&&!s&&!g&&this.unexpected(null,5),o&&a&&this.unexpected(null,98),l||g){if(c=!1,t)throw this.raise(G.UnsupportedDecoratorExport,e);this.parseExportFrom(e,l)}else c=this.maybeParseExportDeclaration(e);if(l||g||c){var u;let n=e;if(this.checkExport(n,!0,!1,!!n.source),"ClassDeclaration"===(null==(u=n.declaration)?void 0:u.type))this.maybeTakeDecorators(t,n.declaration,n);else if(t)throw this.raise(G.UnsupportedDecoratorExport,e);return this.finishNode(n,"ExportNamedDeclaration")}if(this.eat(65)){let n=e,i=this.parseExportDefaultExpression();if(n.declaration=i,"ClassDeclaration"===i.type)this.maybeTakeDecorators(t,i,n);else if(t)throw this.raise(G.UnsupportedDecoratorExport,e);return this.checkExport(n,!0,!0),this.finishNode(n,"ExportDefaultDeclaration")}this.unexpected(null,5)}eatExportStar(e){return this.eat(55)}maybeParseExportDefaultSpecifier(e,t){if(t||this.isExportDefaultSpecifier()){this.expectPlugin("exportDefaultFrom",null==t?void 0:t.loc.start);let n=t||this.parseIdentifier(!0),i=this.startNodeAtNode(n);return i.exported=n,e.specifiers=[this.finishNode(i,"ExportDefaultSpecifier")],!0}return!1}maybeParseExportNamespaceSpecifier(e){if(this.isContextual(93)){var t;null!=(t=e).specifiers||(t.specifiers=[]);let n=this.startNodeAt(this.state.lastTokStartLoc);return this.next(),n.exported=this.parseModuleExportName(),e.specifiers.push(this.finishNode(n,"ExportNamespaceSpecifier")),!0}return!1}maybeParseExportNamedSpecifiers(e){if(this.match(5)){let t=e;t.specifiers||(t.specifiers=[]);let n="type"===t.exportKind;return t.specifiers.push(...this.parseExportSpecifiers(n)),t.source=null,t.declaration=null,this.hasPlugin("importAssertions")&&(t.assertions=[]),!0}return!1}maybeParseExportDeclaration(e){return!!this.shouldParseExportDeclaration()&&(e.specifiers=[],e.source=null,this.hasPlugin("importAssertions")&&(e.assertions=[]),e.declaration=this.parseExportDeclaration(e),!0)}isAsyncFunction(){if(!this.isContextual(95))return!1;let e=this.nextTokenInLineStart();return this.isUnparsedContextual(e,"function")}parseExportDefaultExpression(){let e=this.startNode();if(this.match(68))return this.next(),this.parseFunction(e,5);if(this.isAsyncFunction())return this.next(),this.next(),this.parseFunction(e,13);if(this.match(80))return this.parseClass(e,!0,!0);if(this.match(26))return this.hasPlugin("decorators")&&!0===this.getPluginOption("decorators","decoratorsBeforeExport")&&this.raise(G.DecoratorBeforeExport,this.state.startLoc),this.parseClass(this.maybeTakeDecorators(this.parseDecorators(!1),this.startNode()),!0,!0);if(this.match(75)||this.match(74)||this.isLet())throw this.raise(G.UnsupportedDefaultExport,this.state.startLoc);let t=this.parseMaybeAssignAllowIn();return this.semicolon(),t}parseExportDeclaration(e){return this.match(80)?this.parseClass(this.startNode(),!0,!1):this.parseStatementListItem()}isExportDefaultSpecifier(){let{type:e}=this.state;if(q(e)){if(95===e&&!this.state.containsEsc||100===e)return!1;if((130===e||129===e)&&!this.state.containsEsc){let{type:e}=this.lookahead();if(q(e)&&98!==e||5===e)return this.expectOnePlugin(["flow","typescript"]),!1}}else if(!this.match(65))return!1;let t=this.nextTokenStart(),n=this.isUnparsedContextual(t,"from");if(44===this.input.charCodeAt(t)||q(this.state.type)&&n)return!0;if(this.match(65)&&n){let e=this.input.charCodeAt(this.nextTokenStartSince(t+4));return 34===e||39===e}return!1}parseExportFrom(e,t){this.eatContextual(98)?(e.source=this.parseImportSource(),this.checkExport(e),this.maybeParseImportAttributes(e),this.checkJSONModuleImport(e)):t&&this.unexpected(),this.semicolon()}shouldParseExportDeclaration(){let{type:e}=this.state;return 26===e&&(this.expectOnePlugin(["decorators","decorators-legacy"]),this.hasPlugin("decorators"))?(!0===this.getPluginOption("decorators","decoratorsBeforeExport")&&this.raise(G.DecoratorBeforeExport,this.state.startLoc),!0):this.isContextual(107)||this.isContextual(96)&&this.startsAwaitUsing()?(this.raise(G.UsingDeclarationExport,this.state.startLoc),!0):74===e||75===e||68===e||80===e||this.isLet()||this.isAsyncFunction()}checkExport(e,t,n,i){var r;if(t)if(n){if(this.checkDuplicateExports(e,"default"),this.hasPlugin("exportDefaultFrom")){var s;let t=e.declaration;"Identifier"===t.type&&"from"===t.name&&t.end-t.start===4&&(null==(s=t.extra)||!s.parenthesized)&&this.raise(G.ExportDefaultFromAsIdentifier,t)}}else if(null!=(r=e.specifiers)&&r.length)for(let o of e.specifiers){let{exported:e}=o,t="Identifier"===e.type?e.name:e.value;if(this.checkDuplicateExports(o,t),!i&&o.local){let{local:e}=o;"Identifier"!==e.type?this.raise(G.ExportBindingIsString,o,{localName:e.value,exportName:t}):(this.checkReservedWord(e.name,e.loc.start,!0,!1),this.scope.checkLocalExport(e))}}else if(e.declaration){let t=e.declaration;if("FunctionDeclaration"===t.type||"ClassDeclaration"===t.type){let{id:n}=t;if(!n)throw new Error("Assertion failure");this.checkDuplicateExports(e,n.name)}else if("VariableDeclaration"===t.type)for(let e of t.declarations)this.checkDeclaration(e.id)}}checkDeclaration(e){if("Identifier"===e.type)this.checkDuplicateExports(e,e.name);else if("ObjectPattern"===e.type)for(let t of e.properties)this.checkDeclaration(t);else if("ArrayPattern"===e.type)for(let t of e.elements)t&&this.checkDeclaration(t);else"ObjectProperty"===e.type?this.checkDeclaration(e.value):"RestElement"===e.type?this.checkDeclaration(e.argument):"AssignmentPattern"===e.type&&this.checkDeclaration(e.left)}checkDuplicateExports(e,t){this.exportedIdentifiers.has(t)&&("default"===t?this.raise(G.DuplicateDefaultExport,e):this.raise(G.DuplicateExport,e,{exportName:t})),this.exportedIdentifiers.add(t)}parseExportSpecifiers(e){let t=[],n=!0;for(this.expect(5);!this.eat(8);){if(n)n=!1;else if(this.expect(12),this.eat(8))break;let i=this.isContextual(130),r=this.match(133),s=this.startNode();s.local=this.parseModuleExportName(),t.push(this.parseExportSpecifier(s,r,e,i))}return t}parseExportSpecifier(e,t,n,i){return this.eatContextual(93)?e.exported=this.parseModuleExportName():t?e.exported=Nt(e.local):e.exported||(e.exported=Ft(e.local)),this.finishNode(e,"ExportSpecifier")}parseModuleExportName(){if(this.match(133)){let e=this.parseStringLiteral(this.state.value),t=xn.exec(e.value);return t&&this.raise(G.ModuleExportNameHasLoneSurrogate,e,{surrogateCharCode:t[0].charCodeAt(0)}),e}return this.parseIdentifier(!0)}isJSONModuleImport(e){return null!=e.assertions&&e.assertions.some((e=>{let{key:t,value:n}=e;return"json"===n.value&&("Identifier"===t.type?"type"===t.name:"type"===t.value)}))}checkImportReflection(e){let{specifiers:t}=e,n=1===t.length?t[0].type:null;if("source"===e.phase)"ImportDefaultSpecifier"!==n&&this.raise(G.SourcePhaseImportRequiresDefault,t[0].loc.start);else if("defer"===e.phase)"ImportNamespaceSpecifier"!==n&&this.raise(G.DeferImportRequiresNamespace,t[0].loc.start);else if(e.module){var i;"ImportDefaultSpecifier"!==n&&this.raise(G.ImportReflectionNotBinding,t[0].loc.start),(null==(i=e.assertions)?void 0:i.length)>0&&this.raise(G.ImportReflectionHasAssertion,t[0].loc.start)}}checkJSONModuleImport(e){if(this.isJSONModuleImport(e)&&"ExportAllDeclaration"!==e.type){let{specifiers:t}=e;if(null!=t){let e=t.find((e=>{let t;if("ExportSpecifier"===e.type?t=e.local:"ImportSpecifier"===e.type&&(t=e.imported),void 0!==t)return"Identifier"===t.type?"default"!==t.name:"default"!==t.value}));void 0!==e&&this.raise(G.ImportJSONBindingNotDefault,e.loc.start)}}}isPotentialImportPhase(e){return!e&&(this.isContextual(105)||this.isContextual(97)||this.isContextual(127))}applyImportPhase(e,t,n,i){t||("module"===n?(this.expectPlugin("importReflection",i),e.module=!0):this.hasPlugin("importReflection")&&(e.module=!1),"source"===n?(this.expectPlugin("sourcePhaseImports",i),e.phase="source"):"defer"===n?(this.expectPlugin("deferredImportEvaluation",i),e.phase="defer"):this.hasPlugin("sourcePhaseImports")&&(e.phase=null))}parseMaybeImportPhase(e,t){if(!this.isPotentialImportPhase(t))return this.applyImportPhase(e,t,null),null;let n=this.parseIdentifier(!0),{type:i}=this.state;return(ee(i)?98!==i||102===this.lookaheadCharCode():12!==i)?(this.resetPreviousIdentifierLeadingComments(n),this.applyImportPhase(e,t,n.name,n.loc.start),null):(this.applyImportPhase(e,t,null),n)}isPrecedingIdImportPhase(e){let{type:t}=this.state;return q(t)?98!==t||102===this.lookaheadCharCode():12!==t}parseImport(e){return this.match(133)?this.parseImportSourceAndAttributes(e):this.parseImportSpecifiersAndAfter(e,this.parseMaybeImportPhase(e,!1))}parseImportSpecifiersAndAfter(e,t){e.specifiers=[];let n=!this.maybeParseDefaultImportSpecifier(e,t)||this.eat(12),i=n&&this.maybeParseStarImportSpecifier(e);return n&&!i&&this.parseNamedImportSpecifiers(e),this.expectContextual(98),this.parseImportSourceAndAttributes(e)}parseImportSourceAndAttributes(e){return null!=e.specifiers||(e.specifiers=[]),e.source=this.parseImportSource(),this.maybeParseImportAttributes(e),this.checkImportReflection(e),this.checkJSONModuleImport(e),this.semicolon(),this.finishNode(e,"ImportDeclaration")}parseImportSource(){return this.match(133)||this.unexpected(),this.parseExprAtom()}parseImportSpecifierLocal(e,t,n){t.local=this.parseIdentifier(),e.specifiers.push(this.finishImportSpecifier(t,n))}finishImportSpecifier(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8201;return this.checkLVal(e.local,{in:{type:t},binding:n}),this.finishNode(e,t)}parseImportAttributes(){this.expect(5);let e=[],t=new Set;do{if(this.match(8))break;let n=this.startNode(),i=this.state.value;if(t.has(i)&&this.raise(G.ModuleAttributesWithDuplicateKeys,this.state.startLoc,{key:i}),t.add(i),this.match(133)?n.key=this.parseStringLiteral(i):n.key=this.parseIdentifier(!0),this.expect(14),!this.match(133))throw this.raise(G.ModuleAttributeInvalidValue,this.state.startLoc);n.value=this.parseStringLiteral(this.state.value),e.push(this.finishNode(n,"ImportAttribute"))}while(this.eat(12));return this.expect(8),e}parseModuleAttributes(){let e=[],t=new Set;do{let n=this.startNode();if(n.key=this.parseIdentifier(!0),"type"!==n.key.name&&this.raise(G.ModuleAttributeDifferentFromType,n.key),t.has(n.key.name)&&this.raise(G.ModuleAttributesWithDuplicateKeys,n.key,{key:n.key.name}),t.add(n.key.name),this.expect(14),!this.match(133))throw this.raise(G.ModuleAttributeInvalidValue,this.state.startLoc);n.value=this.parseStringLiteral(this.state.value),e.push(this.finishNode(n,"ImportAttribute"))}while(this.eat(12));return e}maybeParseImportAttributes(e){let t,n=!1;if(this.match(76)){if(this.hasPrecedingLineBreak()&&40===this.lookaheadCharCode())return;this.next(),this.hasPlugin("moduleAttributes")?t=this.parseModuleAttributes():(this.expectImportAttributesPlugin(),t=this.parseImportAttributes()),n=!0}else if(this.isContextual(94)&&!this.hasPrecedingLineBreak())this.hasPlugin("importAttributes")?(!0!==this.getPluginOption("importAttributes","deprecatedAssertSyntax")&&this.raise(G.ImportAttributesUseAssert,this.state.startLoc),this.addExtra(e,"deprecatedAssertSyntax",!0)):this.expectOnePlugin(["importAttributes","importAssertions"]),this.next(),t=this.parseImportAttributes();else if(this.hasPlugin("importAttributes")||this.hasPlugin("importAssertions"))t=[];else{if(!this.hasPlugin("moduleAttributes"))return;t=[]}!n&&this.hasPlugin("importAssertions")?e.assertions=t:e.attributes=t}maybeParseDefaultImportSpecifier(e,t){if(t){let n=this.startNodeAtNode(t);return n.local=t,e.specifiers.push(this.finishImportSpecifier(n,"ImportDefaultSpecifier")),!0}return!!ee(this.state.type)&&(this.parseImportSpecifierLocal(e,this.startNode(),"ImportDefaultSpecifier"),!0)}maybeParseStarImportSpecifier(e){if(this.match(55)){let t=this.startNode();return this.next(),this.expectContextual(93),this.parseImportSpecifierLocal(e,t,"ImportNamespaceSpecifier"),!0}return!1}parseNamedImportSpecifiers(e){let t=!0;for(this.expect(5);!this.eat(8);){if(t)t=!1;else{if(this.eat(14))throw this.raise(G.DestructureNamedImport,this.state.startLoc);if(this.expect(12),this.eat(8))break}let n=this.startNode(),i=this.match(133),r=this.isContextual(130);n.imported=this.parseModuleExportName();let s=this.parseImportSpecifier(n,i,"type"===e.importKind||"typeof"===e.importKind,r,void 0);e.specifiers.push(s)}}parseImportSpecifier(e,t,n,i,r){if(this.eatContextual(93))e.local=this.parseIdentifier();else{let{imported:n}=e;if(t)throw this.raise(G.ImportBindingIsString,e,{importName:n.value});this.checkReservedWord(n.name,e.loc.start,!0,!0),e.local||(e.local=Ft(n))}return this.finishImportSpecifier(e,"ImportSpecifier",r)}isThisParam(e){return"Identifier"===e.type&&"this"===e.name}},Dn=class extends Zn{constructor(e,t){super(e=vn(e),t),this.options=e,this.initializeScopes(),this.plugins=Fn(this.options.plugins),this.filename=e.sourceFilename}getScopeHandler(){return He}parse(){this.enterInitialScopes();let e=this.startNode(),t=this.startNode();return this.nextToken(),e.errors=null,this.parseTopLevel(e,t),e.errors=this.state.errors,e.comments.length=this.state.commentsLen,e}};function Fn(e){let t=new Map;for(let n of e){let[e,i]=Array.isArray(n)?n:[n,{}];t.has(e)||t.set(e,i||{})}return t}function Nn(e,t){var n;if("unambiguous"!==(null==(n=t)?void 0:n.sourceType))return Tn(t,e).parse();t=Object.assign({},t);try{t.sourceType="module";let n=Tn(t,e),i=n.parse();if(n.sawUnambiguousESM)return i;if(n.ambiguousScriptDifferentAst)try{return t.sourceType="script",Tn(t,e).parse()}catch{}else i.program.sourceType="script";return i}catch(i){try{return t.sourceType="script",Tn(t,e).parse()}catch{}throw i}}function Mn(e,t){let n=Tn(t,e);return n.options.strictMode&&(n.state.strict=!0),n.getExpression()}function Wn(e){let t={};for(let n of Object.keys(e))t[n]=Ce(e[n]);return t}var kn=Wn(j);function Tn(e,t){let n=Dn;return null!=e&&e.plugins&&(fn(e.plugins),n=Ln(e.plugins)),new n(e,t)}var Vn={};function Ln(e){let t=bn.filter((t=>In(e,t))),n=t.join("/"),i=Vn[n];if(!i){i=Dn;for(let e of t)i=yn[e](i);Vn[n]=i}return i}t.parse=Nn,t.parseExpression=Mn,t.tokTypes=kn})),f={};h(f,{parsers:()=>tt});var y=p(m(),1);function b(e){return(t,n,i)=>{let r=!(null==i||!i.backwards);if(!1===n)return!1;let{length:s}=t,o=n;for(;o>=0&&o<s;){let n=t.charAt(o);if(e instanceof RegExp){if(!e.test(n))return o}else if(!e.includes(n))return o;r?o--:o++}return(-1===o||o===s)&&o}}b(/\s/u);var B=b(" \t"),v=(b(",; \t"),b(/[^\n\r]/u));function w(e,t){if(!1===t)return!1;if("/"===e.charAt(t)&&"*"===e.charAt(t+1))for(let n=t+2;n<e.length;++n)if("*"===e.charAt(n)&&"/"===e.charAt(n+1))return n+2;return t}var G=w;function E(e,t,n){let i=!(null==n||!n.backwards);if(!1===t)return!1;let r=e.charAt(t);if(i){if("\r"===e.charAt(t-1)&&"\n"===r)return t-2;if("\n"===r||"\r"===r||"\u2028"===r||"\u2029"===r)return t-1}else{if("\r"===r&&"\n"===e.charAt(t+1))return t+2;if("\n"===r||"\r"===r||"\u2028"===r||"\u2029"===r)return t+1}return t}var x=E;function S(e,t){return!1!==t&&("/"===e.charAt(t)&&"/"===e.charAt(t+1)?v(e,t):t)}var R=S;function Z(e,t){let n=null,i=t;for(;i!==n;)n=i,i=B(e,i),i=G(e,i),i=R(e,i),i=x(e,i);return i}var D=Z;function F(e){let t=[];for(let i of e)try{return i()}catch(n){t.push(n)}throw Object.assign(new Error("All combinations failed"),{errors:t})}var N=F;function M(e){if(!e.startsWith("#!"))return"";let t=e.indexOf("\n");return-1===t?e:e.slice(0,t)}var W=M,k=(e,t,n)=>{if(!e||null!=t)return Array.isArray(t)||"string"==typeof t?t[n<0?t.length+n:n]:t.at(n)},T=k;function V(e){return Array.isArray(e)&&e.length>0}var L=V;function H(e){var t,n,i,r,s;let o=null!==(t=null==(i=e.range)?void 0:i[0])&&void 0!==t?t:e.start,a=null==(s=null!==(n=null==(r=e.declaration)?void 0:r.decorators)&&void 0!==n?n:e.decorators)?void 0:s[0];return a?Math.min(H(a),o):o}function Q(e){var t,n;return null!==(t=null==(n=e.range)?void 0:n[1])&&void 0!==t?t:e.end}function K(e){let t=new Set(e);return e=>t.has(null==e?void 0:e.type)}var X=K(["Block","CommentBlock","MultiLine"]);function Y(e){let t="*".concat(e.value,"*").split("\n");return t.length>1&&t.every((e=>"*"===e.trimStart()[0]))}var z=Y;function P(e){return X(e)&&"*"===e.value[0]&&/@(?:type|satisfies)\b/u.test(e.value)}var U=P,_=null;function O(e){if(null!==_&&(_.property,1)){let e=_;return _=O.prototype=null,e}return _=O.prototype=null!==e&&void 0!==e?e:Object.create(null),new O}var J=10;for(let e=0;e<=J;e++)O();function j(e){return O(e)}function q(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"type";function n(n){let i=n[t],r=e[i];if(!Array.isArray(r))throw Object.assign(new Error("Missing visitor keys for '".concat(i,"'.")),{node:n});return r}return j(e),n}var $=q({ArrayExpression:["elements"],AssignmentExpression:["left","right"],BinaryExpression:["left","right"],InterpreterDirective:[],Directive:["value"],DirectiveLiteral:[],BlockStatement:["directives","body"],BreakStatement:["label"],CallExpression:["callee","arguments","typeParameters","typeArguments"],CatchClause:["param","body"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DoWhileStatement:["test","body"],EmptyStatement:[],ExpressionStatement:["expression"],File:["program"],ForInStatement:["left","right","body"],ForStatement:["init","test","update","body"],FunctionDeclaration:["id","params","body","returnType","typeParameters","predicate"],FunctionExpression:["id","params","body","returnType","typeParameters"],Identifier:["typeAnnotation","decorators"],IfStatement:["test","consequent","alternate"],LabeledStatement:["label","body"],StringLiteral:[],NumericLiteral:[],NullLiteral:[],BooleanLiteral:[],RegExpLiteral:[],LogicalExpression:["left","right"],MemberExpression:["object","property"],NewExpression:["callee","arguments","typeParameters","typeArguments"],Program:["directives","body"],ObjectExpression:["properties"],ObjectMethod:["key","params","body","decorators","returnType","typeParameters"],ObjectProperty:["key","value","decorators"],RestElement:["argument","typeAnnotation","decorators"],ReturnStatement:["argument"],SequenceExpression:["expressions"],ParenthesizedExpression:["expression"],SwitchCase:["test","consequent"],SwitchStatement:["discriminant","cases"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handler","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],AssignmentPattern:["left","right","decorators","typeAnnotation"],ArrayPattern:["elements","typeAnnotation","decorators"],ArrowFunctionExpression:["params","body","returnType","typeParameters","predicate"],ClassBody:["body"],ClassExpression:["id","body","superClass","mixins","typeParameters","superTypeParameters","implements","decorators","superTypeArguments"],ClassDeclaration:["id","body","superClass","mixins","typeParameters","superTypeParameters","implements","decorators","superTypeArguments"],ExportAllDeclaration:["source","attributes","exported"],ExportDefaultDeclaration:["declaration"],ExportNamedDeclaration:["declaration","specifiers","source","attributes"],ExportSpecifier:["local","exported"],ForOfStatement:["left","right","body"],ImportDeclaration:["specifiers","source","attributes"],ImportDefaultSpecifier:["local"],ImportNamespaceSpecifier:["local"],ImportSpecifier:["local","imported"],ImportExpression:["source","options","attributes"],MetaProperty:["meta","property"],ClassMethod:["key","params","body","decorators","returnType","typeParameters"],ObjectPattern:["properties","typeAnnotation","decorators"],SpreadElement:["argument"],Super:[],TaggedTemplateExpression:["tag","quasi","typeParameters","typeArguments"],TemplateElement:[],TemplateLiteral:["quasis","expressions"],YieldExpression:["argument"],AwaitExpression:["argument"],Import:[],BigIntLiteral:[],ExportNamespaceSpecifier:["exported"],OptionalMemberExpression:["object","property"],OptionalCallExpression:["callee","arguments","typeParameters","typeArguments"],ClassProperty:["key","value","typeAnnotation","decorators","variance"],ClassAccessorProperty:["key","value","typeAnnotation","decorators"],ClassPrivateProperty:["key","value","decorators","typeAnnotation","variance"],ClassPrivateMethod:["key","params","body","decorators","returnType","typeParameters"],PrivateName:["id"],StaticBlock:["body"],AnyTypeAnnotation:[],ArrayTypeAnnotation:["elementType"],BooleanTypeAnnotation:[],BooleanLiteralTypeAnnotation:[],NullLiteralTypeAnnotation:[],ClassImplements:["id","typeParameters"],DeclareClass:["id","typeParameters","extends","mixins","implements","body"],DeclareFunction:["id","predicate"],DeclareInterface:["id","typeParameters","extends","body"],DeclareModule:["id","body"],DeclareModuleExports:["typeAnnotation"],DeclareTypeAlias:["id","typeParameters","right"],DeclareOpaqueType:["id","typeParameters","supertype"],DeclareVariable:["id"],DeclareExportDeclaration:["declaration","specifiers","source"],DeclareExportAllDeclaration:["source"],DeclaredPredicate:["value"],ExistsTypeAnnotation:[],FunctionTypeAnnotation:["typeParameters","params","rest","returnType","this"],FunctionTypeParam:["name","typeAnnotation"],GenericTypeAnnotation:["id","typeParameters"],InferredPredicate:[],InterfaceExtends:["id","typeParameters"],InterfaceDeclaration:["id","typeParameters","extends","body"],InterfaceTypeAnnotation:["extends","body"],IntersectionTypeAnnotation:["types"],MixedTypeAnnotation:[],EmptyTypeAnnotation:[],NullableTypeAnnotation:["typeAnnotation"],NumberLiteralTypeAnnotation:[],NumberTypeAnnotation:[],ObjectTypeAnnotation:["properties","indexers","callProperties","internalSlots"],ObjectTypeInternalSlot:["id","value"],ObjectTypeCallProperty:["value"],ObjectTypeIndexer:["id","key","value","variance"],ObjectTypeProperty:["key","value","variance"],ObjectTypeSpreadProperty:["argument"],OpaqueType:["id","typeParameters","supertype","impltype"],QualifiedTypeIdentifier:["id","qualification"],StringLiteralTypeAnnotation:[],StringTypeAnnotation:[],SymbolTypeAnnotation:[],ThisTypeAnnotation:[],TupleTypeAnnotation:["types","elementTypes"],TypeofTypeAnnotation:["argument","typeArguments"],TypeAlias:["id","typeParameters","right"],TypeAnnotation:["typeAnnotation"],TypeCastExpression:["expression","typeAnnotation"],TypeParameter:["bound","default","variance"],TypeParameterDeclaration:["params"],TypeParameterInstantiation:["params"],UnionTypeAnnotation:["types"],Variance:[],VoidTypeAnnotation:[],EnumDeclaration:["id","body"],EnumBooleanBody:["members"],EnumNumberBody:["members"],EnumStringBody:["members"],EnumSymbolBody:["members"],EnumBooleanMember:["id","init"],EnumNumberMember:["id","init"],EnumStringMember:["id","init"],EnumDefaultedMember:["id"],IndexedAccessType:["objectType","indexType"],OptionalIndexedAccessType:["objectType","indexType"],JSXAttribute:["name","value"],JSXClosingElement:["name"],JSXElement:["openingElement","children","closingElement"],JSXEmptyExpression:[],JSXExpressionContainer:["expression"],JSXSpreadChild:["expression"],JSXIdentifier:[],JSXMemberExpression:["object","property"],JSXNamespacedName:["namespace","name"],JSXOpeningElement:["name","attributes","typeArguments","typeParameters"],JSXSpreadAttribute:["argument"],JSXText:[],JSXFragment:["openingFragment","children","closingFragment"],JSXOpeningFragment:[],JSXClosingFragment:[],Noop:[],Placeholder:[],V8IntrinsicIdentifier:[],ArgumentPlaceholder:[],BindExpression:["object","callee"],ImportAttribute:["key","value"],Decorator:["expression"],DoExpression:["body"],ExportDefaultSpecifier:["exported"],RecordExpression:["properties"],TupleExpression:["elements"],DecimalLiteral:[],ModuleExpression:["body"],TopicReference:[],PipelineTopicExpression:["expression"],PipelineBareFunction:["callee"],PipelinePrimaryTopicReference:[],TSParameterProperty:["parameter","decorators"],TSDeclareFunction:["id","typeParameters","params","returnType","body"],TSDeclareMethod:["decorators","key","typeParameters","params","returnType"],TSQualifiedName:["left","right"],TSCallSignatureDeclaration:["typeParameters","parameters","typeAnnotation","params","returnType"],TSConstructSignatureDeclaration:["typeParameters","parameters","typeAnnotation","params","returnType"],TSPropertySignature:["key","typeAnnotation"],TSMethodSignature:["key","typeParameters","parameters","typeAnnotation","params","returnType"],TSIndexSignature:["parameters","typeAnnotation"],TSAnyKeyword:[],TSBooleanKeyword:[],TSBigIntKeyword:[],TSIntrinsicKeyword:[],TSNeverKeyword:[],TSNullKeyword:[],TSNumberKeyword:[],TSObjectKeyword:[],TSStringKeyword:[],TSSymbolKeyword:[],TSUndefinedKeyword:[],TSUnknownKeyword:[],TSVoidKeyword:[],TSThisType:[],TSFunctionType:["typeParameters","parameters","typeAnnotation","params","returnType"],TSConstructorType:["typeParameters","parameters","typeAnnotation","params","returnType"],TSTypeReference:["typeName","typeParameters","typeArguments"],TSTypePredicate:["parameterName","typeAnnotation"],TSTypeQuery:["exprName","typeParameters","typeArguments"],TSTypeLiteral:["members"],TSArrayType:["elementType"],TSTupleType:["elementTypes"],TSOptionalType:["typeAnnotation"],TSRestType:["typeAnnotation"],TSNamedTupleMember:["label","elementType"],TSUnionType:["types"],TSIntersectionType:["types"],TSConditionalType:["checkType","extendsType","trueType","falseType"],TSInferType:["typeParameter"],TSParenthesizedType:["typeAnnotation"],TSTypeOperator:["typeAnnotation"],TSIndexedAccessType:["objectType","indexType"],TSMappedType:["typeParameter","typeAnnotation","nameType"],TSLiteralType:["literal"],TSExpressionWithTypeArguments:["expression","typeParameters"],TSInterfaceDeclaration:["id","typeParameters","extends","body"],TSInterfaceBody:["body"],TSTypeAliasDeclaration:["id","typeParameters","typeAnnotation"],TSInstantiationExpression:["expression","typeParameters","typeArguments"],TSAsExpression:["expression","typeAnnotation"],TSSatisfiesExpression:["expression","typeAnnotation"],TSTypeAssertion:["typeAnnotation","expression"],TSEnumDeclaration:["id","members"],TSEnumMember:["id","initializer"],TSModuleDeclaration:["id","body"],TSModuleBlock:["body"],TSImportType:["argument","qualifier","typeParameters","typeArguments"],TSImportEqualsDeclaration:["id","moduleReference"],TSExternalModuleReference:["expression"],TSNonNullExpression:["expression"],TSExportAssignment:["expression"],TSNamespaceExportDeclaration:["id"],TSTypeAnnotation:["typeAnnotation"],TSTypeParameterInstantiation:["params"],TSTypeParameterDeclaration:["params"],TSTypeParameter:["constraint","default","name"],ChainExpression:["expression"],ExperimentalRestProperty:["argument"],ExperimentalSpreadProperty:["argument"],Literal:[],MethodDefinition:["decorators","key","value"],PrivateIdentifier:[],Property:["key","value"],PropertyDefinition:["decorators","key","typeAnnotation","value","variance"],AccessorProperty:["decorators","key","typeAnnotation","value"],TSAbstractAccessorProperty:["decorators","key","typeAnnotation"],TSAbstractKeyword:[],TSAbstractMethodDefinition:["key","value"],TSAbstractPropertyDefinition:["decorators","key","typeAnnotation"],TSAsyncKeyword:[],TSClassImplements:["expression","typeArguments","typeParameters"],TSDeclareKeyword:[],TSEmptyBodyFunctionExpression:["id","typeParameters","params","returnType"],TSEnumBody:["members"],TSExportKeyword:[],TSInterfaceHeritage:["expression","typeArguments","typeParameters"],TSPrivateKeyword:[],TSProtectedKeyword:[],TSPublicKeyword:[],TSReadonlyKeyword:[],TSStaticKeyword:[],TSTemplateLiteralType:["quasis","types"],AsConstExpression:["expression"],AsExpression:["expression","typeAnnotation"],BigIntLiteralTypeAnnotation:[],BigIntTypeAnnotation:[],ComponentDeclaration:["id","params","body","typeParameters","rendersType"],ComponentParameter:["name","local"],ComponentTypeAnnotation:["params","rest","typeParameters","rendersType"],ComponentTypeParameter:["name","typeAnnotation"],ConditionalTypeAnnotation:["checkType","extendsType","trueType","falseType"],DeclareComponent:["id","params","rest","typeParameters","rendersType"],DeclareEnum:["id","body"],DeclareHook:["id"],DeclareNamespace:["id","body"],EnumBigIntBody:["members"],EnumBigIntMember:["id","init"],HookDeclaration:["id","params","body","typeParameters","returnType"],HookTypeAnnotation:["params","returnType","rest","typeParameters"],InferTypeAnnotation:["typeParameter"],KeyofTypeAnnotation:["argument"],ObjectTypeMappedTypeProperty:["keyTparam","propType","sourceType","variance"],QualifiedTypeofIdentifier:["qualification","id"],TupleTypeLabeledElement:["label","elementType","variance"],TupleTypeSpreadElement:["label","typeAnnotation"],TypeOperator:["typeAnnotation"],TypePredicate:["parameterName","typeAnnotation","asserts"],NGRoot:["node"],NGPipeExpression:["left","right","arguments"],NGChainedExpression:["expressions"],NGEmptyExpression:[],NGMicrosyntax:["body"],NGMicrosyntaxKey:[],NGMicrosyntaxExpression:["expression","alias"],NGMicrosyntaxKeyedExpression:["key","expression"],NGMicrosyntaxLet:["key","value"],NGMicrosyntaxAs:["key","alias"],JsExpressionRoot:["node"],JsonRoot:["node"],TSJSDocAllType:[],TSJSDocUnknownType:[],TSJSDocNullableType:["typeAnnotation"],TSJSDocNonNullableType:["typeAnnotation"],NeverTypeAnnotation:[],UndefinedTypeAnnotation:[],UnknownTypeAnnotation:[],SatisfiesExpression:["expression","typeAnnotation"]});function ee(e,t){if(null===e||"object"!=typeof e)return e;if(Array.isArray(e)){for(let n=0;n<e.length;n++)e[n]=ee(e[n],t);return e}let n=$(e);for(let i=0;i<n.length;i++)e[n[i]]=ee(e[n[i]],t);return t(e)||e}var te=ee;function ne(e,t){let{parser:n,text:i}=t;if("File"===e.type&&e.program.interpreter){let{program:{interpreter:t},comments:n}=e;delete e.program.interpreter,n.unshift(t)}if("babel"===n){let t=new Set;e=te(e,(e=>{var n;null!=(n=e.leadingComments)&&n.some(U)&&t.add(H(e))})),e=te(e,(e=>{if("ParenthesizedExpression"===e.type){let{expression:n}=e;if("TypeCastExpression"===n.type)return n.range=[...e.range],n;let i=H(e);if(!t.has(i))return n.extra={...n.extra,parenthesized:!0},n}}))}if(e=te(e,(t=>{var r;switch(t.type){case"LogicalExpression":if(ie(t))return re(t);break;case"VariableDeclaration":{let e=T(!1,t.declarations,-1);null!=e&&e.init&&";"!==i[Q(e)]&&(t.range=[H(t),Q(e)]);break}case"TSParenthesizedType":return t.typeAnnotation;case"TSTypeParameter":if("string"==typeof t.name){let e=H(t);t.name={type:"Identifier",name:t.name,range:[e,e+t.name.length]}}break;case"TopicReference":e.extra={...e.extra,__isUsingHackPipeline:!0};break;case"ExportAllDeclaration":if("meriyah"===n&&"Identifier"===(null==(r=t.exported)?void 0:r.type)){let{exported:e}=t,n=i.slice(H(e),Q(e));(n.startsWith('"')||n.startsWith("'"))&&(t.exported={...t.exported,type:"Literal",value:t.exported.name,raw:n})}break;case"TSUnionType":case"TSIntersectionType":if(1===t.types.length)return t.types[0]}})),L(e.comments)){let t=T(!1,e.comments,-1);for(let n=e.comments.length-2;n>=0;n--){let i=e.comments[n];Q(i)===H(t)&&X(i)&&X(t)&&z(i)&&z(t)&&(e.comments.splice(n+1,1),i.value+="*//*"+t.value,i.range=[H(i),Q(t)]),t=i}}return"Program"===e.type&&(e.range=[0,i.length]),e}function ie(e){return"LogicalExpression"===e.type&&"LogicalExpression"===e.right.type&&e.operator===e.right.operator}function re(e){return ie(e)?re({type:"LogicalExpression",operator:e.operator,left:re({type:"LogicalExpression",operator:e.operator,left:e.left,right:e.right.left,range:[H(e.left),Q(e.right.left)]}),right:e.right.right,range:[H(e),Q(e)]}):e}var se=ne;function oe(e,t){let n=new SyntaxError(e+" ("+t.loc.start.line+":"+t.loc.start.column+")");return Object.assign(n,t)}var ae=oe;function le(e){let{message:t,loc:{line:n,column:i},reasonCode:r}=e,s=e;("MissingPlugin"===r||"MissingOneOfPlugins"===r)&&(t="Unexpected token.",s=void 0);let o=" (".concat(n,":").concat(i,")");return t.endsWith(o)&&(t=t.slice(0,-o.length)),ae(t,{loc:{start:{line:n,column:i+1}},cause:s})}var ce=le,ge=(e,t,n,i)=>{if(!e||null!=t)return t.replaceAll?t.replaceAll(n,i):n.global?t.replace(n,i):t.split(n).join(i)},ue=ge,Ae=/\*\/$/,de=/^\/\*\*?/,he=/^\s*(\/\*\*?(.|\r?\n)*?\*\/)/,Ie=/(^|\s+)\/\/([^\n\r]*)/g,pe=/^(\r?\n)+/,Ce=/(?:^|\r?\n) *(@[^\n\r]*?) *\r?\n *(?![^\n\r@]*\/\/[^]*)([^\s@][^\n\r@]+?) *\r?\n/g,me=/(?:^|\r?\n) *@(\S+) *([^\n\r]*)/g,fe=/(\r?\n|^) *\* ?/g,ye=[];function be(e){let t=e.match(he);return t?t[0].trimStart():""}function Be(e){let t="\n";e=ue(!1,e.replace(de,"").replace(Ae,""),fe,"$1");let n="";for(;n!==e;)n=e,e=ue(!1,e,Ce,"".concat(t,"$1 $2").concat(t));e=e.replace(pe,"").trimEnd();let i,r=Object.create(null),s=ue(!1,e,me,"").replace(pe,"").trimEnd();for(;i=me.exec(e);){let e=ue(!1,i[2],Ie,"");if("string"==typeof r[i[1]]||Array.isArray(r[i[1]])){let t=r[i[1]];r[i[1]]=[...ye,...Array.isArray(t)?t:[t],e]}else r[i[1]]=e}return{comments:s,pragmas:r}}function ve(e){let t=W(e);t&&(e=e.slice(t.length+1));let n=be(e),{pragmas:i,comments:r}=Be(n);return{shebang:t,text:e,pragmas:i,comments:r}}function we(e){let{pragmas:t}=ve(e);return Object.prototype.hasOwnProperty.call(t,"prettier")||Object.prototype.hasOwnProperty.call(t,"format")}function Ge(e){return e="function"==typeof e?{parse:e}:e,{astFormat:"estree",hasPragma:we,locStart:H,locEnd:Q,...e}}var Ee=Ge;function xe(e){let{filepath:t}=e;if(t){if(t=t.toLowerCase(),t.endsWith(".cjs"))return"script";if(t.endsWith(".mjs"))return"module"}}var Se=xe;function Re(e,t){let{type:n="JsExpressionRoot",rootMarker:i,text:r}=t,{tokens:s,comments:o}=e;return delete e.tokens,delete e.comments,{tokens:s,comments:o,type:n,node:e,range:[0,r.length],rootMarker:i}}var Ze=Re,De=e=>Ee(Le(e)),Fe={sourceType:"module",allowImportExportEverywhere:!0,allowReturnOutsideFunction:!0,allowNewTargetOutsideFunction:!0,allowSuperOutsideMethod:!0,allowUndeclaredExports:!0,errorRecovery:!0,createParenthesizedExpressions:!0,createImportExpressions:!0,plugins:["doExpressions","exportDefaultFrom","functionBind","functionSent","throwExpressions","partialApplication","decorators","decimal","moduleBlocks","asyncDoExpressions","destructuringPrivate","decoratorAutoAccessors","importReflection","explicitResourceManagement",["importAttributes",{deprecatedAssertSyntax:!0}],"sourcePhaseImports","deferredImportEvaluation",["optionalChainingAssign",{version:"2023-07"}],"recordAndTuple"],tokens:!0,ranges:!0},Ne="v8intrinsic",Me=[["pipelineOperator",{proposal:"hack",topicToken:"%"}],["pipelineOperator",{proposal:"minimal"}],["pipelineOperator",{proposal:"fsharp"}]],We=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Fe;return{...t,plugins:[...t.plugins,...e]}},ke=/@(?:no)?flow\b/u;function Te(e,t){var n;if(null!=(n=t.filepath)&&n.endsWith(".js.flow"))return!0;let i=W(e);i&&(e=e.slice(i.length));let r=D(e,0);return!1!==r&&(e=e.slice(0,r)),ke.test(e)}function Ve(e,t,n){let i=e(t,n),r=i.errors.find((e=>!He.has(e.reasonCode)));if(r)throw r;return i}function Le(e){let{isExpression:t=!1,optionsCombinations:n}=e;return function(e){var i;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(("babel"===r.parser||"__babel_estree"===r.parser)&&Te(e,r))return r.parser="babel-flow",Pe.parse(e,r);let s=n;"script"===(null!==(i=r.__babelSourceType)&&void 0!==i?i:Se(r))&&(s=s.map((e=>({...e,sourceType:"script"}))));let o=/%[A-Z]/u.test(e);e.includes("|>")?s=(o?[...Me,Ne]:Me).flatMap((e=>s.map((t=>We([e],t))))):o&&(s=s.map((e=>We([Ne],e))));let a,l=t?y.parseExpression:y.parse;try{a=N(s.map((t=>()=>Ve(l,e,t))))}catch({errors:[c]}){throw ce(c)}return t&&(a=Ze(a,{text:e,rootMarker:r.rootMarker})),se(a,{parser:"babel",text:e})}}var He=new Set(["StrictNumericEscape","StrictWith","StrictOctalLiteral","StrictDelete","StrictEvalArguments","StrictEvalArgumentsBinding","StrictFunction","ForInOfLoopInitializer","EmptyTypeArguments","EmptyTypeParameters","ConstructorHasTypeParameters","UnsupportedParameterPropertyKind","DecoratorExportClass","ParamDupe","InvalidDecimal","RestTrailingComma","UnsupportedParameterDecorator","UnterminatedJsxContent","UnexpectedReservedWord","ModuleAttributesWithDuplicateKeys","LineTerminatorBeforeArrow","InvalidEscapeSequenceTemplate","NonAbstractClassHasAbstractMethod","OptionalTypeBeforeRequired","PatternIsOptional","OptionalBindingPattern","DeclareClassFieldHasInitializer","TypeImportCannotSpecifyDefaultAndNamed","ConstructorClassField","VarRedeclaration","InvalidPrivateFieldResolution","DuplicateExport"]),Qe=[We(["jsx"])],Ke=De({optionsCombinations:Qe}),Xe=De({optionsCombinations:[We(["jsx","typescript"]),We(["typescript"])]}),Ye=De({isExpression:!0,optionsCombinations:[We(["jsx"])]}),ze=De({isExpression:!0,optionsCombinations:[We(["typescript"])]}),Pe=De({optionsCombinations:[We(["jsx",["flow",{all:!0,enums:!0}],"flowComments"])]}),Ue=De({optionsCombinations:Qe.map((e=>We(["estree"],e)))}),_e={babel:Ke,"babel-flow":Pe,"babel-ts":Xe,__js_expression:Ye,__ts_expression:ze,__vue_expression:Ye,__vue_ts_expression:ze,__vue_event_binding:Ke,__vue_ts_event_binding:Xe,__babel_estree:Ue},Oe=p(m(),1);function Je(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{allowComments:t=!0}=e;return function(e){let n;try{n=(0,Oe.parseExpression)(e,{tokens:!0,ranges:!0,attachComment:!1})}catch(i){throw ce(i)}if(!t&&L(n.comments))throw je(n.comments[0],"Comment");return qe(n),Ze(n,{type:"JsonRoot",text:e})}}function je(e,t){let[n,i]=[e.loc.start,e.loc.end].map((e=>{let{line:t,column:n}=e;return{line:t,column:n+1}}));return ae("".concat(t," is not allowed in JSON."),{loc:{start:n,end:i}})}function qe(e){switch(e.type){case"ArrayExpression":for(let t of e.elements)null!==t&&qe(t);return;case"ObjectExpression":for(let t of e.properties)qe(t);return;case"ObjectProperty":if(e.computed)throw je(e.key,"Computed key");if(e.shorthand)throw je(e.key,"Shorthand property");return"Identifier"!==e.key.type&&qe(e.key),void qe(e.value);case"UnaryExpression":{let{operator:t,argument:n}=e;if("+"!==t&&"-"!==t)throw je(e,"Operator '".concat(e.operator,"'"));if("NumericLiteral"===n.type||"Identifier"===n.type&&("Infinity"===n.name||"NaN"===n.name))return;throw je(n,"Operator '".concat(t,"' before '").concat(n.type,"'"))}case"Identifier":if("Infinity"!==e.name&&"NaN"!==e.name&&"undefined"!==e.name)throw je(e,"Identifier '".concat(e.name,"'"));return;case"TemplateLiteral":if(L(e.expressions))throw je(e.expressions[0],"'TemplateLiteral' with expression");for(let t of e.quasis)qe(t);return;case"NullLiteral":case"BooleanLiteral":case"NumericLiteral":case"StringLiteral":case"TemplateElement":return;default:throw je(e,"'".concat(e.type,"'"))}}var $e=Je(),et={json:Ee({parse:$e,hasPragma:()=>!0}),json5:Ee($e),jsonc:Ee($e),"json-stringify":Ee({parse:Je({allowComments:!1}),astFormat:"estree-json"})},tt={..._e,...et};return C(f)}();return e.default||e}()},194:(e,t,n)=>{var i,r,s,o=n(166).default,a=n(693).default;e.exports=function(){var e=function(){"use strict";var e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,l=Object.prototype.hasOwnProperty,c=e=>{throw TypeError(e)},g=(t,n)=>{for(var i in n)e(t,i,{get:n[i],enumerable:!0})},u=(i,r,s,o)=>{if(r&&"object"==typeof r||"function"==typeof r)for(let a of n(r))!l.call(i,a)&&a!==s&&e(i,a,{get:()=>r[a],enumerable:!(o=t(r,a))||o.enumerable});return i},A=t=>u(e({},"__esModule",{value:!0}),t),d=(e,t,n)=>t.has(e)||c("Cannot "+n),h=(e,t,n)=>(d(e,t,"read from private field"),n?n.call(e):t.get(e)),I=(e,t,n)=>t.has(e)?c("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),p=(e,t,n,i)=>(d(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n),C={};g(C,{languages:()=>lu,options:()=>ou,printers:()=>au});var m=[{linguistLanguageId:183,name:"JavaScript",type:"programming",tmScope:"source.js",aceMode:"javascript",codemirrorMode:"javascript",codemirrorMimeType:"text/javascript",color:"#f1e05a",aliases:["js","node"],extensions:[".js","._js",".bones",".cjs",".es",".es6",".frag",".gs",".jake",".javascript",".jsb",".jscad",".jsfl",".jslib",".jsm",".jspre",".jss",".mjs",".njs",".pac",".sjs",".ssjs",".xsjs",".xsjslib",".wxs"],filenames:["Jakefile"],interpreters:["chakra","d8","gjs","js","node","nodejs","qjs","rhino","v8","v8-shell","zx"],parsers:["babel","acorn","espree","meriyah","babel-flow","babel-ts","flow","typescript"],vscodeLanguageIds:["javascript","mongo"]},{linguistLanguageId:183,name:"Flow",type:"programming",tmScope:"source.js",aceMode:"javascript",codemirrorMode:"javascript",codemirrorMimeType:"text/javascript",color:"#f1e05a",aliases:[],extensions:[".js.flow"],filenames:[],interpreters:["chakra","d8","gjs","js","node","nodejs","qjs","rhino","v8","v8-shell"],parsers:["flow","babel-flow"],vscodeLanguageIds:["javascript"]},{linguistLanguageId:183,name:"JSX",type:"programming",tmScope:"source.js.jsx",aceMode:"javascript",codemirrorMode:"jsx",codemirrorMimeType:"text/jsx",color:void 0,aliases:void 0,extensions:[".jsx"],filenames:void 0,interpreters:void 0,parsers:["babel","babel-flow","babel-ts","flow","typescript","espree","meriyah"],vscodeLanguageIds:["javascriptreact"],group:"JavaScript"},{linguistLanguageId:378,name:"TypeScript",type:"programming",color:"#3178c6",aliases:["ts"],interpreters:["deno","ts-node"],extensions:[".ts",".cts",".mts"],tmScope:"source.ts",aceMode:"typescript",codemirrorMode:"javascript",codemirrorMimeType:"application/typescript",parsers:["typescript","babel-ts"],vscodeLanguageIds:["typescript"]},{linguistLanguageId:94901924,name:"TSX",type:"programming",color:"#3178c6",group:"TypeScript",extensions:[".tsx"],tmScope:"source.tsx",aceMode:"javascript",codemirrorMode:"jsx",codemirrorMimeType:"text/jsx",parsers:["typescript","babel-ts"],vscodeLanguageIds:["typescriptreact"]}],f={};g(f,{canAttachComment:()=>Cr,embed:()=>ws,experimentalFeatures:()=>Jg,getCommentChildNodes:()=>mr,getVisitorKeys:()=>Ce,handleComments:()=>hi,insertPragma:()=>Ks,isBlockComment:()=>ye,isGap:()=>yr,massageAstNode:()=>$t,print:()=>Og,printComment:()=>Ai,willPrintOwnComments:()=>fr});var y=(e,t,n,i)=>{if(!e||null!=t)return t.replaceAll?t.replaceAll(n,i):n.global?t.replace(n,i):t.split(n).join(i)},b=y,B=(e,t,n)=>{if(!e||null!=t)return Array.isArray(t)||"string"==typeof t?t[n<0?t.length+n:n]:t.at(n)},v=B;function w(e){return null!==e&&"object"==typeof e}var G=w;function*E(e,t){let{getVisitorKeys:n,filter:i=()=>!0}=t,r=e=>G(e)&&i(e);for(let s of n(e)){let t=e[s];if(Array.isArray(t))for(let e of t)r(e)&&(yield e);else r(t)&&(yield t)}}function*x(e,t){let n=[e];for(let i=0;i<n.length;i++){let e=n[i];for(let i of E(e,t))yield i,n.push(i)}}function S(e,t){let{getVisitorKeys:n,predicate:i}=t;for(let r of x(e,{getVisitorKeys:n}))if(i(r))return!0;return!1}var R=()=>/[#*0-9]\uFE0F?\u20E3|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23ED-\u23EF\u23F1\u23F2\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692\u2694-\u2697\u2699\u269B\u269C\u26A0\u26A7\u26AA\u26B0\u26B1\u26BD\u26BE\u26C4\u26C8\u26CF\u26D1\u26E9\u26F0-\u26F5\u26F7\u26F8\u26FA\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B55\u3030\u303D\u3297\u3299]\uFE0F?|[\u261D\u270C\u270D](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\u270A\u270B](?:\uD83C[\uDFFB-\uDFFF])?|[\u23E9-\u23EC\u23F0\u23F3\u25FD\u2693\u26A1\u26AB\u26C5\u26CE\u26D4\u26EA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2795-\u2797\u27B0\u27BF\u2B50]|\u26D3\uFE0F?(?:\u200D\uD83D\uDCA5)?|\u26F9(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\u2764\uFE0F?(?:\u200D(?:\uD83D\uDD25|\uD83E\uDE79))?|\uD83C(?:[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF5\uDFF7]\uFE0F?|[\uDF85\uDFC2\uDFC7](?:\uD83C[\uDFFB-\uDFFF])?|[\uDFC4\uDFCA](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDFCB\uDFCC](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF43\uDF45-\uDF4A\uDF4C-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF8-\uDFFF]|\uDDE6\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF]|\uDDE7\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF]|\uDDE8\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF]|\uDDE9\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF]|\uDDEA\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA]|\uDDEB\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7]|\uDDEC\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE]|\uDDED\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA]|\uDDEE\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9]|\uDDEF\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5]|\uDDF0\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF]|\uDDF1\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE]|\uDDF2\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF]|\uDDF3\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF]|\uDDF4\uD83C\uDDF2|\uDDF5\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE]|\uDDF6\uD83C\uDDE6|\uDDF7\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC]|\uDDF8\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF]|\uDDF9\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF]|\uDDFA\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF]|\uDDFB\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA]|\uDDFC\uD83C[\uDDEB\uDDF8]|\uDDFD\uD83C\uDDF0|\uDDFE\uD83C[\uDDEA\uDDF9]|\uDDFF\uD83C[\uDDE6\uDDF2\uDDFC]|\uDF44(?:\u200D\uD83D\uDFEB)?|\uDF4B(?:\u200D\uD83D\uDFE9)?|\uDFC3(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?|\uDFF3\uFE0F?(?:\u200D(?:\u26A7\uFE0F?|\uD83C\uDF08))?|\uDFF4(?:\u200D\u2620\uFE0F?|\uDB40\uDC67\uDB40\uDC62\uDB40(?:\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDC73\uDB40\uDC63\uDB40\uDC74|\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F)?)|\uD83D(?:[\uDC3F\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3]\uFE0F?|[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC](?:\uD83C[\uDFFB-\uDFFF])?|[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4\uDEB5](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD74\uDD90](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\uDC00-\uDC07\uDC09-\uDC14\uDC16-\uDC25\uDC27-\uDC3A\uDC3C-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE2D\uDE2F-\uDE34\uDE37-\uDE41\uDE43\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED7\uDEDC-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uDC08(?:\u200D\u2B1B)?|\uDC15(?:\u200D\uD83E\uDDBA)?|\uDC26(?:\u200D(?:\u2B1B|\uD83D\uDD25))?|\uDC3B(?:\u200D\u2744\uFE0F?)?|\uDC41\uFE0F?(?:\u200D\uD83D\uDDE8\uFE0F?)?|\uDC68(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDC68\uDC69]\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFE])))?))?|\uDC69(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?[\uDC68\uDC69]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?|\uDC69\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?))|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFE])))?))?|\uDC6F(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDD75(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDE2E(?:\u200D\uD83D\uDCA8)?|\uDE35(?:\u200D\uD83D\uDCAB)?|\uDE36(?:\u200D\uD83C\uDF2B\uFE0F?)?|\uDE42(?:\u200D[\u2194\u2195]\uFE0F?)?|\uDEB6(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?)|\uD83E(?:[\uDD0C\uDD0F\uDD18-\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5\uDEC3-\uDEC5\uDEF0\uDEF2-\uDEF8](?:\uD83C[\uDFFB-\uDFFF])?|[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD\uDDCF\uDDD4\uDDD6-\uDDDD](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDDDE\uDDDF](?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD0D\uDD0E\uDD10-\uDD17\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3F-\uDD45\uDD47-\uDD76\uDD78-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCC\uDDD0\uDDE0-\uDDFF\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC2\uDECE-\uDEDB\uDEE0-\uDEE8]|\uDD3C(?:\u200D[\u2640\u2642]\uFE0F?|\uD83C[\uDFFB-\uDFFF])?|\uDDCE(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?|\uDDD1(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1|\uDDD1\u200D\uD83E\uDDD2(?:\u200D\uD83E\uDDD2)?|\uDDD2(?:\u200D\uD83E\uDDD2)?))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?))?|\uDEF1(?:\uD83C(?:\uDFFB(?:\u200D\uD83E\uDEF2\uD83C[\uDFFC-\uDFFF])?|\uDFFC(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFD-\uDFFF])?|\uDFFD(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])?|\uDFFE(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFD\uDFFF])?|\uDFFF(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFE])?))?)/g;function Z(e){return 12288===e||e>=65281&&e<=65376||e>=65504&&e<=65510}function D(e){return e>=4352&&e<=4447||8986===e||8987===e||9001===e||9002===e||e>=9193&&e<=9196||9200===e||9203===e||9725===e||9726===e||9748===e||9749===e||e>=9800&&e<=9811||9855===e||9875===e||9889===e||9898===e||9899===e||9917===e||9918===e||9924===e||9925===e||9934===e||9940===e||9962===e||9970===e||9971===e||9973===e||9978===e||9981===e||9989===e||9994===e||9995===e||10024===e||10060===e||10062===e||e>=10067&&e<=10069||10071===e||e>=10133&&e<=10135||10160===e||10175===e||11035===e||11036===e||11088===e||11093===e||e>=11904&&e<=11929||e>=11931&&e<=12019||e>=12032&&e<=12245||e>=12272&&e<=12287||e>=12289&&e<=12350||e>=12353&&e<=12438||e>=12441&&e<=12543||e>=12549&&e<=12591||e>=12593&&e<=12686||e>=12688&&e<=12771||e>=12783&&e<=12830||e>=12832&&e<=12871||e>=12880&&e<=19903||e>=19968&&e<=42124||e>=42128&&e<=42182||e>=43360&&e<=43388||e>=44032&&e<=55203||e>=63744&&e<=64255||e>=65040&&e<=65049||e>=65072&&e<=65106||e>=65108&&e<=65126||e>=65128&&e<=65131||e>=94176&&e<=94180||94192===e||94193===e||e>=94208&&e<=100343||e>=100352&&e<=101589||e>=101632&&e<=101640||e>=110576&&e<=110579||e>=110581&&e<=110587||110589===e||110590===e||e>=110592&&e<=110882||110898===e||e>=110928&&e<=110930||110933===e||e>=110948&&e<=110951||e>=110960&&e<=111355||126980===e||127183===e||127374===e||e>=127377&&e<=127386||e>=127488&&e<=127490||e>=127504&&e<=127547||e>=127552&&e<=127560||127568===e||127569===e||e>=127584&&e<=127589||e>=127744&&e<=127776||e>=127789&&e<=127797||e>=127799&&e<=127868||e>=127870&&e<=127891||e>=127904&&e<=127946||e>=127951&&e<=127955||e>=127968&&e<=127984||127988===e||e>=127992&&e<=128062||128064===e||e>=128066&&e<=128252||e>=128255&&e<=128317||e>=128331&&e<=128334||e>=128336&&e<=128359||128378===e||128405===e||128406===e||128420===e||e>=128507&&e<=128591||e>=128640&&e<=128709||128716===e||e>=128720&&e<=128722||e>=128725&&e<=128727||e>=128732&&e<=128735||128747===e||128748===e||e>=128756&&e<=128764||e>=128992&&e<=129003||129008===e||e>=129292&&e<=129338||e>=129340&&e<=129349||e>=129351&&e<=129535||e>=129648&&e<=129660||e>=129664&&e<=129672||e>=129680&&e<=129725||e>=129727&&e<=129733||e>=129742&&e<=129755||e>=129760&&e<=129768||e>=129776&&e<=129784||e>=131072&&e<=196605||e>=196608&&e<=262141}var F=e=>!(Z(e)||D(e)),N=/[^\x20-\x7F]/u;function M(e){if(!e)return 0;if(!N.test(e))return e.length;e=e.replace(R(),"  ");let t=0;for(let n of e){let e=n.codePointAt(0);e<=31||e>=127&&e<=159||e>=768&&e<=879||(t+=F(e)?1:2)}return t}var W=M;function k(e){return(t,n,i)=>{let r=!(null==i||!i.backwards);if(!1===n)return!1;let{length:s}=t,o=n;for(;o>=0&&o<s;){let n=t.charAt(o);if(e instanceof RegExp){if(!e.test(n))return o}else if(!e.includes(n))return o;r?o--:o++}return(-1===o||o===s)&&o}}k(/\s/u);var T=k(" \t"),V=k(",; \t"),L=k(/[^\n\r]/u);function H(e,t,n){let i=!(null==n||!n.backwards);if(!1===t)return!1;let r=e.charAt(t);if(i){if("\r"===e.charAt(t-1)&&"\n"===r)return t-2;if("\n"===r||"\r"===r||"\u2028"===r||"\u2029"===r)return t-1}else{if("\r"===r&&"\n"===e.charAt(t+1))return t+2;if("\n"===r||"\r"===r||"\u2028"===r||"\u2029"===r)return t+1}return t}var Q=H;function K(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=T(e,n.backwards?t-1:t,n);return i!==Q(e,i,n)}var X=K;function Y(e,t){if(!1===t)return!1;if("/"===e.charAt(t)&&"*"===e.charAt(t+1))for(let n=t+2;n<e.length;++n)if("*"===e.charAt(n)&&"/"===e.charAt(n+1))return n+2;return t}var z=Y;function P(e,t){return!1!==t&&("/"===e.charAt(t)&&"/"===e.charAt(t+1)?L(e,t):t)}var U=P;function _(e,t){let n=null,i=t;for(;i!==n;)n=i,i=V(e,i),i=z(e,i),i=T(e,i);return i=U(e,i),i=Q(e,i),!1!==i&&X(e,i)}var O=_;function J(e){return Array.isArray(e)&&e.length>0}var j=J,q="'",$='"';function ee(e,t){let n=!0===t||t===q?q:$,i=n===q?$:q,r=0,s=0;for(let o of e)o===n?r++:o===i&&s++;return r>s?i:n}var te=ee;function ne(e,t,n){let i='"'===t?"'":'"',r=b(!1,e,/\\(.)|(["'])/gsu,((e,r,s)=>r===i?r:s===t?"\\"+s:s||(n&&/^[^\n\r"'0-7\\bfnrt-vx\u2028\u2029]$/u.test(r)?r:"\\"+r)));return t+r+t}var ie=ne;function re(e,t){let n=e.slice(1,-1),i="json"===t.parser||"jsonc"===t.parser||"json5"===t.parser&&"preserve"===t.quoteProps&&!t.singleQuote?'"':t.__isInHtmlAttribute?"'":te(n,t.singleQuote);return ie(n,i,!("css"===t.parser||"less"===t.parser||"scss"===t.parser||t.__embeddedInHtml))}var se=re;function oe(e){var t,n,i,r,s;let o=null!==(t=null==(i=e.range)?void 0:i[0])&&void 0!==t?t:e.start,a=null==(s=null!==(n=null==(r=e.declaration)?void 0:r.decorators)&&void 0!==n?n:e.decorators)?void 0:s[0];return a?Math.min(oe(a),o):o}function ae(e){var t,n;return null!==(t=null==(n=e.range)?void 0:n[1])&&void 0!==t?t:e.end}function le(e,t){let n=oe(e);return Number.isInteger(n)&&n===oe(t)}function ce(e,t){let n=ae(e);return Number.isInteger(n)&&n===ae(t)}function ge(e,t){return le(e,t)&&ce(e,t)}var ue=null;function Ae(e){if(null!==ue&&(ue.property,1)){let e=ue;return ue=Ae.prototype=null,e}return ue=Ae.prototype=null!==e&&void 0!==e?e:Object.create(null),new Ae}var de=10;for(let i=0;i<=de;i++)Ae();function he(e){return Ae(e)}function Ie(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"type";function n(n){let i=n[t],r=e[i];if(!Array.isArray(r))throw Object.assign(new Error("Missing visitor keys for '".concat(i,"'.")),{node:n});return r}return he(e),n}var pe=Ie,Ce=pe({ArrayExpression:["elements"],AssignmentExpression:["left","right"],BinaryExpression:["left","right"],InterpreterDirective:[],Directive:["value"],DirectiveLiteral:[],BlockStatement:["directives","body"],BreakStatement:["label"],CallExpression:["callee","arguments","typeParameters","typeArguments"],CatchClause:["param","body"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DoWhileStatement:["test","body"],EmptyStatement:[],ExpressionStatement:["expression"],File:["program"],ForInStatement:["left","right","body"],ForStatement:["init","test","update","body"],FunctionDeclaration:["id","params","body","returnType","typeParameters","predicate"],FunctionExpression:["id","params","body","returnType","typeParameters"],Identifier:["typeAnnotation","decorators"],IfStatement:["test","consequent","alternate"],LabeledStatement:["label","body"],StringLiteral:[],NumericLiteral:[],NullLiteral:[],BooleanLiteral:[],RegExpLiteral:[],LogicalExpression:["left","right"],MemberExpression:["object","property"],NewExpression:["callee","arguments","typeParameters","typeArguments"],Program:["directives","body"],ObjectExpression:["properties"],ObjectMethod:["key","params","body","decorators","returnType","typeParameters"],ObjectProperty:["key","value","decorators"],RestElement:["argument","typeAnnotation","decorators"],ReturnStatement:["argument"],SequenceExpression:["expressions"],ParenthesizedExpression:["expression"],SwitchCase:["test","consequent"],SwitchStatement:["discriminant","cases"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handler","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],AssignmentPattern:["left","right","decorators","typeAnnotation"],ArrayPattern:["elements","typeAnnotation","decorators"],ArrowFunctionExpression:["params","body","returnType","typeParameters","predicate"],ClassBody:["body"],ClassExpression:["id","body","superClass","mixins","typeParameters","superTypeParameters","implements","decorators","superTypeArguments"],ClassDeclaration:["id","body","superClass","mixins","typeParameters","superTypeParameters","implements","decorators","superTypeArguments"],ExportAllDeclaration:["source","attributes","exported"],ExportDefaultDeclaration:["declaration"],ExportNamedDeclaration:["declaration","specifiers","source","attributes"],ExportSpecifier:["local","exported"],ForOfStatement:["left","right","body"],ImportDeclaration:["specifiers","source","attributes"],ImportDefaultSpecifier:["local"],ImportNamespaceSpecifier:["local"],ImportSpecifier:["local","imported"],ImportExpression:["source","options","attributes"],MetaProperty:["meta","property"],ClassMethod:["key","params","body","decorators","returnType","typeParameters"],ObjectPattern:["properties","typeAnnotation","decorators"],SpreadElement:["argument"],Super:[],TaggedTemplateExpression:["tag","quasi","typeParameters","typeArguments"],TemplateElement:[],TemplateLiteral:["quasis","expressions"],YieldExpression:["argument"],AwaitExpression:["argument"],Import:[],BigIntLiteral:[],ExportNamespaceSpecifier:["exported"],OptionalMemberExpression:["object","property"],OptionalCallExpression:["callee","arguments","typeParameters","typeArguments"],ClassProperty:["key","value","typeAnnotation","decorators","variance"],ClassAccessorProperty:["key","value","typeAnnotation","decorators"],ClassPrivateProperty:["key","value","decorators","typeAnnotation","variance"],ClassPrivateMethod:["key","params","body","decorators","returnType","typeParameters"],PrivateName:["id"],StaticBlock:["body"],AnyTypeAnnotation:[],ArrayTypeAnnotation:["elementType"],BooleanTypeAnnotation:[],BooleanLiteralTypeAnnotation:[],NullLiteralTypeAnnotation:[],ClassImplements:["id","typeParameters"],DeclareClass:["id","typeParameters","extends","mixins","implements","body"],DeclareFunction:["id","predicate"],DeclareInterface:["id","typeParameters","extends","body"],DeclareModule:["id","body"],DeclareModuleExports:["typeAnnotation"],DeclareTypeAlias:["id","typeParameters","right"],DeclareOpaqueType:["id","typeParameters","supertype"],DeclareVariable:["id"],DeclareExportDeclaration:["declaration","specifiers","source"],DeclareExportAllDeclaration:["source"],DeclaredPredicate:["value"],ExistsTypeAnnotation:[],FunctionTypeAnnotation:["typeParameters","params","rest","returnType","this"],FunctionTypeParam:["name","typeAnnotation"],GenericTypeAnnotation:["id","typeParameters"],InferredPredicate:[],InterfaceExtends:["id","typeParameters"],InterfaceDeclaration:["id","typeParameters","extends","body"],InterfaceTypeAnnotation:["extends","body"],IntersectionTypeAnnotation:["types"],MixedTypeAnnotation:[],EmptyTypeAnnotation:[],NullableTypeAnnotation:["typeAnnotation"],NumberLiteralTypeAnnotation:[],NumberTypeAnnotation:[],ObjectTypeAnnotation:["properties","indexers","callProperties","internalSlots"],ObjectTypeInternalSlot:["id","value"],ObjectTypeCallProperty:["value"],ObjectTypeIndexer:["id","key","value","variance"],ObjectTypeProperty:["key","value","variance"],ObjectTypeSpreadProperty:["argument"],OpaqueType:["id","typeParameters","supertype","impltype"],QualifiedTypeIdentifier:["id","qualification"],StringLiteralTypeAnnotation:[],StringTypeAnnotation:[],SymbolTypeAnnotation:[],ThisTypeAnnotation:[],TupleTypeAnnotation:["types","elementTypes"],TypeofTypeAnnotation:["argument","typeArguments"],TypeAlias:["id","typeParameters","right"],TypeAnnotation:["typeAnnotation"],TypeCastExpression:["expression","typeAnnotation"],TypeParameter:["bound","default","variance"],TypeParameterDeclaration:["params"],TypeParameterInstantiation:["params"],UnionTypeAnnotation:["types"],Variance:[],VoidTypeAnnotation:[],EnumDeclaration:["id","body"],EnumBooleanBody:["members"],EnumNumberBody:["members"],EnumStringBody:["members"],EnumSymbolBody:["members"],EnumBooleanMember:["id","init"],EnumNumberMember:["id","init"],EnumStringMember:["id","init"],EnumDefaultedMember:["id"],IndexedAccessType:["objectType","indexType"],OptionalIndexedAccessType:["objectType","indexType"],JSXAttribute:["name","value"],JSXClosingElement:["name"],JSXElement:["openingElement","children","closingElement"],JSXEmptyExpression:[],JSXExpressionContainer:["expression"],JSXSpreadChild:["expression"],JSXIdentifier:[],JSXMemberExpression:["object","property"],JSXNamespacedName:["namespace","name"],JSXOpeningElement:["name","attributes","typeArguments","typeParameters"],JSXSpreadAttribute:["argument"],JSXText:[],JSXFragment:["openingFragment","children","closingFragment"],JSXOpeningFragment:[],JSXClosingFragment:[],Noop:[],Placeholder:[],V8IntrinsicIdentifier:[],ArgumentPlaceholder:[],BindExpression:["object","callee"],ImportAttribute:["key","value"],Decorator:["expression"],DoExpression:["body"],ExportDefaultSpecifier:["exported"],RecordExpression:["properties"],TupleExpression:["elements"],DecimalLiteral:[],ModuleExpression:["body"],TopicReference:[],PipelineTopicExpression:["expression"],PipelineBareFunction:["callee"],PipelinePrimaryTopicReference:[],TSParameterProperty:["parameter","decorators"],TSDeclareFunction:["id","typeParameters","params","returnType","body"],TSDeclareMethod:["decorators","key","typeParameters","params","returnType"],TSQualifiedName:["left","right"],TSCallSignatureDeclaration:["typeParameters","parameters","typeAnnotation","params","returnType"],TSConstructSignatureDeclaration:["typeParameters","parameters","typeAnnotation","params","returnType"],TSPropertySignature:["key","typeAnnotation"],TSMethodSignature:["key","typeParameters","parameters","typeAnnotation","params","returnType"],TSIndexSignature:["parameters","typeAnnotation"],TSAnyKeyword:[],TSBooleanKeyword:[],TSBigIntKeyword:[],TSIntrinsicKeyword:[],TSNeverKeyword:[],TSNullKeyword:[],TSNumberKeyword:[],TSObjectKeyword:[],TSStringKeyword:[],TSSymbolKeyword:[],TSUndefinedKeyword:[],TSUnknownKeyword:[],TSVoidKeyword:[],TSThisType:[],TSFunctionType:["typeParameters","parameters","typeAnnotation","params","returnType"],TSConstructorType:["typeParameters","parameters","typeAnnotation","params","returnType"],TSTypeReference:["typeName","typeParameters","typeArguments"],TSTypePredicate:["parameterName","typeAnnotation"],TSTypeQuery:["exprName","typeParameters","typeArguments"],TSTypeLiteral:["members"],TSArrayType:["elementType"],TSTupleType:["elementTypes"],TSOptionalType:["typeAnnotation"],TSRestType:["typeAnnotation"],TSNamedTupleMember:["label","elementType"],TSUnionType:["types"],TSIntersectionType:["types"],TSConditionalType:["checkType","extendsType","trueType","falseType"],TSInferType:["typeParameter"],TSParenthesizedType:["typeAnnotation"],TSTypeOperator:["typeAnnotation"],TSIndexedAccessType:["objectType","indexType"],TSMappedType:["typeParameter","typeAnnotation","nameType"],TSLiteralType:["literal"],TSExpressionWithTypeArguments:["expression","typeParameters"],TSInterfaceDeclaration:["id","typeParameters","extends","body"],TSInterfaceBody:["body"],TSTypeAliasDeclaration:["id","typeParameters","typeAnnotation"],TSInstantiationExpression:["expression","typeParameters","typeArguments"],TSAsExpression:["expression","typeAnnotation"],TSSatisfiesExpression:["expression","typeAnnotation"],TSTypeAssertion:["typeAnnotation","expression"],TSEnumDeclaration:["id","members"],TSEnumMember:["id","initializer"],TSModuleDeclaration:["id","body"],TSModuleBlock:["body"],TSImportType:["argument","qualifier","typeParameters","typeArguments"],TSImportEqualsDeclaration:["id","moduleReference"],TSExternalModuleReference:["expression"],TSNonNullExpression:["expression"],TSExportAssignment:["expression"],TSNamespaceExportDeclaration:["id"],TSTypeAnnotation:["typeAnnotation"],TSTypeParameterInstantiation:["params"],TSTypeParameterDeclaration:["params"],TSTypeParameter:["constraint","default","name"],ChainExpression:["expression"],ExperimentalRestProperty:["argument"],ExperimentalSpreadProperty:["argument"],Literal:[],MethodDefinition:["decorators","key","value"],PrivateIdentifier:[],Property:["key","value"],PropertyDefinition:["decorators","key","typeAnnotation","value","variance"],AccessorProperty:["decorators","key","typeAnnotation","value"],TSAbstractAccessorProperty:["decorators","key","typeAnnotation"],TSAbstractKeyword:[],TSAbstractMethodDefinition:["key","value"],TSAbstractPropertyDefinition:["decorators","key","typeAnnotation"],TSAsyncKeyword:[],TSClassImplements:["expression","typeArguments","typeParameters"],TSDeclareKeyword:[],TSEmptyBodyFunctionExpression:["id","typeParameters","params","returnType"],TSEnumBody:["members"],TSExportKeyword:[],TSInterfaceHeritage:["expression","typeArguments","typeParameters"],TSPrivateKeyword:[],TSProtectedKeyword:[],TSPublicKeyword:[],TSReadonlyKeyword:[],TSStaticKeyword:[],TSTemplateLiteralType:["quasis","types"],AsConstExpression:["expression"],AsExpression:["expression","typeAnnotation"],BigIntLiteralTypeAnnotation:[],BigIntTypeAnnotation:[],ComponentDeclaration:["id","params","body","typeParameters","rendersType"],ComponentParameter:["name","local"],ComponentTypeAnnotation:["params","rest","typeParameters","rendersType"],ComponentTypeParameter:["name","typeAnnotation"],ConditionalTypeAnnotation:["checkType","extendsType","trueType","falseType"],DeclareComponent:["id","params","rest","typeParameters","rendersType"],DeclareEnum:["id","body"],DeclareHook:["id"],DeclareNamespace:["id","body"],EnumBigIntBody:["members"],EnumBigIntMember:["id","init"],HookDeclaration:["id","params","body","typeParameters","returnType"],HookTypeAnnotation:["params","returnType","rest","typeParameters"],InferTypeAnnotation:["typeParameter"],KeyofTypeAnnotation:["argument"],ObjectTypeMappedTypeProperty:["keyTparam","propType","sourceType","variance"],QualifiedTypeofIdentifier:["qualification","id"],TupleTypeLabeledElement:["label","elementType","variance"],TupleTypeSpreadElement:["label","typeAnnotation"],TypeOperator:["typeAnnotation"],TypePredicate:["parameterName","typeAnnotation","asserts"],NGRoot:["node"],NGPipeExpression:["left","right","arguments"],NGChainedExpression:["expressions"],NGEmptyExpression:[],NGMicrosyntax:["body"],NGMicrosyntaxKey:[],NGMicrosyntaxExpression:["expression","alias"],NGMicrosyntaxKeyedExpression:["key","expression"],NGMicrosyntaxLet:["key","value"],NGMicrosyntaxAs:["key","alias"],JsExpressionRoot:["node"],JsonRoot:["node"],TSJSDocAllType:[],TSJSDocUnknownType:[],TSJSDocNullableType:["typeAnnotation"],TSJSDocNonNullableType:["typeAnnotation"],NeverTypeAnnotation:[],UndefinedTypeAnnotation:[],UnknownTypeAnnotation:[],SatisfiesExpression:["expression","typeAnnotation"]});function me(e){let t=new Set(e);return e=>t.has(null==e?void 0:e.type)}var fe=me,ye=fe(["Block","CommentBlock","MultiLine"]),be=fe(["AnyTypeAnnotation","ThisTypeAnnotation","NumberTypeAnnotation","VoidTypeAnnotation","BooleanTypeAnnotation","BigIntTypeAnnotation","SymbolTypeAnnotation","StringTypeAnnotation","NeverTypeAnnotation","UndefinedTypeAnnotation","UnknownTypeAnnotation","EmptyTypeAnnotation","MixedTypeAnnotation"]);function Be(e,t){let n=t.split(".");for(let i=n.length-1;i>=0;i--){let t=n[i];if(0===i)return"Identifier"===e.type&&e.name===t;if("MemberExpression"!==e.type||e.optional||e.computed||"Identifier"!==e.property.type||e.property.name!==t)return!1;e=e.object}}function ve(e,t){return t.some((t=>Be(e,t)))}var we=ve;function Ge(e){let{type:t}=e;return t.startsWith("TS")&&t.endsWith("Keyword")}var Ee=Ge;function xe(e,t){return t(e)||S(e,{getVisitorKeys:Ce,predicate:t})}function Se(e){return"AssignmentExpression"===e.type||"BinaryExpression"===e.type||"LogicalExpression"===e.type||"NGPipeExpression"===e.type||"ConditionalExpression"===e.type||st(e)||ot(e)||"SequenceExpression"===e.type||"TaggedTemplateExpression"===e.type||"BindExpression"===e.type||"UpdateExpression"===e.type&&!e.prefix||Ut(e)||"TSNonNullExpression"===e.type||"ChainExpression"===e.type}function Re(e){var t,n,i,r,s,o;return e.expressions?e.expressions[0]:null!==(t=null!==(n=null!==(i=null!==(r=null!==(s=null!==(o=e.left)&&void 0!==o?o:e.test)&&void 0!==s?s:e.callee)&&void 0!==r?r:e.object)&&void 0!==i?i:e.tag)&&void 0!==n?n:e.argument)&&void 0!==t?t:e.expression}function Ze(e){if(e.expressions)return["expressions",0];if(e.left)return["left"];if(e.test)return["test"];if(e.object)return["object"];if(e.callee)return["callee"];if(e.tag)return["tag"];if(e.argument)return["argument"];if(e.expression)return["expression"];throw new Error("Unexpected node has no left side.")}var De=fe(["Line","CommentLine","SingleLine","HashbangComment","HTMLOpen","HTMLClose","Hashbang","InterpreterDirective"]),Fe=fe(["ExportDefaultDeclaration","DeclareExportDeclaration","ExportNamedDeclaration","ExportAllDeclaration","DeclareExportAllDeclaration"]),Ne=fe(["ArrayExpression","TupleExpression"]),Me=fe(["ObjectExpression","RecordExpression"]);function We(e){return"LogicalExpression"===e.type&&"??"===e.operator}function ke(e){return"NumericLiteral"===e.type||"Literal"===e.type&&"number"==typeof e.value}function Te(e){return"UnaryExpression"===e.type&&("+"===e.operator||"-"===e.operator)&&ke(e.argument)}function Ve(e){return!(!e||"StringLiteral"!==e.type&&("Literal"!==e.type||"string"!=typeof e.value))}function Le(e){return"RegExpLiteral"===e.type||"Literal"===e.type&&!!e.regex}var He=fe(["Literal","BooleanLiteral","BigIntLiteral","DecimalLiteral","DirectiveLiteral","NullLiteral","NumericLiteral","RegExpLiteral","StringLiteral"]),Qe=fe(["Identifier","ThisExpression","Super","PrivateName","PrivateIdentifier","Import"]),Ke=fe(["ObjectTypeAnnotation","TSTypeLiteral","TSMappedType"]),Xe=fe(["FunctionExpression","ArrowFunctionExpression"]);function Ye(e){return"FunctionExpression"===e.type||"ArrowFunctionExpression"===e.type&&"BlockStatement"===e.body.type}function ze(e){return st(e)&&"Identifier"===e.callee.type&&["async","inject","fakeAsync","waitForAsync"].includes(e.callee.name)}var Pe=fe(["JSXElement","JSXFragment"]);function Ue(e){return e.method&&"init"===e.kind||"get"===e.kind||"set"===e.kind}function _e(e){return("ObjectTypeProperty"===e.type||"ObjectTypeInternalSlot"===e.type)&&!e.static&&!e.method&&"get"!==e.kind&&"set"!==e.kind&&"FunctionTypeAnnotation"===e.value.type}function Oe(e){return("TypeAnnotation"===e.type||"TSTypeAnnotation"===e.type)&&"FunctionTypeAnnotation"===e.typeAnnotation.type&&!e.static&&!le(e,e.typeAnnotation)}var Je=fe(["BinaryExpression","LogicalExpression","NGPipeExpression"]);function je(e){return ot(e)||"BindExpression"===e.type&&!!e.object}var qe=fe(["TSThisType","NullLiteralTypeAnnotation","BooleanLiteralTypeAnnotation","StringLiteralTypeAnnotation","BigIntLiteralTypeAnnotation","NumberLiteralTypeAnnotation","TSLiteralType","TSTemplateLiteralType"]);function $e(e){return Ee(e)||be(e)||qe(e)||("GenericTypeAnnotation"===e.type||"TSTypeReference"===e.type)&&!e.typeParameters&&!e.typeArguments}function et(e){return"Identifier"===e.type&&("beforeEach"===e.name||"beforeAll"===e.name||"afterEach"===e.name||"afterAll"===e.name)}var tt=["it","it.only","it.skip","describe","describe.only","describe.skip","test","test.only","test.skip","test.step","test.describe","test.describe.only","test.describe.parallel","test.describe.parallel.only","test.describe.serial","test.describe.serial.only","skip","xit","xdescribe","xtest","fit","fdescribe","ftest"];function nt(e){return we(e,tt)}function it(e,t){if("CallExpression"!==(null==e?void 0:e.type)||e.optional)return!1;let n=Wt(e);if(1===n.length){if(ze(e)&&it(t))return Xe(n[0]);if(et(e.callee))return ze(n[0])}else if((2===n.length||3===n.length)&&("TemplateLiteral"===n[0].type||Ve(n[0]))&&nt(e.callee))return!(n[2]&&!ke(n[2]))&&((2===n.length?Xe(n[1]):Ye(n[1])&&Ft(n[1]).length<=1)||ze(n[1]));return!1}var rt=e=>t=>("ChainExpression"===(null==t?void 0:t.type)&&(t=t.expression),e(t)),st=rt(fe(["CallExpression","OptionalCallExpression"])),ot=rt(fe(["MemberExpression","OptionalMemberExpression"]));function at(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return lt(e,t)<=t}function lt(e,t){let n=0;for(let i in e){let r=e[i];if(r&&"object"==typeof r&&"string"==typeof r.type&&(n++,n+=lt(r,t-n)),n>t)return n}return n}var ct=.25;function gt(e,t){let{printWidth:n}=t;if(Kt(e))return!1;let i=n*ct;if("ThisExpression"===e.type||"Identifier"===e.type&&e.name.length<=i||Te(e)&&!Kt(e.argument))return!0;let r="Literal"===e.type&&"regex"in e&&e.regex.pattern||"RegExpLiteral"===e.type&&e.pattern;return r?r.length<=i:Ve(e)?se(ft(e),t).length<=i:"TemplateLiteral"===e.type?0===e.expressions.length&&e.quasis[0].value.raw.length<=i&&!e.quasis[0].value.raw.includes("\n"):"UnaryExpression"===e.type?gt(e.argument,{printWidth:n}):"CallExpression"===e.type&&0===e.arguments.length&&"Identifier"===e.callee.type?e.callee.name.length<=i-2:He(e)}function ut(e,t){return Pe(t)?Lt(t):Kt(t,Ht.Leading,(t=>X(e,ae(t))))}function At(e){return e.quasis.some((e=>e.value.raw.includes("\n")))}function dt(e,t){return("TemplateLiteral"===e.type&&At(e)||"TaggedTemplateExpression"===e.type&&At(e.quasi))&&!X(t,oe(e),{backwards:!0})}function ht(e){if(!Kt(e))return!1;let t=v(!1,Xt(e,Ht.Dangling),-1);return t&&!ye(t)}function It(e){if(e.length<=1)return!1;let t=0;for(let n of e)if(Xe(n)){if(t+=1,t>1)return!0}else if(st(n))for(let e of Wt(n))if(Xe(e))return!0;return!1}function pt(e){let{node:t,parent:n,key:i}=e;return"callee"===i&&st(t)&&st(n)&&n.arguments.length>0&&t.arguments.length>n.arguments.length}var Ct=new Set(["!","-","+","~"]);function mt(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(n<=0)return!1;if("ChainExpression"===e.type||"TSNonNullExpression"===e.type)return mt(e.expression,n);let i=e=>mt(e,n-1);if(Le(e))return W(null!==(t=e.pattern)&&void 0!==t?t:e.regex.pattern)<=5;if(He(e)||Qe(e)||"ArgumentPlaceholder"===e.type)return!0;if("TemplateLiteral"===e.type)return e.quasis.every((e=>!e.value.raw.includes("\n")))&&e.expressions.every(i);if(Me(e))return e.properties.every((e=>!e.computed&&(e.shorthand||e.value&&i(e.value))));if(Ne(e))return e.elements.every((e=>null===e||i(e)));if(zt(e)){if("ImportExpression"===e.type||mt(e.callee,n)){let t=Wt(e);return t.length<=n&&t.every(i)}return!1}return ot(e)?mt(e.object,n)&&mt(e.property,n):!!("UnaryExpression"===e.type&&Ct.has(e.operator)||"UpdateExpression"===e.type)&&mt(e.argument,n)}function ft(e){var t,n;return null!==(t=null==(n=e.extra)?void 0:n.raw)&&void 0!==t?t:e.raw}function yt(e){return e}function bt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"es5";return"es5"===e.trailingComma&&"es5"===t||"all"===e.trailingComma&&("all"===t||"es5"===t)}function Bt(e,t){switch(e.type){case"BinaryExpression":case"LogicalExpression":case"AssignmentExpression":case"NGPipeExpression":return Bt(e.left,t);case"MemberExpression":case"OptionalMemberExpression":return Bt(e.object,t);case"TaggedTemplateExpression":return"FunctionExpression"!==e.tag.type&&Bt(e.tag,t);case"CallExpression":case"OptionalCallExpression":return"FunctionExpression"!==e.callee.type&&Bt(e.callee,t);case"ConditionalExpression":return Bt(e.test,t);case"UpdateExpression":return!e.prefix&&Bt(e.argument,t);case"BindExpression":return e.object&&Bt(e.object,t);case"SequenceExpression":return Bt(e.expressions[0],t);case"ChainExpression":case"TSSatisfiesExpression":case"TSAsExpression":case"TSNonNullExpression":case"AsExpression":case"AsConstExpression":case"SatisfiesExpression":return Bt(e.expression,t);default:return t(e)}}var vt={"==":!0,"!=":!0,"===":!0,"!==":!0},wt={"*":!0,"/":!0,"%":!0},Gt={">>":!0,">>>":!0,"<<":!0};function Et(e,t){return!(St(t)!==St(e)||"**"===e||vt[e]&&vt[t]||"%"===t&&wt[e]||"%"===e&&wt[t]||t!==e&&wt[t]&&wt[e]||Gt[e]&&Gt[t])}var xt=new Map([["|>"],["??"],["||"],["&&"],["|"],["^"],["&"],["==","===","!=","!=="],["<",">","<=",">=","in","instanceof"],[">>","<<",">>>"],["+","-"],["*","/","%"],["**"]].flatMap(((e,t)=>e.map((e=>[e,t])))));function St(e){return xt.get(e)}function Rt(e){return!!Gt[e]||"|"===e||"^"===e||"&"===e}function Zt(e){var t;if(e.rest)return!0;let n=Ft(e);return"RestElement"===(null==(t=v(!1,n,-1))?void 0:t.type)}var Dt=new WeakMap;function Ft(e){if(Dt.has(e))return Dt.get(e);let t=[];return e.this&&t.push(e.this),Array.isArray(e.parameters)?t.push(...e.parameters):Array.isArray(e.params)&&t.push(...e.params),e.rest&&t.push(e.rest),Dt.set(e,t),t}function Nt(e,t){let{node:n}=e,i=0,r=e=>t(e,i++);n.this&&e.call(r,"this"),Array.isArray(n.parameters)?e.each(r,"parameters"):Array.isArray(n.params)&&e.each(r,"params"),n.rest&&e.call(r,"rest")}var Mt=new WeakMap;function Wt(e){if(Mt.has(e))return Mt.get(e);if("ChainExpression"===e.type)return Wt(e.expression);let t=e.arguments;return"ImportExpression"===e.type&&(t=[e.source],e.attributes&&t.push(e.attributes),e.options&&t.push(e.options)),Mt.set(e,t),t}function kt(e,t){let{node:n}=e;if("ChainExpression"===n.type)return e.call((()=>kt(e,t)),"expression");"ImportExpression"===n.type?(e.call((e=>t(e,0)),"source"),n.attributes&&e.call((e=>t(e,1)),"attributes"),n.options&&e.call((e=>t(e,1)),"options")):e.each(t,"arguments")}function Tt(e,t){let n=[];if("ChainExpression"===e.type&&(e=e.expression,n.push("expression")),"ImportExpression"===e.type){if(0===t||t===(e.attributes||e.options?-2:-1))return[...n,"source"];if(e.attributes&&(1===t||-1===t))return[...n,"attributes"];if(e.options&&(1===t||-1===t))return[...n,"options"];throw new RangeError("Invalid argument index")}if(t<0&&(t=e.arguments.length+t),t<0||t>=e.arguments.length)throw new RangeError("Invalid argument index");return[...n,"arguments",t]}function Vt(e){return"prettier-ignore"===e.value.trim()&&!e.unignore}function Lt(e){return(null==e?void 0:e.prettierIgnore)||Kt(e,Ht.PrettierIgnore)}var Ht={Leading:2,Trailing:4,Dangling:8,Block:16,Line:32,PrettierIgnore:64,First:128,Last:256},Qt=(e,t)=>{if("function"==typeof e&&(t=e,e=0),e||t)return(n,i,r)=>!(e&Ht.Leading&&!n.leading||e&Ht.Trailing&&!n.trailing||e&Ht.Dangling&&(n.leading||n.trailing)||e&Ht.Block&&!ye(n)||e&Ht.Line&&!De(n)||e&Ht.First&&0!==i||e&Ht.Last&&i!==r.length-1||e&Ht.PrettierIgnore&&!Vt(n)||t&&!t(n))};function Kt(e,t,n){if(!j(null==e?void 0:e.comments))return!1;let i=Qt(t,n);return!i||e.comments.some(i)}function Xt(e,t,n){if(!Array.isArray(null==e?void 0:e.comments))return[];let i=Qt(t,n);return i?e.comments.filter(i):e.comments}var Yt=(e,t)=>{let{originalText:n}=t;return O(n,ae(e))};function zt(e){return st(e)||"NewExpression"===e.type||"ImportExpression"===e.type}function Pt(e){return e&&("ObjectProperty"===e.type||"Property"===e.type&&!Ue(e))}var Ut=fe(["TSAsExpression","TSSatisfiesExpression","AsExpression","AsConstExpression","SatisfiesExpression"]),_t=fe(["UnionTypeAnnotation","TSUnionType"]),Ot=fe(["IntersectionTypeAnnotation","TSIntersectionType"]),Jt=new Set(["range","raw","comments","leadingComments","trailingComments","innerComments","extra","start","end","loc","flags","errors","tokens"]),jt=e=>{for(let t of e.quasis)delete t.value};function qt(e,t,n){var i,r;if("Program"===e.type&&delete t.sourceType,("BigIntLiteral"===e.type||"BigIntLiteralTypeAnnotation"===e.type)&&e.value&&(t.value=e.value.toLowerCase()),("BigIntLiteral"===e.type||"Literal"===e.type)&&e.bigint&&(t.bigint=e.bigint.toLowerCase()),"DecimalLiteral"===e.type&&(t.value=Number(e.value)),"Literal"===e.type&&t.decimal&&(t.decimal=Number(e.decimal)),"EmptyStatement"===e.type||"JSXText"===e.type||"JSXExpressionContainer"===e.type&&("Literal"===e.expression.type||"StringLiteral"===e.expression.type)&&" "===e.expression.value)return null;if(("Property"===e.type||"ObjectProperty"===e.type||"MethodDefinition"===e.type||"ClassProperty"===e.type||"ClassMethod"===e.type||"PropertyDefinition"===e.type||"TSDeclareMethod"===e.type||"TSPropertySignature"===e.type||"ObjectTypeProperty"===e.type||"ImportAttribute"===e.type)&&e.key&&!e.computed){let{key:n}=e;Ve(n)||ke(n)?t.key=String(n.value):"Identifier"===n.type&&(t.key=n.name)}if("JSXElement"===e.type&&"style"===e.openingElement.name.name&&e.openingElement.attributes.some((e=>"JSXAttribute"===e.type&&"jsx"===e.name.name)))for(let{type:o,expression:a}of t.children)"JSXExpressionContainer"===o&&"TemplateLiteral"===a.type&&jt(a);"JSXAttribute"===e.type&&"css"===e.name.name&&"JSXExpressionContainer"===e.value.type&&"TemplateLiteral"===e.value.expression.type&&jt(t.value.expression),"JSXAttribute"===e.type&&"Literal"===(null==(i=e.value)?void 0:i.type)&&/["']|&quot;|&apos;/u.test(e.value.value)&&(t.value.value=b(!1,e.value.value,/["']|&quot;|&apos;/gu,'"'));let s=e.expression||e.callee;if("Decorator"===e.type&&"CallExpression"===s.type&&"Component"===s.callee.name&&1===s.arguments.length){let n=e.expression.arguments[0].properties;for(let[e,i]of t.expression.arguments[0].properties.entries())switch(n[e].key.name){case"styles":Ne(i.value)&&jt(i.value.elements[0]);break;case"template":"TemplateLiteral"===i.value.type&&jt(i.value)}}"TaggedTemplateExpression"===e.type&&("MemberExpression"===e.tag.type||"Identifier"===e.tag.type&&("gql"===e.tag.name||"graphql"===e.tag.name||"css"===e.tag.name||"md"===e.tag.name||"markdown"===e.tag.name||"html"===e.tag.name)||"CallExpression"===e.tag.type)&&jt(t.quasi),"TemplateLiteral"===e.type&&(null!=(r=e.leadingComments)&&r.some((e=>ye(e)&&["GraphQL","HTML"].some((t=>e.value===" ".concat(t," ")))))||"CallExpression"===n.type&&"graphql"===n.callee.name||!e.leadingComments)&&jt(t),"ChainExpression"===e.type&&"TSNonNullExpression"===e.expression.type&&(t.type="TSNonNullExpression",t.expression.type="ChainExpression"),"TSMappedType"===e.type&&(delete t.key,delete t.constraint),"TSEnumDeclaration"===e.type&&delete t.body}qt.ignoredProperties=Jt;var $t=qt,en="string",tn="array",nn="cursor",rn="indent",sn="align",on="trim",an="group",ln="fill",cn="if-break",gn="indent-if-break",un="line-suffix",An="line-suffix-boundary",dn="line",hn="label",In="break-parent",pn=new Set([nn,rn,sn,on,an,ln,cn,gn,un,An,dn,hn,In]);function Cn(e){if("string"==typeof e)return en;if(Array.isArray(e))return tn;if(!e)return;let{type:t}=e;return pn.has(t)?t:void 0}var mn=Cn,fn=e=>new Intl.ListFormat("en-US",{type:"disjunction"}).format(e);function yn(e){let t=null===e?"null":typeof e;if("string"!==t&&"object"!==t)return"Unexpected doc '".concat(t,"', \nExpected it to be 'string' or 'object'.");if(mn(e))throw new Error("doc is valid.");let n=Object.prototype.toString.call(e);if("[object Object]"!==n)return"Unexpected doc '".concat(n,"'.");let i=fn([...pn].map((e=>"'".concat(e,"'"))));return"Unexpected doc.type '".concat(e.type,"'.\nExpected it to be ").concat(i,".")}var bn=class extends Error{constructor(e){super(yn(e)),a(this,"name","InvalidDocError"),this.doc=e}},Bn=bn,vn={};function wn(e,t,n,i){let r=[e];for(;r.length>0;){let e=r.pop();if(e===vn){n(r.pop());continue}n&&r.push(e,vn);let s=mn(e);if(!s)throw new Bn(e);if(!1!==(null==t?void 0:t(e)))switch(s){case tn:case ln:{let t=s===tn?e:e.parts;for(let e=t.length-1;e>=0;--e)r.push(t[e]);break}case cn:r.push(e.flatContents,e.breakContents);break;case an:if(i&&e.expandedStates)for(let t=e.expandedStates.length-1;t>=0;--t)r.push(e.expandedStates[t]);else r.push(e.contents);break;case sn:case rn:case gn:case hn:case un:r.push(e.contents);break;case en:case nn:case on:case An:case dn:case In:break;default:throw new Bn(e)}}}var Gn=wn,En=()=>{},xn=En,Sn=En;function Rn(e){return xn(e),{type:rn,contents:e}}function Zn(e,t){return xn(t),{type:sn,contents:t,n:e}}function Dn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return xn(e),Sn(t.expandedStates,!0),{type:an,id:t.id,contents:e,break:!!t.shouldBreak,expandedStates:t.expandedStates}}function Fn(e){return Zn(Number.NEGATIVE_INFINITY,e)}function Nn(e){return Zn(-1,e)}function Mn(e,t){return Dn(e[0],{...t,expandedStates:e})}function Wn(e){return Sn(e),{type:ln,parts:e}}function kn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return xn(e),""!==t&&xn(t),{type:cn,breakContents:e,flatContents:t,groupId:n.groupId}}function Tn(e,t){return xn(e),{type:gn,contents:e,groupId:t.groupId,negate:t.negate}}function Vn(e){return xn(e),{type:un,contents:e}}var Ln={type:An},Hn={type:In},Qn={type:dn,hard:!0},Kn={type:dn},Xn={type:dn,soft:!0},Yn=[Qn,Hn],zn=[{type:dn,hard:!0,literal:!0},Hn],Pn={type:nn};function Un(e,t){xn(e),Sn(t);let n=[];for(let i=0;i<t.length;i++)0!==i&&n.push(e),n.push(t[i]);return n}function _n(e,t,n){xn(e);let i=e;if(t>0){for(let e=0;e<Math.floor(t/n);++e)i=Rn(i);i=Zn(t%n,i),i=Zn(Number.NEGATIVE_INFINITY,i)}return i}function On(e,t){return xn(t),e?{type:hn,label:e,contents:t}:t}function Jn(e,t){if("string"==typeof e)return t(e);let n=new Map;return i(e);function i(e){if(n.has(e))return n.get(e);let t=r(e);return n.set(e,t),t}function r(e){switch(mn(e)){case tn:return t(e.map(i));case ln:return t({...e,parts:e.parts.map(i)});case cn:return t({...e,breakContents:i(e.breakContents),flatContents:i(e.flatContents)});case an:{let{expandedStates:n,contents:r}=e;return n?(n=n.map(i),r=n[0]):r=i(r),t({...e,contents:r,expandedStates:n})}case sn:case rn:case gn:case hn:case un:return t({...e,contents:i(e.contents)});case en:case nn:case on:case An:case dn:case In:return t(e);default:throw new Bn(e)}}}function jn(e,t,n){let i=n,r=!1;function s(e){if(r)return!1;let n=t(e);void 0!==n&&(r=!0,i=n)}return Gn(e,s),i}function qn(e){if(e.type===an&&e.break||e.type===dn&&e.hard||e.type===In)return!0}function $n(e){return jn(e,qn,!1)}function ei(e){if(e.length>0){let t=v(!1,e,-1);!t.expandedStates&&!t.break&&(t.break="propagated")}return null}function ti(e){let t=new Set,n=[];function i(e){if(e.type===In&&ei(n),e.type===an){if(n.push(e),t.has(e))return!1;t.add(e)}}function r(e){e.type===an&&n.pop().break&&ei(n)}Gn(e,i,r,!0)}function ni(e){return e.type!==dn||e.hard?e.type===cn?e.flatContents:e:e.soft?"":" "}function ii(e){return Jn(e,ni)}function ri(e){switch(mn(e)){case ln:if(e.parts.every((e=>""===e)))return"";break;case an:if(!e.contents&&!e.id&&!e.break&&!e.expandedStates)return"";if(e.contents.type===an&&e.contents.id===e.id&&e.contents.break===e.break&&e.contents.expandedStates===e.expandedStates)return e.contents;break;case sn:case rn:case gn:case un:if(!e.contents)return"";break;case cn:if(!e.flatContents&&!e.breakContents)return"";break;case tn:{let t=[];for(let n of e){if(!n)continue;let[e,...i]=Array.isArray(n)?n:[n];"string"==typeof e&&"string"==typeof v(!1,t,-1)?t[t.length-1]+=e:t.push(e),t.push(...i)}return 0===t.length?"":1===t.length?t[0]:t}case en:case nn:case on:case An:case dn:case hn:case In:break;default:throw new Bn(e)}return e}function si(e){return Jn(e,(e=>ri(e)))}function oi(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zn;return Jn(e,(e=>"string"==typeof e?Un(t,e.split("\n")):e))}function ai(e){if(e.type===dn)return!0}function li(e){return jn(e,ai,!1)}function ci(e,t){return e.type===hn?{...e,contents:t(e.contents)}:t(e)}function gi(e){let t="*".concat(e.value,"*").split("\n");return t.length>1&&t.every((e=>"*"===e.trimStart()[0]))}var ui=gi;function Ai(e,t){let n=e.node;if(De(n))return t.originalText.slice(oe(n),ae(n)).trimEnd();if(ye(n))return ui(n)?di(n):["/*",oi(n.value),"*/"];throw new Error("Not a comment: "+JSON.stringify(n))}function di(e){let t=e.value.split("\n");return["/*",Un(Yn,t.map(((e,n)=>0===n?e.trimEnd():" "+(n<t.length-1?e.trim():e.trimStart())))),"*/"]}var hi={};function Ii(e){let t=e.type||e.kind||"(unknown type)",n=String(e.name||e.id&&("object"==typeof e.id?e.id.name:e.id)||e.key&&("object"==typeof e.key?e.key.name:e.key)||e.value&&("object"==typeof e.value?"":String(e.value))||e.operator||"");return n.length>20&&(n=n.slice(0,19)+"\u2026"),t+(n?" "+n:"")}function pi(e,t){var n;(null!==(n=e.comments)&&void 0!==n?n:e.comments=[]).push(t),t.printed=!1,t.nodeDescription=Ii(e)}function Ci(e,t){t.leading=!0,t.trailing=!1,pi(e,t)}function mi(e,t,n){t.leading=!1,t.trailing=!1,n&&(t.marker=n),pi(e,t)}function fi(e,t){t.leading=!1,t.trailing=!0,pi(e,t)}function yi(e,t){let n=null,i=t;for(;i!==n;)n=i,i=T(e,i),i=z(e,i),i=U(e,i),i=Q(e,i);return i}g(hi,{endOfLine:()=>Ri,ownLine:()=>Si,remaining:()=>Zi});var bi=yi;function Bi(e,t){let n=bi(e,t);return!1===n?"":e.charAt(n)}var vi=Bi;function wi(e,t,n){for(let i=t;i<n;++i)if("\n"===e.charAt(i))return!0;return!1}var Gi=wi;function Ei(e){return ye(e)&&"*"===e.value[0]&&/@(?:type|satisfies)\b/u.test(e.value)}var xi=Ei;function Si(e){return[gr,Li,Ji,Oi,Ti,Mi,Wi,ki,Ki,ir,er,nr,rr,sr,Yi,ji,qi,Vi,hr].some((t=>t(e)))}function Ri(e){return[Ni,Ji,Li,rr,Mi,Wi,ki,Ki,ji,$i,tr,nr,lr,qi,Ar,dr].some((t=>t(e)))}function Zi(e){return[gr,Mi,Wi,Hi,_i,Yi,nr,Ui,Pi,ur,qi,cr].some((t=>t(e)))}function Di(e,t){let n=(e.body||e.properties).find((e=>{let{type:t}=e;return"EmptyStatement"!==t}));n?Ci(n,t):mi(e,t)}function Fi(e,t){"BlockStatement"===e.type?Di(e,t):Ci(e,t)}function Ni(e){let{comment:t,followingNode:n}=e;return!(!n||!xi(t))&&(Ci(n,t),!0)}function Mi(e){let{comment:t,precedingNode:n,enclosingNode:i,followingNode:r,text:s}=e;if("IfStatement"!==(null==i?void 0:i.type)||!r)return!1;if(")"===vi(s,ae(t)))return fi(n,t),!0;if(n===i.consequent&&r===i.alternate){if("BlockStatement"===n.type)fi(n,t);else{let e=De(t)||t.loc.start.line===t.loc.end.line,r=t.loc.start.line===n.loc.start.line;e&&r?fi(n,t):mi(i,t)}return!0}return"BlockStatement"===r.type?(Di(r,t),!0):"IfStatement"===r.type?(Fi(r.consequent,t),!0):i.consequent===r&&(Ci(r,t),!0)}function Wi(e){let{comment:t,precedingNode:n,enclosingNode:i,followingNode:r,text:s}=e;return!("WhileStatement"!==(null==i?void 0:i.type)||!r)&&(")"===vi(s,ae(t))?(fi(n,t),!0):"BlockStatement"===r.type?(Di(r,t),!0):i.body===r&&(Ci(r,t),!0))}function ki(e){let{comment:t,precedingNode:n,enclosingNode:i,followingNode:r}=e;return!("TryStatement"!==(null==i?void 0:i.type)&&"CatchClause"!==(null==i?void 0:i.type)||!r)&&("CatchClause"===i.type&&n?(fi(n,t),!0):"BlockStatement"===r.type?(Di(r,t),!0):"TryStatement"===r.type?(Fi(r.finalizer,t),!0):"CatchClause"===r.type&&(Fi(r.body,t),!0))}function Ti(e){let{comment:t,enclosingNode:n,followingNode:i}=e;return!(!ot(n)||"Identifier"!==(null==i?void 0:i.type))&&(Ci(n,t),!0)}function Vi(e){let{comment:t,enclosingNode:n,followingNode:i,options:r}=e;return!(!r.experimentalTernaries||"ConditionalExpression"!==(null==n?void 0:n.type)&&"ConditionalTypeAnnotation"!==(null==n?void 0:n.type)&&"TSConditionalType"!==(null==n?void 0:n.type))&&("ConditionalExpression"===(null==i?void 0:i.type)||"ConditionalTypeAnnotation"===(null==i?void 0:i.type)||"TSConditionalType"===(null==i?void 0:i.type))&&(mi(n,t),!0)}function Li(e){let{comment:t,precedingNode:n,enclosingNode:i,followingNode:r,text:s,options:o}=e,a=n&&!Gi(s,ae(n),oe(t));return!(n&&a||"ConditionalExpression"!==(null==i?void 0:i.type)&&"ConditionalTypeAnnotation"!==(null==i?void 0:i.type)&&"TSConditionalType"!==(null==i?void 0:i.type)||!r)&&(!o.experimentalTernaries||i.alternate!==r||ye(t)&&!Gi(o.originalText,oe(t),ae(t))?(Ci(r,t),!0):(mi(i,t),!0))}function Hi(e){let{comment:t,precedingNode:n,enclosingNode:i}=e;return!(!Pt(i)||!i.shorthand||i.key!==n||"AssignmentPattern"!==i.value.type)&&(fi(i.value.left,t),!0)}var Qi=new Set(["ClassDeclaration","ClassExpression","DeclareClass","DeclareInterface","InterfaceDeclaration","TSInterfaceDeclaration"]);function Ki(e){let{comment:t,precedingNode:n,enclosingNode:i,followingNode:r}=e;if(Qi.has(null==i?void 0:i.type)){if(j(i.decorators)&&"Decorator"!==(null==r?void 0:r.type))return fi(v(!1,i.decorators,-1),t),!0;if(i.body&&r===i.body)return Di(i.body,t),!0;if(r){if(i.superClass&&r===i.superClass&&n&&(n===i.id||n===i.typeParameters))return fi(n,t),!0;for(let e of["implements","extends","mixins"])if(i[e]&&r===i[e][0])return!n||n!==i.id&&n!==i.typeParameters&&n!==i.superClass?mi(i,t,e):fi(n,t),!0}}return!1}var Xi=new Set(["ClassMethod","ClassProperty","PropertyDefinition","TSAbstractPropertyDefinition","TSAbstractMethodDefinition","TSDeclareMethod","MethodDefinition","ClassAccessorProperty","AccessorProperty","TSAbstractAccessorProperty"]);function Yi(e){let{comment:t,precedingNode:n,enclosingNode:i,text:r}=e;return(i&&n&&"("===vi(r,ae(t))&&("Property"===i.type||"TSDeclareMethod"===i.type||"TSAbstractMethodDefinition"===i.type)&&"Identifier"===n.type&&i.key===n&&":"!==vi(r,ae(n))||!("Decorator"!==(null==n?void 0:n.type)||!Xi.has(null==i?void 0:i.type)))&&(fi(n,t),!0)}var zi=new Set(["FunctionDeclaration","FunctionExpression","ClassMethod","MethodDefinition","ObjectMethod"]);function Pi(e){let{comment:t,precedingNode:n,enclosingNode:i,text:r}=e;return"("===vi(r,ae(t))&&!(!n||!zi.has(null==i?void 0:i.type))&&(fi(n,t),!0)}function Ui(e){let{comment:t,enclosingNode:n,text:i}=e;if("ArrowFunctionExpression"!==(null==n?void 0:n.type))return!1;let r=bi(i,ae(t));return!1!==r&&"=>"===i.slice(r,r+2)&&(mi(n,t),!0)}function _i(e){let{comment:t,enclosingNode:n,text:i}=e;return")"===vi(i,ae(t))&&(n&&(Ir(n)&&0===Ft(n).length||zt(n)&&0===Wt(n).length)?(mi(n,t),!0):("MethodDefinition"===(null==n?void 0:n.type)||"TSAbstractMethodDefinition"===(null==n?void 0:n.type))&&0===Ft(n.value).length&&(mi(n.value,t),!0))}function Oi(e){let{comment:t,precedingNode:n,enclosingNode:i,followingNode:r,text:s}=e;return"ComponentTypeParameter"!==(null==n?void 0:n.type)||"DeclareComponent"!==(null==i?void 0:i.type)&&"ComponentTypeAnnotation"!==(null==i?void 0:i.type)||"ComponentTypeParameter"===(null==r?void 0:r.type)?("ComponentParameter"===(null==n?void 0:n.type)||"RestElement"===(null==n?void 0:n.type))&&"ComponentDeclaration"===(null==i?void 0:i.type)&&")"===vi(s,ae(t))&&(fi(n,t),!0):(fi(n,t),!0)}function Ji(e){let{comment:t,precedingNode:n,enclosingNode:i,followingNode:r,text:s}=e;return"FunctionTypeParam"===(null==n?void 0:n.type)&&"FunctionTypeAnnotation"===(null==i?void 0:i.type)&&"FunctionTypeParam"!==(null==r?void 0:r.type)?(fi(n,t),!0):"Identifier"!==(null==n?void 0:n.type)&&"AssignmentPattern"!==(null==n?void 0:n.type)&&"ObjectPattern"!==(null==n?void 0:n.type)&&"ArrayPattern"!==(null==n?void 0:n.type)&&"RestElement"!==(null==n?void 0:n.type)&&"TSParameterProperty"!==(null==n?void 0:n.type)||!Ir(i)||")"!==vi(s,ae(t))?!(ye(t)||"FunctionDeclaration"!==(null==i?void 0:i.type)&&"FunctionExpression"!==(null==i?void 0:i.type)&&"ObjectMethod"!==(null==i?void 0:i.type)||"BlockStatement"!==(null==r?void 0:r.type)||i.body!==r||bi(s,ae(t))!==oe(r))&&(Di(r,t),!0):(fi(n,t),!0)}function ji(e){let{comment:t,enclosingNode:n}=e;return"LabeledStatement"===(null==n?void 0:n.type)&&(Ci(n,t),!0)}function qi(e){let{comment:t,enclosingNode:n}=e;return!("ContinueStatement"!==(null==n?void 0:n.type)&&"BreakStatement"!==(null==n?void 0:n.type)||n.label)&&(fi(n,t),!0)}function $i(e){let{comment:t,precedingNode:n,enclosingNode:i}=e;return!!(st(i)&&n&&i.callee===n&&i.arguments.length>0)&&(Ci(i.arguments[0],t),!0)}function er(e){let{comment:t,precedingNode:n,enclosingNode:i,followingNode:r}=e;return _t(i)?(Vt(t)&&(r.prettierIgnore=!0,t.unignore=!0),!!n&&(fi(n,t),!0)):(_t(r)&&Vt(t)&&(r.types[0].prettierIgnore=!0,t.unignore=!0),!1)}function tr(e){let{comment:t,enclosingNode:n}=e;return!!Pt(n)&&(Ci(n,t),!0)}function nr(e){let{comment:t,enclosingNode:n,ast:i,isLastComment:r}=e;var s;return 0===(null==(s=null==i?void 0:i.body)?void 0:s.length)?(r?mi(i,t):Ci(i,t),!0):"Program"===(null==n?void 0:n.type)&&0===n.body.length&&!j(n.directives)&&(r?mi(n,t):Ci(n,t),!0)}function ir(e){let{comment:t,enclosingNode:n}=e;return("ForInStatement"===(null==n?void 0:n.type)||"ForOfStatement"===(null==n?void 0:n.type))&&(Ci(n,t),!0)}function rr(e){let{comment:t,precedingNode:n,enclosingNode:i,text:r}=e;if("ImportSpecifier"===(null==i?void 0:i.type)||"ExportSpecifier"===(null==i?void 0:i.type))return Ci(i,t),!0;let s="ImportSpecifier"===(null==n?void 0:n.type)&&"ImportDeclaration"===(null==i?void 0:i.type),o="ExportSpecifier"===(null==n?void 0:n.type)&&"ExportNamedDeclaration"===(null==i?void 0:i.type);return!(!s&&!o||!X(r,ae(t)))&&(fi(n,t),!0)}function sr(e){let{comment:t,enclosingNode:n}=e;return"AssignmentPattern"===(null==n?void 0:n.type)&&(Ci(n,t),!0)}var or=new Set(["VariableDeclarator","AssignmentExpression","TypeAlias","TSTypeAliasDeclaration"]),ar=new Set(["ObjectExpression","RecordExpression","ArrayExpression","TupleExpression","TemplateLiteral","TaggedTemplateExpression","ObjectTypeAnnotation","TSTypeLiteral"]);function lr(e){let{comment:t,enclosingNode:n,followingNode:i}=e;return!(!or.has(null==n?void 0:n.type)||!i||!ar.has(i.type)&&!ye(t))&&(Ci(i,t),!0)}function cr(e){let{comment:t,enclosingNode:n,followingNode:i,text:r}=e;return!(i||"TSMethodSignature"!==(null==n?void 0:n.type)&&"TSDeclareFunction"!==(null==n?void 0:n.type)&&"TSAbstractMethodDefinition"!==(null==n?void 0:n.type)||";"!==vi(r,ae(t)))&&(fi(n,t),!0)}function gr(e){let{comment:t,enclosingNode:n,followingNode:i}=e;if(Vt(t)&&"TSMappedType"===(null==n?void 0:n.type)&&"TSTypeParameter"===(null==i?void 0:i.type)&&i.constraint)return n.prettierIgnore=!0,t.unignore=!0,!0}function ur(e){let{comment:t,precedingNode:n,enclosingNode:i,followingNode:r}=e;return"TSMappedType"===(null==i?void 0:i.type)&&("TSTypeParameter"===(null==r?void 0:r.type)&&r.name?(Ci(r.name,t),!0):!("TSTypeParameter"!==(null==n?void 0:n.type)||!n.constraint)&&(fi(n.constraint,t),!0))}function Ar(e){let{comment:t,enclosingNode:n,followingNode:i}=e;return!(!n||"SwitchCase"!==n.type||n.test||!i||i!==n.consequent[0])&&("BlockStatement"===i.type&&De(t)?Di(i,t):mi(n,t),!0)}function dr(e){let{comment:t,precedingNode:n,enclosingNode:i,followingNode:r}=e;return!(!_t(n)||("TSArrayType"!==i.type&&"ArrayTypeAnnotation"!==i.type||r)&&!Ot(i))&&(fi(v(!1,n.types,-1),t),!0)}function hr(e){let{comment:t,enclosingNode:n,precedingNode:i,followingNode:r}=e;if(("ObjectPattern"===(null==n?void 0:n.type)||"ArrayPattern"===(null==n?void 0:n.type))&&"TSTypeAnnotation"===(null==r?void 0:r.type))return i?fi(i,t):mi(n,t),!0}var Ir=fe(["ArrowFunctionExpression","FunctionExpression","FunctionDeclaration","ObjectMethod","ClassMethod","TSDeclareFunction","TSCallSignatureDeclaration","TSConstructSignatureDeclaration","TSMethodSignature","TSConstructorType","TSFunctionType","TSDeclareMethod"]),pr=new Set(["EmptyStatement","TemplateElement","Import","TSEmptyBodyFunctionExpression","ChainExpression"]);function Cr(e){return!pr.has(e.type)}function mr(e,t){var n;if(("typescript"===t.parser||"flow"===t.parser||"acorn"===t.parser||"espree"===t.parser||"meriyah"===t.parser||"__babel_estree"===t.parser)&&"MethodDefinition"===e.type&&"FunctionExpression"===(null==(n=e.value)?void 0:n.type)&&0===Ft(e.value).length&&!e.value.returnType&&!j(e.value.typeParameters)&&e.value.body)return[...e.decorators||[],e.key,e.value.body]}function fr(e){let{node:t,parent:n}=e;return(Pe(t)||n&&("JSXSpreadAttribute"===n.type||"JSXSpreadChild"===n.type||_t(n)||("ClassDeclaration"===n.type||"ClassExpression"===n.type)&&n.superClass===t))&&(!Lt(t)||_t(n))}function yr(e,t){let{parser:n}=t;if("flow"===n||"babel-flow"===n)return""===(e=b(!1,e,/[\s(]/gu,""))||"/*"===e||"/*::"===e}function br(e){switch(e){case"cr":return"\r";case"crlf":return"\r\n";default:return"\n"}}var Br=Symbol("MODE_BREAK"),vr=Symbol("MODE_FLAT"),wr=Symbol("cursor");function Gr(){return{value:"",length:0,queue:[]}}function Er(e,t){return Sr(e,{type:"indent"},t)}function xr(e,t,n){return t===Number.NEGATIVE_INFINITY?e.root||Gr():t<0?Sr(e,{type:"dedent"},n):t?"root"===t.type?{...e,root:e}:Sr(e,{type:"string"==typeof t?"stringAlign":"numberAlign",n:t},n):e}function Sr(e,t,n){let i="dedent"===t.type?e.queue.slice(0,-1):[...e.queue,t],r="",s=0,o=0,a=0;for(let h of i)switch(h.type){case"indent":g(),n.useTabs?l(1):c(n.tabWidth);break;case"stringAlign":g(),r+=h.n,s+=h.n.length;break;case"numberAlign":o+=1,a+=h.n;break;default:throw new Error("Unexpected type '".concat(h.type,"'"))}return A(),{...e,value:r,length:s,queue:i};function l(e){r+="\t".repeat(e),s+=n.tabWidth*e}function c(e){r+=" ".repeat(e),s+=e}function g(){n.useTabs?u():A()}function u(){o>0&&l(o),d()}function A(){a>0&&c(a),d()}function d(){o=0,a=0}}function Rr(e){let t=0,n=0,i=e.length;e:for(;i--;){let r=e[i];if(r!==wr)for(let n=r.length-1;n>=0;n--){let s=r[n];if(" "!==s&&"\t"!==s){e[i]=r.slice(0,n+1);break e}t++}else n++}if(t>0||n>0)for(e.length=i+1;n-- >0;)e.push(wr);return t}function Zr(e,t,n,i,r,s){if(n===Number.POSITIVE_INFINITY)return!0;let o=t.length,a=[e],l=[];for(;n>=0;){if(0===a.length){if(0===o)return!0;a.push(t[--o]);continue}let{mode:e,doc:c}=a.pop(),g=mn(c);switch(g){case en:l.push(c),n-=W(c);break;case tn:case ln:{let t=g===tn?c:c.parts;for(let n=t.length-1;n>=0;n--)a.push({mode:e,doc:t[n]});break}case rn:case sn:case gn:case hn:a.push({mode:e,doc:c.contents});break;case on:n+=Rr(l);break;case an:{if(s&&c.break)return!1;let t=c.break?Br:e,n=c.expandedStates&&t===Br?v(!1,c.expandedStates,-1):c.contents;a.push({mode:t,doc:n});break}case cn:{let t=(c.groupId?r[c.groupId]||vr:e)===Br?c.breakContents:c.flatContents;t&&a.push({mode:e,doc:t});break}case dn:if(e===Br||c.hard)return!0;c.soft||(l.push(" "),n--);break;case un:i=!0;break;case An:if(i)return!1}}return!1}function Dr(e,t){let n={},i=t.printWidth,r=br(t.endOfLine),s=0,o=[{ind:Gr(),mode:Br,doc:e}],a=[],l=!1,c=[],g=0;for(ti(e);o.length>0;){let{ind:e,mode:u,doc:A}=o.pop();switch(mn(A)){case en:{let e="\n"!==r?b(!1,A,"\n",r):A;a.push(e),o.length>0&&(s+=W(e));break}case tn:for(let t=A.length-1;t>=0;t--)o.push({ind:e,mode:u,doc:A[t]});break;case nn:if(g>=2)throw new Error("There are too many 'cursor' in doc.");a.push(wr),g++;break;case rn:o.push({ind:Er(e,t),mode:u,doc:A.contents});break;case sn:o.push({ind:xr(e,A.n,t),mode:u,doc:A.contents});break;case on:s-=Rr(a);break;case an:switch(u){case vr:if(!l){o.push({ind:e,mode:A.break?Br:vr,doc:A.contents});break}case Br:{l=!1;let t={ind:e,mode:vr,doc:A.contents},r=i-s,a=c.length>0;if(!A.break&&Zr(t,o,r,a,n))o.push(t);else if(A.expandedStates){let t=v(!1,A.expandedStates,-1);if(A.break){o.push({ind:e,mode:Br,doc:t});break}for(let i=1;i<A.expandedStates.length+1;i++){if(i>=A.expandedStates.length){o.push({ind:e,mode:Br,doc:t});break}{let t=A.expandedStates[i],s={ind:e,mode:vr,doc:t};if(Zr(s,o,r,a,n)){o.push(s);break}}}}else o.push({ind:e,mode:Br,doc:A.contents});break}}A.id&&(n[A.id]=v(!1,o,-1).mode);break;case ln:{let t=i-s,{parts:r}=A;if(0===r.length)break;let[a,l]=r,g={ind:e,mode:vr,doc:a},d={ind:e,mode:Br,doc:a},h=Zr(g,[],t,c.length>0,n,!0);if(1===r.length){h?o.push(g):o.push(d);break}let I={ind:e,mode:vr,doc:l},p={ind:e,mode:Br,doc:l};if(2===r.length){h?o.push(I,g):o.push(p,d);break}r.splice(0,2);let C={ind:e,mode:u,doc:Wn(r)},m=r[0];Zr({ind:e,mode:vr,doc:[a,l,m]},[],t,c.length>0,n,!0)?o.push(C,I,g):h?o.push(C,p,g):o.push(C,p,d);break}case cn:case gn:{let t=A.groupId?n[A.groupId]:u;if(t===Br){let t=A.type===cn?A.breakContents:A.negate?A.contents:Rn(A.contents);t&&o.push({ind:e,mode:u,doc:t})}if(t===vr){let t=A.type===cn?A.flatContents:A.negate?Rn(A.contents):A.contents;t&&o.push({ind:e,mode:u,doc:t})}break}case un:c.push({ind:e,mode:u,doc:A.contents});break;case An:c.length>0&&o.push({ind:e,mode:u,doc:Qn});break;case dn:switch(u){case vr:if(!A.hard){A.soft||(a.push(" "),s+=1);break}l=!0;case Br:if(c.length>0){o.push({ind:e,mode:u,doc:A},...c.reverse()),c.length=0;break}A.literal?e.root?(a.push(r,e.root.value),s=e.root.length):(a.push(r),s=0):(s-=Rr(a),a.push(r+e.value),s=e.length)}break;case hn:o.push({ind:e,mode:u,doc:A.contents});break;case In:break;default:throw new Bn(A)}0===o.length&&c.length>0&&(o.push(...c.reverse()),c.length=0)}let u=a.indexOf(wr);if(-1!==u){let e=a.indexOf(wr,u+1),t=a.slice(0,u).join(""),n=a.slice(u+1,e).join("");return{formatted:t+n+a.slice(e+1).join(""),cursorNodeStart:t.length,cursorNodeText:n}}return{formatted:a.join("")}}function Fr(e,t){let n=0;for(let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;i<e.length;++i)"\t"===e[i]?n=n+t-n%t:n++;return n}var Nr=Fr;function Mr(e,t){let n=e.lastIndexOf("\n");return-1===n?0:Nr(e.slice(n+1).match(/^[\t ]*/u)[0],t)}var Wr=Mr;function kr(e,t,n){let{node:i}=e;if("TemplateLiteral"===i.type&&Xr(e)){let i=Vr(e,n,t);if(i)return i}let r="expressions";"TSTemplateLiteralType"===i.type&&(r="types");let s=[],o=e.map(t,r);s.push(Ln,"`");let a=0;return e.each((e=>{let{index:l,node:c}=e;if(s.push(t()),c.tail)return;let{tabWidth:g}=n,u=c.value.raw,A=u.includes("\n")?Wr(u,g):a;a=A;let d=o[l],h=i[r][l],I=Gi(n.originalText,ae(c),oe(i.quasis[l+1]));if(!I){let e=Dr(d,{...n,printWidth:Number.POSITIVE_INFINITY}).formatted;e.includes("\n")?I=!0:d=e}I&&(Kt(h)||"Identifier"===h.type||ot(h)||"ConditionalExpression"===h.type||"SequenceExpression"===h.type||Ut(h)||Je(h))&&(d=[Rn([Xn,d]),Xn]);let p=0===A&&u.endsWith("\n")?Zn(Number.NEGATIVE_INFINITY,d):_n(d,A,g);s.push(Dn(["${",p,Ln,"}"]))}),"quasis"),s.push("`"),s}function Tr(e,t){let n=t("quasi");return On(n.label&&{tagged:!0,...n.label},[t("tag"),t(e.node.typeArguments?"typeArguments":"typeParameters"),Ln,n])}function Vr(e,t,n){let{node:i}=e,r=i.quasis[0].value.raw.trim().split(/\s*\|\s*/u);if(r.length>1||r.some((e=>e.length>0))){t.__inJestEach=!0;let s=e.map(n,"expressions");t.__inJestEach=!1;let o=[],a=s.map((e=>"${"+Dr(e,{...t,printWidth:Number.POSITIVE_INFINITY,endOfLine:"lf"}).formatted+"}")),l=[{hasLineBreak:!1,cells:[]}];for(let e=1;e<i.quasis.length;e++){let t=v(!1,l,-1),n=a[e-1];t.cells.push(n),n.includes("\n")&&(t.hasLineBreak=!0),i.quasis[e].value.raw.includes("\n")&&l.push({hasLineBreak:!1,cells:[]})}let c=Math.max(r.length,...l.map((e=>e.cells.length))),g=Array.from({length:c}).fill(0),u=[{cells:r},...l.filter((e=>e.cells.length>0))];for(let{cells:e}of u.filter((e=>!e.hasLineBreak)))for(let[t,n]of e.entries())g[t]=Math.max(g[t],W(n));return o.push(Ln,"`",Rn([Yn,Un(Yn,u.map((e=>Un(" | ",e.cells.map(((t,n)=>e.hasLineBreak?t:t+" ".repeat(g[n]-W(t))))))))]),Yn,"`"),o}}function Lr(e,t){let{node:n}=e,i=t();return Kt(n)&&(i=Dn([Rn([Xn,i]),Xn])),["${",i,Ln,"}"]}function Hr(e,t){return e.map((e=>Lr(e,t)),"expressions")}function Qr(e,t){return Jn(e,(e=>"string"==typeof e?t?b(!1,e,/(\\*)`/gu,"$1$1\\`"):Kr(e):e))}function Kr(e){return b(!1,e,/([\\`]|\$\{)/gu,String.raw(i||(i=o(["$1"],["\\$1"]))))}function Xr(e){let{node:t,parent:n}=e,i=/^[fx]?(?:describe|it|test)$/u;return"TaggedTemplateExpression"===n.type&&n.quasi===t&&"MemberExpression"===n.tag.type&&"Identifier"===n.tag.property.type&&"each"===n.tag.property.name&&("Identifier"===n.tag.object.type&&i.test(n.tag.object.name)||"MemberExpression"===n.tag.object.type&&"Identifier"===n.tag.object.property.type&&("only"===n.tag.object.property.name||"skip"===n.tag.object.property.name)&&"Identifier"===n.tag.object.object.type&&i.test(n.tag.object.object.name))}var Yr=[(e,t)=>"ObjectExpression"===e.type&&"properties"===t,(e,t)=>"CallExpression"===e.type&&"Identifier"===e.callee.type&&"Component"===e.callee.name&&"arguments"===t,(e,t)=>"Decorator"===e.type&&"expression"===t];function zr(e){let t=e=>"TemplateLiteral"===e.type,n=(e,t)=>Pt(e)&&!e.computed&&"Identifier"===e.key.type&&"styles"===e.key.name&&"value"===t;return e.match(t,((e,t)=>Ne(e)&&"elements"===t),n,...Yr)||e.match(t,n,...Yr)}function Pr(e){return e.match((e=>"TemplateLiteral"===e.type),((e,t)=>Pt(e)&&!e.computed&&"Identifier"===e.key.type&&"template"===e.key.name&&"value"===t),...Yr)}function Ur(e,t){return Kt(e,Ht.Block|Ht.Leading,(e=>{let{value:n}=e;return n===" ".concat(t," ")}))}function _r(e,t){let{node:n,parent:i}=e;return Ur(n,t)||Or(i)&&Ur(i,t)||"ExpressionStatement"===i.type&&Ur(i,t)}function Or(e){return"AsConstExpression"===e.type||"TSAsExpression"===e.type&&"TSTypeReference"===e.typeAnnotation.type&&"Identifier"===e.typeAnnotation.typeName.type&&"const"===e.typeAnnotation.typeName.name}async function Jr(e,t,n){let{node:i}=n,r=i.quasis.map((e=>e.value.raw)),s=0,o=r.reduce(((e,t,n)=>0===n?t:e+"@prettier-placeholder-"+s+++"-id"+t),""),a=jr(await e(o,{parser:"scss"}),Hr(n,t));if(!a)throw new Error("Couldn't insert all the expressions");return["`",Rn([Yn,a]),Xn,"`"]}function jr(e,t){if(!j(t))return e;let n=0,i=Jn(si(e),(e=>"string"==typeof e&&e.includes("@prettier-placeholder")?e.split(/@prettier-placeholder-(\d+)-id/u).map(((e,i)=>i%2===0?oi(e):(n++,t[e]))):e));return t.length===n?i:null}function qr(e){let{node:t,parent:n,grandparent:i}=e;return i&&t.quasis&&"JSXExpressionContainer"===n.type&&"JSXElement"===i.type&&"style"===i.openingElement.name.name&&i.openingElement.attributes.some((e=>"JSXAttribute"===e.type&&"jsx"===e.name.name))||"TaggedTemplateExpression"===(null==n?void 0:n.type)&&"Identifier"===n.tag.type&&"css"===n.tag.name||"TaggedTemplateExpression"===(null==n?void 0:n.type)&&"MemberExpression"===n.tag.type&&"css"===n.tag.object.name&&("global"===n.tag.property.name||"resolve"===n.tag.property.name)}function $r(e){return"Identifier"===e.type&&"styled"===e.name}function es(e){return/^[A-Z]/u.test(e.object.name)&&"extend"===e.property.name}function ts(e){let{parent:t}=e;if(!t||"TaggedTemplateExpression"!==t.type)return!1;let n="ParenthesizedExpression"===t.tag.type?t.tag.expression:t.tag;switch(n.type){case"MemberExpression":return $r(n.object)||es(n);case"CallExpression":return $r(n.callee)||"MemberExpression"===n.callee.type&&("MemberExpression"===n.callee.object.type&&($r(n.callee.object.object)||es(n.callee.object))||"CallExpression"===n.callee.object.type&&$r(n.callee.object.callee));case"Identifier":return"css"===n.name;default:return!1}}function ns(e){let{parent:t,grandparent:n}=e;return"JSXAttribute"===(null==n?void 0:n.type)&&"JSXExpressionContainer"===t.type&&"JSXIdentifier"===n.name.type&&"css"===n.name.name}function is(e){if(qr(e)||ts(e)||ns(e)||zr(e))return Jr}var rs=is;async function ss(e,t,n){let{node:i}=n,r=i.quasis.length,s=Hr(n,t),o=[];for(let a=0;a<r;a++){let t=0===a,n=a===r-1,l=i.quasis[a].value.cooked,c=l.split("\n"),g=c.length,u=s[a],A=g>2&&""===c[0].trim()&&""===c[1].trim(),d=g>2&&""===c[g-1].trim()&&""===c[g-2].trim(),h=c.every((e=>/^\s*(?:#[^\n\r]*)?$/u.test(e)));if(!n&&/#[^\n\r]*$/u.test(c[g-1]))return null;let I=null;I=h?os(c):await e(l,{parser:"graphql"}),I?(I=Qr(I,!1),!t&&A&&o.push(""),o.push(I),!n&&d&&o.push("")):!t&&!n&&A&&o.push(""),u&&o.push(u)}return["`",Rn([Yn,Un(Yn,o)]),Yn,"`"]}function os(e){let t=[],n=!1,i=e.map((e=>e.trim()));for(let[r,s]of i.entries())""!==s&&(""===i[r-1]&&n?t.push([Yn,s]):t.push(s),n=!0);return 0===t.length?null:Un(Yn,t)}function as(e){let{node:t,parent:n}=e;return _r({node:t,parent:n},"GraphQL")||n&&("TaggedTemplateExpression"===n.type&&("MemberExpression"===n.tag.type&&"graphql"===n.tag.object.name&&"experimental"===n.tag.property.name||"Identifier"===n.tag.type&&("gql"===n.tag.name||"graphql"===n.tag.name))||"CallExpression"===n.type&&"Identifier"===n.callee.type&&"graphql"===n.callee.name)}function ls(e){if(as(e))return ss}var cs=ls,gs=0;async function us(e,t,n,i,a){let{node:l}=i,c=gs;gs=gs+1>>>0;let g=e=>"PRETTIER_HTML_PLACEHOLDER_".concat(e,"_").concat(c,"_IN_JS"),u=l.quasis.map(((e,t,n)=>t===n.length-1?e.value.cooked:e.value.cooked+g(t))).join(""),A=Hr(i,n),d=new RegExp(g(String.raw(r||(r=o(["(d+)"],["(\\d+)"])))),"gu"),h=0,I=Jn(await t(u,{parser:e,__onHtmlRoot(e){h=e.children.length}}),(e=>{if("string"!=typeof e)return e;let t=[],n=e.split(d);for(let i=0;i<n.length;i++){let e=n[i];if(i%2===0){e&&(e=Kr(e),a.__embeddedInHtml&&(e=b(!1,e,/<\/(?=script\b)/giu,String.raw(s||(s=o(["</"],["<\\/"]))))),t.push(e));continue}let r=Number(e);t.push(A[r])}return t})),p=/^\s/u.test(u)?" ":"",C=/\s$/u.test(u)?" ":"",m="ignore"===a.htmlWhitespaceSensitivity?Yn:p&&C?Kn:null;return m?Dn(["`",Rn([m,Dn(I)]),m,"`"]):On({hug:!1},Dn(["`",p,h>1?Rn(Dn(I)):Dn(I),C,"`"]))}function As(e){return _r(e,"HTML")||e.match((e=>"TemplateLiteral"===e.type),((e,t)=>"TaggedTemplateExpression"===e.type&&"Identifier"===e.tag.type&&"html"===e.tag.name&&"quasi"===t))}var ds=us.bind(void 0,"html"),hs=us.bind(void 0,"angular");function Is(e){return As(e)?ds:Pr(e)?hs:void 0}var ps=Is;async function Cs(e,t,n){let{node:i}=n,r=b(!1,i.quasis[0].value.raw,/((?:\\\\)*)\\`/gu,((e,t)=>"\\".repeat(t.length/2)+"`")),s=ms(r),o=""!==s;o&&(r=b(!1,r,new RegExp("^".concat(s),"gmu"),""));let a=Qr(await e(r,{parser:"markdown",__inJsTemplate:!0}),!0);return["`",o?Rn([Xn,a]):[zn,Fn(a)],Xn,"`"]}function ms(e){let t=e.match(/^([^\S\n]*)\S/mu);return null===t?"":t[1]}function fs(e){if(ys(e))return Cs}function ys(e){let{node:t,parent:n}=e;return"TaggedTemplateExpression"===(null==n?void 0:n.type)&&1===t.quasis.length&&"Identifier"===n.tag.type&&("md"===n.tag.name||"markdown"===n.tag.name)}var bs=fs;function Bs(e){let t,{node:n}=e;if("TemplateLiteral"===n.type&&!vs(n))for(let i of[rs,cs,ps,bs])if(t=i(e),t)return 1===n.quasis.length&&""===n.quasis[0].value.raw.trim()?"``":async function(){let e=await t(...arguments);return e&&On({embed:!0,...e.label},e)}}function vs(e){let{quasis:t}=e;return t.some((e=>{let{value:{cooked:t}}=e;return null===t}))}var ws=Bs,Gs=/\*\/$/,Es=/^\/\*\*?/,xs=/^\s*(\/\*\*?(.|\r?\n)*?\*\/)/,Ss=/(^|\s+)\/\/([^\n\r]*)/g,Rs=/^(\r?\n)+/,Zs=/(?:^|\r?\n) *(@[^\n\r]*?) *\r?\n *(?![^\n\r@]*\/\/[^]*)([^\s@][^\n\r@]+?) *\r?\n/g,Ds=/(?:^|\r?\n) *@(\S+) *([^\n\r]*)/g,Fs=/(\r?\n|^) *\* ?/g,Ns=[];function Ms(e){let t=e.match(xs);return t?t[0].trimStart():""}function Ws(e){let t=e.match(xs),n=null==t?void 0:t[0];return null==n?e:e.slice(n.length)}function ks(e){let t="\n";e=b(!1,e.replace(Es,"").replace(Gs,""),Fs,"$1");let n="";for(;n!==e;)n=e,e=b(!1,e,Zs,"".concat(t,"$1 $2").concat(t));e=e.replace(Rs,"").trimEnd();let i,r=Object.create(null),s=b(!1,e,Ds,"").replace(Rs,"").trimEnd();for(;i=Ds.exec(e);){let e=b(!1,i[2],Ss,"");if("string"==typeof r[i[1]]||Array.isArray(r[i[1]])){let t=r[i[1]];r[i[1]]=[...Ns,...Array.isArray(t)?t:[t],e]}else r[i[1]]=e}return{comments:s,pragmas:r}}function Ts(e){let{comments:t="",pragmas:n={}}=e,i="\n",r="/**",s=" *",o=" */",a=Object.keys(n),l=a.flatMap((e=>Vs(e,n[e]))).map((e=>"".concat(s," ").concat(e).concat(i))).join("");if(!t){if(0===a.length)return"";if(1===a.length&&!Array.isArray(n[a[0]])){let e=n[a[0]];return"".concat(r," ").concat(Vs(a[0],e)[0]).concat(o)}}let c=t.split(i).map((e=>"".concat(s," ").concat(e))).join(i)+i;return r+i+(t?c:"")+(t&&a.length>0?s+i:"")+l+o}function Vs(e,t){return[...Ns,...Array.isArray(t)?t:[t]].map((t=>"@".concat(e," ").concat(t).trim()))}function Ls(e){if(!e.startsWith("#!"))return"";let t=e.indexOf("\n");return-1===t?e:e.slice(0,t)}var Hs=Ls;function Qs(e){let t=Hs(e);t&&(e=e.slice(t.length+1));let n=Ms(e),{pragmas:i,comments:r}=ks(n);return{shebang:t,text:e,pragmas:i,comments:r}}function Ks(e){let{shebang:t,text:n,pragmas:i,comments:r}=Qs(e),s=Ws(n),o=Ts({pragmas:{format:"",...i},comments:r.trimStart()});return(t?"".concat(t,"\n"):"")+o+(s.startsWith("\n")?"\n":"\n\n")+s}function Xs(e,t){let{originalText:n,[Symbol.for("comments")]:i,locStart:r,locEnd:s,[Symbol.for("printedComments")]:o}=t,{node:a}=e,l=r(a),c=s(a);for(let g of i)r(g)>=l&&s(g)<=c&&o.add(g);return n.slice(l,c)}var Ys=Xs;function zs(e,t){var n,i,r,s,o,a,l,c,g;if(e.isRoot)return!1;let{node:u,key:A,parent:d}=e;if(t.__isInHtmlInterpolation&&!t.bracketSpacing&&Os(u)&&Js(e))return!0;if(Ps(u))return!1;if("Identifier"===u.type){if(null!=(n=u.extra)&&n.parenthesized&&/^PRETTIER_HTML_PLACEHOLDER_\d+_\d+_IN_JS$/u.test(u.name)||"left"===A&&("async"===u.name&&!d.await||"let"===u.name)&&"ForOfStatement"===d.type)return!0;if("let"===u.name){let t=null==(i=e.findAncestor((e=>"ForOfStatement"===e.type)))?void 0:i.left;if(t&&Bt(t,(e=>e===u)))return!0}if("object"===A&&"let"===u.name&&"MemberExpression"===d.type&&d.computed&&!d.optional){let t=e.findAncestor((e=>"ExpressionStatement"===e.type||"ForStatement"===e.type||"ForInStatement"===e.type)),n=t?"ExpressionStatement"===t.type?t.expression:"ForStatement"===t.type?t.init:t.left:void 0;if(n&&Bt(n,(e=>e===u)))return!0}if("expression"===A)switch(u.name){case"await":case"interface":case"module":case"using":case"yield":case"let":case"component":case"hook":case"type":{let t=e.findAncestor((e=>!Ut(e)));if(t!==d&&"ExpressionStatement"===t.type)return!0}}return!1}if("ObjectExpression"===u.type||"FunctionExpression"===u.type||"ClassExpression"===u.type||"DoExpression"===u.type){let t=null==(r=e.findAncestor((e=>"ExpressionStatement"===e.type)))?void 0:r.expression;if(t&&Bt(t,(e=>e===u)))return!0}if("ObjectExpression"===u.type){let t=null==(s=e.findAncestor((e=>"ArrowFunctionExpression"===e.type)))?void 0:s.body;if(t&&"SequenceExpression"!==t.type&&"AssignmentExpression"!==t.type&&Bt(t,(e=>e===u)))return!0}switch(d.type){case"ParenthesizedExpression":return!1;case"ClassDeclaration":case"ClassExpression":if("superClass"===A&&("ArrowFunctionExpression"===u.type||"AssignmentExpression"===u.type||"AwaitExpression"===u.type||"BinaryExpression"===u.type||"ConditionalExpression"===u.type||"LogicalExpression"===u.type||"NewExpression"===u.type||"ObjectExpression"===u.type||"SequenceExpression"===u.type||"TaggedTemplateExpression"===u.type||"UnaryExpression"===u.type||"UpdateExpression"===u.type||"YieldExpression"===u.type||"TSNonNullExpression"===u.type||"ClassExpression"===u.type&&j(u.decorators)))return!0;break;case"ExportDefaultDeclaration":return js(e,t)||"SequenceExpression"===u.type;case"Decorator":if("expression"===A&&!eo(u))return!0;break;case"TypeAnnotation":if(e.match(void 0,void 0,((e,t)=>"returnType"===t&&"ArrowFunctionExpression"===e.type))&&_s(u))return!0;break;case"BinaryExpression":if("left"===A&&("in"===d.operator||"instanceof"===d.operator)&&"UnaryExpression"===u.type)return!0;break;case"VariableDeclarator":if("init"===A&&e.match(void 0,void 0,((e,t)=>"declarations"===t&&"VariableDeclaration"===e.type),((e,t)=>"left"===t&&"ForInStatement"===e.type)))return!0}switch(u.type){case"UpdateExpression":if("UnaryExpression"===d.type)return u.prefix&&("++"===u.operator&&"+"===d.operator||"--"===u.operator&&"-"===d.operator);case"UnaryExpression":switch(d.type){case"UnaryExpression":return u.operator===d.operator&&("+"===u.operator||"-"===u.operator);case"BindExpression":case"TaggedTemplateExpression":case"TSNonNullExpression":return!0;case"MemberExpression":case"OptionalMemberExpression":return"object"===A;case"NewExpression":case"CallExpression":case"OptionalCallExpression":return"callee"===A;case"BinaryExpression":return"left"===A&&"**"===d.operator;default:return!1}case"BinaryExpression":if("UpdateExpression"===d.type||"in"===u.operator&&Us(e))return!0;if("|>"===u.operator&&null!=(o=u.extra)&&o.parenthesized){let t=e.grandparent;if("BinaryExpression"===t.type&&"|>"===t.operator)return!0}case"TSTypeAssertion":case"TSAsExpression":case"TSSatisfiesExpression":case"AsExpression":case"AsConstExpression":case"SatisfiesExpression":case"LogicalExpression":switch(d.type){case"TSAsExpression":case"TSSatisfiesExpression":case"AsExpression":case"AsConstExpression":case"SatisfiesExpression":return!Ut(u);case"ConditionalExpression":return Ut(u)||We(u);case"CallExpression":case"NewExpression":case"OptionalCallExpression":return"callee"===A;case"ClassExpression":case"ClassDeclaration":return"superClass"===A;case"TSTypeAssertion":case"TaggedTemplateExpression":case"UnaryExpression":case"JSXSpreadAttribute":case"SpreadElement":case"BindExpression":case"AwaitExpression":case"TSNonNullExpression":case"UpdateExpression":return!0;case"MemberExpression":case"OptionalMemberExpression":return"object"===A;case"AssignmentExpression":case"AssignmentPattern":return"left"===A&&("TSTypeAssertion"===u.type||Ut(u));case"LogicalExpression":if("LogicalExpression"===u.type)return d.operator!==u.operator;case"BinaryExpression":{let{operator:e,type:t}=u;if(!e&&"TSTypeAssertion"!==t)return!0;let n=St(e),i=d.operator,r=St(i);return r>n||"right"===A&&r===n||r===n&&!Et(i,e)||(r<n&&"%"===e?"+"===i||"-"===i:!!Rt(i))}default:return!1}case"SequenceExpression":switch(d.type){case"ReturnStatement":case"ForStatement":return!1;case"ExpressionStatement":return"expression"!==A;case"ArrowFunctionExpression":return"body"!==A;default:return!0}case"YieldExpression":if("AwaitExpression"===d.type||"TSTypeAssertion"===d.type)return!0;case"AwaitExpression":switch(d.type){case"TaggedTemplateExpression":case"UnaryExpression":case"LogicalExpression":case"SpreadElement":case"TSAsExpression":case"TSSatisfiesExpression":case"TSNonNullExpression":case"AsExpression":case"AsConstExpression":case"SatisfiesExpression":case"BindExpression":return!0;case"MemberExpression":case"OptionalMemberExpression":return"object"===A;case"NewExpression":case"CallExpression":case"OptionalCallExpression":return"callee"===A;case"ConditionalExpression":return"test"===A;case"BinaryExpression":return!(!u.argument&&"|>"===d.operator);default:return!1}case"TSFunctionType":if(e.match((e=>"TSFunctionType"===e.type),((e,t)=>"typeAnnotation"===t&&"TSTypeAnnotation"===e.type),((e,t)=>"returnType"===t&&"ArrowFunctionExpression"===e.type)))return!0;case"TSConditionalType":case"TSConstructorType":if("extendsType"===A&&"TSConditionalType"===d.type){if("TSConditionalType"===u.type)return!0;let{typeAnnotation:e}=u.returnType||u.typeAnnotation;if("TSTypePredicate"===e.type&&e.typeAnnotation&&(e=e.typeAnnotation.typeAnnotation),"TSInferType"===e.type&&e.typeParameter.constraint)return!0}if("checkType"===A&&"TSConditionalType"===d.type)return!0;case"TSUnionType":case"TSIntersectionType":if(("TSUnionType"===d.type||"TSIntersectionType"===d.type)&&d.types.length>1&&(!u.types||u.types.length>1))return!0;case"TSInferType":if("TSInferType"===u.type){if("TSRestType"===d.type)return!1;if("types"===A&&("TSUnionType"===d.type||"TSIntersectionType"===d.type)&&"TSTypeParameter"===u.typeParameter.type&&u.typeParameter.constraint)return!0}case"TSTypeOperator":return"TSArrayType"===d.type||"TSOptionalType"===d.type||"TSRestType"===d.type||"objectType"===A&&"TSIndexedAccessType"===d.type||"TSTypeOperator"===d.type||"TSTypeAnnotation"===d.type&&e.grandparent.type.startsWith("TSJSDoc");case"TSTypeQuery":return"objectType"===A&&"TSIndexedAccessType"===d.type||"elementType"===A&&"TSArrayType"===d.type;case"TypeOperator":return"ArrayTypeAnnotation"===d.type||"NullableTypeAnnotation"===d.type||"objectType"===A&&("IndexedAccessType"===d.type||"OptionalIndexedAccessType"===d.type)||"TypeOperator"===d.type;case"TypeofTypeAnnotation":return"objectType"===A&&("IndexedAccessType"===d.type||"OptionalIndexedAccessType"===d.type)||"elementType"===A&&"ArrayTypeAnnotation"===d.type;case"ArrayTypeAnnotation":return"NullableTypeAnnotation"===d.type;case"IntersectionTypeAnnotation":case"UnionTypeAnnotation":return"TypeOperator"===d.type||"ArrayTypeAnnotation"===d.type||"NullableTypeAnnotation"===d.type||"IntersectionTypeAnnotation"===d.type||"UnionTypeAnnotation"===d.type||"objectType"===A&&("IndexedAccessType"===d.type||"OptionalIndexedAccessType"===d.type);case"InferTypeAnnotation":case"NullableTypeAnnotation":return"ArrayTypeAnnotation"===d.type||"objectType"===A&&("IndexedAccessType"===d.type||"OptionalIndexedAccessType"===d.type);case"ComponentTypeAnnotation":case"FunctionTypeAnnotation":{if("ComponentTypeAnnotation"===u.type&&(null===u.rendersType||void 0===u.rendersType))return!1;if(e.match(void 0,((e,t)=>"typeAnnotation"===t&&"TypeAnnotation"===e.type),((e,t)=>"returnType"===t&&"ArrowFunctionExpression"===e.type))||e.match(void 0,((e,t)=>"typeAnnotation"===t&&"TypePredicate"===e.type),((e,t)=>"typeAnnotation"===t&&"TypeAnnotation"===e.type),((e,t)=>"returnType"===t&&"ArrowFunctionExpression"===e.type)))return!0;let t="NullableTypeAnnotation"===d.type?e.grandparent:d;return"UnionTypeAnnotation"===t.type||"IntersectionTypeAnnotation"===t.type||"ArrayTypeAnnotation"===t.type||"objectType"===A&&("IndexedAccessType"===t.type||"OptionalIndexedAccessType"===t.type)||"checkType"===A&&"ConditionalTypeAnnotation"===d.type||"extendsType"===A&&"ConditionalTypeAnnotation"===d.type&&"InferTypeAnnotation"===(null==(a=u.returnType)?void 0:a.type)&&(null==(l=u.returnType)?void 0:l.typeParameter.bound)||"NullableTypeAnnotation"===t.type||"FunctionTypeParam"===d.type&&null===d.name&&Ft(u).some((e=>{var t;return"NullableTypeAnnotation"===(null==(t=e.typeAnnotation)?void 0:t.type)}))}case"ConditionalTypeAnnotation":if("extendsType"===A&&"ConditionalTypeAnnotation"===d.type&&"ConditionalTypeAnnotation"===u.type||"checkType"===A&&"ConditionalTypeAnnotation"===d.type)return!0;case"OptionalIndexedAccessType":return"objectType"===A&&"IndexedAccessType"===d.type;case"StringLiteral":case"NumericLiteral":case"Literal":if("string"==typeof u.value&&"ExpressionStatement"===d.type&&!d.directive){let t=e.grandparent;return"Program"===t.type||"BlockStatement"===t.type}return"object"===A&&"MemberExpression"===d.type&&"number"==typeof u.value;case"AssignmentExpression":{let t=e.grandparent;return"body"===A&&"ArrowFunctionExpression"===d.type||("key"!==A||"ClassProperty"!==d.type&&"PropertyDefinition"!==d.type||!d.computed)&&("init"!==A&&"update"!==A||"ForStatement"!==d.type)&&("ExpressionStatement"===d.type?"ObjectPattern"===u.left.type:!("key"===A&&"TSPropertySignature"===d.type||"AssignmentExpression"===d.type||"SequenceExpression"===d.type&&"ForStatement"===t.type&&(t.init===d||t.update===d)||"value"===A&&"Property"===d.type&&"ObjectPattern"===t.type&&t.properties.includes(d)||"NGChainedExpression"===d.type))}case"ConditionalExpression":switch(d.type){case"TaggedTemplateExpression":case"UnaryExpression":case"SpreadElement":case"BinaryExpression":case"LogicalExpression":case"NGPipeExpression":case"ExportDefaultDeclaration":case"AwaitExpression":case"JSXSpreadAttribute":case"TSTypeAssertion":case"TypeCastExpression":case"TSAsExpression":case"TSSatisfiesExpression":case"AsExpression":case"AsConstExpression":case"SatisfiesExpression":case"TSNonNullExpression":return!0;case"NewExpression":case"CallExpression":case"OptionalCallExpression":return"callee"===A;case"ConditionalExpression":return!t.experimentalTernaries&&"test"===A;case"MemberExpression":case"OptionalMemberExpression":return"object"===A;default:return!1}case"FunctionExpression":switch(d.type){case"NewExpression":case"CallExpression":case"OptionalCallExpression":return"callee"===A;case"TaggedTemplateExpression":return!0;default:return!1}case"ArrowFunctionExpression":switch(d.type){case"BinaryExpression":return"|>"!==d.operator||(null==(c=u.extra)?void 0:c.parenthesized);case"NewExpression":case"CallExpression":case"OptionalCallExpression":return"callee"===A;case"MemberExpression":case"OptionalMemberExpression":return"object"===A;case"TSAsExpression":case"TSSatisfiesExpression":case"AsExpression":case"AsConstExpression":case"SatisfiesExpression":case"TSNonNullExpression":case"BindExpression":case"TaggedTemplateExpression":case"UnaryExpression":case"LogicalExpression":case"AwaitExpression":case"TSTypeAssertion":return!0;case"ConditionalExpression":return"test"===A;default:return!1}case"ClassExpression":return"NewExpression"===d.type&&"callee"===A;case"OptionalMemberExpression":case"OptionalCallExpression":case"CallExpression":case"MemberExpression":if(qs(e))return!0;case"TaggedTemplateExpression":case"TSNonNullExpression":if("callee"===A&&("BindExpression"===d.type||"NewExpression"===d.type)){let e=u;for(;e;)switch(e.type){case"CallExpression":case"OptionalCallExpression":return!0;case"MemberExpression":case"OptionalMemberExpression":case"BindExpression":e=e.object;break;case"TaggedTemplateExpression":e=e.tag;break;case"TSNonNullExpression":e=e.expression;break;default:return!1}}return!1;case"BindExpression":return"callee"===A&&("BindExpression"===d.type||"NewExpression"===d.type)||"object"===A&&ot(d);case"NGPipeExpression":return!("NGRoot"===d.type||"NGMicrosyntaxExpression"===d.type||"ObjectProperty"===d.type&&(null==(g=u.extra)||!g.parenthesized)||Ne(d)||"arguments"===A&&st(d)||"right"===A&&"NGPipeExpression"===d.type||"property"===A&&"MemberExpression"===d.type||"AssignmentExpression"===d.type);case"JSXFragment":case"JSXElement":return"callee"===A||"left"===A&&"BinaryExpression"===d.type&&"<"===d.operator||!Ne(d)&&"ArrowFunctionExpression"!==d.type&&"AssignmentExpression"!==d.type&&"AssignmentPattern"!==d.type&&"BinaryExpression"!==d.type&&"NewExpression"!==d.type&&"ConditionalExpression"!==d.type&&"ExpressionStatement"!==d.type&&"JsExpressionRoot"!==d.type&&"JSXAttribute"!==d.type&&"JSXElement"!==d.type&&"JSXExpressionContainer"!==d.type&&"JSXFragment"!==d.type&&"LogicalExpression"!==d.type&&!st(d)&&!Pt(d)&&"ReturnStatement"!==d.type&&"ThrowStatement"!==d.type&&"TypeCastExpression"!==d.type&&"VariableDeclarator"!==d.type&&"YieldExpression"!==d.type;case"TSInstantiationExpression":return"object"===A&&ot(d)}return!1}var Ps=fe(["BlockStatement","BreakStatement","ComponentDeclaration","ClassBody","ClassDeclaration","ClassMethod","ClassProperty","PropertyDefinition","ClassPrivateProperty","ContinueStatement","DebuggerStatement","DeclareComponent","DeclareClass","DeclareExportAllDeclaration","DeclareExportDeclaration","DeclareFunction","DeclareHook","DeclareInterface","DeclareModule","DeclareModuleExports","DeclareNamespace","DeclareVariable","DeclareEnum","DoWhileStatement","EnumDeclaration","ExportAllDeclaration","ExportDefaultDeclaration","ExportNamedDeclaration","ExpressionStatement","ForInStatement","ForOfStatement","ForStatement","FunctionDeclaration","HookDeclaration","IfStatement","ImportDeclaration","InterfaceDeclaration","LabeledStatement","MethodDefinition","ReturnStatement","SwitchStatement","ThrowStatement","TryStatement","TSDeclareFunction","TSEnumDeclaration","TSImportEqualsDeclaration","TSInterfaceDeclaration","TSModuleDeclaration","TSNamespaceExportDeclaration","TypeAlias","VariableDeclaration","WhileStatement","WithStatement"]);function Us(e){let t=0,{node:n}=e;for(;n;){let i=e.getParentNode(t++);if("ForStatement"===(null==i?void 0:i.type)&&i.init===n)return!0;n=i}return!1}function _s(e){return xe(e,(e=>"ObjectTypeAnnotation"===e.type&&xe(e,(e=>"FunctionTypeAnnotation"===e.type))))}function Os(e){return Me(e)}function Js(e){let{parent:t,key:n}=e;switch(t.type){case"NGPipeExpression":if("arguments"===n&&e.isLast)return e.callParent(Js);break;case"ObjectProperty":if("value"===n)return e.callParent((()=>"properties"===e.key&&e.isLast));break;case"BinaryExpression":case"LogicalExpression":if("right"===n)return e.callParent(Js);break;case"ConditionalExpression":if("alternate"===n)return e.callParent(Js);break;case"UnaryExpression":if(t.prefix)return e.callParent(Js)}return!1}function js(e,t){let{node:n,parent:i}=e;return"FunctionExpression"===n.type||"ClassExpression"===n.type?"ExportDefaultDeclaration"===i.type||!zs(e,t):!(!Se(n)||"ExportDefaultDeclaration"!==i.type&&zs(e,t))&&e.call((()=>js(e,t)),...Ze(n))}function qs(e){let{node:t,parent:n,grandparent:i,key:r}=e;return!!(("OptionalMemberExpression"===t.type||"OptionalCallExpression"===t.type)&&("object"===r&&"MemberExpression"===n.type||"callee"===r&&("CallExpression"===n.type||"NewExpression"===n.type)||"TSNonNullExpression"===n.type&&"MemberExpression"===i.type&&i.object===n)||e.match((()=>"CallExpression"===t.type||"MemberExpression"===t.type),((e,t)=>"expression"===t&&"ChainExpression"===e.type))&&(e.match(void 0,void 0,((e,t)=>"callee"===t&&("CallExpression"===e.type&&!e.optional||"NewExpression"===e.type)||"object"===t&&"MemberExpression"===e.type&&!e.optional))||e.match(void 0,void 0,((e,t)=>"expression"===t&&"TSNonNullExpression"===e.type),((e,t)=>"object"===t&&"MemberExpression"===e.type)))||e.match((()=>"CallExpression"===t.type||"MemberExpression"===t.type),((e,t)=>"expression"===t&&"TSNonNullExpression"===e.type),((e,t)=>"expression"===t&&"ChainExpression"===e.type),((e,t)=>"object"===t&&"MemberExpression"===e.type)))}function $s(e){return"Identifier"===e.type||!!ot(e)&&!e.computed&&!e.optional&&"Identifier"===e.property.type&&$s(e.object)}function eo(e){return"ChainExpression"===e.type&&(e=e.expression),$s(e)||st(e)&&!e.optional&&$s(e.callee)}var to=zs;function no(e,t){let n=t-1;return n=T(e,n,{backwards:!0}),n=Q(e,n,{backwards:!0}),n=T(e,n,{backwards:!0}),n!==Q(e,n,{backwards:!0})}var io=no,ro=()=>!0;function so(e,t){return e.node.printed=!0,t.printer.printComment(e,t)}function oo(e,t){var n;let i=e.node,r=[so(e,t)],{printer:s,originalText:o,locStart:a,locEnd:l}=t;if(null==(n=s.isBlockComment)?void 0:n.call(s,i)){let e=X(o,l(i))?X(o,a(i),{backwards:!0})?Yn:Kn:" ";r.push(e)}else r.push(Yn);let c=Q(o,T(o,l(i)));return!1!==c&&X(o,c)&&r.push(Yn),r}function ao(e,t,n){var i;let r=e.node,s=so(e,t),{printer:o,originalText:a,locStart:l}=t,c=null==(i=o.isBlockComment)?void 0:i.call(o,r);if(null!=n&&n.hasLineSuffix&&(null==n||!n.isBlock)||X(a,l(r),{backwards:!0})){let e=io(a,l(r));return{doc:Vn([Yn,e?Yn:"",s]),isBlock:c,hasLineSuffix:!0}}return!c||null!=n&&n.hasLineSuffix?{doc:[Vn([" ",s]),Hn],isBlock:c,hasLineSuffix:!0}:{doc:[" ",s],isBlock:c,hasLineSuffix:!1}}function lo(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{node:i}=e;if(!j(null==i?void 0:i.comments))return"";let{indent:r=!1,marker:s,filter:o=ro}=n,a=[];if(e.each((n=>{let{node:i}=n;i.leading||i.trailing||i.marker!==s||!o(i)||a.push(so(e,t))}),"comments"),0===a.length)return"";let l=Un(Yn,a);return r?Rn([Yn,l]):l}function co(e,t){let n=e.node;if(!n)return{};let i=t[Symbol.for("printedComments")];if(0===(n.comments||[]).filter((e=>!i.has(e))).length)return{leading:"",trailing:""};let r,s=[],o=[];return e.each((()=>{let n=e.node;if(null!=i&&i.has(n))return;let{leading:a,trailing:l}=n;a?s.push(oo(e,t)):l&&(r=ao(e,t,r),o.push(r.doc))}),"comments"),{leading:s,trailing:o}}function go(e,t,n){let{leading:i,trailing:r}=co(e,n);return i||r?ci(t,(e=>[i,e,r])):t}var uo=class extends Error{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"type";super("Unexpected ".concat(t," node ").concat(n,": ").concat(JSON.stringify(e[n]),".")),a(this,"name","UnexpectedNodeError"),this.node=e}},Ao=uo;function ho(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}var Io,po=class{constructor(e){I(this,Io),p(this,Io,new Set(e))}getLeadingWhitespaceCount(e){let t=h(this,Io),n=0;for(let i=0;i<e.length&&t.has(e.charAt(i));i++)n++;return n}getTrailingWhitespaceCount(e){let t=h(this,Io),n=0;for(let i=e.length-1;i>=0&&t.has(e.charAt(i));i--)n++;return n}getLeadingWhitespace(e){let t=this.getLeadingWhitespaceCount(e);return e.slice(0,t)}getTrailingWhitespace(e){let t=this.getTrailingWhitespaceCount(e);return e.slice(e.length-t)}hasLeadingWhitespace(e){return h(this,Io).has(e.charAt(0))}hasTrailingWhitespace(e){return h(this,Io).has(v(!1,e,-1))}trimStart(e){let t=this.getLeadingWhitespaceCount(e);return e.slice(t)}trimEnd(e){let t=this.getTrailingWhitespaceCount(e);return e.slice(0,e.length-t)}trim(e){return this.trimEnd(this.trimStart(e))}split(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="[".concat(ho([...h(this,Io)].join("")),"]+"),i=new RegExp(t?"(".concat(n,")"):n,"u");return e.split(i)}hasWhitespaceCharacter(e){let t=h(this,Io);return Array.prototype.some.call(e,(e=>t.has(e)))}hasNonWhitespaceCharacter(e){let t=h(this,Io);return Array.prototype.some.call(e,(e=>!t.has(e)))}isWhitespaceOnly(e){let t=h(this,Io);return Array.prototype.every.call(e,(e=>t.has(e)))}};Io=new WeakMap;var Co=new po(" \n\r\t"),mo=e=>""===e||e===Kn||e===Yn||e===Xn;function fo(e,t,n){var i,r,s;let{node:o}=e;if("JSXElement"===o.type&&ko(o))return[n("openingElement"),n("closingElement")];let a="JSXElement"===o.type?n("openingElement"):n("openingFragment"),l="JSXElement"===o.type?n("closingElement"):n("closingFragment");if(1===o.children.length&&"JSXExpressionContainer"===o.children[0].type&&("TemplateLiteral"===o.children[0].expression.type||"TaggedTemplateExpression"===o.children[0].expression.type))return[a,...e.map(n,"children"),l];o.children=o.children.map((e=>Vo(e)?{type:"JSXText",value:" ",raw:" "}:e));let c=o.children.some(Pe),g=o.children.filter((e=>"JSXExpressionContainer"===e.type)).length>1,u="JSXElement"===o.type&&o.openingElement.attributes.length>1,A=$n(a)||c||u||g,d="mdx"===e.parent.rootMarker,h=t.singleQuote?"{' '}":'{" "}',I=d?" ":kn([h,Xn]," "),p=yo(e,t,n,I,"fbt"===(null==(r=null==(i=o.openingElement)?void 0:i.name)?void 0:r.name)),C=o.children.some((e=>To(e)));for(let b=p.length-2;b>=0;b--){let e=""===p[b]&&""===p[b+1],t=p[b]===Yn&&""===p[b+1]&&p[b+2]===Yn,n=(p[b]===Xn||p[b]===Yn)&&""===p[b+1]&&p[b+2]===I,i=p[b]===I&&""===p[b+1]&&(p[b+2]===Xn||p[b+2]===Yn),r=p[b]===I&&""===p[b+1]&&p[b+2]===I,s=p[b]===Xn&&""===p[b+1]&&p[b+2]===Yn||p[b]===Yn&&""===p[b+1]&&p[b+2]===Xn;t&&C||e||n||r||s?p.splice(b,2):i&&p.splice(b+1,2)}for(;p.length>0&&mo(v(!1,p,-1));)p.pop();for(;p.length>1&&mo(p[0])&&mo(p[1]);)p.shift(),p.shift();let m=[];for(let[b,B]of p.entries()){if(B===I){if(1===b&&""===p[b-1]){if(2===p.length){m.push(h);continue}m.push([h,Yn]);continue}if(b===p.length-1){m.push(h);continue}if(""===p[b-1]&&p[b-2]===Yn){m.push(h);continue}}m.push(B),$n(B)&&(A=!0)}let f=C?Wn(m):Dn(m,{shouldBreak:!0});if("JSXText"===(null==(s=t.cursorNode)?void 0:s.type)&&o.children.includes(t.cursorNode)&&(f=[Pn,f,Pn]),d)return f;let y=Dn([a,Rn([Yn,f]),Yn,l]);return A?y:Mn([Dn([a,...p,l]),y])}function yo(e,t,n,i,r){let s=[];return e.each((e=>{let{node:t,next:o}=e;if("JSXText"===t.type){let e=ft(t);if(To(t)){let n,a=Co.split(e,!0);if(""===a[0]&&(s.push(""),a.shift(),/\n/u.test(a[0])?s.push(Bo(r,a[1],t,o)):s.push(i),a.shift()),""===v(!1,a,-1)&&(a.pop(),n=a.pop()),0===a.length)return;for(let[e,t]of a.entries())e%2===1?s.push(Kn):s.push(t);void 0!==n?/\n/u.test(n)?s.push(Bo(r,v(!1,s,-1),t,o)):s.push(i):s.push(bo(r,v(!1,s,-1),t,o))}else/\n/u.test(e)?e.match(/\n/gu).length>1&&s.push("",Yn):s.push("",i)}else{let e=n();if(s.push(e),o&&To(o)){let e=Co.trim(ft(o)),[n]=Co.split(e);s.push(bo(r,n,t,o))}else s.push(Yn)}}),"children"),s}function bo(e,t,n,i){return e?"":"JSXElement"===n.type&&!n.closingElement||"JSXElement"===(null==i?void 0:i.type)&&!i.closingElement?1===t.length?Xn:Yn:Xn}function Bo(e,t,n,i){return e?Yn:1===t.length?"JSXElement"===n.type&&!n.closingElement||"JSXElement"===(null==i?void 0:i.type)&&!i.closingElement?Yn:Xn:Yn}var vo=new Set(["ArrayExpression","TupleExpression","JSXAttribute","JSXElement","JSXExpressionContainer","JSXFragment","ExpressionStatement","CallExpression","OptionalCallExpression","ConditionalExpression","JsExpressionRoot"]);function wo(e,t,n){let{parent:i}=e;if(vo.has(i.type))return t;let r=e.match(void 0,(e=>"ArrowFunctionExpression"===e.type),st,(e=>"JSXExpressionContainer"===e.type)),s=to(e,n);return Dn([s?"":kn("("),Rn([Xn,t]),Xn,s?"":kn(")")],{shouldBreak:r})}function Go(e,t,n){let{node:i}=e,r=[];if(r.push(n("name")),i.value){let s;if(Ve(i.value)){let n=ft(i.value),r=b(!1,b(!1,n.slice(1,-1),"&apos;","'"),"&quot;",'"'),o=te(r,t.jsxSingleQuote);r='"'===o?b(!1,r,'"',"&quot;"):b(!1,r,"'","&apos;"),s=e.call((()=>go(e,oi(o+r+o),t)),"value")}else s=n("value");r.push("=",s)}return r}function Eo(e,t,n){let{node:i}=e,r=(e,t)=>"JSXEmptyExpression"===e.type||!Kt(e)&&(Ne(e)||Me(e)||"ArrowFunctionExpression"===e.type||"AwaitExpression"===e.type&&(r(e.argument,e)||"JSXElement"===e.argument.type)||st(e)||"ChainExpression"===e.type&&st(e.expression)||"FunctionExpression"===e.type||"TemplateLiteral"===e.type||"TaggedTemplateExpression"===e.type||"DoExpression"===e.type||Pe(t)&&("ConditionalExpression"===e.type||Je(e)));return r(i.expression,e.parent)?Dn(["{",n("expression"),Ln,"}"]):Dn(["{",Rn([Xn,n("expression")]),Xn,Ln,"}"])}function xo(e,t,n){var i,r;let{node:s}=e,o=Kt(s.name)||Kt(s.typeParameters)||Kt(s.typeArguments);if(s.selfClosing&&0===s.attributes.length&&!o)return["<",n("name"),s.typeArguments?n("typeArguments"):n("typeParameters")," />"];if(1===(null==(i=s.attributes)?void 0:i.length)&&Ve(s.attributes[0].value)&&!s.attributes[0].value.value.includes("\n")&&!o&&!Kt(s.attributes[0]))return Dn(["<",n("name"),s.typeArguments?n("typeArguments"):n("typeParameters")," ",...e.map(n,"attributes"),s.selfClosing?" />":">"]);let a=null==(r=s.attributes)?void 0:r.some((e=>Ve(e.value)&&e.value.value.includes("\n"))),l=t.singleAttributePerLine&&s.attributes.length>1?Yn:Kn;return Dn(["<",n("name"),s.typeArguments?n("typeArguments"):n("typeParameters"),Rn(e.map((()=>[l,n()]),"attributes")),...So(s,t,o)],{shouldBreak:a})}function So(e,t,n){return e.selfClosing?[Kn,"/>"]:Ro(e,t,n)?[">"]:[Xn,">"]}function Ro(e,t,n){let i=e.attributes.length>0&&Kt(v(!1,e.attributes,-1),Ht.Trailing);return 0===e.attributes.length&&!n||(t.bracketSameLine||t.jsxBracketSameLine)&&(!n||e.attributes.length>0)&&!i}function Zo(e,t,n){let{node:i}=e,r=[];r.push("</");let s=n("name");return Kt(i.name,Ht.Leading|Ht.Line)?r.push(Rn([Yn,s]),Yn):Kt(i.name,Ht.Leading|Ht.Block)?r.push(" ",s):r.push(s),r.push(">"),r}function Do(e,t){let{node:n}=e,i=Kt(n),r=Kt(n,Ht.Line),s="JSXOpeningFragment"===n.type;return[s?"<":"</",Rn([r?Yn:i&&!s?" ":"",lo(e,t)]),r?Yn:"",">"]}function Fo(e,t,n){return wo(e,go(e,fo(e,t,n),t),t)}function No(e,t){let{node:n}=e,i=Kt(n,Ht.Line);return[lo(e,t,{indent:i}),i?Yn:""]}function Mo(e,t,n){let{node:i}=e;return["{",e.call((i=>{let{node:r}=i,s=["...",n()];return Kt(r)&&fr(e)?[Rn([Xn,go(e,s,t)]),Xn]:s}),"JSXSpreadAttribute"===i.type?"argument":"expression"),"}"]}function Wo(e,t,n){let{node:i}=e;if(i.type.startsWith("JSX"))switch(i.type){case"JSXAttribute":return Go(e,t,n);case"JSXIdentifier":return i.name;case"JSXNamespacedName":return Un(":",[n("namespace"),n("name")]);case"JSXMemberExpression":return Un(".",[n("object"),n("property")]);case"JSXSpreadAttribute":case"JSXSpreadChild":return Mo(e,t,n);case"JSXExpressionContainer":return Eo(e,t,n);case"JSXFragment":case"JSXElement":return Fo(e,t,n);case"JSXOpeningElement":return xo(e,t,n);case"JSXClosingElement":return Zo(e,t,n);case"JSXOpeningFragment":case"JSXClosingFragment":return Do(e,t);case"JSXEmptyExpression":return No(e,t);case"JSXText":throw new Error("JSXText should be handled by JSXElement");default:throw new Ao(i,"JSX")}}function ko(e){if(0===e.children.length)return!0;if(e.children.length>1)return!1;let t=e.children[0];return"JSXText"===t.type&&!To(t)}function To(e){return"JSXText"===e.type&&(Co.hasNonWhitespaceCharacter(ft(e))||!/\n/u.test(ft(e)))}function Vo(e){return"JSXExpressionContainer"===e.type&&Ve(e.expression)&&" "===e.expression.value&&!Kt(e.expression)}function Lo(e){let{node:t,parent:n}=e;if(!Pe(t)||!Pe(n))return!1;let i,{index:r,siblings:s}=e;for(let o=r;o>0;o--){let e=s[o-1];if("JSXText"!==e.type||To(e)){i=e;break}}return"JSXExpressionContainer"===(null==i?void 0:i.type)&&"JSXEmptyExpression"===i.expression.type&&Lt(i.expression)}function Ho(e){return Lt(e.node)||Lo(e)}var Qo=Ho,Ko=0;function Xo(e,t,n){var i;let{node:r,parent:s,grandparent:o,key:a}=e,l="body"!==a&&("IfStatement"===s.type||"WhileStatement"===s.type||"SwitchStatement"===s.type||"DoWhileStatement"===s.type),c="|>"===r.operator&&(null==(i=e.root.extra)?void 0:i.__isUsingHackPipeline),g=Yo(e,n,t,!1,l);if(l)return g;if(c)return Dn(g);if(st(s)&&s.callee===r||"UnaryExpression"===s.type||ot(s)&&!s.computed)return Dn([Rn([Xn,...g]),Xn]);let u="ReturnStatement"===s.type||"ThrowStatement"===s.type||"JSXExpressionContainer"===s.type&&"JSXAttribute"===o.type||"|"!==r.operator&&"JsExpressionRoot"===s.type||"NGPipeExpression"!==r.type&&("NGRoot"===s.type&&"__ng_binding"===t.parser||"NGMicrosyntaxExpression"===s.type&&"NGMicrosyntax"===o.type&&1===o.body.length)||r===s.body&&"ArrowFunctionExpression"===s.type||r!==s.body&&"ForStatement"===s.type||"ConditionalExpression"===s.type&&"ReturnStatement"!==o.type&&"ThrowStatement"!==o.type&&!st(o)||"TemplateLiteral"===s.type,A="AssignmentExpression"===s.type||"VariableDeclarator"===s.type||"ClassProperty"===s.type||"PropertyDefinition"===s.type||"TSAbstractPropertyDefinition"===s.type||"ClassPrivateProperty"===s.type||Pt(s),d=Je(r.left)&&Et(r.operator,r.left.operator);if(u||zo(r)&&!d||!zo(r)&&A)return Dn(g);if(0===g.length)return"";let h=Pe(r.right),I=g.findIndex((e=>"string"!=typeof e&&!Array.isArray(e)&&e.type===an)),p=g.slice(0,-1===I?1:I+1),C=g.slice(p.length,h?-1:void 0),m=Symbol("logicalChain-"+ ++Ko),f=Dn([...p,Rn(C)],{id:m});return h?Dn([f,Tn(v(!1,g,-1),{groupId:m})]):f}function Yo(e,t,n,i,r){var s;let{node:o}=e;if(!Je(o))return[Dn(t())];let a=[];Et(o.operator,o.left.operator)?a=e.call((e=>Yo(e,t,n,!0,r)),"left"):a.push(Dn(t("left")));let l,c=zo(o),g=("|>"===o.operator||"NGPipeExpression"===o.type||Uo(e,n))&&!ut(n.originalText,o.right),u="NGPipeExpression"===o.type?"|":o.operator,A="NGPipeExpression"===o.type&&o.arguments.length>0?Dn(Rn([Xn,": ",Un([Kn,": "],e.map((()=>Zn(2,Dn(t()))),"arguments"))])):"";if(c)l=[u," ",t("right"),A];else{let i="|>"===u&&(null==(s=e.root.extra)?void 0:s.__isUsingHackPipeline)?e.call((e=>Yo(e,t,n,!0,r)),"right"):t("right");l=[g?Kn:"",u,g?" ":Kn,i,A]}let{parent:d}=e,h=Kt(o.left,Ht.Trailing|Ht.Line),I=h||!(r&&"LogicalExpression"===o.type)&&d.type!==o.type&&o.left.type!==o.type&&o.right.type!==o.type;if(a.push(g?"":" ",I?Dn(l,{shouldBreak:h}):l),i&&Kt(o)){let t=si(go(e,a,n));return t.type===ln?t.parts:Array.isArray(t)?t:[t]}return a}function zo(e){return"LogicalExpression"===e.type&&!!(Me(e.right)&&e.right.properties.length>0||Ne(e.right)&&e.right.elements.length>0||Pe(e.right))}var Po=e=>"BinaryExpression"===e.type&&"|"===e.operator;function Uo(e,t){return("__vue_expression"===t.parser||"__vue_ts_expression"===t.parser)&&Po(e.node)&&!e.hasAncestor((e=>!Po(e)&&"JsExpressionRoot"!==e.type))}function _o(e,t,n){let{node:i}=e;if(i.type.startsWith("NG"))switch(i.type){case"NGRoot":return[n("node"),Kt(i.node)?" //"+Xt(i.node)[0].value.trimEnd():""];case"NGPipeExpression":return Xo(e,t,n);case"NGChainedExpression":return Dn(Un([";",Kn],e.map((()=>jo(e)?n():["(",n(),")"]),"expressions")));case"NGEmptyExpression":return"";case"NGMicrosyntax":return e.map((()=>[e.isFirst?"":Oo(e)?" ":[";",Kn],n()]),"body");case"NGMicrosyntaxKey":return/^[$_a-z][\w$]*(?:-[$_a-z][\w$])*$/iu.test(i.name)?i.name:JSON.stringify(i.name);case"NGMicrosyntaxExpression":return[n("expression"),null===i.alias?"":[" as ",n("alias")]];case"NGMicrosyntaxKeyedExpression":{let{index:t,parent:r}=e,s=Oo(e)||(1===t&&("then"===i.key.name||"else"===i.key.name||"as"===i.key.name)||(2===t||3===t)&&("else"===i.key.name&&"NGMicrosyntaxKeyedExpression"===r.body[t-1].type&&"then"===r.body[t-1].key.name||"track"===i.key.name))&&"NGMicrosyntaxExpression"===r.body[0].type;return[n("key"),s?" ":": ",n("expression")]}case"NGMicrosyntaxLet":return["let ",n("key"),null===i.value?"":[" = ",n("value")]];case"NGMicrosyntaxAs":return[n("key")," as ",n("alias")];default:throw new Ao(i,"Angular")}}function Oo(e){let{node:t,index:n}=e;return"NGMicrosyntaxKeyedExpression"===t.type&&"of"===t.key.name&&1===n}var Jo=fe(["CallExpression","OptionalCallExpression","AssignmentExpression"]);function jo(e){let{node:t}=e;return xe(t,Jo)}function qo(e,t,n){let{node:i}=e;return Dn([Un(Kn,e.map(n,"decorators")),ta(i,t)?Yn:Kn])}function $o(e,t,n){return na(e.node)?[Un(Yn,e.map(n,"declaration","decorators")),Yn]:""}function ea(e,t,n){let{node:i,parent:r}=e,{decorators:s}=i;if(!j(s)||na(r)||Qo(e))return"";let o="ClassExpression"===i.type||"ClassDeclaration"===i.type||ta(i,t);return["declaration"===e.key&&Fe(r)?Yn:o?Hn:"",Un(Kn,e.map(n,"decorators")),Kn]}function ta(e,t){return e.decorators.some((e=>X(t.originalText,ae(e))))}function na(e){var t;if("ExportDefaultDeclaration"!==e.type&&"ExportNamedDeclaration"!==e.type&&"DeclareExportDeclaration"!==e.type)return!1;let n=null==(t=e.declaration)?void 0:t.decorators;return j(n)&&le(e,n[0])}var ia=class extends Error{constructor(){super(...arguments),a(this,"name","ArgExpansionBailout")}};function ra(e,t,n){let{node:i}=e,r=Wt(i);if(0===r.length)return["(",lo(e,t),")"];let s=r.length-1;if(ca(r)){let t=["("];return kt(e,((e,i)=>{t.push(n()),i!==s&&t.push(", ")})),t.push(")"),t}let o=!1,a=[];kt(e,((e,i)=>{let{node:r}=e,l=n();i===s||(Yt(r,t)?(o=!0,l=[l,",",Yn,Yn]):l=[l,",",Kn]),a.push(l)}));let l="ImportExpression"===i.type||"Import"===i.callee.type,c=t.parser.startsWith("__ng_")||l||!bt(t,"all")?"":",";function g(){return Dn(["(",Rn([Kn,...a]),c,Kn,")"],{shouldBreak:!0})}if(o||"Decorator"!==e.parent.type&&It(r))return g();if(aa(r)){let e,t=a.slice(1);if(t.some($n))return g();try{e=n(Tt(i,0),{expandFirstArg:!0})}catch(A){if(A instanceof ia)return g();throw A}return $n(e)?[Hn,Mn([["(",Dn(e,{shouldBreak:!0}),", ",...t,")"],g()])]:Mn([["(",e,", ",...t,")"],["(",Dn(e,{shouldBreak:!0}),", ",...t,")"],g()])}if(oa(r,a,t)){let e,t=a.slice(0,-1);if(t.some($n))return g();try{e=n(Tt(i,-1),{expandLastArg:!0})}catch(A){if(A instanceof ia)return g();throw A}return $n(e)?[Hn,Mn([["(",...t,Dn(e,{shouldBreak:!0}),")"],g()])]:Mn([["(",...t,e,")"],["(",...t,Dn(e,{shouldBreak:!0}),")"],g()])}let u=["(",Rn([Xn,...a]),kn(c),Xn,")"];return pt(e)?u:Dn(u,{shouldBreak:a.some($n)||o})}function sa(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Me(e)&&(e.properties.length>0||Kt(e))||Ne(e)&&(e.elements.length>0||Kt(e))||"TSTypeAssertion"===e.type&&sa(e.expression)||Ut(e)&&sa(e.expression)||"FunctionExpression"===e.type||"ArrowFunctionExpression"===e.type&&(!e.returnType||!e.returnType.typeAnnotation||"TSTypeReference"!==e.returnType.typeAnnotation.type||ua(e.body))&&("BlockStatement"===e.body.type||"ArrowFunctionExpression"===e.body.type&&sa(e.body,!0)||Me(e.body)||Ne(e.body)||!t&&(st(e.body)||"ConditionalExpression"===e.body.type)||Pe(e.body))||"DoExpression"===e.type||"ModuleExpression"===e.type}function oa(e,t,n){var i,r;let s=v(!1,e,-1);if(1===e.length){let e=v(!1,t,-1);if(null!=(i=e.label)&&i.embed&&!1!==(null==(r=e.label)?void 0:r.hug))return!0}let o=v(!1,e,-2);return!Kt(s,Ht.Leading)&&!Kt(s,Ht.Trailing)&&sa(s)&&(!o||o.type!==s.type)&&(2!==e.length||"ArrowFunctionExpression"!==o.type||!Ne(s))&&!(e.length>1&&Rl(s,n))}function aa(e){if(2!==e.length)return!1;let[t,n]=e;return!("ModuleExpression"!==t.type||!Aa(n))||!Kt(t)&&("FunctionExpression"===t.type||"ArrowFunctionExpression"===t.type&&"BlockStatement"===t.body.type)&&"FunctionExpression"!==n.type&&"ArrowFunctionExpression"!==n.type&&"ConditionalExpression"!==n.type&&la(n)&&!sa(n)}function la(e){if("ParenthesizedExpression"===e.type)return la(e.expression);if(Ut(e)||"TypeCastExpression"===e.type){let{typeAnnotation:n}=e;if("TypeAnnotation"===n.type&&(n=n.typeAnnotation),"TSArrayType"===n.type&&(n=n.elementType,"TSArrayType"===n.type&&(n=n.elementType)),"GenericTypeAnnotation"===n.type||"TSTypeReference"===n.type){var t;let e=null!==(t=n.typeArguments)&&void 0!==t?t:n.typeParameters;1===(null==e?void 0:e.params.length)&&(n=e.params[0])}return $e(n)&&mt(e.expression,1)}return!(zt(e)&&Wt(e).length>1)&&(Je(e)?mt(e.left,1)&&mt(e.right,1):Le(e)||mt(e))}function ca(e){return 2===e.length?ga(e,0):3===e.length&&"Identifier"===e[0].type&&ga(e,1)}function ga(e,t){let n=e[t],i=e[t+1];return"ArrowFunctionExpression"===n.type&&0===Ft(n).length&&"BlockStatement"===n.body.type&&"ArrayExpression"===i.type&&!e.some((e=>Kt(e)))}function ua(e){return"BlockStatement"===e.type&&(e.body.some((e=>"EmptyStatement"!==e.type))||Kt(e,Ht.Dangling))}function Aa(e){return"ObjectExpression"===e.type&&1===e.properties.length&&Pt(e.properties[0])&&"Identifier"===e.properties[0].key.type&&"type"===e.properties[0].key.name&&Ve(e.properties[0].value)&&"module"===e.properties[0].value.value}var da=ra,ha=e=>(("ChainExpression"===e.type||"TSNonNullExpression"===e.type)&&(e=e.expression),st(e)&&Wt(e).length>0);function Ia(e,t,n){var i;let r=n("object"),s=pa(e,t,n),{node:o}=e,a=e.findAncestor((e=>!(ot(e)||"TSNonNullExpression"===e.type))),l=e.findAncestor((e=>!("ChainExpression"===e.type||"TSNonNullExpression"===e.type))),c=a&&("NewExpression"===a.type||"BindExpression"===a.type||"AssignmentExpression"===a.type&&"Identifier"!==a.left.type)||o.computed||"Identifier"===o.object.type&&"Identifier"===o.property.type&&!ot(l)||("AssignmentExpression"===l.type||"VariableDeclarator"===l.type)&&(ha(o.object)||(null==(i=r.label)?void 0:i.memberChain));return On(r.label,[r,c?s:Dn(Rn([Xn,s]))])}function pa(e,t,n){let i=n("property"),{node:r}=e,s=pl(e);return r.computed?!r.property||ke(r.property)?[s,"[",i,"]"]:Dn([s,"[",Rn([Xn,i]),Xn,"]"]):[s,".",i]}function Ca(e,t,n){if("ChainExpression"===e.node.type)return e.call((()=>Ca(e,t,n)),"expression");let{parent:i}=e,r=!i||"ExpressionStatement"===i.type,s=[];function o(e){let{originalText:n}=t,i=bi(n,ae(e));return")"===n.charAt(i)?!1!==i&&O(n,i+1):Yt(e,t)}function a(e){let{node:i}=e;if("ChainExpression"===i.type)return e.call((()=>a(e)),"expression");if(st(i)&&(je(i.callee)||st(i.callee))){let r=o(i);s.unshift({node:i,hasTrailingEmptyLine:r,printed:[go(e,[pl(e),Bl(e,t,n),da(e,t,n)],t),r?Yn:""]}),e.call((e=>a(e)),"callee")}else je(i)?(s.unshift({node:i,needsParens:to(e,t),printed:go(e,ot(i)?pa(e,t,n):vl(e,t,n),t)}),e.call((e=>a(e)),"object")):"TSNonNullExpression"===i.type?(s.unshift({node:i,printed:go(e,"!",t)}),e.call((e=>a(e)),"expression")):s.unshift({node:i,printed:n()})}let{node:l}=e;s.unshift({node:l,printed:[pl(e),Bl(e,t,n),da(e,t,n)]}),l.callee&&e.call((e=>a(e)),"callee");let c=[],g=[s[0]],u=1;for(;u<s.length&&("TSNonNullExpression"===s[u].node.type||st(s[u].node)||ot(s[u].node)&&s[u].node.computed&&ke(s[u].node.property));++u)g.push(s[u]);if(!st(s[0].node))for(;u+1<s.length&&je(s[u].node)&&je(s[u+1].node);++u)g.push(s[u]);c.push(g),g=[];let A=!1;for(;u<s.length;++u){if(A&&je(s[u].node)){if(s[u].node.computed&&ke(s[u].node.property)){g.push(s[u]);continue}c.push(g),g=[],A=!1}(st(s[u].node)||"ImportExpression"===s[u].node.type)&&(A=!0),g.push(s[u]),Kt(s[u].node,Ht.Trailing)&&(c.push(g),g=[],A=!1)}function d(e){return/^[A-Z]|^[$_]+$/u.test(e)}function h(e){return e.length<=t.tabWidth}function I(e){var t;let n=null==(t=e[1][0])?void 0:t.node.computed;if(1===e[0].length){let t=e[0][0].node;return"ThisExpression"===t.type||"Identifier"===t.type&&(d(t.name)||r&&h(t.name)||n)}let i=v(!1,e[0],-1).node;return ot(i)&&"Identifier"===i.property.type&&(d(i.property.name)||n)}g.length>0&&c.push(g);let p=c.length>=2&&!Kt(c[1][0].node)&&I(c);function C(e){let t=e.map((e=>e.printed));return e.length>0&&v(!1,e,-1).needsParens?["(",...t,")"]:t}function m(e){return 0===e.length?"":Rn([Yn,Un(Yn,e.map(C))])}let f=c.map(C),y=f,b=p?3:2,B=c.flat(),w=B.slice(1,-1).some((e=>Kt(e.node,Ht.Leading)))||B.slice(0,-1).some((e=>Kt(e.node,Ht.Trailing)))||c[b]&&Kt(c[b][0].node,Ht.Leading);if(c.length<=b&&!w&&!c.some((e=>v(!1,e,-1).hasTrailingEmptyLine)))return pt(e)?y:Dn(y);let G,E=v(!1,c[p?1:0],-1).node,x=!st(E)&&o(E),S=[C(c[0]),p?c.slice(1,2).map(C):"",x?Yn:"",m(c.slice(p?2:1))],R=s.map((e=>{let{node:t}=e;return t})).filter(st);function Z(){let e=v(!1,v(!1,c,-1),-1).node,t=v(!1,f,-1);return st(e)&&$n(t)&&R.slice(0,-1).some((e=>e.arguments.some(Xe)))}return G=w||R.length>2&&R.some((e=>!e.arguments.every((e=>mt(e)))))||f.slice(0,-1).some($n)||Z()?Dn(S):[$n(y)||x?Hn:"",Mn([y,S])],On({memberChain:!0},G)}var ma=Ca;function fa(e,t,n){var i;let{node:r}=e,s="NewExpression"===r.type,o="ImportExpression"===r.type,a=pl(e),l=Wt(r),c=1===l.length&&dt(l[0],t.originalText);if(c||ba(e)||it(r,e.parent)){let r=[];if(kt(e,(()=>{r.push(n())})),!c||null==(i=r[0].label)||!i.embed)return[s?"new ":"",ya(e,n),a,Bl(e,t,n),"(",Un(", ",r),")"]}if(!o&&!s&&je(r.callee)&&!e.call((e=>to(e,t)),"callee",..."ChainExpression"===r.callee.type?["expression"]:[]))return ma(e,t,n);let g=[s?"new ":"",ya(e,n),a,Bl(e,t,n),da(e,t,n)];return o||st(r.callee)?Dn(g):g}function ya(e,t){let{node:n}=e;return"ImportExpression"===n.type?"import".concat(n.phase?".".concat(n.phase):""):t("callee")}function ba(e){let{node:t}=e;if("CallExpression"!==t.type||t.optional||"Identifier"!==t.callee.type)return!1;let n=Wt(t);return"require"===t.callee.name?1===n.length&&Ve(n[0])||n.length>1:"define"===t.callee.name&&"ExpressionStatement"===e.parent.type&&(1===n.length||2===n.length&&"ArrayExpression"===n[0].type||3===n.length&&Ve(n[0])&&"ArrayExpression"===n[1].type)}function Ba(e,t,n,i,r,s){let o=Ga(e,t,n,i,s),a=s?n(s,{assignmentLayout:o}):"";switch(o){case"break-after-operator":return Dn([Dn(i),r,Dn(Rn([Kn,a]))]);case"never-break-after-operator":return Dn([Dn(i),r," ",a]);case"fluid":{let e=Symbol("assignment");return Dn([Dn(i),r,Dn(Rn(Kn),{id:e}),Ln,Tn(a,{groupId:e})])}case"break-lhs":return Dn([i,r," ",Dn(a)]);case"chain":return[Dn(i),r,Kn,a];case"chain-tail":return[Dn(i),r,Rn([Kn,a])];case"chain-tail-arrow-chain":return[Dn(i),r,a];case"only-left":return i}}function va(e,t,n){let{node:i}=e;return Ba(e,t,n,n("left"),[" ",i.operator],"right")}function wa(e,t,n){return Ba(e,t,n,n("id")," =","init")}function Ga(e,t,n,i,r){let{node:s}=e,o=s[r];if(!o)return"only-left";let a=!Sa(o);if(e.match(Sa,Ra,(e=>!a||"ExpressionStatement"!==e.type&&"VariableDeclaration"!==e.type)))return a?"ArrowFunctionExpression"===o.type&&"ArrowFunctionExpression"===o.body.type?"chain-tail-arrow-chain":"chain-tail":"chain";if(!a&&Sa(o.right)||ut(t.originalText,o))return"break-after-operator";if("ImportAttribute"===s.type||"CallExpression"===o.type&&"require"===o.callee.name||"json5"===t.parser||"jsonc"===t.parser||"json"===t.parser)return"never-break-after-operator";let l=li(i);if(xa(s)||Na(s)||Ma(s)&&l)return"break-lhs";let c=Va(s,i,t);return e.call((()=>Ea(e,t,n,c)),r)?"break-after-operator":Za(s)?"break-lhs":l||!c&&"TemplateLiteral"!==o.type&&"TaggedTemplateExpression"!==o.type&&"BooleanLiteral"!==o.type&&!ke(o)&&"ClassExpression"!==o.type?"fluid":"never-break-after-operator"}function Ea(e,t,n,i){let r=e.node;if(Je(r)&&!zo(r))return!0;switch(r.type){case"StringLiteralTypeAnnotation":case"SequenceExpression":return!0;case"TSConditionalType":case"ConditionalTypeAnnotation":if(!t.experimentalTernaries&&!Qa(r))break;return!0;case"ConditionalExpression":{if(!t.experimentalTernaries){let{test:e}=r;return Je(e)&&!zo(e)}let{consequent:e,alternate:n}=r;return"ConditionalExpression"===e.type||"ConditionalExpression"===n.type}case"ClassExpression":return j(r.decorators)}if(i)return!1;let s=r,o=[];for(;;)if("UnaryExpression"===s.type||"AwaitExpression"===s.type||"YieldExpression"===s.type&&null!==s.argument)s=s.argument,o.push("argument");else{if("TSNonNullExpression"!==s.type)break;s=s.expression,o.push("expression")}return!(!Ve(s)&&!e.call((()=>Ta(e,t,n)),...o))}function xa(e){if(Ra(e)){let t=e.left||e.id;return"ObjectPattern"===t.type&&t.properties.length>2&&t.properties.some((e=>{var t;return Pt(e)&&(!e.shorthand||"AssignmentPattern"===(null==(t=e.value)?void 0:t.type))}))}return!1}function Sa(e){return"AssignmentExpression"===e.type}function Ra(e){return Sa(e)||"VariableDeclarator"===e.type}function Za(e){let t=Fa(e);if(j(t)){let n="TSTypeAliasDeclaration"===e.type?"constraint":"bound";if(t.length>1&&t.some((e=>e[n]||e.default)))return!0}return!1}var Da=fe(["TSTypeAliasDeclaration","TypeAlias"]);function Fa(e){var t;if(Da(e))return null==(t=e.typeParameters)?void 0:t.params}function Na(e){if("VariableDeclarator"!==e.type)return!1;let{typeAnnotation:t}=e.id;if(!t||!t.typeAnnotation)return!1;let n=ka(t.typeAnnotation);return j(n)&&n.length>1&&n.some((e=>j(ka(e))||"TSConditionalType"===e.type))}function Ma(e){var t;return"VariableDeclarator"===e.type&&"ArrowFunctionExpression"===(null==(t=e.init)?void 0:t.type)}var Wa=fe(["TSTypeReference","GenericTypeAnnotation"]);function ka(e){var t,n;if(Wa(e))return null==(n=null!==(t=e.typeArguments)&&void 0!==t?t:e.typeParameters)?void 0:n.params}function Ta(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];var r;let{node:s}=e,o=()=>Ta(e,t,n,!0);if("ChainExpression"===s.type||"TSNonNullExpression"===s.type)return e.call(o,"expression");if(st(s)){if(null!=(r=fa(e,t,n).label)&&r.memberChain)return!1;let i=Wt(s);return!(!(0===i.length||1===i.length&&gt(i[0],t))||La(s,n))&&e.call(o,"callee")}return ot(s)?e.call(o,"object"):i&&("Identifier"===s.type||"ThisExpression"===s.type)}function Va(e,t,n){return!!Pt(e)&&"string"==typeof(t=si(t))&&W(t)<n.tabWidth+3}function La(e,t){let n=Ha(e);if(j(n)){if(n.length>1)return!0;if(1===n.length){let e=n[0];if(_t(e)||Ot(e)||"TSTypeLiteral"===e.type||"ObjectTypeAnnotation"===e.type)return!0}if($n(t(e.typeParameters?"typeParameters":"typeArguments")))return!0}return!1}function Ha(e){var t,n;return null==(n=null!==(t=e.typeParameters)&&void 0!==t?t:e.typeArguments)?void 0:n.params}function Qa(e){function t(e){var t;switch(e.type){case"FunctionTypeAnnotation":case"GenericTypeAnnotation":case"TSFunctionType":return!!e.typeParameters;case"TSTypeReference":return!!(null!==(t=e.typeArguments)&&void 0!==t?t:e.typeParameters);default:return!1}}return t(e.checkType)||t(e.extendsType)}function Ka(e,t,n,i,r){let s=e.node,o=Ft(s),a=r?Bl(e,n,t):"";if(0===o.length)return[a,"(",lo(e,n,{filter:e=>")"===vi(n.originalText,ae(e))}),")"];let{parent:l}=e,c=it(l),g=Xa(s),u=[];if(Nt(e,((e,i)=>{let r=i===o.length-1;r&&s.rest&&u.push("..."),u.push(t()),!r&&(u.push(","),c||g?u.push(" "):Yt(o[i],n)?u.push(Yn,Yn):u.push(Kn))})),i&&!Pa(e)){if($n(a)||$n(u))throw new ia;return Dn([ii(a),"(",ii(u),")"])}let A=o.every((e=>!j(e.decorators)));return g&&A||c?[a,"(",...u,")"]:(_e(l)||Oe(l)||"TypeAlias"===l.type||"UnionTypeAnnotation"===l.type||"IntersectionTypeAnnotation"===l.type||"FunctionTypeAnnotation"===l.type&&l.returnType===s)&&1===o.length&&null===o[0].name&&s.this!==o[0]&&o[0].typeAnnotation&&null===s.typeParameters&&$e(o[0].typeAnnotation)&&!s.rest?"always"===n.arrowParens||"HookTypeAnnotation"===s.type?["(",...u,")"]:u:[a,"(",Rn([Xn,...u]),kn(!Zt(s)&&bt(n,"all")?",":""),Xn,")"]}function Xa(e){if(!e)return!1;let t=Ft(e);if(1!==t.length)return!1;let[n]=t;return!Kt(n)&&("ObjectPattern"===n.type||"ArrayPattern"===n.type||"Identifier"===n.type&&n.typeAnnotation&&("TypeAnnotation"===n.typeAnnotation.type||"TSTypeAnnotation"===n.typeAnnotation.type)&&Ke(n.typeAnnotation.typeAnnotation)||"FunctionTypeParam"===n.type&&Ke(n.typeAnnotation)&&n!==e.rest||"AssignmentPattern"===n.type&&("ObjectPattern"===n.left.type||"ArrayPattern"===n.left.type)&&("Identifier"===n.right.type||Me(n.right)&&0===n.right.properties.length||Ne(n.right)&&0===n.right.elements.length))}function Ya(e){let t;return e.returnType?(t=e.returnType,t.typeAnnotation&&(t=t.typeAnnotation)):e.typeAnnotation&&(t=e.typeAnnotation),t}function za(e,t){var n;let i=Ya(e);if(!i)return!1;let r=null==(n=e.typeParameters)?void 0:n.params;if(r){if(r.length>1)return!1;if(1===r.length){let e=r[0];if(e.constraint||e.default)return!1}}return 1===Ft(e).length&&(Ke(i)||$n(t))}function Pa(e){return e.match((e=>"ArrowFunctionExpression"===e.type&&"BlockStatement"===e.body.type),((e,t)=>{if("CallExpression"===e.type&&"arguments"===t&&1===e.arguments.length&&"CallExpression"===e.callee.type){let t=e.callee.callee;return"Identifier"===t.type||"MemberExpression"===t.type&&!t.computed&&"Identifier"===t.object.type&&"Identifier"===t.property.type}return!1}),((e,t)=>"VariableDeclarator"===e.type&&"init"===t||"ExportDefaultDeclaration"===e.type&&"declaration"===t||"TSExportAssignment"===e.type&&"expression"===t||"AssignmentExpression"===e.type&&"right"===t&&"MemberExpression"===e.left.type&&"Identifier"===e.left.object.type&&"module"===e.left.object.name&&"Identifier"===e.left.property.type&&"exports"===e.left.property.name),(e=>"VariableDeclaration"!==e.type||"const"===e.kind&&1===e.declarations.length))}function Ua(e){let t=Ft(e);return t.length>1&&t.some((e=>"TSParameterProperty"===e.type))}var _a=fe(["VoidTypeAnnotation","TSVoidKeyword","NullLiteralTypeAnnotation","TSNullKeyword"]),Oa=fe(["ObjectTypeAnnotation","TSTypeLiteral","GenericTypeAnnotation","TSTypeReference"]);function Ja(e){let{types:t}=e;if(t.some((e=>Kt(e))))return!1;let n=t.find((e=>Oa(e)));return!!n&&t.every((e=>e===n||_a(e)))}function ja(e){return!(!$e(e)&&!Ke(e))||!!_t(e)&&Ja(e)}function qa(e,t,n){let i=t.semi?";":"",{node:r}=e,s=[fl(e),"opaque type ",n("id"),n("typeParameters")];return r.supertype&&s.push(": ",n("supertype")),r.impltype&&s.push(" = ",n("impltype")),s.push(i),s}function $a(e,t,n){let i=t.semi?";":"",{node:r}=e,s=[fl(e)];return s.push("type ",n("id"),n("typeParameters")),[Ba(e,t,n,s," =","TSTypeAliasDeclaration"===r.type?"typeAnnotation":"right"),i]}function el(e,t,n){let i=!1;return Dn(e.map((e=>{let{isFirst:t,previous:r,node:s,index:o}=e,a=n();if(t)return a;let l=Ke(s),c=Ke(r);return c&&l?[" & ",i?Rn(a):a]:c||l?(o>1&&(i=!0),[" & ",o>1?Rn(a):a]):Rn([" &",Kn,a])}),"types"))}function tl(e,t,n){let{node:i}=e,{parent:r}=e,s="TypeParameterInstantiation"!==r.type&&("TSConditionalType"!==r.type||!t.experimentalTernaries)&&("ConditionalTypeAnnotation"!==r.type||!t.experimentalTernaries)&&"TSTypeParameterInstantiation"!==r.type&&"GenericTypeAnnotation"!==r.type&&"TSTypeReference"!==r.type&&"TSTypeAssertion"!==r.type&&"TupleTypeAnnotation"!==r.type&&"TSTupleType"!==r.type&&!("FunctionTypeParam"===r.type&&!r.name&&e.grandparent.this!==r)&&!(("TypeAlias"===r.type||"VariableDeclarator"===r.type||"TSTypeAliasDeclaration"===r.type)&&ut(t.originalText,i)),o=ja(i),a=e.map((e=>{let i=n();return o||(i=Zn(2,i)),go(e,i,t)}),"types");if(o)return Un(" | ",a);let l=[kn([s&&!ut(t.originalText,i)?Kn:"","| "]),Un([Kn,"| "],a)];return to(e,t)?Dn([Rn(l),Xn]):("TupleTypeAnnotation"===r.type||"TSTupleType"===r.type)&&r["TupleTypeAnnotation"===r.type&&r.types?"types":"elementTypes"].length>1?Dn([Rn([kn(["(",Xn]),l]),Xn,kn(")")]):Dn(s?Rn(l):l)}function nl(e){var t;let{node:n,parent:i}=e;return"FunctionTypeAnnotation"===n.type&&(_e(i)||!(("ObjectTypeProperty"===i.type||"ObjectTypeInternalSlot"===i.type)&&!i.variance&&!i.optional&&le(i,n)||"ObjectTypeCallProperty"===i.type||"DeclareFunction"===(null==(t=e.getParentNode(2))?void 0:t.type)))}function il(e,t,n){let{node:i}=e,r=[bl(e)];("TSConstructorType"===i.type||"TSConstructSignatureDeclaration"===i.type)&&r.push("new ");let s=Ka(e,n,t,!1,!0),o=[];return"FunctionTypeAnnotation"===i.type?o.push(nl(e)?" => ":": ",n("returnType")):o.push(gl(e,n,i.returnType?"returnType":"typeAnnotation")),za(i,o)&&(s=Dn(s)),r.push(s,o),Dn(r)}function rl(e,t,n){return[n("objectType"),pl(e),"[",n("indexType"),"]"]}function sl(e,t,n){return["infer ",n("typeParameter")]}function ol(e,t,n){let{node:i}=e;return[i.postfix?"":n,gl(e,t),i.postfix?n:""]}function al(e,t,n){let{node:i}=e;return["...",..."TupleTypeSpreadElement"===i.type&&i.label?[n("label"),": "]:[],n("typeAnnotation")]}function ll(e,t,n){let{node:i}=e;return[i.variance?n("variance"):"",n("label"),i.optional?"?":"",": ",n("elementType")]}var cl=new WeakSet;function gl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"typeAnnotation",{node:{[n]:i}}=e;if(!i)return"";let r=!1;if("TSTypeAnnotation"===i.type||"TypeAnnotation"===i.type){let t=e.call(ul,n);("=>"===t||":"===t&&Kt(i,Ht.Leading))&&(r=!0),cl.add(i)}return r?[" ",t(n)]:t(n)}var ul=e=>e.match((e=>"TSTypeAnnotation"===e.type),((e,t)=>("returnType"===t||"typeAnnotation"===t)&&("TSFunctionType"===e.type||"TSConstructorType"===e.type)))?"=>":e.match((e=>"TSTypeAnnotation"===e.type),((e,t)=>"typeAnnotation"===t&&("TSJSDocNullableType"===e.type||"TSJSDocNonNullableType"===e.type||"TSTypePredicate"===e.type)))||e.match((e=>"TypeAnnotation"===e.type),((e,t)=>"typeAnnotation"===t&&"Identifier"===e.type),((e,t)=>"id"===t&&"DeclareFunction"===e.type))||e.match((e=>"TypeAnnotation"===e.type),((e,t)=>"typeAnnotation"===t&&"Identifier"===e.type),((e,t)=>"id"===t&&"DeclareHook"===e.type))||e.match((e=>"TypeAnnotation"===e.type),((e,t)=>"bound"===t&&"TypeParameter"===e.type&&e.usesExtendsBound))?"":":";function Al(e,t,n){let i=ul(e);return i?[i," ",n("typeAnnotation")]:n("typeAnnotation")}function dl(e){return[e("elementType"),"[]"]}function hl(e,t){let{node:n}=e,i="TSTypeQuery"===n.type?"exprName":"argument",r="TypeofTypeAnnotation"===n.type||n.typeArguments?"typeArguments":"typeParameters";return["typeof ",t(i),t(r)]}function Il(e,t){let{node:n}=e;return["TSTypePredicate"===n.type&&n.asserts?"asserts ":"TypePredicate"===n.type&&n.kind?"".concat(n.kind," "):"",t("parameterName"),n.typeAnnotation?[" is ",gl(e,t)]:""]}function pl(e){let{node:t}=e;return!t.optional||"Identifier"===t.type&&t===e.parent.key?"":st(t)||ot(t)&&t.computed||"OptionalIndexedAccessType"===t.type?"?.":"?"}function Cl(e){return e.node.definite||e.match(void 0,((e,t)=>"id"===t&&"VariableDeclarator"===e.type&&e.definite))?"!":""}var ml=new Set(["DeclareClass","DeclareComponent","DeclareFunction","DeclareHook","DeclareVariable","DeclareExportDeclaration","DeclareExportAllDeclaration","DeclareOpaqueType","DeclareTypeAlias","DeclareEnum","DeclareInterface"]);function fl(e){let{node:t}=e;return t.declare||ml.has(t.type)&&"DeclareExportDeclaration"!==e.parent.type?"declare ":""}var yl=new Set(["TSAbstractMethodDefinition","TSAbstractPropertyDefinition","TSAbstractAccessorProperty"]);function bl(e){let{node:t}=e;return t.abstract||yl.has(t.type)?"abstract ":""}function Bl(e,t,n){let i=e.node;return i.typeArguments?n("typeArguments"):i.typeParameters?n("typeParameters"):""}function vl(e,t,n){return["::",n("callee")]}function wl(e,t,n){return"EmptyStatement"===e.type?";":"BlockStatement"===e.type||n?[" ",t]:Rn([Kn,t])}function Gl(e,t){return["...",t("argument"),gl(e,t)]}function El(e){return e.accessibility?e.accessibility+" ":""}function xl(e,t,n,i){let{node:r}=e,s=r.inexact?"...":"";return Kt(r,Ht.Dangling)?Dn([n,s,lo(e,t,{indent:!0}),Xn,i]):[n,s,i]}function Sl(e,t,n){let{node:i}=e,r=[],s="TupleExpression"===i.type?"#[":"[",o="]",a="TupleTypeAnnotation"===i.type&&i.types?"types":"TSTupleType"===i.type||"TupleTypeAnnotation"===i.type?"elementTypes":"elements",l=i[a];if(0===l.length)r.push(xl(e,t,s,o));else{let c=v(!1,l,-1),g="RestElement"!==(null==c?void 0:c.type)&&!i.inexact,u=null===c,A=Symbol("array"),d=!t.__inJestEach&&l.length>1&&l.every(((e,t,n)=>{let i=null==e?void 0:e.type;if(!Ne(e)&&!Me(e))return!1;let r=n[t+1];if(r&&i!==r.type)return!1;let s=Ne(e)?"elements":"properties";return e[s]&&e[s].length>1})),h=Rl(i,t),I=g?u?",":bt(t)?h?kn(",","",{groupId:A}):kn(","):"":"";r.push(Dn([s,Rn([Xn,h?Fl(e,t,n,I):[Dl(e,t,a,i.inexact,n),I],lo(e,t)]),Xn,o],{shouldBreak:d,id:A}))}return r.push(pl(e),gl(e,n)),r}function Rl(e,t){return Ne(e)&&e.elements.length>1&&e.elements.every((e=>e&&(ke(e)||Te(e)&&!Kt(e.argument))&&!Kt(e,Ht.Trailing|Ht.Line,(e=>!X(t.originalText,oe(e),{backwards:!0})))))}function Zl(e,t){let{node:n}=e,{originalText:i}=t,r=e=>z(i,U(i,e)),s=e=>","===i[e]?e:s(r(e+1));return O(i,s(ae(n)))}function Dl(e,t,n,i,r){let s=[];return e.each((n=>{let{node:o,isLast:a}=n;s.push(o?Dn(r()):""),(!a||i)&&s.push([",",Kn,o&&Zl(e,t)?Xn:""])}),n),i&&s.push("..."),s}function Fl(e,t,n,i){let r=[];return e.each((s=>{let{isLast:o,next:a}=s;r.push([n(),o?i:","]),o||r.push(Zl(e,t)?[Yn,Yn]:Kt(a,Ht.Leading|Ht.Line)?Yn:Kn)}),"elements"),Wn(r)}var Nl=new Proxy((()=>{}),{get:()=>Nl}),Ml=Nl,Wl=/^[\$A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC][\$0-9A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]*$/,kl=e=>Wl.test(e),Tl=kl;function Vl(e){return 1===e.length?e:e.toLowerCase().replace(/^([+-]?[\d.]+e)(?:\+|(-))?0*(?=\d)/u,"$1$2").replace(/^([+-]?[\d.]+)e[+-]?0+$/u,"$1").replace(/^([+-])?\./u,"$10.").replace(/(\.\d+?)0+(?=e|$)/u,"$1").replace(/\.(?=e|$)/u,"")}var Ll=Vl,Hl=new WeakMap;function Ql(e){return/^(?:\d+|\d+\.\d+)$/u.test(e)}function Kl(e,t){return!("json"===t.parser||"jsonc"===t.parser||!Ve(e.key)||se(ft(e.key),t).slice(1,-1)!==e.key.value)&&!!(Tl(e.key.value)&&!("babel-ts"===t.parser&&"ClassProperty"===e.type||"typescript"===t.parser&&"PropertyDefinition"===e.type)||Ql(e.key.value)&&String(Number(e.key.value))===e.key.value&&"ImportAttribute"!==e.type&&("babel"===t.parser||"acorn"===t.parser||"espree"===t.parser||"meriyah"===t.parser||"__babel_estree"===t.parser))}function Xl(e,t){let{key:n}=e.node;return("Identifier"===n.type||ke(n)&&Ql(Ll(ft(n)))&&String(n.value)===Ll(ft(n))&&!("typescript"===t.parser||"babel-ts"===t.parser))&&("json"===t.parser||"jsonc"===t.parser||"consistent"===t.quoteProps&&Hl.get(e.parent))}function Yl(e,t,n){let{node:i}=e;if(i.computed)return["[",n("key"),"]"];let{parent:r}=e,{key:s}=i;if("consistent"===t.quoteProps&&!Hl.has(r)){let n=e.siblings.some((e=>!e.computed&&Ve(e.key)&&!Kl(e,t)));Hl.set(r,n)}if(Xl(e,t)){let n=se(JSON.stringify("Identifier"===s.type?s.name:s.value.toString()),t);return e.call((e=>go(e,n,t)),"key")}return Kl(i,t)&&("as-needed"===t.quoteProps||"consistent"===t.quoteProps&&!Hl.get(r))?e.call((e=>go(e,/^\d/u.test(s.value)?Ll(s.value):s.value,t)),"key"):n("key")}function zl(e,t,n){let{node:i}=e;return i.shorthand?n("value"):Ba(e,t,n,Yl(e,t,n),":","value")}var Pl=e=>{let{node:t,key:n,parent:i}=e;return"value"===n&&"FunctionExpression"===t.type&&("ObjectMethod"===i.type||"ClassMethod"===i.type||"ClassPrivateMethod"===i.type||"MethodDefinition"===i.type||"TSAbstractMethodDefinition"===i.type||"TSDeclareMethod"===i.type||"Property"===i.type&&Ue(i))};function Ul(e,t,n,i){if(Pl(e))return Ol(e,n,t);let{node:r}=e,s=!1;if(("FunctionDeclaration"===r.type||"FunctionExpression"===r.type)&&null!=i&&i.expandLastArg){let{parent:t}=e;st(t)&&(Wt(t).length>1||Ft(r).every((e=>"Identifier"===e.type&&!e.typeAnnotation)))&&(s=!0)}let o=[fl(e),r.async?"async ":"","function".concat(r.generator?"*":""," "),r.id?t("id"):""],a=Ka(e,t,n,s),l=ql(e,t),c=za(r,l);return o.push(Bl(e,n,t),Dn([c?Dn(a):a,l]),r.body?" ":"",t("body")),n.semi&&(r.declare||!r.body)&&o.push(";"),o}function _l(e,t,n){let{node:i}=e,{kind:r}=i,s=i.value||i,o=[];return r&&"init"!==r&&"method"!==r&&"constructor"!==r?(Ml.ok("get"===r||"set"===r),o.push(r," ")):s.async&&o.push("async "),s.generator&&o.push("*"),o.push(Yl(e,t,n),i.optional||i.key.optional?"?":"",i===s?Ol(e,t,n):n("value")),o}function Ol(e,t,n){let{node:i}=e,r=Ka(e,n,t),s=ql(e,n),o=Ua(i),a=za(i,s),l=[Bl(e,t,n),Dn([o?Dn(r,{shouldBreak:!0}):a?Dn(r):r,s])];return i.body?l.push(" ",n("body")):l.push(t.semi?";":""),l}function Jl(e){let t=Ft(e);return 1===t.length&&!e.typeParameters&&!Kt(e,Ht.Dangling)&&"Identifier"===t[0].type&&!t[0].typeAnnotation&&!Kt(t[0])&&!t[0].optional&&!e.predicate&&!e.returnType}function jl(e,t){if("always"===t.arrowParens)return!1;if("avoid"===t.arrowParens){let{node:t}=e;return Jl(t)}return!1}function ql(e,t){let{node:n}=e,i=[gl(e,t,"returnType")];return n.predicate&&i.push(t("predicate")),i}function $l(e,t,n){let{node:i}=e,r=t.semi?";":"",s=[];if(i.argument){let e=n("argument");nc(t,i.argument)?e=["(",Rn([Yn,e]),Yn,")"]:(Je(i.argument)||"SequenceExpression"===i.argument.type||t.experimentalTernaries&&"ConditionalExpression"===i.argument.type&&("ConditionalExpression"===i.argument.consequent.type||"ConditionalExpression"===i.argument.alternate.type))&&(e=Dn([kn("("),Rn([Xn,e]),Xn,kn(")")])),s.push(" ",e)}let o=Kt(i,Ht.Dangling),a=r&&o&&Kt(i,Ht.Last|Ht.Line);return a&&s.push(r),o&&s.push(" ",lo(e,t)),a||s.push(r),s}function ec(e,t,n){return["return",$l(e,t,n)]}function tc(e,t,n){return["throw",$l(e,t,n)]}function nc(e,t){if(ut(e.originalText,t)||Kt(t,Ht.Leading,(t=>Gi(e.originalText,oe(t),ae(t))))&&!Pe(t))return!0;if(Se(t)){let n,i=t;for(;n=Re(i);)if(i=n,ut(e.originalText,i))return!0}return!1}var ic=new WeakMap;function rc(e){return ic.has(e)||ic.set(e,"ConditionalExpression"===e.type&&!Bt(e,(e=>"ObjectExpression"===e.type))),ic.get(e)}var sc=e=>"SequenceExpression"===e.type;function oc(e,t,n){let i,r,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=[],a=[],l=!1,c=!s.expandLastArg&&"ArrowFunctionExpression"===e.node.body.type;!function g(){let{node:u}=e,A=ac(e,t,n,s);if(0===o.length)o.push(A);else{let{leading:n,trailing:i}=co(e,t);o.push([n,A]),a.unshift(i)}c&&(l||(l=u.returnType&&Ft(u).length>0||u.typeParameters||Ft(u).some((e=>"Identifier"!==e.type)))),c&&"ArrowFunctionExpression"===u.body.type?e.call(g,"body"):(i=n("body",s),r=u.body)}();let g,u=!ut(t.originalText,r)&&(sc(r)||lc(r,i,t)||!l&&rc(r)),A="callee"===e.key&&zt(e.parent),d=Symbol("arrow-chain"),h=cc(e,s,{signatureDocs:o,shouldBreak:l}),I=!1;return c&&(A||s.assignmentLayout)&&(I=!0,g="chain-tail-arrow-chain"===s.assignmentLayout||A&&!u),i=gc(e,t,s,{bodyDoc:i,bodyComments:a,functionBody:r,shouldPutBodyOnSameLine:u}),Dn([Dn(I?Rn([Xn,h]):h,{shouldBreak:g,id:d})," =>",c?Tn(i,{groupId:d}):Dn(i),c&&A?kn(Xn,"",{groupId:d}):""])}function ac(e,t,n,i){let{node:r}=e,s=[];if(r.async&&s.push("async "),jl(e,t))s.push(n(["params",0]));else{let r=i.expandLastArg||i.expandFirstArg,o=ql(e,n);if(r){if($n(o))throw new ia;o=Dn(ii(o))}s.push(Dn([Ka(e,n,t,r,!0),o]))}let o=lo(e,t,{filter(e){let n=bi(t.originalText,ae(e));return!1!==n&&"=>"===t.originalText.slice(n,n+2)}});return o&&s.push(" ",o),s}function lc(e,t,n){var i,r;return Ne(e)||Me(e)||"ArrowFunctionExpression"===e.type||"DoExpression"===e.type||"BlockStatement"===e.type||Pe(e)||!1!==(null==(i=t.label)?void 0:i.hug)&&((null==(r=t.label)?void 0:r.embed)||dt(e,n.originalText))}function cc(e,t,n){let{signatureDocs:i,shouldBreak:r}=n;if(1===i.length)return i[0];let{parent:s,key:o}=e;return"callee"!==o&&zt(s)||Je(s)?Dn([i[0]," =>",Rn([Kn,Un([" =>",Kn],i.slice(1))])],{shouldBreak:r}):"callee"===o&&zt(s)||t.assignmentLayout?Dn(Un([" =>",Kn],i),{shouldBreak:r}):Dn(Rn(Un([" =>",Kn],i)),{shouldBreak:r})}function gc(e,t,n,i){let{bodyDoc:r,bodyComments:s,functionBody:o,shouldPutBodyOnSameLine:a}=i,{node:l,parent:c}=e,g=n.expandLastArg&&bt(t,"all")?kn(","):"",u=!n.expandLastArg&&"JSXExpressionContainer"!==c.type||Kt(l)?"":Xn;return a&&rc(o)?[" ",Dn([kn("","("),Rn([Xn,r]),kn("",")"),g,u]),s]:(sc(o)&&(r=Dn(["(",Rn([Xn,r]),Xn,")"])),a?[" ",r,s]:[Rn([Kn,r,s]),g,u])}var uc=(e,t,n)=>{if(!e||null!=t){if(t.findLast)return t.findLast(n);for(let e=t.length-1;e>=0;e--){let i=t[e];if(n(i,e,t))return i}}},Ac=uc;function dc(e,t,n,i){let{node:r}=e,s=[],o=Ac(!1,r[i],(e=>"EmptyStatement"!==e.type));return e.each((e=>{let{node:i}=e;"EmptyStatement"!==i.type&&(s.push(n()),i!==o&&(s.push(Yn),Yt(i,t)&&s.push(Yn)))}),i),s}function hc(e,t,n){let i=Ic(e,t,n),{node:r,parent:s}=e;if("Program"===r.type&&"ModuleExpression"!==(null==s?void 0:s.type))return i?[i,Yn]:"";let o=[];if("StaticBlock"===r.type&&o.push("static "),o.push("{"),i)o.push(Rn([Yn,i]),Yn);else{let t=e.grandparent;"ArrowFunctionExpression"===s.type||"FunctionExpression"===s.type||"FunctionDeclaration"===s.type||"ComponentDeclaration"===s.type||"HookDeclaration"===s.type||"ObjectMethod"===s.type||"ClassMethod"===s.type||"ClassPrivateMethod"===s.type||"ForStatement"===s.type||"WhileStatement"===s.type||"DoWhileStatement"===s.type||"DoExpression"===s.type||"ModuleExpression"===s.type||"CatchClause"===s.type&&!t.finalizer||"TSModuleDeclaration"===s.type||"StaticBlock"===r.type||o.push(Yn)}return o.push("}"),o}function Ic(e,t,n){let{node:i}=e,r=j(i.directives),s=i.body.some((e=>"EmptyStatement"!==e.type)),o=Kt(i,Ht.Dangling);if(!r&&!s&&!o)return"";let a=[];return r&&(a.push(dc(e,t,n,"directives")),(s||o)&&(a.push(Yn),Yt(v(!1,i.directives,-1),t)&&a.push(Yn))),s&&a.push(dc(e,t,n,"body")),o&&a.push(lo(e,t)),a}function pc(e){let t=new WeakMap;return function(n){return t.has(n)||t.set(n,Symbol(e)),t.get(n)}}var Cc=pc;function mc(e){switch(e){case null:return"";case"PlusOptional":return"+?";case"MinusOptional":return"-?";case"Optional":return"?"}}function fc(e,t,n){let{node:i}=e;return Dn([i.variance?n("variance"):"","[",Rn([n("keyTparam")," in ",n("sourceType")]),"]",mc(i.optional),": ",n("propType")])}function yc(e,t){return"+"===e||"-"===e?e+t:t}function bc(e,t,n){let{node:i}=e,r=Gi(t.originalText,oe(i),oe(i.typeParameter));return Dn(["{",Rn([t.bracketSpacing?Kn:Xn,Dn([n("typeParameter"),i.optional?yc(i.optional,"?"):"",i.typeAnnotation?": ":"",n("typeAnnotation")]),t.semi?kn(";"):""]),lo(e,t),t.bracketSpacing?Kn:Xn,"}"],{shouldBreak:r})}var Bc=Cc("typeParameters");function vc(e,t,n){let{node:i}=e;return 1===Ft(i).length&&i.type.startsWith("TS")&&!i[n][0].constraint&&"ArrowFunctionExpression"===e.parent.type&&!(t.filepath&&/\.ts$/u.test(t.filepath))}function wc(e,t,n,i){let{node:r}=e;if(!r[i])return"";if(!Array.isArray(r[i]))return n(i);let s=it(e.grandparent),o=e.match((e=>!(1===e[i].length&&Ke(e[i][0]))),void 0,((e,t)=>"typeAnnotation"===t),(e=>"Identifier"===e.type),Ma);if(0===r[i].length||!o&&(s||1===r[i].length&&("NullableTypeAnnotation"===r[i][0].type||ja(r[i][0]))))return["<",Un(", ",e.map(n,i)),Gc(e,t),">"];let a="TSTypeParameterInstantiation"===r.type?"":vc(e,t,i)?",":bt(t)?kn(","):"";return Dn(["<",Rn([Xn,Un([",",Kn],e.map(n,i))]),a,Xn,">"],{id:Bc(r)})}function Gc(e,t){let{node:n}=e;if(!Kt(n,Ht.Dangling))return"";let i=!Kt(n,Ht.Line),r=lo(e,t,{indent:!i});return i?r:[r,Yn]}function Ec(e,t,n){let{node:i,parent:r}=e,s=["TSTypeParameter"===i.type&&i.const?"const ":""],o="TSTypeParameter"===i.type?n("name"):i.name;if("TSMappedType"===r.type)return r.readonly&&s.push(yc(r.readonly,"readonly")," "),s.push("[",o),i.constraint&&s.push(" in ",n("constraint")),r.nameType&&s.push(" as ",e.callParent((()=>n("nameType")))),s.push("]"),s;if(i.variance&&s.push(n("variance")),i.in&&s.push("in "),i.out&&s.push("out "),s.push(o),i.bound&&(i.usesExtendsBound&&s.push(" extends "),s.push(gl(e,n,"bound"))),i.constraint){let e=Symbol("constraint");s.push(" extends",Dn(Rn(Kn),{id:e}),Ln,Tn(n("constraint"),{groupId:e}))}return i.default&&s.push(" = ",n("default")),Dn(s)}var xc=fe(["ClassProperty","PropertyDefinition","ClassPrivateProperty","ClassAccessorProperty","AccessorProperty","TSAbstractPropertyDefinition","TSAbstractAccessorProperty"]);function Sc(e,t,n){let{node:i}=e,r=[fl(e),bl(e),"class"],s=Kt(i.id,Ht.Trailing)||Kt(i.typeParameters,Ht.Trailing)||Kt(i.superClass)||j(i.extends)||j(i.mixins)||j(i.implements),o=[],a=[];if(i.id&&o.push(" ",n("id")),o.push(n("typeParameters")),i.superClass){let r=[Mc(e,t,n),n(i.superTypeArguments?"superTypeArguments":"superTypeParameters")],o=e.call((e=>["extends ",go(e,r,t)]),"superClass");s?a.push(Kn,Dn(o)):a.push(" ",o)}else a.push(Nc(e,t,n,"extends"));if(a.push(Nc(e,t,n,"mixins"),Nc(e,t,n,"implements")),s){let e;e=Fc(i)?[...o,Rn(a)]:Rn([...o,a]),r.push(Dn(e,{id:Rc(i)}))}else r.push(...o,...a);return r.push(" ",n("body")),r}var Rc=Cc("heritageGroup");function Zc(e){return kn(Yn,"",{groupId:Rc(e)})}function Dc(e){return["extends","mixins","implements"].reduce(((t,n)=>t+(Array.isArray(e[n])?e[n].length:0)),e.superClass?1:0)>1}function Fc(e){return e.typeParameters&&!Kt(e.typeParameters,Ht.Trailing|Ht.Line)&&!Dc(e)}function Nc(e,t,n,i){let{node:r}=e;if(!j(r[i]))return"";let s=lo(e,t,{marker:i});return[Fc(r)?kn(" ",Kn,{groupId:Bc(r.typeParameters)}):Kn,s,s&&Yn,i,Dn(Rn([Kn,Un([",",Kn],e.map(n,i))]))]}function Mc(e,t,n){let i=n("superClass"),{parent:r}=e;return"AssignmentExpression"===r.type?Dn(kn(["(",Rn([Xn,i]),Xn,")"],i)):i}function Wc(e,t,n){let{node:i}=e,r=[];return j(i.decorators)&&r.push(qo(e,t,n)),r.push(El(i)),i.static&&r.push("static "),r.push(bl(e)),i.override&&r.push("override "),r.push(_l(e,t,n)),r}function kc(e,t,n){let{node:i}=e,r=[],s=t.semi?";":"";return j(i.decorators)&&r.push(qo(e,t,n)),r.push(El(i),fl(e)),i.static&&r.push("static "),r.push(bl(e)),i.override&&r.push("override "),i.readonly&&r.push("readonly "),i.variance&&r.push(n("variance")),("ClassAccessorProperty"===i.type||"AccessorProperty"===i.type||"TSAbstractAccessorProperty"===i.type)&&r.push("accessor "),r.push(Yl(e,t,n),pl(e),Cl(e),gl(e,n)),[Ba(e,t,n,r," =","TSAbstractPropertyDefinition"===i.type||"TSAbstractAccessorProperty"===i.type?void 0:"value"),s]}function Tc(e,t,n){let{node:i}=e,r=[];return e.each((e=>{let{node:i,next:s,isLast:o}=e;r.push(n()),!t.semi&&xc(i)&&Vc(i,s)&&r.push(";"),o||(r.push(Yn),Yt(i,t)&&r.push(Yn))}),"body"),Kt(i,Ht.Dangling)&&r.push(lo(e,t)),[j(i.body)?Zc(e.parent):"","{",r.length>0?[Rn([Yn,r]),Yn]:"","}"]}function Vc(e,t){var n;let{type:i,name:r}=e.key;if(!e.computed&&"Identifier"===i&&("static"===r||"get"===r||"set"===r)&&!e.value&&!e.typeAnnotation)return!0;if(!t||t.static||t.accessibility||t.readonly)return!1;if(!t.computed){let e=null==(n=t.key)?void 0:n.name;if("in"===e||"instanceof"===e)return!0}if(xc(t)&&t.variance&&!t.static&&!t.declare)return!0;switch(t.type){case"ClassProperty":case"PropertyDefinition":case"TSAbstractPropertyDefinition":return t.computed;case"MethodDefinition":case"TSAbstractMethodDefinition":case"ClassMethod":case"ClassPrivateMethod":{if((t.value?t.value.async:t.async)||"get"===t.kind||"set"===t.kind)return!1;let e=t.value?t.value.generator:t.generator;return!(!t.computed&&!e)}case"TSIndexSignature":return!0}return!1}function Lc(e,t){if(t.semi||Qc(e,t)||Xc(e,t))return!1;let{node:n,key:i,parent:r}=e;return!("ExpressionStatement"!==n.type||("body"!==i||"Program"!==r.type&&"BlockStatement"!==r.type&&"StaticBlock"!==r.type&&"TSModuleBlock"!==r.type)&&("consequent"!==i||"SwitchCase"!==r.type)||!e.call((()=>Hc(e,t)),"expression"))}function Hc(e,t){let{node:n}=e;switch(n.type){case"ParenthesizedExpression":case"TypeCastExpression":case"ArrayExpression":case"ArrayPattern":case"TemplateLiteral":case"TemplateElement":case"RegExpLiteral":return!0;case"ArrowFunctionExpression":if(!jl(e,t))return!0;break;case"UnaryExpression":{let{prefix:e,operator:t}=n;if(e&&("+"===t||"-"===t))return!0;break}case"BindExpression":if(!n.object)return!0;break;case"Literal":if(n.regex)return!0;break;default:if(Pe(n))return!0}return!!to(e,t)||!!Se(n)&&e.call((()=>Hc(e,t)),...Ze(n))}function Qc(e,t){let{node:n,parent:i}=e;return("markdown"===t.parentParser||"mdx"===t.parentParser)&&"ExpressionStatement"===n.type&&Pe(n.expression)&&"Program"===i.type&&1===i.body.length}function Kc(e){switch(e.type){case"MemberExpression":switch(e.property.type){case"Identifier":case"NumericLiteral":case"StringLiteral":return Kc(e.object)}return!1;case"Identifier":return!0;default:return!1}}function Xc(e,t){let{node:n,parent:i}=e;return("__vue_event_binding"===t.parser||"__vue_ts_event_binding"===t.parser)&&"ExpressionStatement"===n.type&&"Program"===i.type&&1===i.body.length}function Yc(e,t,n){let i=[n("expression")];return Xc(e,t)?Kc(e.node.expression)&&i.push(";"):Qc(e,t)||t.semi&&i.push(";"),i}function zc(e,t,n){if(t.__isVueBindings||t.__isVueForBindingLeft){let i=e.map(n,"program","body",0,"params");if(1===i.length)return i[0];let r=Un([",",Kn],i);return t.__isVueForBindingLeft?["(",Rn([Xn,Dn(r)]),Xn,")"]:r}if(t.__isEmbeddedTypescriptGenericParameters){let t=e.map(n,"program","body",0,"typeParameters","params");return Un([",",Kn],t)}}function Pc(e,t){let{node:n}=e;switch(n.type){case"RegExpLiteral":return Oc(n);case"BigIntLiteral":return _c(n.extra.raw);case"NumericLiteral":return Ll(n.extra.raw);case"StringLiteral":return oi(se(n.extra.raw,t));case"NullLiteral":return"null";case"BooleanLiteral":return String(n.value);case"DecimalLiteral":return Ll(n.value)+"m";case"DirectiveLiteral":return Jc(n.extra.raw,t);case"Literal":{if(n.regex)return Oc(n.regex);if(n.bigint)return _c(n.raw);if(n.decimal)return Ll(n.decimal)+"m";let{value:i}=n;return"number"==typeof i?Ll(n.raw):"string"==typeof i?Uc(e)?Jc(n.raw,t):oi(se(n.raw,t)):String(i)}}}function Uc(e){if("expression"!==e.key)return;let{parent:t}=e;return"ExpressionStatement"===t.type&&t.directive}function _c(e){return e.toLowerCase()}function Oc(e){let{pattern:t,flags:n}=e;return n=[...n].sort().join(""),"/".concat(t,"/").concat(n)}function Jc(e,t){let n=e.slice(1,-1);if(n.includes('"')||n.includes("'"))return e;let i=t.singleQuote?"'":'"';return i+n+i}function jc(e,t,n){let i=e.originalText.slice(t,n);for(let r of e[Symbol.for("comments")]){let e=oe(r);if(e>n)break;let s=ae(r);if(s<t)continue;let o=s-e;i=i.slice(0,e-t)+" ".repeat(o)+i.slice(s-t)}return i}var qc=jc;function $c(e,t,n){let{node:i}=e;return["import",i.module?" module":"",i.phase?" ".concat(i.phase):"",sg(i),lg(e,t,n),ag(e,t,n),ug(e,t,n),t.semi?";":""]}var eg=e=>"ExportDefaultDeclaration"===e.type||"DeclareExportDeclaration"===e.type&&e.default;function tg(e,t,n){let{node:i}=e,r=[$o(e,t,n),fl(e),"export",eg(i)?" default":""],{declaration:s,exported:o}=i;return Kt(i,Ht.Dangling)&&(r.push(" ",lo(e,t)),ht(i)&&r.push(Yn)),s?r.push(" ",n("declaration")):(r.push(og(i)),"ExportAllDeclaration"===i.type||"DeclareExportAllDeclaration"===i.type?(r.push(" *"),o&&r.push(" as ",n("exported"))):r.push(lg(e,t,n)),r.push(ag(e,t,n),ug(e,t,n))),r.push(ig(i,t)),r}var ng=fe(["ClassDeclaration","ComponentDeclaration","FunctionDeclaration","TSInterfaceDeclaration","DeclareClass","DeclareComponent","DeclareFunction","DeclareHook","HookDeclaration","TSDeclareFunction","EnumDeclaration"]);function ig(e,t){return t.semi&&(!e.declaration||eg(e)&&!ng(e.declaration))?";":""}function rg(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e&&"value"!==e?"".concat(t?" ":"").concat(e).concat(t?"":" "):""}function sg(e,t){return rg(e.importKind,t)}function og(e){return rg(e.exportKind)}function ag(e,t,n){let{node:i}=e;if(!i.source)return"";let r=[];return cg(i,t)&&r.push(" from"),r.push(" ",n("source")),r}function lg(e,t,n){let{node:i}=e;if(!cg(i,t))return"";let r=[" "];if(j(i.specifiers)){let s=[],o=[];e.each((()=>{let t=e.node.type;if("ExportNamespaceSpecifier"===t||"ExportDefaultSpecifier"===t||"ImportNamespaceSpecifier"===t||"ImportDefaultSpecifier"===t)s.push(n());else{if("ExportSpecifier"!==t&&"ImportSpecifier"!==t)throw new Ao(i,"specifier");o.push(n())}}),"specifiers"),r.push(Un(", ",s)),o.length>0&&(s.length>0&&r.push(", "),o.length>1||s.length>0||i.specifiers.some((e=>Kt(e)))?r.push(Dn(["{",Rn([t.bracketSpacing?Kn:Xn,Un([",",Kn],o)]),kn(bt(t)?",":""),t.bracketSpacing?Kn:Xn,"}"])):r.push(["{",t.bracketSpacing?" ":"",...o,t.bracketSpacing?" ":"","}"]))}else r.push("{}");return r}function cg(e,t){return!("ImportDeclaration"===e.type&&!j(e.specifiers)&&"type"!==e.importKind)||qc(t,oe(e),oe(e.source)).trimEnd().endsWith("from")}function gg(e,t){var n,i;if(null!=(n=e.extra)&&n.deprecatedAssertSyntax)return"assert";let r=qc(t,ae(e.source),null!=(i=e.attributes)&&i[0]?oe(e.attributes[0]):ae(e)).trimStart();return r.startsWith("assert")?"assert":r.startsWith("with")||j(e.attributes)?"with":void 0}function ug(e,t,n){let{node:i}=e;if(!i.source)return"";let r=gg(i,t);if(!r)return"";let s=[" ".concat(r," {")];return j(i.attributes)&&(t.bracketSpacing&&s.push(" "),s.push(Un(", ",e.map(n,"attributes"))),t.bracketSpacing&&s.push(" ")),s.push("}"),s}function Ag(e,t,n){let{node:i}=e,{type:r}=i,s=r.startsWith("Import"),o=s?"imported":"local",a=s?"local":"exported",l=i[o],c=i[a],g="",u="";return"ExportNamespaceSpecifier"===r||"ImportNamespaceSpecifier"===r?g="*":l&&(g=n(o)),c&&!dg(i)&&(u=n(a)),[rg("ImportSpecifier"===r?i.importKind:i.exportKind,!1),g,g&&u?" as ":"",u]}function dg(e){if("ImportSpecifier"!==e.type&&"ExportSpecifier"!==e.type)return!1;let{local:t,["ImportSpecifier"===e.type?"imported":"exported"]:n}=e;return!(t.type!==n.type||!ge(t,n))&&(Ve(t)?t.value===n.value&&ft(t)===ft(n):"Identifier"===t.type&&t.name===n.name)}function hg(e,t,n){var i;let r=t.semi?";":"",{node:s}=e,o="ObjectTypeAnnotation"===s.type,a="TSEnumDeclaration"===s.type||"EnumBooleanBody"===s.type||"EnumNumberBody"===s.type||"EnumBigIntBody"===s.type||"EnumStringBody"===s.type||"EnumSymbolBody"===s.type,l=["TSTypeLiteral"===s.type||a?"members":"TSInterfaceBody"===s.type?"body":"properties"];o&&l.push("indexers","callProperties","internalSlots");let c=l.flatMap((t=>e.map((e=>{let{node:t}=e;return{node:t,printed:n(),loc:oe(t)}}),t)));l.length>1&&c.sort(((e,t)=>e.loc-t.loc));let{parent:g,key:u}=e,A=o&&"body"===u&&("InterfaceDeclaration"===g.type||"DeclareInterface"===g.type||"DeclareClass"===g.type),d="TSInterfaceBody"===s.type||a||A||"ObjectPattern"===s.type&&"FunctionDeclaration"!==g.type&&"FunctionExpression"!==g.type&&"ArrowFunctionExpression"!==g.type&&"ObjectMethod"!==g.type&&"ClassMethod"!==g.type&&"ClassPrivateMethod"!==g.type&&"AssignmentPattern"!==g.type&&"CatchClause"!==g.type&&s.properties.some((e=>e.value&&("ObjectPattern"===e.value.type||"ArrayPattern"===e.value.type)))||"ObjectPattern"!==s.type&&c.length>0&&Gi(t.originalText,oe(s),c[0].loc),h=A?";":"TSInterfaceBody"===s.type||"TSTypeLiteral"===s.type?kn(r,";"):",",I="RecordExpression"===s.type?"#{":s.exact?"{|":"{",p=s.exact?"|}":"}",C=[],m=c.map((e=>{let n=[...C,Dn(e.printed)];return C=[h,Kn],("TSPropertySignature"===e.node.type||"TSMethodSignature"===e.node.type||"TSConstructSignatureDeclaration"===e.node.type||"TSCallSignatureDeclaration"===e.node.type)&&Kt(e.node,Ht.PrettierIgnore)&&C.shift(),Yt(e.node,t)&&C.push(Yn),n}));if(s.inexact||s.hasUnknownMembers){let n;if(Kt(s,Ht.Dangling)){let i=Kt(s,Ht.Line);n=[lo(e,t),i||X(t.originalText,ae(v(!1,Xt(s),-1)))?Yn:Kn,"..."]}else n=["..."];m.push([...C,...n])}let f,y=null==(i=v(!1,c,-1))?void 0:i.node,b=!(s.inexact||s.hasUnknownMembers||y&&("RestElement"===y.type||("TSPropertySignature"===y.type||"TSCallSignatureDeclaration"===y.type||"TSMethodSignature"===y.type||"TSConstructSignatureDeclaration"===y.type)&&Kt(y,Ht.PrettierIgnore)));if(0===m.length){if(!Kt(s,Ht.Dangling))return[I,p,gl(e,n)];f=Dn([I,lo(e,t,{indent:!0}),Xn,p,pl(e),gl(e,n)])}else f=[A&&j(s.properties)?Zc(g):"",I,Rn([t.bracketSpacing?Kn:Xn,...m]),kn(b&&(","!==h||bt(t))?h:""),t.bracketSpacing?Kn:Xn,p,pl(e),gl(e,n)];return e.match((e=>"ObjectPattern"===e.type&&!j(e.decorators)),Ig)||Ke(s)&&(e.match(void 0,((e,t)=>"typeAnnotation"===t),((e,t)=>"typeAnnotation"===t),Ig)||e.match(void 0,((e,t)=>"FunctionTypeParam"===e.type&&"typeAnnotation"===t),Ig))||!d&&e.match((e=>"ObjectPattern"===e.type),(e=>"AssignmentExpression"===e.type||"VariableDeclarator"===e.type))?f:Dn(f,{shouldBreak:d})}function Ig(e,t){return("params"===t||"parameters"===t||"this"===t||"rest"===t)&&Xa(e)}function pg(e){let t=[e];for(let n=0;n<t.length;n++){let e=t[n];for(let n of["test","consequent","alternate"]){let i=e[n];if(Pe(i))return!0;"ConditionalExpression"===i.type&&t.push(i)}}return!1}function Cg(e,t,n){let{node:i}=e,r="ConditionalExpression"===i.type,s=r?"alternate":"falseType",{parent:o}=e,a=r?n("test"):[n("checkType")," ","extends"," ",n("extendsType")];return o.type===i.type&&o[s]===i?Zn(2,a):a}var mg=new Map([["AssignmentExpression","right"],["VariableDeclarator","init"],["ReturnStatement","argument"],["ThrowStatement","argument"],["UnaryExpression","argument"],["YieldExpression","argument"],["AwaitExpression","argument"]]);function fg(e){let{node:t}=e;if("ConditionalExpression"!==t.type)return!1;let n,i=t;for(let r=0;!n;r++){let t=e.getParentNode(r);"ChainExpression"===t.type&&t.expression===i||st(t)&&t.callee===i||ot(t)&&t.object===i||"TSNonNullExpression"===t.type&&t.expression===i?i=t:"NewExpression"===t.type&&t.callee===i||Ut(t)&&t.expression===i?(n=e.getParentNode(r+1),i=t):n=t}return i!==t&&n[mg.get(n.type)]===i}function yg(e,t,n){let i,r,{node:s}=e,o="ConditionalExpression"===s.type,a=o?"consequent":"trueType",l=o?"alternate":"falseType",c=o?["test"]:["checkType","extendsType"],g=s[a],u=s[l],A=[],d=!1,{parent:h}=e,I=h.type===s.type&&c.some((e=>h[e]===s)),p=h.type===s.type&&!I,C=0;do{r=i||s,i=e.getParentNode(C),C++}while(i&&i.type===s.type&&c.every((e=>i[e]!==r)));let m=i||h,f=r;if(o&&(Pe(s[c[0]])||Pe(g)||Pe(u)||pg(f))){d=!0,p=!0;let e=e=>[kn("("),Rn([Xn,e]),Xn,kn(")")],t=e=>"NullLiteral"===e.type||"Literal"===e.type&&null===e.value||"Identifier"===e.type&&"undefined"===e.name;A.push(" ? ",t(g)?n(a):e(n(a))," : ",u.type===s.type||t(u)?n(l):e(n(l)))}else{let e=e=>t.useTabs?Rn(n(e)):Zn(2,n(e)),i=[Kn,"? ",g.type===s.type?kn("","("):"",e(a),g.type===s.type?kn("",")"):"",Kn,": ",e(l)];A.push(h.type!==s.type||h[l]===s||I?i:t.useTabs?Nn(Rn(i)):Zn(Math.max(0,t.tabWidth-2),i))}let y=[a,l,...c].some((e=>Kt(s[e],(e=>ye(e)&&Gi(t.originalText,oe(e),ae(e)))))),b=e=>h===m?Dn(e,{shouldBreak:y}):y?[e,Hn]:e,B=!d&&(ot(h)||"NGPipeExpression"===h.type&&h.left===s)&&!h.computed,v=fg(e),w=b([Cg(e,t,n),p?A:Rn(A),o&&B&&!v?Xn:""]);return I||v?Dn([Rn([Xn,w]),Xn]):w}function bg(e,t){return(ot(t)||"NGPipeExpression"===t.type&&t.left===e)&&!t.computed}function Bg(e,t,n,i){return[...e.map((e=>Xt(e))),Xt(t),Xt(n)].flat().some((e=>ye(e)&&Gi(i.originalText,oe(e),ae(e))))}var vg=new Map([["AssignmentExpression","right"],["VariableDeclarator","init"],["ReturnStatement","argument"],["ThrowStatement","argument"],["UnaryExpression","argument"],["YieldExpression","argument"],["AwaitExpression","argument"]]);function wg(e){let{node:t}=e;if("ConditionalExpression"!==t.type)return!1;let n,i=t;for(let r=0;!n;r++){let t=e.getParentNode(r);"ChainExpression"===t.type&&t.expression===i||st(t)&&t.callee===i||ot(t)&&t.object===i||"TSNonNullExpression"===t.type&&t.expression===i?i=t:"NewExpression"===t.type&&t.callee===i||Ut(t)&&t.expression===i?(n=e.getParentNode(r+1),i=t):n=t}return i!==t&&n[vg.get(n.type)]===i}var Gg=e=>[kn("("),Rn([Xn,e]),Xn,kn(")")];function Eg(e,t,n,i){if(!t.experimentalTernaries)return yg(e,t,n);let r,s,{node:o}=e,a="ConditionalExpression"===o.type,l="TSConditionalType"===o.type||"ConditionalTypeAnnotation"===o.type,c=a?"consequent":"trueType",g=a?"alternate":"falseType",u=a?["test"]:["checkType","extendsType"],A=o[c],d=o[g],h=u.map((e=>o[e])),{parent:I}=e,p=I.type===o.type,C=p&&u.some((e=>I[e]===o)),m=p&&I[g]===o,f=A.type===o.type,y=d.type===o.type,b=y||m,B=t.tabWidth>2||t.useTabs,v=0;do{s=r||o,r=e.getParentNode(v),v++}while(r&&r.type===o.type&&u.every((e=>r[e]!==s)));let w=r||I,G=i&&i.assignmentLayout&&"break-after-operator"!==i.assignmentLayout&&("AssignmentExpression"===I.type||"VariableDeclarator"===I.type||"ClassProperty"===I.type||"PropertyDefinition"===I.type||"ClassPrivateProperty"===I.type||"ObjectProperty"===I.type||"Property"===I.type),E=("ReturnStatement"===I.type||"ThrowStatement"===I.type)&&!(f||y),x=a&&"JSXExpressionContainer"===w.type&&"JSXAttribute"!==e.grandparent.type,S=wg(e),R=bg(o,I),Z=l&&to(e,t),D=B?t.useTabs?"\t":" ".repeat(t.tabWidth-1):"",F=Bg(h,A,d,t)||f||y,N=!b&&!p&&!l&&(x?"NullLiteral"===A.type||"Literal"===A.type&&null===A.value:gt(A,t)&&at(o.test,3)),M=b||m||l&&!p||p&&a&&at(o.test,1)||N,W=[];!f&&Kt(A,Ht.Dangling)&&e.call((e=>{W.push(lo(e,t),Yn)}),"consequent");let k=[];Kt(o.test,Ht.Dangling)&&e.call((e=>{k.push(lo(e,t))}),"test"),!y&&Kt(d,Ht.Dangling)&&e.call((e=>{k.push(lo(e,t))}),"alternate"),Kt(o,Ht.Dangling)&&k.push(lo(e,t));let T=Symbol("test"),V=Symbol("consequent"),L=Symbol("test-and-consequent"),H=a?[Gg(n("test")),"ConditionalExpression"===o.test.type?Hn:""]:[n("checkType")," ","extends"," ","TSConditionalType"===o.extendsType.type||"ConditionalTypeAnnotation"===o.extendsType.type||"TSMappedType"===o.extendsType.type?n("extendsType"):Dn(Gg(n("extendsType")))],Q=Dn([H," ?"],{id:T}),K=n(c),X=Rn([f||x&&(Pe(A)||p||b)?Yn:Kn,W,K]),Y=M?Dn([Q,b?X:kn(X,Dn(X,{id:V}),{groupId:T})],{id:L}):[Q,X],z=n(g),P=N?kn(z,Nn(Gg(z)),{groupId:L}):z,U=[Y,k.length>0?[Rn([Yn,k]),Yn]:y?Yn:N?kn(Kn," ",{groupId:L}):Kn,":",y?" ":B?M?kn(D,kn(b||N?" ":D," "),{groupId:L}):kn(D," "):" ",y?P:Dn([Rn(P),x&&!N?Xn:""]),R&&!S?Xn:"",F?Hn:""];return G&&!F?Dn(Rn([Xn,Dn(U)])):G||E?Dn(Rn(U)):S||l&&C?Dn([Rn([Xn,U]),Z?Xn:""]):I===w?Dn(U):U}function xg(e,t,n,i){var r;let{node:s}=e;if(He(s))return Pc(e,t);let o=t.semi?";":"",a=[];switch(s.type){case"JsExpressionRoot":return n("node");case"JsonRoot":return[n("node"),Yn];case"File":return null!==(r=zc(e,t,n))&&void 0!==r?r:n("program");case"EmptyStatement":return"";case"ExpressionStatement":return Yc(e,t,n);case"ChainExpression":return n("expression");case"ParenthesizedExpression":return Kt(s.expression)||!Me(s.expression)&&!Ne(s.expression)?Dn(["(",Rn([Xn,n("expression")]),Xn,")"]):["(",n("expression"),")"];case"AssignmentExpression":return va(e,t,n);case"VariableDeclarator":return wa(e,t,n);case"BinaryExpression":case"LogicalExpression":return Xo(e,t,n);case"AssignmentPattern":return[n("left")," = ",n("right")];case"OptionalMemberExpression":case"MemberExpression":return Ia(e,t,n);case"MetaProperty":return[n("meta"),".",n("property")];case"BindExpression":return s.object&&a.push(n("object")),a.push(Dn(Rn([Xn,vl(e,t,n)]))),a;case"Identifier":return[s.name,pl(e),Cl(e),gl(e,n)];case"V8IntrinsicIdentifier":return["%",s.name];case"SpreadElement":case"SpreadElementPattern":case"SpreadPropertyPattern":case"RestElement":return Gl(e,n);case"FunctionDeclaration":case"FunctionExpression":return Ul(e,n,t,i);case"ArrowFunctionExpression":return oc(e,t,n,i);case"YieldExpression":return a.push("yield"),s.delegate&&a.push("*"),s.argument&&a.push(" ",n("argument")),a;case"AwaitExpression":if(a.push("await"),s.argument){a.push(" ",n("argument"));let{parent:t}=e;if(st(t)&&t.callee===s||ot(t)&&t.object===s){a=[Rn([Xn,...a]),Xn];let t=e.findAncestor((e=>"AwaitExpression"===e.type||"BlockStatement"===e.type));if("AwaitExpression"!==(null==t?void 0:t.type)||!Bt(t.argument,(e=>e===s)))return Dn(a)}}return a;case"ExportDefaultDeclaration":case"ExportNamedDeclaration":case"ExportAllDeclaration":return tg(e,t,n);case"ImportDeclaration":return $c(e,t,n);case"ImportSpecifier":case"ExportSpecifier":case"ImportNamespaceSpecifier":case"ExportNamespaceSpecifier":case"ImportDefaultSpecifier":case"ExportDefaultSpecifier":return Ag(e,t,n);case"ImportAttribute":case"ObjectProperty":return zl(e,t,n);case"Import":return"import";case"Program":case"BlockStatement":case"StaticBlock":return hc(e,t,n);case"ClassBody":return Tc(e,t,n);case"ThrowStatement":return tc(e,t,n);case"ReturnStatement":return ec(e,t,n);case"NewExpression":case"ImportExpression":case"OptionalCallExpression":case"CallExpression":return fa(e,t,n);case"ObjectExpression":case"ObjectPattern":case"RecordExpression":return hg(e,t,n);case"Property":return Ue(s)?_l(e,t,n):zl(e,t,n);case"ObjectMethod":return _l(e,t,n);case"Decorator":return["@",n("expression")];case"ArrayExpression":case"ArrayPattern":case"TupleExpression":return Sl(e,t,n);case"SequenceExpression":{let{parent:t}=e;if("ExpressionStatement"===t.type||"ForStatement"===t.type){let t=[];return e.each((e=>{let{isFirst:i}=e;i?t.push(n()):t.push(",",Rn([Kn,n()]))}),"expressions"),Dn(t)}return Dn(Un([",",Kn],e.map(n,"expressions")))}case"ThisExpression":return"this";case"Super":return"super";case"Directive":return[n("value"),o];case"UnaryExpression":return a.push(s.operator),/[a-z]$/u.test(s.operator)&&a.push(" "),Kt(s.argument)?a.push(Dn(["(",Rn([Xn,n("argument")]),Xn,")"])):a.push(n("argument")),a;case"UpdateExpression":return[s.prefix?s.operator:"",n("argument"),s.prefix?"":s.operator];case"ConditionalExpression":return Eg(e,t,n,i);case"VariableDeclaration":{let t,i=e.map(n,"declarations"),r=e.parent,l="ForStatement"===r.type||"ForInStatement"===r.type||"ForOfStatement"===r.type,c=s.declarations.some((e=>e.init));return 1!==i.length||Kt(s.declarations[0])?i.length>0&&(t=Rn(i[0])):t=i[0],a=[fl(e),s.kind,t?[" ",t]:"",Rn(i.slice(1).map((e=>[",",c&&!l?Yn:Kn,e])))],l&&r.body!==s||a.push(o),Dn(a)}case"WithStatement":return Dn(["with (",n("object"),")",wl(s.body,n("body"))]);case"IfStatement":{let i=wl(s.consequent,n("consequent")),r=Dn(["if (",Dn([Rn([Xn,n("test")]),Xn]),")",i]);if(a.push(r),s.alternate){let i=Kt(s.consequent,Ht.Trailing|Ht.Line)||ht(s),r="BlockStatement"===s.consequent.type&&!i;a.push(r?" ":Yn),Kt(s,Ht.Dangling)&&a.push(lo(e,t),i?Yn:" "),a.push("else",Dn(wl(s.alternate,n("alternate"),"IfStatement"===s.alternate.type)))}return a}case"ForStatement":{let i=wl(s.body,n("body")),r=lo(e,t),o=r?[r,Xn]:"";return s.init||s.test||s.update?[o,Dn(["for (",Dn([Rn([Xn,n("init"),";",Kn,n("test"),";",Kn,n("update")]),Xn]),")",i])]:[o,Dn(["for (;;)",i])]}case"WhileStatement":return Dn(["while (",Dn([Rn([Xn,n("test")]),Xn]),")",wl(s.body,n("body"))]);case"ForInStatement":return Dn(["for (",n("left")," in ",n("right"),")",wl(s.body,n("body"))]);case"ForOfStatement":return Dn(["for",s.await?" await":""," (",n("left")," of ",n("right"),")",wl(s.body,n("body"))]);case"DoWhileStatement":return a=[Dn(["do",wl(s.body,n("body"))])],"BlockStatement"===s.body.type?a.push(" "):a.push(Yn),a.push("while (",Dn([Rn([Xn,n("test")]),Xn]),")",o),a;case"DoExpression":return[s.async?"async ":"","do ",n("body")];case"BreakStatement":case"ContinueStatement":return a.push("BreakStatement"===s.type?"break":"continue"),s.label&&a.push(" ",n("label")),a.push(o),a;case"LabeledStatement":return"EmptyStatement"===s.body.type?[n("label"),":;"]:[n("label"),": ",n("body")];case"TryStatement":return["try ",n("block"),s.handler?[" ",n("handler")]:"",s.finalizer?[" finally ",n("finalizer")]:""];case"CatchClause":if(s.param){let e=Kt(s.param,(e=>!ye(e)||e.leading&&X(t.originalText,ae(e))||e.trailing&&X(t.originalText,oe(e),{backwards:!0}))),i=n("param");return["catch ",e?["(",Rn([Xn,i]),Xn,") "]:["(",i,") "],n("body")]}return["catch ",n("body")];case"SwitchStatement":return[Dn(["switch (",Rn([Xn,n("discriminant")]),Xn,")"])," {",s.cases.length>0?Rn([Yn,Un(Yn,e.map((e=>{let{node:i,isLast:r}=e;return[n(),!r&&Yt(i,t)?Yn:""]}),"cases"))]):"",Yn,"}"];case"SwitchCase":{s.test?a.push("case ",n("test"),":"):a.push("default:"),Kt(s,Ht.Dangling)&&a.push(" ",lo(e,t));let i=s.consequent.filter((e=>"EmptyStatement"!==e.type));if(i.length>0){let r=dc(e,t,n,"consequent");a.push(1===i.length&&"BlockStatement"===i[0].type?[" ",r]:Rn([Yn,r]))}return a}case"DebuggerStatement":return["debugger",o];case"ClassDeclaration":case"ClassExpression":return Sc(e,t,n);case"ClassMethod":case"ClassPrivateMethod":case"MethodDefinition":return Wc(e,t,n);case"ClassProperty":case"PropertyDefinition":case"ClassPrivateProperty":case"ClassAccessorProperty":case"AccessorProperty":return kc(e,t,n);case"TemplateElement":return oi(s.value.raw);case"TemplateLiteral":return kr(e,n,t);case"TaggedTemplateExpression":return Tr(e,n);case"PrivateIdentifier":return["#",s.name];case"PrivateName":return["#",n("id")];case"TopicReference":return"%";case"ArgumentPlaceholder":return"?";case"ModuleExpression":return["module ",n("body")];default:throw new Ao(s,"ESTree")}}function Sg(e,t,n){let{parent:i,node:r,key:s}=e,o=[n("expression")];switch(r.type){case"AsConstExpression":o.push(" as const");break;case"AsExpression":case"TSAsExpression":o.push(" as ",n("typeAnnotation"));break;case"SatisfiesExpression":case"TSSatisfiesExpression":o.push(" satisfies ",n("typeAnnotation"))}return"callee"===s&&st(i)||"object"===s&&ot(i)?Dn([Rn([Xn,...o]),Xn]):o}function Rg(e,t,n){let{node:i}=e,r=[fl(e),"component"];i.id&&r.push(" ",n("id")),r.push(n("typeParameters"));let s=Zg(e,n,t);return i.rendersType?r.push(Dn([s," ",n("rendersType")])):r.push(Dn([s])),i.body&&r.push(" ",n("body")),t.semi&&"DeclareComponent"===i.type&&r.push(";"),r}function Zg(e,t,n){let{node:i}=e,r=i.params;if(i.rest&&(r=[...r,i.rest]),0===r.length)return["(",lo(e,n,{filter:e=>")"===vi(n.originalText,ae(e))}),")"];let s=[];return Fg(e,((e,o)=>{let a=o===r.length-1;a&&i.rest&&s.push("..."),s.push(t()),!a&&(s.push(","),Yt(r[o],n)?s.push(Yn,Yn):s.push(Kn))})),["(",Rn([Xn,...s]),kn(bt(n,"all")&&!Dg(i,r)?",":""),Xn,")"]}function Dg(e,t){var n;return e.rest||"RestElement"===(null==(n=v(!1,t,-1))?void 0:n.type)}function Fg(e,t){let{node:n}=e,i=0,r=e=>t(e,i++);e.each(r,"params"),n.rest&&e.call(r,"rest")}function Ng(e,t,n){let{node:i}=e;return i.shorthand?n("local"):[n("name")," as ",n("local")]}function Mg(e,t,n){let{node:i}=e,r=[];return i.name&&r.push(n("name"),i.optional?"?: ":": "),r.push(n("typeAnnotation")),r}function Wg(e,t,n){return hg(e,n,t)}function kg(e,t){let{node:n}=e,i=t("id");n.computed&&(i=["[",i,"]"]);let r="";return n.initializer&&(r=t("initializer")),n.init&&(r=t("init")),r?[i," = ",r]:i}function Tg(e,t,n){let i,{node:r}=e;if("EnumSymbolBody"===r.type||r.explicitType)switch(r.type){case"EnumBooleanBody":i="boolean";break;case"EnumNumberBody":i="number";break;case"EnumBigIntBody":i="bigint";break;case"EnumStringBody":i="string";break;case"EnumSymbolBody":i="symbol"}return[i?"of ".concat(i," "):"",Wg(e,t,n)]}function Vg(e,t,n){let{node:i}=e;return[fl(e),i.const?"const ":"","enum ",t("id")," ","TSEnumDeclaration"===i.type?Wg(e,t,n):t("body")]}function Lg(e,t,n){let{node:i}=e,r=["hook"];i.id&&r.push(" ",n("id"));let s=Ka(e,n,t,!1,!0),o=ql(e,n),a=za(i,o);return r.push(Dn([a?Dn(s):s,o]),i.body?" ":"",n("body")),r}function Hg(e,t,n){let{node:i}=e,r=[fl(e),"hook"];return i.id&&r.push(" ",n("id")),t.semi&&r.push(";"),r}function Qg(e){var t;let{node:n}=e;return"HookTypeAnnotation"===n.type&&"DeclareHook"===(null==(t=e.getParentNode(2))?void 0:t.type)}function Kg(e,t,n){let{node:i}=e,r=[];r.push(Qg(e)?"":"hook ");let s=Ka(e,n,t,!1,!0),o=[];return o.push(Qg(e)?": ":" => ",n("returnType")),za(i,o)&&(s=Dn(s)),r.push(s,o),Dn(r)}function Xg(e,t,n){let{node:i}=e,r=[fl(e),"interface"],s=[],o=[];"InterfaceTypeAnnotation"!==i.type&&s.push(" ",n("id"),n("typeParameters"));let a=i.typeParameters&&!Kt(i.typeParameters,Ht.Trailing|Ht.Line);return j(i.extends)&&o.push(a?kn(" ",Kn,{groupId:Bc(i.typeParameters)}):Kn,"extends ",(1===i.extends.length?yt:Rn)(Un([",",Kn],e.map(n,"extends")))),Kt(i.id,Ht.Trailing)||j(i.extends)?a?r.push(Dn([...s,Rn(o)])):r.push(Dn(Rn([...s,...o]))):r.push(...s,...o),r.push(" ",n("body")),Dn(r)}function Yg(e,t,n){var i,r,s;let{node:o}=e;if(be(o))return o.type.slice(0,-14).toLowerCase();let a=t.semi?";":"";switch(o.type){case"ComponentDeclaration":case"DeclareComponent":case"ComponentTypeAnnotation":return Rg(e,t,n);case"ComponentParameter":return Ng(e,t,n);case"ComponentTypeParameter":return Mg(e,t,n);case"HookDeclaration":return Lg(e,t,n);case"DeclareHook":return Hg(e,t,n);case"HookTypeAnnotation":return Kg(e,t,n);case"DeclareClass":return Sc(e,t,n);case"DeclareFunction":return[fl(e),"function ",n("id"),n("predicate"),a];case"DeclareModule":return["declare module ",n("id")," ",n("body")];case"DeclareModuleExports":return["declare module.exports",gl(e,n),a];case"DeclareNamespace":return["declare namespace ",n("id")," ",n("body")];case"DeclareVariable":return[fl(e),null!==(i=o.kind)&&void 0!==i?i:"var"," ",n("id"),a];case"DeclareExportDeclaration":case"DeclareExportAllDeclaration":return tg(e,t,n);case"DeclareOpaqueType":case"OpaqueType":return qa(e,t,n);case"DeclareTypeAlias":case"TypeAlias":return $a(e,t,n);case"IntersectionTypeAnnotation":return el(e,t,n);case"UnionTypeAnnotation":return tl(e,t,n);case"ConditionalTypeAnnotation":return Eg(e,t,n);case"InferTypeAnnotation":return sl(e,t,n);case"FunctionTypeAnnotation":return il(e,t,n);case"TupleTypeAnnotation":return Sl(e,t,n);case"TupleTypeLabeledElement":return ll(e,t,n);case"TupleTypeSpreadElement":return al(e,t,n);case"GenericTypeAnnotation":return[n("id"),wc(e,t,n,"typeParameters")];case"IndexedAccessType":case"OptionalIndexedAccessType":return rl(e,t,n);case"TypeAnnotation":return Al(e,t,n);case"TypeParameter":return Ec(e,t,n);case"TypeofTypeAnnotation":return hl(e,n);case"ExistsTypeAnnotation":return"*";case"ArrayTypeAnnotation":return dl(n);case"DeclareEnum":case"EnumDeclaration":return Vg(e,n,t);case"EnumBooleanBody":case"EnumNumberBody":case"EnumBigIntBody":case"EnumStringBody":case"EnumSymbolBody":return Tg(e,n,t);case"EnumBooleanMember":case"EnumNumberMember":case"EnumBigIntMember":case"EnumStringMember":case"EnumDefaultedMember":return kg(e,n);case"FunctionTypeParam":{let t=o.name?n("name"):e.parent.this===o?"this":"";return[t,pl(e),t?": ":"",n("typeAnnotation")]}case"DeclareInterface":case"InterfaceDeclaration":case"InterfaceTypeAnnotation":return Xg(e,t,n);case"ClassImplements":case"InterfaceExtends":return[n("id"),n("typeParameters")];case"NullableTypeAnnotation":return["?",n("typeAnnotation")];case"Variance":{let{kind:e}=o;return Ml.ok("plus"===e||"minus"===e),"plus"===e?"+":"-"}case"KeyofTypeAnnotation":return["keyof ",n("argument")];case"ObjectTypeCallProperty":return[o.static?"static ":"",n("value")];case"ObjectTypeMappedTypeProperty":return fc(e,t,n);case"ObjectTypeIndexer":return[o.static?"static ":"",o.variance?n("variance"):"","[",n("id"),o.id?": ":"",n("key"),"]: ",n("value")];case"ObjectTypeProperty":{let i="";return o.proto?i="proto ":o.static&&(i="static "),[i,"init"!==o.kind?o.kind+" ":"",o.variance?n("variance"):"",Yl(e,t,n),pl(e),Ue(o)?"":": ",n("value")]}case"ObjectTypeAnnotation":return hg(e,t,n);case"ObjectTypeInternalSlot":return[o.static?"static ":"","[[",n("id"),"]]",pl(e),o.method?"":": ",n("value")];case"ObjectTypeSpreadProperty":return Gl(e,n);case"QualifiedTypeofIdentifier":case"QualifiedTypeIdentifier":return[n("qualification"),".",n("id")];case"NullLiteralTypeAnnotation":return"null";case"BooleanLiteralTypeAnnotation":return String(o.value);case"StringLiteralTypeAnnotation":return oi(se(ft(o),t));case"NumberLiteralTypeAnnotation":return Ll(null!==(r=o.raw)&&void 0!==r?r:o.extra.raw);case"BigIntLiteralTypeAnnotation":return _c(null!==(s=o.raw)&&void 0!==s?s:o.extra.raw);case"TypeCastExpression":return["(",n("expression"),gl(e,n),")"];case"TypePredicate":return Il(e,n);case"TypeOperator":return[o.operator," ",n("typeAnnotation")];case"TypeParameterDeclaration":case"TypeParameterInstantiation":return wc(e,t,n,"params");case"InferredPredicate":case"DeclaredPredicate":return["predicate"!==e.key||"DeclareFunction"===e.parent.type||e.parent.returnType?" ":": ","%checks",..."DeclaredPredicate"===o.type?["(",n("value"),")"]:[]];case"AsExpression":case"AsConstExpression":case"SatisfiesExpression":return Sg(e,t,n)}}function zg(e,t,n){var i;let{node:r}=e;if(!r.type.startsWith("TS"))return;if(Ee(r))return r.type.slice(2,-7).toLowerCase();let s=t.semi?";":"",o=[];switch(r.type){case"TSThisType":return"this";case"TSTypeAssertion":{let e=!(Ne(r.expression)||Me(r.expression)),t=Dn(["<",Rn([Xn,n("typeAnnotation")]),Xn,">"]),i=[kn("("),Rn([Xn,n("expression")]),Xn,kn(")")];return e?Mn([[t,n("expression")],[t,Dn(i,{shouldBreak:!0})],[t,n("expression")]]):Dn([t,n("expression")])}case"TSDeclareFunction":return Ul(e,n,t);case"TSExportAssignment":return["export = ",n("expression"),s];case"TSModuleBlock":return hc(e,t,n);case"TSInterfaceBody":case"TSTypeLiteral":return hg(e,t,n);case"TSTypeAliasDeclaration":return $a(e,t,n);case"TSQualifiedName":return[n("left"),".",n("right")];case"TSAbstractMethodDefinition":case"TSDeclareMethod":return Wc(e,t,n);case"TSAbstractAccessorProperty":case"TSAbstractPropertyDefinition":return kc(e,t,n);case"TSInterfaceHeritage":case"TSClassImplements":case"TSExpressionWithTypeArguments":case"TSInstantiationExpression":return[n("expression"),n(r.typeArguments?"typeArguments":"typeParameters")];case"TSTemplateLiteralType":return kr(e,n,t);case"TSNamedTupleMember":return ll(e,t,n);case"TSRestType":return al(e,t,n);case"TSOptionalType":return[n("typeAnnotation"),"?"];case"TSInterfaceDeclaration":return Xg(e,t,n);case"TSTypeParameterDeclaration":case"TSTypeParameterInstantiation":return wc(e,t,n,"params");case"TSTypeParameter":return Ec(e,t,n);case"TSAsExpression":case"TSSatisfiesExpression":return Sg(e,t,n);case"TSArrayType":return dl(n);case"TSPropertySignature":return[r.readonly?"readonly ":"",Yl(e,t,n),pl(e),gl(e,n)];case"TSParameterProperty":return[El(r),r.static?"static ":"",r.override?"override ":"",r.readonly?"readonly ":"",n("parameter")];case"TSTypeQuery":return hl(e,n);case"TSIndexSignature":{let i=r.parameters.length>1?kn(bt(t)?",":""):"",o=Dn([Rn([Xn,Un([", ",Xn],e.map(n,"parameters"))]),i,Xn]),a="ClassBody"===e.parent.type&&"body"===e.key;return[a&&r.static?"static ":"",r.readonly?"readonly ":"","[",r.parameters?o:"","]",gl(e,n),a?s:""]}case"TSTypePredicate":return Il(e,n);case"TSNonNullExpression":return[n("expression"),"!"];case"TSImportType":return[r.isTypeOf?"typeof ":"","import(",n("argument"),")",r.qualifier?[".",n("qualifier")]:"",wc(e,t,n,r.typeArguments?"typeArguments":"typeParameters")];case"TSLiteralType":return n("literal");case"TSIndexedAccessType":return rl(e,t,n);case"TSTypeOperator":return[r.operator," ",n("typeAnnotation")];case"TSMappedType":return bc(e,t,n);case"TSMethodSignature":{let i=r.kind&&"method"!==r.kind?"".concat(r.kind," "):"";o.push(El(r),i,r.computed?"[":"",n("key"),r.computed?"]":"",pl(e));let s=Ka(e,n,t,!1,!0),a=r.returnType?"returnType":"typeAnnotation",l=r[a],c=l?gl(e,n,a):"",g=za(r,c);return o.push(g?Dn(s):s),l&&o.push(Dn(c)),Dn(o)}case"TSNamespaceExportDeclaration":return["export as namespace ",n("id"),t.semi?";":""];case"TSEnumDeclaration":return Vg(e,n,t);case"TSEnumMember":return kg(e,n);case"TSImportEqualsDeclaration":return[r.isExport?"export ":"","import ",sg(r,!1),n("id")," = ",n("moduleReference"),t.semi?";":""];case"TSExternalModuleReference":return["require(",n("expression"),")"];case"TSModuleDeclaration":{let{parent:l}=e,c="TSModuleDeclaration"===l.type,g="TSModuleDeclaration"===(null==(i=r.body)?void 0:i.type);if(c)o.push(".");else if(o.push(fl(e)),"global"!==r.kind&&!r.global){var a;let e=null!==(a=r.kind)&&void 0!==a?a:Ve(r.id)||qc(t,oe(r),oe(r.id)).trim().endsWith("module")?"module":"namespace";o.push(e," ")}return o.push(n("id")),g?o.push(n("body")):r.body?o.push(" ",Dn(n("body"))):o.push(s),o}case"TSConditionalType":return Eg(e,t,n);case"TSInferType":return sl(e,t,n);case"TSIntersectionType":return el(e,t,n);case"TSUnionType":return tl(e,t,n);case"TSFunctionType":case"TSCallSignatureDeclaration":case"TSConstructorType":case"TSConstructSignatureDeclaration":return il(e,t,n);case"TSTupleType":return Sl(e,t,n);case"TSTypeReference":return[n("typeName"),wc(e,t,n,r.typeArguments?"typeArguments":"typeParameters")];case"TSTypeAnnotation":return Al(e,t,n);case"TSEmptyBodyFunctionExpression":return Ol(e,t,n);case"TSJSDocAllType":return"*";case"TSJSDocUnknownType":return"?";case"TSJSDocNullableType":return ol(e,n,"?");case"TSJSDocNonNullableType":return ol(e,n,"!");default:throw new Ao(r,"TypeScript")}}function Pg(e,t,n,i){if(Qo(e))return Ys(e,t);for(let r of[_o,Wo,Yg,zg,xg]){let s=r(e,t,n,i);if(void 0!==s)return s}}var Ug=fe(["ClassMethod","ClassPrivateMethod","ClassProperty","ClassAccessorProperty","AccessorProperty","TSAbstractAccessorProperty","PropertyDefinition","TSAbstractPropertyDefinition","ClassPrivateProperty","MethodDefinition","TSAbstractMethodDefinition","TSDeclareMethod"]);function _g(e,t,n,i){var r;e.isRoot&&(null==(r=t.__onHtmlBindingRoot)||r.call(t,e.node,t));let s=Pg(e,t,n,i);if(!s)return"";let{node:o}=e;if(Ug(o))return s;let a=j(o.decorators),l=ea(e,t,n),c="ClassExpression"===o.type;if(a&&!c)return ci(s,(e=>Dn([l,e])));let g=to(e,t),u=Lc(e,t);return l||g||u?ci(s,(e=>[u?";":"",g?"(":"",g&&c&&a?[Rn([Kn,l,e]),Kn]:[l,e],g?")":""])):s}var Og=_g,Jg={avoidAstMutation:!0},jg=[{linguistLanguageId:174,name:"JSON.stringify",type:"data",color:"#292929",tmScope:"source.json",aceMode:"json",codemirrorMode:"javascript",codemirrorMimeType:"application/json",aliases:["geojson","jsonl","topojson"],extensions:[".importmap"],filenames:["package.json","package-lock.json","composer.json"],parsers:["json-stringify"],vscodeLanguageIds:["json"]},{linguistLanguageId:174,name:"JSON",type:"data",color:"#292929",tmScope:"source.json",aceMode:"json",codemirrorMode:"javascript",codemirrorMimeType:"application/json",aliases:["geojson","jsonl","topojson"],extensions:[".json",".4DForm",".4DProject",".avsc",".geojson",".gltf",".har",".ice",".JSON-tmLanguage",".mcmeta",".tfstate",".tfstate.backup",".topojson",".webapp",".webmanifest",".yy",".yyp"],filenames:[".all-contributorsrc",".arcconfig",".auto-changelog",".c8rc",".htmlhintrc",".imgbotconfig",".nycrc",".tern-config",".tern-project",".watchmanconfig","Pipfile.lock","composer.lock","flake.lock","mcmod.info",".babelrc",".jscsrc",".jshintrc",".jslintrc",".swcrc"],parsers:["json"],vscodeLanguageIds:["json"]},{linguistLanguageId:423,name:"JSON with Comments",type:"data",color:"#292929",group:"JSON",tmScope:"source.js",aceMode:"javascript",codemirrorMode:"javascript",codemirrorMimeType:"text/javascript",aliases:["jsonc"],extensions:[".jsonc",".code-snippets",".code-workspace",".sublime-build",".sublime-commands",".sublime-completions",".sublime-keymap",".sublime-macro",".sublime-menu",".sublime-mousemap",".sublime-project",".sublime-settings",".sublime-theme",".sublime-workspace",".sublime_metrics",".sublime_session"],filenames:[],parsers:["jsonc"],vscodeLanguageIds:["jsonc"]},{linguistLanguageId:175,name:"JSON5",type:"data",color:"#267CB9",extensions:[".json5"],tmScope:"source.js",aceMode:"javascript",codemirrorMode:"javascript",codemirrorMimeType:"application/json",parsers:["json5"],vscodeLanguageIds:["json5"]}],qg={};g(qg,{getVisitorKeys:()=>$g,massageAstNode:()=>iu,print:()=>eu});var $g=pe({JsonRoot:["node"],ArrayExpression:["elements"],ObjectExpression:["properties"],ObjectProperty:["key","value"],UnaryExpression:["argument"],NullLiteral:[],BooleanLiteral:[],StringLiteral:[],NumericLiteral:[],Identifier:[],TemplateLiteral:["quasis"],TemplateElement:[]});function eu(e,t,n){let{node:i}=e;switch(i.type){case"JsonRoot":return[n("node"),Yn];case"ArrayExpression":{if(0===i.elements.length)return"[]";let t=e.map((()=>null===e.node?"null":n()),"elements");return["[",Rn([Yn,Un([",",Yn],t)]),Yn,"]"]}case"ObjectExpression":return 0===i.properties.length?"{}":["{",Rn([Yn,Un([",",Yn],e.map(n,"properties"))]),Yn,"}"];case"ObjectProperty":return[n("key"),": ",n("value")];case"UnaryExpression":return["+"===i.operator?"":i.operator,n("argument")];case"NullLiteral":return"null";case"BooleanLiteral":return i.value?"true":"false";case"StringLiteral":return JSON.stringify(i.value);case"NumericLiteral":return tu(e)?JSON.stringify(String(i.value)):JSON.stringify(i.value);case"Identifier":return tu(e)?JSON.stringify(i.name):i.name;case"TemplateLiteral":return n(["quasis",0]);case"TemplateElement":return JSON.stringify(i.value.cooked);default:throw new Ao(i,"JSON")}}function tu(e){return"key"===e.key&&"ObjectProperty"===e.parent.type}var nu=new Set(["start","end","extra","loc","comments","leadingComments","trailingComments","innerComments","errors","range","tokens"]);function iu(e,t){let{type:n}=e;if("ObjectProperty"!==n){if("UnaryExpression"===n&&"+"===e.operator)return t.argument;if("ArrayExpression"!==n)return"TemplateLiteral"===n?{type:"StringLiteral",value:e.quasis[0].value.cooked}:void 0;for(let[n,i]of e.elements.entries())null===i&&t.elements.splice(n,0,{type:"NullLiteral"})}else{let{key:n}=e;"Identifier"===n.type?t.key={type:"StringLiteral",value:n.name}:"NumericLiteral"===n.type&&(t.key={type:"StringLiteral",value:String(n.value)})}}iu.ignoredProperties=nu;var ru={bracketSpacing:{category:"Common",type:"boolean",default:!0,description:"Print spaces between brackets.",oppositeDescription:"Do not print spaces between brackets."},singleQuote:{category:"Common",type:"boolean",default:!1,description:"Use single quotes instead of double quotes."},proseWrap:{category:"Common",type:"choice",default:"preserve",description:"How to wrap prose.",choices:[{value:"always",description:"Wrap prose if it exceeds the print width."},{value:"never",description:"Do not wrap prose."},{value:"preserve",description:"Wrap prose as-is."}]},bracketSameLine:{category:"Common",type:"boolean",default:!1,description:"Put > of opening tags on the last line instead of on a new line."},singleAttributePerLine:{category:"Common",type:"boolean",default:!1,description:"Enforce single attribute per line in HTML, Vue and JSX."}},su="JavaScript",ou={arrowParens:{category:su,type:"choice",default:"always",description:"Include parentheses around a sole arrow function parameter.",choices:[{value:"always",description:"Always include parens. Example: `(x) => x`"},{value:"avoid",description:"Omit parens when possible. Example: `x => x`"}]},bracketSameLine:ru.bracketSameLine,bracketSpacing:ru.bracketSpacing,jsxBracketSameLine:{category:su,type:"boolean",description:"Put > on the last line instead of at a new line.",deprecated:"2.4.0"},semi:{category:su,type:"boolean",default:!0,description:"Print semicolons.",oppositeDescription:"Do not print semicolons, except at the beginning of lines which may need them."},experimentalTernaries:{category:su,type:"boolean",default:!1,description:"Use curious ternaries, with the question mark after the condition.",oppositeDescription:"Default behavior of ternaries; keep question marks on the same line as the consequent."},singleQuote:ru.singleQuote,jsxSingleQuote:{category:su,type:"boolean",default:!1,description:"Use single quotes in JSX."},quoteProps:{category:su,type:"choice",default:"as-needed",description:"Change when properties in objects are quoted.",choices:[{value:"as-needed",description:"Only add quotes around object properties where required."},{value:"consistent",description:"If at least one property in an object requires quotes, quote all properties."},{value:"preserve",description:"Respect the input use of quotes in object properties."}]},trailingComma:{category:su,type:"choice",default:"all",description:"Print trailing commas wherever possible when multi-line.",choices:[{value:"all",description:"Trailing commas wherever possible (including function arguments)."},{value:"es5",description:"Trailing commas where valid in ES5 (objects, arrays, etc.)"},{value:"none",description:"No trailing commas."}]},singleAttributePerLine:ru.singleAttributePerLine},au={estree:f,"estree-json":qg},lu=[...m,...jg];return A(C)}();return e.default||e}()},730:(e,t,n)=>{"use strict";var i=n(43),r=n(67);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var g=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,A=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},h={};function I(e,t,n,i,r,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var p={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){p[e]=new I(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];p[t]=new I(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){p[e]=new I(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){p[e]=new I(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){p[e]=new I(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){p[e]=new I(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){p[e]=new I(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){p[e]=new I(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){p[e]=new I(e,5,!1,e.toLowerCase(),null,!1,!1)}));var C=/[\-:]([a-z])/g;function m(e){return e[1].toUpperCase()}function f(e,t,n,i){var r=p.hasOwnProperty(t)?p[t]:null;(null!==r?0!==r.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null===t||"undefined"===typeof t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,i)&&(n=null),i||null===r?function(e){return!!u.call(h,e)||!u.call(d,e)&&(A.test(e)?h[e]=!0:(d[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,i=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(C,m);p[t]=new I(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(C,m);p[t]=new I(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(C,m);p[t]=new I(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){p[e]=new I(e,1,!1,e.toLowerCase(),null,!1,!1)})),p.xlinkHref=new I("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){p[e]=new I(e,1,!1,e.toLowerCase(),null,!0,!0)}));var y=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),B=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),G=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),x=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),Z=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),F=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var N=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var M=Symbol.iterator;function W(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=M&&e[M]||e["@@iterator"])?e:null}var k,T=Object.assign;function V(e){if(void 0===k)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);k=t&&t[1]||""}return"\n"+k+e}var L=!1;function H(e,t){if(!e||L)return"";L=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),s=i.stack.split("\n"),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||r[o]!==s[a]){var l="\n"+r[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{L=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?V(e):""}function Q(e){switch(e.tag){case 5:return V(e.type);case 16:return V("Lazy");case 13:return V("Suspense");case 19:return V("SuspenseList");case 0:case 2:case 15:return e=H(e.type,!1);case 11:return e=H(e.type.render,!1);case 1:return e=H(e.type,!0);default:return""}}function K(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case v:return"Fragment";case B:return"Portal";case G:return"Profiler";case w:return"StrictMode";case R:return"Suspense";case Z:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case x:return(e.displayName||"Context")+".Consumer";case E:return(e._context.displayName||"Context")+".Provider";case S:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case D:return null!==(t=e.displayName||null)?t:K(e.type)||"Memo";case F:t=e._payload,e=e._init;try{return K(e(t))}catch(n){}}return null}function X(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return K(t);case 8:return t===w?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function Y(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function z(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function P(e){e._valueTracker||(e._valueTracker=function(e){var t=z(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){i=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function U(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=z(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function _(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function O(e,t){var n=t.checked;return T({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function J(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=Y(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function j(e,t){null!=(t=t.checked)&&f(e,"checked",t,!1)}function q(e,t){j(e,t);var n=Y(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,Y(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&_(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+Y(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return T({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:Y(n)}}function se(e,t){var n=Y(t.value),i=Y(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ge,ue=(ge=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction((function(){return ge(e,t)}))}:ge);function Ae(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var de={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},he=["Webkit","ms","Moz","O"];function Ie(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||de.hasOwnProperty(e)&&de[e]?(""+t).trim():t+"px"}function pe(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=Ie(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}Object.keys(de).forEach((function(e){he.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),de[t]=de[e]}))}));var Ce=T({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function me(e,t){if(t){if(Ce[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function fe(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ye=null;function be(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Be=null,ve=null,we=null;function Ge(e){if(e=fr(e)){if("function"!==typeof Be)throw Error(s(280));var t=e.stateNode;t&&(t=br(t),Be(e.stateNode,e.type,t))}}function Ee(e){ve?we?we.push(e):we=[e]:ve=e}function xe(){if(ve){var e=ve,t=we;if(we=ve=null,Ge(e),t)for(e=0;e<t.length;e++)Ge(t[e])}}function Se(e,t){return e(t)}function Re(){}var Ze=!1;function De(e,t,n){if(Ze)return e(t,n);Ze=!0;try{return Se(e,t,n)}finally{Ze=!1,(null!==ve||null!==we)&&(Re(),xe())}}function Fe(e,t){var n=e.stateNode;if(null===n)return null;var i=br(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Ne=!1;if(g)try{var Me={};Object.defineProperty(Me,"passive",{get:function(){Ne=!0}}),window.addEventListener("test",Me,Me),window.removeEventListener("test",Me,Me)}catch(ge){Ne=!1}function We(e,t,n,i,r,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(g){this.onError(g)}}var ke=!1,Te=null,Ve=!1,Le=null,He={onError:function(e){ke=!0,Te=e}};function Qe(e,t,n,i,r,s,o,a,l){ke=!1,Te=null,We.apply(He,arguments)}function Ke(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Xe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ye(e){if(Ke(e)!==e)throw Error(s(188))}function ze(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ke(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var o=r.alternate;if(null===o){if(null!==(i=r.return)){n=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return Ye(r),e;if(o===i)return Ye(r),t;o=o.sibling}throw Error(s(188))}if(n.return!==i.return)n=r,i=o;else{for(var a=!1,l=r.child;l;){if(l===n){a=!0,n=r,i=o;break}if(l===i){a=!0,i=r,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,i=r;break}if(l===i){a=!0,i=o,n=r;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==i)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?Pe(e):null}function Pe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Pe(e);if(null!==t)return t;e=e.sibling}return null}var Ue=r.unstable_scheduleCallback,_e=r.unstable_cancelCallback,Oe=r.unstable_shouldYield,Je=r.unstable_requestPaint,je=r.unstable_now,qe=r.unstable_getCurrentPriorityLevel,$e=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,it=r.unstable_IdlePriority,rt=null,st=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,gt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function At(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~r;0!==a?i=ut(a):0!==(s&=o)&&(i=ut(s))}else 0!==(o=n&~r)?i=ut(o):0!==s&&(i=ut(s));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(s=t&-t)||16===r&&0!==(4194240&s)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-ot(t)),i|=e[n],t&=~r;return i}function dt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ht(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function It(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function pt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ct(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function mt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-ot(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var ft=0;function yt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var bt,Bt,vt,wt,Gt,Et=!1,xt=[],St=null,Rt=null,Zt=null,Dt=new Map,Ft=new Map,Nt=[],Mt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Wt(e,t){switch(e){case"focusin":case"focusout":St=null;break;case"dragenter":case"dragleave":Rt=null;break;case"mouseover":case"mouseout":Zt=null;break;case"pointerover":case"pointerout":Dt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ft.delete(t.pointerId)}}function kt(e,t,n,i,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=fr(t))&&Bt(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Tt(e){var t=mr(e.target);if(null!==t){var n=Ke(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Xe(n)))return e.blockedOn=t,void Gt(e.priority,(function(){vt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Vt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Ot(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=fr(n))&&Bt(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);ye=i,n.target.dispatchEvent(i),ye=null,t.shift()}return!0}function Lt(e,t,n){Vt(e)&&n.delete(t)}function Ht(){Et=!1,null!==St&&Vt(St)&&(St=null),null!==Rt&&Vt(Rt)&&(Rt=null),null!==Zt&&Vt(Zt)&&(Zt=null),Dt.forEach(Lt),Ft.forEach(Lt)}function Qt(e,t){e.blockedOn===t&&(e.blockedOn=null,Et||(Et=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Ht)))}function Kt(e){function t(t){return Qt(t,e)}if(0<xt.length){Qt(xt[0],e);for(var n=1;n<xt.length;n++){var i=xt[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==St&&Qt(St,e),null!==Rt&&Qt(Rt,e),null!==Zt&&Qt(Zt,e),Dt.forEach(t),Ft.forEach(t),n=0;n<Nt.length;n++)(i=Nt[n]).blockedOn===e&&(i.blockedOn=null);for(;0<Nt.length&&null===(n=Nt[0]).blockedOn;)Tt(n),null===n.blockedOn&&Nt.shift()}var Xt=y.ReactCurrentBatchConfig,Yt=!0;function zt(e,t,n,i){var r=ft,s=Xt.transition;Xt.transition=null;try{ft=1,Ut(e,t,n,i)}finally{ft=r,Xt.transition=s}}function Pt(e,t,n,i){var r=ft,s=Xt.transition;Xt.transition=null;try{ft=4,Ut(e,t,n,i)}finally{ft=r,Xt.transition=s}}function Ut(e,t,n,i){if(Yt){var r=Ot(e,t,n,i);if(null===r)Yi(e,t,i,_t,n),Wt(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return St=kt(St,e,t,n,i,r),!0;case"dragenter":return Rt=kt(Rt,e,t,n,i,r),!0;case"mouseover":return Zt=kt(Zt,e,t,n,i,r),!0;case"pointerover":var s=r.pointerId;return Dt.set(s,kt(Dt.get(s)||null,e,t,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Ft.set(s,kt(Ft.get(s)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(Wt(e,i),4&t&&-1<Mt.indexOf(e)){for(;null!==r;){var s=fr(r);if(null!==s&&bt(s),null===(s=Ot(e,t,n,i))&&Yi(e,t,i,_t,n),s===r)break;r=s}null!==r&&i.stopPropagation()}else Yi(e,t,i,null,n)}}var _t=null;function Ot(e,t,n,i){if(_t=null,null!==(e=mr(e=be(i))))if(null===(t=Ke(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Xe(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return _t=e,null}function Jt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qe()){case $e:return 1;case et:return 4;case tt:case nt:return 16;case it:return 536870912;default:return 16}default:return 16}}var jt=null,qt=null,$t=null;function en(){if($t)return $t;var e,t,n=qt,i=n.length,r="value"in jt?jt.value:jt.textContent,s=r.length;for(e=0;e<i&&n[e]===r[e];e++);var o=i-e;for(t=1;t<=o&&n[i-t]===r[s-t];t++);return $t=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,i,r,s){for(var o in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return T(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,an,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gn=sn(cn),un=T({},cn,{view:0,detail:0}),An=sn(un),dn=T({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:an}}),hn=sn(dn),In=sn(T({},dn,{dataTransfer:0})),pn=sn(T({},un,{relatedTarget:0})),Cn=sn(T({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),mn=T({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),fn=sn(mn),yn=sn(T({},cn,{data:0})),bn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Bn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=vn[e])&&!!t[e]}function Gn(){return wn}var En=T({},un,{key:function(e){if(e.key){var t=bn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Bn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),xn=sn(En),Sn=sn(T({},dn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Rn=sn(T({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gn})),Zn=sn(T({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Dn=T({},dn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Fn=sn(Dn),Nn=[9,13,27,32],Mn=g&&"CompositionEvent"in window,Wn=null;g&&"documentMode"in document&&(Wn=document.documentMode);var kn=g&&"TextEvent"in window&&!Wn,Tn=g&&(!Mn||Wn&&8<Wn&&11>=Wn),Vn=String.fromCharCode(32),Ln=!1;function Hn(e,t){switch(e){case"keyup":return-1!==Nn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Kn=!1;var Xn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Xn[e.type]:"textarea"===t}function zn(e,t,n,i){Ee(i),0<(t=Pi(t,"onChange")).length&&(n=new gn("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Pn=null,Un=null;function _n(e){Vi(e,0)}function On(e){if(U(yr(e)))return e}function Jn(e,t){if("change"===e)return t}var jn=!1;if(g){var qn;if(g){var $n="oninput"in document;if(!$n){var ei=document.createElement("div");ei.setAttribute("oninput","return;"),$n="function"===typeof ei.oninput}qn=$n}else qn=!1;jn=qn&&(!document.documentMode||9<document.documentMode)}function ti(){Pn&&(Pn.detachEvent("onpropertychange",ni),Un=Pn=null)}function ni(e){if("value"===e.propertyName&&On(Un)){var t=[];zn(t,Un,e,be(e)),De(_n,t)}}function ii(e,t,n){"focusin"===e?(ti(),Un=n,(Pn=t).attachEvent("onpropertychange",ni)):"focusout"===e&&ti()}function ri(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return On(Un)}function si(e,t){if("click"===e)return On(t)}function oi(e,t){if("input"===e||"change"===e)return On(t)}var ai="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function li(e,t){if(ai(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!u.call(t,r)||!ai(e[r],t[r]))return!1}return!0}function ci(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function gi(e,t){var n,i=ci(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ci(i)}}function ui(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ui(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function Ai(){for(var e=window,t=_();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=_((e=t.contentWindow).document)}return t}function di(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function hi(e){var t=Ai(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ui(n.ownerDocument.documentElement,n)){if(null!==i&&di(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=void 0===i.end?s:Math.min(i.end,r),!e.extend&&s>i&&(r=i,i=s,s=r),r=gi(n,s);var o=gi(n,i);r&&o&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Ii=g&&"documentMode"in document&&11>=document.documentMode,pi=null,Ci=null,mi=null,fi=!1;function yi(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;fi||null==pi||pi!==_(i)||("selectionStart"in(i=pi)&&di(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},mi&&li(mi,i)||(mi=i,0<(i=Pi(Ci,"onSelect")).length&&(t=new gn("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=pi)))}function bi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Bi={animationend:bi("Animation","AnimationEnd"),animationiteration:bi("Animation","AnimationIteration"),animationstart:bi("Animation","AnimationStart"),transitionend:bi("Transition","TransitionEnd")},vi={},wi={};function Gi(e){if(vi[e])return vi[e];if(!Bi[e])return e;var t,n=Bi[e];for(t in n)if(n.hasOwnProperty(t)&&t in wi)return vi[e]=n[t];return e}g&&(wi=document.createElement("div").style,"AnimationEvent"in window||(delete Bi.animationend.animation,delete Bi.animationiteration.animation,delete Bi.animationstart.animation),"TransitionEvent"in window||delete Bi.transitionend.transition);var Ei=Gi("animationend"),xi=Gi("animationiteration"),Si=Gi("animationstart"),Ri=Gi("transitionend"),Zi=new Map,Di="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fi(e,t){Zi.set(e,t),l(t,[e])}for(var Ni=0;Ni<Di.length;Ni++){var Mi=Di[Ni];Fi(Mi.toLowerCase(),"on"+(Mi[0].toUpperCase()+Mi.slice(1)))}Fi(Ei,"onAnimationEnd"),Fi(xi,"onAnimationIteration"),Fi(Si,"onAnimationStart"),Fi("dblclick","onDoubleClick"),Fi("focusin","onFocus"),Fi("focusout","onBlur"),Fi(Ri,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ki=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wi));function Ti(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,r,o,a,l,c){if(Qe.apply(this,arguments),ke){if(!ke)throw Error(s(198));var g=Te;ke=!1,Te=null,Ve||(Ve=!0,Le=g)}}(i,t,void 0,e),e.currentTarget=null}function Vi(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;Ti(r,a,c),s=l}else for(o=0;o<i.length;o++){if(l=(a=i[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;Ti(r,a,c),s=l}}}if(Ve)throw e=Le,Ve=!1,Le=null,e}function Li(e,t){var n=t[Ir];void 0===n&&(n=t[Ir]=new Set);var i=e+"__bubble";n.has(i)||(Xi(t,e,2,!1),n.add(i))}function Hi(e,t,n){var i=0;t&&(i|=4),Xi(n,e,i,t)}var Qi="_reactListening"+Math.random().toString(36).slice(2);function Ki(e){if(!e[Qi]){e[Qi]=!0,o.forEach((function(t){"selectionchange"!==t&&(ki.has(t)||Hi(t,!1,e),Hi(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Qi]||(t[Qi]=!0,Hi("selectionchange",!1,t))}}function Xi(e,t,n,i){switch(Jt(t)){case 1:var r=zt;break;case 4:r=Pt;break;default:r=Ut}n=r.bind(null,t,n,e),r=void 0,!Ne||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Yi(e,t,n,i,r){var s=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var o=i.tag;if(3===o||4===o){var a=i.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===o)for(o=i.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;o=o.return}for(;null!==a;){if(null===(o=mr(a)))return;if(5===(l=o.tag)||6===l){i=s=o;continue e}a=a.parentNode}}i=i.return}De((function(){var i=s,r=be(n),o=[];e:{var a=Zi.get(e);if(void 0!==a){var l=gn,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=xn;break;case"focusin":c="focus",l=pn;break;case"focusout":c="blur",l=pn;break;case"beforeblur":case"afterblur":l=pn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=hn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=In;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Rn;break;case Ei:case xi:case Si:l=Cn;break;case Ri:l=Zn;break;case"scroll":l=An;break;case"wheel":l=Fn;break;case"copy":case"cut":case"paste":l=fn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Sn}var g=0!==(4&t),u=!g&&"scroll"===e,A=g?null!==a?a+"Capture":null:a;g=[];for(var d,h=i;null!==h;){var I=(d=h).stateNode;if(5===d.tag&&null!==I&&(d=I,null!==A&&(null!=(I=Fe(h,A))&&g.push(zi(h,I,d)))),u)break;h=h.return}0<g.length&&(a=new l(a,c,null,n,r),o.push({event:a,listeners:g}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===ye||!(c=n.relatedTarget||n.fromElement)||!mr(c)&&!c[hr])&&(l||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?mr(c):null)&&(c!==(u=Ke(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(g=hn,I="onMouseLeave",A="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(g=Sn,I="onPointerLeave",A="onPointerEnter",h="pointer"),u=null==l?a:yr(l),d=null==c?a:yr(c),(a=new g(I,h+"leave",l,n,r)).target=u,a.relatedTarget=d,I=null,mr(r)===i&&((g=new g(A,h+"enter",c,n,r)).target=d,g.relatedTarget=u,I=g),u=I,l&&c)e:{for(A=c,h=0,d=g=l;d;d=Ui(d))h++;for(d=0,I=A;I;I=Ui(I))d++;for(;0<h-d;)g=Ui(g),h--;for(;0<d-h;)A=Ui(A),d--;for(;h--;){if(g===A||null!==A&&g===A.alternate)break e;g=Ui(g),A=Ui(A)}g=null}else g=null;null!==l&&_i(o,a,l,g,!1),null!==c&&null!==u&&_i(o,u,c,g,!0)}if("select"===(l=(a=i?yr(i):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var p=Jn;else if(Yn(a))if(jn)p=oi;else{p=ri;var C=ii}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(p=si);switch(p&&(p=p(e,i))?zn(o,p,n,r):(C&&C(e,a,i),"focusout"===e&&(C=a._wrapperState)&&C.controlled&&"number"===a.type&&ee(a,"number",a.value)),C=i?yr(i):window,e){case"focusin":(Yn(C)||"true"===C.contentEditable)&&(pi=C,Ci=i,mi=null);break;case"focusout":mi=Ci=pi=null;break;case"mousedown":fi=!0;break;case"contextmenu":case"mouseup":case"dragend":fi=!1,yi(o,n,r);break;case"selectionchange":if(Ii)break;case"keydown":case"keyup":yi(o,n,r)}var m;if(Mn)e:{switch(e){case"compositionstart":var f="onCompositionStart";break e;case"compositionend":f="onCompositionEnd";break e;case"compositionupdate":f="onCompositionUpdate";break e}f=void 0}else Kn?Hn(e,n)&&(f="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(f="onCompositionStart");f&&(Tn&&"ko"!==n.locale&&(Kn||"onCompositionStart"!==f?"onCompositionEnd"===f&&Kn&&(m=en()):(qt="value"in(jt=r)?jt.value:jt.textContent,Kn=!0)),0<(C=Pi(i,f)).length&&(f=new yn(f,e,null,n,r),o.push({event:f,listeners:C}),m?f.data=m:null!==(m=Qn(n))&&(f.data=m))),(m=kn?function(e,t){switch(e){case"compositionend":return Qn(t);case"keypress":return 32!==t.which?null:(Ln=!0,Vn);case"textInput":return(e=t.data)===Vn&&Ln?null:e;default:return null}}(e,n):function(e,t){if(Kn)return"compositionend"===e||!Mn&&Hn(e,t)?(e=en(),$t=qt=jt=null,Kn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Tn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(i=Pi(i,"onBeforeInput")).length&&(r=new yn("onBeforeInput","beforeinput",null,n,r),o.push({event:r,listeners:i}),r.data=m))}Vi(o,t)}))}function zi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Pi(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=Fe(e,n))&&i.unshift(zi(e,s,r)),null!=(s=Fe(e,t))&&i.push(zi(e,s,r))),e=e.return}return i}function Ui(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function _i(e,t,n,i,r){for(var s=t._reactName,o=[];null!==n&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===i)break;5===a.tag&&null!==c&&(a=c,r?null!=(l=Fe(n,s))&&o.unshift(zi(n,l,a)):r||null!=(l=Fe(n,s))&&o.push(zi(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Oi=/\r\n?/g,Ji=/\u0000|\uFFFD/g;function ji(e){return("string"===typeof e?e:""+e).replace(Oi,"\n").replace(Ji,"")}function qi(e,t,n){if(t=ji(t),ji(e)!==t&&n)throw Error(s(425))}function $i(){}var er=null,tr=null;function nr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ir="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,sr="function"===typeof Promise?Promise:void 0,or="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sr?function(e){return sr.resolve(null).then(e).catch(ar)}:ir;function ar(e){setTimeout((function(){throw e}))}function lr(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return e.removeChild(r),void Kt(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);Kt(t)}function cr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function gr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ur=Math.random().toString(36).slice(2),Ar="__reactFiber$"+ur,dr="__reactProps$"+ur,hr="__reactContainer$"+ur,Ir="__reactEvents$"+ur,pr="__reactListeners$"+ur,Cr="__reactHandles$"+ur;function mr(e){var t=e[Ar];if(t)return t;for(var n=e.parentNode;n;){if(t=n[hr]||n[Ar]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=gr(e);null!==e;){if(n=e[Ar])return n;e=gr(e)}return t}n=(e=n).parentNode}return null}function fr(e){return!(e=e[Ar]||e[hr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function yr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function br(e){return e[dr]||null}var Br=[],vr=-1;function wr(e){return{current:e}}function Gr(e){0>vr||(e.current=Br[vr],Br[vr]=null,vr--)}function Er(e,t){vr++,Br[vr]=e.current,e.current=t}var xr={},Sr=wr(xr),Rr=wr(!1),Zr=xr;function Dr(e,t){var n=e.type.contextTypes;if(!n)return xr;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Fr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Nr(){Gr(Rr),Gr(Sr)}function Mr(e,t,n){if(Sr.current!==xr)throw Error(s(168));Er(Sr,t),Er(Rr,n)}function Wr(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in t))throw Error(s(108,X(e)||"Unknown",r));return T({},n,i)}function kr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||xr,Zr=Sr.current,Er(Sr,e),Er(Rr,Rr.current),!0}function Tr(e,t,n){var i=e.stateNode;if(!i)throw Error(s(169));n?(e=Wr(e,t,Zr),i.__reactInternalMemoizedMergedChildContext=e,Gr(Rr),Gr(Sr),Er(Sr,e)):Gr(Rr),Er(Rr,n)}var Vr=null,Lr=!1,Hr=!1;function Qr(e){null===Vr?Vr=[e]:Vr.push(e)}function Kr(){if(!Hr&&null!==Vr){Hr=!0;var e=0,t=ft;try{var n=Vr;for(ft=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}Vr=null,Lr=!1}catch(r){throw null!==Vr&&(Vr=Vr.slice(e+1)),Ue($e,Kr),r}finally{ft=t,Hr=!1}}return null}var Xr=[],Yr=0,zr=null,Pr=0,Ur=[],_r=0,Or=null,Jr=1,jr="";function qr(e,t){Xr[Yr++]=Pr,Xr[Yr++]=zr,zr=e,Pr=t}function $r(e,t,n){Ur[_r++]=Jr,Ur[_r++]=jr,Ur[_r++]=Or,Or=e;var i=Jr;e=jr;var r=32-ot(i)-1;i&=~(1<<r),n+=1;var s=32-ot(t)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,Jr=1<<32-ot(t)+r|n<<r|i,jr=s+e}else Jr=1<<s|n<<r|i,jr=e}function es(e){null!==e.return&&(qr(e,1),$r(e,1,0))}function ts(e){for(;e===zr;)zr=Xr[--Yr],Xr[Yr]=null,Pr=Xr[--Yr],Xr[Yr]=null;for(;e===Or;)Or=Ur[--_r],Ur[_r]=null,jr=Ur[--_r],Ur[_r]=null,Jr=Ur[--_r],Ur[_r]=null}var ns=null,is=null,rs=!1,ss=null;function os(e,t){var n=Dc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function as(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,is=cr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,is=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Or?{id:Jr,overflow:jr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Dc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,is=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(rs){var t=is;if(t){var n=t;if(!as(e,t)){if(ls(e))throw Error(s(418));t=cr(n.nextSibling);var i=ns;t&&as(e,t)?os(i,n):(e.flags=-4097&e.flags|2,rs=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,rs=!1,ns=e}}}function gs(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function us(e){if(e!==ns)return!1;if(!rs)return gs(e),rs=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!nr(e.type,e.memoizedProps)),t&&(t=is)){if(ls(e))throw As(),Error(s(418));for(;t;)os(e,t),t=cr(t.nextSibling)}if(gs(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){is=cr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}is=null}}else is=ns?cr(e.stateNode.nextSibling):null;return!0}function As(){for(var e=is;e;)e=cr(e.nextSibling)}function ds(){is=ns=null,rs=!1}function hs(e){null===ss?ss=[e]:ss.push(e)}var Is=y.ReactCurrentBatchConfig;function ps(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var i=n.stateNode}if(!i)throw Error(s(147,e));var r=i,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=r.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function Cs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ms(e){return(0,e._init)(e._payload)}function fs(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Nc(e,t)).index=0,e.sibling=null,e}function o(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=Tc(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,i){var s=n.type;return s===v?u(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===F&&ms(s)===t.type)?((i=r(t,n.props)).ref=ps(e,t,n),i.return=e,i):((i=Mc(n.type,n.key,n.props,null,e.mode,i)).ref=ps(e,t,n),i.return=e,i)}function g(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Vc(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function u(e,t,n,i,s){return null===t||7!==t.tag?((t=Wc(n,e.mode,i,s)).return=e,t):((t=r(t,n)).return=e,t)}function A(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Tc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case b:return(n=Mc(t.type,t.key,t.props,null,e.mode,n)).ref=ps(e,null,t),n.return=e,n;case B:return(t=Vc(t,e.mode,n)).return=e,t;case F:return A(e,(0,t._init)(t._payload),n)}if(te(t)||W(t))return(t=Wc(t,e.mode,n,null)).return=e,t;Cs(e,t)}return null}function d(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case b:return n.key===r?c(e,t,n,i):null;case B:return n.key===r?g(e,t,n,i):null;case F:return d(e,t,(r=n._init)(n._payload),i)}if(te(n)||W(n))return null!==r?null:u(e,t,n,i,null);Cs(e,n)}return null}function h(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return l(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case b:return c(t,e=e.get(null===i.key?n:i.key)||null,i,r);case B:return g(t,e=e.get(null===i.key?n:i.key)||null,i,r);case F:return h(e,t,n,(0,i._init)(i._payload),r)}if(te(i)||W(i))return u(t,e=e.get(n)||null,i,r,null);Cs(t,i)}return null}function I(r,s,a,l){for(var c=null,g=null,u=s,I=s=0,p=null;null!==u&&I<a.length;I++){u.index>I?(p=u,u=null):p=u.sibling;var C=d(r,u,a[I],l);if(null===C){null===u&&(u=p);break}e&&u&&null===C.alternate&&t(r,u),s=o(C,s,I),null===g?c=C:g.sibling=C,g=C,u=p}if(I===a.length)return n(r,u),rs&&qr(r,I),c;if(null===u){for(;I<a.length;I++)null!==(u=A(r,a[I],l))&&(s=o(u,s,I),null===g?c=u:g.sibling=u,g=u);return rs&&qr(r,I),c}for(u=i(r,u);I<a.length;I++)null!==(p=h(u,r,I,a[I],l))&&(e&&null!==p.alternate&&u.delete(null===p.key?I:p.key),s=o(p,s,I),null===g?c=p:g.sibling=p,g=p);return e&&u.forEach((function(e){return t(r,e)})),rs&&qr(r,I),c}function p(r,a,l,c){var g=W(l);if("function"!==typeof g)throw Error(s(150));if(null==(l=g.call(l)))throw Error(s(151));for(var u=g=null,I=a,p=a=0,C=null,m=l.next();null!==I&&!m.done;p++,m=l.next()){I.index>p?(C=I,I=null):C=I.sibling;var f=d(r,I,m.value,c);if(null===f){null===I&&(I=C);break}e&&I&&null===f.alternate&&t(r,I),a=o(f,a,p),null===u?g=f:u.sibling=f,u=f,I=C}if(m.done)return n(r,I),rs&&qr(r,p),g;if(null===I){for(;!m.done;p++,m=l.next())null!==(m=A(r,m.value,c))&&(a=o(m,a,p),null===u?g=m:u.sibling=m,u=m);return rs&&qr(r,p),g}for(I=i(r,I);!m.done;p++,m=l.next())null!==(m=h(I,r,p,m.value,c))&&(e&&null!==m.alternate&&I.delete(null===m.key?p:m.key),a=o(m,a,p),null===u?g=m:u.sibling=m,u=m);return e&&I.forEach((function(e){return t(r,e)})),rs&&qr(r,p),g}return function e(i,s,o,l){if("object"===typeof o&&null!==o&&o.type===v&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case b:e:{for(var c=o.key,g=s;null!==g;){if(g.key===c){if((c=o.type)===v){if(7===g.tag){n(i,g.sibling),(s=r(g,o.props.children)).return=i,i=s;break e}}else if(g.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===F&&ms(c)===g.type){n(i,g.sibling),(s=r(g,o.props)).ref=ps(i,g,o),s.return=i,i=s;break e}n(i,g);break}t(i,g),g=g.sibling}o.type===v?((s=Wc(o.props.children,i.mode,l,o.key)).return=i,i=s):((l=Mc(o.type,o.key,o.props,null,i.mode,l)).ref=ps(i,s,o),l.return=i,i=l)}return a(i);case B:e:{for(g=o.key;null!==s;){if(s.key===g){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(i,s.sibling),(s=r(s,o.children||[])).return=i,i=s;break e}n(i,s);break}t(i,s),s=s.sibling}(s=Vc(o,i.mode,l)).return=i,i=s}return a(i);case F:return e(i,s,(g=o._init)(o._payload),l)}if(te(o))return I(i,s,o,l);if(W(o))return p(i,s,o,l);Cs(i,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(i,s.sibling),(s=r(s,o)).return=i,i=s):(n(i,s),(s=Tc(o,i.mode,l)).return=i,i=s),a(i)):n(i,s)}}var ys=fs(!0),bs=fs(!1),Bs=wr(null),vs=null,ws=null,Gs=null;function Es(){Gs=ws=vs=null}function xs(e){var t=Bs.current;Gr(Bs),e._currentValue=t}function Ss(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Rs(e,t){vs=e,Gs=ws=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(fa=!0),e.firstContext=null)}function Zs(e){var t=e._currentValue;if(Gs!==e)if(e={context:e,memoizedValue:t,next:null},null===ws){if(null===vs)throw Error(s(308));ws=e,vs.dependencies={lanes:0,firstContext:e}}else ws=ws.next=e;return t}var Ds=null;function Fs(e){null===Ds?Ds=[e]:Ds.push(e)}function Ns(e,t,n,i){var r=t.interleaved;return null===r?(n.next=n,Fs(t)):(n.next=r.next,r.next=n),t.interleaved=n,Ms(e,i)}function Ms(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ws=!1;function ks(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ts(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Vs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ls(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&Sl)){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,Ms(e,n)}return null===(r=i.interleaved)?(t.next=t,Fs(i)):(t.next=r.next,r.next=t),i.interleaved=t,Ms(e,n)}function Hs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,mt(e,n)}}function Qs(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ks(e,t,n,i){var r=e.updateQueue;Ws=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var g=e.alternate;null!==g&&((a=(g=g.updateQueue).lastBaseUpdate)!==o&&(null===a?g.firstBaseUpdate=c:a.next=c,g.lastBaseUpdate=l))}if(null!==s){var u=r.baseState;for(o=0,g=c=l=null,a=s;;){var A=a.lane,d=a.eventTime;if((i&A)===A){null!==g&&(g=g.next={eventTime:d,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var h=e,I=a;switch(A=t,d=n,I.tag){case 1:if("function"===typeof(h=I.payload)){u=h.call(d,u,A);break e}u=h;break e;case 3:h.flags=-65537&h.flags|128;case 0:if(null===(A="function"===typeof(h=I.payload)?h.call(d,u,A):h)||void 0===A)break e;u=T({},u,A);break e;case 2:Ws=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(A=r.effects)?r.effects=[a]:A.push(a))}else d={eventTime:d,lane:A,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===g?(c=g=d,l=u):g=g.next=d,o|=A;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(A=a).next,A.next=null,r.lastBaseUpdate=A,r.shared.pending=null}}if(null===g&&(l=u),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=g,null!==(t=r.shared.interleaved)){r=t;do{o|=r.lane,r=r.next}while(r!==t)}else null===s&&(r.shared.lanes=0);kl|=o,e.lanes=o,e.memoizedState=u}}function Xs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(s(191,r));r.call(i)}}}var Ys={},zs=wr(Ys),Ps=wr(Ys),Us=wr(Ys);function _s(e){if(e===Ys)throw Error(s(174));return e}function Os(e,t){switch(Er(Us,t),Er(Ps,e),Er(zs,Ys),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Gr(zs),Er(zs,t)}function Js(){Gr(zs),Gr(Ps),Gr(Us)}function js(e){_s(Us.current);var t=_s(zs.current),n=le(t,e.type);t!==n&&(Er(Ps,e),Er(zs,n))}function qs(e){Ps.current===e&&(Gr(zs),Gr(Ps))}var $s=wr(0);function eo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function no(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var io=y.ReactCurrentDispatcher,ro=y.ReactCurrentBatchConfig,so=0,oo=null,ao=null,lo=null,co=!1,go=!1,uo=0,Ao=0;function ho(){throw Error(s(321))}function Io(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ai(e[n],t[n]))return!1;return!0}function po(e,t,n,i,r,o){if(so=o,oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,io.current=null===e||null===e.memoizedState?$o:ea,e=n(i,r),go){o=0;do{if(go=!1,uo=0,25<=o)throw Error(s(301));o+=1,lo=ao=null,t.updateQueue=null,io.current=ta,e=n(i,r)}while(go)}if(io.current=qo,t=null!==ao&&null!==ao.next,so=0,lo=ao=oo=null,co=!1,t)throw Error(s(300));return e}function Co(){var e=0!==uo;return uo=0,e}function mo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lo?oo.memoizedState=lo=e:lo=lo.next=e,lo}function fo(){if(null===ao){var e=oo.alternate;e=null!==e?e.memoizedState:null}else e=ao.next;var t=null===lo?oo.memoizedState:lo.next;if(null!==t)lo=t,ao=e;else{if(null===e)throw Error(s(310));e={memoizedState:(ao=e).memoizedState,baseState:ao.baseState,baseQueue:ao.baseQueue,queue:ao.queue,next:null},null===lo?oo.memoizedState=lo=e:lo=lo.next=e}return lo}function yo(e,t){return"function"===typeof t?t(e):t}function bo(e){var t=fo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=ao,r=i.baseQueue,o=n.pending;if(null!==o){if(null!==r){var a=r.next;r.next=o.next,o.next=a}i.baseQueue=r=o,n.pending=null}if(null!==r){o=r.next,i=i.baseState;var l=a=null,c=null,g=o;do{var u=g.lane;if((so&u)===u)null!==c&&(c=c.next={lane:0,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null}),i=g.hasEagerState?g.eagerState:e(i,g.action);else{var A={lane:u,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null};null===c?(l=c=A,a=i):c=c.next=A,oo.lanes|=u,kl|=u}g=g.next}while(null!==g&&g!==o);null===c?a=i:c.next=l,ai(i,t.memoizedState)||(fa=!0),t.memoizedState=i,t.baseState=a,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){r=e;do{o=r.lane,oo.lanes|=o,kl|=o,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Bo(e){var t=fo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,o=t.memoizedState;if(null!==r){n.pending=null;var a=r=r.next;do{o=e(o,a.action),a=a.next}while(a!==r);ai(o,t.memoizedState)||(fa=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,i]}function vo(){}function wo(e,t){var n=oo,i=fo(),r=t(),o=!ai(i.memoizedState,r);if(o&&(i.memoizedState=r,fa=!0),i=i.queue,ko(xo.bind(null,n,i,e),[e]),i.getSnapshot!==t||o||null!==lo&&1&lo.memoizedState.tag){if(n.flags|=2048,Do(9,Eo.bind(null,n,i,r,t),void 0,null),null===Rl)throw Error(s(349));0!==(30&so)||Go(n,t,r)}return r}function Go(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Eo(e,t,n,i){t.value=n,t.getSnapshot=i,So(t)&&Ro(e)}function xo(e,t,n){return n((function(){So(t)&&Ro(e)}))}function So(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ai(e,n)}catch(i){return!0}}function Ro(e){var t=Ms(e,1);null!==t&&nc(t,e,1,-1)}function Zo(e){var t=mo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yo,lastRenderedState:e},t.queue=e,e=e.dispatch=_o.bind(null,oo,e),[t.memoizedState,e]}function Do(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Fo(){return fo().memoizedState}function No(e,t,n,i){var r=mo();oo.flags|=e,r.memoizedState=Do(1|t,n,void 0,void 0===i?null:i)}function Mo(e,t,n,i){var r=fo();i=void 0===i?null:i;var s=void 0;if(null!==ao){var o=ao.memoizedState;if(s=o.destroy,null!==i&&Io(i,o.deps))return void(r.memoizedState=Do(t,n,s,i))}oo.flags|=e,r.memoizedState=Do(1|t,n,s,i)}function Wo(e,t){return No(8390656,8,e,t)}function ko(e,t){return Mo(2048,8,e,t)}function To(e,t){return Mo(4,2,e,t)}function Vo(e,t){return Mo(4,4,e,t)}function Lo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ho(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Mo(4,4,Lo.bind(null,t,e),n)}function Qo(){}function Ko(e,t){var n=fo();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&Io(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Xo(e,t){var n=fo();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&Io(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Yo(e,t,n){return 0===(21&so)?(e.baseState&&(e.baseState=!1,fa=!0),e.memoizedState=n):(ai(n,t)||(n=It(),oo.lanes|=n,kl|=n,e.baseState=!0),t)}function zo(e,t){var n=ft;ft=0!==n&&4>n?n:4,e(!0);var i=ro.transition;ro.transition={};try{e(!1),t()}finally{ft=n,ro.transition=i}}function Po(){return fo().memoizedState}function Uo(e,t,n){var i=tc(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Oo(e))Jo(t,n);else if(null!==(n=Ns(e,t,n,i))){nc(n,e,i,ec()),jo(n,t,i)}}function _o(e,t,n){var i=tc(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Oo(e))Jo(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,ai(a,o)){var l=t.interleaved;return null===l?(r.next=r,Fs(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(c){}null!==(n=Ns(e,t,r,i))&&(nc(n,e,i,r=ec()),jo(n,t,i))}}function Oo(e){var t=e.alternate;return e===oo||null!==t&&t===oo}function Jo(e,t){go=co=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function jo(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,mt(e,n)}}var qo={readContext:Zs,useCallback:ho,useContext:ho,useEffect:ho,useImperativeHandle:ho,useInsertionEffect:ho,useLayoutEffect:ho,useMemo:ho,useReducer:ho,useRef:ho,useState:ho,useDebugValue:ho,useDeferredValue:ho,useTransition:ho,useMutableSource:ho,useSyncExternalStore:ho,useId:ho,unstable_isNewReconciler:!1},$o={readContext:Zs,useCallback:function(e,t){return mo().memoizedState=[e,void 0===t?null:t],e},useContext:Zs,useEffect:Wo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,No(4194308,4,Lo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return No(4194308,4,e,t)},useInsertionEffect:function(e,t){return No(4,2,e,t)},useMemo:function(e,t){var n=mo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=mo();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=Uo.bind(null,oo,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},mo().memoizedState=e},useState:Zo,useDebugValue:Qo,useDeferredValue:function(e){return mo().memoizedState=e},useTransition:function(){var e=Zo(!1),t=e[0];return e=zo.bind(null,e[1]),mo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=oo,r=mo();if(rs){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Rl)throw Error(s(349));0!==(30&so)||Go(i,t,n)}r.memoizedState=n;var o={value:n,getSnapshot:t};return r.queue=o,Wo(xo.bind(null,i,o,e),[e]),i.flags|=2048,Do(9,Eo.bind(null,i,o,n,t),void 0,null),n},useId:function(){var e=mo(),t=Rl.identifierPrefix;if(rs){var n=jr;t=":"+t+"R"+(n=(Jr&~(1<<32-ot(Jr)-1)).toString(32)+n),0<(n=uo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=Ao++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ea={readContext:Zs,useCallback:Ko,useContext:Zs,useEffect:ko,useImperativeHandle:Ho,useInsertionEffect:To,useLayoutEffect:Vo,useMemo:Xo,useReducer:bo,useRef:Fo,useState:function(){return bo(yo)},useDebugValue:Qo,useDeferredValue:function(e){return Yo(fo(),ao.memoizedState,e)},useTransition:function(){return[bo(yo)[0],fo().memoizedState]},useMutableSource:vo,useSyncExternalStore:wo,useId:Po,unstable_isNewReconciler:!1},ta={readContext:Zs,useCallback:Ko,useContext:Zs,useEffect:ko,useImperativeHandle:Ho,useInsertionEffect:To,useLayoutEffect:Vo,useMemo:Xo,useReducer:Bo,useRef:Fo,useState:function(){return Bo(yo)},useDebugValue:Qo,useDeferredValue:function(e){var t=fo();return null===ao?t.memoizedState=e:Yo(t,ao.memoizedState,e)},useTransition:function(){return[Bo(yo)[0],fo().memoizedState]},useMutableSource:vo,useSyncExternalStore:wo,useId:Po,unstable_isNewReconciler:!1};function na(e,t){if(e&&e.defaultProps){for(var n in t=T({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ia(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:T({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ra={isMounted:function(e){return!!(e=e._reactInternals)&&Ke(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=ec(),r=tc(e),s=Vs(i,r);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Ls(e,s,r))&&(nc(t,e,r,i),Hs(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=ec(),r=tc(e),s=Vs(i,r);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Ls(e,s,r))&&(nc(t,e,r,i),Hs(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),i=tc(e),r=Vs(n,i);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Ls(e,r,i))&&(nc(t,e,i,n),Hs(t,e,i))}};function sa(e,t,n,i,r,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!li(n,i)||!li(r,s))}function oa(e,t,n){var i=!1,r=xr,s=t.contextType;return"object"===typeof s&&null!==s?s=Zs(s):(r=Fr(t)?Zr:Sr.current,s=(i=null!==(i=t.contextTypes)&&void 0!==i)?Dr(e,r):xr),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ra,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function aa(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&ra.enqueueReplaceState(t,t.state,null)}function la(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},ks(e);var s=t.contextType;"object"===typeof s&&null!==s?r.context=Zs(s):(s=Fr(t)?Zr:Sr.current,r.context=Dr(e,s)),r.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(ia(e,t,s,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&ra.enqueueReplaceState(r,r.state,null),Ks(e,n,r,i),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function ca(e,t){try{var n="",i=t;do{n+=Q(i),i=i.return}while(i);var r=n}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:r,digest:null}}function ga(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ua(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var Aa="function"===typeof WeakMap?WeakMap:Map;function da(e,t,n){(n=Vs(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){Yl||(Yl=!0,zl=i),ua(0,t)},n}function ha(e,t,n){(n=Vs(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){ua(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){ua(0,t),"function"!==typeof i&&(null===Pl?Pl=new Set([this]):Pl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function Ia(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new Aa;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=Gc.bind(null,e,t,n),t.then(e,e))}function pa(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function Ca(e,t,n,i,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Vs(-1,1)).tag=2,Ls(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var ma=y.ReactCurrentOwner,fa=!1;function ya(e,t,n,i){t.child=null===e?bs(t,null,n,i):ys(t,e.child,n,i)}function ba(e,t,n,i,r){n=n.render;var s=t.ref;return Rs(t,r),i=po(e,t,n,i,s,r),n=Co(),null===e||fa?(rs&&n&&es(t),t.flags|=1,ya(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Ya(e,t,r))}function Ba(e,t,n,i,r){if(null===e){var s=n.type;return"function"!==typeof s||Fc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Mc(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,va(e,t,s,i,r))}if(s=e.child,0===(e.lanes&r)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:li)(o,i)&&e.ref===t.ref)return Ya(e,t,r)}return t.flags|=1,(e=Nc(s,i)).ref=t.ref,e.return=t,t.child=e}function va(e,t,n,i,r){if(null!==e){var s=e.memoizedProps;if(li(s,i)&&e.ref===t.ref){if(fa=!1,t.pendingProps=i=s,0===(e.lanes&r))return t.lanes=e.lanes,Ya(e,t,r);0!==(131072&e.flags)&&(fa=!0)}}return Ea(e,t,n,i,r)}function wa(e,t,n){var i=t.pendingProps,r=i.children,s=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Er(Nl,Fl),Fl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Er(Nl,Fl),Fl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==s?s.baseLanes:n,Er(Nl,Fl),Fl|=i}else null!==s?(i=s.baseLanes|n,t.memoizedState=null):i=n,Er(Nl,Fl),Fl|=i;return ya(e,t,r,n),t.child}function Ga(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ea(e,t,n,i,r){var s=Fr(n)?Zr:Sr.current;return s=Dr(t,s),Rs(t,r),n=po(e,t,n,i,s,r),i=Co(),null===e||fa?(rs&&i&&es(t),t.flags|=1,ya(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Ya(e,t,r))}function xa(e,t,n,i,r){if(Fr(n)){var s=!0;kr(t)}else s=!1;if(Rs(t,r),null===t.stateNode)Xa(e,t),oa(t,n,i),la(t,n,i,r),i=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Zs(c):c=Dr(t,c=Fr(n)?Zr:Sr.current);var g=n.getDerivedStateFromProps,u="function"===typeof g||"function"===typeof o.getSnapshotBeforeUpdate;u||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==i||l!==c)&&aa(t,o,i,c),Ws=!1;var A=t.memoizedState;o.state=A,Ks(t,i,o,r),l=t.memoizedState,a!==i||A!==l||Rr.current||Ws?("function"===typeof g&&(ia(t,n,g,i),l=t.memoizedState),(a=Ws||sa(t,n,a,i,A,l,c))?(u||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),o.props=i,o.state=l,o.context=c,i=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,Ts(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:na(t.type,a),o.props=c,u=t.pendingProps,A=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Zs(l):l=Dr(t,l=Fr(n)?Zr:Sr.current);var d=n.getDerivedStateFromProps;(g="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==u||A!==l)&&aa(t,o,i,l),Ws=!1,A=t.memoizedState,o.state=A,Ks(t,i,o,r);var h=t.memoizedState;a!==u||A!==h||Rr.current||Ws?("function"===typeof d&&(ia(t,n,d,i),h=t.memoizedState),(c=Ws||sa(t,n,c,i,A,h,l)||!1)?(g||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(i,h,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,h,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&A===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&A===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=h),o.props=i,o.state=h,o.context=l,i=c):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&A===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&A===e.memoizedState||(t.flags|=1024),i=!1)}return Sa(e,t,n,i,s,r)}function Sa(e,t,n,i,r,s){Ga(e,t);var o=0!==(128&t.flags);if(!i&&!o)return r&&Tr(t,n,!1),Ya(e,t,s);i=t.stateNode,ma.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&o?(t.child=ys(t,e.child,null,s),t.child=ys(t,null,a,s)):ya(e,t,a,s),t.memoizedState=i.state,r&&Tr(t,n,!0),t.child}function Ra(e){var t=e.stateNode;t.pendingContext?Mr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Mr(0,t.context,!1),Os(e,t.containerInfo)}function Za(e,t,n,i,r){return ds(),hs(r),t.flags|=256,ya(e,t,n,i),t.child}var Da,Fa,Na,Ma,Wa={dehydrated:null,treeContext:null,retryLane:0};function ka(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ta(e,t,n){var i,r=t.pendingProps,o=$s.current,a=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&o)),i?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Er($s,1&o),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,a?(r=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=kc(l,r,0,null),e=Wc(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=ka(n),t.memoizedState=Wa,e):Va(t,l));if(null!==(o=e.memoizedState)&&null!==(i=o.dehydrated))return function(e,t,n,i,r,o,a){if(n)return 256&t.flags?(t.flags&=-257,La(e,t,a,i=ga(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=i.fallback,r=t.mode,i=kc({mode:"visible",children:i.children},r,0,null),(o=Wc(o,r,a,null)).flags|=2,i.return=t,o.return=t,i.sibling=o,t.child=i,0!==(1&t.mode)&&ys(t,e.child,null,a),t.child.memoizedState=ka(a),t.memoizedState=Wa,o);if(0===(1&t.mode))return La(e,t,a,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var l=i.dgst;return i=l,La(e,t,a,i=ga(o=Error(s(419)),i,void 0))}if(l=0!==(a&e.childLanes),fa||l){if(null!==(i=Rl)){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(i.suspendedLanes|a))?0:r)&&r!==o.retryLane&&(o.retryLane=r,Ms(e,r),nc(i,e,r,-1))}return Ic(),La(e,t,a,i=ga(Error(s(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=xc.bind(null,e),r._reactRetry=t,null):(e=o.treeContext,is=cr(r.nextSibling),ns=t,rs=!0,ss=null,null!==e&&(Ur[_r++]=Jr,Ur[_r++]=jr,Ur[_r++]=Or,Jr=e.id,jr=e.overflow,Or=t),t=Va(t,i.children),t.flags|=4096,t)}(e,t,l,r,i,o,n);if(a){a=r.fallback,l=t.mode,i=(o=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==o?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=Nc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==i?a=Nc(i,a):(a=Wc(a,l,n,null)).flags|=2,a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,l=null===(l=e.child.memoizedState)?ka(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Wa,r}return e=(a=e.child).sibling,r=Nc(a,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Va(e,t){return(t=kc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function La(e,t,n,i){return null!==i&&hs(i),ys(t,e.child,null,n),(e=Va(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ha(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Ss(e.return,t,n)}function Qa(e,t,n,i,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function Ka(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(ya(e,t,i.children,n),0!==(2&(i=$s.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ha(e,n,t);else if(19===e.tag)Ha(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Er($s,i),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===eo(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Qa(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===eo(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Qa(t,!0,n,null,s);break;case"together":Qa(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Xa(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ya(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),kl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Nc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Nc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function za(e,t){if(!rs)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Pa(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Ua(e,t,n){var i=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pa(t),null;case 1:case 17:return Fr(t.type)&&Nr(),Pa(t),null;case 3:return i=t.stateNode,Js(),Gr(Rr),Gr(Sr),no(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(us(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(oc(ss),ss=null))),Fa(e,t),Pa(t),null;case 5:qs(t);var r=_s(Us.current);if(n=t.type,null!==e&&null!=t.stateNode)Na(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(s(166));return Pa(t),null}if(e=_s(zs.current),us(t)){i=t.stateNode,n=t.type;var o=t.memoizedProps;switch(i[Ar]=t,i[dr]=o,e=0!==(1&t.mode),n){case"dialog":Li("cancel",i),Li("close",i);break;case"iframe":case"object":case"embed":Li("load",i);break;case"video":case"audio":for(r=0;r<Wi.length;r++)Li(Wi[r],i);break;case"source":Li("error",i);break;case"img":case"image":case"link":Li("error",i),Li("load",i);break;case"details":Li("toggle",i);break;case"input":J(i,o),Li("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},Li("invalid",i);break;case"textarea":re(i,o),Li("invalid",i)}for(var l in me(n,o),r=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?i.textContent!==c&&(!0!==o.suppressHydrationWarning&&qi(i.textContent,c,e),r=["children",c]):"number"===typeof c&&i.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&qi(i.textContent,c,e),r=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Li("scroll",i)}switch(n){case"input":P(i),$(i,o,!0);break;case"textarea":P(i),oe(i);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(i.onclick=$i)}i=r,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof i.is?e=l.createElement(n,{is:i.is}):(e=l.createElement(n),"select"===n&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,n),e[Ar]=t,e[dr]=i,Da(e,t,!1,!1),t.stateNode=e;e:{switch(l=fe(n,i),n){case"dialog":Li("cancel",e),Li("close",e),r=i;break;case"iframe":case"object":case"embed":Li("load",e),r=i;break;case"video":case"audio":for(r=0;r<Wi.length;r++)Li(Wi[r],e);r=i;break;case"source":Li("error",e),r=i;break;case"img":case"image":case"link":Li("error",e),Li("load",e),r=i;break;case"details":Li("toggle",e),r=i;break;case"input":J(e,i),r=O(e,i),Li("invalid",e);break;case"option":default:r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=T({},i,{value:void 0}),Li("invalid",e);break;case"textarea":re(e,i),r=ie(e,i),Li("invalid",e)}for(o in me(n,r),c=r)if(c.hasOwnProperty(o)){var g=c[o];"style"===o?pe(e,g):"dangerouslySetInnerHTML"===o?null!=(g=g?g.__html:void 0)&&ue(e,g):"children"===o?"string"===typeof g?("textarea"!==n||""!==g)&&Ae(e,g):"number"===typeof g&&Ae(e,""+g):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=g&&"onScroll"===o&&Li("scroll",e):null!=g&&f(e,o,g,l))}switch(n){case"input":P(e),$(e,i,!1);break;case"textarea":P(e),oe(e);break;case"option":null!=i.value&&e.setAttribute("value",""+Y(i.value));break;case"select":e.multiple=!!i.multiple,null!=(o=i.value)?ne(e,!!i.multiple,o,!1):null!=i.defaultValue&&ne(e,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=$i)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Pa(t),null;case 6:if(e&&null!=t.stateNode)Ma(e,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(s(166));if(n=_s(Us.current),_s(zs.current),us(t)){if(i=t.stateNode,n=t.memoizedProps,i[Ar]=t,(o=i.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:qi(i.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&qi(i.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[Ar]=t,t.stateNode=i}return Pa(t),null;case 13:if(Gr($s),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(rs&&null!==is&&0!==(1&t.mode)&&0===(128&t.flags))As(),ds(),t.flags|=98560,o=!1;else if(o=us(t),null!==i&&null!==i.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[Ar]=t}else ds(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Pa(t),o=!1}else null!==ss&&(oc(ss),ss=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&$s.current)?0===Ml&&(Ml=3):Ic())),null!==t.updateQueue&&(t.flags|=4),Pa(t),null);case 4:return Js(),Fa(e,t),null===e&&Ki(t.stateNode.containerInfo),Pa(t),null;case 10:return xs(t.type._context),Pa(t),null;case 19:if(Gr($s),null===(o=t.memoizedState))return Pa(t),null;if(i=0!==(128&t.flags),null===(l=o.rendering))if(i)za(o,!1);else{if(0!==Ml||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=eo(e))){for(t.flags|=128,za(o,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Er($s,1&$s.current|2),t.child}e=e.sibling}null!==o.tail&&je()>Kl&&(t.flags|=128,i=!0,za(o,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=eo(l))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),za(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!rs)return Pa(t),null}else 2*je()-o.renderingStartTime>Kl&&1073741824!==n&&(t.flags|=128,i=!0,za(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=je(),t.sibling=null,n=$s.current,Er($s,i?1&n|2:1&n),t):(Pa(t),null);case 22:case 23:return uc(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Fl)&&(Pa(t),6&t.subtreeFlags&&(t.flags|=8192)):Pa(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function _a(e,t){switch(ts(t),t.tag){case 1:return Fr(t.type)&&Nr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Js(),Gr(Rr),Gr(Sr),no(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return qs(t),null;case 13:if(Gr($s),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));ds()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Gr($s),null;case 4:return Js(),null;case 10:return xs(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}Da=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Fa=function(){},Na=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,_s(zs.current);var s,o=null;switch(n){case"input":r=O(e,r),i=O(e,i),o=[];break;case"select":r=T({},r,{value:void 0}),i=T({},i,{value:void 0}),o=[];break;case"textarea":r=ie(e,r),i=ie(e,i),o=[];break;default:"function"!==typeof r.onClick&&"function"===typeof i.onClick&&(e.onclick=$i)}for(g in me(n,i),n=null,r)if(!i.hasOwnProperty(g)&&r.hasOwnProperty(g)&&null!=r[g])if("style"===g){var l=r[g];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==g&&"children"!==g&&"suppressContentEditableWarning"!==g&&"suppressHydrationWarning"!==g&&"autoFocus"!==g&&(a.hasOwnProperty(g)?o||(o=[]):(o=o||[]).push(g,null));for(g in i){var c=i[g];if(l=null!=r?r[g]:void 0,i.hasOwnProperty(g)&&c!==l&&(null!=c||null!=l))if("style"===g)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(g,n)),n=c;else"dangerouslySetInnerHTML"===g?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(g,c)):"children"===g?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(g,""+c):"suppressContentEditableWarning"!==g&&"suppressHydrationWarning"!==g&&(a.hasOwnProperty(g)?(null!=c&&"onScroll"===g&&Li("scroll",e),o||l===c||(o=[])):(o=o||[]).push(g,c))}n&&(o=o||[]).push("style",n);var g=o;(t.updateQueue=g)&&(t.flags|=4)}},Ma=function(e,t,n,i){n!==i&&(t.flags|=4)};var Oa=!1,Ja=!1,ja="function"===typeof WeakSet?WeakSet:Set,qa=null;function $a(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){wc(e,t,i)}else n.current=null}function el(e,t,n){try{n()}catch(i){wc(e,t,i)}}var tl=!1;function nl(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&el(t,n,s)}r=r.next}while(r!==i)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function rl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[Ar],delete t[dr],delete t[Ir],delete t[pr],delete t[Cr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function al(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=$i));else if(4!==i&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var gl=null,ul=!1;function Al(e,t,n){for(n=n.child;null!==n;)dl(e,t,n),n=n.sibling}function dl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(rt,n)}catch(a){}switch(n.tag){case 5:Ja||$a(n,t);case 6:var i=gl,r=ul;gl=null,Al(e,t,n),ul=r,null!==(gl=i)&&(ul?(e=gl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):gl.removeChild(n.stateNode));break;case 18:null!==gl&&(ul?(e=gl,n=n.stateNode,8===e.nodeType?lr(e.parentNode,n):1===e.nodeType&&lr(e,n),Kt(e)):lr(gl,n.stateNode));break;case 4:i=gl,r=ul,gl=n.stateNode.containerInfo,ul=!0,Al(e,t,n),gl=i,ul=r;break;case 0:case 11:case 14:case 15:if(!Ja&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&el(n,t,o),r=r.next}while(r!==i)}Al(e,t,n);break;case 1:if(!Ja&&($a(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){wc(n,t,a)}Al(e,t,n);break;case 21:Al(e,t,n);break;case 22:1&n.mode?(Ja=(i=Ja)||null!==n.memoizedState,Al(e,t,n),Ja=i):Al(e,t,n);break;default:Al(e,t,n)}}function hl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new ja),t.forEach((function(t){var i=Sc.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}}function Il(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:gl=l.stateNode,ul=!1;break e;case 3:case 4:gl=l.stateNode.containerInfo,ul=!0;break e}l=l.return}if(null===gl)throw Error(s(160));dl(o,a,r),gl=null,ul=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(g){wc(r,t,g)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)pl(t,e),t=t.sibling}function pl(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Il(t,e),Cl(e),4&i){try{nl(3,e,e.return),il(3,e)}catch(p){wc(e,e.return,p)}try{nl(5,e,e.return)}catch(p){wc(e,e.return,p)}}break;case 1:Il(t,e),Cl(e),512&i&&null!==n&&$a(n,n.return);break;case 5:if(Il(t,e),Cl(e),512&i&&null!==n&&$a(n,n.return),32&e.flags){var r=e.stateNode;try{Ae(r,"")}catch(p){wc(e,e.return,p)}}if(4&i&&null!=(r=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&j(r,o),fe(l,a);var g=fe(l,o);for(a=0;a<c.length;a+=2){var u=c[a],A=c[a+1];"style"===u?pe(r,A):"dangerouslySetInnerHTML"===u?ue(r,A):"children"===u?Ae(r,A):f(r,u,A,g)}switch(l){case"input":q(r,o);break;case"textarea":se(r,o);break;case"select":var d=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var h=o.value;null!=h?ne(r,!!o.multiple,h,!1):d!==!!o.multiple&&(null!=o.defaultValue?ne(r,!!o.multiple,o.defaultValue,!0):ne(r,!!o.multiple,o.multiple?[]:"",!1))}r[dr]=o}catch(p){wc(e,e.return,p)}}break;case 6:if(Il(t,e),Cl(e),4&i){if(null===e.stateNode)throw Error(s(162));r=e.stateNode,o=e.memoizedProps;try{r.nodeValue=o}catch(p){wc(e,e.return,p)}}break;case 3:if(Il(t,e),Cl(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Kt(t.containerInfo)}catch(p){wc(e,e.return,p)}break;case 4:default:Il(t,e),Cl(e);break;case 13:Il(t,e),Cl(e),8192&(r=e.child).flags&&(o=null!==r.memoizedState,r.stateNode.isHidden=o,!o||null!==r.alternate&&null!==r.alternate.memoizedState||(Ql=je())),4&i&&hl(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?(Ja=(g=Ja)||u,Il(t,e),Ja=g):Il(t,e),Cl(e),8192&i){if(g=null!==e.memoizedState,(e.stateNode.isHidden=g)&&!u&&0!==(1&e.mode))for(qa=e,u=e.child;null!==u;){for(A=qa=u;null!==qa;){switch(h=(d=qa).child,d.tag){case 0:case 11:case 14:case 15:nl(4,d,d.return);break;case 1:$a(d,d.return);var I=d.stateNode;if("function"===typeof I.componentWillUnmount){i=d,n=d.return;try{t=i,I.props=t.memoizedProps,I.state=t.memoizedState,I.componentWillUnmount()}catch(p){wc(i,n,p)}}break;case 5:$a(d,d.return);break;case 22:if(null!==d.memoizedState){bl(A);continue}}null!==h?(h.return=d,qa=h):bl(A)}u=u.sibling}e:for(u=null,A=e;;){if(5===A.tag){if(null===u){u=A;try{r=A.stateNode,g?"function"===typeof(o=r.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=A.stateNode,a=void 0!==(c=A.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=Ie("display",a))}catch(p){wc(e,e.return,p)}}}else if(6===A.tag){if(null===u)try{A.stateNode.nodeValue=g?"":A.memoizedProps}catch(p){wc(e,e.return,p)}}else if((22!==A.tag&&23!==A.tag||null===A.memoizedState||A===e)&&null!==A.child){A.child.return=A,A=A.child;continue}if(A===e)break e;for(;null===A.sibling;){if(null===A.return||A.return===e)break e;u===A&&(u=null),A=A.return}u===A&&(u=null),A.sibling.return=A.return,A=A.sibling}}break;case 19:Il(t,e),Cl(e),4&i&&hl(e);case 21:}}function Cl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var i=n;break e}n=n.return}throw Error(s(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(Ae(r,""),i.flags&=-33),cl(e,al(e),r);break;case 3:case 4:var o=i.stateNode.containerInfo;ll(e,al(e),o);break;default:throw Error(s(161))}}catch(a){wc(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function ml(e,t,n){qa=e,fl(e,t,n)}function fl(e,t,n){for(var i=0!==(1&e.mode);null!==qa;){var r=qa,s=r.child;if(22===r.tag&&i){var o=null!==r.memoizedState||Oa;if(!o){var a=r.alternate,l=null!==a&&null!==a.memoizedState||Ja;a=Oa;var c=Ja;if(Oa=o,(Ja=l)&&!c)for(qa=r;null!==qa;)l=(o=qa).child,22===o.tag&&null!==o.memoizedState?Bl(r):null!==l?(l.return=o,qa=l):Bl(r);for(;null!==s;)qa=s,fl(s,t,n),s=s.sibling;qa=r,Oa=a,Ja=c}yl(e)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,qa=s):yl(e)}}function yl(e){for(;null!==qa;){var t=qa;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ja||il(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Ja)if(null===n)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:na(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Xs(t,o,i);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Xs(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var g=t.alternate;if(null!==g){var u=g.memoizedState;if(null!==u){var A=u.dehydrated;null!==A&&Kt(A)}}}break;default:throw Error(s(163))}Ja||512&t.flags&&rl(t)}catch(d){wc(t,t.return,d)}}if(t===e){qa=null;break}if(null!==(n=t.sibling)){n.return=t.return,qa=n;break}qa=t.return}}function bl(e){for(;null!==qa;){var t=qa;if(t===e){qa=null;break}var n=t.sibling;if(null!==n){n.return=t.return,qa=n;break}qa=t.return}}function Bl(e){for(;null!==qa;){var t=qa;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(l){wc(t,n,l)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(l){wc(t,r,l)}}var s=t.return;try{rl(t)}catch(l){wc(t,s,l)}break;case 5:var o=t.return;try{rl(t)}catch(l){wc(t,o,l)}}}catch(l){wc(t,t.return,l)}if(t===e){qa=null;break}var a=t.sibling;if(null!==a){a.return=t.return,qa=a;break}qa=t.return}}var vl,wl=Math.ceil,Gl=y.ReactCurrentDispatcher,El=y.ReactCurrentOwner,xl=y.ReactCurrentBatchConfig,Sl=0,Rl=null,Zl=null,Dl=0,Fl=0,Nl=wr(0),Ml=0,Wl=null,kl=0,Tl=0,Vl=0,Ll=null,Hl=null,Ql=0,Kl=1/0,Xl=null,Yl=!1,zl=null,Pl=null,Ul=!1,_l=null,Ol=0,Jl=0,jl=null,ql=-1,$l=0;function ec(){return 0!==(6&Sl)?je():-1!==ql?ql:ql=je()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Sl)&&0!==Dl?Dl&-Dl:null!==Is.transition?(0===$l&&($l=It()),$l):0!==(e=ft)?e:e=void 0===(e=window.event)?16:Jt(e.type)}function nc(e,t,n,i){if(50<Jl)throw Jl=0,jl=null,Error(s(185));Ct(e,n,i),0!==(2&Sl)&&e===Rl||(e===Rl&&(0===(2&Sl)&&(Tl|=n),4===Ml&&ac(e,Dl)),ic(e,i),1===n&&0===Sl&&0===(1&t.mode)&&(Kl=je()+500,Lr&&Kr()))}function ic(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-ot(s),a=1<<o,l=r[o];-1===l?0!==(a&n)&&0===(a&i)||(r[o]=dt(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var i=At(e,e===Rl?Dl:0);if(0===i)null!==n&&_e(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&_e(n),1===t)0===e.tag?function(e){Lr=!0,Qr(e)}(lc.bind(null,e)):Qr(lc.bind(null,e)),or((function(){0===(6&Sl)&&Kr()})),n=null;else{switch(yt(i)){case 1:n=$e;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=it}n=Rc(n,rc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function rc(e,t){if(ql=-1,$l=0,0!==(6&Sl))throw Error(s(327));var n=e.callbackNode;if(Bc()&&e.callbackNode!==n)return null;var i=At(e,e===Rl?Dl:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=pc(e,i);else{t=i;var r=Sl;Sl|=2;var o=hc();for(Rl===e&&Dl===t||(Xl=null,Kl=je()+500,Ac(e,t));;)try{mc();break}catch(l){dc(e,l)}Es(),Gl.current=o,Sl=r,null!==Zl?t=0:(Rl=null,Dl=0,t=Ml)}if(0!==t){if(2===t&&(0!==(r=ht(e))&&(i=r,t=sc(e,r))),1===t)throw n=Wl,Ac(e,0),ac(e,i),ic(e,je()),n;if(6===t)ac(e,i);else{if(r=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!ai(s(),r))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=pc(e,i))&&(0!==(o=ht(e))&&(i=o,t=sc(e,o))),1===t))throw n=Wl,Ac(e,0),ac(e,i),ic(e,je()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(s(345));case 2:case 5:bc(e,Hl,Xl);break;case 3:if(ac(e,i),(130023424&i)===i&&10<(t=Ql+500-je())){if(0!==At(e,0))break;if(((r=e.suspendedLanes)&i)!==i){ec(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=ir(bc.bind(null,e,Hl,Xl),t);break}bc(e,Hl,Xl);break;case 4:if(ac(e,i),(4194240&i)===i)break;for(t=e.eventTimes,r=-1;0<i;){var a=31-ot(i);o=1<<a,(a=t[a])>r&&(r=a),i&=~o}if(i=r,10<(i=(120>(i=je()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*wl(i/1960))-i)){e.timeoutHandle=ir(bc.bind(null,e,Hl,Xl),i);break}bc(e,Hl,Xl);break;default:throw Error(s(329))}}}return ic(e,je()),e.callbackNode===n?rc.bind(null,e):null}function sc(e,t){var n=Ll;return e.current.memoizedState.isDehydrated&&(Ac(e,t).flags|=256),2!==(e=pc(e,t))&&(t=Hl,Hl=n,null!==t&&oc(t)),e}function oc(e){null===Hl?Hl=e:Hl.push.apply(Hl,e)}function ac(e,t){for(t&=~Vl,t&=~Tl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),i=1<<n;e[n]=-1,t&=~i}}function lc(e){if(0!==(6&Sl))throw Error(s(327));Bc();var t=At(e,0);if(0===(1&t))return ic(e,je()),null;var n=pc(e,t);if(0!==e.tag&&2===n){var i=ht(e);0!==i&&(t=i,n=sc(e,i))}if(1===n)throw n=Wl,Ac(e,0),ac(e,t),ic(e,je()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bc(e,Hl,Xl),ic(e,je()),null}function cc(e,t){var n=Sl;Sl|=1;try{return e(t)}finally{0===(Sl=n)&&(Kl=je()+500,Lr&&Kr())}}function gc(e){null!==_l&&0===_l.tag&&0===(6&Sl)&&Bc();var t=Sl;Sl|=1;var n=xl.transition,i=ft;try{if(xl.transition=null,ft=1,e)return e()}finally{ft=i,xl.transition=n,0===(6&(Sl=t))&&Kr()}}function uc(){Fl=Nl.current,Gr(Nl)}function Ac(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,rr(n)),null!==Zl)for(n=Zl.return;null!==n;){var i=n;switch(ts(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Nr();break;case 3:Js(),Gr(Rr),Gr(Sr),no();break;case 5:qs(i);break;case 4:Js();break;case 13:case 19:Gr($s);break;case 10:xs(i.type._context);break;case 22:case 23:uc()}n=n.return}if(Rl=e,Zl=e=Nc(e.current,null),Dl=Fl=t,Ml=0,Wl=null,Vl=Tl=kl=0,Hl=Ll=null,null!==Ds){for(t=0;t<Ds.length;t++)if(null!==(i=(n=Ds[t]).interleaved)){n.interleaved=null;var r=i.next,s=n.pending;if(null!==s){var o=s.next;s.next=r,i.next=o}n.pending=i}Ds=null}return e}function dc(e,t){for(;;){var n=Zl;try{if(Es(),io.current=qo,co){for(var i=oo.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}co=!1}if(so=0,lo=ao=oo=null,go=!1,uo=0,El.current=null,null===n||null===n.return){Ml=1,Wl=t,Zl=null;break}e:{var o=e,a=n.return,l=n,c=t;if(t=Dl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var g=c,u=l,A=u.tag;if(0===(1&u.mode)&&(0===A||11===A||15===A)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=pa(a);if(null!==h){h.flags&=-257,Ca(h,a,l,0,t),1&h.mode&&Ia(o,g,t),c=g;var I=(t=h).updateQueue;if(null===I){var p=new Set;p.add(c),t.updateQueue=p}else I.add(c);break e}if(0===(1&t)){Ia(o,g,t),Ic();break e}c=Error(s(426))}else if(rs&&1&l.mode){var C=pa(a);if(null!==C){0===(65536&C.flags)&&(C.flags|=256),Ca(C,a,l,0,t),hs(ca(c,l));break e}}o=c=ca(c,l),4!==Ml&&(Ml=2),null===Ll?Ll=[o]:Ll.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Qs(o,da(0,c,t));break e;case 1:l=c;var m=o.type,f=o.stateNode;if(0===(128&o.flags)&&("function"===typeof m.getDerivedStateFromError||null!==f&&"function"===typeof f.componentDidCatch&&(null===Pl||!Pl.has(f)))){o.flags|=65536,t&=-t,o.lanes|=t,Qs(o,ha(o,l,t));break e}}o=o.return}while(null!==o)}yc(n)}catch(y){t=y,Zl===n&&null!==n&&(Zl=n=n.return);continue}break}}function hc(){var e=Gl.current;return Gl.current=qo,null===e?qo:e}function Ic(){0!==Ml&&3!==Ml&&2!==Ml||(Ml=4),null===Rl||0===(268435455&kl)&&0===(268435455&Tl)||ac(Rl,Dl)}function pc(e,t){var n=Sl;Sl|=2;var i=hc();for(Rl===e&&Dl===t||(Xl=null,Ac(e,t));;)try{Cc();break}catch(r){dc(e,r)}if(Es(),Sl=n,Gl.current=i,null!==Zl)throw Error(s(261));return Rl=null,Dl=0,Ml}function Cc(){for(;null!==Zl;)fc(Zl)}function mc(){for(;null!==Zl&&!Oe();)fc(Zl)}function fc(e){var t=vl(e.alternate,e,Fl);e.memoizedProps=e.pendingProps,null===t?yc(e):Zl=t,El.current=null}function yc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ua(n,t,Fl)))return void(Zl=n)}else{if(null!==(n=_a(n,t)))return n.flags&=32767,void(Zl=n);if(null===e)return Ml=6,void(Zl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Zl=t);Zl=t=e}while(null!==t);0===Ml&&(Ml=5)}function bc(e,t,n){var i=ft,r=xl.transition;try{xl.transition=null,ft=1,function(e,t,n,i){do{Bc()}while(null!==_l);if(0!==(6&Sl))throw Error(s(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-ot(n),s=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~s}}(e,o),e===Rl&&(Zl=Rl=null,Dl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Ul||(Ul=!0,Rc(tt,(function(){return Bc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=xl.transition,xl.transition=null;var a=ft;ft=1;var l=Sl;Sl|=4,El.current=null,function(e,t){if(er=Yt,di(e=Ai())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch(b){n=null;break e}var a=0,l=-1,c=-1,g=0,u=0,A=e,d=null;t:for(;;){for(var h;A!==n||0!==r&&3!==A.nodeType||(l=a+r),A!==o||0!==i&&3!==A.nodeType||(c=a+i),3===A.nodeType&&(a+=A.nodeValue.length),null!==(h=A.firstChild);)d=A,A=h;for(;;){if(A===e)break t;if(d===n&&++g===r&&(l=a),d===o&&++u===i&&(c=a),null!==(h=A.nextSibling))break;d=(A=d).parentNode}A=h}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(tr={focusedElem:e,selectionRange:n},Yt=!1,qa=t;null!==qa;)if(e=(t=qa).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,qa=e;else for(;null!==qa;){t=qa;try{var I=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==I){var p=I.memoizedProps,C=I.memoizedState,m=t.stateNode,f=m.getSnapshotBeforeUpdate(t.elementType===t.type?p:na(t.type,p),C);m.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var y=t.stateNode.containerInfo;1===y.nodeType?y.textContent="":9===y.nodeType&&y.documentElement&&y.removeChild(y.documentElement);break;default:throw Error(s(163))}}catch(b){wc(t,t.return,b)}if(null!==(e=t.sibling)){e.return=t.return,qa=e;break}qa=t.return}I=tl,tl=!1}(e,n),pl(n,e),hi(tr),Yt=!!er,tr=er=null,e.current=n,ml(n,e,r),Je(),Sl=l,ft=a,xl.transition=o}else e.current=n;if(Ul&&(Ul=!1,_l=e,Ol=r),o=e.pendingLanes,0===o&&(Pl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ic(e,je()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Yl)throw Yl=!1,e=zl,zl=null,e;0!==(1&Ol)&&0!==e.tag&&Bc(),o=e.pendingLanes,0!==(1&o)?e===jl?Jl++:(Jl=0,jl=e):Jl=0,Kr()}(e,t,n,i)}finally{xl.transition=r,ft=i}return null}function Bc(){if(null!==_l){var e=yt(Ol),t=xl.transition,n=ft;try{if(xl.transition=null,ft=16>e?16:e,null===_l)var i=!1;else{if(e=_l,_l=null,Ol=0,0!==(6&Sl))throw Error(s(331));var r=Sl;for(Sl|=4,qa=e.current;null!==qa;){var o=qa,a=o.child;if(0!==(16&qa.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var g=l[c];for(qa=g;null!==qa;){var u=qa;switch(u.tag){case 0:case 11:case 15:nl(8,u,o)}var A=u.child;if(null!==A)A.return=u,qa=A;else for(;null!==qa;){var d=(u=qa).sibling,h=u.return;if(sl(u),u===g){qa=null;break}if(null!==d){d.return=h,qa=d;break}qa=h}}}var I=o.alternate;if(null!==I){var p=I.child;if(null!==p){I.child=null;do{var C=p.sibling;p.sibling=null,p=C}while(null!==p)}}qa=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,qa=a;else e:for(;null!==qa;){if(0!==(2048&(o=qa).flags))switch(o.tag){case 0:case 11:case 15:nl(9,o,o.return)}var m=o.sibling;if(null!==m){m.return=o.return,qa=m;break e}qa=o.return}}var f=e.current;for(qa=f;null!==qa;){var y=(a=qa).child;if(0!==(2064&a.subtreeFlags)&&null!==y)y.return=a,qa=y;else e:for(a=f;null!==qa;){if(0!==(2048&(l=qa).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(B){wc(l,l.return,B)}if(l===a){qa=null;break e}var b=l.sibling;if(null!==b){b.return=l.return,qa=b;break e}qa=l.return}}if(Sl=r,Kr(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(rt,e)}catch(B){}i=!0}return i}finally{ft=n,xl.transition=t}}return!1}function vc(e,t,n){e=Ls(e,t=da(0,t=ca(n,t),1),1),t=ec(),null!==e&&(Ct(e,1,t),ic(e,t))}function wc(e,t,n){if(3===e.tag)vc(e,e,n);else for(;null!==t;){if(3===t.tag){vc(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Pl||!Pl.has(i))){t=Ls(t,e=ha(t,e=ca(n,e),1),1),e=ec(),null!==t&&(Ct(t,1,e),ic(t,e));break}}t=t.return}}function Gc(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Rl===e&&(Dl&n)===n&&(4===Ml||3===Ml&&(130023424&Dl)===Dl&&500>je()-Ql?Ac(e,0):Vl|=n),ic(e,t)}function Ec(e,t){0===t&&(0===(1&e.mode)?t=1:(t=gt,0===(130023424&(gt<<=1))&&(gt=4194304)));var n=ec();null!==(e=Ms(e,t))&&(Ct(e,t,n),ic(e,n))}function xc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ec(e,n)}function Sc(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(s(314))}null!==i&&i.delete(t),Ec(e,n)}function Rc(e,t){return Ue(e,t)}function Zc(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dc(e,t,n,i){return new Zc(e,t,n,i)}function Fc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Nc(e,t){var n=e.alternate;return null===n?((n=Dc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Mc(e,t,n,i,r,o){var a=2;if(i=e,"function"===typeof e)Fc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case v:return Wc(n.children,r,o,t);case w:a=8,r|=8;break;case G:return(e=Dc(12,n,t,2|r)).elementType=G,e.lanes=o,e;case R:return(e=Dc(13,n,t,r)).elementType=R,e.lanes=o,e;case Z:return(e=Dc(19,n,t,r)).elementType=Z,e.lanes=o,e;case N:return kc(n,r,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case E:a=10;break e;case x:a=9;break e;case S:a=11;break e;case D:a=14;break e;case F:a=16,i=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Dc(a,n,t,r)).elementType=e,t.type=i,t.lanes=o,t}function Wc(e,t,n,i){return(e=Dc(7,e,i,t)).lanes=n,e}function kc(e,t,n,i){return(e=Dc(22,e,i,t)).elementType=N,e.lanes=n,e.stateNode={isHidden:!1},e}function Tc(e,t,n){return(e=Dc(6,e,null,t)).lanes=n,e}function Vc(e,t,n){return(t=Dc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Lc(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=pt(0),this.expirationTimes=pt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pt(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Hc(e,t,n,i,r,s,o,a,l){return e=new Lc(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Dc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ks(s),e}function Qc(e){if(!e)return xr;e:{if(Ke(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Fr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Fr(n))return Wr(e,n,t)}return t}function Kc(e,t,n,i,r,s,o,a,l){return(e=Hc(n,i,!0,e,0,s,0,a,l)).context=Qc(null),n=e.current,(s=Vs(i=ec(),r=tc(n))).callback=void 0!==t&&null!==t?t:null,Ls(n,s,r),e.current.lanes=r,Ct(e,r,i),ic(e,i),e}function Xc(e,t,n,i){var r=t.current,s=ec(),o=tc(r);return n=Qc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Vs(s,o)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=Ls(r,t,o))&&(nc(e,r,o,s),Hs(e,r,o)),o}function Yc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function zc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Pc(e,t){zc(e,t),(e=e.alternate)&&zc(e,t)}vl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Rr.current)fa=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return fa=!1,function(e,t,n){switch(t.tag){case 3:Ra(t),ds();break;case 5:js(t);break;case 1:Fr(t.type)&&kr(t);break;case 4:Os(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;Er(Bs,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(Er($s,1&$s.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ta(e,t,n):(Er($s,1&$s.current),null!==(e=Ya(e,t,n))?e.sibling:null);Er($s,1&$s.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return Ka(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Er($s,$s.current),i)break;return null;case 22:case 23:return t.lanes=0,wa(e,t,n)}return Ya(e,t,n)}(e,t,n);fa=0!==(131072&e.flags)}else fa=!1,rs&&0!==(1048576&t.flags)&&$r(t,Pr,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Xa(e,t),e=t.pendingProps;var r=Dr(t,Sr.current);Rs(t,n),r=po(null,t,i,e,r,n);var o=Co();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Fr(i)?(o=!0,kr(t)):o=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,ks(t),r.updater=ra,t.stateNode=r,r._reactInternals=t,la(t,i,e,n),t=Sa(null,t,i,!0,o,n)):(t.tag=0,rs&&o&&es(t),ya(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(Xa(e,t),e=t.pendingProps,i=(r=i._init)(i._payload),t.type=i,r=t.tag=function(e){if("function"===typeof e)return Fc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===S)return 11;if(e===D)return 14}return 2}(i),e=na(i,e),r){case 0:t=Ea(null,t,i,e,n);break e;case 1:t=xa(null,t,i,e,n);break e;case 11:t=ba(null,t,i,e,n);break e;case 14:t=Ba(null,t,i,na(i.type,e),n);break e}throw Error(s(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,Ea(e,t,i,r=t.elementType===i?r:na(i,r),n);case 1:return i=t.type,r=t.pendingProps,xa(e,t,i,r=t.elementType===i?r:na(i,r),n);case 3:e:{if(Ra(t),null===e)throw Error(s(387));i=t.pendingProps,r=(o=t.memoizedState).element,Ts(e,t),Ks(t,i,null,n);var a=t.memoizedState;if(i=a.element,o.isDehydrated){if(o={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Za(e,t,i,n,r=ca(Error(s(423)),t));break e}if(i!==r){t=Za(e,t,i,n,r=ca(Error(s(424)),t));break e}for(is=cr(t.stateNode.containerInfo.firstChild),ns=t,rs=!0,ss=null,n=bs(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ds(),i===r){t=Ya(e,t,n);break e}ya(e,t,i,n)}t=t.child}return t;case 5:return js(t),null===e&&cs(t),i=t.type,r=t.pendingProps,o=null!==e?e.memoizedProps:null,a=r.children,nr(i,r)?a=null:null!==o&&nr(i,o)&&(t.flags|=32),Ga(e,t),ya(e,t,a,n),t.child;case 6:return null===e&&cs(t),null;case 13:return Ta(e,t,n);case 4:return Os(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=ys(t,null,i,n):ya(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,ba(e,t,i,r=t.elementType===i?r:na(i,r),n);case 7:return ya(e,t,t.pendingProps,n),t.child;case 8:case 12:return ya(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,o=t.memoizedProps,a=r.value,Er(Bs,i._currentValue),i._currentValue=a,null!==o)if(ai(o.value,a)){if(o.children===r.children&&!Rr.current){t=Ya(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===o.tag){(c=Vs(-1,n&-n)).tag=2;var g=o.updateQueue;if(null!==g){var u=(g=g.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),g.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Ss(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Ss(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}ya(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Rs(t,n),i=i(r=Zs(r)),t.flags|=1,ya(e,t,i,n),t.child;case 14:return r=na(i=t.type,t.pendingProps),Ba(e,t,i,r=na(i.type,r),n);case 15:return va(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:na(i,r),Xa(e,t),t.tag=1,Fr(i)?(e=!0,kr(t)):e=!1,Rs(t,n),oa(t,i,r),la(t,i,r,n),Sa(null,t,i,!0,e,n);case 19:return Ka(e,t,n);case 22:return wa(e,t,n)}throw Error(s(156,t.tag))};var Uc="function"===typeof reportError?reportError:function(e){console.error(e)};function _c(e){this._internalRoot=e}function Oc(e){this._internalRoot=e}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function qc(){}function $c(e,t,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof r){var a=r;r=function(){var e=Yc(o);a.call(e)}}Xc(t,o,e,r)}else o=function(e,t,n,i,r){if(r){if("function"===typeof i){var s=i;i=function(){var e=Yc(o);s.call(e)}}var o=Kc(t,i,e,0,null,!1,0,"",qc);return e._reactRootContainer=o,e[hr]=o.current,Ki(8===e.nodeType?e.parentNode:e),gc(),o}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof i){var a=i;i=function(){var e=Yc(l);a.call(e)}}var l=Hc(e,0,!1,null,0,!1,0,"",qc);return e._reactRootContainer=l,e[hr]=l.current,Ki(8===e.nodeType?e.parentNode:e),gc((function(){Xc(t,l,n,i)})),l}(n,t,e,r,i);return Yc(o)}Oc.prototype.render=_c.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Xc(e,t,null,null)},Oc.prototype.unmount=_c.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;gc((function(){Xc(null,e,null,null)})),t[hr]=null}},Oc.prototype.unstable_scheduleHydration=function(e){if(e){var t=wt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Nt.length&&0!==t&&t<Nt[n].priority;n++);Nt.splice(n,0,e),0===n&&Tt(e)}},bt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(mt(t,1|n),ic(t,je()),0===(6&Sl)&&(Kl=je()+500,Kr()))}break;case 13:gc((function(){var t=Ms(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),Pc(e,1)}},Bt=function(e){if(13===e.tag){var t=Ms(e,134217728);if(null!==t)nc(t,e,134217728,ec());Pc(e,134217728)}},vt=function(e){if(13===e.tag){var t=tc(e),n=Ms(e,t);if(null!==n)nc(n,e,t,ec());Pc(e,t)}},wt=function(){return ft},Gt=function(e,t){var n=ft;try{return ft=e,t()}finally{ft=n}},Be=function(e,t,n){switch(t){case"input":if(q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=br(i);if(!r)throw Error(s(90));U(i),q(i,r)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Se=cc,Re=gc;var eg={usingClientEntryPoint:!1,Events:[fr,yr,br,Ee,xe,cc]},tg={findFiberByHostInstance:mr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ng={bundleType:tg.bundleType,version:tg.version,rendererPackageName:tg.rendererPackageName,rendererConfig:tg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:y.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=ze(e))?null:e.stateNode},findFiberByHostInstance:tg.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ig=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ig.isDisabled&&ig.supportsFiber)try{rt=ig.inject(ng),st=ig}catch(ge){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eg,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jc(t))throw Error(s(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:B,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Jc(e))throw Error(s(299));var n=!1,i="",r=Uc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Hc(e,1,!1,null,0,n,0,i,r),e[hr]=t.current,Ki(8===e.nodeType?e.parentNode:e),new _c(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=ze(t))?null:e.stateNode},t.flushSync=function(e){return gc(e)},t.hydrate=function(e,t,n){if(!jc(t))throw Error(s(200));return $c(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Jc(e))throw Error(s(405));var i=null!=n&&n.hydratedSources||null,r=!1,o="",a=Uc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Kc(t,null,e,1,null!=n?n:null,r,0,o,a),e[hr]=t.current,Ki(e),i)for(e=0;e<i.length;e++)r=(r=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Oc(t)},t.render=function(e,t,n){if(!jc(t))throw Error(s(200));return $c(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!jc(e))throw Error(s(40));return!!e._reactRootContainer&&(gc((function(){$c(null,null,e,!1,(function(){e._reactRootContainer=null,e[hr]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!jc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return $c(e,t,n,!1,i)},t.version="18.3.1-next-f1338f8080-20240426"},391:(e,t,n)=>{"use strict";var i=n(950);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},612:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<s(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,o=r>>>1;i<o;){var a=2*(i+1)-1,l=e[a],c=a+1,g=e[c];if(0>s(l,n))c<r&&0>s(g,l)?(e[i]=g,e[c]=n,i=c):(e[i]=l,e[a]=n,i=a);else{if(!(c<r&&0>s(g,n)))break e;e[i]=g,e[c]=n,i=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],g=[],u=1,A=null,d=3,h=!1,I=!1,p=!1,C="function"===typeof setTimeout?setTimeout:null,m="function"===typeof clearTimeout?clearTimeout:null,f="undefined"!==typeof setImmediate?setImmediate:null;function y(e){for(var t=i(g);null!==t;){if(null===t.callback)r(g);else{if(!(t.startTime<=e))break;r(g),t.sortIndex=t.expirationTime,n(c,t)}t=i(g)}}function b(e){if(p=!1,y(e),!I)if(null!==i(c))I=!0,N(B);else{var t=i(g);null!==t&&M(b,t.startTime-e)}}function B(e,n){I=!1,p&&(p=!1,m(E),E=-1),h=!0;var s=d;try{for(y(n),A=i(c);null!==A&&(!(A.expirationTime>n)||e&&!R());){var o=A.callback;if("function"===typeof o){A.callback=null,d=A.priorityLevel;var a=o(A.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?A.callback=a:A===i(c)&&r(c),y(n)}else r(c);A=i(c)}if(null!==A)var l=!0;else{var u=i(g);null!==u&&M(b,u.startTime-n),l=!1}return l}finally{A=null,d=s,h=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var v,w=!1,G=null,E=-1,x=5,S=-1;function R(){return!(t.unstable_now()-S<x)}function Z(){if(null!==G){var e=t.unstable_now();S=e;var n=!0;try{n=G(!0,e)}finally{n?v():(w=!1,G=null)}}else w=!1}if("function"===typeof f)v=function(){f(Z)};else if("undefined"!==typeof MessageChannel){var D=new MessageChannel,F=D.port2;D.port1.onmessage=Z,v=function(){F.postMessage(null)}}else v=function(){C(Z,0)};function N(e){G=e,w||(w=!0,v())}function M(e,n){E=C((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){I||h||(I=!0,N(B))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var n=d;d=t;try{return e()}finally{d=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=d;d=e;try{return t()}finally{d=n}},t.unstable_scheduleCallback=function(e,r,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:u++,callback:r,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(g,e),null===i(c)&&e===i(g)&&(p?(m(E),E=-1):p=!0,M(b,s-o))):(e.sortIndex=a,n(c,e),I||h||(I=!0,N(B))),e},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(e){var t=d;return function(){var n=d;d=t;try{return e.apply(this,arguments)}finally{d=n}}}},67:(e,t,n)=>{"use strict";e.exports=n(612)},302:(e,t)=>{"use strict";t.ConcurrentRoot=1,t.ContinuousEventPriority=4,t.DefaultEventPriority=16,t.DiscreteEventPriority=1},958:(e,t,n)=>{e.exports=function(e){var t={},i=n(43),r=n(853),s=Object.assign;function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),d=Symbol.for("react.provider"),h=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),m=Symbol.for("react.memo"),f=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var y=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var b=Symbol.iterator;function B(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=b&&e[b]||e["@@iterator"])?e:null}function v(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case g:return"Fragment";case c:return"Portal";case A:return"Profiler";case u:return"StrictMode";case p:return"Suspense";case C:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case h:return(e.displayName||"Context")+".Consumer";case d:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case m:return null!==(t=e.displayName||null)?t:v(e.type)||"Memo";case f:t=e._payload,e=e._init;try{return v(e(t))}catch(n){}}return null}function w(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return v(t);case 8:return t===u?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function G(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function E(e){if(G(e)!==e)throw Error(o(188))}function x(e){var t=e.alternate;if(!t){if(null===(t=G(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var s=r.alternate;if(null===s){if(null!==(i=r.return)){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return E(r),e;if(s===i)return E(r),t;s=s.sibling}throw Error(o(188))}if(n.return!==i.return)n=r,i=s;else{for(var a=!1,l=r.child;l;){if(l===n){a=!0,n=r,i=s;break}if(l===i){a=!0,i=r,n=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===n){a=!0,n=s,i=r;break}if(l===i){a=!0,i=s,n=r;break}l=l.sibling}if(!a)throw Error(o(189))}}if(n.alternate!==i)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}function S(e){return null!==(e=x(e))?R(e):null}function R(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=R(e);if(null!==t)return t;e=e.sibling}return null}function Z(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){if(4!==e.tag){var t=Z(e);if(null!==t)return t}e=e.sibling}return null}var D,F=Array.isArray,N=e.getPublicInstance,M=e.getRootHostContext,W=e.getChildHostContext,k=e.prepareForCommit,T=e.resetAfterCommit,V=e.createInstance,L=e.appendInitialChild,H=e.finalizeInitialChildren,Q=e.prepareUpdate,K=e.shouldSetTextContent,X=e.createTextInstance,Y=e.scheduleTimeout,z=e.cancelTimeout,P=e.noTimeout,U=e.isPrimaryRenderer,_=e.supportsMutation,O=e.supportsPersistence,J=e.supportsHydration,j=e.getInstanceFromNode,q=e.preparePortalMount,$=e.getCurrentEventPriority,ee=e.detachDeletedInstance,te=e.supportsMicrotasks,ne=e.scheduleMicrotask,ie=e.supportsTestSelectors,re=e.findFiberRoot,se=e.getBoundingRect,oe=e.getTextContent,ae=e.isHiddenSubtree,le=e.matchAccessibilityRole,ce=e.setFocusIfFocusable,ge=e.setupIntersectionObserver,ue=e.appendChild,Ae=e.appendChildToContainer,de=e.commitTextUpdate,he=e.commitMount,Ie=e.commitUpdate,pe=e.insertBefore,Ce=e.insertInContainerBefore,me=e.removeChild,fe=e.removeChildFromContainer,ye=e.resetTextContent,be=e.hideInstance,Be=e.hideTextInstance,ve=e.unhideInstance,we=e.unhideTextInstance,Ge=e.clearContainer,Ee=e.cloneInstance,xe=e.createContainerChildSet,Se=e.appendChildToContainerChildSet,Re=e.finalizeContainerChildren,Ze=e.replaceContainerChildren,De=e.cloneHiddenInstance,Fe=e.cloneHiddenTextInstance,Ne=e.canHydrateInstance,Me=e.canHydrateTextInstance,We=e.canHydrateSuspenseInstance,ke=e.isSuspenseInstancePending,Te=e.isSuspenseInstanceFallback,Ve=e.registerSuspenseInstanceRetry,Le=e.getNextHydratableSibling,He=e.getFirstHydratableChild,Qe=e.getFirstHydratableChildWithinContainer,Ke=e.getFirstHydratableChildWithinSuspenseInstance,Xe=e.hydrateInstance,Ye=e.hydrateTextInstance,ze=e.hydrateSuspenseInstance,Pe=e.getNextHydratableInstanceAfterSuspenseInstance,Ue=e.commitHydratedContainer,_e=e.commitHydratedSuspenseInstance,Oe=e.clearSuspenseBoundary,Je=e.clearSuspenseBoundaryFromContainer,je=e.shouldDeleteUnhydratedTailInstances,qe=e.didNotMatchHydratedContainerTextInstance,$e=e.didNotMatchHydratedTextInstance;function et(e){if(void 0===D)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);D=t&&t[1]||""}return"\n"+D+e}var tt=!1;function nt(e,t){if(!e||tt)return"";tt=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),s=i.stack.split("\n"),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||r[o]!==s[a]){var l="\n"+r[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{tt=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?et(e):""}var it=Object.prototype.hasOwnProperty,rt=[],st=-1;function ot(e){return{current:e}}function at(e){0>st||(e.current=rt[st],rt[st]=null,st--)}function lt(e,t){st++,rt[st]=e.current,e.current=t}var ct={},gt=ot(ct),ut=ot(!1),At=ct;function dt(e,t){var n=e.type.contextTypes;if(!n)return ct;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function ht(e){return null!==(e=e.childContextTypes)&&void 0!==e}function It(){at(ut),at(gt)}function pt(e,t,n){if(gt.current!==ct)throw Error(o(168));lt(gt,t),lt(ut,n)}function Ct(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in t))throw Error(o(108,w(e)||"Unknown",r));return s({},n,i)}function mt(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ct,At=gt.current,lt(gt,e),lt(ut,ut.current),!0}function ft(e,t,n){var i=e.stateNode;if(!i)throw Error(o(169));n?(e=Ct(e,t,At),i.__reactInternalMemoizedMergedChildContext=e,at(ut),at(gt),lt(gt,e)):at(ut),lt(ut,n)}var yt=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(bt(e)/Bt|0)|0},bt=Math.log,Bt=Math.LN2;var vt=64,wt=4194304;function Gt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Et(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~r;0!==a?i=Gt(a):0!==(s&=o)&&(i=Gt(s))}else 0!==(o=n&~r)?i=Gt(o):0!==s&&(i=Gt(s));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(s=t&-t)||16===r&&0!==(4194240&s)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-yt(t)),i|=e[n],t&=~r;return i}function xt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function St(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Rt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Zt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-yt(t)]=n}function Dt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-yt(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var Ft=0;function Nt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var Mt=r.unstable_scheduleCallback,Wt=r.unstable_cancelCallback,kt=r.unstable_shouldYield,Tt=r.unstable_requestPaint,Vt=r.unstable_now,Lt=r.unstable_ImmediatePriority,Ht=r.unstable_UserBlockingPriority,Qt=r.unstable_NormalPriority,Kt=r.unstable_IdlePriority,Xt=null,Yt=null;var zt="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},Pt=null,Ut=!1,_t=!1;function Ot(e){null===Pt?Pt=[e]:Pt.push(e)}function Jt(){if(!_t&&null!==Pt){_t=!0;var e=0,t=Ft;try{var n=Pt;for(Ft=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}Pt=null,Ut=!1}catch(r){throw null!==Pt&&(Pt=Pt.slice(e+1)),Mt(Lt,Jt),r}finally{Ft=t,_t=!1}}return null}var jt=a.ReactCurrentBatchConfig;function qt(e,t){if(zt(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!it.call(t,r)||!zt(e[r],t[r]))return!1}return!0}function $t(e){switch(e.tag){case 5:return et(e.type);case 16:return et("Lazy");case 13:return et("Suspense");case 19:return et("SuspenseList");case 0:case 2:case 15:return e=nt(e.type,!1);case 11:return e=nt(e.type.render,!1);case 1:return e=nt(e.type,!0);default:return""}}function en(e,t){if(e&&e.defaultProps){for(var n in t=s({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var tn=ot(null),nn=null,rn=null,sn=null;function on(){sn=rn=nn=null}function an(e,t,n){U?(lt(tn,t._currentValue),t._currentValue=n):(lt(tn,t._currentValue2),t._currentValue2=n)}function ln(e){var t=tn.current;at(tn),U?e._currentValue=t:e._currentValue2=t}function cn(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function gn(e,t){nn=e,sn=rn=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(kr=!0),e.firstContext=null)}function un(e){var t=U?e._currentValue:e._currentValue2;if(sn!==e)if(e={context:e,memoizedValue:t,next:null},null===rn){if(null===nn)throw Error(o(308));rn=e,nn.dependencies={lanes:0,firstContext:e}}else rn=rn.next=e;return t}var An=null,dn=!1;function hn(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function In(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function pn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Cn(e,t){var n=e.updateQueue;null!==n&&(n=n.shared,null!==_s&&0!==(1&e.mode)&&0===(2&Us)?(null===(e=n.interleaved)?(t.next=t,null===An?An=[n]:An.push(n)):(t.next=e.next,e.next=t),n.interleaved=t):(null===(e=n.pending)?t.next=t:(t.next=e.next,e.next=t),n.pending=t))}function mn(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,Dt(e,n)}}function fn(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function yn(e,t,n,i){var r=e.updateQueue;dn=!1;var o=r.firstBaseUpdate,a=r.lastBaseUpdate,l=r.shared.pending;if(null!==l){r.shared.pending=null;var c=l,g=c.next;c.next=null,null===a?o=g:a.next=g,a=c;var u=e.alternate;null!==u&&((l=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===l?u.firstBaseUpdate=g:l.next=g,u.lastBaseUpdate=c))}if(null!==o){var A=r.baseState;for(a=0,u=g=c=null,l=o;;){var d=l.lane,h=l.eventTime;if((i&d)===d){null!==u&&(u=u.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var I=e,p=l;switch(d=t,h=n,p.tag){case 1:if("function"===typeof(I=p.payload)){A=I.call(h,A,d);break e}A=I;break e;case 3:I.flags=-65537&I.flags|128;case 0:if(null===(d="function"===typeof(I=p.payload)?I.call(h,A,d):I)||void 0===d)break e;A=s({},A,d);break e;case 2:dn=!0}}null!==l.callback&&0!==l.lane&&(e.flags|=64,null===(d=r.effects)?r.effects=[l]:d.push(l))}else h={eventTime:h,lane:d,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===u?(g=u=h,c=A):u=u.next=h,a|=d;if(null===(l=l.next)){if(null===(l=r.shared.pending))break;l=(d=l).next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}if(null===u&&(c=A),r.baseState=c,r.firstBaseUpdate=g,r.lastBaseUpdate=u,null!==(t=r.shared.interleaved)){r=t;do{a|=r.lane,r=r.next}while(r!==t)}else null===o&&(r.shared.lanes=0);to|=a,e.lanes=a,e.memoizedState=A}}function bn(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(o(191,r));r.call(i)}}}var Bn=(new i.Component).refs;function vn(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:s({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var wn={isMounted:function(e){return!!(e=e._reactInternals)&&G(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=bo(),r=Bo(e),s=pn(i,r);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),Cn(e,s),null!==(t=vo(e,r,i))&&mn(t,e,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=bo(),r=Bo(e),s=pn(i,r);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),Cn(e,s),null!==(t=vo(e,r,i))&&mn(t,e,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=bo(),i=Bo(e),r=pn(n,i);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),Cn(e,r),null!==(t=vo(e,i,n))&&mn(t,e,i)}};function Gn(e,t,n,i,r,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!qt(n,i)||!qt(r,s))}function En(e,t,n){var i=!1,r=ct,s=t.contextType;return"object"===typeof s&&null!==s?s=un(s):(r=ht(t)?At:gt.current,s=(i=null!==(i=t.contextTypes)&&void 0!==i)?dt(e,r):ct),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=wn,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function xn(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&wn.enqueueReplaceState(t,t.state,null)}function Sn(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs=Bn,hn(e);var s=t.contextType;"object"===typeof s&&null!==s?r.context=un(s):(s=ht(t)?At:gt.current,r.context=dt(e,s)),r.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(vn(e,t,s,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&wn.enqueueReplaceState(r,r.state,null),yn(e,n,r,i),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}var Rn=[],Zn=0,Dn=null,Fn=0,Nn=[],Mn=0,Wn=null,kn=1,Tn="";function Vn(e,t){Rn[Zn++]=Fn,Rn[Zn++]=Dn,Dn=e,Fn=t}function Ln(e,t,n){Nn[Mn++]=kn,Nn[Mn++]=Tn,Nn[Mn++]=Wn,Wn=e;var i=kn;e=Tn;var r=32-yt(i)-1;i&=~(1<<r),n+=1;var s=32-yt(t)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,kn=1<<32-yt(t)+r|n<<r|i,Tn=s+e}else kn=1<<s|n<<r|i,Tn=e}function Hn(e){null!==e.return&&(Vn(e,1),Ln(e,1,0))}function Qn(e){for(;e===Dn;)Dn=Rn[--Zn],Rn[Zn]=null,Fn=Rn[--Zn],Rn[Zn]=null;for(;e===Wn;)Wn=Nn[--Mn],Nn[Mn]=null,Tn=Nn[--Mn],Nn[Mn]=null,kn=Nn[--Mn],Nn[Mn]=null}var Kn=null,Xn=null,Yn=!1,zn=!1,Pn=null;function Un(e,t){var n=qo(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function _n(e,t){switch(e.tag){case 5:return null!==(t=Ne(t,e.type,e.pendingProps))&&(e.stateNode=t,Kn=e,Xn=He(t),!0);case 6:return null!==(t=Me(t,e.pendingProps))&&(e.stateNode=t,Kn=e,Xn=null,!0);case 13:if(null!==(t=We(t))){var n=null!==Wn?{id:kn,overflow:Tn}:null;return e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=qo(18,null,null,0)).stateNode=t,n.return=e,e.child=n,Kn=e,Xn=null,!0}return!1;default:return!1}}function On(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function Jn(e){if(Yn){var t=Xn;if(t){var n=t;if(!_n(e,t)){if(On(e))throw Error(o(418));t=Le(n);var i=Kn;t&&_n(e,t)?Un(i,n):(e.flags=-4097&e.flags|2,Yn=!1,Kn=e)}}else{if(On(e))throw Error(o(418));e.flags=-4097&e.flags|2,Yn=!1,Kn=e}}}function jn(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Kn=e}function qn(e){if(!J||e!==Kn)return!1;if(!Yn)return jn(e),Yn=!0,!1;if(3!==e.tag&&(5!==e.tag||je(e.type)&&!K(e.type,e.memoizedProps))){var t=Xn;if(t){if(On(e)){for(e=Xn;e;)e=Le(e);throw Error(o(418))}for(;t;)Un(e,t),t=Le(t)}}if(jn(e),13===e.tag){if(!J)throw Error(o(316));if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));Xn=Pe(e)}else Xn=Kn?Le(e.stateNode):null;return!0}function $n(){J&&(Xn=Kn=null,zn=Yn=!1)}function ei(e){null===Pn?Pn=[e]:Pn.push(e)}function ti(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var i=n.stateNode}if(!i)throw Error(o(147,e));var r=i,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=r.refs;t===Bn&&(t=r.refs={}),null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function ni(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ii(e){return(0,e._init)(e._payload)}function ri(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=ea(e,t)).index=0,e.sibling=null,e}function s(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function u(e,t,n,i){return null===t||6!==t.tag?((t=ra(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function A(e,t,n,i){var s=n.type;return s===g?h(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===f&&ii(s)===t.type)?((i=r(t,n.props)).ref=ti(e,t,n),i.return=e,i):((i=ta(n.type,n.key,n.props,null,e.mode,i)).ref=ti(e,t,n),i.return=e,i)}function d(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=sa(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function h(e,t,n,i,s){return null===t||7!==t.tag?((t=na(n,e.mode,i,s)).return=e,t):((t=r(t,n)).return=e,t)}function I(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=ra(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case l:return(n=ta(t.type,t.key,t.props,null,e.mode,n)).ref=ti(e,null,t),n.return=e,n;case c:return(t=sa(t,e.mode,n)).return=e,t;case f:return I(e,(0,t._init)(t._payload),n)}if(F(t)||B(t))return(t=na(t,e.mode,n,null)).return=e,t;ni(e,t)}return null}function p(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:u(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case l:return n.key===r?A(e,t,n,i):null;case c:return n.key===r?d(e,t,n,i):null;case f:return p(e,t,(r=n._init)(n._payload),i)}if(F(n)||B(n))return null!==r?null:h(e,t,n,i,null);ni(e,n)}return null}function C(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return u(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case l:return A(t,e=e.get(null===i.key?n:i.key)||null,i,r);case c:return d(t,e=e.get(null===i.key?n:i.key)||null,i,r);case f:return C(e,t,n,(0,i._init)(i._payload),r)}if(F(i)||B(i))return h(t,e=e.get(n)||null,i,r,null);ni(t,i)}return null}function m(r,o,a,l){for(var c=null,g=null,u=o,A=o=0,d=null;null!==u&&A<a.length;A++){u.index>A?(d=u,u=null):d=u.sibling;var h=p(r,u,a[A],l);if(null===h){null===u&&(u=d);break}e&&u&&null===h.alternate&&t(r,u),o=s(h,o,A),null===g?c=h:g.sibling=h,g=h,u=d}if(A===a.length)return n(r,u),Yn&&Vn(r,A),c;if(null===u){for(;A<a.length;A++)null!==(u=I(r,a[A],l))&&(o=s(u,o,A),null===g?c=u:g.sibling=u,g=u);return Yn&&Vn(r,A),c}for(u=i(r,u);A<a.length;A++)null!==(d=C(u,r,A,a[A],l))&&(e&&null!==d.alternate&&u.delete(null===d.key?A:d.key),o=s(d,o,A),null===g?c=d:g.sibling=d,g=d);return e&&u.forEach((function(e){return t(r,e)})),Yn&&Vn(r,A),c}function y(r,a,l,c){var g=B(l);if("function"!==typeof g)throw Error(o(150));if(null==(l=g.call(l)))throw Error(o(151));for(var u=g=null,A=a,d=a=0,h=null,m=l.next();null!==A&&!m.done;d++,m=l.next()){A.index>d?(h=A,A=null):h=A.sibling;var f=p(r,A,m.value,c);if(null===f){null===A&&(A=h);break}e&&A&&null===f.alternate&&t(r,A),a=s(f,a,d),null===u?g=f:u.sibling=f,u=f,A=h}if(m.done)return n(r,A),Yn&&Vn(r,d),g;if(null===A){for(;!m.done;d++,m=l.next())null!==(m=I(r,m.value,c))&&(a=s(m,a,d),null===u?g=m:u.sibling=m,u=m);return Yn&&Vn(r,d),g}for(A=i(r,A);!m.done;d++,m=l.next())null!==(m=C(A,r,d,m.value,c))&&(e&&null!==m.alternate&&A.delete(null===m.key?d:m.key),a=s(m,a,d),null===u?g=m:u.sibling=m,u=m);return e&&A.forEach((function(e){return t(r,e)})),Yn&&Vn(r,d),g}return function e(i,s,o,u){if("object"===typeof o&&null!==o&&o.type===g&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case l:e:{for(var A=o.key,d=s;null!==d;){if(d.key===A){if((A=o.type)===g){if(7===d.tag){n(i,d.sibling),(s=r(d,o.props.children)).return=i,i=s;break e}}else if(d.elementType===A||"object"===typeof A&&null!==A&&A.$$typeof===f&&ii(A)===d.type){n(i,d.sibling),(s=r(d,o.props)).ref=ti(i,d,o),s.return=i,i=s;break e}n(i,d);break}t(i,d),d=d.sibling}o.type===g?((s=na(o.props.children,i.mode,u,o.key)).return=i,i=s):((u=ta(o.type,o.key,o.props,null,i.mode,u)).ref=ti(i,s,o),u.return=i,i=u)}return a(i);case c:e:{for(d=o.key;null!==s;){if(s.key===d){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(i,s.sibling),(s=r(s,o.children||[])).return=i,i=s;break e}n(i,s);break}t(i,s),s=s.sibling}(s=sa(o,i.mode,u)).return=i,i=s}return a(i);case f:return e(i,s,(d=o._init)(o._payload),u)}if(F(o))return m(i,s,o,u);if(B(o))return y(i,s,o,u);ni(i,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(i,s.sibling),(s=r(s,o)).return=i,i=s):(n(i,s),(s=ra(o,i.mode,u)).return=i,i=s),a(i)):n(i,s)}}var si=ri(!0),oi=ri(!1),ai={},li=ot(ai),ci=ot(ai),gi=ot(ai);function ui(e){if(e===ai)throw Error(o(174));return e}function Ai(e,t){lt(gi,t),lt(ci,e),lt(li,ai),e=M(t),at(li),lt(li,e)}function di(){at(li),at(ci),at(gi)}function hi(e){var t=ui(gi.current),n=ui(li.current);n!==(t=W(n,e.type,t))&&(lt(ci,e),lt(li,t))}function Ii(e){ci.current===e&&(at(li),at(ci))}var pi=ot(0);function Ci(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||ke(n)||Te(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var mi=[];function fi(){for(var e=0;e<mi.length;e++){var t=mi[e];U?t._workInProgressVersionPrimary=null:t._workInProgressVersionSecondary=null}mi.length=0}var yi=a.ReactCurrentDispatcher,bi=a.ReactCurrentBatchConfig,Bi=0,vi=null,wi=null,Gi=null,Ei=!1,xi=!1,Si=0,Ri=0;function Zi(){throw Error(o(321))}function Di(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!zt(e[n],t[n]))return!1;return!0}function Fi(e,t,n,i,r,s){if(Bi=s,vi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,yi.current=null===e||null===e.memoizedState?hr:Ir,e=n(i,r),xi){s=0;do{if(xi=!1,Si=0,25<=s)throw Error(o(301));s+=1,Gi=wi=null,t.updateQueue=null,yi.current=pr,e=n(i,r)}while(xi)}if(yi.current=dr,t=null!==wi&&null!==wi.next,Bi=0,Gi=wi=vi=null,Ei=!1,t)throw Error(o(300));return e}function Ni(){var e=0!==Si;return Si=0,e}function Mi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Gi?vi.memoizedState=Gi=e:Gi=Gi.next=e,Gi}function Wi(){if(null===wi){var e=vi.alternate;e=null!==e?e.memoizedState:null}else e=wi.next;var t=null===Gi?vi.memoizedState:Gi.next;if(null!==t)Gi=t,wi=e;else{if(null===e)throw Error(o(310));e={memoizedState:(wi=e).memoizedState,baseState:wi.baseState,baseQueue:wi.baseQueue,queue:wi.queue,next:null},null===Gi?vi.memoizedState=Gi=e:Gi=Gi.next=e}return Gi}function ki(e,t){return"function"===typeof t?t(e):t}function Ti(e){var t=Wi(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var i=wi,r=i.baseQueue,s=n.pending;if(null!==s){if(null!==r){var a=r.next;r.next=s.next,s.next=a}i.baseQueue=r=s,n.pending=null}if(null!==r){s=r.next,i=i.baseState;var l=a=null,c=null,g=s;do{var u=g.lane;if((Bi&u)===u)null!==c&&(c=c.next={lane:0,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null}),i=g.hasEagerState?g.eagerState:e(i,g.action);else{var A={lane:u,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null};null===c?(l=c=A,a=i):c=c.next=A,vi.lanes|=u,to|=u}g=g.next}while(null!==g&&g!==s);null===c?a=i:c.next=l,zt(i,t.memoizedState)||(kr=!0),t.memoizedState=i,t.baseState=a,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){r=e;do{s=r.lane,vi.lanes|=s,to|=s,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Vi(e){var t=Wi(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,s=t.memoizedState;if(null!==r){n.pending=null;var a=r=r.next;do{s=e(s,a.action),a=a.next}while(a!==r);zt(s,t.memoizedState)||(kr=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,i]}function Li(){}function Hi(e,t){var n=vi,i=Wi(),r=t(),s=!zt(i.memoizedState,r);if(s&&(i.memoizedState=r,kr=!0),i=i.queue,ji(Xi.bind(null,n,i,e),[e]),i.getSnapshot!==t||s||null!==Gi&&1&Gi.memoizedState.tag){if(n.flags|=2048,Pi(9,Ki.bind(null,n,i,r,t),void 0,null),null===_s)throw Error(o(349));0!==(30&Bi)||Qi(n,t,r)}return r}function Qi(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=vi.updateQueue)?(t={lastEffect:null,stores:null},vi.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ki(e,t,n,i){t.value=n,t.getSnapshot=i,Yi(t)&&vo(e,1,-1)}function Xi(e,t,n){return n((function(){Yi(t)&&vo(e,1,-1)}))}function Yi(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!zt(e,n)}catch(i){return!0}}function zi(e){var t=Mi();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ki,lastRenderedState:e},t.queue=e,e=e.dispatch=lr.bind(null,vi,e),[t.memoizedState,e]}function Pi(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=vi.updateQueue)?(t={lastEffect:null,stores:null},vi.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Ui(){return Wi().memoizedState}function _i(e,t,n,i){var r=Mi();vi.flags|=e,r.memoizedState=Pi(1|t,n,void 0,void 0===i?null:i)}function Oi(e,t,n,i){var r=Wi();i=void 0===i?null:i;var s=void 0;if(null!==wi){var o=wi.memoizedState;if(s=o.destroy,null!==i&&Di(i,o.deps))return void(r.memoizedState=Pi(t,n,s,i))}vi.flags|=e,r.memoizedState=Pi(1|t,n,s,i)}function Ji(e,t){return _i(8390656,8,e,t)}function ji(e,t){return Oi(2048,8,e,t)}function qi(e,t){return Oi(4,2,e,t)}function $i(e,t){return Oi(4,4,e,t)}function er(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function tr(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Oi(4,4,er.bind(null,t,e),n)}function nr(){}function ir(e,t){var n=Wi();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&Di(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function rr(e,t){var n=Wi();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&Di(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function sr(e,t){var n=Ft;Ft=0!==n&&4>n?n:4,e(!0);var i=bi.transition;bi.transition={};try{e(!1),t()}finally{Ft=n,bi.transition=i}}function or(){return Wi().memoizedState}function ar(e,t,n){var i=Bo(e);n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},cr(e)?gr(t,n):(ur(e,t,n),null!==(e=vo(e,i,n=bo()))&&Ar(e,t,i))}function lr(e,t,n){var i=Bo(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(cr(e))gr(t,r);else{ur(e,t,r);var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,zt(a,o))return}catch(l){}null!==(e=vo(e,i,n=bo()))&&Ar(e,t,i)}}function cr(e){var t=e.alternate;return e===vi||null!==t&&t===vi}function gr(e,t){xi=Ei=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ur(e,t,n){null!==_s&&0!==(1&e.mode)&&0===(2&Us)?(null===(e=t.interleaved)?(n.next=n,null===An?An=[t]:An.push(t)):(n.next=e.next,e.next=n),t.interleaved=n):(null===(e=t.pending)?n.next=n:(n.next=e.next,e.next=n),t.pending=n)}function Ar(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,Dt(e,n)}}var dr={readContext:un,useCallback:Zi,useContext:Zi,useEffect:Zi,useImperativeHandle:Zi,useInsertionEffect:Zi,useLayoutEffect:Zi,useMemo:Zi,useReducer:Zi,useRef:Zi,useState:Zi,useDebugValue:Zi,useDeferredValue:Zi,useTransition:Zi,useMutableSource:Zi,useSyncExternalStore:Zi,useId:Zi,unstable_isNewReconciler:!1},hr={readContext:un,useCallback:function(e,t){return Mi().memoizedState=[e,void 0===t?null:t],e},useContext:un,useEffect:Ji,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,_i(4194308,4,er.bind(null,t,e),n)},useLayoutEffect:function(e,t){return _i(4194308,4,e,t)},useInsertionEffect:function(e,t){return _i(4,2,e,t)},useMemo:function(e,t){var n=Mi();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=Mi();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=ar.bind(null,vi,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},Mi().memoizedState=e},useState:zi,useDebugValue:nr,useDeferredValue:function(e){var t=zi(e),n=t[0],i=t[1];return Ji((function(){var t=bi.transition;bi.transition={};try{i(e)}finally{bi.transition=t}}),[e]),n},useTransition:function(){var e=zi(!1),t=e[0];return e=sr.bind(null,e[1]),Mi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=vi,r=Mi();if(Yn){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===_s)throw Error(o(349));0!==(30&Bi)||Qi(i,t,n)}r.memoizedState=n;var s={value:n,getSnapshot:t};return r.queue=s,Ji(Xi.bind(null,i,s,e),[e]),i.flags|=2048,Pi(9,Ki.bind(null,i,s,n,t),void 0,null),n},useId:function(){var e=Mi(),t=_s.identifierPrefix;if(Yn){var n=Tn;t=":"+t+"R"+(n=(kn&~(1<<32-yt(kn)-1)).toString(32)+n),0<(n=Si++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=Ri++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Ir={readContext:un,useCallback:ir,useContext:un,useEffect:ji,useImperativeHandle:tr,useInsertionEffect:qi,useLayoutEffect:$i,useMemo:rr,useReducer:Ti,useRef:Ui,useState:function(){return Ti(ki)},useDebugValue:nr,useDeferredValue:function(e){var t=Ti(ki),n=t[0],i=t[1];return ji((function(){var t=bi.transition;bi.transition={};try{i(e)}finally{bi.transition=t}}),[e]),n},useTransition:function(){return[Ti(ki)[0],Wi().memoizedState]},useMutableSource:Li,useSyncExternalStore:Hi,useId:or,unstable_isNewReconciler:!1},pr={readContext:un,useCallback:ir,useContext:un,useEffect:ji,useImperativeHandle:tr,useInsertionEffect:qi,useLayoutEffect:$i,useMemo:rr,useReducer:Vi,useRef:Ui,useState:function(){return Vi(ki)},useDebugValue:nr,useDeferredValue:function(e){var t=Vi(ki),n=t[0],i=t[1];return ji((function(){var t=bi.transition;bi.transition={};try{i(e)}finally{bi.transition=t}}),[e]),n},useTransition:function(){return[Vi(ki)[0],Wi().memoizedState]},useMutableSource:Li,useSyncExternalStore:Hi,useId:or,unstable_isNewReconciler:!1};function Cr(e,t){try{var n="",i=t;do{n+=$t(i),i=i.return}while(i);var r=n}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:r}}function mr(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var fr,yr,br,Br,vr="function"===typeof WeakMap?WeakMap:Map;function wr(e,t,n){(n=pn(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){go||(go=!0,uo=i),mr(0,t)},n}function Gr(e,t,n){(n=pn(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){mr(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){mr(0,t),"function"!==typeof i&&(null===Ao?Ao=new Set([this]):Ao.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function Er(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new vr;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=Po.bind(null,e,t,n),t.then(e,e))}function xr(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function Sr(e,t,n,i,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=pn(-1,1)).tag=2,Cn(n,t))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}function Rr(e){e.flags|=4}function Zr(e,t){if(null!==e&&e.child===t.child)return!0;if(0!==(16&t.flags))return!1;for(e=t.child;null!==e;){if(0!==(12854&e.flags)||0!==(12854&e.subtreeFlags))return!1;e=e.sibling}return!0}if(_)fr=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)L(e,n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},yr=function(){},br=function(e,t,n,i,r){if((e=e.memoizedProps)!==i){var s=t.stateNode,o=ui(li.current);n=Q(s,n,e,i,r,o),(t.updateQueue=n)&&Rr(t)}},Br=function(e,t,n,i){n!==i&&Rr(t)};else if(O){fr=function(e,t,n,i){for(var r=t.child;null!==r;){if(5===r.tag){var s=r.stateNode;n&&i&&(s=De(s,r.type,r.memoizedProps,r)),L(e,s)}else if(6===r.tag)s=r.stateNode,n&&i&&(s=Fe(s,r.memoizedProps,r)),L(e,s);else if(4!==r.tag)if(22===r.tag&&null!==r.memoizedState)null!==(s=r.child)&&(s.return=r),fr(e,r,!0,!0);else if(null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};var Dr=function(e,t,n,i){for(var r=t.child;null!==r;){if(5===r.tag){var s=r.stateNode;n&&i&&(s=De(s,r.type,r.memoizedProps,r)),Se(e,s)}else if(6===r.tag)s=r.stateNode,n&&i&&(s=Fe(s,r.memoizedProps,r)),Se(e,s);else if(4!==r.tag)if(22===r.tag&&null!==r.memoizedState)null!==(s=r.child)&&(s.return=r),Dr(e,r,!0,!0);else if(null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};yr=function(e,t){var n=t.stateNode;if(!Zr(e,t)){e=n.containerInfo;var i=xe(e);Dr(i,t,!1,!1),n.pendingChildren=i,Rr(t),Re(e,i)}},br=function(e,t,n,i,r){var s=e.stateNode,o=e.memoizedProps;if((e=Zr(e,t))&&o===i)t.stateNode=s;else{var a=t.stateNode,l=ui(li.current),c=null;o!==i&&(c=Q(a,n,o,i,r,l)),e&&null===c?t.stateNode=s:(s=Ee(s,c,n,o,i,t,e,a),H(s,n,i,r,l)&&Rr(t),t.stateNode=s,e?Rr(t):fr(s,t,!1,!1))}},Br=function(e,t,n,i){n!==i?(e=ui(gi.current),n=ui(li.current),t.stateNode=X(i,e,n,t),Rr(t)):t.stateNode=e.stateNode}}else yr=function(){},br=function(){},Br=function(){};function Fr(e,t){if(!Yn)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Nr(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Mr(e,t,n){var i=t.pendingProps;switch(Qn(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nr(t),null;case 1:case 17:return ht(t.type)&&It(),Nr(t),null;case 3:return i=t.stateNode,di(),at(ut),at(gt),fi(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(qn(t)?Rr(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==Pn&&(So(Pn),Pn=null))),yr(e,t),Nr(t),null;case 5:Ii(t),n=ui(gi.current);var r=t.type;if(null!==e&&null!=t.stateNode)br(e,t,r,i,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(o(166));return Nr(t),null}if(e=ui(li.current),qn(t)){if(!J)throw Error(o(175));e=Xe(t.stateNode,t.type,t.memoizedProps,n,e,t,!zn),t.updateQueue=e,null!==e&&Rr(t)}else{var s=V(r,i,n,e,t);fr(s,t,!1,!1),t.stateNode=s,H(s,r,i,n,e)&&Rr(t)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Nr(t),null;case 6:if(e&&null!=t.stateNode)Br(e,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(o(166));if(e=ui(gi.current),n=ui(li.current),qn(t)){if(!J)throw Error(o(176));if(e=t.stateNode,i=t.memoizedProps,(n=Ye(e,i,t,!zn))&&null!==(r=Kn))switch(s=0!==(1&r.mode),r.tag){case 3:qe(r.stateNode.containerInfo,e,i,s);break;case 5:$e(r.type,r.memoizedProps,r.stateNode,e,i,s)}n&&Rr(t)}else t.stateNode=X(i,e,n,t)}return Nr(t),null;case 13:if(at(pi),i=t.memoizedState,Yn&&null!==Xn&&0!==(1&t.mode)&&0===(128&t.flags)){for(e=Xn;e;)e=Le(e);return $n(),t.flags|=98560,t}if(null!==i&&null!==i.dehydrated){if(i=qn(t),null===e){if(!i)throw Error(o(318));if(!J)throw Error(o(344));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(o(317));ze(e,t)}else $n(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;return Nr(t),null}return null!==Pn&&(So(Pn),Pn=null),0!==(128&t.flags)?(t.lanes=n,t):(i=null!==i,n=!1,null===e?qn(t):n=null!==e.memoizedState,i&&!n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&pi.current)?0===$s&&($s=3):ko())),null!==t.updateQueue&&(t.flags|=4),Nr(t),null);case 4:return di(),yr(e,t),null===e&&q(t.stateNode.containerInfo),Nr(t),null;case 10:return ln(t.type._context),Nr(t),null;case 19:if(at(pi),null===(r=t.memoizedState))return Nr(t),null;if(i=0!==(128&t.flags),null===(s=r.rendering))if(i)Fr(r,!1);else{if(0!==$s||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=Ci(e))){for(t.flags|=128,Fr(r,!1),null!==(e=s.updateQueue)&&(t.updateQueue=e,t.flags|=4),t.subtreeFlags=0,e=n,i=t.child;null!==i;)r=e,(n=i).flags&=14680066,null===(s=n.alternate)?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=s.childLanes,n.lanes=s.lanes,n.child=s.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=s.memoizedProps,n.memoizedState=s.memoizedState,n.updateQueue=s.updateQueue,n.type=s.type,r=s.dependencies,n.dependencies=null===r?null:{lanes:r.lanes,firstContext:r.firstContext}),i=i.sibling;return lt(pi,1&pi.current|2),t.child}e=e.sibling}null!==r.tail&&Vt()>ao&&(t.flags|=128,i=!0,Fr(r,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=Ci(s))){if(t.flags|=128,i=!0,null!==(e=e.updateQueue)&&(t.updateQueue=e,t.flags|=4),Fr(r,!0),null===r.tail&&"hidden"===r.tailMode&&!s.alternate&&!Yn)return Nr(t),null}else 2*Vt()-r.renderingStartTime>ao&&1073741824!==n&&(t.flags|=128,i=!0,Fr(r,!1),t.lanes=4194304);r.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=r.last)?e.sibling=s:t.child=s,r.last=s)}return null!==r.tail?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=Vt(),t.sibling=null,e=pi.current,lt(pi,i?1&e|2:1&e),t):(Nr(t),null);case 22:case 23:return Fo(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&js)&&(Nr(t),_&&6&t.subtreeFlags&&(t.flags|=8192)):Nr(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}var Wr=a.ReactCurrentOwner,kr=!1;function Tr(e,t,n,i){t.child=null===e?oi(t,null,n,i):si(t,e.child,n,i)}function Vr(e,t,n,i,r){n=n.render;var s=t.ref;return gn(t,r),i=Fi(e,t,n,i,s,r),n=Ni(),null===e||kr?(Yn&&n&&Hn(t),t.flags|=1,Tr(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,rs(e,t,r))}function Lr(e,t,n,i,r){if(null===e){var s=n.type;return"function"!==typeof s||$o(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=ta(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Hr(e,t,s,i,r))}if(s=e.child,0===(e.lanes&r)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:qt)(o,i)&&e.ref===t.ref)return rs(e,t,r)}return t.flags|=1,(e=ea(s,i)).ref=t.ref,e.return=t,t.child=e}function Hr(e,t,n,i,r){if(null!==e&&qt(e.memoizedProps,i)&&e.ref===t.ref){if(kr=!1,0===(e.lanes&r))return t.lanes=e.lanes,rs(e,t,r);0!==(131072&e.flags)&&(kr=!0)}return Xr(e,t,n,i,r)}function Qr(e,t,n){var i=t.pendingProps,r=i.children,s=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null},lt(qs,js),js|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null},t.updateQueue=null,lt(qs,js),js|=e,null;t.memoizedState={baseLanes:0,cachePool:null},i=null!==s?s.baseLanes:n,lt(qs,js),js|=i}else null!==s?(i=s.baseLanes|n,t.memoizedState=null):i=n,lt(qs,js),js|=i;return Tr(e,t,r,n),t.child}function Kr(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Xr(e,t,n,i,r){var s=ht(n)?At:gt.current;return s=dt(t,s),gn(t,r),n=Fi(e,t,n,i,s,r),i=Ni(),null===e||kr?(Yn&&i&&Hn(t),t.flags|=1,Tr(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,rs(e,t,r))}function Yr(e,t,n,i,r){if(ht(n)){var s=!0;mt(t)}else s=!1;if(gn(t,r),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),En(t,n,i),Sn(t,n,i,r),i=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=un(c):c=dt(t,c=ht(n)?At:gt.current);var g=n.getDerivedStateFromProps,u="function"===typeof g||"function"===typeof o.getSnapshotBeforeUpdate;u||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==i||l!==c)&&xn(t,o,i,c),dn=!1;var A=t.memoizedState;o.state=A,yn(t,i,o,r),l=t.memoizedState,a!==i||A!==l||ut.current||dn?("function"===typeof g&&(vn(t,n,g,i),l=t.memoizedState),(a=dn||Gn(t,n,a,i,A,l,c))?(u||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),o.props=i,o.state=l,o.context=c,i=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,In(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:en(t.type,a),o.props=c,u=t.pendingProps,A=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=un(l):l=dt(t,l=ht(n)?At:gt.current);var d=n.getDerivedStateFromProps;(g="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==u||A!==l)&&xn(t,o,i,l),dn=!1,A=t.memoizedState,o.state=A,yn(t,i,o,r);var h=t.memoizedState;a!==u||A!==h||ut.current||dn?("function"===typeof d&&(vn(t,n,d,i),h=t.memoizedState),(c=dn||Gn(t,n,c,i,A,h,l)||!1)?(g||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(i,h,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,h,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&A===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&A===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=h),o.props=i,o.state=h,o.context=l,i=c):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&A===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&A===e.memoizedState||(t.flags|=1024),i=!1)}return zr(e,t,n,i,s,r)}function zr(e,t,n,i,r,s){Kr(e,t);var o=0!==(128&t.flags);if(!i&&!o)return r&&ft(t,n,!1),rs(e,t,s);i=t.stateNode,Wr.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&o?(t.child=si(t,e.child,null,s),t.child=si(t,null,a,s)):Tr(e,t,a,s),t.memoizedState=i.state,r&&ft(t,n,!0),t.child}function Pr(e){var t=e.stateNode;t.pendingContext?pt(0,t.pendingContext,t.pendingContext!==t.context):t.context&&pt(0,t.context,!1),Ai(e,t.containerInfo)}function Ur(e,t,n,i,r){return $n(),ei(r),t.flags|=256,Tr(e,t,n,i),t.child}var _r={dehydrated:null,treeContext:null,retryLane:0};function Or(e){return{baseLanes:e,cachePool:null}}function Jr(e,t,n){var i,r=t.pendingProps,s=pi.current,a=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&s)),i?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),lt(pi,1&s),null===e)return Jn(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:Te(e)?t.lanes=8:t.lanes=1073741824,null):(s=r.children,e=r.fallback,a?(r=t.mode,a=t.child,s={mode:"hidden",children:s},0===(1&r)&&null!==a?(a.childLanes=0,a.pendingProps=s):a=ia(s,r,0,null),e=na(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Or(n),t.memoizedState=_r,e):jr(t,s));if(null!==(s=e.memoizedState)){if(null!==(i=s.dehydrated)){if(l)return 256&t.flags?(t.flags&=-257,es(e,t,n,Error(o(422)))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,s=t.mode,r=ia({mode:"visible",children:r.children},s,0,null),(a=na(a,s,n,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&si(t,e.child,null,n),t.child.memoizedState=Or(n),t.memoizedState=_r,a);if(0===(1&t.mode))t=es(e,t,n,null);else if(Te(i))t=es(e,t,n,Error(o(419)));else if(r=0!==(n&e.childLanes),kr||r){if(null!==(r=_s)){switch(n&-n){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(r=0!==(a&(r.suspendedLanes|n))?0:a)&&r!==s.retryLane&&(s.retryLane=r,vo(e,r,-1))}ko(),t=es(e,t,n,Error(o(421)))}else ke(i)?(t.flags|=128,t.child=e.child,t=_o.bind(null,e),Ve(i,t),t=null):(n=s.treeContext,J&&(Xn=Ke(i),Kn=t,Yn=!0,Pn=null,zn=!1,null!==n&&(Nn[Mn++]=kn,Nn[Mn++]=Tn,Nn[Mn++]=Wn,kn=n.id,Tn=n.overflow,Wn=t)),(t=jr(t,t.pendingProps.children)).flags|=4096);return t}return a?(r=$r(e,t,r.children,r.fallback,n),a=t.child,s=e.child.memoizedState,a.memoizedState=null===s?Or(n):{baseLanes:s.baseLanes|n,cachePool:null},a.childLanes=e.childLanes&~n,t.memoizedState=_r,r):(n=qr(e,t,r.children,n),t.memoizedState=null,n)}return a?(r=$r(e,t,r.children,r.fallback,n),a=t.child,s=e.child.memoizedState,a.memoizedState=null===s?Or(n):{baseLanes:s.baseLanes|n,cachePool:null},a.childLanes=e.childLanes&~n,t.memoizedState=_r,r):(n=qr(e,t,r.children,n),t.memoizedState=null,n)}function jr(e,t){return(t=ia({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function qr(e,t,n,i){var r=e.child;return e=r.sibling,n=ea(r,{mode:"visible",children:n}),0===(1&t.mode)&&(n.lanes=i),n.return=t,n.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=n}function $r(e,t,n,i,r){var s=t.mode,o=(e=e.child).sibling,a={mode:"hidden",children:n};return 0===(1&s)&&t.child!==e?((n=t.child).childLanes=0,n.pendingProps=a,t.deletions=null):(n=ea(e,a)).subtreeFlags=14680064&e.subtreeFlags,null!==o?i=ea(o,i):(i=na(i,s,r,null)).flags|=2,i.return=t,n.return=t,n.sibling=i,t.child=n,i}function es(e,t,n,i){return null!==i&&ei(i),si(t,e.child,null,n),(e=jr(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function ts(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),cn(e.return,t,n)}function ns(e,t,n,i,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function is(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(Tr(e,t,i.children,n),0!==(2&(i=pi.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ts(e,n,t);else if(19===e.tag)ts(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(lt(pi,i),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===Ci(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),ns(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===Ci(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}ns(t,!0,n,null,s);break;case"together":ns(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function rs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),to|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=ea(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=ea(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function ss(e,t){switch(Qn(t),t.tag){case 1:return ht(t.type)&&It(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return di(),at(ut),at(gt),fi(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Ii(t),null;case 13:if(at(pi),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));$n()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return at(pi),null;case 4:return di(),null;case 10:return ln(t.type._context),null;case 22:case 23:return Fo(),null;default:return null}}var os=!1,as=!1,ls="function"===typeof WeakSet?WeakSet:Set,cs=null;function gs(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){zo(e,t,i)}else n.current=null}function us(e,t,n){try{n()}catch(i){zo(e,t,i)}}var As=!1;function ds(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&us(t,n,s)}r=r.next}while(r!==i)}}function hs(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function Is(e){var t=e.ref;if(null!==t){var n=e.stateNode;if(5===e.tag)e=N(n);else e=n;"function"===typeof t?t(e):t.current=e}}function ps(e,t,n){if(Yt&&"function"===typeof Yt.onCommitFiberUnmount)try{Yt.onCommitFiberUnmount(Xt,t)}catch(o){}switch(t.tag){case 0:case 11:case 14:case 15:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var i=e=e.next;do{var r=i,s=r.destroy;r=r.tag,void 0!==s&&(0!==(2&r)||0!==(4&r))&&us(t,n,s),i=i.next}while(i!==e)}break;case 1:if(gs(t,n),"function"===typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(o){zo(t,n,o)}break;case 5:gs(t,n);break;case 4:_?ws(e,t,n):O&&O&&(t=t.stateNode.containerInfo,n=xe(t),Ze(t,n))}}function Cs(e,t,n){for(var i=t;;)if(ps(e,i,n),null===i.child||_&&4===i.tag){if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}else i.child.return=i,i=i.child}function ms(e){var t=e.alternate;null!==t&&(e.alternate=null,ms(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&ee(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function fs(e){return 5===e.tag||3===e.tag||4===e.tag}function ys(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||fs(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function bs(e){if(_){e:{for(var t=e.return;null!==t;){if(fs(t))break e;t=t.return}throw Error(o(160))}var n=t;switch(n.tag){case 5:t=n.stateNode,32&n.flags&&(ye(t),n.flags&=-33),vs(e,n=ys(e),t);break;case 3:case 4:t=n.stateNode.containerInfo,Bs(e,n=ys(e),t);break;default:throw Error(o(161))}}}function Bs(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?Ce(n,e,t):Ae(n,e);else if(4!==i&&null!==(e=e.child))for(Bs(e,t,n),e=e.sibling;null!==e;)Bs(e,t,n),e=e.sibling}function vs(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?pe(n,e,t):ue(n,e);else if(4!==i&&null!==(e=e.child))for(vs(e,t,n),e=e.sibling;null!==e;)vs(e,t,n),e=e.sibling}function ws(e,t,n){for(var i,r,s=t,a=!1;;){if(!a){a=s.return;e:for(;;){if(null===a)throw Error(o(160));switch(i=a.stateNode,a.tag){case 5:r=!1;break e;case 3:case 4:i=i.containerInfo,r=!0;break e}a=a.return}a=!0}if(5===s.tag||6===s.tag)Cs(e,s,n),r?fe(i,s.stateNode):me(i,s.stateNode);else if(18===s.tag)r?Je(i,s.stateNode):Oe(i,s.stateNode);else if(4===s.tag){if(null!==s.child){i=s.stateNode.containerInfo,r=!0,s.child.return=s,s=s.child;continue}}else if(ps(e,s,n),null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break;for(;null===s.sibling;){if(null===s.return||s.return===t)return;4===(s=s.return).tag&&(a=!1)}s.sibling.return=s.return,s=s.sibling}}function Gs(e,t){if(_){switch(t.tag){case 0:case 11:case 14:case 15:return ds(3,t,t.return),hs(3,t),void ds(5,t,t.return);case 1:case 12:case 17:return;case 5:var n=t.stateNode;if(null!=n){var i=t.memoizedProps;e=null!==e?e.memoizedProps:i;var r=t.type,s=t.updateQueue;t.updateQueue=null,null!==s&&Ie(n,s,r,e,i,t)}return;case 6:if(null===t.stateNode)throw Error(o(162));return n=t.memoizedProps,void de(t.stateNode,null!==e?e.memoizedProps:n,n);case 3:return void(J&&null!==e&&e.memoizedState.isDehydrated&&Ue(t.stateNode.containerInfo));case 13:case 19:return void Es(t)}throw Error(o(163))}switch(t.tag){case 0:case 11:case 14:case 15:return ds(3,t,t.return),hs(3,t),void ds(5,t,t.return);case 12:case 22:case 23:return;case 13:case 19:return void Es(t);case 3:J&&null!==e&&e.memoizedState.isDehydrated&&Ue(t.stateNode.containerInfo)}e:if(O){switch(t.tag){case 1:case 5:case 6:break e;case 3:case 4:t=t.stateNode,Ze(t.containerInfo,t.pendingChildren);break e}throw Error(o(163))}}function Es(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new ls),t.forEach((function(t){var i=Oo.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}}function xs(e,t,n){cs=e,Ss(e,t,n)}function Ss(e,t,n){for(var i=0!==(1&e.mode);null!==cs;){var r=cs,s=r.child;if(22===r.tag&&i){var o=null!==r.memoizedState||os;if(!o){var a=r.alternate,l=null!==a&&null!==a.memoizedState||as;a=os;var c=as;if(os=o,(as=l)&&!c)for(cs=r;null!==cs;)l=(o=cs).child,22===o.tag&&null!==o.memoizedState?Ds(r):null!==l?(l.return=o,cs=l):Ds(r);for(;null!==s;)cs=s,Ss(s,t,n),s=s.sibling;cs=r,os=a,as=c}Rs(e)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,cs=s):Rs(e)}}function Rs(e){for(;null!==cs;){var t=cs;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:as||hs(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!as)if(null===n)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:en(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&bn(t,s,i);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:n=N(t.child.stateNode);break;case 1:n=t.child.stateNode}bn(t,a,n)}break;case 5:var l=t.stateNode;null===n&&4&t.flags&&he(l,t.type,t.memoizedProps,t);break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:break;case 13:if(J&&null===t.memoizedState){var c=t.alternate;if(null!==c){var g=c.memoizedState;if(null!==g){var u=g.dehydrated;null!==u&&_e(u)}}}break;default:throw Error(o(163))}as||512&t.flags&&Is(t)}catch(A){zo(t,t.return,A)}}if(t===e){cs=null;break}if(null!==(n=t.sibling)){n.return=t.return,cs=n;break}cs=t.return}}function Zs(e){for(;null!==cs;){var t=cs;if(t===e){cs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,cs=n;break}cs=t.return}}function Ds(e){for(;null!==cs;){var t=cs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{hs(4,t)}catch(l){zo(t,n,l)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(l){zo(t,r,l)}}var s=t.return;try{Is(t)}catch(l){zo(t,s,l)}break;case 5:var o=t.return;try{Is(t)}catch(l){zo(t,o,l)}}}catch(l){zo(t,t.return,l)}if(t===e){cs=null;break}var a=t.sibling;if(null!==a){a.return=t.return,cs=a;break}cs=t.return}}var Fs=0,Ns=1,Ms=2,Ws=3,ks=4;if("function"===typeof Symbol&&Symbol.for){var Ts=Symbol.for;Fs=Ts("selector.component"),Ns=Ts("selector.has_pseudo_class"),Ms=Ts("selector.role"),Ws=Ts("selector.test_id"),ks=Ts("selector.text")}function Vs(e){var t=j(e);if(null!=t){if("string"!==typeof t.memoizedProps["data-testname"])throw Error(o(364));return t}if(null===(e=re(e)))throw Error(o(362));return e.stateNode.current}function Ls(e,t){switch(t.$$typeof){case Fs:if(e.type===t.value)return!0;break;case Ns:e:{t=t.value,e=[e,0];for(var n=0;n<e.length;){var i=e[n++],r=e[n++],s=t[r];if(5!==i.tag||!ae(i)){for(;null!=s&&Ls(i,s);)s=t[++r];if(r===t.length){t=!0;break e}for(i=i.child;null!==i;)e.push(i,r),i=i.sibling}}t=!1}return t;case Ms:if(5===e.tag&&le(e.stateNode,t.value))return!0;break;case ks:if((5===e.tag||6===e.tag)&&(null!==(e=oe(e))&&0<=e.indexOf(t.value)))return!0;break;case Ws:if(5===e.tag&&("string"===typeof(e=e.memoizedProps["data-testname"])&&e.toLowerCase()===t.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function Hs(e){switch(e.$$typeof){case Fs:return"<"+(v(e.value)||"Unknown")+">";case Ns:return":has("+(Hs(e)||"")+")";case Ms:return'[role="'+e.value+'"]';case ks:return'"'+e.value+'"';case Ws:return'[data-testname="'+e.value+'"]';default:throw Error(o(365))}}function Qs(e,t){var n=[];e=[e,0];for(var i=0;i<e.length;){var r=e[i++],s=e[i++],o=t[s];if(5!==r.tag||!ae(r)){for(;null!=o&&Ls(r,o);)o=t[++s];if(s===t.length)n.push(r);else for(r=r.child;null!==r;)e.push(r,s),r=r.sibling}}return n}function Ks(e,t){if(!ie)throw Error(o(363));e=Qs(e=Vs(e),t),t=[],e=Array.from(e);for(var n=0;n<e.length;){var i=e[n++];if(5===i.tag)ae(i)||t.push(i.stateNode);else for(i=i.child;null!==i;)e.push(i),i=i.sibling}return t}var Xs=Math.ceil,Ys=a.ReactCurrentDispatcher,zs=a.ReactCurrentOwner,Ps=a.ReactCurrentBatchConfig,Us=0,_s=null,Os=null,Js=0,js=0,qs=ot(0),$s=0,eo=null,to=0,no=0,io=0,ro=null,so=null,oo=0,ao=1/0;function lo(){ao=Vt()+500}var co,go=!1,uo=null,Ao=null,ho=!1,Io=null,po=0,Co=0,mo=null,fo=-1,yo=0;function bo(){return 0!==(6&Us)?Vt():-1!==fo?fo:fo=Vt()}function Bo(e){return 0===(1&e.mode)?1:0!==(2&Us)&&0!==Js?Js&-Js:null!==jt.transition?(0===yo&&(e=vt,0===(4194240&(vt<<=1))&&(vt=64),yo=e),yo):0!==(e=Ft)?e:$()}function vo(e,t,n){if(50<Co)throw Co=0,mo=null,Error(o(185));var i=wo(e,t);return null===i?null:(Zt(i,t,n),0!==(2&Us)&&i===_s||(i===_s&&(0===(2&Us)&&(no|=t),4===$s&&Ro(i,Js)),Go(i,n),1===t&&0===Us&&0===(1&e.mode)&&(lo(),Ut&&Jt())),i)}function wo(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function Go(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-yt(s),a=1<<o,l=r[o];-1===l?0!==(a&n)&&0===(a&i)||(r[o]=xt(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var i=Et(e,e===_s?Js:0);if(0===i)null!==n&&Wt(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&Wt(n),1===t)0===e.tag?function(e){Ut=!0,Ot(e)}(Zo.bind(null,e)):Ot(Zo.bind(null,e)),te?ne((function(){0===Us&&Jt()})):Mt(Lt,Jt),n=null;else{switch(Nt(i)){case 1:n=Lt;break;case 4:n=Ht;break;case 16:default:n=Qt;break;case 536870912:n=Kt}n=Jo(n,Eo.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Eo(e,t){if(fo=-1,yo=0,0!==(6&Us))throw Error(o(327));var n=e.callbackNode;if(Xo()&&e.callbackNode!==n)return null;var i=Et(e,e===_s?Js:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=To(e,i);else{t=i;var r=Us;Us|=2;var s=Wo();for(_s===e&&Js===t||(lo(),No(e,t));;)try{Lo();break}catch(l){Mo(e,l)}on(),Ys.current=s,Us=r,null!==Os?t=0:(_s=null,Js=0,t=$s)}if(0!==t){if(2===t&&(0!==(r=St(e))&&(i=r,t=xo(e,r))),1===t)throw n=eo,No(e,0),Ro(e,i),Go(e,Vt()),n;if(6===t)Ro(e,i);else{if(r=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!zt(s(),r))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=To(e,i))&&(0!==(s=St(e))&&(i=s,t=xo(e,s))),1===t))throw n=eo,No(e,0),Ro(e,i),Go(e,Vt()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(o(345));case 2:case 5:Ko(e,so);break;case 3:if(Ro(e,i),(130023424&i)===i&&10<(t=oo+500-Vt())){if(0!==Et(e,0))break;if(((r=e.suspendedLanes)&i)!==i){bo(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=Y(Ko.bind(null,e,so),t);break}Ko(e,so);break;case 4:if(Ro(e,i),(4194240&i)===i)break;for(t=e.eventTimes,r=-1;0<i;){var a=31-yt(i);s=1<<a,(a=t[a])>r&&(r=a),i&=~s}if(i=r,10<(i=(120>(i=Vt()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Xs(i/1960))-i)){e.timeoutHandle=Y(Ko.bind(null,e,so),i);break}Ko(e,so);break;default:throw Error(o(329))}}}return Go(e,Vt()),e.callbackNode===n?Eo.bind(null,e):null}function xo(e,t){var n=ro;return e.current.memoizedState.isDehydrated&&(No(e,t).flags|=256),2!==(e=To(e,t))&&(t=so,so=n,null!==t&&So(t)),e}function So(e){null===so?so=e:so.push.apply(so,e)}function Ro(e,t){for(t&=~io,t&=~no,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-yt(t),i=1<<n;e[n]=-1,t&=~i}}function Zo(e){if(0!==(6&Us))throw Error(o(327));Xo();var t=Et(e,0);if(0===(1&t))return Go(e,Vt()),null;var n=To(e,t);if(0!==e.tag&&2===n){var i=St(e);0!==i&&(t=i,n=xo(e,i))}if(1===n)throw n=eo,No(e,0),Ro(e,t),Go(e,Vt()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ko(e,so),Go(e,Vt()),null}function Do(e){null!==Io&&0===Io.tag&&0===(6&Us)&&Xo();var t=Us;Us|=1;var n=Ps.transition,i=Ft;try{if(Ps.transition=null,Ft=1,e)return e()}finally{Ft=i,Ps.transition=n,0===(6&(Us=t))&&Jt()}}function Fo(){js=qs.current,at(qs)}function No(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==P&&(e.timeoutHandle=P,z(n)),null!==Os)for(n=Os.return;null!==n;){var i=n;switch(Qn(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&It();break;case 3:di(),at(ut),at(gt),fi();break;case 5:Ii(i);break;case 4:di();break;case 13:case 19:at(pi);break;case 10:ln(i.type._context);break;case 22:case 23:Fo()}n=n.return}if(_s=e,Os=e=ea(e.current,null),Js=js=t,$s=0,eo=null,io=no=to=0,so=ro=null,null!==An){for(t=0;t<An.length;t++)if(null!==(i=(n=An[t]).interleaved)){n.interleaved=null;var r=i.next,s=n.pending;if(null!==s){var o=s.next;s.next=r,i.next=o}n.pending=i}An=null}return e}function Mo(e,t){for(;;){var n=Os;try{if(on(),yi.current=dr,Ei){for(var i=vi.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}Ei=!1}if(Bi=0,Gi=wi=vi=null,xi=!1,Si=0,zs.current=null,null===n||null===n.return){$s=1,eo=t,Os=null;break}e:{var s=e,a=n.return,l=n,c=t;if(t=Js,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var g=c,u=l,A=u.tag;if(0===(1&u.mode)&&(0===A||11===A||15===A)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=xr(a);if(null!==h){h.flags&=-257,Sr(h,a,l,0,t),1&h.mode&&Er(s,g,t),c=g;var I=(t=h).updateQueue;if(null===I){var p=new Set;p.add(c),t.updateQueue=p}else I.add(c);break e}if(0===(1&t)){Er(s,g,t),ko();break e}c=Error(o(426))}else if(Yn&&1&l.mode){var C=xr(a);if(null!==C){0===(65536&C.flags)&&(C.flags|=256),Sr(C,a,l,0,t),ei(c);break e}}s=c,4!==$s&&($s=2),null===ro?ro=[s]:ro.push(s),c=Cr(c,l),l=a;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t,fn(l,wr(0,c,t));break e;case 1:s=c;var m=l.type,f=l.stateNode;if(0===(128&l.flags)&&("function"===typeof m.getDerivedStateFromError||null!==f&&"function"===typeof f.componentDidCatch&&(null===Ao||!Ao.has(f)))){l.flags|=65536,t&=-t,l.lanes|=t,fn(l,Gr(l,s,t));break e}}l=l.return}while(null!==l)}Qo(n)}catch(y){t=y,Os===n&&null!==n&&(Os=n=n.return);continue}break}}function Wo(){var e=Ys.current;return Ys.current=dr,null===e?dr:e}function ko(){0!==$s&&3!==$s&&2!==$s||($s=4),null===_s||0===(268435455&to)&&0===(268435455&no)||Ro(_s,Js)}function To(e,t){var n=Us;Us|=2;var i=Wo();for(_s===e&&Js===t||No(e,t);;)try{Vo();break}catch(r){Mo(e,r)}if(on(),Us=n,Ys.current=i,null!==Os)throw Error(o(261));return _s=null,Js=0,$s}function Vo(){for(;null!==Os;)Ho(Os)}function Lo(){for(;null!==Os&&!kt();)Ho(Os)}function Ho(e){var t=co(e.alternate,e,js);e.memoizedProps=e.pendingProps,null===t?Qo(e):Os=t,zs.current=null}function Qo(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Mr(n,t,js)))return void(Os=n)}else{if(null!==(n=ss(n,t)))return n.flags&=32767,void(Os=n);if(null===e)return $s=6,void(Os=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Os=t);Os=t=e}while(null!==t);0===$s&&($s=5)}function Ko(e,t){var n=Ft,i=Ps.transition;try{Ps.transition=null,Ft=1,function(e,t,n){do{Xo()}while(null!==Io);if(0!==(6&Us))throw Error(o(327));var i=e.finishedWork,r=e.finishedLanes;if(null===i)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var s=i.lanes|i.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-yt(n),s=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~s}}(e,s),e===_s&&(Os=_s=null,Js=0),0===(2064&i.subtreeFlags)&&0===(2064&i.flags)||ho||(ho=!0,Jo(Qt,(function(){return Xo(),null}))),s=0!==(15990&i.flags),0!==(15990&i.subtreeFlags)||s){s=Ps.transition,Ps.transition=null;var a=Ft;Ft=1;var l=Us;Us|=4,zs.current=null,function(e,t){for(k(e.containerInfo),cs=t;null!==cs;)if(t=(e=cs).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,cs=t;else for(;null!==cs;){e=cs;try{var n=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==n){var i=n.memoizedProps,r=n.memoizedState,s=e.stateNode,a=s.getSnapshotBeforeUpdate(e.elementType===e.type?i:en(e.type,i),r);s.__reactInternalSnapshotBeforeUpdate=a}break;case 3:_&&Ge(e.stateNode.containerInfo);break;default:throw Error(o(163))}}catch(l){zo(e,e.return,l)}if(null!==(t=e.sibling)){t.return=e.return,cs=t;break}cs=e.return}n=As,As=!1}(e,i),function(e,t){for(cs=t;null!==cs;){var n=(t=cs).deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var s=e;_?ws(s,r,t):Cs(s,r,t);var o=r.alternate;null!==o&&(o.return=null),r.return=null}catch(b){zo(r,t,b)}}if(n=t.child,0!==(12854&t.subtreeFlags)&&null!==n)n.return=t,cs=n;else for(;null!==cs;){t=cs;try{var a=t.flags;if(32&a&&_&&ye(t.stateNode),512&a){var l=t.alternate;if(null!==l){var c=l.ref;null!==c&&("function"===typeof c?c(null):c.current=null)}}if(8192&a)switch(t.tag){case 13:if(null!==t.memoizedState){var g=t.alternate;null!==g&&null!==g.memoizedState||(oo=Vt())}break;case 22:var u=null!==t.memoizedState,A=t.alternate,d=null!==A&&null!==A.memoizedState;if(n=t,_)e:if(i=n,r=u,s=null,_)for(var h=i;;){if(5===h.tag){if(null===s){s=h;var I=h.stateNode;r?be(I):ve(h.stateNode,h.memoizedProps)}}else if(6===h.tag){if(null===s){var p=h.stateNode;r?Be(p):we(p,h.memoizedProps)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===i)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===i)break;for(;null===h.sibling;){if(null===h.return||h.return===i)break e;s===h&&(s=null),h=h.return}s===h&&(s=null),h.sibling.return=h.return,h=h.sibling}if(u&&!d&&0!==(1&n.mode)){cs=n;for(var C=n.child;null!==C;){for(n=cs=C;null!==cs;){var m=(i=cs).child;switch(i.tag){case 0:case 11:case 14:case 15:ds(4,i,i.return);break;case 1:gs(i,i.return);var f=i.stateNode;if("function"===typeof f.componentWillUnmount){var y=i.return;try{f.props=i.memoizedProps,f.state=i.memoizedState,f.componentWillUnmount()}catch(b){zo(i,y,b)}}break;case 5:gs(i,i.return);break;case 22:if(null!==i.memoizedState){Zs(n);continue}}null!==m?(m.return=i,cs=m):Zs(n)}C=C.sibling}}}switch(4102&a){case 2:bs(t),t.flags&=-3;break;case 6:bs(t),t.flags&=-3,Gs(t.alternate,t);break;case 4096:t.flags&=-4097;break;case 4100:t.flags&=-4097,Gs(t.alternate,t);break;case 4:Gs(t.alternate,t)}}catch(b){zo(t,t.return,b)}if(null!==(n=t.sibling)){n.return=t.return,cs=n;break}cs=t.return}}}(e,i),T(e.containerInfo),e.current=i,xs(i,e,r),Tt(),Us=l,Ft=a,Ps.transition=s}else e.current=i;if(ho&&(ho=!1,Io=e,po=r),s=e.pendingLanes,0===s&&(Ao=null),function(e){if(Yt&&"function"===typeof Yt.onCommitFiberRoot)try{Yt.onCommitFiberRoot(Xt,e,void 0,128===(128&e.current.flags))}catch(t){}}(i.stateNode),Go(e,Vt()),null!==t)for(n=e.onRecoverableError,i=0;i<t.length;i++)n(t[i]);if(go)throw go=!1,e=uo,uo=null,e;0!==(1&po)&&0!==e.tag&&Xo(),s=e.pendingLanes,0!==(1&s)?e===mo?Co++:(Co=0,mo=e):Co=0,Jt()}(e,t,n)}finally{Ps.transition=i,Ft=n}return null}function Xo(){if(null!==Io){var e=Nt(po),t=Ps.transition,n=Ft;try{if(Ps.transition=null,Ft=16>e?16:e,null===Io)var i=!1;else{if(e=Io,Io=null,po=0,0!==(6&Us))throw Error(o(331));var r=Us;for(Us|=4,cs=e.current;null!==cs;){var s=cs,a=s.child;if(0!==(16&cs.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var g=l[c];for(cs=g;null!==cs;){var u=cs;switch(u.tag){case 0:case 11:case 15:ds(8,u,s)}var A=u.child;if(null!==A)A.return=u,cs=A;else for(;null!==cs;){var d=(u=cs).sibling,h=u.return;if(ms(u),u===g){cs=null;break}if(null!==d){d.return=h,cs=d;break}cs=h}}}var I=s.alternate;if(null!==I){var p=I.child;if(null!==p){I.child=null;do{var C=p.sibling;p.sibling=null,p=C}while(null!==p)}}cs=s}}if(0!==(2064&s.subtreeFlags)&&null!==a)a.return=s,cs=a;else e:for(;null!==cs;){if(0!==(2048&(s=cs).flags))switch(s.tag){case 0:case 11:case 15:ds(9,s,s.return)}var m=s.sibling;if(null!==m){m.return=s.return,cs=m;break e}cs=s.return}}var f=e.current;for(cs=f;null!==cs;){var y=(a=cs).child;if(0!==(2064&a.subtreeFlags)&&null!==y)y.return=a,cs=y;else e:for(a=f;null!==cs;){if(0!==(2048&(l=cs).flags))try{switch(l.tag){case 0:case 11:case 15:hs(9,l)}}catch(B){zo(l,l.return,B)}if(l===a){cs=null;break e}var b=l.sibling;if(null!==b){b.return=l.return,cs=b;break e}cs=l.return}}if(Us=r,Jt(),Yt&&"function"===typeof Yt.onPostCommitFiberRoot)try{Yt.onPostCommitFiberRoot(Xt,e)}catch(B){}i=!0}return i}finally{Ft=n,Ps.transition=t}}return!1}function Yo(e,t,n){Cn(e,t=wr(0,t=Cr(n,t),1)),t=bo(),null!==(e=wo(e,1))&&(Zt(e,1,t),Go(e,t))}function zo(e,t,n){if(3===e.tag)Yo(e,e,n);else for(;null!==t;){if(3===t.tag){Yo(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Ao||!Ao.has(i))){Cn(t,e=Gr(t,e=Cr(n,e),1)),e=bo(),null!==(t=wo(t,1))&&(Zt(t,1,e),Go(t,e));break}}t=t.return}}function Po(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=bo(),e.pingedLanes|=e.suspendedLanes&n,_s===e&&(Js&n)===n&&(4===$s||3===$s&&(130023424&Js)===Js&&500>Vt()-oo?No(e,0):io|=n),Go(e,t)}function Uo(e,t){0===t&&(0===(1&e.mode)?t=1:(t=wt,0===(130023424&(wt<<=1))&&(wt=4194304)));var n=bo();null!==(e=wo(e,t))&&(Zt(e,t,n),Go(e,n))}function _o(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Uo(e,n)}function Oo(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(o(314))}null!==i&&i.delete(t),Uo(e,n)}function Jo(e,t){return Mt(e,t)}function jo(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qo(e,t,n,i){return new jo(e,t,n,i)}function $o(e){return!(!(e=e.prototype)||!e.isReactComponent)}function ea(e,t){var n=e.alternate;return null===n?((n=qo(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ta(e,t,n,i,r,s){var a=2;if(i=e,"function"===typeof e)$o(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case g:return na(n.children,r,s,t);case u:a=8,r|=8;break;case A:return(e=qo(12,n,t,2|r)).elementType=A,e.lanes=s,e;case p:return(e=qo(13,n,t,r)).elementType=p,e.lanes=s,e;case C:return(e=qo(19,n,t,r)).elementType=C,e.lanes=s,e;case y:return ia(n,r,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case d:a=10;break e;case h:a=9;break e;case I:a=11;break e;case m:a=14;break e;case f:a=16,i=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=qo(a,n,t,r)).elementType=e,t.type=i,t.lanes=s,t}function na(e,t,n,i){return(e=qo(7,e,i,t)).lanes=n,e}function ia(e,t,n,i){return(e=qo(22,e,i,t)).elementType=y,e.lanes=n,e.stateNode={},e}function ra(e,t,n){return(e=qo(6,e,null,t)).lanes=n,e}function sa(e,t,n){return(t=qo(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function oa(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=P,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Rt(0),this.expirationTimes=Rt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rt(0),this.identifierPrefix=i,this.onRecoverableError=r,J&&(this.mutableSourceEagerHydrationData=null)}function aa(e,t,n,i,r,s,o,a,l){return e=new oa(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=qo(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null},hn(s),e}function la(e){if(!e)return ct;e:{if(G(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ht(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(ht(n))return Ct(e,n,t)}return t}function ca(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return null===(e=S(t))?null:e.stateNode}function ga(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function ua(e,t){ga(e,t),(e=e.alternate)&&ga(e,t)}function Aa(e){return null===(e=S(e))?null:e.stateNode}function da(){return null}return co=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||ut.current)kr=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return kr=!1,function(e,t,n){switch(t.tag){case 3:Pr(t),$n();break;case 5:hi(t);break;case 1:ht(t.type)&&mt(t);break;case 4:Ai(t,t.stateNode.containerInfo);break;case 10:an(0,t.type._context,t.memoizedProps.value);break;case 13:var i=t.memoizedState;if(null!==i)return null!==i.dehydrated?(lt(pi,1&pi.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Jr(e,t,n):(lt(pi,1&pi.current),null!==(e=rs(e,t,n))?e.sibling:null);lt(pi,1&pi.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return is(e,t,n);t.flags|=128}var r=t.memoizedState;if(null!==r&&(r.rendering=null,r.tail=null,r.lastEffect=null),lt(pi,pi.current),i)break;return null;case 22:case 23:return t.lanes=0,Qr(e,t,n)}return rs(e,t,n)}(e,t,n);kr=0!==(131072&e.flags)}else kr=!1,Yn&&0!==(1048576&t.flags)&&Ln(t,Fn,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps;var r=dt(t,gt.current);gn(t,n),r=Fi(null,t,i,e,r,n);var s=Ni();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ht(i)?(s=!0,mt(t)):s=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,hn(t),r.updater=wn,t.stateNode=r,r._reactInternals=t,Sn(t,i,e,n),t=zr(null,t,i,!0,s,n)):(t.tag=0,Yn&&s&&Hn(t),Tr(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=(r=i._init)(i._payload),t.type=i,r=t.tag=function(e){if("function"===typeof e)return $o(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===I)return 11;if(e===m)return 14}return 2}(i),e=en(i,e),r){case 0:t=Xr(null,t,i,e,n);break e;case 1:t=Yr(null,t,i,e,n);break e;case 11:t=Vr(null,t,i,e,n);break e;case 14:t=Lr(null,t,i,en(i.type,e),n);break e}throw Error(o(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,Xr(e,t,i,r=t.elementType===i?r:en(i,r),n);case 1:return i=t.type,r=t.pendingProps,Yr(e,t,i,r=t.elementType===i?r:en(i,r),n);case 3:e:{if(Pr(t),null===e)throw Error(o(387));i=t.pendingProps,r=(s=t.memoizedState).element,In(e,t),yn(t,i,null,n);var a=t.memoizedState;if(i=a.element,J&&s.isDehydrated){if(s={element:i,isDehydrated:!1,cache:a.cache,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Ur(e,t,i,n,r=Error(o(423)));break e}if(i!==r){t=Ur(e,t,i,n,r=Error(o(424)));break e}for(J&&(Xn=Qe(t.stateNode.containerInfo),Kn=t,Yn=!0,Pn=null,zn=!1),n=oi(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if($n(),i===r){t=rs(e,t,n);break e}Tr(e,t,i,n)}t=t.child}return t;case 5:return hi(t),null===e&&Jn(t),i=t.type,r=t.pendingProps,s=null!==e?e.memoizedProps:null,a=r.children,K(i,r)?a=null:null!==s&&K(i,s)&&(t.flags|=32),Kr(e,t),Tr(e,t,a,n),t.child;case 6:return null===e&&Jn(t),null;case 13:return Jr(e,t,n);case 4:return Ai(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=si(t,null,i,n):Tr(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,Vr(e,t,i,r=t.elementType===i?r:en(i,r),n);case 7:return Tr(e,t,t.pendingProps,n),t.child;case 8:case 12:return Tr(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,s=t.memoizedProps,an(0,i,a=r.value),null!==s)if(zt(s.value,a)){if(s.children===r.children&&!ut.current){t=rs(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){a=s.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===s.tag){(c=pn(-1,n&-n)).tag=2;var g=s.updateQueue;if(null!==g){var u=(g=g.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),g.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),cn(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)a=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(a=s.return))throw Error(o(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),cn(a,n,t),a=s.sibling}else a=s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===t){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}Tr(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,gn(t,n),i=i(r=un(r)),t.flags|=1,Tr(e,t,i,n),t.child;case 14:return r=en(i=t.type,t.pendingProps),Lr(e,t,i,r=en(i.type,r),n);case 15:return Hr(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:en(i,r),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,ht(i)?(e=!0,mt(t)):e=!1,gn(t,n),En(t,i,r),Sn(t,i,r,n),zr(null,t,i,!0,e,n);case 19:return is(e,t,n);case 22:return Qr(e,t,n)}throw Error(o(156,t.tag))},t.attemptContinuousHydration=function(e){13===e.tag&&(vo(e,134217728,bo()),ua(e,134217728))},t.attemptHydrationAtCurrentPriority=function(e){if(13===e.tag){var t=bo(),n=Bo(e);vo(e,n,t),ua(e,n)}},t.attemptSynchronousHydration=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Gt(t.pendingLanes);0!==n&&(Dt(t,1|n),Go(t,Vt()),0===(6&Us)&&(lo(),Jt()))}break;case 13:var i=bo();Do((function(){return vo(e,1,i)})),ua(e,1)}},t.batchedUpdates=function(e,t){var n=Us;Us|=1;try{return e(t)}finally{0===(Us=n)&&(lo(),Ut&&Jt())}},t.createComponentSelector=function(e){return{$$typeof:Fs,value:e}},t.createContainer=function(e,t,n,i,r,s,o){return aa(e,t,!1,null,0,i,0,s,o)},t.createHasPseudoClassSelector=function(e){return{$$typeof:Ns,value:e}},t.createHydrationContainer=function(e,t,n,i,r,s,o,a,l){return(e=aa(n,i,!0,e,0,s,0,a,l)).context=la(null),n=e.current,(s=pn(i=bo(),r=Bo(n))).callback=void 0!==t&&null!==t?t:null,Cn(n,s),e.current.lanes=r,Zt(e,r,i),Go(e,i),e},t.createPortal=function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:c,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}},t.createRoleSelector=function(e){return{$$typeof:Ms,value:e}},t.createTestNameSelector=function(e){return{$$typeof:Ws,value:e}},t.createTextSelector=function(e){return{$$typeof:ks,value:e}},t.deferredUpdates=function(e){var t=Ft,n=Ps.transition;try{return Ps.transition=null,Ft=16,e()}finally{Ft=t,Ps.transition=n}},t.discreteUpdates=function(e,t,n,i,r){var s=Ft,o=Ps.transition;try{return Ps.transition=null,Ft=1,e(t,n,i,r)}finally{Ft=s,Ps.transition=o,0===Us&&lo()}},t.findAllNodes=Ks,t.findBoundingRects=function(e,t){if(!ie)throw Error(o(363));t=Ks(e,t),e=[];for(var n=0;n<t.length;n++)e.push(se(t[n]));for(t=e.length-1;0<t;t--)for(var i=(n=e[t]).x,r=i+n.width,s=n.y,a=s+n.height,l=t-1;0<=l;l--)if(t!==l){var c=e[l],g=c.x,u=g+c.width,A=c.y,d=A+c.height;if(i>=g&&s>=A&&r<=u&&a<=d){e.splice(t,1);break}if(!(i!==g||n.width!==c.width||d<s||A>a)){A>s&&(c.height+=A-s,c.y=s),d<a&&(c.height=a-A),e.splice(t,1);break}if(!(s!==A||n.height!==c.height||u<i||g>r)){g>i&&(c.width+=g-i,c.x=i),u<r&&(c.width=r-g),e.splice(t,1);break}}return e},t.findHostInstance=ca,t.findHostInstanceWithNoPortals=function(e){return null===(e=null!==(e=x(e))?Z(e):null)?null:e.stateNode},t.findHostInstanceWithWarning=function(e){return ca(e)},t.flushControlled=function(e){var t=Us;Us|=1;var n=Ps.transition,i=Ft;try{Ps.transition=null,Ft=1,e()}finally{Ft=i,Ps.transition=n,0===(Us=t)&&(lo(),Jt())}},t.flushPassiveEffects=Xo,t.flushSync=Do,t.focusWithin=function(e,t){if(!ie)throw Error(o(363));for(t=Qs(e=Vs(e),t),t=Array.from(t),e=0;e<t.length;){var n=t[e++];if(!ae(n)){if(5===n.tag&&ce(n.stateNode))return!0;for(n=n.child;null!==n;)t.push(n),n=n.sibling}}return!1},t.getCurrentUpdatePriority=function(){return Ft},t.getFindAllNodesFailureDescription=function(e,t){if(!ie)throw Error(o(363));var n=0,i=[];e=[Vs(e),0];for(var r=0;r<e.length;){var s=e[r++],a=e[r++],l=t[a];if((5!==s.tag||!ae(s))&&(Ls(s,l)&&(i.push(Hs(l)),++a>n&&(n=a)),a<t.length))for(s=s.child;null!==s;)e.push(s,a),s=s.sibling}if(n<t.length){for(e=[];n<t.length;n++)e.push(Hs(t[n]));return"findAllNodes was able to match part of the selector:\n  "+i.join(" > ")+"\n\nNo matching component was found for:\n  "+e.join(" > ")}return null},t.getPublicRootInstance=function(e){return(e=e.current).child?5===e.child.tag?N(e.child.stateNode):e.child.stateNode:null},t.injectIntoDevTools=function(e){if(e={bundleType:e.bundleType,version:e.version,rendererPackageName:e.rendererPackageName,rendererConfig:e.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:Aa,findFiberByHostInstance:e.findFiberByHostInstance||da,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},"undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)e=!1;else{var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)e=!0;else{try{Xt=t.inject(e),Yt=t}catch(n){}e=!!t.checkDCE}}return e},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(e,t,n,i){if(!ie)throw Error(o(363));e=Ks(e,t);var r=ge(e,n,i).disconnect;return{disconnect:function(){r()}}},t.registerMutableSourceForHydration=function(e,t){var n=t._getVersion;n=n(t._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n)},t.runWithPriority=function(e,t){var n=Ft;try{return Ft=e,t()}finally{Ft=n}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(e,t,n,i){var r=t.current,s=bo(),o=Bo(r);return n=la(n),null===t.context?t.context=n:t.pendingContext=n,(t=pn(s,o)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),Cn(r,t),null!==(e=vo(r,o,s))&&mn(e,r,o),o},t}},205:(e,t,n)=>{"use strict";e.exports=n(302)},16:(e,t,n)=>{"use strict";e.exports=n(958)},153:(e,t,n)=>{"use strict";var i=n(43),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var i,s={},c=null,g=null;for(i in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(g=t.ref),t)o.call(t,i)&&!l.hasOwnProperty(i)&&(s[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===s[i]&&(s[i]=t[i]);return{$$typeof:r,type:e,key:c,ref:g,props:s,_owner:a.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),d=Symbol.iterator;var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,p={};function C(e,t,n){this.props=e,this.context=t,this.refs=p,this.updater=n||h}function m(){}function f(e,t,n){this.props=e,this.context=t,this.refs=p,this.updater=n||h}C.prototype.isReactComponent={},C.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},C.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},m.prototype=C.prototype;var y=f.prototype=new m;y.constructor=f,I(y,C.prototype),y.isPureReactComponent=!0;var b=Array.isArray,B=Object.prototype.hasOwnProperty,v={current:null},w={key:!0,ref:!0,__self:!0,__source:!0};function G(e,t,i){var r,s={},o=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)B.call(t,r)&&!w.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(1===l)s.children=i;else if(1<l){for(var c=Array(l),g=0;g<l;g++)c[g]=arguments[g+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===s[r]&&(s[r]=l[r]);return{$$typeof:n,type:e,key:o,ref:a,props:s,_owner:v.current}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var x=/\/+/g;function S(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function R(e,t,r,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case i:l=!0}}if(l)return o=o(l=e),e=""===s?"."+S(l,0):s,b(o)?(r="",null!=e&&(r=e.replace(x,"$&/")+"/"),R(o,t,r,"",(function(e){return e}))):null!=o&&(E(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,r+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(x,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",b(e))for(var c=0;c<e.length;c++){var g=s+S(a=e[c],c);l+=R(a,t,r,g,o)}else if(g=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e),"function"===typeof g)for(e=g.call(e),c=0;!(a=e.next()).done;)l+=R(a=a.value,t,r,g=s+S(a,c++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function Z(e,t,n){if(null==e)return e;var i=[],r=0;return R(e,i,"","",(function(e){return t.call(n,e,r++)})),i}function D(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var F={current:null},N={transition:null},M={ReactCurrentDispatcher:F,ReactCurrentBatchConfig:N,ReactCurrentOwner:v};function W(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:Z,forEach:function(e,t,n){Z(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return Z(e,(function(){t++})),t},toArray:function(e){return Z(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=C,t.Fragment=r,t.Profiler=o,t.PureComponent=f,t.StrictMode=s,t.Suspense=g,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,t.act=W,t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=I({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=v.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)B.call(t,c)&&!w.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=i;else if(1<c){l=Array(c);for(var g=0;g<c;g++)l[g]=arguments[g+2];r.children=l}return{$$typeof:n,type:e.type,key:s,ref:o,props:r,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=G,t.createFactory=function(e){var t=G.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:A,_payload:{_status:-1,_result:e},_init:D}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=N.transition;N.transition={};try{e()}finally{N.transition=t}},t.unstable_act=W,t.useCallback=function(e,t){return F.current.useCallback(e,t)},t.useContext=function(e){return F.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return F.current.useDeferredValue(e)},t.useEffect=function(e,t){return F.current.useEffect(e,t)},t.useId=function(){return F.current.useId()},t.useImperativeHandle=function(e,t,n){return F.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return F.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return F.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return F.current.useMemo(e,t)},t.useReducer=function(e,t,n){return F.current.useReducer(e,t,n)},t.useRef=function(e){return F.current.useRef(e)},t.useState=function(e){return F.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return F.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return F.current.useTransition()},t.version="18.3.1"},43:(e,t,n)=>{"use strict";e.exports=n(202)},579:(e,t,n)=>{"use strict";e.exports=n(153)},234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<s(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,o=r>>>1;i<o;){var a=2*(i+1)-1,l=e[a],c=a+1,g=e[c];if(0>s(l,n))c<r&&0>s(g,l)?(e[i]=g,e[c]=n,i=c):(e[i]=l,e[a]=n,i=a);else{if(!(c<r&&0>s(g,n)))break e;e[i]=g,e[c]=n,i=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],g=[],u=1,A=null,d=3,h=!1,I=!1,p=!1,C="function"===typeof setTimeout?setTimeout:null,m="function"===typeof clearTimeout?clearTimeout:null,f="undefined"!==typeof setImmediate?setImmediate:null;function y(e){for(var t=i(g);null!==t;){if(null===t.callback)r(g);else{if(!(t.startTime<=e))break;r(g),t.sortIndex=t.expirationTime,n(c,t)}t=i(g)}}function b(e){if(p=!1,y(e),!I)if(null!==i(c))I=!0,N(B);else{var t=i(g);null!==t&&M(b,t.startTime-e)}}function B(e,n){I=!1,p&&(p=!1,m(E),E=-1),h=!0;var s=d;try{for(y(n),A=i(c);null!==A&&(!(A.expirationTime>n)||e&&!R());){var o=A.callback;if("function"===typeof o){A.callback=null,d=A.priorityLevel;var a=o(A.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?A.callback=a:A===i(c)&&r(c),y(n)}else r(c);A=i(c)}if(null!==A)var l=!0;else{var u=i(g);null!==u&&M(b,u.startTime-n),l=!1}return l}finally{A=null,d=s,h=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var v,w=!1,G=null,E=-1,x=5,S=-1;function R(){return!(t.unstable_now()-S<x)}function Z(){if(null!==G){var e=t.unstable_now();S=e;var n=!0;try{n=G(!0,e)}finally{n?v():(w=!1,G=null)}}else w=!1}if("function"===typeof f)v=function(){f(Z)};else if("undefined"!==typeof MessageChannel){var D=new MessageChannel,F=D.port2;D.port1.onmessage=Z,v=function(){F.postMessage(null)}}else v=function(){C(Z,0)};function N(e){G=e,w||(w=!0,v())}function M(e,n){E=C((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){I||h||(I=!0,N(B))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var n=d;d=t;try{return e()}finally{d=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=d;d=e;try{return t()}finally{d=n}},t.unstable_scheduleCallback=function(e,r,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:u++,callback:r,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(g,e),null===i(c)&&e===i(g)&&(p?(m(E),E=-1):p=!0,M(b,s-o))):(e.sortIndex=a,n(c,e),I||h||(I=!0,N(B))),e},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(e){var t=d;return function(){var n=d;d=t;try{return e.apply(this,arguments)}finally{d=n}}}},853:(e,t,n)=>{"use strict";e.exports=n(234)},956:(e,t,n)=>{"use strict";var i=n(43);var r="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},s=i.useState,o=i.useEffect,a=i.useLayoutEffect,l=i.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!r(e,n)}catch(i){return!0}}var g="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),i=s({inst:{value:n,getSnapshot:t}}),r=i[0].inst,g=i[1];return a((function(){r.value=n,r.getSnapshot=t,c(r)&&g({inst:r})}),[e,n,t]),o((function(){return c(r)&&g({inst:r}),e((function(){c(r)&&g({inst:r})}))}),[e]),l(n),n};t.useSyncExternalStore=void 0!==i.useSyncExternalStore?i.useSyncExternalStore:g},39:(e,t,n)=>{"use strict";var i=n(43),r=n(461);var s="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},o=r.useSyncExternalStore,a=i.useRef,l=i.useEffect,c=i.useMemo,g=i.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,i,r){var u=a(null);if(null===u.current){var A={hasValue:!1,value:null};u.current=A}else A=u.current;u=c((function(){function e(e){if(!l){if(l=!0,o=e,e=i(e),void 0!==r&&A.hasValue){var t=A.value;if(r(t,e))return a=t}return a=e}if(t=a,s(o,e))return t;var n=i(e);return void 0!==r&&r(t,n)?t:(o=e,a=n)}var o,a,l=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]}),[t,n,i,r]);var d=o(e,u[0],u[1]);return l((function(){A.hasValue=!0,A.value=d}),[d]),g(d),d}},461:(e,t,n)=>{"use strict";e.exports=n(956)},443:(e,t,n)=>{"use strict";e.exports=n(39)},693:(e,t,n)=>{var i=n(736);e.exports=function(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},166:e=>{e.exports=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))},e.exports.__esModule=!0,e.exports.default=e.exports},45:(e,t,n)=>{var i=n(738).default;e.exports=function(e,t){if("object"!=i(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},736:(e,t,n)=>{var i=n(738).default,r=n(45);e.exports=function(e){var t=r(e,"string");return"symbol"==i(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},738:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={};n.r(e),n.d(e,{ACESFilmicToneMapping:()=>je,AddEquation:()=>pe,AddOperation:()=>Pe,AdditiveAnimationBlendMode:()=>Fn,AdditiveBlending:()=>Ae,AgXToneMapping:()=>$e,AlphaFormat:()=>Ft,AlwaysCompare:()=>yi,AlwaysDepth:()=>Te,AlwaysStencilFunc:()=>Ai,AmbientLight:()=>th,AnimationAction:()=>Yh,AnimationClip:()=>Gd,AnimationLoader:()=>Md,AnimationMixer:()=>Ph,AnimationObjectGroup:()=>Xh,AnimationUtils:()=>Ad,ArcCurve:()=>Zu,ArrayCamera:()=>Tc,ArrowHelper:()=>TI,AttachedBindMode:()=>et,Audio:()=>Sh,AudioAnalyser:()=>Mh,AudioContext:()=>Ih,AudioListener:()=>xh,AudioLoader:()=>ph,AxesHelper:()=>VI,BackSide:()=>ae,BasicDepthPacking:()=>Vn,BasicShadowMap:()=>ne,BatchedMesh:()=>iu,Bone:()=>xg,BooleanKeyframeTrack:()=>md,Box2:()=>rI,Box3:()=>Dr,Box3Helper:()=>FI,BoxGeometry:()=>Xo,BoxHelper:()=>DI,BufferAttribute:()=>ro,BufferGeometry:()=>vo,BufferGeometryLoader:()=>lh,ByteType:()=>Bt,Cache:()=>xd,Camera:()=>Oo,CameraHelper:()=>SI,CanvasTexture:()=>xu,CapsuleGeometry:()=>ju,CatmullRomCurve3:()=>ku,CineonToneMapping:()=>Je,CircleGeometry:()=>qu,ClampToEdgeWrapping:()=>ct,Clock:()=>bh,Color:()=>Ps,ColorKeyframeTrack:()=>fd,ColorManagement:()=>cr,CompressedArrayTexture:()=>Gu,CompressedCubeTexture:()=>Eu,CompressedTexture:()=>wu,CompressedTextureLoader:()=>Wd,ConeGeometry:()=>eA,ConstantAlphaFactor:()=>Me,ConstantColorFactor:()=>Fe,CubeCamera:()=>qo,CubeReflectionMapping:()=>it,CubeRefractionMapping:()=>rt,CubeTexture:()=>$o,CubeTextureLoader:()=>Td,CubeUVReflectionMapping:()=>at,CubicBezierCurve:()=>Hu,CubicBezierCurve3:()=>Qu,CubicInterpolant:()=>hd,CullFaceBack:()=>$,CullFaceFront:()=>ee,CullFaceFrontBack:()=>te,CullFaceNone:()=>q,Curve:()=>Su,CurvePath:()=>_u,CustomBlending:()=>Ie,CustomToneMapping:()=>qe,CylinderGeometry:()=>$u,Cylindrical:()=>nI,Data3DTexture:()=>wr,DataArrayTexture:()=>Br,DataTexture:()=>Sg,DataTextureLoader:()=>Vd,DataUtils:()=>to,DecrementStencilOp:()=>ti,DecrementWrapStencilOp:()=>ii,DefaultLoadingManager:()=>Rd,DepthFormat:()=>kt,DepthStencilFormat:()=>Tt,DepthTexture:()=>Pa,DetachedBindMode:()=>tt,DirectionalLight:()=>eh,DirectionalLightHelper:()=>GI,DiscreteInterpolant:()=>pd,DisplayP3ColorSpace:()=>zn,DodecahedronGeometry:()=>nA,DoubleSide:()=>le,DstAlphaFactor:()=>xe,DstColorFactor:()=>Re,DynamicCopyUsage:()=>Si,DynamicDrawUsage:()=>Bi,DynamicReadUsage:()=>Gi,EdgesGeometry:()=>aA,EllipseCurve:()=>Ru,EqualCompare:()=>Ii,EqualDepth:()=>He,EqualStencilFunc:()=>ai,EquirectangularReflectionMapping:()=>st,EquirectangularRefractionMapping:()=>ot,Euler:()=>hs,EventDispatcher:()=>Wi,ExtrudeGeometry:()=>TA,FileLoader:()=>Nd,Float16BufferAttribute:()=>Ao,Float32BufferAttribute:()=>ho,Float64BufferAttribute:()=>Io,FloatType:()=>xt,Fog:()=>Uc,FogExp2:()=>Pc,FramebufferTexture:()=>vu,FrontSide:()=>oe,Frustum:()=>aa,GLBufferAttribute:()=>jh,GLSL1:()=>Zi,GLSL3:()=>Di,GreaterCompare:()=>Ci,GreaterDepth:()=>Ke,GreaterEqualCompare:()=>fi,GreaterEqualDepth:()=>Qe,GreaterEqualStencilFunc:()=>ui,GreaterStencilFunc:()=>ci,GridHelper:()=>yI,Group:()=>Vc,HalfFloatType:()=>St,HemisphereLight:()=>Qd,HemisphereLightHelper:()=>fI,IcosahedronGeometry:()=>LA,ImageBitmapLoader:()=>dh,ImageLoader:()=>kd,ImageUtils:()=>dr,IncrementStencilOp:()=>ei,IncrementWrapStencilOp:()=>ni,InstancedBufferAttribute:()=>Fg,InstancedBufferGeometry:()=>ah,InstancedInterleavedBuffer:()=>Jh,InstancedMesh:()=>Hg,Int16BufferAttribute:()=>lo,Int32BufferAttribute:()=>go,Int8BufferAttribute:()=>so,IntType:()=>Gt,InterleavedBuffer:()=>Oc,InterleavedBufferAttribute:()=>jc,Interpolant:()=>dd,InterpolateDiscrete:()=>Gn,InterpolateLinear:()=>En,InterpolateSmooth:()=>xn,InvertStencilOp:()=>ri,KeepStencilOp:()=>qn,KeyframeTrack:()=>Cd,LOD:()=>pg,LatheGeometry:()=>Ju,Layers:()=>Is,LessCompare:()=>hi,LessDepth:()=>Ve,LessEqualCompare:()=>pi,LessEqualDepth:()=>Le,LessEqualStencilFunc:()=>li,LessStencilFunc:()=>oi,Light:()=>Hd,LightProbe:()=>rh,Line:()=>gu,Line3:()=>aI,LineBasicMaterial:()=>ru,LineCurve:()=>Ku,LineCurve3:()=>Xu,LineDashedMaterial:()=>od,LineLoop:()=>hu,LineSegments:()=>du,LinearDisplayP3ColorSpace:()=>Pn,LinearEncoding:()=>kn,LinearFilter:()=>pt,LinearInterpolant:()=>Id,LinearMipMapLinearFilter:()=>yt,LinearMipMapNearestFilter:()=>mt,LinearMipmapLinearFilter:()=>ft,LinearMipmapNearestFilter:()=>Ct,LinearSRGBColorSpace:()=>Yn,LinearToneMapping:()=>_e,LinearTransfer:()=>Un,Loader:()=>Zd,LoaderUtils:()=>oh,LoadingManager:()=>Sd,LoopOnce:()=>Bn,LoopPingPong:()=>wn,LoopRepeat:()=>vn,LuminanceAlphaFormat:()=>Wt,LuminanceFormat:()=>Mt,MOUSE:()=>J,Material:()=>Os,MaterialLoader:()=>sh,MathUtils:()=>_i,Matrix3:()=>Ji,Matrix4:()=>rs,MaxEquation:()=>ye,Mesh:()=>Qo,MeshBasicMaterial:()=>Js,MeshDepthMaterial:()=>Dc,MeshDistanceMaterial:()=>Fc,MeshLambertMaterial:()=>rd,MeshMatcapMaterial:()=>sd,MeshNormalMaterial:()=>id,MeshPhongMaterial:()=>td,MeshPhysicalMaterial:()=>ed,MeshStandardMaterial:()=>$A,MeshToonMaterial:()=>nd,MinEquation:()=>fe,MirroredRepeatWrapping:()=>gt,MixOperation:()=>ze,MultiplyBlending:()=>he,MultiplyOperation:()=>Ye,NearestFilter:()=>ut,NearestMipMapLinearFilter:()=>It,NearestMipMapNearestFilter:()=>dt,NearestMipmapLinearFilter:()=>ht,NearestMipmapNearestFilter:()=>At,NeverCompare:()=>di,NeverDepth:()=>ke,NeverStencilFunc:()=>si,NoBlending:()=>ge,NoColorSpace:()=>Kn,NoToneMapping:()=>Ue,NormalAnimationBlendMode:()=>Dn,NormalBlending:()=>ue,NotEqualCompare:()=>mi,NotEqualDepth:()=>Xe,NotEqualStencilFunc:()=>gi,NumberKeyframeTrack:()=>yd,Object3D:()=>Rs,ObjectLoader:()=>ch,ObjectSpaceNormalMap:()=>Qn,OctahedronGeometry:()=>HA,OneFactor:()=>Be,OneMinusConstantAlphaFactor:()=>We,OneMinusConstantColorFactor:()=>Ne,OneMinusDstAlphaFactor:()=>Se,OneMinusDstColorFactor:()=>Ze,OneMinusSrcAlphaFactor:()=>Ee,OneMinusSrcColorFactor:()=>we,OrthographicCamera:()=>ba,P3Primaries:()=>Jn,PCFShadowMap:()=>ie,PCFSoftShadowMap:()=>re,PMREMGenerator:()=>Fa,Path:()=>Ou,PerspectiveCamera:()=>Jo,Plane:()=>ra,PlaneGeometry:()=>ga,PlaneHelper:()=>NI,PointLight:()=>qd,PointLightHelper:()=>II,Points:()=>yu,PointsMaterial:()=>Iu,PolarGridHelper:()=>bI,PolyhedronGeometry:()=>tA,PositionalAudio:()=>Nh,PropertyBinding:()=>Kh,PropertyMixer:()=>Wh,QuadraticBezierCurve:()=>Yu,QuadraticBezierCurve3:()=>zu,Quaternion:()=>xr,QuaternionKeyframeTrack:()=>Bd,QuaternionLinearInterpolant:()=>bd,RED_GREEN_RGTC2_Format:()=>yn,RED_RGTC1_Format:()=>mn,REVISION:()=>O,RGBADepthPacking:()=>Ln,RGBAFormat:()=>Nt,RGBAIntegerFormat:()=>Kt,RGBA_ASTC_10x10_Format:()=>An,RGBA_ASTC_10x5_Format:()=>cn,RGBA_ASTC_10x6_Format:()=>gn,RGBA_ASTC_10x8_Format:()=>un,RGBA_ASTC_12x10_Format:()=>dn,RGBA_ASTC_12x12_Format:()=>hn,RGBA_ASTC_4x4_Format:()=>en,RGBA_ASTC_5x4_Format:()=>tn,RGBA_ASTC_5x5_Format:()=>nn,RGBA_ASTC_6x5_Format:()=>rn,RGBA_ASTC_6x6_Format:()=>sn,RGBA_ASTC_8x5_Format:()=>on,RGBA_ASTC_8x6_Format:()=>an,RGBA_ASTC_8x8_Format:()=>ln,RGBA_BPTC_Format:()=>In,RGBA_ETC2_EAC_Format:()=>$t,RGBA_PVRTC_2BPPV1_Format:()=>Jt,RGBA_PVRTC_4BPPV1_Format:()=>Ot,RGBA_S3TC_DXT1_Format:()=>Yt,RGBA_S3TC_DXT3_Format:()=>zt,RGBA_S3TC_DXT5_Format:()=>Pt,RGB_BPTC_SIGNED_Format:()=>pn,RGB_BPTC_UNSIGNED_Format:()=>Cn,RGB_ETC1_Format:()=>jt,RGB_ETC2_Format:()=>qt,RGB_PVRTC_2BPPV1_Format:()=>_t,RGB_PVRTC_4BPPV1_Format:()=>Ut,RGB_S3TC_DXT1_Format:()=>Xt,RGFormat:()=>Ht,RGIntegerFormat:()=>Qt,RawShaderMaterial:()=>qA,Ray:()=>is,Raycaster:()=>qh,Rec709Primaries:()=>On,RectAreaLight:()=>nh,RedFormat:()=>Vt,RedIntegerFormat:()=>Lt,ReinhardToneMapping:()=>Oe,RenderTarget:()=>yr,RepeatWrapping:()=>lt,ReplaceStencilOp:()=>$n,ReverseSubtractEquation:()=>me,RingGeometry:()=>QA,SIGNED_RED_GREEN_RGTC2_Format:()=>bn,SIGNED_RED_RGTC1_Format:()=>fn,SRGBColorSpace:()=>Xn,SRGBTransfer:()=>_n,Scene:()=>_c,ShaderChunk:()=>ua,ShaderLib:()=>da,ShaderMaterial:()=>_o,ShadowMaterial:()=>jA,Shape:()=>lA,ShapeGeometry:()=>KA,ShapePath:()=>LI,ShapeUtils:()=>MA,ShortType:()=>vt,Skeleton:()=>Dg,SkeletonHelper:()=>dI,SkinnedMesh:()=>Eg,Source:()=>Ir,Sphere:()=>Or,SphereGeometry:()=>XA,Spherical:()=>tI,SphericalHarmonics3:()=>ih,SplineCurve:()=>Pu,SpotLight:()=>Ud,SpotLightHelper:()=>cI,Sprite:()=>Ag,SpriteMaterial:()=>qc,SrcAlphaFactor:()=>Ge,SrcAlphaSaturateFactor:()=>De,SrcColorFactor:()=>ve,StaticCopyUsage:()=>xi,StaticDrawUsage:()=>bi,StaticReadUsage:()=>wi,StereoCamera:()=>yh,StreamCopyUsage:()=>Ri,StreamDrawUsage:()=>vi,StreamReadUsage:()=>Ei,StringKeyframeTrack:()=>vd,SubtractEquation:()=>Ce,SubtractiveBlending:()=>de,TOUCH:()=>j,TangentSpaceNormalMap:()=>Hn,TetrahedronGeometry:()=>YA,Texture:()=>mr,TextureLoader:()=>Ld,TorusGeometry:()=>zA,TorusKnotGeometry:()=>PA,Triangle:()=>Qs,TriangleFanDrawMode:()=>Wn,TriangleStripDrawMode:()=>Mn,TrianglesDrawMode:()=>Nn,TubeGeometry:()=>UA,TwoPassDoubleSide:()=>ce,UVMapping:()=>nt,Uint16BufferAttribute:()=>co,Uint32BufferAttribute:()=>uo,Uint8BufferAttribute:()=>oo,Uint8ClampedBufferAttribute:()=>ao,Uniform:()=>Uh,UniformsGroup:()=>Oh,UniformsLib:()=>Aa,UniformsUtils:()=>Uo,UnsignedByteType:()=>bt,UnsignedInt248Type:()=>Dt,UnsignedIntType:()=>Et,UnsignedShort4444Type:()=>Rt,UnsignedShort5551Type:()=>Zt,UnsignedShortType:()=>wt,VSMShadowMap:()=>se,Vector2:()=>Oi,Vector3:()=>Sr,Vector4:()=>fr,VectorKeyframeTrack:()=>wd,VideoTexture:()=>Bu,WebGL1Renderer:()=>zc,WebGL3DRenderTarget:()=>Gr,WebGLArrayRenderTarget:()=>vr,WebGLCoordinateSystem:()=>Ni,WebGLCubeRenderTarget:()=>ea,WebGLMultipleRenderTargets:()=>Er,WebGLRenderTarget:()=>br,WebGLRenderer:()=>Yc,WebGLUtils:()=>kc,WebGPUCoordinateSystem:()=>Mi,WireframeGeometry:()=>_A,WrapAroundEnding:()=>Zn,ZeroCurvatureEnding:()=>Sn,ZeroFactor:()=>be,ZeroSlopeEnding:()=>Rn,ZeroStencilOp:()=>jn,_SRGBAFormat:()=>Fi,createCanvasElement:()=>nr,sRGBEncoding:()=>Tn});var t=n(43),i=n(391);const r=e=>{let t;const n=new Set,i=(e,i)=>{const r="function"===typeof e?e(t):e;if(!Object.is(r,t)){const e=t;t=(null!=i?i:"object"!==typeof r||null===r)?r:Object.assign({},t,r),n.forEach((n=>n(t,e)))}},r=()=>t,s={setState:i,getState:r,getInitialState:()=>o,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},o=t=e(i,r,s);return s},s=e=>e?r(e):r;var o=n(443);const{useDebugValue:a}=t,{useSyncExternalStoreWithSelector:l}=o;let c=!1;const g=e=>e;function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g,n=arguments.length>2?arguments[2]:void 0;n&&!c&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),c=!0);const i=l(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return a(i),i}const A=e=>{"function"!==typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t="function"===typeof e?s(e):e,n=(e,n)=>u(t,e,n);return Object.assign(n,t),n},d=e=>e?A(e):A;const h=d((e=>({appId:1,xrmode:!1,displayVideoplayer:!0,setAppId:t=>e({appId:t}),setXrmode:t=>e({xrmode:t}),setDisplayVideoPlayer:t=>e({displayVideoplayer:t})})));var I=n(579);function p(){const e=h((e=>e.setAppId));return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("h1",{children:"Bienvenidos a Sepinaco World"}),(0,I.jsx)("button",{onClick:()=>e(1),style:{width:"10rem",height:"10rem",backgroundColor:"red"},children:"Rollercoaster"}),(0,I.jsx)("button",{onClick:()=>e(2),style:{width:"10rem",height:"10rem",backgroundColor:"red"},children:"App 2"})]})}const C="https://sepinaco.com:3000",m="https://video-dl-esp.herokuapp.com/video/video?url=";const f=class{constructor(e,t){this.set=e,this.get=t,this.videos=[],this.selectedVideo=null,this.resolution={width:640,height:360},this.originalResolution={width:640,height:360},this.resolutions=[{width:640,height:360},{width:220,height:140},{width:800,height:800}]}async fetchVideos(){try{const e=await fetch("".concat(C,"/media-list"));if(!e.ok)throw new Error("Error al obtener la lista de recursos.");const t=await e.json();this.set({videos:t.mediaFiles.map((e=>({name:e,url:e}))).sort(((e,t)=>e.name.localeCompare(t.name)))})}catch(HY){console.error(HY)}}selectVideo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const{selectedVideo:n}=this.get();(null===n||void 0===n?void 0:n.url)!==(null===e||void 0===e?void 0:e.url)&&(this.set({selectedVideo:e}),this.handleVideoSelection(e.url,t))}setResolution(e){this.set({resolution:e})}handleVideoSelection(e,t){if(0===t)this.playLocalVideo(e);else if(1===t){const t=this.convertUrlToMyServer(e);this.playLocalVideo(t)}else this.playLocalVideo(e)}convertUrlToMyServer(e){const t=C,n=this.replaceSpacesWithPercent20(e),i=this.replaceHashSymbol(n);return"".concat(t,"/media/").concat(i)}replaceSpacesWithPercent20(e){return e.replace(/ /g,"%20")}replaceHashSymbol(e){return e.replace("#","%23")}playLocalVideo(e){const t=document.getElementById("video");t.src=e,t.play();const n=setInterval((()=>{0!==t.videoWidth&&0!==t.videoHeight&&(this.set({originalResolution:{width:t.videoWidth,height:t.videoHeight}}),clearInterval(n))}),500)}async fetchAndPlayYoutubeVideo(e){const t=document.getElementById("loading");t.style.display="block";try{const n=await fetch("".concat(m).concat(e)),i=await n.blob(),r=URL.createObjectURL(i),s=document.getElementById("video");s.src=r,s.play(),t.style.display="none"}catch(HY){console.error("Error al cargar el video:",HY)}}},y=d(((e,t)=>{const n=new f(e,t);return{videos:n.videos,selectedVideo:n.selectedVideo,resolution:n.resolution,originalResolution:n.originalResolution,resolutions:n.resolutions,fetchVideos:n.fetchVideos.bind(n),selectVideo:n.selectVideo.bind(n),setResolution:n.setResolution.bind(n)}})),b=e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase();function B(e){let{showUI:n=!0}=e;const i=y((e=>e.videos)),r=y((e=>e.selectVideo)),s=y((e=>e.fetchVideos));(0,t.useEffect)((()=>{s()}),[s]);const[o,a]=(0,t.useState)(""),[l,c]=(0,t.useState)(i);(0,t.useEffect)((()=>{c((e=>i))}),[i]);(0,t.useEffect)((()=>{""===o&&0===l.length&&c((e=>i))}),[o,l]);const[g,u]=(0,t.useState)(window.innerWidth);(0,t.useEffect)((()=>{const e=()=>u(window.innerWidth);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]);const A={paddingRight:g<768?"1rem":"11rem",textAlign:"right"};return(0,I.jsxs)("div",{style:{width:"100%",display:n?"block":"none",position:"absolute",top:0,color:"#636363"},children:[(0,I.jsx)("div",{style:{minWidth:"100vw",minHeight:"48vh"},children:l.length>0?(0,I.jsx)("ul",{style:{height:"45vh",overflowY:"auto",overflowX:"hidden",paddingRight:"100px",maxWidth:"79%"},children:l.map(((e,t)=>(0,I.jsx)("li",{style:{listStyle:"none"},children:(0,I.jsx)("button",{style:{background:"rgba(163, 163, 163, .1)",color:"#a0b0c0",border:"none",borderRadius:"15px",fontSize:"1.5rem",marginBottom:"0.5rem",padding:"0.2rem 1rem",width:"100%",textAlign:"start",cursor:"pointer"},onClick:()=>r(e),children:e.name})},t)))}):o&&(0,I.jsx)("p",{children:"Not video found."})}),(0,I.jsxs)("div",{style:A,children:[(0,I.jsx)("input",{type:"text",placeholder:"Search videos...",value:o,onChange:e=>{const t=e.target.value;if(a(t),""===t.trim())c([]);else{const e=t.trim().split(/\s+/).map((e=>b(e))),n=i.filter((t=>e.every((e=>b(t.name).includes(e)))));c(n)}},className:"input-search"}),(0,I.jsxs)("h3",{children:[l.length," videos"]})]})]})}const v={name:"Tove Lo - Habits (Stay High)",url:"videos/stayHigh.mp4"};function w(e){let{showUI:n=!0}=e;const i=y((e=>e.selectVideo)),r=y((e=>e.videos));return(0,t.useEffect)((()=>{const e=window.location.href.split("/"),t=e[e.length-1];if(t&&0!==r.length){const e=r.find((e=>b(e.name).includes(t)));e?i(e):i(v,0)}else i(v,0)}),[r]),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(B,{showUI:n}),(0,I.jsx)("video",{id:"video",style:{display:"none"},playsInline:!0,loop:!0,crossOrigin:"anonymous",width:660,height:300,muted:!1})]})}const G=d((e=>({controlsId:3,maxNumControls:4,setControlsId:t=>e({controlsId:t})}))),E=d((e=>({controlsXRId:1,maxNumControlsXR:3,setControlsXRId:t=>e({controlsXRId:t})})));function x(e){let{showButton:t=!0}=e;const n=h((e=>e.xrmode)),i=G((e=>e.controlsId)),r=G((e=>e.setControlsId)),s=G((e=>e.maxNumControls)),o=E((e=>e.controlsXRId)),a=E((e=>e.setControlsXRId)),l=E((e=>e.maxNumControlsXR));return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)("button",{onClick:()=>{if(n){a((o+1)%l)}else{r((i+1)%s)}},style:{display:t?"block":"none",width:"50px",height:"50px",borderRadius:"25px",position:"absolute",top:280,right:0,background:"linear-gradient(90deg, #636363 0%, #000000 100%)",opacity:t?.3:0,cursor:"pointer",color:"white"},children:"Control"})})}function S(e){let{showButton:t=!0}=e;const n=h((e=>e.xrmode)),i=h((e=>e.setXrmode));return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)("button",{onClick:()=>{i(!n)},style:{display:t?"block":"none",width:"50px",height:"50px",borderRadius:"25px",position:"absolute",top:350,right:0,background:"linear-gradient(90deg, #636363 0%, #000000 100%)",opacity:t?.3:0,cursor:"pointer",color:"white"},children:"VR"})})}function R(e){let{showButton:n=!0}=e;const i=y((e=>e.originalResolution)),r=y((e=>e.resolutions)),s=y((e=>e.setResolution)),[o,a]=(0,t.useState)(1),l=(0,t.useCallback)((()=>{o<=r.length-1?s(r[o]):s(i),a((e=>(e+1)%(r.length+1)))}),[i,r,o]);return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)("button",{onClick:l,style:{display:n?"block":"none",width:"50px",height:"50px",borderRadius:"25px",position:"absolute",top:200,right:0,background:"linear-gradient(90deg, #636363 0%, #000000 100%)",opacity:n?.3:0,cursor:"pointer",color:"white"},children:"Resolution video"})})}const Z=d((e=>({sceneId:0,maxNumScenes:2,setSceneId:t=>e({sceneId:t})})));function D(e){let{showButton:t=!0}=e;const n=Z((e=>e.sceneId)),i=Z((e=>e.setSceneId)),r=Z((e=>e.maxNumScenes));return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)("button",{onClick:()=>{i((n+1)%r)},style:{display:t?"block":"none",width:"50px",height:"50px",borderRadius:"25px",position:"absolute",top:100,right:0,background:"linear-gradient(90deg, #636363 0%, #000000 100%)",opacity:t?.3:0,cursor:"pointer",color:"white"},children:"Scene"})})}function F(e){let{showButton:n=!0}=e;const i=(0,t.useCallback)((()=>{window.orbitControls&&(window.orbitControls.autoRotate=!window.orbitControls.autoRotate)}),[]);return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)("button",{onClick:i,style:{display:n?"block":"none",width:"50px",height:"50px",borderRadius:"25px",position:"absolute",bottom:"100px",right:"190px",background:"linear-gradient(90deg, #636363 0%, #000000 100%)",opacity:.5,cursor:"pointer",color:"white"},children:"Rotate"})})}var N={fullscreenEnabled:0,fullscreenElement:1,requestFullscreen:2,exitFullscreen:3,fullscreenchange:4,fullscreenerror:5,fullscreen:6},M=["webkitFullscreenEnabled","webkitFullscreenElement","webkitRequestFullscreen","webkitExitFullscreen","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],W=["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],k=["msFullscreenEnabled","msFullscreenElement","msRequestFullscreen","msExitFullscreen","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"],T="undefined"!==typeof window&&"undefined"!==typeof window.document?window.document:{},V="fullscreenEnabled"in T&&Object.keys(N)||M[0]in T&&M||W[0]in T&&W||k[0]in T&&k||[],L={requestFullscreen:function(e){return e[V[N.requestFullscreen]]()},requestFullscreenFunction:function(e){return e[V[N.requestFullscreen]]},get exitFullscreen(){return T[V[N.exitFullscreen]].bind(T)},get fullscreenPseudoClass(){return":"+V[N.fullscreen]},addEventListener:function(e,t,n){return T.addEventListener(V[N[e]],t,n)},removeEventListener:function(e,t,n){return T.removeEventListener(V[N[e]],t,n)},get fullscreenEnabled(){return Boolean(T[V[N.fullscreenEnabled]])},set fullscreenEnabled(e){},get fullscreenElement(){return T[V[N.fullscreenElement]]},set fullscreenElement(e){},get onfullscreenchange(){return T[("on"+V[N.fullscreenchange]).toLowerCase()]},set onfullscreenchange(e){return T[("on"+V[N.fullscreenchange]).toLowerCase()]=e},get onfullscreenerror(){return T[("on"+V[N.fullscreenerror]).toLowerCase()]},set onfullscreenerror(e){return T[("on"+V[N.fullscreenerror]).toLowerCase()]=e}};const H=L;var Q=function(e){var n=e.handle,i=e.onChange,r=e.children,s=e.className,o=[];return s&&o.push(s),o.push("fullscreen"),n.active&&o.push("fullscreen-enabled"),(0,t.useEffect)((function(){i&&i(n.active,n)}),[n.active]),t.createElement("div",{className:o.join(" "),ref:n.node,style:n.active?{height:"100%",width:"100%"}:void 0},r)};function K(e){let{showButton:n=!0,children:i}=e;const r=function(){var e=(0,t.useState)(!1),n=e[0],i=e[1],r=(0,t.useRef)(null);(0,t.useEffect)((function(){var e=function(){i(H.fullscreenElement===r.current)};return H.addEventListener("fullscreenchange",e),function(){return H.removeEventListener("fullscreenchange",e)}}),[]);var s=(0,t.useCallback)((function(){return H.fullscreenElement?H.exitFullscreen().then((function(){return H.requestFullscreen(r.current)})):r.current?H.requestFullscreen(r.current):void 0}),[]),o=(0,t.useCallback)((function(){return H.fullscreenElement===r.current?H.exitFullscreen():Promise.resolve()}),[]);return(0,t.useMemo)((function(){return{active:n,enter:s,exit:o,node:r}}),[n,s,o])}(),s=(0,t.useCallback)((()=>{r.active?r.exit():r.enter()}),[r]);return(0,I.jsx)(I.Fragment,{children:(0,I.jsxs)(Q,{handle:r,children:[i,(0,I.jsx)("button",{onClick:s,style:{display:n?"block":"none",width:"50px",height:"50px",borderRadius:"25px",position:"absolute",bottom:"100px",right:"100px",background:"linear-gradient(90deg, #636363 0%, #000000 100%)",opacity:.5,cursor:"pointer",color:"white"},children:"Screen"})]})})}const X=1;function Y(e){let{showUI:n=!0}=e;const i=(0,t.useRef)(null);(0,t.useEffect)((()=>{i.current&&(i.current.value=X)}),[i]);const r=(0,t.useCallback)((e=>{window.videoPoints&&window.videoPoints.scale.set(e,e,e)}),[]);return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)("div",{id:"div-input-range-video-point-scale",className:"range",style:{display:n?"block":"none",position:"absolute",left:30,bottom:225,border:"none",borderRadius:"4px"},children:(0,I.jsx)("input",{className:"range1",type:"range",ref:i,onChange:e=>r(e.target.value),min:.1,max:30,step:.1})})})}const z=1.5;function P(e){let{showUI:n=!0}=e;const i=(0,t.useRef)(null);(0,t.useEffect)((()=>{i.current&&(i.current.value=z)}),[i]);const r=(0,t.useCallback)((e=>{window.videoPoints&&(window.videoPoints.material.uniforms.pointSize.value=e)}),[]);return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)("div",{id:"div-input-range-video-point-size",className:"range",style:{display:n?"block":"none",position:"absolute",left:30,bottom:255,border:"none",borderRadius:"4px"},children:(0,I.jsx)("input",{className:"range1",type:"range",ref:i,onChange:e=>r(e.target.value),min:.1,max:30,step:.1})})})}const U=1;function _(e){let{showUI:n=!0}=e;const i=(0,t.useRef)(null);(0,t.useEffect)((()=>{i.current&&(i.current.value=U)}),[i]);const r=(0,t.useCallback)((e=>{window.videoPoints&&(window.videoPoints.material.uniforms.amplitudeDistance.value=e)}),[]);return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)("div",{id:"div-input-range-video-point-amplitude-distance",className:"range",style:{display:n?"block":"none",position:"absolute",left:30,bottom:285,border:"none",borderRadius:"4px"},children:(0,I.jsx)("input",{className:"range1",type:"range",ref:i,onChange:e=>r(e.target.value),min:-9e3,max:9e3,step:1})})})}const O="160",J={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},j={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},q=0,$=1,ee=2,te=3,ne=0,ie=1,re=2,se=3,oe=0,ae=1,le=2,ce=2,ge=0,ue=1,Ae=2,de=3,he=4,Ie=5,pe=100,Ce=101,me=102,fe=103,ye=104,be=200,Be=201,ve=202,we=203,Ge=204,Ee=205,xe=206,Se=207,Re=208,Ze=209,De=210,Fe=211,Ne=212,Me=213,We=214,ke=0,Te=1,Ve=2,Le=3,He=4,Qe=5,Ke=6,Xe=7,Ye=0,ze=1,Pe=2,Ue=0,_e=1,Oe=2,Je=3,je=4,qe=5,$e=6,et="attached",tt="detached",nt=300,it=301,rt=302,st=303,ot=304,at=306,lt=1e3,ct=1001,gt=1002,ut=1003,At=1004,dt=1004,ht=1005,It=1005,pt=1006,Ct=1007,mt=1007,ft=1008,yt=1008,bt=1009,Bt=1010,vt=1011,wt=1012,Gt=1013,Et=1014,xt=1015,St=1016,Rt=1017,Zt=1018,Dt=1020,Ft=1021,Nt=1023,Mt=1024,Wt=1025,kt=1026,Tt=1027,Vt=1028,Lt=1029,Ht=1030,Qt=1031,Kt=1033,Xt=33776,Yt=33777,zt=33778,Pt=33779,Ut=35840,_t=35841,Ot=35842,Jt=35843,jt=36196,qt=37492,$t=37496,en=37808,tn=37809,nn=37810,rn=37811,sn=37812,on=37813,an=37814,ln=37815,cn=37816,gn=37817,un=37818,An=37819,dn=37820,hn=37821,In=36492,pn=36494,Cn=36495,mn=36283,fn=36284,yn=36285,bn=36286,Bn=2200,vn=2201,wn=2202,Gn=2300,En=2301,xn=2302,Sn=2400,Rn=2401,Zn=2402,Dn=2500,Fn=2501,Nn=0,Mn=1,Wn=2,kn=3e3,Tn=3001,Vn=3200,Ln=3201,Hn=0,Qn=1,Kn="",Xn="srgb",Yn="srgb-linear",zn="display-p3",Pn="display-p3-linear",Un="linear",_n="srgb",On="rec709",Jn="p3",jn=0,qn=7680,$n=7681,ei=7682,ti=7683,ni=34055,ii=34056,ri=5386,si=512,oi=513,ai=514,li=515,ci=516,gi=517,ui=518,Ai=519,di=512,hi=513,Ii=514,pi=515,Ci=516,mi=517,fi=518,yi=519,bi=35044,Bi=35048,vi=35040,wi=35045,Gi=35049,Ei=35041,xi=35046,Si=35050,Ri=35042,Zi="100",Di="300 es",Fi=1035,Ni=2e3,Mi=2001;class Wi{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,i=n.length;t<i;t++)n[t].call(this,e);e.target=null}}}const ki=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Ti=1234567;const Vi=Math.PI/180,Li=180/Math.PI;function Hi(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(ki[255&e]+ki[e>>8&255]+ki[e>>16&255]+ki[e>>24&255]+"-"+ki[255&t]+ki[t>>8&255]+"-"+ki[t>>16&15|64]+ki[t>>24&255]+"-"+ki[63&n|128]+ki[n>>8&255]+"-"+ki[n>>16&255]+ki[n>>24&255]+ki[255&i]+ki[i>>8&255]+ki[i>>16&255]+ki[i>>24&255]).toLowerCase()}function Qi(e,t,n){return Math.max(t,Math.min(n,e))}function Ki(e,t){return(e%t+t)%t}function Xi(e,t,n){return(1-n)*e+n*t}function Yi(e){return 0===(e&e-1)&&0!==e}function zi(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function Pi(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function Ui(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}const _i={DEG2RAD:Vi,RAD2DEG:Li,generateUUID:Hi,clamp:Qi,euclideanModulo:Ki,mapLinear:function(e,t,n,i,r){return i+(e-t)*(r-i)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:Xi,damp:function(e,t,n,i){return Xi(e,t,1-Math.exp(-n*i))},pingpong:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(Ki(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(Ti=e);let t=Ti+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*Vi},radToDeg:function(e){return e*Li},isPowerOfTwo:Yi,ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:zi,setQuaternionFromProperEuler:function(e,t,n,i,r){const s=Math.cos,o=Math.sin,a=s(n/2),l=o(n/2),c=s((t+i)/2),g=o((t+i)/2),u=s((t-i)/2),A=o((t-i)/2),d=s((i-t)/2),h=o((i-t)/2);switch(r){case"XYX":e.set(a*g,l*u,l*A,a*c);break;case"YZY":e.set(l*A,a*g,l*u,a*c);break;case"ZXZ":e.set(l*u,l*A,a*g,a*c);break;case"XZX":e.set(a*g,l*h,l*d,a*c);break;case"YXY":e.set(l*d,a*g,l*h,a*c);break;case"ZYZ":e.set(l*h,l*d,a*g,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:Ui,denormalize:Pi};class Oi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Oi.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Qi(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),r=this.x-e.x,s=this.y-e.y;return this.x=r*n-s*i+e.x,this.y=r*i+s*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ji{constructor(e,t,n,i,r,s,o,a,l){Ji.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,n,i,r,s,o,a,l)}set(e,t,n,i,r,s,o,a,l){const c=this.elements;return c[0]=e,c[1]=i,c[2]=o,c[3]=t,c[4]=r,c[5]=a,c[6]=n,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,s=n[0],o=n[3],a=n[6],l=n[1],c=n[4],g=n[7],u=n[2],A=n[5],d=n[8],h=i[0],I=i[3],p=i[6],C=i[1],m=i[4],f=i[7],y=i[2],b=i[5],B=i[8];return r[0]=s*h+o*C+a*y,r[3]=s*I+o*m+a*b,r[6]=s*p+o*f+a*B,r[1]=l*h+c*C+g*y,r[4]=l*I+c*m+g*b,r[7]=l*p+c*f+g*B,r[2]=u*h+A*C+d*y,r[5]=u*I+A*m+d*b,r[8]=u*p+A*f+d*B,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8];return t*s*c-t*o*l-n*r*c+n*o*a+i*r*l-i*s*a}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],g=c*s-o*l,u=o*a-c*r,A=l*r-s*a,d=t*g+n*u+i*A;if(0===d)return this.set(0,0,0,0,0,0,0,0,0);const h=1/d;return e[0]=g*h,e[1]=(i*l-c*n)*h,e[2]=(o*n-i*s)*h,e[3]=u*h,e[4]=(c*t-i*a)*h,e[5]=(i*r-o*t)*h,e[6]=A*h,e[7]=(n*a-l*t)*h,e[8]=(s*t-n*r)*h,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,r,s,o){const a=Math.cos(r),l=Math.sin(r);return this.set(n*a,n*l,-n*(a*s+l*o)+s+e,-i*l,i*a,-i*(-l*s+a*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(ji.makeScale(e,t)),this}rotate(e){return this.premultiply(ji.makeRotation(-e)),this}translate(e,t){return this.premultiply(ji.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const ji=new Ji;function qi(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}const $i={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function er(e,t){return new $i[e](t)}function tr(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function nr(){const e=tr("canvas");return e.style.display="block",e}const ir={};function rr(e){e in ir||(ir[e]=!0,console.warn(e))}const sr=(new Ji).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),or=(new Ji).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),ar={[Yn]:{transfer:Un,primaries:On,toReference:e=>e,fromReference:e=>e},[Xn]:{transfer:_n,primaries:On,toReference:e=>e.convertSRGBToLinear(),fromReference:e=>e.convertLinearToSRGB()},[Pn]:{transfer:Un,primaries:Jn,toReference:e=>e.applyMatrix3(or),fromReference:e=>e.applyMatrix3(sr)},[zn]:{transfer:_n,primaries:Jn,toReference:e=>e.convertSRGBToLinear().applyMatrix3(or),fromReference:e=>e.applyMatrix3(sr).convertLinearToSRGB()}},lr=new Set([Yn,Pn]),cr={enabled:!0,_workingColorSpace:Yn,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(e){if(!lr.has(e))throw new Error('Unsupported working color space, "'.concat(e,'".'));this._workingColorSpace=e},convert:function(e,t,n){if(!1===this.enabled||t===n||!t||!n)return e;const i=ar[t].toReference;return(0,ar[n].fromReference)(i(e))},fromWorkingColorSpace:function(e,t){return this.convert(e,this._workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this._workingColorSpace)},getPrimaries:function(e){return ar[e].primaries},getTransfer:function(e){return e===Kn?Un:ar[e].transfer}};function gr(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function ur(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}let Ar;class dr{static getDataURL(e){if(/^data:/i.test(e.src))return e.src;if("undefined"===typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Ar&&(Ar=tr("canvas")),Ar.width=e.width,Ar.height=e.height;const n=Ar.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Ar}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap){const t=tr("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const i=n.getImageData(0,0,e.width,e.height),r=i.data;for(let e=0;e<r.length;e++)r[e]=255*gr(r[e]/255);return n.putImageData(i,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*gr(t[e]/255)):t[e]=gr(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let hr=0;class Ir{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isSource=!0,Object.defineProperty(this,"id",{value:hr++}),this.uuid=Hi(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(null!==i){let e;if(Array.isArray(i)){e=[];for(let t=0,n=i.length;t<n;t++)i[t].isDataTexture?e.push(pr(i[t].image)):e.push(pr(i[t]))}else e=pr(i);n.url=e}return t||(e.images[this.uuid]=n),n}}function pr(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?dr.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Cr=0;class mr extends Wi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mr.DEFAULT_IMAGE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mr.DEFAULT_MAPPING,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ct,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ct,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:pt,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:ft,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Nt,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:bt,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:mr.DEFAULT_ANISOTROPY,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:Kn;super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Cr++}),this.uuid=Hi(),this.name="",this.source=new Ir(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=a,this.offset=new Oi(0,0),this.repeat=new Oi(1,1),this.center=new Oi(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ji,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"===typeof c?this.colorSpace=c:(rr("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=c===Tn?Xn:Kn),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){void 0===e&&(e=null),this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==nt)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case lt:e.x=e.x-Math.floor(e.x);break;case ct:e.x=e.x<0?0:1;break;case gt:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case lt:e.y=e.y-Math.floor(e.y);break;case ct:e.y=e.y<0?0:1;break;case gt:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return rr("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Xn?Tn:kn}set encoding(e){rr("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===Tn?Xn:Kn}}mr.DEFAULT_IMAGE=null,mr.DEFAULT_MAPPING=nt,mr.DEFAULT_ANISOTROPY=1;class fr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;fr.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=this.w,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*i+s[12]*r,this.y=s[1]*t+s[5]*n+s[9]*i+s[13]*r,this.z=s[2]*t+s[6]*n+s[10]*i+s[14]*r,this.w=s[3]*t+s[7]*n+s[11]*i+s[15]*r,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,r;const s=.01,o=.1,a=e.elements,l=a[0],c=a[4],g=a[8],u=a[1],A=a[5],d=a[9],h=a[2],I=a[6],p=a[10];if(Math.abs(c-u)<s&&Math.abs(g-h)<s&&Math.abs(d-I)<s){if(Math.abs(c+u)<o&&Math.abs(g+h)<o&&Math.abs(d+I)<o&&Math.abs(l+A+p-3)<o)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,a=(A+1)/2,C=(p+1)/2,m=(c+u)/4,f=(g+h)/4,y=(d+I)/4;return e>a&&e>C?e<s?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(e),i=m/n,r=f/n):a>C?a<s?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(a),n=m/i,r=y/i):C<s?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(C),n=f/r,i=y/r),this.set(n,i,r,t),this}let C=Math.sqrt((I-d)*(I-d)+(g-h)*(g-h)+(u-c)*(u-c));return Math.abs(C)<.001&&(C=1),this.x=(I-d)/C,this.y=(g-h)/C,this.z=(u-c)/C,this.w=Math.acos((l+A+p-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class yr extends Wi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new fr(0,0,e,t),this.scissorTest=!1,this.viewport=new fr(0,0,e,t);const i={width:e,height:t,depth:1};void 0!==n.encoding&&(rr("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),n.colorSpace=n.encoding===Tn?Xn:Kn),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:pt,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},n),this.texture=new mr(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=n.generateMipmaps,this.texture.internalFormat=n.internalFormat,this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}setSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Ir(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class br extends yr{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),this.isWebGLRenderTarget=!0}}class Br extends mr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=ut,this.minFilter=ut,this.wrapR=ct,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class vr extends br{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new Br(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class wr extends mr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=ut,this.minFilter=ut,this.wrapR=ct,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Gr extends br{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new wr(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class Er extends br{constructor(){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),this.isWebGLMultipleRenderTargets=!0;const t=this.texture;this.texture=[];for(let n=0;n<e;n++)this.texture[n]=t.clone(),this.texture[n].isRenderTargetTexture=!0}setSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,r=this.texture.length;i<r;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class xr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=i}static slerpFlat(e,t,n,i,r,s,o){let a=n[i+0],l=n[i+1],c=n[i+2],g=n[i+3];const u=r[s+0],A=r[s+1],d=r[s+2],h=r[s+3];if(0===o)return e[t+0]=a,e[t+1]=l,e[t+2]=c,void(e[t+3]=g);if(1===o)return e[t+0]=u,e[t+1]=A,e[t+2]=d,void(e[t+3]=h);if(g!==h||a!==u||l!==A||c!==d){let e=1-o;const t=a*u+l*A+c*d+g*h,n=t>=0?1:-1,i=1-t*t;if(i>Number.EPSILON){const r=Math.sqrt(i),s=Math.atan2(r,t*n);e=Math.sin(e*s)/r,o=Math.sin(o*s)/r}const r=o*n;if(a=a*e+u*r,l=l*e+A*r,c=c*e+d*r,g=g*e+h*r,e===1-o){const e=1/Math.sqrt(a*a+l*l+c*c+g*g);a*=e,l*=e,c*=e,g*=e}}e[t]=a,e[t+1]=l,e[t+2]=c,e[t+3]=g}static multiplyQuaternionsFlat(e,t,n,i,r,s){const o=n[i],a=n[i+1],l=n[i+2],c=n[i+3],g=r[s],u=r[s+1],A=r[s+2],d=r[s+3];return e[t]=o*d+c*g+a*A-l*u,e[t+1]=a*d+c*u+l*g-o*A,e[t+2]=l*d+c*A+o*u-a*g,e[t+3]=c*d-o*g-a*u-l*A,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=e._x,i=e._y,r=e._z,s=e._order,o=Math.cos,a=Math.sin,l=o(n/2),c=o(i/2),g=o(r/2),u=a(n/2),A=a(i/2),d=a(r/2);switch(s){case"XYZ":this._x=u*c*g+l*A*d,this._y=l*A*g-u*c*d,this._z=l*c*d+u*A*g,this._w=l*c*g-u*A*d;break;case"YXZ":this._x=u*c*g+l*A*d,this._y=l*A*g-u*c*d,this._z=l*c*d-u*A*g,this._w=l*c*g+u*A*d;break;case"ZXY":this._x=u*c*g-l*A*d,this._y=l*A*g+u*c*d,this._z=l*c*d+u*A*g,this._w=l*c*g-u*A*d;break;case"ZYX":this._x=u*c*g-l*A*d,this._y=l*A*g+u*c*d,this._z=l*c*d-u*A*g,this._w=l*c*g+u*A*d;break;case"YZX":this._x=u*c*g+l*A*d,this._y=l*A*g+u*c*d,this._z=l*c*d-u*A*g,this._w=l*c*g-u*A*d;break;case"XZY":this._x=u*c*g-l*A*d,this._y=l*A*g-u*c*d,this._z=l*c*d+u*A*g,this._w=l*c*g+u*A*d;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],r=t[8],s=t[1],o=t[5],a=t[9],l=t[2],c=t[6],g=t[10],u=n+o+g;if(u>0){const e=.5/Math.sqrt(u+1);this._w=.25/e,this._x=(c-a)*e,this._y=(r-l)*e,this._z=(s-i)*e}else if(n>o&&n>g){const e=2*Math.sqrt(1+n-o-g);this._w=(c-a)/e,this._x=.25*e,this._y=(i+s)/e,this._z=(r+l)/e}else if(o>g){const e=2*Math.sqrt(1+o-n-g);this._w=(r-l)/e,this._x=(i+s)/e,this._y=.25*e,this._z=(a+c)/e}else{const e=2*Math.sqrt(1+g-n-o);this._w=(s-i)/e,this._x=(r+l)/e,this._y=(a+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Qi(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,r=e._z,s=e._w,o=t._x,a=t._y,l=t._z,c=t._w;return this._x=n*c+s*o+i*l-r*a,this._y=i*c+s*a+r*o-n*l,this._z=r*c+s*l+n*a-i*o,this._w=s*c-n*o-i*a-r*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,i=this._y,r=this._z,s=this._w;let o=s*e._w+n*e._x+i*e._y+r*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=s,this._x=n,this._y=i,this._z=r,this;const a=1-o*o;if(a<=Number.EPSILON){const e=1-t;return this._w=e*s+t*this._w,this._x=e*n+t*this._x,this._y=e*i+t*this._y,this._z=e*r+t*this._z,this.normalize(),this}const l=Math.sqrt(a),c=Math.atan2(l,o),g=Math.sin((1-t)*c)/l,u=Math.sin(t*c)/l;return this._w=s*g+this._w*u,this._x=n*g+this._x*u,this._y=i*g+this._y*u,this._z=r*g+this._z*u,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),i=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(t*Math.cos(i),n*Math.sin(r),n*Math.cos(r),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Sr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Sr.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Zr.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Zr.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=e.elements,s=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*s,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*s,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*s,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,r=e.x,s=e.y,o=e.z,a=e.w,l=2*(s*i-o*n),c=2*(o*t-r*i),g=2*(r*n-s*t);return this.x=t+a*l+s*g-o*c,this.y=n+a*c+o*l-r*g,this.z=i+a*g+r*c-s*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,r=e.z,s=t.x,o=t.y,a=t.z;return this.x=i*a-r*o,this.y=r*s-n*a,this.z=n*o-i*s,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Rr.copy(this).projectOnVector(e),this.sub(Rr)}reflect(e){return this.sub(Rr.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Qi(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Rr=new Sr,Zr=new xr;class Dr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Sr(1/0,1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sr(-1/0,-1/0,-1/0);this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Nr.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Nr.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Nr.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n){const i=n.getAttribute("position");if(!0===t&&void 0!==i&&!0!==e.isInstancedMesh)for(let t=0,n=i.count;t<n;t++)!0===e.isMesh?e.getVertexPosition(t,Nr):Nr.fromBufferAttribute(i,t),Nr.applyMatrix4(e.matrixWorld),this.expandByPoint(Nr);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),Mr.copy(e.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),Mr.copy(n.boundingBox)),Mr.applyMatrix4(e.matrixWorld),this.union(Mr)}const i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Nr),Nr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Qr),Kr.subVectors(this.max,Qr),Wr.subVectors(e.a,Qr),kr.subVectors(e.b,Qr),Tr.subVectors(e.c,Qr),Vr.subVectors(kr,Wr),Lr.subVectors(Tr,kr),Hr.subVectors(Wr,Tr);let t=[0,-Vr.z,Vr.y,0,-Lr.z,Lr.y,0,-Hr.z,Hr.y,Vr.z,0,-Vr.x,Lr.z,0,-Lr.x,Hr.z,0,-Hr.x,-Vr.y,Vr.x,0,-Lr.y,Lr.x,0,-Hr.y,Hr.x,0];return!!zr(t,Wr,kr,Tr,Kr)&&(t=[1,0,0,0,1,0,0,0,1],!!zr(t,Wr,kr,Tr,Kr)&&(Xr.crossVectors(Vr,Lr),t=[Xr.x,Xr.y,Xr.z],zr(t,Wr,kr,Tr,Kr)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Nr).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Nr).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Fr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Fr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Fr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Fr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Fr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Fr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Fr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Fr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Fr)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Fr=[new Sr,new Sr,new Sr,new Sr,new Sr,new Sr,new Sr,new Sr],Nr=new Sr,Mr=new Dr,Wr=new Sr,kr=new Sr,Tr=new Sr,Vr=new Sr,Lr=new Sr,Hr=new Sr,Qr=new Sr,Kr=new Sr,Xr=new Sr,Yr=new Sr;function zr(e,t,n,i,r){for(let s=0,o=e.length-3;s<=o;s+=3){Yr.fromArray(e,s);const o=r.x*Math.abs(Yr.x)+r.y*Math.abs(Yr.y)+r.z*Math.abs(Yr.z),a=t.dot(Yr),l=n.dot(Yr),c=i.dot(Yr);if(Math.max(-Math.max(a,l,c),Math.min(a,l,c))>o)return!1}return!0}const Pr=new Dr,Ur=new Sr,_r=new Sr;class Or{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Sr,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):Pr.setFromPoints(e).getCenter(n);let i=0;for(let r=0,s=e.length;r<s;r++)i=Math.max(i,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Ur.subVectors(e,this.center);const t=Ur.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.addScaledVector(Ur,n/e),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(_r.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Ur.copy(e.center).add(_r)),this.expandByPoint(Ur.copy(e.center).sub(_r))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Jr=new Sr,jr=new Sr,qr=new Sr,$r=new Sr,es=new Sr,ts=new Sr,ns=new Sr;class is{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Sr,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sr(0,0,-1);this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Jr)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Jr.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Jr.copy(this.origin).addScaledVector(this.direction,t),Jr.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){jr.copy(e).add(t).multiplyScalar(.5),qr.copy(t).sub(e).normalize(),$r.copy(this.origin).sub(jr);const r=.5*e.distanceTo(t),s=-this.direction.dot(qr),o=$r.dot(this.direction),a=-$r.dot(qr),l=$r.lengthSq(),c=Math.abs(1-s*s);let g,u,A,d;if(c>0)if(g=s*a-o,u=s*o-a,d=r*c,g>=0)if(u>=-d)if(u<=d){const e=1/c;g*=e,u*=e,A=g*(g+s*u+2*o)+u*(s*g+u+2*a)+l}else u=r,g=Math.max(0,-(s*u+o)),A=-g*g+u*(u+2*a)+l;else u=-r,g=Math.max(0,-(s*u+o)),A=-g*g+u*(u+2*a)+l;else u<=-d?(g=Math.max(0,-(-s*r+o)),u=g>0?-r:Math.min(Math.max(-r,-a),r),A=-g*g+u*(u+2*a)+l):u<=d?(g=0,u=Math.min(Math.max(-r,-a),r),A=u*(u+2*a)+l):(g=Math.max(0,-(s*r+o)),u=g>0?r:Math.min(Math.max(-r,-a),r),A=-g*g+u*(u+2*a)+l);else u=s>0?-r:r,g=Math.max(0,-(s*u+o)),A=-g*g+u*(u+2*a)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,g),i&&i.copy(jr).addScaledVector(qr,u),A}intersectSphere(e,t){Jr.subVectors(e.center,this.origin);const n=Jr.dot(this.direction),i=Jr.dot(Jr)-n*n,r=e.radius*e.radius;if(i>r)return null;const s=Math.sqrt(r-i),o=n-s,a=n+s;return a<0?null:o<0?this.at(a,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,r,s,o,a;const l=1/this.direction.x,c=1/this.direction.y,g=1/this.direction.z,u=this.origin;return l>=0?(n=(e.min.x-u.x)*l,i=(e.max.x-u.x)*l):(n=(e.max.x-u.x)*l,i=(e.min.x-u.x)*l),c>=0?(r=(e.min.y-u.y)*c,s=(e.max.y-u.y)*c):(r=(e.max.y-u.y)*c,s=(e.min.y-u.y)*c),n>s||r>i?null:((r>n||isNaN(n))&&(n=r),(s<i||isNaN(i))&&(i=s),g>=0?(o=(e.min.z-u.z)*g,a=(e.max.z-u.z)*g):(o=(e.max.z-u.z)*g,a=(e.min.z-u.z)*g),n>a||o>i?null:((o>n||n!==n)&&(n=o),(a<i||i!==i)&&(i=a),i<0?null:this.at(n>=0?n:i,t)))}intersectsBox(e){return null!==this.intersectBox(e,Jr)}intersectTriangle(e,t,n,i,r){es.subVectors(t,e),ts.subVectors(n,e),ns.crossVectors(es,ts);let s,o=this.direction.dot(ns);if(o>0){if(i)return null;s=1}else{if(!(o<0))return null;s=-1,o=-o}$r.subVectors(this.origin,e);const a=s*this.direction.dot(ts.crossVectors($r,ts));if(a<0)return null;const l=s*this.direction.dot(es.cross($r));if(l<0)return null;if(a+l>o)return null;const c=-s*$r.dot(ns);return c<0?null:this.at(c/o,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class rs{constructor(e,t,n,i,r,s,o,a,l,c,g,u,A,d,h,I){rs.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,n,i,r,s,o,a,l,c,g,u,A,d,h,I)}set(e,t,n,i,r,s,o,a,l,c,g,u,A,d,h,I){const p=this.elements;return p[0]=e,p[4]=t,p[8]=n,p[12]=i,p[1]=r,p[5]=s,p[9]=o,p[13]=a,p[2]=l,p[6]=c,p[10]=g,p[14]=u,p[3]=A,p[7]=d,p[11]=h,p[15]=I,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new rs).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/ss.setFromMatrixColumn(e,0).length(),r=1/ss.setFromMatrixColumn(e,1).length(),s=1/ss.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*s,t[9]=n[9]*s,t[10]=n[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,i=e.y,r=e.z,s=Math.cos(n),o=Math.sin(n),a=Math.cos(i),l=Math.sin(i),c=Math.cos(r),g=Math.sin(r);if("XYZ"===e.order){const e=s*c,n=s*g,i=o*c,r=o*g;t[0]=a*c,t[4]=-a*g,t[8]=l,t[1]=n+i*l,t[5]=e-r*l,t[9]=-o*a,t[2]=r-e*l,t[6]=i+n*l,t[10]=s*a}else if("YXZ"===e.order){const e=a*c,n=a*g,i=l*c,r=l*g;t[0]=e+r*o,t[4]=i*o-n,t[8]=s*l,t[1]=s*g,t[5]=s*c,t[9]=-o,t[2]=n*o-i,t[6]=r+e*o,t[10]=s*a}else if("ZXY"===e.order){const e=a*c,n=a*g,i=l*c,r=l*g;t[0]=e-r*o,t[4]=-s*g,t[8]=i+n*o,t[1]=n+i*o,t[5]=s*c,t[9]=r-e*o,t[2]=-s*l,t[6]=o,t[10]=s*a}else if("ZYX"===e.order){const e=s*c,n=s*g,i=o*c,r=o*g;t[0]=a*c,t[4]=i*l-n,t[8]=e*l+r,t[1]=a*g,t[5]=r*l+e,t[9]=n*l-i,t[2]=-l,t[6]=o*a,t[10]=s*a}else if("YZX"===e.order){const e=s*a,n=s*l,i=o*a,r=o*l;t[0]=a*c,t[4]=r-e*g,t[8]=i*g+n,t[1]=g,t[5]=s*c,t[9]=-o*c,t[2]=-l*c,t[6]=n*g+i,t[10]=e-r*g}else if("XZY"===e.order){const e=s*a,n=s*l,i=o*a,r=o*l;t[0]=a*c,t[4]=-g,t[8]=l*c,t[1]=e*g+r,t[5]=s*c,t[9]=n*g-i,t[2]=i*g-n,t[6]=o*c,t[10]=r*g+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(as,e,ls)}lookAt(e,t,n){const i=this.elements;return us.subVectors(e,t),0===us.lengthSq()&&(us.z=1),us.normalize(),cs.crossVectors(n,us),0===cs.lengthSq()&&(1===Math.abs(n.z)?us.x+=1e-4:us.z+=1e-4,us.normalize(),cs.crossVectors(n,us)),cs.normalize(),gs.crossVectors(us,cs),i[0]=cs.x,i[4]=gs.x,i[8]=us.x,i[1]=cs.y,i[5]=gs.y,i[9]=us.y,i[2]=cs.z,i[6]=gs.z,i[10]=us.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,s=n[0],o=n[4],a=n[8],l=n[12],c=n[1],g=n[5],u=n[9],A=n[13],d=n[2],h=n[6],I=n[10],p=n[14],C=n[3],m=n[7],f=n[11],y=n[15],b=i[0],B=i[4],v=i[8],w=i[12],G=i[1],E=i[5],x=i[9],S=i[13],R=i[2],Z=i[6],D=i[10],F=i[14],N=i[3],M=i[7],W=i[11],k=i[15];return r[0]=s*b+o*G+a*R+l*N,r[4]=s*B+o*E+a*Z+l*M,r[8]=s*v+o*x+a*D+l*W,r[12]=s*w+o*S+a*F+l*k,r[1]=c*b+g*G+u*R+A*N,r[5]=c*B+g*E+u*Z+A*M,r[9]=c*v+g*x+u*D+A*W,r[13]=c*w+g*S+u*F+A*k,r[2]=d*b+h*G+I*R+p*N,r[6]=d*B+h*E+I*Z+p*M,r[10]=d*v+h*x+I*D+p*W,r[14]=d*w+h*S+I*F+p*k,r[3]=C*b+m*G+f*R+y*N,r[7]=C*B+m*E+f*Z+y*M,r[11]=C*v+m*x+f*D+y*W,r[15]=C*w+m*S+f*F+y*k,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],s=e[1],o=e[5],a=e[9],l=e[13],c=e[2],g=e[6],u=e[10],A=e[14];return e[3]*(+r*a*g-i*l*g-r*o*u+n*l*u+i*o*A-n*a*A)+e[7]*(+t*a*A-t*l*u+r*s*u-i*s*A+i*l*c-r*a*c)+e[11]*(+t*l*g-t*o*A-r*s*g+n*s*A+r*o*c-n*l*c)+e[15]*(-i*o*c-t*a*g+t*o*u+i*s*g-n*s*u+n*a*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],g=e[9],u=e[10],A=e[11],d=e[12],h=e[13],I=e[14],p=e[15],C=g*I*l-h*u*l+h*a*A-o*I*A-g*a*p+o*u*p,m=d*u*l-c*I*l-d*a*A+s*I*A+c*a*p-s*u*p,f=c*h*l-d*g*l+d*o*A-s*h*A-c*o*p+s*g*p,y=d*g*a-c*h*a-d*o*u+s*h*u+c*o*I-s*g*I,b=t*C+n*m+i*f+r*y;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const B=1/b;return e[0]=C*B,e[1]=(h*u*r-g*I*r-h*i*A+n*I*A+g*i*p-n*u*p)*B,e[2]=(o*I*r-h*a*r+h*i*l-n*I*l-o*i*p+n*a*p)*B,e[3]=(g*a*r-o*u*r-g*i*l+n*u*l+o*i*A-n*a*A)*B,e[4]=m*B,e[5]=(c*I*r-d*u*r+d*i*A-t*I*A-c*i*p+t*u*p)*B,e[6]=(d*a*r-s*I*r-d*i*l+t*I*l+s*i*p-t*a*p)*B,e[7]=(s*u*r-c*a*r+c*i*l-t*u*l-s*i*A+t*a*A)*B,e[8]=f*B,e[9]=(d*g*r-c*h*r-d*n*A+t*h*A+c*n*p-t*g*p)*B,e[10]=(s*h*r-d*o*r+d*n*l-t*h*l-s*n*p+t*o*p)*B,e[11]=(c*o*r-s*g*r-c*n*l+t*g*l+s*n*A-t*o*A)*B,e[12]=y*B,e[13]=(c*h*i-d*g*i+d*n*u-t*h*u-c*n*I+t*g*I)*B,e[14]=(d*o*i-s*h*i-d*n*a+t*h*a+s*n*I-t*o*I)*B,e[15]=(s*g*i-c*o*i+c*n*a-t*g*a-s*n*u+t*o*u)*B,this}scale(e){const t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),r=1-n,s=e.x,o=e.y,a=e.z,l=r*s,c=r*o;return this.set(l*s+n,l*o-i*a,l*a+i*o,0,l*o+i*a,c*o+n,c*a-i*s,0,l*a-i*o,c*a+i*s,r*a*a+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,r,s){return this.set(1,n,r,0,e,1,s,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,r=t._x,s=t._y,o=t._z,a=t._w,l=r+r,c=s+s,g=o+o,u=r*l,A=r*c,d=r*g,h=s*c,I=s*g,p=o*g,C=a*l,m=a*c,f=a*g,y=n.x,b=n.y,B=n.z;return i[0]=(1-(h+p))*y,i[1]=(A+f)*y,i[2]=(d-m)*y,i[3]=0,i[4]=(A-f)*b,i[5]=(1-(u+p))*b,i[6]=(I+C)*b,i[7]=0,i[8]=(d+m)*B,i[9]=(I-C)*B,i[10]=(1-(u+h))*B,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let r=ss.set(i[0],i[1],i[2]).length();const s=ss.set(i[4],i[5],i[6]).length(),o=ss.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),e.x=i[12],e.y=i[13],e.z=i[14],os.copy(this);const a=1/r,l=1/s,c=1/o;return os.elements[0]*=a,os.elements[1]*=a,os.elements[2]*=a,os.elements[4]*=l,os.elements[5]*=l,os.elements[6]*=l,os.elements[8]*=c,os.elements[9]*=c,os.elements[10]*=c,t.setFromRotationMatrix(os),n.x=r,n.y=s,n.z=o,this}makePerspective(e,t,n,i,r,s){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Ni;const a=this.elements,l=2*r/(t-e),c=2*r/(n-i),g=(t+e)/(t-e),u=(n+i)/(n-i);let A,d;if(o===Ni)A=-(s+r)/(s-r),d=-2*s*r/(s-r);else{if(o!==Mi)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);A=-s/(s-r),d=-s*r/(s-r)}return a[0]=l,a[4]=0,a[8]=g,a[12]=0,a[1]=0,a[5]=c,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=A,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,n,i,r,s){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Ni;const a=this.elements,l=1/(t-e),c=1/(n-i),g=1/(s-r),u=(t+e)*l,A=(n+i)*c;let d,h;if(o===Ni)d=(s+r)*g,h=-2*g;else{if(o!==Mi)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);d=r*g,h=-1*g}return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-A,a[2]=0,a[6]=0,a[10]=h,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const ss=new Sr,os=new rs,as=new Sr(0,0,0),ls=new Sr(1,1,1),cs=new Sr,gs=new Sr,us=new Sr,As=new rs,ds=new xr;class hs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:hs.DEFAULT_ORDER;this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=e.elements,r=i[0],s=i[4],o=i[8],a=i[1],l=i[5],c=i[9],g=i[2],u=i[6],A=i[10];switch(t){case"XYZ":this._y=Math.asin(Qi(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,A),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(u,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Qi(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,A),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-g,r),this._z=0);break;case"ZXY":this._x=Math.asin(Qi(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-g,A),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(a,r));break;case"ZYX":this._y=Math.asin(-Qi(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(u,A),this._z=Math.atan2(a,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(Qi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-g,r)):(this._x=0,this._y=Math.atan2(o,A));break;case"XZY":this._z=Math.asin(-Qi(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(u,l),this._y=Math.atan2(o,r)):(this._x=Math.atan2(-c,A),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return As.makeRotationFromQuaternion(e),this.setFromRotationMatrix(As,t,n)}setFromVector3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}reorder(e){return ds.setFromEuler(this),this.setFromQuaternion(ds,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}hs.DEFAULT_ORDER="XYZ";class Is{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return 0!==(this.mask&e.mask)}isEnabled(e){return 0!==(this.mask&1<<e)}}let ps=0;const Cs=new Sr,ms=new xr,fs=new rs,ys=new Sr,bs=new Sr,Bs=new Sr,vs=new xr,ws=new Sr(1,0,0),Gs=new Sr(0,1,0),Es=new Sr(0,0,1),xs={type:"added"},Ss={type:"removed"};class Rs extends Wi{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:ps++}),this.uuid=Hi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Rs.DEFAULT_UP.clone();const e=new Sr,t=new hs,n=new xr,i=new Sr(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new rs},normalMatrix:{value:new Ji}}),this.matrix=new rs,this.matrixWorld=new rs,this.matrixAutoUpdate=Rs.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Rs.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Is,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return ms.setFromAxisAngle(e,t),this.quaternion.multiply(ms),this}rotateOnWorldAxis(e,t){return ms.setFromAxisAngle(e,t),this.quaternion.premultiply(ms),this}rotateX(e){return this.rotateOnAxis(ws,e)}rotateY(e){return this.rotateOnAxis(Gs,e)}rotateZ(e){return this.rotateOnAxis(Es,e)}translateOnAxis(e,t){return Cs.copy(e).applyQuaternion(this.quaternion),this.position.add(Cs.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(ws,e)}translateY(e){return this.translateOnAxis(Gs,e)}translateZ(e){return this.translateOnAxis(Es,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(fs.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?ys.copy(e):ys.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),bs.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?fs.lookAt(bs,ys,this.up):fs.lookAt(ys,bs,this.up),this.quaternion.setFromRotationMatrix(fs),i&&(fs.extractRotation(i.matrixWorld),ms.setFromRotationMatrix(fs),this.quaternion.premultiply(ms.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(xs)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Ss)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),fs.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),fs.multiply(e.parent.matrixWorld)),e.applyMatrix4(fs),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}}getObjectsByProperty(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this[e]===t&&n.push(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(bs,e,Bs),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(bs,vs,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++){const i=t[n];!0!==i.matrixWorldAutoUpdate&&!0!==e||i.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++){const n=e[t];!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=void 0===e||"string"===typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};function r(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map((e=>({boxInitialized:e.boxInitialized,boxMin:e.box.min.toArray(),boxMax:e.box.max.toArray(),sphereInitialized:e.sphereInitialized,sphereRadius:e.sphere.radius,sphereCenter:e.sphere.center.toArray()}))),i.maxGeometryCount=this._maxGeometryCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),null!==this.boundingSphere&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),null!==this.boundingBox&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,i=n.length;t<i;t++){const i=n[t];r(e.shapes,i)}else r(e.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,i=this.material.length;n<i;n++)t.push(r(e.materials,this.material[n]));i.material=t}else i.material=r(e.materials,this.material);if(this.children.length>0){i.children=[];for(let t=0;t<this.children.length;t++)i.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];i.animations.push(r(e.animations,n))}}if(t){const t=s(e.geometries),i=s(e.materials),r=s(e.textures),o=s(e.images),a=s(e.shapes),l=s(e.skeletons),c=s(e.animations),g=s(e.nodes);t.length>0&&(n.geometries=t),i.length>0&&(n.materials=i),r.length>0&&(n.textures=r),o.length>0&&(n.images=o),a.length>0&&(n.shapes=a),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),g.length>0&&(n.nodes=g)}return n.object=i,n;function s(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++){const t=e.children[n];this.add(t.clone())}return this}}Rs.DEFAULT_UP=new Sr(0,1,0),Rs.DEFAULT_MATRIX_AUTO_UPDATE=!0,Rs.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Zs=new Sr,Ds=new Sr,Fs=new Sr,Ns=new Sr,Ms=new Sr,Ws=new Sr,ks=new Sr,Ts=new Sr,Vs=new Sr,Ls=new Sr;let Hs=!1;class Qs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Sr,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sr,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Sr;this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),Zs.subVectors(e,t),i.cross(Zs);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(e,t,n,i,r){Zs.subVectors(i,t),Ds.subVectors(n,t),Fs.subVectors(e,t);const s=Zs.dot(Zs),o=Zs.dot(Ds),a=Zs.dot(Fs),l=Ds.dot(Ds),c=Ds.dot(Fs),g=s*l-o*o;if(0===g)return r.set(0,0,0),null;const u=1/g,A=(l*a-o*c)*u,d=(s*c-o*a)*u;return r.set(1-A-d,d,A)}static containsPoint(e,t,n,i){return null!==this.getBarycoord(e,t,n,i,Ns)&&(Ns.x>=0&&Ns.y>=0&&Ns.x+Ns.y<=1)}static getUV(e,t,n,i,r,s,o,a){return!1===Hs&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Hs=!0),this.getInterpolation(e,t,n,i,r,s,o,a)}static getInterpolation(e,t,n,i,r,s,o,a){return null===this.getBarycoord(e,t,n,i,Ns)?(a.x=0,a.y=0,"z"in a&&(a.z=0),"w"in a&&(a.w=0),null):(a.setScalar(0),a.addScaledVector(r,Ns.x),a.addScaledVector(s,Ns.y),a.addScaledVector(o,Ns.z),a)}static isFrontFacing(e,t,n,i){return Zs.subVectors(n,t),Ds.subVectors(e,t),Zs.cross(Ds).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Zs.subVectors(this.c,this.b),Ds.subVectors(this.a,this.b),.5*Zs.cross(Ds).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Qs.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Qs.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,i,r){return!1===Hs&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Hs=!0),Qs.getInterpolation(e,this.a,this.b,this.c,t,n,i,r)}getInterpolation(e,t,n,i,r){return Qs.getInterpolation(e,this.a,this.b,this.c,t,n,i,r)}containsPoint(e){return Qs.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Qs.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,r=this.c;let s,o;Ms.subVectors(i,n),Ws.subVectors(r,n),Ts.subVectors(e,n);const a=Ms.dot(Ts),l=Ws.dot(Ts);if(a<=0&&l<=0)return t.copy(n);Vs.subVectors(e,i);const c=Ms.dot(Vs),g=Ws.dot(Vs);if(c>=0&&g<=c)return t.copy(i);const u=a*g-c*l;if(u<=0&&a>=0&&c<=0)return s=a/(a-c),t.copy(n).addScaledVector(Ms,s);Ls.subVectors(e,r);const A=Ms.dot(Ls),d=Ws.dot(Ls);if(d>=0&&A<=d)return t.copy(r);const h=A*l-a*d;if(h<=0&&l>=0&&d<=0)return o=l/(l-d),t.copy(n).addScaledVector(Ws,o);const I=c*d-A*g;if(I<=0&&g-c>=0&&A-d>=0)return ks.subVectors(r,i),o=(g-c)/(g-c+(A-d)),t.copy(i).addScaledVector(ks,o);const p=1/(I+h+u);return s=h*p,o=u*p,t.copy(n).addScaledVector(Ms,s).addScaledVector(Ws,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Ks={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Xs={h:0,s:0,l:0},Ys={h:0,s:0,l:0};function zs(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}class Ps{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(void 0===t&&void 0===n){const t=e;t&&t.isColor?this.copy(t):"number"===typeof t?this.setHex(t):"string"===typeof t&&this.setStyle(t)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Xn;return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,cr.toWorkingColorSpace(this,t),this}setRGB(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:cr.workingColorSpace;return this.r=e,this.g=t,this.b=n,cr.toWorkingColorSpace(this,i),this}setHSL(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:cr.workingColorSpace;if(e=Ki(e,1),t=Qi(t,0,1),n=Qi(n,0,1),0===t)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,r=2*n-i;this.r=zs(r,i,e+1/3),this.g=zs(r,i,e),this.b=zs(r,i,e-1/3)}return cr.toWorkingColorSpace(this,i),this}setStyle(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Xn;function i(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(t=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const s=t[1],o=t[2];switch(s){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,n);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,n);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){const i=t[1],r=i.length;if(3===r)return this.setRGB(parseInt(i.charAt(0),16)/15,parseInt(i.charAt(1),16)/15,parseInt(i.charAt(2),16)/15,n);if(6===r)return this.setHex(parseInt(i,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Xn;const n=Ks[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=gr(e.r),this.g=gr(e.g),this.b=gr(e.b),this}copyLinearToSRGB(e){return this.r=ur(e.r),this.g=ur(e.g),this.b=ur(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xn;return cr.fromWorkingColorSpace(Us.copy(this),e),65536*Math.round(Qi(255*Us.r,0,255))+256*Math.round(Qi(255*Us.g,0,255))+Math.round(Qi(255*Us.b,0,255))}getHexString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xn;return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cr.workingColorSpace;cr.fromWorkingColorSpace(Us.copy(this),t);const n=Us.r,i=Us.g,r=Us.b,s=Math.max(n,i,r),o=Math.min(n,i,r);let a,l;const c=(o+s)/2;if(o===s)a=0,l=0;else{const e=s-o;switch(l=c<=.5?e/(s+o):e/(2-s-o),s){case n:a=(i-r)/e+(i<r?6:0);break;case i:a=(r-n)/e+2;break;case r:a=(n-i)/e+4}a/=6}return e.h=a,e.s=l,e.l=c,e}getRGB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cr.workingColorSpace;return cr.fromWorkingColorSpace(Us.copy(this),t),e.r=Us.r,e.g=Us.g,e.b=Us.b,e}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xn;cr.fromWorkingColorSpace(Us.copy(this),e);const t=Us.r,n=Us.g,i=Us.b;return e!==Xn?"color(".concat(e," ").concat(t.toFixed(3)," ").concat(n.toFixed(3)," ").concat(i.toFixed(3),")"):"rgb(".concat(Math.round(255*t),",").concat(Math.round(255*n),",").concat(Math.round(255*i),")")}offsetHSL(e,t,n){return this.getHSL(Xs),this.setHSL(Xs.h+e,Xs.s+t,Xs.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Xs),e.getHSL(Ys);const n=Xi(Xs.h,Ys.h,t),i=Xi(Xs.s,Ys.s,t),r=Xi(Xs.l,Ys.l,t);return this.setHSL(n,i,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,i=this.b,r=e.elements;return this.r=r[0]*t+r[3]*n+r[6]*i,this.g=r[1]*t+r[4]*n+r[7]*i,this.b=r[2]*t+r[5]*n+r[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Us=new Ps;Ps.NAMES=Ks;let _s=0;class Os extends Wi{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:_s++}),this.uuid=Hi(),this.name="",this.type="Material",this.blending=ue,this.side=oe,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Ge,this.blendDst=Ee,this.blendEquation=pe,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Ps(0,0,0),this.blendAlpha=0,this.depthFunc=Le,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Ai,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=qn,this.stencilZFail=qn,this.stencilZPass=qn,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!==e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: parameter '".concat(t,"' has value of undefined."));continue}const i=this[t];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n:console.warn("THREE.Material: '".concat(t,"' is not a property of THREE.").concat(this.type,"."))}}toJSON(e){const t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function i(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==ue&&(n.blending=this.blending),this.side!==oe&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),this.blendSrc!==Ge&&(n.blendSrc=this.blendSrc),this.blendDst!==Ee&&(n.blendDst=this.blendDst),this.blendEquation!==pe&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==Le&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Ai&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==qn&&(n.stencilFail=this.stencilFail),this.stencilZFail!==qn&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==qn&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const t=i(e.textures),r=i(e.images);t.length>0&&(n.textures=t),r.length>0&&(n.images=r)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let i=0;i!==e;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class Js extends Os{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ps(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ye,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const js=qs();function qs(){const e=new ArrayBuffer(4),t=new Float32Array(e),n=new Uint32Array(e),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const e=l-127;e<-27?(i[l]=0,i[256|l]=32768,r[l]=24,r[256|l]=24):e<-14?(i[l]=1024>>-e-14,i[256|l]=1024>>-e-14|32768,r[l]=-e-1,r[256|l]=-e-1):e<=15?(i[l]=e+15<<10,i[256|l]=e+15<<10|32768,r[l]=13,r[256|l]=13):e<128?(i[l]=31744,i[256|l]=64512,r[l]=24,r[256|l]=24):(i[l]=31744,i[256|l]=64512,r[l]=13,r[256|l]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let e=l<<13,t=0;for(;0===(8388608&e);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,s[l]=e|t}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(a[l]=1024);return{floatView:t,uint32View:n,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function $s(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=Qi(e,-65504,65504),js.floatView[0]=e;const t=js.uint32View[0],n=t>>23&511;return js.baseTable[n]+((8388607&t)>>js.shiftTable[n])}function eo(e){const t=e>>10;return js.uint32View[0]=js.mantissaTable[js.offsetTable[t]+(1023&e)]+js.exponentTable[t],js.floatView[0]}const to={toHalfFloat:$s,fromHalfFloat:eo},no=new Sr,io=new Oi;class ro{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=bi,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=xt,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return console.warn("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)io.fromBufferAttribute(this,t),io.applyMatrix3(e),this.setXY(t,io.x,io.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)no.fromBufferAttribute(this,t),no.applyMatrix3(e),this.setXYZ(t,no.x,no.y,no.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)no.fromBufferAttribute(this,t),no.applyMatrix4(e),this.setXYZ(t,no.x,no.y,no.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)no.fromBufferAttribute(this,t),no.applyNormalMatrix(e),this.setXYZ(t,no.x,no.y,no.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)no.fromBufferAttribute(this,t),no.transformDirection(e),this.setXYZ(t,no.x,no.y,no.z);return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=Pi(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Ui(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Pi(t,this.array)),t}setX(e,t){return this.normalized&&(t=Ui(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Pi(t,this.array)),t}setY(e,t){return this.normalized&&(t=Ui(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Pi(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Ui(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Pi(t,this.array)),t}setW(e,t){return this.normalized&&(t=Ui(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Ui(t,this.array),n=Ui(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=Ui(t,this.array),n=Ui(n,this.array),i=Ui(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e*=this.itemSize,this.normalized&&(t=Ui(t,this.array),n=Ui(n,this.array),i=Ui(i,this.array),r=Ui(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==bi&&(e.usage=this.usage),e}}class so extends ro{constructor(e,t,n){super(new Int8Array(e),t,n)}}class oo extends ro{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class ao extends ro{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class lo extends ro{constructor(e,t,n){super(new Int16Array(e),t,n)}}class co extends ro{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class go extends ro{constructor(e,t,n){super(new Int32Array(e),t,n)}}class uo extends ro{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class Ao extends ro{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=eo(this.array[e*this.itemSize]);return this.normalized&&(t=Pi(t,this.array)),t}setX(e,t){return this.normalized&&(t=Ui(t,this.array)),this.array[e*this.itemSize]=$s(t),this}getY(e){let t=eo(this.array[e*this.itemSize+1]);return this.normalized&&(t=Pi(t,this.array)),t}setY(e,t){return this.normalized&&(t=Ui(t,this.array)),this.array[e*this.itemSize+1]=$s(t),this}getZ(e){let t=eo(this.array[e*this.itemSize+2]);return this.normalized&&(t=Pi(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Ui(t,this.array)),this.array[e*this.itemSize+2]=$s(t),this}getW(e){let t=eo(this.array[e*this.itemSize+3]);return this.normalized&&(t=Pi(t,this.array)),t}setW(e,t){return this.normalized&&(t=Ui(t,this.array)),this.array[e*this.itemSize+3]=$s(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Ui(t,this.array),n=Ui(n,this.array)),this.array[e+0]=$s(t),this.array[e+1]=$s(n),this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=Ui(t,this.array),n=Ui(n,this.array),i=Ui(i,this.array)),this.array[e+0]=$s(t),this.array[e+1]=$s(n),this.array[e+2]=$s(i),this}setXYZW(e,t,n,i,r){return e*=this.itemSize,this.normalized&&(t=Ui(t,this.array),n=Ui(n,this.array),i=Ui(i,this.array),r=Ui(r,this.array)),this.array[e+0]=$s(t),this.array[e+1]=$s(n),this.array[e+2]=$s(i),this.array[e+3]=$s(r),this}}class ho extends ro{constructor(e,t,n){super(new Float32Array(e),t,n)}}class Io extends ro{constructor(e,t,n){super(new Float64Array(e),t,n)}}let po=0;const Co=new rs,mo=new Rs,fo=new Sr,yo=new Dr,bo=new Dr,Bo=new Sr;class vo extends Wi{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:po++}),this.uuid=Hi(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(qi(e)?uo:co)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new Ji).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Co.makeRotationFromQuaternion(e),this.applyMatrix4(Co),this}rotateX(e){return Co.makeRotationX(e),this.applyMatrix4(Co),this}rotateY(e){return Co.makeRotationY(e),this.applyMatrix4(Co),this}rotateZ(e){return Co.makeRotationZ(e),this.applyMatrix4(Co),this}translate(e,t,n){return Co.makeTranslation(e,t,n),this.applyMatrix4(Co),this}scale(e,t,n){return Co.makeScale(e,t,n),this.applyMatrix4(Co),this}lookAt(e){return mo.lookAt(e),mo.updateMatrix(),this.applyMatrix4(mo.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(fo).negate(),this.translate(fo.x,fo.y,fo.z),this}setFromPoints(e){const t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new ho(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Dr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Sr(-1/0,-1/0,-1/0),new Sr(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){const e=t[n];yo.setFromBufferAttribute(e),this.morphTargetsRelative?(Bo.addVectors(this.boundingBox.min,yo.min),this.boundingBox.expandByPoint(Bo),Bo.addVectors(this.boundingBox.max,yo.max),this.boundingBox.expandByPoint(Bo)):(this.boundingBox.expandByPoint(yo.min),this.boundingBox.expandByPoint(yo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Or);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Sr,1/0);if(e){const n=this.boundingSphere.center;if(yo.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){const n=t[e];bo.setFromBufferAttribute(n),this.morphTargetsRelative?(Bo.addVectors(yo.min,bo.min),yo.expandByPoint(Bo),Bo.addVectors(yo.max,bo.max),yo.expandByPoint(Bo)):(yo.expandByPoint(bo.min),yo.expandByPoint(bo.max))}yo.getCenter(n);let i=0;for(let t=0,r=e.count;t<r;t++)Bo.fromBufferAttribute(e,t),i=Math.max(i,n.distanceToSquared(Bo));if(t)for(let r=0,s=t.length;r<s;r++){const s=t[r],o=this.morphTargetsRelative;for(let t=0,r=s.count;t<r;t++)Bo.fromBufferAttribute(s,t),o&&(fo.fromBufferAttribute(e,t),Bo.add(fo)),i=Math.max(i,n.distanceToSquared(Bo))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,i=t.position.array,r=t.normal.array,s=t.uv.array,o=i.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new ro(new Float32Array(4*o),4));const a=this.getAttribute("tangent").array,l=[],c=[];for(let G=0;G<o;G++)l[G]=new Sr,c[G]=new Sr;const g=new Sr,u=new Sr,A=new Sr,d=new Oi,h=new Oi,I=new Oi,p=new Sr,C=new Sr;function m(e,t,n){g.fromArray(i,3*e),u.fromArray(i,3*t),A.fromArray(i,3*n),d.fromArray(s,2*e),h.fromArray(s,2*t),I.fromArray(s,2*n),u.sub(g),A.sub(g),h.sub(d),I.sub(d);const r=1/(h.x*I.y-I.x*h.y);isFinite(r)&&(p.copy(u).multiplyScalar(I.y).addScaledVector(A,-h.y).multiplyScalar(r),C.copy(A).multiplyScalar(h.x).addScaledVector(u,-I.x).multiplyScalar(r),l[e].add(p),l[t].add(p),l[n].add(p),c[e].add(C),c[t].add(C),c[n].add(C))}let f=this.groups;0===f.length&&(f=[{start:0,count:n.length}]);for(let G=0,E=f.length;G<E;++G){const e=f[G],t=e.start;for(let i=t,r=t+e.count;i<r;i+=3)m(n[i+0],n[i+1],n[i+2])}const y=new Sr,b=new Sr,B=new Sr,v=new Sr;function w(e){B.fromArray(r,3*e),v.copy(B);const t=l[e];y.copy(t),y.sub(B.multiplyScalar(B.dot(t))).normalize(),b.crossVectors(v,t);const n=b.dot(c[e])<0?-1:1;a[4*e]=y.x,a[4*e+1]=y.y,a[4*e+2]=y.z,a[4*e+3]=n}for(let G=0,E=f.length;G<E;++G){const e=f[G],t=e.start;for(let i=t,r=t+e.count;i<r;i+=3)w(n[i+0]),w(n[i+1]),w(n[i+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new ro(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const i=new Sr,r=new Sr,s=new Sr,o=new Sr,a=new Sr,l=new Sr,c=new Sr,g=new Sr;if(e)for(let u=0,A=e.count;u<A;u+=3){const A=e.getX(u+0),d=e.getX(u+1),h=e.getX(u+2);i.fromBufferAttribute(t,A),r.fromBufferAttribute(t,d),s.fromBufferAttribute(t,h),c.subVectors(s,r),g.subVectors(i,r),c.cross(g),o.fromBufferAttribute(n,A),a.fromBufferAttribute(n,d),l.fromBufferAttribute(n,h),o.add(c),a.add(c),l.add(c),n.setXYZ(A,o.x,o.y,o.z),n.setXYZ(d,a.x,a.y,a.z),n.setXYZ(h,l.x,l.y,l.z)}else for(let e=0,u=t.count;e<u;e+=3)i.fromBufferAttribute(t,e+0),r.fromBufferAttribute(t,e+1),s.fromBufferAttribute(t,e+2),c.subVectors(s,r),g.subVectors(i,r),c.cross(g),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Bo.fromBufferAttribute(e,t),Bo.normalize(),e.setXYZ(t,Bo.x,Bo.y,Bo.z)}toNonIndexed(){function e(e,t){const n=e.array,i=e.itemSize,r=e.normalized,s=new n.constructor(t.length*i);let o=0,a=0;for(let l=0,c=t.length;l<c;l++){o=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*i;for(let e=0;e<i;e++)s[a++]=n[o++]}return new ro(s,i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new vo,n=this.index.array,i=this.attributes;for(const o in i){const r=e(i[o],n);t.setAttribute(o,r)}const r=this.morphAttributes;for(const o in r){const i=[],s=r[o];for(let t=0,r=s.length;t<r;t++){const r=e(s[t],n);i.push(r)}t.morphAttributes[o]=i}t.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let o=0,a=s.length;o<a;o++){const e=s[o];t.addGroup(e.start,e.count,e.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const a in n){const t=n[a];e.data.attributes[a]=t.toJSON(e.data)}const i={};let r=!1;for(const a in this.morphAttributes){const t=this.morphAttributes[a],n=[];for(let i=0,r=t.length;i<r;i++){const r=t[i];n.push(r.toJSON(e.data))}n.length>0&&(i[a]=n,r=!0)}r&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const o=this.boundingSphere;return null!==o&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const i=e.attributes;for(const l in i){const e=i[l];this.setAttribute(l,e.clone(t))}const r=e.morphAttributes;for(const l in r){const e=[],n=r[l];for(let i=0,r=n.length;i<r;i++)e.push(n[i].clone(t));this.morphAttributes[l]=e}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let l=0,c=s.length;l<c;l++){const e=s[l];this.addGroup(e.start,e.count,e.materialIndex)}const o=e.boundingBox;null!==o&&(this.boundingBox=o.clone());const a=e.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const wo=new rs,Go=new is,Eo=new Or,xo=new Sr,So=new Sr,Ro=new Sr,Zo=new Sr,Do=new Sr,Fo=new Sr,No=new Oi,Mo=new Oi,Wo=new Oi,ko=new Sr,To=new Sr,Vo=new Sr,Lo=new Sr,Ho=new Sr;class Qo extends Rs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new vo,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Js;super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){const n=this.geometry,i=n.attributes.position,r=n.morphAttributes.position,s=n.morphTargetsRelative;t.fromBufferAttribute(i,e);const o=this.morphTargetInfluences;if(r&&o){Fo.set(0,0,0);for(let n=0,i=r.length;n<i;n++){const i=o[n],a=r[n];0!==i&&(Do.fromBufferAttribute(a,e),s?Fo.addScaledVector(Do,i):Fo.addScaledVector(Do.sub(t),i))}t.add(Fo)}return t}raycast(e,t){const n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0!==i){if(null===n.boundingSphere&&n.computeBoundingSphere(),Eo.copy(n.boundingSphere),Eo.applyMatrix4(r),Go.copy(e.ray).recast(e.near),!1===Eo.containsPoint(Go.origin)){if(null===Go.intersectSphere(Eo,xo))return;if(Go.origin.distanceToSquared(xo)>(e.far-e.near)**2)return}wo.copy(r).invert(),Go.copy(e.ray).applyMatrix4(wo),null!==n.boundingBox&&!1===Go.intersectsBox(n.boundingBox)||this._computeIntersections(e,t,Go)}}_computeIntersections(e,t,n){let i;const r=this.geometry,s=this.material,o=r.index,a=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv1,g=r.attributes.normal,u=r.groups,A=r.drawRange;if(null!==o)if(Array.isArray(s))for(let d=0,h=u.length;d<h;d++){const r=u[d],a=s[r.materialIndex];for(let s=Math.max(r.start,A.start),u=Math.min(o.count,Math.min(r.start+r.count,A.start+A.count));s<u;s+=3){i=Ko(this,a,e,n,l,c,g,o.getX(s),o.getX(s+1),o.getX(s+2)),i&&(i.faceIndex=Math.floor(s/3),i.face.materialIndex=r.materialIndex,t.push(i))}}else{for(let r=Math.max(0,A.start),a=Math.min(o.count,A.start+A.count);r<a;r+=3){i=Ko(this,s,e,n,l,c,g,o.getX(r),o.getX(r+1),o.getX(r+2)),i&&(i.faceIndex=Math.floor(r/3),t.push(i))}}else if(void 0!==a)if(Array.isArray(s))for(let d=0,h=u.length;d<h;d++){const r=u[d],o=s[r.materialIndex];for(let s=Math.max(r.start,A.start),u=Math.min(a.count,Math.min(r.start+r.count,A.start+A.count));s<u;s+=3){i=Ko(this,o,e,n,l,c,g,s,s+1,s+2),i&&(i.faceIndex=Math.floor(s/3),i.face.materialIndex=r.materialIndex,t.push(i))}}else{for(let r=Math.max(0,A.start),o=Math.min(a.count,A.start+A.count);r<o;r+=3){i=Ko(this,s,e,n,l,c,g,r,r+1,r+2),i&&(i.faceIndex=Math.floor(r/3),t.push(i))}}}}function Ko(e,t,n,i,r,s,o,a,l,c){e.getVertexPosition(a,So),e.getVertexPosition(l,Ro),e.getVertexPosition(c,Zo);const g=function(e,t,n,i,r,s,o,a){let l;if(l=t.side===ae?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,t.side===oe,a),null===l)return null;Ho.copy(a),Ho.applyMatrix4(e.matrixWorld);const c=n.ray.origin.distanceTo(Ho);return c<n.near||c>n.far?null:{distance:c,point:Ho.clone(),object:e}}(e,t,n,i,So,Ro,Zo,Lo);if(g){r&&(No.fromBufferAttribute(r,a),Mo.fromBufferAttribute(r,l),Wo.fromBufferAttribute(r,c),g.uv=Qs.getInterpolation(Lo,So,Ro,Zo,No,Mo,Wo,new Oi)),s&&(No.fromBufferAttribute(s,a),Mo.fromBufferAttribute(s,l),Wo.fromBufferAttribute(s,c),g.uv1=Qs.getInterpolation(Lo,So,Ro,Zo,No,Mo,Wo,new Oi),g.uv2=g.uv1),o&&(ko.fromBufferAttribute(o,a),To.fromBufferAttribute(o,l),Vo.fromBufferAttribute(o,c),g.normal=Qs.getInterpolation(Lo,So,Ro,Zo,ko,To,Vo,new Sr),g.normal.dot(i.direction)>0&&g.normal.multiplyScalar(-1));const e={a:a,b:l,c:c,normal:new Sr,materialIndex:0};Qs.getNormal(So,Ro,Zo,e.normal),g.face=e}return g}class Xo extends vo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:s};const o=this;i=Math.floor(i),r=Math.floor(r),s=Math.floor(s);const a=[],l=[],c=[],g=[];let u=0,A=0;function d(e,t,n,i,r,s,d,h,I,p,C){const m=s/I,f=d/p,y=s/2,b=d/2,B=h/2,v=I+1,w=p+1;let G=0,E=0;const x=new Sr;for(let o=0;o<w;o++){const s=o*f-b;for(let a=0;a<v;a++){const u=a*m-y;x[e]=u*i,x[t]=s*r,x[n]=B,l.push(x.x,x.y,x.z),x[e]=0,x[t]=0,x[n]=h>0?1:-1,c.push(x.x,x.y,x.z),g.push(a/I),g.push(1-o/p),G+=1}}for(let o=0;o<p;o++)for(let e=0;e<I;e++){const t=u+e+v*o,n=u+e+v*(o+1),i=u+(e+1)+v*(o+1),r=u+(e+1)+v*o;a.push(t,n,r),a.push(n,i,r),E+=6}o.addGroup(A,E,C),A+=E,u+=G}d("z","y","x",-1,-1,n,t,e,s,r,0),d("z","y","x",1,-1,n,t,-e,s,r,1),d("x","z","y",1,1,e,n,t,i,s,2),d("x","z","y",1,-1,e,n,-t,i,s,3),d("x","y","z",1,-1,e,t,n,i,r,4),d("x","y","z",-1,-1,e,t,-n,i,r,5),this.setIndex(a),this.setAttribute("position",new ho(l,3)),this.setAttribute("normal",new ho(c,3)),this.setAttribute("uv",new ho(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Xo(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Yo(e){const t={};for(const n in e){t[n]={};for(const i in e[n]){const r=e[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][i]=null):t[n][i]=r.clone():Array.isArray(r)?t[n][i]=r.slice():t[n][i]=r}}return t}function zo(e){const t={};for(let n=0;n<e.length;n++){const i=Yo(e[n]);for(const e in i)t[e]=i[e]}return t}function Po(e){return null===e.getRenderTarget()?e.outputColorSpace:cr.workingColorSpace}const Uo={clone:Yo,merge:zo};class _o extends Os{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Yo(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const n=this.uniforms[i].value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const i in this.extensions)!0===this.extensions[i]&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Oo extends Rs{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new rs,this.projectionMatrix=new rs,this.projectionMatrixInverse=new rs,this.coordinateSystem=Ni}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Jo extends Oo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Li*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Vi*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Li*Math.atan(Math.tan(.5*Vi*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,i,r,s){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Vi*this.fov)/this.zoom,n=2*t,i=this.aspect*n,r=-.5*i;const s=this.view;if(null!==this.view&&this.view.enabled){const e=s.fullWidth,o=s.fullHeight;r+=s.offsetX*i/e,t-=s.offsetY*n/o,i*=s.width/e,n*=s.height/o}const o=this.filmOffset;0!==o&&(r+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const jo=-90;class qo extends Rs{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new Jo(jo,1,e,t);i.layers=this.layers,this.add(i);const r=new Jo(jo,1,e,t);r.layers=this.layers,this.add(r);const s=new Jo(jo,1,e,t);s.layers=this.layers,this.add(s);const o=new Jo(jo,1,e,t);o.layers=this.layers,this.add(o);const a=new Jo(jo,1,e,t);a.layers=this.layers,this.add(a);const l=new Jo(jo,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,i,r,s,o,a]=t;for(const l of t)this.remove(l);if(e===Ni)n.up.set(0,1,0),n.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),s.up.set(0,0,1),s.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),a.up.set(0,1,0),a.lookAt(0,0,-1);else{if(e!==Mi)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);n.up.set(0,-1,0),n.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),s.up.set(0,0,-1),s.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),a.up.set(0,-1,0),a.lookAt(0,0,-1)}for(const l of t)this.add(l),l.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,s,o,a,l,c]=this.children,g=e.getRenderTarget(),u=e.getActiveCubeFace(),A=e.getActiveMipmapLevel(),d=e.xr.enabled;e.xr.enabled=!1;const h=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,i),e.render(t,r),e.setRenderTarget(n,1,i),e.render(t,s),e.setRenderTarget(n,2,i),e.render(t,o),e.setRenderTarget(n,3,i),e.render(t,a),e.setRenderTarget(n,4,i),e.render(t,l),n.texture.generateMipmaps=h,e.setRenderTarget(n,5,i),e.render(t,c),e.setRenderTarget(g,u,A),e.xr.enabled=d,n.texture.needsPMREMUpdate=!0}}class $o extends mr{constructor(e,t,n,i,r,s,o,a,l,c){super(e=void 0!==e?e:[],t=void 0!==t?t:it,n,i,r,s,o,a,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class ea extends br{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];void 0!==t.encoding&&(rr("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===Tn?Xn:Kn),this.texture=new $o(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:pt}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={tEquirect:{value:null}},i="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",r="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",s=new Xo(5,5,5),o=new _o({name:"CubemapFromEquirect",uniforms:Yo(n),vertexShader:i,fragmentShader:r,side:ae,blending:ge});o.uniforms.tEquirect.value=t;const a=new Qo(s,o),l=t.minFilter;t.minFilter===ft&&(t.minFilter=pt);return new qo(1,10,this).update(e,a),t.minFilter=l,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,n,i){const r=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,n,i);e.setRenderTarget(r)}}const ta=new Sr,na=new Sr,ia=new Ji;class ra{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Sr(1,0,0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=ta.subVectors(n,t).cross(na.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(ta),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:t.copy(e.start).addScaledVector(n,r)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||ia.getNormalMatrix(e),i=this.coplanarPoint(ta).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const sa=new Or,oa=new Sr;class aa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ra,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ra,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ra,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new ra,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new ra,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new ra;this.planes=[e,t,n,i,r,s]}set(e,t,n,i,r,s){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(i),o[4].copy(r),o[5].copy(s),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ni;const n=this.planes,i=e.elements,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],c=i[5],g=i[6],u=i[7],A=i[8],d=i[9],h=i[10],I=i[11],p=i[12],C=i[13],m=i[14],f=i[15];if(n[0].setComponents(a-r,u-l,I-A,f-p).normalize(),n[1].setComponents(a+r,u+l,I+A,f+p).normalize(),n[2].setComponents(a+s,u+c,I+d,f+C).normalize(),n[3].setComponents(a-s,u-c,I-d,f-C).normalize(),n[4].setComponents(a-o,u-g,I-h,f-m).normalize(),t===Ni)n[5].setComponents(a+o,u+g,I+h,f+m).normalize();else{if(t!==Mi)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);n[5].setComponents(o,g,h,m).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),sa.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),sa.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(sa)}intersectsSprite(e){return sa.center.set(0,0,0),sa.radius=.7071067811865476,sa.applyMatrix4(e.matrixWorld),this.intersectsSphere(sa)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let r=0;r<6;r++){if(t[r].distanceToPoint(n)<i)return!1}return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(oa.x=i.normal.x>0?e.max.x:e.min.x,oa.y=i.normal.y>0?e.max.y:e.min.y,oa.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(oa)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function la(){let e=null,t=!1,n=null,i=null;function r(t,s){n(t,s),i=e.requestAnimationFrame(r)}return{start:function(){!0!==t&&null!==n&&(i=e.requestAnimationFrame(r),t=!0)},stop:function(){e.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function ca(e,t){const n=t.isWebGL2,i=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),i.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);const n=i.get(t);n&&(e.deleteBuffer(n.buffer),i.delete(t))},update:function(t,r){if(t.isGLBufferAttribute){const e=i.get(t);return void((!e||e.version<t.version)&&i.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version}))}t.isInterleavedBufferAttribute&&(t=t.data);const s=i.get(t);if(void 0===s)i.set(t,function(t,i){const r=t.array,s=t.usage,o=r.byteLength,a=e.createBuffer();let l;if(e.bindBuffer(i,a),e.bufferData(i,r,s),t.onUploadCallback(),r instanceof Float32Array)l=e.FLOAT;else if(r instanceof Uint16Array)if(t.isFloat16BufferAttribute){if(!n)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");l=e.HALF_FLOAT}else l=e.UNSIGNED_SHORT;else if(r instanceof Int16Array)l=e.SHORT;else if(r instanceof Uint32Array)l=e.UNSIGNED_INT;else if(r instanceof Int32Array)l=e.INT;else if(r instanceof Int8Array)l=e.BYTE;else if(r instanceof Uint8Array)l=e.UNSIGNED_BYTE;else{if(!(r instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+r);l=e.UNSIGNED_BYTE}return{buffer:a,type:l,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version,size:o}}(t,r));else if(s.version<t.version){if(s.size!==t.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(t,i,r){const s=i.array,o=i._updateRange,a=i.updateRanges;if(e.bindBuffer(r,t),-1===o.count&&0===a.length&&e.bufferSubData(r,0,s),0!==a.length){for(let t=0,i=a.length;t<i;t++){const i=a[t];n?e.bufferSubData(r,i.start*s.BYTES_PER_ELEMENT,s,i.start,i.count):e.bufferSubData(r,i.start*s.BYTES_PER_ELEMENT,s.subarray(i.start,i.start+i.count))}i.clearUpdateRanges()}-1!==o.count&&(n?e.bufferSubData(r,o.offset*s.BYTES_PER_ELEMENT,s,o.offset,o.count):e.bufferSubData(r,o.offset*s.BYTES_PER_ELEMENT,s.subarray(o.offset,o.offset+o.count)),o.count=-1),i.onUploadCallback()}(s.buffer,t,r),s.version=t.version}}}}class ga extends vo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const r=e/2,s=t/2,o=Math.floor(n),a=Math.floor(i),l=o+1,c=a+1,g=e/o,u=t/a,A=[],d=[],h=[],I=[];for(let p=0;p<c;p++){const e=p*u-s;for(let t=0;t<l;t++){const n=t*g-r;d.push(n,-e,0),h.push(0,0,1),I.push(t/o),I.push(1-p/a)}}for(let p=0;p<a;p++)for(let e=0;e<o;e++){const t=e+l*p,n=e+l*(p+1),i=e+1+l*(p+1),r=e+1+l*p;A.push(t,n,r),A.push(n,i,r)}this.setIndex(A),this.setAttribute("position",new ho(d,3)),this.setAttribute("normal",new ho(h,3)),this.setAttribute("uv",new ho(I,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ga(e.width,e.height,e.widthSegments,e.heightSegments)}}const ua={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\tattribute float batchId;\n\tuniform highp sampler2D batchingTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( batchId );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor *= toneMappingExposure;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\treturn color;\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},Aa={common:{diffuse:{value:new Ps(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Ji},alphaMap:{value:null},alphaMapTransform:{value:new Ji},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Ji}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Ji}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Ji}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Ji},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Ji},normalScale:{value:new Oi(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Ji},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Ji}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Ji}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Ji}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ps(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ps(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Ji},alphaTest:{value:0},uvTransform:{value:new Ji}},sprite:{diffuse:{value:new Ps(16777215)},opacity:{value:1},center:{value:new Oi(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Ji},alphaMap:{value:null},alphaMapTransform:{value:new Ji},alphaTest:{value:0}}},da={basic:{uniforms:zo([Aa.common,Aa.specularmap,Aa.envmap,Aa.aomap,Aa.lightmap,Aa.fog]),vertexShader:ua.meshbasic_vert,fragmentShader:ua.meshbasic_frag},lambert:{uniforms:zo([Aa.common,Aa.specularmap,Aa.envmap,Aa.aomap,Aa.lightmap,Aa.emissivemap,Aa.bumpmap,Aa.normalmap,Aa.displacementmap,Aa.fog,Aa.lights,{emissive:{value:new Ps(0)}}]),vertexShader:ua.meshlambert_vert,fragmentShader:ua.meshlambert_frag},phong:{uniforms:zo([Aa.common,Aa.specularmap,Aa.envmap,Aa.aomap,Aa.lightmap,Aa.emissivemap,Aa.bumpmap,Aa.normalmap,Aa.displacementmap,Aa.fog,Aa.lights,{emissive:{value:new Ps(0)},specular:{value:new Ps(1118481)},shininess:{value:30}}]),vertexShader:ua.meshphong_vert,fragmentShader:ua.meshphong_frag},standard:{uniforms:zo([Aa.common,Aa.envmap,Aa.aomap,Aa.lightmap,Aa.emissivemap,Aa.bumpmap,Aa.normalmap,Aa.displacementmap,Aa.roughnessmap,Aa.metalnessmap,Aa.fog,Aa.lights,{emissive:{value:new Ps(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ua.meshphysical_vert,fragmentShader:ua.meshphysical_frag},toon:{uniforms:zo([Aa.common,Aa.aomap,Aa.lightmap,Aa.emissivemap,Aa.bumpmap,Aa.normalmap,Aa.displacementmap,Aa.gradientmap,Aa.fog,Aa.lights,{emissive:{value:new Ps(0)}}]),vertexShader:ua.meshtoon_vert,fragmentShader:ua.meshtoon_frag},matcap:{uniforms:zo([Aa.common,Aa.bumpmap,Aa.normalmap,Aa.displacementmap,Aa.fog,{matcap:{value:null}}]),vertexShader:ua.meshmatcap_vert,fragmentShader:ua.meshmatcap_frag},points:{uniforms:zo([Aa.points,Aa.fog]),vertexShader:ua.points_vert,fragmentShader:ua.points_frag},dashed:{uniforms:zo([Aa.common,Aa.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ua.linedashed_vert,fragmentShader:ua.linedashed_frag},depth:{uniforms:zo([Aa.common,Aa.displacementmap]),vertexShader:ua.depth_vert,fragmentShader:ua.depth_frag},normal:{uniforms:zo([Aa.common,Aa.bumpmap,Aa.normalmap,Aa.displacementmap,{opacity:{value:1}}]),vertexShader:ua.meshnormal_vert,fragmentShader:ua.meshnormal_frag},sprite:{uniforms:zo([Aa.sprite,Aa.fog]),vertexShader:ua.sprite_vert,fragmentShader:ua.sprite_frag},background:{uniforms:{uvTransform:{value:new Ji},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ua.background_vert,fragmentShader:ua.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:ua.backgroundCube_vert,fragmentShader:ua.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ua.cube_vert,fragmentShader:ua.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ua.equirect_vert,fragmentShader:ua.equirect_frag},distanceRGBA:{uniforms:zo([Aa.common,Aa.displacementmap,{referencePosition:{value:new Sr},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ua.distanceRGBA_vert,fragmentShader:ua.distanceRGBA_frag},shadow:{uniforms:zo([Aa.lights,Aa.fog,{color:{value:new Ps(0)},opacity:{value:1}}]),vertexShader:ua.shadow_vert,fragmentShader:ua.shadow_frag}};da.physical={uniforms:zo([da.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Ji},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Ji},clearcoatNormalScale:{value:new Oi(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Ji},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Ji},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Ji},sheen:{value:0},sheenColor:{value:new Ps(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Ji},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Ji},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Ji},transmissionSamplerSize:{value:new Oi},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Ji},attenuationDistance:{value:0},attenuationColor:{value:new Ps(0)},specularColor:{value:new Ps(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Ji},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Ji},anisotropyVector:{value:new Oi},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Ji}}]),vertexShader:ua.meshphysical_vert,fragmentShader:ua.meshphysical_frag};const ha={r:0,b:0,g:0};function Ia(e,t,n,i,r,s,o){const a=new Ps(0);let l,c,g=!0===s?0:1,u=null,A=0,d=null;function h(t,n){t.getRGB(ha,Po(e)),i.buffers.color.setClear(ha.r,ha.g,ha.b,n,o)}return{getClearColor:function(){return a},setClearColor:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;a.set(e),g=t,h(a,g)},getClearAlpha:function(){return g},setClearAlpha:function(e){g=e,h(a,g)},render:function(s,I){let p=!1,C=!0===I.isScene?I.background:null;if(C&&C.isTexture){C=(I.backgroundBlurriness>0?n:t).get(C)}null===C?h(a,g):C&&C.isColor&&(h(C,1),p=!0);const m=e.xr.getEnvironmentBlendMode();"additive"===m?i.buffers.color.setClear(0,0,0,1,o):"alpha-blend"===m&&i.buffers.color.setClear(0,0,0,0,o),(e.autoClear||p)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),C&&(C.isCubeTexture||C.mapping===at)?(void 0===c&&(c=new Qo(new Xo(1,1,1),new _o({name:"BackgroundCubeMaterial",uniforms:Yo(da.backgroundCube.uniforms),vertexShader:da.backgroundCube.vertexShader,fragmentShader:da.backgroundCube.fragmentShader,side:ae,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(c)),c.material.uniforms.envMap.value=C,c.material.uniforms.flipEnvMap.value=C.isCubeTexture&&!1===C.isRenderTargetTexture?-1:1,c.material.uniforms.backgroundBlurriness.value=I.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=I.backgroundIntensity,c.material.toneMapped=cr.getTransfer(C.colorSpace)!==_n,u===C&&A===C.version&&d===e.toneMapping||(c.material.needsUpdate=!0,u=C,A=C.version,d=e.toneMapping),c.layers.enableAll(),s.unshift(c,c.geometry,c.material,0,0,null)):C&&C.isTexture&&(void 0===l&&(l=new Qo(new ga(2,2),new _o({name:"BackgroundMaterial",uniforms:Yo(da.background.uniforms),vertexShader:da.background.vertexShader,fragmentShader:da.background.fragmentShader,side:oe,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=C,l.material.uniforms.backgroundIntensity.value=I.backgroundIntensity,l.material.toneMapped=cr.getTransfer(C.colorSpace)!==_n,!0===C.matrixAutoUpdate&&C.updateMatrix(),l.material.uniforms.uvTransform.value.copy(C.matrix),u===C&&A===C.version&&d===e.toneMapping||(l.material.needsUpdate=!0,u=C,A=C.version,d=e.toneMapping),l.layers.enableAll(),s.unshift(l,l.geometry,l.material,0,0,null))}}}function pa(e,t,n,i){const r=e.getParameter(e.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:t.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},l=d(null);let c=l,g=!1;function u(t){return i.isWebGL2?e.bindVertexArray(t):s.bindVertexArrayOES(t)}function A(t){return i.isWebGL2?e.deleteVertexArray(t):s.deleteVertexArrayOES(t)}function d(e){const t=[],n=[],i=[];for(let s=0;s<r;s++)t[s]=0,n[s]=0,i[s]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:i,object:e,attributes:{},index:null}}function h(){const e=c.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function I(e){p(e,0)}function p(n,r){const s=c.newAttributes,o=c.enabledAttributes,a=c.attributeDivisors;if(s[n]=1,0===o[n]&&(e.enableVertexAttribArray(n),o[n]=1),a[n]!==r){(i.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,r),a[n]=r}}function C(){const t=c.newAttributes,n=c.enabledAttributes;for(let i=0,r=n.length;i<r;i++)n[i]!==t[i]&&(e.disableVertexAttribArray(i),n[i]=0)}function m(t,n,i,r,s,o,a){!0===a?e.vertexAttribIPointer(t,n,i,s,o):e.vertexAttribPointer(t,n,i,r,s,o)}function f(){y(),g=!0,c!==l&&(c=l,u(c.object))}function y(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(r,l,A,f,y){let b=!1;if(o){const t=function(t,n,r){const o=!0===r.wireframe;let l=a[t.id];void 0===l&&(l={},a[t.id]=l);let c=l[n.id];void 0===c&&(c={},l[n.id]=c);let g=c[o];void 0===g&&(g=d(i.isWebGL2?e.createVertexArray():s.createVertexArrayOES()),c[o]=g);return g}(f,A,l);c!==t&&(c=t,u(c.object)),b=function(e,t,n,i){const r=c.attributes,s=t.attributes;let o=0;const a=n.getAttributes();for(const l in a){if(a[l].location>=0){const t=r[l];let n=s[l];if(void 0===n&&("instanceMatrix"===l&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(n=e.instanceColor)),void 0===t)return!0;if(t.attribute!==n)return!0;if(n&&t.data!==n.data)return!0;o++}}return c.attributesNum!==o||c.index!==i}(r,f,A,y),b&&function(e,t,n,i){const r={},s=t.attributes;let o=0;const a=n.getAttributes();for(const l in a){if(a[l].location>=0){let t=s[l];void 0===t&&("instanceMatrix"===l&&e.instanceMatrix&&(t=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(t=e.instanceColor));const n={};n.attribute=t,t&&t.data&&(n.data=t.data),r[l]=n,o++}}c.attributes=r,c.attributesNum=o,c.index=i}(r,f,A,y)}else{const e=!0===l.wireframe;c.geometry===f.id&&c.program===A.id&&c.wireframe===e||(c.geometry=f.id,c.program=A.id,c.wireframe=e,b=!0)}null!==y&&n.update(y,e.ELEMENT_ARRAY_BUFFER),(b||g)&&(g=!1,function(r,s,o,a){if(!1===i.isWebGL2&&(r.isInstancedMesh||a.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;h();const l=a.attributes,c=o.getAttributes(),g=s.defaultAttributeValues;for(const t in c){const s=c[t];if(s.location>=0){let o=l[t];if(void 0===o&&("instanceMatrix"===t&&r.instanceMatrix&&(o=r.instanceMatrix),"instanceColor"===t&&r.instanceColor&&(o=r.instanceColor)),void 0!==o){const t=o.normalized,l=o.itemSize,c=n.get(o);if(void 0===c)continue;const g=c.buffer,u=c.type,A=c.bytesPerElement,d=!0===i.isWebGL2&&(u===e.INT||u===e.UNSIGNED_INT||o.gpuType===Gt);if(o.isInterleavedBufferAttribute){const n=o.data,i=n.stride,c=o.offset;if(n.isInstancedInterleavedBuffer){for(let e=0;e<s.locationSize;e++)p(s.location+e,n.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=n.meshPerAttribute*n.count)}else for(let e=0;e<s.locationSize;e++)I(s.location+e);e.bindBuffer(e.ARRAY_BUFFER,g);for(let e=0;e<s.locationSize;e++)m(s.location+e,l/s.locationSize,u,t,i*A,(c+l/s.locationSize*e)*A,d)}else{if(o.isInstancedBufferAttribute){for(let e=0;e<s.locationSize;e++)p(s.location+e,o.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=o.meshPerAttribute*o.count)}else for(let e=0;e<s.locationSize;e++)I(s.location+e);e.bindBuffer(e.ARRAY_BUFFER,g);for(let e=0;e<s.locationSize;e++)m(s.location+e,l/s.locationSize,u,t,l*A,l/s.locationSize*e*A,d)}}else if(void 0!==g){const n=g[t];if(void 0!==n)switch(n.length){case 2:e.vertexAttrib2fv(s.location,n);break;case 3:e.vertexAttrib3fv(s.location,n);break;case 4:e.vertexAttrib4fv(s.location,n);break;default:e.vertexAttrib1fv(s.location,n)}}}}C()}(r,l,A,f),null!==y&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n.get(y).buffer))},reset:f,resetDefaultState:y,dispose:function(){f();for(const e in a){const t=a[e];for(const e in t){const n=t[e];for(const e in n)A(n[e].object),delete n[e];delete t[e]}delete a[e]}},releaseStatesOfGeometry:function(e){if(void 0===a[e.id])return;const t=a[e.id];for(const n in t){const e=t[n];for(const t in e)A(e[t].object),delete e[t];delete t[n]}delete a[e.id]},releaseStatesOfProgram:function(e){for(const t in a){const n=a[t];if(void 0===n[e.id])continue;const i=n[e.id];for(const e in i)A(i[e].object),delete i[e];delete n[e.id]}},initAttributes:h,enableAttribute:I,disableUnusedAttributes:C}}function Ca(e,t,n,i){const r=i.isWebGL2;let s;this.setMode=function(e){s=e},this.render=function(t,i){e.drawArrays(s,t,i),n.update(i,s,1)},this.renderInstances=function(i,o,a){if(0===a)return;let l,c;if(r)l=e,c="drawArraysInstanced";else if(l=t.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](s,i,o,a),n.update(o,s,a)},this.renderMultiDraw=function(e,i,r){if(0===r)return;const o=t.get("WEBGL_multi_draw");if(null===o)for(let t=0;t<r;t++)this.render(e[t],i[t]);else{o.multiDrawArraysWEBGL(s,e,0,i,0,r);let t=0;for(let e=0;e<r;e++)t+=i[e];n.update(t,s,1)}}}function ma(e,t,n){let i;function r(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const s="undefined"!==typeof WebGL2RenderingContext&&"WebGL2RenderingContext"===e.constructor.name;let o=void 0!==n.precision?n.precision:"highp";const a=r(o);a!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",a,"instead."),o=a);const l=s||t.has("WEBGL_draw_buffers"),c=!0===n.logarithmicDepthBuffer,g=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),u=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),A=e.getParameter(e.MAX_TEXTURE_SIZE),d=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),h=e.getParameter(e.MAX_VERTEX_ATTRIBS),I=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),p=e.getParameter(e.MAX_VARYING_VECTORS),C=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),m=u>0,f=s||t.has("OES_texture_float");return{isWebGL2:s,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:r,precision:o,logarithmicDepthBuffer:c,maxTextures:g,maxVertexTextures:u,maxTextureSize:A,maxCubemapSize:d,maxAttributes:h,maxVertexUniforms:I,maxVaryings:p,maxFragmentUniforms:C,vertexTextures:m,floatFragmentTextures:f,floatVertexTextures:m&&f,maxSamples:s?e.getParameter(e.MAX_SAMPLES):0}}function fa(e){const t=this;let n=null,i=0,r=!1,s=!1;const o=new ra,a=new Ji,l={value:null,needsUpdate:!1};function c(e,n,i,r){const s=null!==e?e.length:0;let c=null;if(0!==s){if(c=l.value,!0!==r||null===c){const t=i+4*s,r=n.matrixWorldInverse;a.getNormalMatrix(r),(null===c||c.length<t)&&(c=new Float32Array(t));for(let n=0,l=i;n!==s;++n,l+=4)o.copy(e[n]).applyMatrix4(r,a),o.normal.toArray(c,l),c[l+3]=o.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=s,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){const n=0!==e.length||t||0!==i||r;return r=t,i=e.length,n},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(e,t){n=c(e,t,0)},this.setState=function(o,a,g){const u=o.clippingPlanes,A=o.clipIntersection,d=o.clipShadows,h=e.get(o);if(!r||null===u||0===u.length||s&&!d)s?c(null):function(){l.value!==n&&(l.value=n,l.needsUpdate=i>0);t.numPlanes=i,t.numIntersection=0}();else{const e=s?0:i,t=4*e;let r=h.clippingState||null;l.value=r,r=c(u,a,t,g);for(let i=0;i!==t;++i)r[i]=n[i];h.clippingState=r,this.numIntersection=A?this.numPlanes:0,this.numPlanes+=e}}}function ya(e){let t=new WeakMap;function n(e,t){return t===st?e.mapping=it:t===ot&&(e.mapping=rt),e}function i(e){const n=e.target;n.removeEventListener("dispose",i);const r=t.get(n);void 0!==r&&(t.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping;if(s===st||s===ot){if(t.has(r)){return n(t.get(r).texture,r.mapping)}{const s=r.image;if(s&&s.height>0){const o=new ea(s.height/2);return o.fromEquirectangularTexture(e,r),t.set(r,o),r.addEventListener("dispose",i),n(o.texture,r.mapping)}return null}}}return r},dispose:function(){t=new WeakMap}}}class ba extends Oo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,r,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-e,s=n+e,o=i+t,a=i-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=e*this.view.offsetX,s=r+e*this.view.width,o-=t*this.view.offsetY,a=o-t*this.view.height}this.projectionMatrix.makeOrthographic(r,s,o,a,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const Ba=[.125,.215,.35,.446,.526,.582],va=20,wa=new ba,Ga=new Ps;let Ea=null,xa=0,Sa=0;const Ra=(1+Math.sqrt(5))/2,Za=1/Ra,Da=[new Sr(1,1,1),new Sr(-1,1,1),new Sr(1,1,-1),new Sr(-1,1,-1),new Sr(0,Ra,Za),new Sr(0,Ra,-Za),new Sr(Za,0,Ra),new Sr(-Za,0,Ra),new Sr(Ra,Za,0),new Sr(-Ra,Za,0)];class Fa{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;Ea=this._renderer.getRenderTarget(),xa=this._renderer.getActiveCubeFace(),Sa=this._renderer.getActiveMipmapLevel(),this._setSize(256);const r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(e,n,i,r),t>0&&this._blur(r,0,0,t),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}fromCubemap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=ka(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=Wa(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Ea,xa,Sa),e.scissorTest=!1,Ma(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===it||e.mapping===rt?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Ea=this._renderer.getRenderTarget(),xa=this._renderer.getActiveCubeFace(),Sa=this._renderer.getActiveMipmapLevel();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:pt,minFilter:pt,generateMipmaps:!1,type:St,format:Nt,colorSpace:Yn,depthBuffer:!1},i=Na(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=Na(e,t,n);const{_lodMax:i}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){const t=[],n=[],i=[];let r=e;const s=e-4+1+Ba.length;for(let o=0;o<s;o++){const s=Math.pow(2,r);n.push(s);let a=1/s;o>e-4?a=Ba[o-e+4-1]:0===o&&(a=0),i.push(a);const l=1/(s-2),c=-l,g=1+l,u=[c,c,g,c,g,g,c,c,g,g,c,g],A=6,d=6,h=3,I=2,p=1,C=new Float32Array(h*d*A),m=new Float32Array(I*d*A),f=new Float32Array(p*d*A);for(let e=0;e<A;e++){const t=e%3*2/3-1,n=e>2?0:-1,i=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];C.set(i,h*d*e),m.set(u,I*d*e);const r=[e,e,e,e,e,e];f.set(r,p*d*e)}const y=new vo;y.setAttribute("position",new ro(C,h)),y.setAttribute("uv",new ro(m,I)),y.setAttribute("faceIndex",new ro(f,p)),t.push(y),r>4&&r--}return{lodPlanes:t,sizeLods:n,sigmas:i}}(i)),this._blurMaterial=function(e,t,n){const i=new Float32Array(va),r=new Sr(0,1,0),s=new _o({name:"SphericalGaussianBlur",defines:{n:va,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:"".concat(e,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:ge,depthTest:!1,depthWrite:!1});return s}(i,e,t)}return i}_compileMaterial(e){const t=new Qo(this._lodPlanes[0],e);this._renderer.compile(t,wa)}_sceneToCubeUV(e,t,n,i){const r=new Jo(90,1,t,n),s=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],a=this._renderer,l=a.autoClear,c=a.toneMapping;a.getClearColor(Ga),a.toneMapping=Ue,a.autoClear=!1;const g=new Js({name:"PMREM.Background",side:ae,depthWrite:!1,depthTest:!1}),u=new Qo(new Xo,g);let A=!1;const d=e.background;d?d.isColor&&(g.color.copy(d),e.background=null,A=!0):(g.color.copy(Ga),A=!0);for(let h=0;h<6;h++){const t=h%3;0===t?(r.up.set(0,s[h],0),r.lookAt(o[h],0,0)):1===t?(r.up.set(0,0,s[h]),r.lookAt(0,o[h],0)):(r.up.set(0,s[h],0),r.lookAt(0,0,o[h]));const n=this._cubeSize;Ma(i,t*n,h>2?n:0,n,n),a.setRenderTarget(i),A&&a.render(u,r),a.render(e,r)}u.geometry.dispose(),u.material.dispose(),a.toneMapping=c,a.autoClear=l,e.background=d}_textureToCubeUV(e,t){const n=this._renderer,i=e.mapping===it||e.mapping===rt;i?(null===this._cubemapMaterial&&(this._cubemapMaterial=ka()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=Wa());const r=i?this._cubemapMaterial:this._equirectMaterial,s=new Qo(this._lodPlanes[0],r);r.uniforms.envMap.value=e;const o=this._cubeSize;Ma(t,0,0,3*o,2*o),n.setRenderTarget(t),n.render(s,wa)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){const t=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),n=Da[(i-1)%Da.length];this._blur(e,i-1,i,t,n)}t.autoClear=n}_blur(e,t,n,i,r){const s=this._pingPongRenderTarget;this._halfBlur(e,s,t,n,i,"latitudinal",r),this._halfBlur(s,e,n,n,i,"longitudinal",r)}_halfBlur(e,t,n,i,r,s,o){const a=this._renderer,l=this._blurMaterial;"latitudinal"!==s&&"longitudinal"!==s&&console.error("blur direction must be either latitudinal or longitudinal!");const c=new Qo(this._lodPlanes[i],l),g=l.uniforms,u=this._sizeLods[n]-1,A=isFinite(r)?Math.PI/(2*u):2*Math.PI/39,d=r/A,h=isFinite(r)?1+Math.floor(3*d):va;h>va&&console.warn("sigmaRadians, ".concat(r,", is too large and will clip, as it requested ").concat(h," samples when the maximum is set to ").concat(va));const I=[];let p=0;for(let f=0;f<va;++f){const e=f/d,t=Math.exp(-e*e/2);I.push(t),0===f?p+=t:f<h&&(p+=2*t)}for(let f=0;f<I.length;f++)I[f]=I[f]/p;g.envMap.value=e.texture,g.samples.value=h,g.weights.value=I,g.latitudinal.value="latitudinal"===s,o&&(g.poleAxis.value=o);const{_lodMax:C}=this;g.dTheta.value=A,g.mipInt.value=C-n;const m=this._sizeLods[i];Ma(t,3*m*(i>C-4?i-C+4:0),4*(this._cubeSize-m),3*m,2*m),a.setRenderTarget(t),a.render(c,wa)}}function Na(e,t,n){const i=new br(e,t,n);return i.texture.mapping=at,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Ma(e,t,n,i,r){e.viewport.set(t,n,i,r),e.scissor.set(t,n,i,r)}function Wa(){return new _o({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:ge,depthTest:!1,depthWrite:!1})}function ka(){return new _o({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:ge,depthTest:!1,depthWrite:!1})}function Ta(e){let t=new WeakMap,n=null;function i(e){const n=e.target;n.removeEventListener("dispose",i);const r=t.get(n);void 0!==r&&(t.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping,o=s===st||s===ot,a=s===it||s===rt;if(o||a){if(r.isRenderTargetTexture&&!0===r.needsPMREMUpdate){r.needsPMREMUpdate=!1;let i=t.get(r);return null===n&&(n=new Fa(e)),i=o?n.fromEquirectangular(r,i):n.fromCubemap(r,i),t.set(r,i),i.texture}if(t.has(r))return t.get(r).texture;{const s=r.image;if(o&&s&&s.height>0||a&&s&&function(e){let t=0;const n=6;for(let i=0;i<n;i++)void 0!==e[i]&&t++;return t===n}(s)){null===n&&(n=new Fa(e));const s=o?n.fromEquirectangular(r):n.fromCubemap(r);return t.set(r,s),r.addEventListener("dispose",i),s.texture}return null}}}return r},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function Va(e){const t={};function n(n){if(void 0!==t[n])return t[n];let i;switch(n){case"WEBGL_depth_texture":i=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=e.getExtension(n)}return t[n]=i,i}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?(n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance")):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(e){const t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function La(e,t,n,i){const r={},s=new WeakMap;function o(e){const a=e.target;null!==a.index&&t.remove(a.index);for(const n in a.attributes)t.remove(a.attributes[n]);for(const n in a.morphAttributes){const e=a.morphAttributes[n];for(let n=0,i=e.length;n<i;n++)t.remove(e[n])}a.removeEventListener("dispose",o),delete r[a.id];const l=s.get(a);l&&(t.remove(l),s.delete(a)),i.releaseStatesOfGeometry(a),!0===a.isInstancedBufferGeometry&&delete a._maxInstanceCount,n.memory.geometries--}function a(e){const n=[],i=e.index,r=e.attributes.position;let o=0;if(null!==i){const e=i.array;o=i.version;for(let t=0,i=e.length;t<i;t+=3){const i=e[t+0],r=e[t+1],s=e[t+2];n.push(i,r,r,s,s,i)}}else{if(void 0===r)return;{const e=r.array;o=r.version;for(let t=0,i=e.length/3-1;t<i;t+=3){const e=t+0,i=t+1,r=t+2;n.push(e,i,i,r,r,e)}}}const a=new(qi(n)?uo:co)(n,1);a.version=o;const l=s.get(e);l&&t.remove(l),s.set(e,a)}return{get:function(e,t){return!0===r[t.id]||(t.addEventListener("dispose",o),r[t.id]=!0,n.memory.geometries++),t},update:function(n){const i=n.attributes;for(const s in i)t.update(i[s],e.ARRAY_BUFFER);const r=n.morphAttributes;for(const s in r){const n=r[s];for(let i=0,r=n.length;i<r;i++)t.update(n[i],e.ARRAY_BUFFER)}},getWireframeAttribute:function(e){const t=s.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&a(e)}else a(e);return s.get(e)}}}function Ha(e,t,n,i){const r=i.isWebGL2;let s,o,a;this.setMode=function(e){s=e},this.setIndex=function(e){o=e.type,a=e.bytesPerElement},this.render=function(t,i){e.drawElements(s,i,o,t*a),n.update(i,s,1)},this.renderInstances=function(i,l,c){if(0===c)return;let g,u;if(r)g=e,u="drawElementsInstanced";else if(g=t.get("ANGLE_instanced_arrays"),u="drawElementsInstancedANGLE",null===g)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");g[u](s,l,o,i*a,c),n.update(l,s,c)},this.renderMultiDraw=function(e,i,r){if(0===r)return;const l=t.get("WEBGL_multi_draw");if(null===l)for(let t=0;t<r;t++)this.render(e[t]/a,i[t]);else{l.multiDrawElementsWEBGL(s,i,0,o,e,0,r);let t=0;for(let e=0;e<r;e++)t+=i[e];n.update(t,s,1)}}}function Qa(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,i,r){switch(t.calls++,i){case e.TRIANGLES:t.triangles+=r*(n/3);break;case e.LINES:t.lines+=r*(n/2);break;case e.LINE_STRIP:t.lines+=r*(n-1);break;case e.LINE_LOOP:t.lines+=r*n;break;case e.POINTS:t.points+=r*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",i)}}}}function Ka(e,t){return e[0]-t[0]}function Xa(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Ya(e,t,n){const i={},r=new Float32Array(8),s=new WeakMap,o=new fr,a=[];for(let l=0;l<8;l++)a[l]=[l,0];return{update:function(l,c,g){const u=l.morphTargetInfluences;if(!0===t.isWebGL2){const A=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,d=void 0!==A?A.length:0;let h=s.get(c);if(void 0===h||h.count!==d){void 0!==h&&h.texture.dispose();const C=void 0!==c.morphAttributes.position,m=void 0!==c.morphAttributes.normal,f=void 0!==c.morphAttributes.color,y=c.morphAttributes.position||[],b=c.morphAttributes.normal||[],B=c.morphAttributes.color||[];let v=0;!0===C&&(v=1),!0===m&&(v=2),!0===f&&(v=3);let w=c.attributes.position.count*v,G=1;w>t.maxTextureSize&&(G=Math.ceil(w/t.maxTextureSize),w=t.maxTextureSize);const E=new Float32Array(w*G*4*d),x=new Br(E,w,G,d);x.type=xt,x.needsUpdate=!0;const S=4*v;for(let Z=0;Z<d;Z++){const D=y[Z],F=b[Z],N=B[Z],M=w*G*4*Z;for(let W=0;W<D.count;W++){const k=W*S;!0===C&&(o.fromBufferAttribute(D,W),E[M+k+0]=o.x,E[M+k+1]=o.y,E[M+k+2]=o.z,E[M+k+3]=0),!0===m&&(o.fromBufferAttribute(F,W),E[M+k+4]=o.x,E[M+k+5]=o.y,E[M+k+6]=o.z,E[M+k+7]=0),!0===f&&(o.fromBufferAttribute(N,W),E[M+k+8]=o.x,E[M+k+9]=o.y,E[M+k+10]=o.z,E[M+k+11]=4===N.itemSize?o.w:1)}}function R(){x.dispose(),s.delete(c),c.removeEventListener("dispose",R)}h={count:d,texture:x,size:new Oi(w,G)},s.set(c,h),c.addEventListener("dispose",R)}let I=0;for(let T=0;T<u.length;T++)I+=u[T];const p=c.morphTargetsRelative?1:1-I;g.getUniforms().setValue(e,"morphTargetBaseInfluence",p),g.getUniforms().setValue(e,"morphTargetInfluences",u),g.getUniforms().setValue(e,"morphTargetsTexture",h.texture,n),g.getUniforms().setValue(e,"morphTargetsTextureSize",h.size)}else{const V=void 0===u?0:u.length;let L=i[c.id];if(void 0===L||L.length!==V){L=[];for(let Y=0;Y<V;Y++)L[Y]=[Y,0];i[c.id]=L}for(let z=0;z<V;z++){const P=L[z];P[0]=z,P[1]=u[z]}L.sort(Xa);for(let U=0;U<8;U++)U<V&&L[U][1]?(a[U][0]=L[U][0],a[U][1]=L[U][1]):(a[U][0]=Number.MAX_SAFE_INTEGER,a[U][1]=0);a.sort(Ka);const H=c.morphAttributes.position,Q=c.morphAttributes.normal;let K=0;for(let _=0;_<8;_++){const O=a[_],J=O[0],j=O[1];J!==Number.MAX_SAFE_INTEGER&&j?(H&&c.getAttribute("morphTarget"+_)!==H[J]&&c.setAttribute("morphTarget"+_,H[J]),Q&&c.getAttribute("morphNormal"+_)!==Q[J]&&c.setAttribute("morphNormal"+_,Q[J]),r[_]=j,K+=j):(H&&!0===c.hasAttribute("morphTarget"+_)&&c.deleteAttribute("morphTarget"+_),Q&&!0===c.hasAttribute("morphNormal"+_)&&c.deleteAttribute("morphNormal"+_),r[_]=0)}const X=c.morphTargetsRelative?1:1-K;g.getUniforms().setValue(e,"morphTargetBaseInfluence",X),g.getUniforms().setValue(e,"morphTargetInfluences",r)}}}}function za(e,t,n,i){let r=new WeakMap;function s(e){const t=e.target;t.removeEventListener("dispose",s),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(o){const a=i.render.frame,l=o.geometry,c=t.get(o,l);if(r.get(c)!==a&&(t.update(c),r.set(c,a)),o.isInstancedMesh&&(!1===o.hasEventListener("dispose",s)&&o.addEventListener("dispose",s),r.get(o)!==a&&(n.update(o.instanceMatrix,e.ARRAY_BUFFER),null!==o.instanceColor&&n.update(o.instanceColor,e.ARRAY_BUFFER),r.set(o,a))),o.isSkinnedMesh){const e=o.skeleton;r.get(e)!==a&&(e.update(),r.set(e,a))}return c},dispose:function(){r=new WeakMap}}}class Pa extends mr{constructor(e,t,n,i,r,s,o,a,l,c){if((c=void 0!==c?c:kt)!==kt&&c!==Tt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===kt&&(n=Et),void 0===n&&c===Tt&&(n=Dt),super(null,i,r,s,o,a,c,n,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==o?o:ut,this.minFilter=void 0!==a?a:ut,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}const Ua=new mr,_a=new Pa(1,1);_a.compareFunction=pi;const Oa=new Br,Ja=new wr,ja=new $o,qa=[],$a=[],el=new Float32Array(16),tl=new Float32Array(9),nl=new Float32Array(4);function il(e,t,n){const i=e[0];if(i<=0||i>0)return e;const r=t*n;let s=qa[r];if(void 0===s&&(s=new Float32Array(r),qa[r]=s),0!==t){i.toArray(s,0);for(let i=1,r=0;i!==t;++i)r+=n,e[i].toArray(s,r)}return s}function rl(e,t){if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(e[n]!==t[n])return!1;return!0}function sl(e,t){for(let n=0,i=t.length;n<i;n++)e[n]=t[n]}function ol(e,t){let n=$a[t];void 0===n&&(n=new Int32Array(t),$a[t]=n);for(let i=0;i!==t;++i)n[i]=e.allocateTextureUnit();return n}function al(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function ll(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(rl(n,t))return;e.uniform2fv(this.addr,t),sl(n,t)}}function cl(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(rl(n,t))return;e.uniform3fv(this.addr,t),sl(n,t)}}function gl(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(rl(n,t))return;e.uniform4fv(this.addr,t),sl(n,t)}}function ul(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(rl(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),sl(n,t)}else{if(rl(n,i))return;nl.set(i),e.uniformMatrix2fv(this.addr,!1,nl),sl(n,i)}}function Al(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(rl(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),sl(n,t)}else{if(rl(n,i))return;tl.set(i),e.uniformMatrix3fv(this.addr,!1,tl),sl(n,i)}}function dl(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(rl(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),sl(n,t)}else{if(rl(n,i))return;el.set(i),e.uniformMatrix4fv(this.addr,!1,el),sl(n,i)}}function hl(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Il(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(rl(n,t))return;e.uniform2iv(this.addr,t),sl(n,t)}}function pl(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(rl(n,t))return;e.uniform3iv(this.addr,t),sl(n,t)}}function Cl(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(rl(n,t))return;e.uniform4iv(this.addr,t),sl(n,t)}}function ml(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function fl(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(rl(n,t))return;e.uniform2uiv(this.addr,t),sl(n,t)}}function yl(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(rl(n,t))return;e.uniform3uiv(this.addr,t),sl(n,t)}}function bl(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(rl(n,t))return;e.uniform4uiv(this.addr,t),sl(n,t)}}function Bl(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r);const s=this.type===e.SAMPLER_2D_SHADOW?_a:Ua;n.setTexture2D(t||s,r)}function vl(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(t||Ja,r)}function wl(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(t||ja,r)}function Gl(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(t||Oa,r)}function El(e,t){e.uniform1fv(this.addr,t)}function xl(e,t){const n=il(t,this.size,2);e.uniform2fv(this.addr,n)}function Sl(e,t){const n=il(t,this.size,3);e.uniform3fv(this.addr,n)}function Rl(e,t){const n=il(t,this.size,4);e.uniform4fv(this.addr,n)}function Zl(e,t){const n=il(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function Dl(e,t){const n=il(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function Fl(e,t){const n=il(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function Nl(e,t){e.uniform1iv(this.addr,t)}function Ml(e,t){e.uniform2iv(this.addr,t)}function Wl(e,t){e.uniform3iv(this.addr,t)}function kl(e,t){e.uniform4iv(this.addr,t)}function Tl(e,t){e.uniform1uiv(this.addr,t)}function Vl(e,t){e.uniform2uiv(this.addr,t)}function Ll(e,t){e.uniform3uiv(this.addr,t)}function Hl(e,t){e.uniform4uiv(this.addr,t)}function Ql(e,t,n){const i=this.cache,r=t.length,s=ol(n,r);rl(i,s)||(e.uniform1iv(this.addr,s),sl(i,s));for(let o=0;o!==r;++o)n.setTexture2D(t[o]||Ua,s[o])}function Kl(e,t,n){const i=this.cache,r=t.length,s=ol(n,r);rl(i,s)||(e.uniform1iv(this.addr,s),sl(i,s));for(let o=0;o!==r;++o)n.setTexture3D(t[o]||Ja,s[o])}function Xl(e,t,n){const i=this.cache,r=t.length,s=ol(n,r);rl(i,s)||(e.uniform1iv(this.addr,s),sl(i,s));for(let o=0;o!==r;++o)n.setTextureCube(t[o]||ja,s[o])}function Yl(e,t,n){const i=this.cache,r=t.length,s=ol(n,r);rl(i,s)||(e.uniform1iv(this.addr,s),sl(i,s));for(let o=0;o!==r;++o)n.setTexture2DArray(t[o]||Oa,s[o])}class zl{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=function(e){switch(e){case 5126:return al;case 35664:return ll;case 35665:return cl;case 35666:return gl;case 35674:return ul;case 35675:return Al;case 35676:return dl;case 5124:case 35670:return hl;case 35667:case 35671:return Il;case 35668:case 35672:return pl;case 35669:case 35673:return Cl;case 5125:return ml;case 36294:return fl;case 36295:return yl;case 36296:return bl;case 35678:case 36198:case 36298:case 36306:case 35682:return Bl;case 35679:case 36299:case 36307:return vl;case 35680:case 36300:case 36308:case 36293:return wl;case 36289:case 36303:case 36311:case 36292:return Gl}}(t.type)}}class Pl{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return El;case 35664:return xl;case 35665:return Sl;case 35666:return Rl;case 35674:return Zl;case 35675:return Dl;case 35676:return Fl;case 5124:case 35670:return Nl;case 35667:case 35671:return Ml;case 35668:case 35672:return Wl;case 35669:case 35673:return kl;case 5125:return Tl;case 36294:return Vl;case 36295:return Ll;case 36296:return Hl;case 35678:case 36198:case 36298:case 36306:case 35682:return Ql;case 35679:case 36299:case 36307:return Kl;case 35680:case 36300:case 36308:case 36293:return Xl;case 36289:case 36303:case 36311:case 36292:return Yl}}(t.type)}}class Ul{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const i=this.seq;for(let r=0,s=i.length;r!==s;++r){const s=i[r];s.setValue(e,t[s.id],n)}}}const _l=/(\w+)(\])?(\[|\.)?/g;function Ol(e,t){e.seq.push(t),e.map[t.id]=t}function Jl(e,t,n){const i=e.name,r=i.length;for(_l.lastIndex=0;;){const s=_l.exec(i),o=_l.lastIndex;let a=s[1];const l="]"===s[2],c=s[3];if(l&&(a|=0),void 0===c||"["===c&&o+2===r){Ol(n,void 0===c?new zl(a,e,t):new Pl(a,e,t));break}{let e=n.map[a];void 0===e&&(e=new Ul(a),Ol(n,e)),n=e}}}class jl{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){const n=e.getActiveUniform(t,i);Jl(n,e.getUniformLocation(t,n.name),this)}}setValue(e,t,n,i){const r=this.map[t];void 0!==r&&r.setValue(e,n,i)}setOptional(e,t,n){const i=t[n];void 0!==i&&this.setValue(e,n,i)}static upload(e,t,n,i){for(let r=0,s=t.length;r!==s;++r){const s=t[r],o=n[s.id];!1!==o.needsUpdate&&s.setValue(e,o.value,i)}}static seqWithValue(e,t){const n=[];for(let i=0,r=e.length;i!==r;++i){const r=e[i];r.id in t&&n.push(r)}return n}}function ql(e,t,n){const i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),i}const $l=37297;let ec=0;function tc(e,t,n){const i=e.getShaderParameter(t,e.COMPILE_STATUS),r=e.getShaderInfoLog(t).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const i=parseInt(s[1]);return n.toUpperCase()+"\n\n"+r+"\n\n"+function(e,t){const n=e.split("\n"),i=[],r=Math.max(t-6,0),s=Math.min(t+6,n.length);for(let o=r;o<s;o++){const e=o+1;i.push("".concat(e===t?">":" "," ").concat(e,": ").concat(n[o]))}return i.join("\n")}(e.getShaderSource(t),i)}return r}function nc(e,t){const n=function(e){const t=cr.getPrimaries(cr.workingColorSpace),n=cr.getPrimaries(e);let i;switch(t===n?i="":t===Jn&&n===On?i="LinearDisplayP3ToLinearSRGB":t===On&&n===Jn&&(i="LinearSRGBToLinearDisplayP3"),e){case Yn:case Pn:return[i,"LinearTransferOETF"];case Xn:case zn:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",e),[i,"LinearTransferOETF"]}}(t);return"vec4 ".concat(e,"( vec4 value ) { return ").concat(n[0],"( ").concat(n[1],"( value ) ); }")}function ic(e,t){let n;switch(t){case _e:n="Linear";break;case Oe:n="Reinhard";break;case Je:n="OptimizedCineon";break;case je:n="ACESFilmic";break;case $e:n="AgX";break;case qe:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function rc(e){return""!==e}function sc(e,t){const n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function oc(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const ac=/^[ \t]*#include +<([\w\d./]+)>/gm;function lc(e){return e.replace(ac,gc)}const cc=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function gc(e,t){let n=ua[t];if(void 0===n){const e=cc.get(t);if(void 0===e)throw new Error("Can not resolve #include <"+t+">");n=ua[e],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,e)}return lc(n)}const uc=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Ac(e){return e.replace(uc,dc)}function dc(e,t,n,i){let r="";for(let s=parseInt(t);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function hc(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Ic(e,t,n,i){const r=e.getContext(),s=n.defines;let o=n.vertexShader,a=n.fragmentShader;const l=function(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===ie?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===re?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===se&&(t="SHADOWMAP_TYPE_VSM"),t}(n),c=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case it:case rt:t="ENVMAP_TYPE_CUBE";break;case at:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),g=function(e){let t="ENVMAP_MODE_REFLECTION";e.envMap&&e.envMapMode===rt&&(t="ENVMAP_MODE_REFRACTION");return t}(n),u=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case Ye:t="ENVMAP_BLENDING_MULTIPLY";break;case ze:t="ENVMAP_BLENDING_MIX";break;case Pe:t="ENVMAP_BLENDING_ADD"}return t}(n),A=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const n=Math.log2(t)-2,i=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:i,maxMip:n}}(n),d=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.normalMapTangentSpace||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(rc).join("\n")}(n),h=function(e){return[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":""].filter(rc).join("\n")}(n),I=function(e){const t=[];for(const n in e){const i=e[n];!1!==i&&t.push("#define "+n+" "+i)}return t.join("\n")}(s),p=r.createProgram();let C,m,f=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(C=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,I].filter(rc).join("\n"),C.length>0&&(C+="\n"),m=[d,"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,I].filter(rc).join("\n"),m.length>0&&(m+="\n")):(C=[hc(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,I,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+g:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(rc).join("\n"),m=[d,hc(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,I,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+g:"",n.envMap?"#define "+u:"",A?"#define CUBEUV_TEXEL_WIDTH "+A.texelWidth:"",A?"#define CUBEUV_TEXEL_HEIGHT "+A.texelHeight:"",A?"#define CUBEUV_MAX_MIP "+A.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Ue?"#define TONE_MAPPING":"",n.toneMapping!==Ue?ua.tonemapping_pars_fragment:"",n.toneMapping!==Ue?ic("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",ua.colorspace_pars_fragment,nc("linearToOutputTexel",n.outputColorSpace),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(rc).join("\n")),o=lc(o),o=sc(o,n),o=oc(o,n),a=lc(a),a=sc(a,n),a=oc(a,n),o=Ac(o),a=Ac(a),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(f="#version 300 es\n",C=[h,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+C,m=["precision mediump sampler2DArray;","#define varying in",n.glslVersion===Di?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Di?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+m);const y=f+C+o,b=f+m+a,B=ql(r,r.VERTEX_SHADER,y),v=ql(r,r.FRAGMENT_SHADER,b);function w(t){if(e.debug.checkShaderErrors){const n=r.getProgramInfoLog(p).trim(),i=r.getShaderInfoLog(B).trim(),s=r.getShaderInfoLog(v).trim();let o=!0,a=!0;if(!1===r.getProgramParameter(p,r.LINK_STATUS))if(o=!1,"function"===typeof e.debug.onShaderError)e.debug.onShaderError(r,p,B,v);else{const e=tc(r,B,"vertex"),t=tc(r,v,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(p,r.VALIDATE_STATUS)+"\n\nProgram Info Log: "+n+"\n"+e+"\n"+t)}else""!==n?console.warn("THREE.WebGLProgram: Program Info Log:",n):""!==i&&""!==s||(a=!1);a&&(t.diagnostics={runnable:o,programLog:n,vertexShader:{log:i,prefix:C},fragmentShader:{log:s,prefix:m}})}r.deleteShader(B),r.deleteShader(v),G=new jl(r,p),E=function(e,t){const n={},i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const i=e.getActiveAttrib(t,r),s=i.name;let o=1;i.type===e.FLOAT_MAT2&&(o=2),i.type===e.FLOAT_MAT3&&(o=3),i.type===e.FLOAT_MAT4&&(o=4),n[s]={type:i.type,location:e.getAttribLocation(t,s),locationSize:o}}return n}(r,p)}let G,E;r.attachShader(p,B),r.attachShader(p,v),void 0!==n.index0AttributeName?r.bindAttribLocation(p,0,n.index0AttributeName):!0===n.morphTargets&&r.bindAttribLocation(p,0,"position"),r.linkProgram(p),this.getUniforms=function(){return void 0===G&&w(this),G},this.getAttributes=function(){return void 0===E&&w(this),E};let x=!1===n.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===x&&(x=r.getProgramParameter(p,$l)),x},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(p),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=ec++,this.cacheKey=t,this.usedTimes=1,this.program=p,this.vertexShader=B,this.fragmentShader=v,this}let pc=0;class Cc{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,i=this._getShaderStage(t),r=this._getShaderStage(n),s=this._getShaderCacheForMaterial(e);return!1===s.has(i)&&(s.add(i),i.usedTimes++),!1===s.has(r)&&(s.add(r),r.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new mc(e),t.set(e,n)),n}}class mc{constructor(e){this.id=pc++,this.code=e,this.usedTimes=0}}function fc(e,t,n,i,r,s,o){const a=new Is,l=new Cc,c=[],g=r.isWebGL2,u=r.logarithmicDepthBuffer,A=r.vertexTextures;let d=r.precision;const h={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function I(e){return 0===e?"uv":"uv".concat(e)}return{getParameters:function(s,a,c,p,C){const m=p.fog,f=C.geometry,y=s.isMeshStandardMaterial?p.environment:null,b=(s.isMeshStandardMaterial?n:t).get(s.envMap||y),B=b&&b.mapping===at?b.image.height:null,v=h[s.type];null!==s.precision&&(d=r.getMaxPrecision(s.precision),d!==s.precision&&console.warn("THREE.WebGLProgram.getParameters:",s.precision,"not supported, using",d,"instead."));const w=f.morphAttributes.position||f.morphAttributes.normal||f.morphAttributes.color,G=void 0!==w?w.length:0;let E,x,S,R,Z=0;if(void 0!==f.morphAttributes.position&&(Z=1),void 0!==f.morphAttributes.normal&&(Z=2),void 0!==f.morphAttributes.color&&(Z=3),v){const e=da[v];E=e.vertexShader,x=e.fragmentShader}else E=s.vertexShader,x=s.fragmentShader,l.update(s),S=l.getVertexShaderID(s),R=l.getFragmentShaderID(s);const D=e.getRenderTarget(),F=!0===C.isInstancedMesh,N=!0===C.isBatchedMesh,M=!!s.map,W=!!s.matcap,k=!!b,T=!!s.aoMap,V=!!s.lightMap,L=!!s.bumpMap,H=!!s.normalMap,Q=!!s.displacementMap,K=!!s.emissiveMap,X=!!s.metalnessMap,Y=!!s.roughnessMap,z=s.anisotropy>0,P=s.clearcoat>0,U=s.iridescence>0,_=s.sheen>0,O=s.transmission>0,J=z&&!!s.anisotropyMap,j=P&&!!s.clearcoatMap,q=P&&!!s.clearcoatNormalMap,$=P&&!!s.clearcoatRoughnessMap,ee=U&&!!s.iridescenceMap,te=U&&!!s.iridescenceThicknessMap,ne=_&&!!s.sheenColorMap,ie=_&&!!s.sheenRoughnessMap,re=!!s.specularMap,se=!!s.specularColorMap,oe=!!s.specularIntensityMap,ce=O&&!!s.transmissionMap,ge=O&&!!s.thicknessMap,Ae=!!s.gradientMap,de=!!s.alphaMap,he=s.alphaTest>0,Ie=!!s.alphaHash,pe=!!s.extensions,Ce=!!f.attributes.uv1,me=!!f.attributes.uv2,fe=!!f.attributes.uv3;let ye=Ue;return s.toneMapped&&(null!==D&&!0!==D.isXRRenderTarget||(ye=e.toneMapping)),{isWebGL2:g,shaderID:v,shaderType:s.type,shaderName:s.name,vertexShader:E,fragmentShader:x,defines:s.defines,customVertexShaderID:S,customFragmentShaderID:R,isRawShaderMaterial:!0===s.isRawShaderMaterial,glslVersion:s.glslVersion,precision:d,batching:N,instancing:F,instancingColor:F&&null!==C.instanceColor,supportsVertexTextures:A,outputColorSpace:null===D?e.outputColorSpace:!0===D.isXRRenderTarget?D.texture.colorSpace:Yn,map:M,matcap:W,envMap:k,envMapMode:k&&b.mapping,envMapCubeUVHeight:B,aoMap:T,lightMap:V,bumpMap:L,normalMap:H,displacementMap:A&&Q,emissiveMap:K,normalMapObjectSpace:H&&s.normalMapType===Qn,normalMapTangentSpace:H&&s.normalMapType===Hn,metalnessMap:X,roughnessMap:Y,anisotropy:z,anisotropyMap:J,clearcoat:P,clearcoatMap:j,clearcoatNormalMap:q,clearcoatRoughnessMap:$,iridescence:U,iridescenceMap:ee,iridescenceThicknessMap:te,sheen:_,sheenColorMap:ne,sheenRoughnessMap:ie,specularMap:re,specularColorMap:se,specularIntensityMap:oe,transmission:O,transmissionMap:ce,thicknessMap:ge,gradientMap:Ae,opaque:!1===s.transparent&&s.blending===ue,alphaMap:de,alphaTest:he,alphaHash:Ie,combine:s.combine,mapUv:M&&I(s.map.channel),aoMapUv:T&&I(s.aoMap.channel),lightMapUv:V&&I(s.lightMap.channel),bumpMapUv:L&&I(s.bumpMap.channel),normalMapUv:H&&I(s.normalMap.channel),displacementMapUv:Q&&I(s.displacementMap.channel),emissiveMapUv:K&&I(s.emissiveMap.channel),metalnessMapUv:X&&I(s.metalnessMap.channel),roughnessMapUv:Y&&I(s.roughnessMap.channel),anisotropyMapUv:J&&I(s.anisotropyMap.channel),clearcoatMapUv:j&&I(s.clearcoatMap.channel),clearcoatNormalMapUv:q&&I(s.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:$&&I(s.clearcoatRoughnessMap.channel),iridescenceMapUv:ee&&I(s.iridescenceMap.channel),iridescenceThicknessMapUv:te&&I(s.iridescenceThicknessMap.channel),sheenColorMapUv:ne&&I(s.sheenColorMap.channel),sheenRoughnessMapUv:ie&&I(s.sheenRoughnessMap.channel),specularMapUv:re&&I(s.specularMap.channel),specularColorMapUv:se&&I(s.specularColorMap.channel),specularIntensityMapUv:oe&&I(s.specularIntensityMap.channel),transmissionMapUv:ce&&I(s.transmissionMap.channel),thicknessMapUv:ge&&I(s.thicknessMap.channel),alphaMapUv:de&&I(s.alphaMap.channel),vertexTangents:!!f.attributes.tangent&&(H||z),vertexColors:s.vertexColors,vertexAlphas:!0===s.vertexColors&&!!f.attributes.color&&4===f.attributes.color.itemSize,vertexUv1s:Ce,vertexUv2s:me,vertexUv3s:fe,pointsUvs:!0===C.isPoints&&!!f.attributes.uv&&(M||de),fog:!!m,useFog:!0===s.fog,fogExp2:m&&m.isFogExp2,flatShading:!0===s.flatShading,sizeAttenuation:!0===s.sizeAttenuation,logarithmicDepthBuffer:u,skinning:!0===C.isSkinnedMesh,morphTargets:void 0!==f.morphAttributes.position,morphNormals:void 0!==f.morphAttributes.normal,morphColors:void 0!==f.morphAttributes.color,morphTargetsCount:G,morphTextureStride:Z,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numSpotLightMaps:a.spotLightMap.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numDirLightShadows:a.directionalShadowMap.length,numPointLightShadows:a.pointShadowMap.length,numSpotLightShadows:a.spotShadowMap.length,numSpotLightShadowsWithMaps:a.numSpotLightShadowsWithMaps,numLightProbes:a.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:s.dithering,shadowMapEnabled:e.shadowMap.enabled&&c.length>0,shadowMapType:e.shadowMap.type,toneMapping:ye,useLegacyLights:e._useLegacyLights,decodeVideoTexture:M&&!0===s.map.isVideoTexture&&cr.getTransfer(s.map.colorSpace)===_n,premultipliedAlpha:s.premultipliedAlpha,doubleSided:s.side===le,flipSided:s.side===ae,useDepthPacking:s.depthPacking>=0,depthPacking:s.depthPacking||0,index0AttributeName:s.index0AttributeName,extensionDerivatives:pe&&!0===s.extensions.derivatives,extensionFragDepth:pe&&!0===s.extensions.fragDepth,extensionDrawBuffers:pe&&!0===s.extensions.drawBuffers,extensionShaderTextureLOD:pe&&!0===s.extensions.shaderTextureLOD,extensionClipCullDistance:pe&&s.extensions.clipCullDistance&&i.has("WEBGL_clip_cull_distance"),rendererExtensionFragDepth:g||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:g||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:g||i.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:s.customProgramCacheKey()}},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(!function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.numLightProbes),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){a.disableAll(),t.isWebGL2&&a.enable(0);t.supportsVertexTextures&&a.enable(1);t.instancing&&a.enable(2);t.instancingColor&&a.enable(3);t.matcap&&a.enable(4);t.envMap&&a.enable(5);t.normalMapObjectSpace&&a.enable(6);t.normalMapTangentSpace&&a.enable(7);t.clearcoat&&a.enable(8);t.iridescence&&a.enable(9);t.alphaTest&&a.enable(10);t.vertexColors&&a.enable(11);t.vertexAlphas&&a.enable(12);t.vertexUv1s&&a.enable(13);t.vertexUv2s&&a.enable(14);t.vertexUv3s&&a.enable(15);t.vertexTangents&&a.enable(16);t.anisotropy&&a.enable(17);t.alphaHash&&a.enable(18);t.batching&&a.enable(19);e.push(a.mask),a.disableAll(),t.fog&&a.enable(0);t.useFog&&a.enable(1);t.flatShading&&a.enable(2);t.logarithmicDepthBuffer&&a.enable(3);t.skinning&&a.enable(4);t.morphTargets&&a.enable(5);t.morphNormals&&a.enable(6);t.morphColors&&a.enable(7);t.premultipliedAlpha&&a.enable(8);t.shadowMapEnabled&&a.enable(9);t.useLegacyLights&&a.enable(10);t.doubleSided&&a.enable(11);t.flipSided&&a.enable(12);t.useDepthPacking&&a.enable(13);t.dithering&&a.enable(14);t.transmission&&a.enable(15);t.sheen&&a.enable(16);t.opaque&&a.enable(17);t.pointsUvs&&a.enable(18);t.decodeVideoTexture&&a.enable(19);e.push(a.mask)}(n,t),n.push(e.outputColorSpace)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=h[e.type];let n;if(t){const e=da[t];n=Uo.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let i;for(let e=0,r=c.length;e<r;e++){const t=c[e];if(t.cacheKey===n){i=t,++i.usedTimes;break}}return void 0===i&&(i=new Ic(e,n,t,s),c.push(i)),i},releaseProgram:function(e){if(0===--e.usedTimes){const t=c.indexOf(e);c[t]=c[c.length-1],c.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:c,dispose:function(){l.dispose()}}}function yc(){let e=new WeakMap;return{get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,i){e.get(t)[n]=i},dispose:function(){e=new WeakMap}}}function bc(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Bc(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function vc(){const e=[];let t=0;const n=[],i=[],r=[];function s(n,i,r,s,o,a){let l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:i,material:r,groupOrder:s,renderOrder:n.renderOrder,z:o,group:a},e[t]=l):(l.id=n.id,l.object=n,l.geometry=i,l.material=r,l.groupOrder=s,l.renderOrder=n.renderOrder,l.z=o,l.group=a),t++,l}return{opaque:n,transmissive:i,transparent:r,init:function(){t=0,n.length=0,i.length=0,r.length=0},push:function(e,t,o,a,l,c){const g=s(e,t,o,a,l,c);o.transmission>0?i.push(g):!0===o.transparent?r.push(g):n.push(g)},unshift:function(e,t,o,a,l,c){const g=s(e,t,o,a,l,c);o.transmission>0?i.unshift(g):!0===o.transparent?r.unshift(g):n.unshift(g)},finish:function(){for(let n=t,i=e.length;n<i;n++){const t=e[n];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){n.length>1&&n.sort(e||bc),i.length>1&&i.sort(t||Bc),r.length>1&&r.sort(t||Bc)}}}function wc(){let e=new WeakMap;return{get:function(t,n){const i=e.get(t);let r;return void 0===i?(r=new vc,e.set(t,[r])):n>=i.length?(r=new vc,i.push(r)):r=i[n],r},dispose:function(){e=new WeakMap}}}function Gc(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new Sr,color:new Ps};break;case"SpotLight":n={position:new Sr,direction:new Sr,color:new Ps,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Sr,color:new Ps,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Sr,skyColor:new Ps,groundColor:new Ps};break;case"RectAreaLight":n={color:new Ps,position:new Sr,halfWidth:new Sr,halfHeight:new Sr}}return e[t.id]=n,n}}}let Ec=0;function xc(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function Sc(e,t){const n=new Gc,i=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Oi};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Oi,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let l=0;l<9;l++)r.probe.push(new Sr);const s=new Sr,o=new rs,a=new rs;return{setup:function(s,o){let a=0,l=0,c=0;for(let e=0;e<9;e++)r.probe[e].set(0,0,0);let g=0,u=0,A=0,d=0,h=0,I=0,p=0,C=0,m=0,f=0,y=0;s.sort(xc);const b=!0===o?Math.PI:1;for(let e=0,t=s.length;e<t;e++){const t=s[e],o=t.color,B=t.intensity,v=t.distance,w=t.shadow&&t.shadow.map?t.shadow.map.texture:null;if(t.isAmbientLight)a+=o.r*B*b,l+=o.g*B*b,c+=o.b*B*b;else if(t.isLightProbe){for(let e=0;e<9;e++)r.probe[e].addScaledVector(t.sh.coefficients[e],B);y++}else if(t.isDirectionalLight){const e=n.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*b),t.castShadow){const e=t.shadow,n=i.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,r.directionalShadow[g]=n,r.directionalShadowMap[g]=w,r.directionalShadowMatrix[g]=t.shadow.matrix,I++}r.directional[g]=e,g++}else if(t.isSpotLight){const e=n.get(t);e.position.setFromMatrixPosition(t.matrixWorld),e.color.copy(o).multiplyScalar(B*b),e.distance=v,e.coneCos=Math.cos(t.angle),e.penumbraCos=Math.cos(t.angle*(1-t.penumbra)),e.decay=t.decay,r.spot[A]=e;const s=t.shadow;if(t.map&&(r.spotLightMap[m]=t.map,m++,s.updateMatrices(t),t.castShadow&&f++),r.spotLightMatrix[A]=s.matrix,t.castShadow){const e=i.get(t);e.shadowBias=s.bias,e.shadowNormalBias=s.normalBias,e.shadowRadius=s.radius,e.shadowMapSize=s.mapSize,r.spotShadow[A]=e,r.spotShadowMap[A]=w,C++}A++}else if(t.isRectAreaLight){const e=n.get(t);e.color.copy(o).multiplyScalar(B),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),r.rectArea[d]=e,d++}else if(t.isPointLight){const e=n.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*b),e.distance=t.distance,e.decay=t.decay,t.castShadow){const e=t.shadow,n=i.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,n.shadowCameraNear=e.camera.near,n.shadowCameraFar=e.camera.far,r.pointShadow[u]=n,r.pointShadowMap[u]=w,r.pointShadowMatrix[u]=t.shadow.matrix,p++}r.point[u]=e,u++}else if(t.isHemisphereLight){const e=n.get(t);e.skyColor.copy(t.color).multiplyScalar(B*b),e.groundColor.copy(t.groundColor).multiplyScalar(B*b),r.hemi[h]=e,h++}}d>0&&(t.isWebGL2?!0===e.has("OES_texture_float_linear")?(r.rectAreaLTC1=Aa.LTC_FLOAT_1,r.rectAreaLTC2=Aa.LTC_FLOAT_2):(r.rectAreaLTC1=Aa.LTC_HALF_1,r.rectAreaLTC2=Aa.LTC_HALF_2):!0===e.has("OES_texture_float_linear")?(r.rectAreaLTC1=Aa.LTC_FLOAT_1,r.rectAreaLTC2=Aa.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=Aa.LTC_HALF_1,r.rectAreaLTC2=Aa.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=a,r.ambient[1]=l,r.ambient[2]=c;const B=r.hash;B.directionalLength===g&&B.pointLength===u&&B.spotLength===A&&B.rectAreaLength===d&&B.hemiLength===h&&B.numDirectionalShadows===I&&B.numPointShadows===p&&B.numSpotShadows===C&&B.numSpotMaps===m&&B.numLightProbes===y||(r.directional.length=g,r.spot.length=A,r.rectArea.length=d,r.point.length=u,r.hemi.length=h,r.directionalShadow.length=I,r.directionalShadowMap.length=I,r.pointShadow.length=p,r.pointShadowMap.length=p,r.spotShadow.length=C,r.spotShadowMap.length=C,r.directionalShadowMatrix.length=I,r.pointShadowMatrix.length=p,r.spotLightMatrix.length=C+m-f,r.spotLightMap.length=m,r.numSpotLightShadowsWithMaps=f,r.numLightProbes=y,B.directionalLength=g,B.pointLength=u,B.spotLength=A,B.rectAreaLength=d,B.hemiLength=h,B.numDirectionalShadows=I,B.numPointShadows=p,B.numSpotShadows=C,B.numSpotMaps=m,B.numLightProbes=y,r.version=Ec++)},setupView:function(e,t){let n=0,i=0,l=0,c=0,g=0;const u=t.matrixWorldInverse;for(let A=0,d=e.length;A<d;A++){const t=e[A];if(t.isDirectionalLight){const e=r.directional[n];e.direction.setFromMatrixPosition(t.matrixWorld),s.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(s),e.direction.transformDirection(u),n++}else if(t.isSpotLight){const e=r.spot[l];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(u),e.direction.setFromMatrixPosition(t.matrixWorld),s.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(s),e.direction.transformDirection(u),l++}else if(t.isRectAreaLight){const e=r.rectArea[c];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(u),a.identity(),o.copy(t.matrixWorld),o.premultiply(u),a.extractRotation(o),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),e.halfWidth.applyMatrix4(a),e.halfHeight.applyMatrix4(a),c++}else if(t.isPointLight){const e=r.point[i];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(u),i++}else if(t.isHemisphereLight){const e=r.hemi[g];e.direction.setFromMatrixPosition(t.matrixWorld),e.direction.transformDirection(u),g++}}},state:r}}function Rc(e,t){const n=new Sc(e,t),i=[],r=[];return{init:function(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:n},setupLights:function(e){n.setup(i,e)},setupLightsView:function(e){n.setupView(i,e)},pushLight:function(e){i.push(e)},pushShadow:function(e){r.push(e)}}}function Zc(e,t){let n=new WeakMap;return{get:function(i){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const s=n.get(i);let o;return void 0===s?(o=new Rc(e,t),n.set(i,[o])):r>=s.length?(o=new Rc(e,t),s.push(o)):o=s[r],o},dispose:function(){n=new WeakMap}}}class Dc extends Os{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Vn,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Fc extends Os{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function Nc(e,t,n){let i=new aa;const r=new Oi,s=new Oi,o=new fr,a=new Dc({depthPacking:Ln}),l=new Fc,c={},g=n.maxTextureSize,u={[oe]:ae,[ae]:oe,[le]:le},A=new _o({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Oi},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),d=A.clone();d.defines.HORIZONTAL_PASS=1;const h=new vo;h.setAttribute("position",new ro(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const I=new Qo(h,A),p=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=ie;let C=this.type;function m(n,i){const s=t.update(I);A.defines.VSM_SAMPLES!==n.blurSamples&&(A.defines.VSM_SAMPLES=n.blurSamples,d.defines.VSM_SAMPLES=n.blurSamples,A.needsUpdate=!0,d.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new br(r.x,r.y)),A.uniforms.shadow_pass.value=n.map.texture,A.uniforms.resolution.value=n.mapSize,A.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(i,null,s,A,I,null),d.uniforms.shadow_pass.value=n.mapPass.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(i,null,s,d,I,null)}function f(t,n,i,r){let s=null;const o=!0===i.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==o)s=o;else if(s=!0===i.isPointLight?l:a,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0){const e=s.uuid,t=n.uuid;let i=c[e];void 0===i&&(i={},c[e]=i);let r=i[t];void 0===r&&(r=s.clone(),i[t]=r,n.addEventListener("dispose",b)),s=r}if(s.visible=n.visible,s.wireframe=n.wireframe,s.side=r===se?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:u[n.side],s.alphaMap=n.alphaMap,s.alphaTest=n.alphaTest,s.map=n.map,s.clipShadows=n.clipShadows,s.clippingPlanes=n.clippingPlanes,s.clipIntersection=n.clipIntersection,s.displacementMap=n.displacementMap,s.displacementScale=n.displacementScale,s.displacementBias=n.displacementBias,s.wireframeLinewidth=n.wireframeLinewidth,s.linewidth=n.linewidth,!0===i.isPointLight&&!0===s.isMeshDistanceMaterial){e.properties.get(s).light=i}return s}function y(n,r,s,o,a){if(!1===n.visible)return;if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&a===se)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,n.matrixWorld);const i=t.update(n),l=n.material;if(Array.isArray(l)){const t=i.groups;for(let c=0,g=t.length;c<g;c++){const g=t[c],u=l[g.materialIndex];if(u&&u.visible){const t=f(n,u,o,a);n.onBeforeShadow(e,n,r,s,i,t,g),e.renderBufferDirect(s,null,i,t,n,g),n.onAfterShadow(e,n,r,s,i,t,g)}}}else if(l.visible){const t=f(n,l,o,a);n.onBeforeShadow(e,n,r,s,i,t,null),e.renderBufferDirect(s,null,i,t,n,null),n.onAfterShadow(e,n,r,s,i,t,null)}}const l=n.children;for(let e=0,t=l.length;e<t;e++)y(l[e],r,s,o,a)}function b(e){e.target.removeEventListener("dispose",b);for(const t in c){const n=c[t],i=e.target.uuid;if(i in n){n[i].dispose(),delete n[i]}}}this.render=function(t,n,a){if(!1===p.enabled)return;if(!1===p.autoUpdate&&!1===p.needsUpdate)return;if(0===t.length)return;const l=e.getRenderTarget(),c=e.getActiveCubeFace(),u=e.getActiveMipmapLevel(),A=e.state;A.setBlending(ge),A.buffers.color.setClear(1,1,1,1),A.buffers.depth.setTest(!0),A.setScissorTest(!1);const d=C!==se&&this.type===se,h=C===se&&this.type!==se;for(let I=0,p=t.length;I<p;I++){const l=t[I],c=l.shadow;if(void 0===c){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;r.copy(c.mapSize);const u=c.getFrameExtents();if(r.multiply(u),s.copy(c.mapSize),(r.x>g||r.y>g)&&(r.x>g&&(s.x=Math.floor(g/u.x),r.x=s.x*u.x,c.mapSize.x=s.x),r.y>g&&(s.y=Math.floor(g/u.y),r.y=s.y*u.y,c.mapSize.y=s.y)),null===c.map||!0===d||!0===h){const e=this.type!==se?{minFilter:ut,magFilter:ut}:{};null!==c.map&&c.map.dispose(),c.map=new br(r.x,r.y,e),c.map.texture.name=l.name+".shadowMap",c.camera.updateProjectionMatrix()}e.setRenderTarget(c.map),e.clear();const p=c.getViewportCount();for(let e=0;e<p;e++){const t=c.getViewport(e);o.set(s.x*t.x,s.y*t.y,s.x*t.z,s.y*t.w),A.viewport(o),c.updateMatrices(l,e),i=c.getFrustum(),y(n,a,c.camera,l,this.type)}!0!==c.isPointLightShadow&&this.type===se&&m(c,a),c.needsUpdate=!1}C=this.type,p.needsUpdate=!1,e.setRenderTarget(l,c,u)}}function Mc(e,t,n){const i=n.isWebGL2;const r=new function(){let t=!1;const n=new fr;let i=null;const r=new fr(0,0,0,0);return{setMask:function(n){i===n||t||(e.colorMask(n,n,n,n),i=n)},setLocked:function(e){t=e},setClear:function(t,i,s,o,a){!0===a&&(t*=o,i*=o,s*=o),n.set(t,i,s,o),!1===r.equals(n)&&(e.clearColor(t,i,s,o),r.copy(n))},reset:function(){t=!1,i=null,r.set(-1,0,0,0)}}},s=new function(){let t=!1,n=null,i=null,r=null;return{setTest:function(t){t?K(e.DEPTH_TEST):X(e.DEPTH_TEST)},setMask:function(i){n===i||t||(e.depthMask(i),n=i)},setFunc:function(t){if(i!==t){switch(t){case ke:e.depthFunc(e.NEVER);break;case Te:e.depthFunc(e.ALWAYS);break;case Ve:e.depthFunc(e.LESS);break;case Le:e.depthFunc(e.LEQUAL);break;case He:e.depthFunc(e.EQUAL);break;case Qe:e.depthFunc(e.GEQUAL);break;case Ke:e.depthFunc(e.GREATER);break;case Xe:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}i=t}},setLocked:function(e){t=e},setClear:function(t){r!==t&&(e.clearDepth(t),r=t)},reset:function(){t=!1,n=null,i=null,r=null}}},o=new function(){let t=!1,n=null,i=null,r=null,s=null,o=null,a=null,l=null,c=null;return{setTest:function(n){t||(n?K(e.STENCIL_TEST):X(e.STENCIL_TEST))},setMask:function(i){n===i||t||(e.stencilMask(i),n=i)},setFunc:function(t,n,o){i===t&&r===n&&s===o||(e.stencilFunc(t,n,o),i=t,r=n,s=o)},setOp:function(t,n,i){o===t&&a===n&&l===i||(e.stencilOp(t,n,i),o=t,a=n,l=i)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,i=null,r=null,s=null,o=null,a=null,l=null,c=null}}},a=new WeakMap,l=new WeakMap;let c={},g={},u=new WeakMap,A=[],d=null,h=!1,I=null,p=null,C=null,m=null,f=null,y=null,b=null,B=new Ps(0,0,0),v=0,w=!1,G=null,E=null,x=null,S=null,R=null;const Z=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let D=!1,F=0;const N=e.getParameter(e.VERSION);-1!==N.indexOf("WebGL")?(F=parseFloat(/^WebGL (\d)/.exec(N)[1]),D=F>=1):-1!==N.indexOf("OpenGL ES")&&(F=parseFloat(/^OpenGL ES (\d)/.exec(N)[1]),D=F>=2);let M=null,W={};const k=e.getParameter(e.SCISSOR_BOX),T=e.getParameter(e.VIEWPORT),V=(new fr).fromArray(k),L=(new fr).fromArray(T);function H(t,n,r,s){const o=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let l=0;l<r;l++)!i||t!==e.TEXTURE_3D&&t!==e.TEXTURE_2D_ARRAY?e.texImage2D(n+l,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,o):e.texImage3D(n,0,e.RGBA,1,1,s,0,e.RGBA,e.UNSIGNED_BYTE,o);return a}const Q={};function K(t){!0!==c[t]&&(e.enable(t),c[t]=!0)}function X(t){!1!==c[t]&&(e.disable(t),c[t]=!1)}Q[e.TEXTURE_2D]=H(e.TEXTURE_2D,e.TEXTURE_2D,1),Q[e.TEXTURE_CUBE_MAP]=H(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(Q[e.TEXTURE_2D_ARRAY]=H(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),Q[e.TEXTURE_3D]=H(e.TEXTURE_3D,e.TEXTURE_3D,1,1)),r.setClear(0,0,0,1),s.setClear(1),o.setClear(0),K(e.DEPTH_TEST),s.setFunc(Le),U(!1),_($),K(e.CULL_FACE),P(ge);const Y={[pe]:e.FUNC_ADD,[Ce]:e.FUNC_SUBTRACT,[me]:e.FUNC_REVERSE_SUBTRACT};if(i)Y[fe]=e.MIN,Y[ye]=e.MAX;else{const e=t.get("EXT_blend_minmax");null!==e&&(Y[fe]=e.MIN_EXT,Y[ye]=e.MAX_EXT)}const z={[be]:e.ZERO,[Be]:e.ONE,[ve]:e.SRC_COLOR,[Ge]:e.SRC_ALPHA,[De]:e.SRC_ALPHA_SATURATE,[Re]:e.DST_COLOR,[xe]:e.DST_ALPHA,[we]:e.ONE_MINUS_SRC_COLOR,[Ee]:e.ONE_MINUS_SRC_ALPHA,[Ze]:e.ONE_MINUS_DST_COLOR,[Se]:e.ONE_MINUS_DST_ALPHA,[Fe]:e.CONSTANT_COLOR,[Ne]:e.ONE_MINUS_CONSTANT_COLOR,[Me]:e.CONSTANT_ALPHA,[We]:e.ONE_MINUS_CONSTANT_ALPHA};function P(t,n,i,r,s,o,a,l,c,g){if(t!==ge){if(!1===h&&(K(e.BLEND),h=!0),t===Ie)s=s||n,o=o||i,a=a||r,n===p&&s===f||(e.blendEquationSeparate(Y[n],Y[s]),p=n,f=s),i===C&&r===m&&o===y&&a===b||(e.blendFuncSeparate(z[i],z[r],z[o],z[a]),C=i,m=r,y=o,b=a),!1!==l.equals(B)&&c===v||(e.blendColor(l.r,l.g,l.b,c),B.copy(l),v=c),I=t,w=!1;else if(t!==I||g!==w){if(p===pe&&f===pe||(e.blendEquation(e.FUNC_ADD),p=pe,f=pe),g)switch(t){case ue:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case Ae:e.blendFunc(e.ONE,e.ONE);break;case de:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case he:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case ue:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case Ae:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case de:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case he:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}C=null,m=null,y=null,b=null,B.set(0,0,0),v=0,I=t,w=g}}else!0===h&&(X(e.BLEND),h=!1)}function U(t){G!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),G=t)}function _(t){t!==q?(K(e.CULL_FACE),t!==E&&(t===$?e.cullFace(e.BACK):t===ee?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):X(e.CULL_FACE),E=t}function O(t,n,i){t?(K(e.POLYGON_OFFSET_FILL),S===n&&R===i||(e.polygonOffset(n,i),S=n,R=i)):X(e.POLYGON_OFFSET_FILL)}return{buffers:{color:r,depth:s,stencil:o},enable:K,disable:X,bindFramebuffer:function(t,n){return g[t]!==n&&(e.bindFramebuffer(t,n),g[t]=n,i&&(t===e.DRAW_FRAMEBUFFER&&(g[e.FRAMEBUFFER]=n),t===e.FRAMEBUFFER&&(g[e.DRAW_FRAMEBUFFER]=n)),!0)},drawBuffers:function(i,r){let s=A,o=!1;if(i)if(s=u.get(r),void 0===s&&(s=[],u.set(r,s)),i.isWebGLMultipleRenderTargets){const t=i.texture;if(s.length!==t.length||s[0]!==e.COLOR_ATTACHMENT0){for(let n=0,i=t.length;n<i;n++)s[n]=e.COLOR_ATTACHMENT0+n;s.length=t.length,o=!0}}else s[0]!==e.COLOR_ATTACHMENT0&&(s[0]=e.COLOR_ATTACHMENT0,o=!0);else s[0]!==e.BACK&&(s[0]=e.BACK,o=!0);o&&(n.isWebGL2?e.drawBuffers(s):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(s))},useProgram:function(t){return d!==t&&(e.useProgram(t),d=t,!0)},setBlending:P,setMaterial:function(t,n){t.side===le?X(e.CULL_FACE):K(e.CULL_FACE);let i=t.side===ae;n&&(i=!i),U(i),t.blending===ue&&!1===t.transparent?P(ge):P(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.blendColor,t.blendAlpha,t.premultipliedAlpha),s.setFunc(t.depthFunc),s.setTest(t.depthTest),s.setMask(t.depthWrite),r.setMask(t.colorWrite);const a=t.stencilWrite;o.setTest(a),a&&(o.setMask(t.stencilWriteMask),o.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),o.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),O(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?K(e.SAMPLE_ALPHA_TO_COVERAGE):X(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:U,setCullFace:_,setLineWidth:function(t){t!==x&&(D&&e.lineWidth(t),x=t)},setPolygonOffset:O,setScissorTest:function(t){t?K(e.SCISSOR_TEST):X(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+Z-1),M!==t&&(e.activeTexture(t),M=t)},bindTexture:function(t,n,i){void 0===i&&(i=null===M?e.TEXTURE0+Z-1:M);let r=W[i];void 0===r&&(r={type:void 0,texture:void 0},W[i]=r),r.type===t&&r.texture===n||(M!==i&&(e.activeTexture(i),M=i),e.bindTexture(t,n||Q[t]),r.type=t,r.texture=n)},unbindTexture:function(){const t=W[M];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(HY){console.error("THREE.WebGLState:",HY)}},compressedTexImage3D:function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(HY){console.error("THREE.WebGLState:",HY)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(HY){console.error("THREE.WebGLState:",HY)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(HY){console.error("THREE.WebGLState:",HY)}},updateUBOMapping:function(t,n){let i=l.get(n);void 0===i&&(i=new WeakMap,l.set(n,i));let r=i.get(t);void 0===r&&(r=e.getUniformBlockIndex(n,t.name),i.set(t,r))},uniformBlockBinding:function(t,n){const i=l.get(n).get(t);a.get(n)!==i&&(e.uniformBlockBinding(n,i,t.__bindingPointIndex),a.set(n,i))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(HY){console.error("THREE.WebGLState:",HY)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(HY){console.error("THREE.WebGLState:",HY)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(HY){console.error("THREE.WebGLState:",HY)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(HY){console.error("THREE.WebGLState:",HY)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(HY){console.error("THREE.WebGLState:",HY)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(HY){console.error("THREE.WebGLState:",HY)}},scissor:function(t){!1===V.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),V.copy(t))},viewport:function(t){!1===L.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),L.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),!0===i&&(e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),c={},M=null,W={},g={},u=new WeakMap,A=[],d=null,h=!1,I=null,p=null,C=null,m=null,f=null,y=null,b=null,B=new Ps(0,0,0),v=0,w=!1,G=null,E=null,x=null,S=null,R=null,V.set(0,0,e.canvas.width,e.canvas.height),L.set(0,0,e.canvas.width,e.canvas.height),r.reset(),s.reset(),o.reset()}}}function Wc(e,t,n,i,r,s,o){const a=r.isWebGL2,l=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,c="undefined"!==typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),g=new WeakMap;let u;const A=new WeakMap;let d=!1;try{d="undefined"!==typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(L){}function h(e,t){return d?new OffscreenCanvas(e,t):tr("canvas")}function I(e,t,n,i){let r=1;if((e.width>i||e.height>i)&&(r=i/Math.max(e.width,e.height)),r<1||!0===t){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap){const i=t?zi:Math.floor,s=i(r*e.width),o=i(r*e.height);void 0===u&&(u=h(s,o));const a=n?h(s,o):u;a.width=s,a.height=o;return a.getContext("2d").drawImage(e,0,0,s,o),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+s+"x"+o+")."),a}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function p(e){return Yi(e.width)&&Yi(e.height)}function C(e,t){return e.generateMipmaps&&t&&e.minFilter!==ut&&e.minFilter!==pt}function m(t){e.generateMipmap(t)}function f(n,i,r,s){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!1===a)return i;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let l=i;if(i===e.RED&&(r===e.FLOAT&&(l=e.R32F),r===e.HALF_FLOAT&&(l=e.R16F),r===e.UNSIGNED_BYTE&&(l=e.R8)),i===e.RED_INTEGER&&(r===e.UNSIGNED_BYTE&&(l=e.R8UI),r===e.UNSIGNED_SHORT&&(l=e.R16UI),r===e.UNSIGNED_INT&&(l=e.R32UI),r===e.BYTE&&(l=e.R8I),r===e.SHORT&&(l=e.R16I),r===e.INT&&(l=e.R32I)),i===e.RG&&(r===e.FLOAT&&(l=e.RG32F),r===e.HALF_FLOAT&&(l=e.RG16F),r===e.UNSIGNED_BYTE&&(l=e.RG8)),i===e.RGBA){const t=o?Un:cr.getTransfer(s);r===e.FLOAT&&(l=e.RGBA32F),r===e.HALF_FLOAT&&(l=e.RGBA16F),r===e.UNSIGNED_BYTE&&(l=t===_n?e.SRGB8_ALPHA8:e.RGBA8),r===e.UNSIGNED_SHORT_4_4_4_4&&(l=e.RGBA4),r===e.UNSIGNED_SHORT_5_5_5_1&&(l=e.RGB5_A1)}return l!==e.R16F&&l!==e.R32F&&l!==e.RG16F&&l!==e.RG32F&&l!==e.RGBA16F&&l!==e.RGBA32F||t.get("EXT_color_buffer_float"),l}function y(e,t,n){return!0===C(e,n)||e.isFramebufferTexture&&e.minFilter!==ut&&e.minFilter!==pt?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function b(t){return t===ut||t===At||t===ht?e.NEAREST:e.LINEAR}function B(e){const t=e.target;t.removeEventListener("dispose",B),function(e){const t=i.get(e);if(void 0===t.__webglInit)return;const n=e.source,r=A.get(n);if(r){const i=r[t.__cacheKey];i.usedTimes--,0===i.usedTimes&&w(e),0===Object.keys(r).length&&A.delete(n)}i.remove(e)}(t),t.isVideoTexture&&g.delete(t)}function v(t){const n=t.target;n.removeEventListener("dispose",v),function(t){const n=t.texture,r=i.get(t),s=i.get(n);void 0!==s.__webglTexture&&(e.deleteTexture(s.__webglTexture),o.memory.textures--);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(let i=0;i<6;i++){if(Array.isArray(r.__webglFramebuffer[i]))for(let t=0;t<r.__webglFramebuffer[i].length;t++)e.deleteFramebuffer(r.__webglFramebuffer[i][t]);else e.deleteFramebuffer(r.__webglFramebuffer[i]);r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer[i])}else{if(Array.isArray(r.__webglFramebuffer))for(let t=0;t<r.__webglFramebuffer.length;t++)e.deleteFramebuffer(r.__webglFramebuffer[t]);else e.deleteFramebuffer(r.__webglFramebuffer);if(r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&e.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer)for(let t=0;t<r.__webglColorRenderbuffer.length;t++)r.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(r.__webglColorRenderbuffer[t]);r.__webglDepthRenderbuffer&&e.deleteRenderbuffer(r.__webglDepthRenderbuffer)}if(t.isWebGLMultipleRenderTargets)for(let a=0,l=n.length;a<l;a++){const t=i.get(n[a]);t.__webglTexture&&(e.deleteTexture(t.__webglTexture),o.memory.textures--),i.remove(n[a])}i.remove(n),i.remove(t)}(n)}function w(t){const n=i.get(t);e.deleteTexture(n.__webglTexture);const r=t.source;delete A.get(r)[n.__cacheKey],o.memory.textures--}let G=0;function E(t,r){const s=i.get(t);if(t.isVideoTexture&&function(e){const t=o.render.frame;g.get(e)!==t&&(g.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&t.version>0&&s.__version!==t.version){const e=t.image;if(null===e)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==e.complete)return void F(s,t,r);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.bindTexture(e.TEXTURE_2D,s.__webglTexture,e.TEXTURE0+r)}const x={[lt]:e.REPEAT,[ct]:e.CLAMP_TO_EDGE,[gt]:e.MIRRORED_REPEAT},S={[ut]:e.NEAREST,[At]:e.NEAREST_MIPMAP_NEAREST,[ht]:e.NEAREST_MIPMAP_LINEAR,[pt]:e.LINEAR,[Ct]:e.LINEAR_MIPMAP_NEAREST,[ft]:e.LINEAR_MIPMAP_LINEAR},R={[di]:e.NEVER,[yi]:e.ALWAYS,[hi]:e.LESS,[pi]:e.LEQUAL,[Ii]:e.EQUAL,[fi]:e.GEQUAL,[Ci]:e.GREATER,[mi]:e.NOTEQUAL};function Z(n,s,o){if(o?(e.texParameteri(n,e.TEXTURE_WRAP_S,x[s.wrapS]),e.texParameteri(n,e.TEXTURE_WRAP_T,x[s.wrapT]),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,x[s.wrapR]),e.texParameteri(n,e.TEXTURE_MAG_FILTER,S[s.magFilter]),e.texParameteri(n,e.TEXTURE_MIN_FILTER,S[s.minFilter])):(e.texParameteri(n,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(n,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,e.CLAMP_TO_EDGE),s.wrapS===ct&&s.wrapT===ct||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,e.TEXTURE_MAG_FILTER,b(s.magFilter)),e.texParameteri(n,e.TEXTURE_MIN_FILTER,b(s.minFilter)),s.minFilter!==ut&&s.minFilter!==pt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),s.compareFunction&&(e.texParameteri(n,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(n,e.TEXTURE_COMPARE_FUNC,R[s.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){const o=t.get("EXT_texture_filter_anisotropic");if(s.magFilter===ut)return;if(s.minFilter!==ht&&s.minFilter!==ft)return;if(s.type===xt&&!1===t.has("OES_texture_float_linear"))return;if(!1===a&&s.type===St&&!1===t.has("OES_texture_half_float_linear"))return;(s.anisotropy>1||i.get(s).__currentAnisotropy)&&(e.texParameterf(n,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,r.getMaxAnisotropy())),i.get(s).__currentAnisotropy=s.anisotropy)}}function D(t,n){let i=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",B));const r=n.source;let s=A.get(r);void 0===s&&(s={},A.set(r,s));const a=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(n);if(a!==t.__cacheKey){void 0===s[a]&&(s[a]={texture:e.createTexture(),usedTimes:0},o.memory.textures++,i=!0),s[a].usedTimes++;const r=s[t.__cacheKey];void 0!==r&&(s[t.__cacheKey].usedTimes--,0===r.usedTimes&&w(n)),t.__cacheKey=a,t.__webglTexture=s[a].texture}return i}function F(t,o,l){let c=e.TEXTURE_2D;(o.isDataArrayTexture||o.isCompressedArrayTexture)&&(c=e.TEXTURE_2D_ARRAY),o.isData3DTexture&&(c=e.TEXTURE_3D);const g=D(t,o),u=o.source;n.bindTexture(c,t.__webglTexture,e.TEXTURE0+l);const A=i.get(u);if(u.version!==A.__version||!0===g){n.activeTexture(e.TEXTURE0+l);const t=cr.getPrimaries(cr.workingColorSpace),i=o.colorSpace===Kn?null:cr.getPrimaries(o.colorSpace),d=o.colorSpace===Kn||t===i?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,o.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,o.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,d);const h=function(e){return!a&&(e.wrapS!==ct||e.wrapT!==ct||e.minFilter!==ut&&e.minFilter!==pt)}(o)&&!1===p(o.image);let b=I(o.image,h,!1,r.maxTextureSize);b=V(o,b);const B=p(b)||a,v=s.convert(o.format,o.colorSpace);let w,G=s.convert(o.type),E=f(o.internalFormat,v,G,o.colorSpace,o.isVideoTexture);Z(c,o,B);const x=o.mipmaps,S=a&&!0!==o.isVideoTexture&&E!==jt,R=void 0===A.__version||!0===g,D=y(o,b,B);if(o.isDepthTexture)E=e.DEPTH_COMPONENT,a?E=o.type===xt?e.DEPTH_COMPONENT32F:o.type===Et?e.DEPTH_COMPONENT24:o.type===Dt?e.DEPTH24_STENCIL8:e.DEPTH_COMPONENT16:o.type===xt&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),o.format===kt&&E===e.DEPTH_COMPONENT&&o.type!==wt&&o.type!==Et&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),o.type=Et,G=s.convert(o.type)),o.format===Tt&&E===e.DEPTH_COMPONENT&&(E=e.DEPTH_STENCIL,o.type!==Dt&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),o.type=Dt,G=s.convert(o.type))),R&&(S?n.texStorage2D(e.TEXTURE_2D,1,E,b.width,b.height):n.texImage2D(e.TEXTURE_2D,0,E,b.width,b.height,0,v,G,null));else if(o.isDataTexture)if(x.length>0&&B){S&&R&&n.texStorage2D(e.TEXTURE_2D,D,E,x[0].width,x[0].height);for(let t=0,i=x.length;t<i;t++)w=x[t],S?n.texSubImage2D(e.TEXTURE_2D,t,0,0,w.width,w.height,v,G,w.data):n.texImage2D(e.TEXTURE_2D,t,E,w.width,w.height,0,v,G,w.data);o.generateMipmaps=!1}else S?(R&&n.texStorage2D(e.TEXTURE_2D,D,E,b.width,b.height),n.texSubImage2D(e.TEXTURE_2D,0,0,0,b.width,b.height,v,G,b.data)):n.texImage2D(e.TEXTURE_2D,0,E,b.width,b.height,0,v,G,b.data);else if(o.isCompressedTexture)if(o.isCompressedArrayTexture){S&&R&&n.texStorage3D(e.TEXTURE_2D_ARRAY,D,E,x[0].width,x[0].height,b.depth);for(let t=0,i=x.length;t<i;t++)w=x[t],o.format!==Nt?null!==v?S?n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,w.width,w.height,b.depth,v,w.data,0,0):n.compressedTexImage3D(e.TEXTURE_2D_ARRAY,t,E,w.width,w.height,b.depth,0,w.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):S?n.texSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,w.width,w.height,b.depth,v,G,w.data):n.texImage3D(e.TEXTURE_2D_ARRAY,t,E,w.width,w.height,b.depth,0,v,G,w.data)}else{S&&R&&n.texStorage2D(e.TEXTURE_2D,D,E,x[0].width,x[0].height);for(let t=0,i=x.length;t<i;t++)w=x[t],o.format!==Nt?null!==v?S?n.compressedTexSubImage2D(e.TEXTURE_2D,t,0,0,w.width,w.height,v,w.data):n.compressedTexImage2D(e.TEXTURE_2D,t,E,w.width,w.height,0,w.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):S?n.texSubImage2D(e.TEXTURE_2D,t,0,0,w.width,w.height,v,G,w.data):n.texImage2D(e.TEXTURE_2D,t,E,w.width,w.height,0,v,G,w.data)}else if(o.isDataArrayTexture)S?(R&&n.texStorage3D(e.TEXTURE_2D_ARRAY,D,E,b.width,b.height,b.depth),n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,b.width,b.height,b.depth,v,G,b.data)):n.texImage3D(e.TEXTURE_2D_ARRAY,0,E,b.width,b.height,b.depth,0,v,G,b.data);else if(o.isData3DTexture)S?(R&&n.texStorage3D(e.TEXTURE_3D,D,E,b.width,b.height,b.depth),n.texSubImage3D(e.TEXTURE_3D,0,0,0,0,b.width,b.height,b.depth,v,G,b.data)):n.texImage3D(e.TEXTURE_3D,0,E,b.width,b.height,b.depth,0,v,G,b.data);else if(o.isFramebufferTexture){if(R)if(S)n.texStorage2D(e.TEXTURE_2D,D,E,b.width,b.height);else{let t=b.width,i=b.height;for(let r=0;r<D;r++)n.texImage2D(e.TEXTURE_2D,r,E,t,i,0,v,G,null),t>>=1,i>>=1}}else if(x.length>0&&B){S&&R&&n.texStorage2D(e.TEXTURE_2D,D,E,x[0].width,x[0].height);for(let t=0,i=x.length;t<i;t++)w=x[t],S?n.texSubImage2D(e.TEXTURE_2D,t,0,0,v,G,w):n.texImage2D(e.TEXTURE_2D,t,E,v,G,w);o.generateMipmaps=!1}else S?(R&&n.texStorage2D(e.TEXTURE_2D,D,E,b.width,b.height),n.texSubImage2D(e.TEXTURE_2D,0,0,0,v,G,b)):n.texImage2D(e.TEXTURE_2D,0,E,v,G,b);C(o,B)&&m(c),A.__version=u.version,o.onUpdate&&o.onUpdate(o)}t.__version=o.version}function N(t,r,o,a,c,g){const u=s.convert(o.format,o.colorSpace),A=s.convert(o.type),d=f(o.internalFormat,u,A,o.colorSpace);if(!i.get(r).__hasExternalTextures){const t=Math.max(1,r.width>>g),i=Math.max(1,r.height>>g);c===e.TEXTURE_3D||c===e.TEXTURE_2D_ARRAY?n.texImage3D(c,g,d,t,i,r.depth,0,u,A,null):n.texImage2D(c,g,d,t,i,0,u,A,null)}n.bindFramebuffer(e.FRAMEBUFFER,t),T(r)?l.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,a,c,i.get(o).__webglTexture,0,k(r)):(c===e.TEXTURE_2D||c>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,a,c,i.get(o).__webglTexture,g),n.bindFramebuffer(e.FRAMEBUFFER,null)}function M(t,n,i){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer&&!n.stencilBuffer){let r=!0===a?e.DEPTH_COMPONENT24:e.DEPTH_COMPONENT16;if(i||T(n)){const t=n.depthTexture;t&&t.isDepthTexture&&(t.type===xt?r=e.DEPTH_COMPONENT32F:t.type===Et&&(r=e.DEPTH_COMPONENT24));const i=k(n);T(n)?l.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,i,r,n.width,n.height):e.renderbufferStorageMultisample(e.RENDERBUFFER,i,r,n.width,n.height)}else e.renderbufferStorage(e.RENDERBUFFER,r,n.width,n.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)}else if(n.depthBuffer&&n.stencilBuffer){const r=k(n);i&&!1===T(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,r,e.DEPTH24_STENCIL8,n.width,n.height):T(n)?l.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,r,e.DEPTH24_STENCIL8,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)}else{const t=!0===n.isWebGLMultipleRenderTargets?n.texture:[n.texture];for(let r=0;r<t.length;r++){const o=t[r],a=s.convert(o.format,o.colorSpace),c=s.convert(o.type),g=f(o.internalFormat,a,c,o.colorSpace),u=k(n);i&&!1===T(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,u,g,n.width,n.height):T(n)?l.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,u,g,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,g,n.width,n.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function W(t){const r=i.get(t),s=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!r.__autoAllocateDepthBuffer){if(s)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(e.FRAMEBUFFER,t),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),E(r.depthTexture,0);const s=i.get(r.depthTexture).__webglTexture,o=k(r);if(r.depthTexture.format===kt)T(r)?l.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0,o):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0);else{if(r.depthTexture.format!==Tt)throw new Error("Unknown depthTexture format");T(r)?l.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0,o):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0)}}(r.__webglFramebuffer,t)}else if(s){r.__webglDepthbuffer=[];for(let i=0;i<6;i++)n.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer[i]),r.__webglDepthbuffer[i]=e.createRenderbuffer(),M(r.__webglDepthbuffer[i],t,!1)}else n.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer),r.__webglDepthbuffer=e.createRenderbuffer(),M(r.__webglDepthbuffer,t,!1);n.bindFramebuffer(e.FRAMEBUFFER,null)}function k(e){return Math.min(r.maxSamples,e.samples)}function T(e){const n=i.get(e);return a&&e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function V(e,n){const i=e.colorSpace,r=e.format,s=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||e.format===Fi||i!==Yn&&i!==Kn&&(cr.getTransfer(i)===_n?!1===a?!0===t.has("EXT_sRGB")&&r===Nt?(e.format=Fi,e.minFilter=pt,e.generateMipmaps=!1):n=dr.sRGBToLinear(n):r===Nt&&s===bt||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",i)),n}this.allocateTextureUnit=function(){const e=G;return e>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+r.maxTextures),G+=1,e},this.resetTextureUnits=function(){G=0},this.setTexture2D=E,this.setTexture2DArray=function(t,r){const s=i.get(t);t.version>0&&s.__version!==t.version?F(s,t,r):n.bindTexture(e.TEXTURE_2D_ARRAY,s.__webglTexture,e.TEXTURE0+r)},this.setTexture3D=function(t,r){const s=i.get(t);t.version>0&&s.__version!==t.version?F(s,t,r):n.bindTexture(e.TEXTURE_3D,s.__webglTexture,e.TEXTURE0+r)},this.setTextureCube=function(t,o){const l=i.get(t);t.version>0&&l.__version!==t.version?function(t,o,l){if(6!==o.image.length)return;const c=D(t,o),g=o.source;n.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+l);const u=i.get(g);if(g.version!==u.__version||!0===c){n.activeTexture(e.TEXTURE0+l);const t=cr.getPrimaries(cr.workingColorSpace),i=o.colorSpace===Kn?null:cr.getPrimaries(o.colorSpace),A=o.colorSpace===Kn||t===i?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,o.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,o.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,A);const d=o.isCompressedTexture||o.image[0].isCompressedTexture,h=o.image[0]&&o.image[0].isDataTexture,b=[];for(let e=0;e<6;e++)b[e]=d||h?h?o.image[e].image:o.image[e]:I(o.image[e],!1,!0,r.maxCubemapSize),b[e]=V(o,b[e]);const B=b[0],v=p(B)||a,w=s.convert(o.format,o.colorSpace),G=s.convert(o.type),E=f(o.internalFormat,w,G,o.colorSpace),x=a&&!0!==o.isVideoTexture,S=void 0===u.__version||!0===c;let R,D=y(o,B,v);if(Z(e.TEXTURE_CUBE_MAP,o,v),d){x&&S&&n.texStorage2D(e.TEXTURE_CUBE_MAP,D,E,B.width,B.height);for(let t=0;t<6;t++){R=b[t].mipmaps;for(let i=0;i<R.length;i++){const r=R[i];o.format!==Nt?null!==w?x?n.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,0,0,r.width,r.height,w,r.data):n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,E,r.width,r.height,0,r.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):x?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,0,0,r.width,r.height,w,G,r.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,E,r.width,r.height,0,w,G,r.data)}}}else{R=o.mipmaps,x&&S&&(R.length>0&&D++,n.texStorage2D(e.TEXTURE_CUBE_MAP,D,E,b[0].width,b[0].height));for(let t=0;t<6;t++)if(h){x?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,b[t].width,b[t].height,w,G,b[t].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,E,b[t].width,b[t].height,0,w,G,b[t].data);for(let i=0;i<R.length;i++){const r=R[i].image[t].image;x?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i+1,0,0,r.width,r.height,w,G,r.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i+1,E,r.width,r.height,0,w,G,r.data)}}else{x?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,w,G,b[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,E,w,G,b[t]);for(let i=0;i<R.length;i++){const r=R[i];x?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i+1,0,0,w,G,r.image[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i+1,E,w,G,r.image[t])}}}C(o,v)&&m(e.TEXTURE_CUBE_MAP),u.__version=g.version,o.onUpdate&&o.onUpdate(o)}t.__version=o.version}(l,t,o):n.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture,e.TEXTURE0+o)},this.rebindTextures=function(t,n,r){const s=i.get(t);void 0!==n&&N(s.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==r&&W(t)},this.setupRenderTarget=function(t){const l=t.texture,c=i.get(t),g=i.get(l);t.addEventListener("dispose",v),!0!==t.isWebGLMultipleRenderTargets&&(void 0===g.__webglTexture&&(g.__webglTexture=e.createTexture()),g.__version=l.version,o.memory.textures++);const u=!0===t.isWebGLCubeRenderTarget,A=!0===t.isWebGLMultipleRenderTargets,d=p(t)||a;if(u){c.__webglFramebuffer=[];for(let t=0;t<6;t++)if(a&&l.mipmaps&&l.mipmaps.length>0){c.__webglFramebuffer[t]=[];for(let n=0;n<l.mipmaps.length;n++)c.__webglFramebuffer[t][n]=e.createFramebuffer()}else c.__webglFramebuffer[t]=e.createFramebuffer()}else{if(a&&l.mipmaps&&l.mipmaps.length>0){c.__webglFramebuffer=[];for(let t=0;t<l.mipmaps.length;t++)c.__webglFramebuffer[t]=e.createFramebuffer()}else c.__webglFramebuffer=e.createFramebuffer();if(A)if(r.drawBuffers){const n=t.texture;for(let t=0,r=n.length;t<r;t++){const r=i.get(n[t]);void 0===r.__webglTexture&&(r.__webglTexture=e.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&t.samples>0&&!1===T(t)){const i=A?l:[l];c.__webglMultisampledFramebuffer=e.createFramebuffer(),c.__webglColorRenderbuffer=[],n.bindFramebuffer(e.FRAMEBUFFER,c.__webglMultisampledFramebuffer);for(let n=0;n<i.length;n++){const r=i[n];c.__webglColorRenderbuffer[n]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,c.__webglColorRenderbuffer[n]);const o=s.convert(r.format,r.colorSpace),a=s.convert(r.type),l=f(r.internalFormat,o,a,r.colorSpace,!0===t.isXRRenderTarget),g=k(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,g,l,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+n,e.RENDERBUFFER,c.__webglColorRenderbuffer[n])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(c.__webglDepthRenderbuffer=e.createRenderbuffer(),M(c.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}}if(u){n.bindTexture(e.TEXTURE_CUBE_MAP,g.__webglTexture),Z(e.TEXTURE_CUBE_MAP,l,d);for(let n=0;n<6;n++)if(a&&l.mipmaps&&l.mipmaps.length>0)for(let i=0;i<l.mipmaps.length;i++)N(c.__webglFramebuffer[n][i],t,l,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,i);else N(c.__webglFramebuffer[n],t,l,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0);C(l,d)&&m(e.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(A){const r=t.texture;for(let s=0,o=r.length;s<o;s++){const o=r[s],a=i.get(o);n.bindTexture(e.TEXTURE_2D,a.__webglTexture),Z(e.TEXTURE_2D,o,d),N(c.__webglFramebuffer,t,o,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,0),C(o,d)&&m(e.TEXTURE_2D)}n.unbindTexture()}else{let i=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(a?i=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(i,g.__webglTexture),Z(i,l,d),a&&l.mipmaps&&l.mipmaps.length>0)for(let n=0;n<l.mipmaps.length;n++)N(c.__webglFramebuffer[n],t,l,e.COLOR_ATTACHMENT0,i,n);else N(c.__webglFramebuffer,t,l,e.COLOR_ATTACHMENT0,i,0);C(l,d)&&m(i),n.unbindTexture()}t.depthBuffer&&W(t)},this.updateRenderTargetMipmap=function(t){const r=p(t)||a,s=!0===t.isWebGLMultipleRenderTargets?t.texture:[t.texture];for(let o=0,a=s.length;o<a;o++){const a=s[o];if(C(a,r)){const r=t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,s=i.get(a).__webglTexture;n.bindTexture(r,s),m(r),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(a&&t.samples>0&&!1===T(t)){const r=t.isWebGLMultipleRenderTargets?t.texture:[t.texture],s=t.width,o=t.height;let a=e.COLOR_BUFFER_BIT;const l=[],g=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,u=i.get(t),A=!0===t.isWebGLMultipleRenderTargets;if(A)for(let t=0;t<r.length;t++)n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null),n.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0);n.bindFramebuffer(e.READ_FRAMEBUFFER,u.__webglMultisampledFramebuffer),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglFramebuffer);for(let n=0;n<r.length;n++){l.push(e.COLOR_ATTACHMENT0+n),t.depthBuffer&&l.push(g);const d=void 0!==u.__ignoreDepthValues&&u.__ignoreDepthValues;if(!1===d&&(t.depthBuffer&&(a|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&(a|=e.STENCIL_BUFFER_BIT)),A&&e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,u.__webglColorRenderbuffer[n]),!0===d&&(e.invalidateFramebuffer(e.READ_FRAMEBUFFER,[g]),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[g])),A){const t=i.get(r[n]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,s,o,0,0,s,o,a,e.NEAREST),c&&e.invalidateFramebuffer(e.READ_FRAMEBUFFER,l)}if(n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),A)for(let t=0;t<r.length;t++){n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,u.__webglColorRenderbuffer[t]);const s=i.get(r[t]).__webglTexture;n.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,s,0)}n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=W,this.setupFrameBufferTexture=N,this.useMultisampledRTT=T}function kc(e,t,n){const i=n.isWebGL2;return{convert:function(n){let r,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kn;const o=cr.getTransfer(s);if(n===bt)return e.UNSIGNED_BYTE;if(n===Rt)return e.UNSIGNED_SHORT_4_4_4_4;if(n===Zt)return e.UNSIGNED_SHORT_5_5_5_1;if(n===Bt)return e.BYTE;if(n===vt)return e.SHORT;if(n===wt)return e.UNSIGNED_SHORT;if(n===Gt)return e.INT;if(n===Et)return e.UNSIGNED_INT;if(n===xt)return e.FLOAT;if(n===St)return i?e.HALF_FLOAT:(r=t.get("OES_texture_half_float"),null!==r?r.HALF_FLOAT_OES:null);if(n===Ft)return e.ALPHA;if(n===Nt)return e.RGBA;if(n===Mt)return e.LUMINANCE;if(n===Wt)return e.LUMINANCE_ALPHA;if(n===kt)return e.DEPTH_COMPONENT;if(n===Tt)return e.DEPTH_STENCIL;if(n===Fi)return r=t.get("EXT_sRGB"),null!==r?r.SRGB_ALPHA_EXT:null;if(n===Vt)return e.RED;if(n===Lt)return e.RED_INTEGER;if(n===Ht)return e.RG;if(n===Qt)return e.RG_INTEGER;if(n===Kt)return e.RGBA_INTEGER;if(n===Xt||n===Yt||n===zt||n===Pt)if(o===_n){if(r=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===r)return null;if(n===Xt)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Yt)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===zt)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Pt)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(r=t.get("WEBGL_compressed_texture_s3tc"),null===r)return null;if(n===Xt)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Yt)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===zt)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Pt)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===Ut||n===_t||n===Ot||n===Jt){if(r=t.get("WEBGL_compressed_texture_pvrtc"),null===r)return null;if(n===Ut)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===_t)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Ot)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Jt)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===jt)return r=t.get("WEBGL_compressed_texture_etc1"),null!==r?r.COMPRESSED_RGB_ETC1_WEBGL:null;if(n===qt||n===$t){if(r=t.get("WEBGL_compressed_texture_etc"),null===r)return null;if(n===qt)return o===_n?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(n===$t)return o===_n?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}if(n===en||n===tn||n===nn||n===rn||n===sn||n===on||n===an||n===ln||n===cn||n===gn||n===un||n===An||n===dn||n===hn){if(r=t.get("WEBGL_compressed_texture_astc"),null===r)return null;if(n===en)return o===_n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===tn)return o===_n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===nn)return o===_n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===rn)return o===_n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===sn)return o===_n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===on)return o===_n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===an)return o===_n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===ln)return o===_n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===cn)return o===_n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===gn)return o===_n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===un)return o===_n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===An)return o===_n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===dn)return o===_n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===hn)return o===_n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===In||n===pn||n===Cn){if(r=t.get("EXT_texture_compression_bptc"),null===r)return null;if(n===In)return o===_n?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===pn)return r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===Cn)return r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(n===mn||n===fn||n===yn||n===bn){if(r=t.get("EXT_texture_compression_rgtc"),null===r)return null;if(n===In)return r.COMPRESSED_RED_RGTC1_EXT;if(n===fn)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===yn)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===bn)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===Dt?i?e.UNSIGNED_INT_24_8:(r=t.get("WEBGL_depth_texture"),null!==r?r.UNSIGNED_INT_24_8_WEBGL:null):void 0!==e[n]?e[n]:null}}}class Tc extends Jo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isArrayCamera=!0,this.cameras=e}}class Vc extends Rs{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Lc={type:"move"};class Hc{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Vc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Vc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Sr,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Sr),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Vc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Sr,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Sr),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let i=null,r=null,s=null;const o=this._targetRay,a=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){s=!0;for(const s of e.hand.values()){const e=t.getJointPose(s,n),i=this._getHandJoint(l,s);null!==e&&(i.matrix.fromArray(e.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.matrixWorldNeedsUpdate=!0,i.jointRadius=e.radius),i.visible=null!==e}const i=l.joints["index-finger-tip"],r=l.joints["thumb-tip"],o=i.position.distanceTo(r.position),a=.02,c=.005;l.inputState.pinching&&o>a+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&o<=a-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==a&&e.gripSpace&&(r=t.getPose(e.gripSpace,n),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1));null!==o&&(i=t.getPose(e.targetRaySpace,n),null===i&&null!==r&&(i=r),null!==i&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(Lc)))}return null!==o&&(o.visible=null!==i),null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const n=new Vc;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class Qc extends Wi{constructor(e,t){super();const n=this;let i=null,r=1,s=null,o="local-floor",a=1,l=null,c=null,g=null,u=null,A=null,d=null;const h=t.getContextAttributes();let I=null,p=null;const C=[],m=[],f=new Oi;let y=null;const b=new Jo;b.layers.enable(1),b.viewport=new fr;const B=new Jo;B.layers.enable(2),B.viewport=new fr;const v=[b,B],w=new Tc;w.layers.enable(1),w.layers.enable(2);let G=null,E=null;function x(e){const t=m.indexOf(e.inputSource);if(-1===t)return;const n=C[t];void 0!==n&&(n.update(e.inputSource,e.frame,l||s),n.dispatchEvent({type:e.type,data:e.inputSource}))}function S(){i.removeEventListener("select",x),i.removeEventListener("selectstart",x),i.removeEventListener("selectend",x),i.removeEventListener("squeeze",x),i.removeEventListener("squeezestart",x),i.removeEventListener("squeezeend",x),i.removeEventListener("end",S),i.removeEventListener("inputsourceschange",R);for(let e=0;e<C.length;e++){const t=m[e];null!==t&&(m[e]=null,C[e].disconnect(t))}G=null,E=null,e.setRenderTarget(I),A=null,u=null,g=null,i=null,p=null,M.stop(),n.isPresenting=!1,e.setPixelRatio(y),e.setSize(f.width,f.height,!1),n.dispatchEvent({type:"sessionend"})}function R(e){for(let t=0;t<e.removed.length;t++){const n=e.removed[t],i=m.indexOf(n);i>=0&&(m[i]=null,C[i].disconnect(n))}for(let t=0;t<e.added.length;t++){const n=e.added[t];let i=m.indexOf(n);if(-1===i){for(let e=0;e<C.length;e++){if(e>=m.length){m.push(n),i=e;break}if(null===m[e]){m[e]=n,i=e;break}}if(-1===i)break}const r=C[i];r&&r.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=C[e];return void 0===t&&(t=new Hc,C[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=C[e];return void 0===t&&(t=new Hc,C[e]=t),t.getGripSpace()},this.getHand=function(e){let t=C[e];return void 0===t&&(t=new Hc,C[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){r=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){o=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(e){l=e},this.getBaseLayer=function(){return null!==u?u:A},this.getBinding=function(){return g},this.getFrame=function(){return d},this.getSession=function(){return i},this.setSession=async function(c){if(i=c,null!==i){if(I=e.getRenderTarget(),i.addEventListener("select",x),i.addEventListener("selectstart",x),i.addEventListener("selectend",x),i.addEventListener("squeeze",x),i.addEventListener("squeezestart",x),i.addEventListener("squeezeend",x),i.addEventListener("end",S),i.addEventListener("inputsourceschange",R),!0!==h.xrCompatible&&await t.makeXRCompatible(),y=e.getPixelRatio(),e.getSize(f),void 0===i.renderState.layers||!1===e.capabilities.isWebGL2){const n={antialias:void 0!==i.renderState.layers||h.antialias,alpha:!0,depth:h.depth,stencil:h.stencil,framebufferScaleFactor:r};A=new XRWebGLLayer(i,t,n),i.updateRenderState({baseLayer:A}),e.setPixelRatio(1),e.setSize(A.framebufferWidth,A.framebufferHeight,!1),p=new br(A.framebufferWidth,A.framebufferHeight,{format:Nt,type:bt,colorSpace:e.outputColorSpace,stencilBuffer:h.stencil})}else{let n=null,s=null,o=null;h.depth&&(o=h.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,n=h.stencil?Tt:kt,s=h.stencil?Dt:Et);const a={colorFormat:t.RGBA8,depthFormat:o,scaleFactor:r};g=new XRWebGLBinding(i,t),u=g.createProjectionLayer(a),i.updateRenderState({layers:[u]}),e.setPixelRatio(1),e.setSize(u.textureWidth,u.textureHeight,!1),p=new br(u.textureWidth,u.textureHeight,{format:Nt,type:bt,depthTexture:new Pa(u.textureWidth,u.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:h.stencil,colorSpace:e.outputColorSpace,samples:h.antialias?4:0});e.properties.get(p).__ignoreDepthValues=u.ignoreDepthValues}p.isXRRenderTarget=!0,this.setFoveation(a),l=null,s=await i.requestReferenceSpace(o),M.setContext(i),M.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==i)return i.environmentBlendMode};const Z=new Sr,D=new Sr;function F(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===i)return;w.near=B.near=b.near=e.near,w.far=B.far=b.far=e.far,G===w.near&&E===w.far||(i.updateRenderState({depthNear:w.near,depthFar:w.far}),G=w.near,E=w.far);const t=e.parent,n=w.cameras;F(w,t);for(let i=0;i<n.length;i++)F(n[i],t);2===n.length?function(e,t,n){Z.setFromMatrixPosition(t.matrixWorld),D.setFromMatrixPosition(n.matrixWorld);const i=Z.distanceTo(D),r=t.projectionMatrix.elements,s=n.projectionMatrix.elements,o=r[14]/(r[10]-1),a=r[14]/(r[10]+1),l=(r[9]+1)/r[5],c=(r[9]-1)/r[5],g=(r[8]-1)/r[0],u=(s[8]+1)/s[0],A=o*g,d=o*u,h=i/(-g+u),I=h*-g;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(I),e.translateZ(h),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();const p=o+h,C=a+h,m=A-I,f=d+(i-I),y=l*a/C*p,b=c*a/C*p;e.projectionMatrix.makePerspective(m,f,y,b,p,C),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}(w,b,B):w.projectionMatrix.copy(b.projectionMatrix),function(e,t,n){null===n?e.matrix.copy(t.matrixWorld):(e.matrix.copy(n.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld));e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*Li*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,w,t)},this.getCamera=function(){return w},this.getFoveation=function(){if(null!==u||null!==A)return a},this.setFoveation=function(e){a=e,null!==u&&(u.fixedFoveation=e),null!==A&&void 0!==A.fixedFoveation&&(A.fixedFoveation=e)};let N=null;const M=new la;M.setAnimationLoop((function(t,i){if(c=i.getViewerPose(l||s),d=i,null!==c){const t=c.views;null!==A&&(e.setRenderTargetFramebuffer(p,A.framebuffer),e.setRenderTarget(p));let n=!1;t.length!==w.cameras.length&&(w.cameras.length=0,n=!0);for(let i=0;i<t.length;i++){const r=t[i];let s=null;if(null!==A)s=A.getViewport(r);else{const t=g.getViewSubImage(u,r);s=t.viewport,0===i&&(e.setRenderTargetTextures(p,t.colorTexture,u.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(p))}let o=v[i];void 0===o&&(o=new Jo,o.layers.enable(i),o.viewport=new fr,v[i]=o),o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.quaternion,o.scale),o.projectionMatrix.fromArray(r.projectionMatrix),o.projectionMatrixInverse.copy(o.projectionMatrix).invert(),o.viewport.set(s.x,s.y,s.width,s.height),0===i&&(w.matrix.copy(o.matrix),w.matrix.decompose(w.position,w.quaternion,w.scale)),!0===n&&w.cameras.push(o)}}for(let e=0;e<C.length;e++){const t=m[e],n=C[e];null!==t&&void 0!==n&&n.update(t,i,l||s)}N&&N(t,i),i.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:i}),d=null})),this.setAnimationLoop=function(e){N=e},this.dispose=function(){}}}function Kc(e,t){function n(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function i(i,r){i.opacity.value=r.opacity,r.color&&i.diffuse.value.copy(r.color),r.emissive&&i.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(i.map.value=r.map,n(r.map,i.mapTransform)),r.alphaMap&&(i.alphaMap.value=r.alphaMap,n(r.alphaMap,i.alphaMapTransform)),r.bumpMap&&(i.bumpMap.value=r.bumpMap,n(r.bumpMap,i.bumpMapTransform),i.bumpScale.value=r.bumpScale,r.side===ae&&(i.bumpScale.value*=-1)),r.normalMap&&(i.normalMap.value=r.normalMap,n(r.normalMap,i.normalMapTransform),i.normalScale.value.copy(r.normalScale),r.side===ae&&i.normalScale.value.negate()),r.displacementMap&&(i.displacementMap.value=r.displacementMap,n(r.displacementMap,i.displacementMapTransform),i.displacementScale.value=r.displacementScale,i.displacementBias.value=r.displacementBias),r.emissiveMap&&(i.emissiveMap.value=r.emissiveMap,n(r.emissiveMap,i.emissiveMapTransform)),r.specularMap&&(i.specularMap.value=r.specularMap,n(r.specularMap,i.specularMapTransform)),r.alphaTest>0&&(i.alphaTest.value=r.alphaTest);const s=t.get(r).envMap;if(s&&(i.envMap.value=s,i.flipEnvMap.value=s.isCubeTexture&&!1===s.isRenderTargetTexture?-1:1,i.reflectivity.value=r.reflectivity,i.ior.value=r.ior,i.refractionRatio.value=r.refractionRatio),r.lightMap){i.lightMap.value=r.lightMap;const t=!0===e._useLegacyLights?Math.PI:1;i.lightMapIntensity.value=r.lightMapIntensity*t,n(r.lightMap,i.lightMapTransform)}r.aoMap&&(i.aoMap.value=r.aoMap,i.aoMapIntensity.value=r.aoMapIntensity,n(r.aoMap,i.aoMapTransform))}return{refreshFogUniforms:function(t,n){n.color.getRGB(t.fogColor.value,Po(e)),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(e,r,s,o,a){r.isMeshBasicMaterial||r.isMeshLambertMaterial?i(e,r):r.isMeshToonMaterial?(i(e,r),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,r)):r.isMeshPhongMaterial?(i(e,r),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,r)):r.isMeshStandardMaterial?(i(e,r),function(e,i){e.metalness.value=i.metalness,i.metalnessMap&&(e.metalnessMap.value=i.metalnessMap,n(i.metalnessMap,e.metalnessMapTransform));e.roughness.value=i.roughness,i.roughnessMap&&(e.roughnessMap.value=i.roughnessMap,n(i.roughnessMap,e.roughnessMapTransform));const r=t.get(i).envMap;r&&(e.envMapIntensity.value=i.envMapIntensity)}(e,r),r.isMeshPhysicalMaterial&&function(e,t,i){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,n(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,n(t.sheenRoughnessMap,e.sheenRoughnessMapTransform)));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,n(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,n(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,n(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),t.side===ae&&e.clearcoatNormalScale.value.negate()));t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,n(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,n(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform)));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=i.texture,e.transmissionSamplerSize.value.set(i.width,i.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,n(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,n(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,n(t.anisotropyMap,e.anisotropyMapTransform)));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,n(t.specularColorMap,e.specularColorMapTransform));t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,n(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,r,a)):r.isMeshMatcapMaterial?(i(e,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,r)):r.isMeshDepthMaterial?i(e,r):r.isMeshDistanceMaterial?(i(e,r),function(e,n){const i=t.get(n).light;e.referencePosition.value.setFromMatrixPosition(i.matrixWorld),e.nearDistance.value=i.shadow.camera.near,e.farDistance.value=i.shadow.camera.far}(e,r)):r.isMeshNormalMaterial?i(e,r):r.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform))}(e,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,r)):r.isPointsMaterial?function(e,t,i,r){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*i,e.scale.value=.5*r,t.map&&(e.map.value=t.map,n(t.map,e.uvTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,r,s,o):r.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,r):r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function Xc(e,t,n,i){let r={},s={},o=[];const a=n.isWebGL2?e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(e,t,n,i){const r=e.value,s=t+"_"+n;if(void 0===i[s])return i[s]="number"===typeof r||"boolean"===typeof r?r:r.clone(),!0;{const e=i[s];if("number"===typeof r||"boolean"===typeof r){if(e!==r)return i[s]=r,!0}else if(!1===e.equals(r))return e.copy(r),!0}return!1}function c(e){const t={boundary:0,storage:0};return"number"===typeof e||"boolean"===typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function g(t){const n=t.target;n.removeEventListener("dispose",g);const i=o.indexOf(n.__bindingPointIndex);o.splice(i,1),e.deleteBuffer(r[n.id]),delete r[n.id],delete s[n.id]}return{bind:function(e,t){const n=t.program;i.uniformBlockBinding(e,n)},update:function(n,u){let A=r[n.id];void 0===A&&(!function(e){const t=e.uniforms;let n=0;const i=16;for(let s=0,o=t.length;s<o;s++){const e=Array.isArray(t[s])?t[s]:[t[s]];for(let t=0,r=e.length;t<r;t++){const r=e[t],s=Array.isArray(r.value)?r.value:[r.value];for(let e=0,t=s.length;e<t;e++){const t=c(s[e]),o=n%i;0!==o&&i-o<t.boundary&&(n+=i-o),r.__data=new Float32Array(t.storage/Float32Array.BYTES_PER_ELEMENT),r.__offset=n,n+=t.storage}}}const r=n%i;r>0&&(n+=i-r);e.__size=n,e.__cache={}}(n),A=function(t){const n=function(){for(let e=0;e<a;e++)if(-1===o.indexOf(e))return o.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;const i=e.createBuffer(),r=t.__size,s=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,i),e.bufferData(e.UNIFORM_BUFFER,r,s),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,n,i),i}(n),r[n.id]=A,n.addEventListener("dispose",g));const d=u.program;i.updateUBOMapping(n,d);const h=t.render.frame;s[n.id]!==h&&(!function(t){const n=r[t.id],i=t.uniforms,s=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,n);for(let r=0,o=i.length;r<o;r++){const t=Array.isArray(i[r])?i[r]:[i[r]];for(let n=0,i=t.length;n<i;n++){const i=t[n];if(!0===l(i,r,n,s)){const t=i.__offset,n=Array.isArray(i.value)?i.value:[i.value];let r=0;for(let s=0;s<n.length;s++){const o=n[s],a=c(o);"number"===typeof o||"boolean"===typeof o?(i.__data[0]=o,e.bufferSubData(e.UNIFORM_BUFFER,t+r,i.__data)):o.isMatrix3?(i.__data[0]=o.elements[0],i.__data[1]=o.elements[1],i.__data[2]=o.elements[2],i.__data[3]=0,i.__data[4]=o.elements[3],i.__data[5]=o.elements[4],i.__data[6]=o.elements[5],i.__data[7]=0,i.__data[8]=o.elements[6],i.__data[9]=o.elements[7],i.__data[10]=o.elements[8],i.__data[11]=0):(o.toArray(i.__data,r),r+=a.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,t,i.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(n),s[n.id]=h)},dispose:function(){for(const t in r)e.deleteBuffer(r[t]);o=[],r={},s={}}}}class Yc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{canvas:t=nr(),context:n=null,depth:i=!0,stencil:r=!0,alpha:s=!1,antialias:o=!1,premultipliedAlpha:a=!0,preserveDrawingBuffer:l=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:g=!1}=e;let u;this.isWebGLRenderer=!0,u=null!==n?n.getContextAttributes().alpha:s;const A=new Uint32Array(4),d=new Int32Array(4);let h=null,I=null;const p=[],C=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Xn,this._useLegacyLights=!1,this.toneMapping=Ue,this.toneMappingExposure=1;const m=this;let f=!1,y=0,b=0,B=null,v=-1,w=null;const G=new fr,E=new fr;let x=null;const S=new Ps(0);let R=0,Z=t.width,D=t.height,F=1,N=null,M=null;const W=new fr(0,0,Z,D),k=new fr(0,0,Z,D);let T=!1;const V=new aa;let L=!1,H=!1,Q=null;const K=new rs,X=new Oi,Y=new Sr,z={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function P(){return null===B?F:1}let U,_,J,j,q,$,ee,te,ne,ie,re,se,ce,ge,ue,Ae,de,he,Ie,pe,Ce,me,fe,ye,be=n;function Be(e,n){for(let i=0;i<e.length;i++){const r=e[i],s=t.getContext(r,n);if(null!==s)return s}return null}try{const e={alpha:!0,depth:i,stencil:r,antialias:o,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:g};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r".concat(O)),t.addEventListener("webglcontextlost",Ge,!1),t.addEventListener("webglcontextrestored",Ee,!1),t.addEventListener("webglcontextcreationerror",xe,!1),null===be){const t=["webgl2","webgl","experimental-webgl"];if(!0===m.isWebGL1Renderer&&t.shift(),be=Be(t,e),null===be)throw Be(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}"undefined"!==typeof WebGLRenderingContext&&be instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===be.getShaderPrecisionFormat&&(be.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(HY){throw console.error("THREE.WebGLRenderer: "+HY.message),HY}function ve(){U=new Va(be),_=new ma(be,U,e),U.init(_),me=new kc(be,U,_),J=new Mc(be,U,_),j=new Qa(be),q=new yc,$=new Wc(be,U,J,q,_,me,j),ee=new ya(m),te=new Ta(m),ne=new ca(be,_),fe=new pa(be,U,ne,_),ie=new La(be,ne,j,fe),re=new za(be,ie,ne,j),Ie=new Ya(be,_,$),Ae=new fa(q),se=new fc(m,ee,te,U,_,fe,Ae),ce=new Kc(m,q),ge=new wc,ue=new Zc(U,_),he=new Ia(m,ee,te,J,re,u,a),de=new Nc(m,re,_),ye=new Xc(be,j,_,J),pe=new Ca(be,U,j,_),Ce=new Ha(be,U,j,_),j.programs=se.programs,m.capabilities=_,m.extensions=U,m.properties=q,m.renderLists=ge,m.shadowMap=de,m.state=J,m.info=j}ve();const we=new Qc(m,be);function Ge(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),f=!0}function Ee(){console.log("THREE.WebGLRenderer: Context Restored."),f=!1;const e=j.autoReset,t=de.enabled,n=de.autoUpdate,i=de.needsUpdate,r=de.type;ve(),j.autoReset=e,de.enabled=t,de.autoUpdate=n,de.needsUpdate=i,de.type=r}function xe(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function Se(e){const t=e.target;t.removeEventListener("dispose",Se),function(e){(function(e){const t=q.get(e).programs;void 0!==t&&(t.forEach((function(e){se.releaseProgram(e)})),e.isShaderMaterial&&se.releaseShaderCache(e))})(e),q.remove(e)}(t)}function Re(e,t,n){!0===e.transparent&&e.side===le&&!1===e.forceSinglePass?(e.side=ae,e.needsUpdate=!0,Ve(e,t,n),e.side=oe,e.needsUpdate=!0,Ve(e,t,n),e.side=le):Ve(e,t,n)}this.xr=we,this.getContext=function(){return be},this.getContextAttributes=function(){return be.getContextAttributes()},this.forceContextLoss=function(){const e=U.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=U.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return F},this.setPixelRatio=function(e){void 0!==e&&(F=e,this.setSize(Z,D,!1))},this.getSize=function(e){return e.set(Z,D)},this.setSize=function(e,n){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];we.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Z=e,D=n,t.width=Math.floor(e*F),t.height=Math.floor(n*F),!0===i&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(Z*F,D*F).floor()},this.setDrawingBufferSize=function(e,n,i){Z=e,D=n,F=i,t.width=Math.floor(e*i),t.height=Math.floor(n*i),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return e.copy(G)},this.getViewport=function(e){return e.copy(W)},this.setViewport=function(e,t,n,i){e.isVector4?W.set(e.x,e.y,e.z,e.w):W.set(e,t,n,i),J.viewport(G.copy(W).multiplyScalar(F).floor())},this.getScissor=function(e){return e.copy(k)},this.setScissor=function(e,t,n,i){e.isVector4?k.set(e.x,e.y,e.z,e.w):k.set(e,t,n,i),J.scissor(E.copy(k).multiplyScalar(F).floor())},this.getScissorTest=function(){return T},this.setScissorTest=function(e){J.setScissorTest(T=e)},this.setOpaqueSort=function(e){N=e},this.setTransparentSort=function(e){M=e},this.getClearColor=function(e){return e.copy(he.getClearColor())},this.setClearColor=function(){he.setClearColor.apply(he,arguments)},this.getClearAlpha=function(){return he.getClearAlpha()},this.setClearAlpha=function(){he.setClearAlpha.apply(he,arguments)},this.clear=function(){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=0;if(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]){let e=!1;if(null!==B){const t=B.texture.format;e=t===Kt||t===Qt||t===Lt}if(e){const e=B.texture.type,t=e===bt||e===Et||e===wt||e===Dt||e===Rt||e===Zt,n=he.getClearColor(),i=he.getClearAlpha(),r=n.r,s=n.g,o=n.b;t?(A[0]=r,A[1]=s,A[2]=o,A[3]=i,be.clearBufferuiv(be.COLOR,0,A)):(d[0]=r,d[1]=s,d[2]=o,d[3]=i,be.clearBufferiv(be.COLOR,0,d))}else n|=be.COLOR_BUFFER_BIT}e&&(n|=be.DEPTH_BUFFER_BIT),t&&(n|=be.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),be.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Ge,!1),t.removeEventListener("webglcontextrestored",Ee,!1),t.removeEventListener("webglcontextcreationerror",xe,!1),ge.dispose(),ue.dispose(),q.dispose(),ee.dispose(),te.dispose(),re.dispose(),fe.dispose(),ye.dispose(),se.dispose(),we.dispose(),we.removeEventListener("sessionstart",De),we.removeEventListener("sessionend",Fe),Q&&(Q.dispose(),Q=null),Ne.stop()},this.renderBufferDirect=function(e,t,n,i,r,s){null===t&&(t=z);const o=r.isMesh&&r.matrixWorld.determinant()<0,a=function(e,t,n,i,r){!0!==t.isScene&&(t=z);$.resetTextureUnits();const s=t.fog,o=i.isMeshStandardMaterial?t.environment:null,a=null===B?m.outputColorSpace:!0===B.isXRRenderTarget?B.texture.colorSpace:Yn,l=(i.isMeshStandardMaterial?te:ee).get(i.envMap||o),c=!0===i.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,g=!!n.attributes.tangent&&(!!i.normalMap||i.anisotropy>0),u=!!n.morphAttributes.position,A=!!n.morphAttributes.normal,d=!!n.morphAttributes.color;let h=Ue;i.toneMapped&&(null!==B&&!0!==B.isXRRenderTarget||(h=m.toneMapping));const p=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,C=void 0!==p?p.length:0,f=q.get(i),y=I.state.lights;if(!0===L&&(!0===H||e!==w)){const t=e===w&&i.id===v;Ae.setState(i,e,t)}let b=!1;i.version===f.__version?f.needsLights&&f.lightsStateVersion!==y.state.version||f.outputColorSpace!==a||r.isBatchedMesh&&!1===f.batching?b=!0:r.isBatchedMesh||!0!==f.batching?r.isInstancedMesh&&!1===f.instancing?b=!0:r.isInstancedMesh||!0!==f.instancing?r.isSkinnedMesh&&!1===f.skinning?b=!0:r.isSkinnedMesh||!0!==f.skinning?r.isInstancedMesh&&!0===f.instancingColor&&null===r.instanceColor||r.isInstancedMesh&&!1===f.instancingColor&&null!==r.instanceColor||f.envMap!==l||!0===i.fog&&f.fog!==s?b=!0:void 0===f.numClippingPlanes||f.numClippingPlanes===Ae.numPlanes&&f.numIntersection===Ae.numIntersection?(f.vertexAlphas!==c||f.vertexTangents!==g||f.morphTargets!==u||f.morphNormals!==A||f.morphColors!==d||f.toneMapping!==h||!0===_.isWebGL2&&f.morphTargetsCount!==C)&&(b=!0):b=!0:b=!0:b=!0:b=!0:(b=!0,f.__version=i.version);let G=f.currentProgram;!0===b&&(G=Ve(i,t,r));let E=!1,x=!1,S=!1;const R=G.getUniforms(),Z=f.uniforms;J.useProgram(G.program)&&(E=!0,x=!0,S=!0);i.id!==v&&(v=i.id,x=!0);if(E||w!==e){R.setValue(be,"projectionMatrix",e.projectionMatrix),R.setValue(be,"viewMatrix",e.matrixWorldInverse);const t=R.map.cameraPosition;void 0!==t&&t.setValue(be,Y.setFromMatrixPosition(e.matrixWorld)),_.logarithmicDepthBuffer&&R.setValue(be,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&R.setValue(be,"isOrthographic",!0===e.isOrthographicCamera),w!==e&&(w=e,x=!0,S=!0)}if(r.isSkinnedMesh){R.setOptional(be,r,"bindMatrix"),R.setOptional(be,r,"bindMatrixInverse");const e=r.skeleton;e&&(_.floatVertexTextures?(null===e.boneTexture&&e.computeBoneTexture(),R.setValue(be,"boneTexture",e.boneTexture,$)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}r.isBatchedMesh&&(R.setOptional(be,r,"batchingTexture"),R.setValue(be,"batchingTexture",r._matricesTexture,$));const N=n.morphAttributes;(void 0!==N.position||void 0!==N.normal||void 0!==N.color&&!0===_.isWebGL2)&&Ie.update(r,n,G);(x||f.receiveShadow!==r.receiveShadow)&&(f.receiveShadow=r.receiveShadow,R.setValue(be,"receiveShadow",r.receiveShadow));i.isMeshGouraudMaterial&&null!==i.envMap&&(Z.envMap.value=l,Z.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);x&&(R.setValue(be,"toneMappingExposure",m.toneMappingExposure),f.needsLights&&(W=S,(M=Z).ambientLightColor.needsUpdate=W,M.lightProbe.needsUpdate=W,M.directionalLights.needsUpdate=W,M.directionalLightShadows.needsUpdate=W,M.pointLights.needsUpdate=W,M.pointLightShadows.needsUpdate=W,M.spotLights.needsUpdate=W,M.spotLightShadows.needsUpdate=W,M.rectAreaLights.needsUpdate=W,M.hemisphereLights.needsUpdate=W),s&&!0===i.fog&&ce.refreshFogUniforms(Z,s),ce.refreshMaterialUniforms(Z,i,F,D,Q),jl.upload(be,Le(f),Z,$));var M,W;i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(jl.upload(be,Le(f),Z,$),i.uniformsNeedUpdate=!1);i.isSpriteMaterial&&R.setValue(be,"center",r.center);if(R.setValue(be,"modelViewMatrix",r.modelViewMatrix),R.setValue(be,"normalMatrix",r.normalMatrix),R.setValue(be,"modelMatrix",r.matrixWorld),i.isShaderMaterial||i.isRawShaderMaterial){const e=i.uniformsGroups;for(let t=0,n=e.length;t<n;t++)if(_.isWebGL2){const n=e[t];ye.update(n,G),ye.bind(n,G)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return G}(e,t,n,i,r);J.setMaterial(i,o);let l=n.index,c=1;if(!0===i.wireframe){if(l=ie.getWireframeAttribute(n),void 0===l)return;c=2}const g=n.drawRange,u=n.attributes.position;let A=g.start*c,d=(g.start+g.count)*c;null!==s&&(A=Math.max(A,s.start*c),d=Math.min(d,(s.start+s.count)*c)),null!==l?(A=Math.max(A,0),d=Math.min(d,l.count)):void 0!==u&&null!==u&&(A=Math.max(A,0),d=Math.min(d,u.count));const h=d-A;if(h<0||h===1/0)return;let p;fe.setup(r,i,a,n,l);let C=pe;if(null!==l&&(p=ne.get(l),C=Ce,C.setIndex(p)),r.isMesh)!0===i.wireframe?(J.setLineWidth(i.wireframeLinewidth*P()),C.setMode(be.LINES)):C.setMode(be.TRIANGLES);else if(r.isLine){let e=i.linewidth;void 0===e&&(e=1),J.setLineWidth(e*P()),r.isLineSegments?C.setMode(be.LINES):r.isLineLoop?C.setMode(be.LINE_LOOP):C.setMode(be.LINE_STRIP)}else r.isPoints?C.setMode(be.POINTS):r.isSprite&&C.setMode(be.TRIANGLES);if(r.isBatchedMesh)C.renderMultiDraw(r._multiDrawStarts,r._multiDrawCounts,r._multiDrawCount);else if(r.isInstancedMesh)C.renderInstances(A,h,r.count);else if(n.isInstancedBufferGeometry){const e=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,t=Math.min(n.instanceCount,e);C.renderInstances(A,h,t)}else C.render(A,h)},this.compile=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===n&&(n=e),I=ue.get(n),I.init(),C.push(I),n.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(I.pushLight(e),e.castShadow&&I.pushShadow(e))})),e!==n&&e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(I.pushLight(e),e.castShadow&&I.pushShadow(e))})),I.setupLights(m._useLegacyLights);const i=new Set;return e.traverse((function(e){const t=e.material;if(t)if(Array.isArray(t))for(let r=0;r<t.length;r++){const s=t[r];Re(s,n,e),i.add(s)}else Re(t,n,e),i.add(t)})),C.pop(),I=null,i},this.compileAsync=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=this.compile(e,t,n);return new Promise((t=>{function n(){i.forEach((function(e){q.get(e).currentProgram.isReady()&&i.delete(e)})),0!==i.size?setTimeout(n,10):t(e)}null!==U.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)}))};let Ze=null;function De(){Ne.stop()}function Fe(){Ne.start()}const Ne=new la;function Me(e,t,n,i){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)I.pushLight(e),e.castShadow&&I.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||V.intersectsSprite(e)){i&&Y.setFromMatrixPosition(e.matrixWorld).applyMatrix4(K);const t=re.update(e),r=e.material;r.visible&&h.push(e,t,r,n,Y.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||V.intersectsObject(e))){const t=re.update(e),r=e.material;if(i&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),Y.copy(e.boundingSphere.center)):(null===t.boundingSphere&&t.computeBoundingSphere(),Y.copy(t.boundingSphere.center)),Y.applyMatrix4(e.matrixWorld).applyMatrix4(K)),Array.isArray(r)){const i=t.groups;for(let s=0,o=i.length;s<o;s++){const o=i[s],a=r[o.materialIndex];a&&a.visible&&h.push(e,t,a,n,Y.z,o)}}else r.visible&&h.push(e,t,r,n,Y.z,null)}const r=e.children;for(let s=0,o=r.length;s<o;s++)Me(r[s],t,n,i)}function We(e,t,n,i){const r=e.opaque,s=e.transmissive,o=e.transparent;I.setupLightsView(n),!0===L&&Ae.setGlobalState(m.clippingPlanes,n),s.length>0&&function(e,t,n,i){const r=!0===n.isScene?n.overrideMaterial:null;if(null!==r)return;const s=_.isWebGL2;null===Q&&(Q=new br(1,1,{generateMipmaps:!0,type:U.has("EXT_color_buffer_half_float")?St:bt,minFilter:ft,samples:s?4:0}));m.getDrawingBufferSize(X),s?Q.setSize(X.x,X.y):Q.setSize(zi(X.x),zi(X.y));const o=m.getRenderTarget();m.setRenderTarget(Q),m.getClearColor(S),R=m.getClearAlpha(),R<1&&m.setClearColor(16777215,.5);m.clear();const a=m.toneMapping;m.toneMapping=Ue,ke(e,n,i),$.updateMultisampleRenderTarget(Q),$.updateRenderTargetMipmap(Q);let l=!1;for(let c=0,g=t.length;c<g;c++){const e=t[c],r=e.object,s=e.geometry,o=e.material,a=e.group;if(o.side===le&&r.layers.test(i.layers)){const e=o.side;o.side=ae,o.needsUpdate=!0,Te(r,n,i,s,o,a),o.side=e,o.needsUpdate=!0,l=!0}}!0===l&&($.updateMultisampleRenderTarget(Q),$.updateRenderTargetMipmap(Q));m.setRenderTarget(o),m.setClearColor(S,R),m.toneMapping=a}(r,s,t,n),i&&J.viewport(G.copy(i)),r.length>0&&ke(r,t,n),s.length>0&&ke(s,t,n),o.length>0&&ke(o,t,n),J.buffers.depth.setTest(!0),J.buffers.depth.setMask(!0),J.buffers.color.setMask(!0),J.setPolygonOffset(!1)}function ke(e,t,n){const i=!0===t.isScene?t.overrideMaterial:null;for(let r=0,s=e.length;r<s;r++){const s=e[r],o=s.object,a=s.geometry,l=null===i?s.material:i,c=s.group;o.layers.test(n.layers)&&Te(o,t,n,a,l,c)}}function Te(e,t,n,i,r,s){e.onBeforeRender(m,t,n,i,r,s),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),r.onBeforeRender(m,t,n,i,e,s),!0===r.transparent&&r.side===le&&!1===r.forceSinglePass?(r.side=ae,r.needsUpdate=!0,m.renderBufferDirect(n,t,i,r,e,s),r.side=oe,r.needsUpdate=!0,m.renderBufferDirect(n,t,i,r,e,s),r.side=le):m.renderBufferDirect(n,t,i,r,e,s),e.onAfterRender(m,t,n,i,r,s)}function Ve(e,t,n){!0!==t.isScene&&(t=z);const i=q.get(e),r=I.state.lights,s=I.state.shadowsArray,o=r.state.version,a=se.getParameters(e,r.state,s,t,n),l=se.getProgramCacheKey(a);let c=i.programs;i.environment=e.isMeshStandardMaterial?t.environment:null,i.fog=t.fog,i.envMap=(e.isMeshStandardMaterial?te:ee).get(e.envMap||i.environment),void 0===c&&(e.addEventListener("dispose",Se),c=new Map,i.programs=c);let g=c.get(l);if(void 0!==g){if(i.currentProgram===g&&i.lightsStateVersion===o)return He(e,a),g}else a.uniforms=se.getUniforms(e),e.onBuild(n,a,m),e.onBeforeCompile(a,m),g=se.acquireProgram(a,l),c.set(l,g),i.uniforms=a.uniforms;const u=i.uniforms;return(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(u.clippingPlanes=Ae.uniform),He(e,a),i.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),i.lightsStateVersion=o,i.needsLights&&(u.ambientLightColor.value=r.state.ambient,u.lightProbe.value=r.state.probe,u.directionalLights.value=r.state.directional,u.directionalLightShadows.value=r.state.directionalShadow,u.spotLights.value=r.state.spot,u.spotLightShadows.value=r.state.spotShadow,u.rectAreaLights.value=r.state.rectArea,u.ltc_1.value=r.state.rectAreaLTC1,u.ltc_2.value=r.state.rectAreaLTC2,u.pointLights.value=r.state.point,u.pointLightShadows.value=r.state.pointShadow,u.hemisphereLights.value=r.state.hemi,u.directionalShadowMap.value=r.state.directionalShadowMap,u.directionalShadowMatrix.value=r.state.directionalShadowMatrix,u.spotShadowMap.value=r.state.spotShadowMap,u.spotLightMatrix.value=r.state.spotLightMatrix,u.spotLightMap.value=r.state.spotLightMap,u.pointShadowMap.value=r.state.pointShadowMap,u.pointShadowMatrix.value=r.state.pointShadowMatrix),i.currentProgram=g,i.uniformsList=null,g}function Le(e){if(null===e.uniformsList){const t=e.currentProgram.getUniforms();e.uniformsList=jl.seqWithValue(t.seq,e.uniforms)}return e.uniformsList}function He(e,t){const n=q.get(e);n.outputColorSpace=t.outputColorSpace,n.batching=t.batching,n.instancing=t.instancing,n.instancingColor=t.instancingColor,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}Ne.setAnimationLoop((function(e){Ze&&Ze(e)})),"undefined"!==typeof self&&Ne.setContext(self),this.setAnimationLoop=function(e){Ze=e,we.setAnimationLoop(e),null===e?Ne.stop():Ne.start()},we.addEventListener("sessionstart",De),we.addEventListener("sessionend",Fe),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===f)return;!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===we.enabled&&!0===we.isPresenting&&(!0===we.cameraAutoUpdate&&we.updateCamera(t),t=we.getCamera()),!0===e.isScene&&e.onBeforeRender(m,e,t,B),I=ue.get(e,C.length),I.init(),C.push(I),K.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),V.setFromProjectionMatrix(K),H=this.localClippingEnabled,L=Ae.init(this.clippingPlanes,H),h=ge.get(e,p.length),h.init(),p.push(h),Me(e,t,0,m.sortObjects),h.finish(),!0===m.sortObjects&&h.sort(N,M),this.info.render.frame++,!0===L&&Ae.beginShadows();const n=I.state.shadowsArray;if(de.render(n,e,t),!0===L&&Ae.endShadows(),!0===this.info.autoReset&&this.info.reset(),he.render(h,e),I.setupLights(m._useLegacyLights),t.isArrayCamera){const n=t.cameras;for(let t=0,i=n.length;t<i;t++){const i=n[t];We(h,e,i,i.viewport)}}else We(h,e,t);null!==B&&($.updateMultisampleRenderTarget(B),$.updateRenderTargetMipmap(B)),!0===e.isScene&&e.onAfterRender(m,e,t),fe.resetDefaultState(),v=-1,w=null,C.pop(),I=C.length>0?C[C.length-1]:null,p.pop(),h=p.length>0?p[p.length-1]:null},this.getActiveCubeFace=function(){return y},this.getActiveMipmapLevel=function(){return b},this.getRenderTarget=function(){return B},this.setRenderTargetTextures=function(e,t,n){q.get(e.texture).__webglTexture=t,q.get(e.depthTexture).__webglTexture=n;const i=q.get(e);i.__hasExternalTextures=!0,i.__hasExternalTextures&&(i.__autoAllocateDepthBuffer=void 0===n,i.__autoAllocateDepthBuffer||!0===U.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),i.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(e,t){const n=q.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;B=e,y=t,b=n;let i=!0,r=null,s=!1,o=!1;if(e){const a=q.get(e);void 0!==a.__useDefaultFramebuffer?(J.bindFramebuffer(be.FRAMEBUFFER,null),i=!1):void 0===a.__webglFramebuffer?$.setupRenderTarget(e):a.__hasExternalTextures&&$.rebindTextures(e,q.get(e.texture).__webglTexture,q.get(e.depthTexture).__webglTexture);const l=e.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(o=!0);const c=q.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=Array.isArray(c[t])?c[t][n]:c[t],s=!0):r=_.isWebGL2&&e.samples>0&&!1===$.useMultisampledRTT(e)?q.get(e).__webglMultisampledFramebuffer:Array.isArray(c)?c[n]:c,G.copy(e.viewport),E.copy(e.scissor),x=e.scissorTest}else G.copy(W).multiplyScalar(F).floor(),E.copy(k).multiplyScalar(F).floor(),x=T;if(J.bindFramebuffer(be.FRAMEBUFFER,r)&&_.drawBuffers&&i&&J.drawBuffers(e,r),J.viewport(G),J.scissor(E),J.setScissorTest(x),s){const i=q.get(e.texture);be.framebufferTexture2D(be.FRAMEBUFFER,be.COLOR_ATTACHMENT0,be.TEXTURE_CUBE_MAP_POSITIVE_X+t,i.__webglTexture,n)}else if(o){const i=q.get(e.texture),r=t||0;be.framebufferTextureLayer(be.FRAMEBUFFER,be.COLOR_ATTACHMENT0,i.__webglTexture,n||0,r)}v=-1},this.readRenderTargetPixels=function(e,t,n,i,r,s,o){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let a=q.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(a=a[o]),a){J.bindFramebuffer(be.FRAMEBUFFER,a);try{const o=e.texture,a=o.format,l=o.type;if(a!==Nt&&me.convert(a)!==be.getParameter(be.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const c=l===St&&(U.has("EXT_color_buffer_half_float")||_.isWebGL2&&U.has("EXT_color_buffer_float"));if(l!==bt&&me.convert(l)!==be.getParameter(be.IMPLEMENTATION_COLOR_READ_TYPE)&&(l!==xt||!(_.isWebGL2||U.has("OES_texture_float")||U.has("WEBGL_color_buffer_float")))&&!c)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-i&&n>=0&&n<=e.height-r&&be.readPixels(t,n,i,r,me.convert(a),me.convert(l),s)}finally{const e=null!==B?q.get(B).__webglFramebuffer:null;J.bindFramebuffer(be.FRAMEBUFFER,e)}}},this.copyFramebufferToTexture=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=Math.pow(2,-n),r=Math.floor(t.image.width*i),s=Math.floor(t.image.height*i);$.setTexture2D(t,0),be.copyTexSubImage2D(be.TEXTURE_2D,n,0,0,e.x,e.y,r,s),J.unbindTexture()},this.copyTextureToTexture=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const r=t.image.width,s=t.image.height,o=me.convert(n.format),a=me.convert(n.type);$.setTexture2D(n,0),be.pixelStorei(be.UNPACK_FLIP_Y_WEBGL,n.flipY),be.pixelStorei(be.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),be.pixelStorei(be.UNPACK_ALIGNMENT,n.unpackAlignment),t.isDataTexture?be.texSubImage2D(be.TEXTURE_2D,i,e.x,e.y,r,s,o,a,t.image.data):t.isCompressedTexture?be.compressedTexSubImage2D(be.TEXTURE_2D,i,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,o,t.mipmaps[0].data):be.texSubImage2D(be.TEXTURE_2D,i,e.x,e.y,o,a,t.image),0===i&&n.generateMipmaps&&be.generateMipmap(be.TEXTURE_2D),J.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(m.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const s=e.max.x-e.min.x+1,o=e.max.y-e.min.y+1,a=e.max.z-e.min.z+1,l=me.convert(i.format),c=me.convert(i.type);let g;if(i.isData3DTexture)$.setTexture3D(i,0),g=be.TEXTURE_3D;else{if(!i.isDataArrayTexture&&!i.isCompressedArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");$.setTexture2DArray(i,0),g=be.TEXTURE_2D_ARRAY}be.pixelStorei(be.UNPACK_FLIP_Y_WEBGL,i.flipY),be.pixelStorei(be.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),be.pixelStorei(be.UNPACK_ALIGNMENT,i.unpackAlignment);const u=be.getParameter(be.UNPACK_ROW_LENGTH),A=be.getParameter(be.UNPACK_IMAGE_HEIGHT),d=be.getParameter(be.UNPACK_SKIP_PIXELS),h=be.getParameter(be.UNPACK_SKIP_ROWS),I=be.getParameter(be.UNPACK_SKIP_IMAGES),p=n.isCompressedTexture?n.mipmaps[r]:n.image;be.pixelStorei(be.UNPACK_ROW_LENGTH,p.width),be.pixelStorei(be.UNPACK_IMAGE_HEIGHT,p.height),be.pixelStorei(be.UNPACK_SKIP_PIXELS,e.min.x),be.pixelStorei(be.UNPACK_SKIP_ROWS,e.min.y),be.pixelStorei(be.UNPACK_SKIP_IMAGES,e.min.z),n.isDataTexture||n.isData3DTexture?be.texSubImage3D(g,r,t.x,t.y,t.z,s,o,a,l,c,p.data):n.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),be.compressedTexSubImage3D(g,r,t.x,t.y,t.z,s,o,a,l,p.data)):be.texSubImage3D(g,r,t.x,t.y,t.z,s,o,a,l,c,p),be.pixelStorei(be.UNPACK_ROW_LENGTH,u),be.pixelStorei(be.UNPACK_IMAGE_HEIGHT,A),be.pixelStorei(be.UNPACK_SKIP_PIXELS,d),be.pixelStorei(be.UNPACK_SKIP_ROWS,h),be.pixelStorei(be.UNPACK_SKIP_IMAGES,I),0===r&&i.generateMipmaps&&be.generateMipmap(g),J.unbindTexture()},this.initTexture=function(e){e.isCubeTexture?$.setTextureCube(e,0):e.isData3DTexture?$.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?$.setTexture2DArray(e,0):$.setTexture2D(e,0),J.unbindTexture()},this.resetState=function(){y=0,b=0,B=null,J.reset(),fe.reset()},"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ni}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===zn?"display-p3":"srgb",t.unpackColorSpace=cr.workingColorSpace===Pn?"display-p3":"srgb"}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Xn?Tn:kn}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Tn?Xn:Yn}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class zc extends Yc{}zc.prototype.isWebGL1Renderer=!0;class Pc{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25e-5;this.isFogExp2=!0,this.name="",this.color=new Ps(e),this.density=t}clone(){return new Pc(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Uc{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;this.isFog=!0,this.name="",this.color=new Ps(e),this.near=t,this.far=n}clone(){return new Uc(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class _c extends Rs{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class Oc{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=bi,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=Hi()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return console.warn("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,r=this.stride;i<r;i++)this.array[e+i]=t.array[n+i];return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Hi()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Hi()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Jc=new Sr;class jc{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Jc.fromBufferAttribute(this,t),Jc.applyMatrix4(e),this.setXYZ(t,Jc.x,Jc.y,Jc.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Jc.fromBufferAttribute(this,t),Jc.applyNormalMatrix(e),this.setXYZ(t,Jc.x,Jc.y,Jc.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Jc.fromBufferAttribute(this,t),Jc.transformDirection(e),this.setXYZ(t,Jc.x,Jc.y,Jc.z);return this}setX(e,t){return this.normalized&&(t=Ui(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Ui(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Ui(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Ui(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Pi(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Pi(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Pi(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Pi(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ui(t,this.array),n=Ui(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ui(t,this.array),n=Ui(n,this.array),i=Ui(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ui(t,this.array),n=Ui(n,this.array),i=Ui(i,this.array),r=Ui(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=r,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new ro(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new jc(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class qc extends Os{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Ps(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let $c;const eg=new Sr,tg=new Sr,ng=new Sr,ig=new Oi,rg=new Oi,sg=new rs,og=new Sr,ag=new Sr,lg=new Sr,cg=new Oi,gg=new Oi,ug=new Oi;class Ag extends Rs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qc;if(super(),this.isSprite=!0,this.type="Sprite",void 0===$c){$c=new vo;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new Oc(e,5);$c.setIndex([0,1,2,0,2,3]),$c.setAttribute("position",new jc(t,3,0,!1)),$c.setAttribute("uv",new jc(t,2,3,!1))}this.geometry=$c,this.material=e,this.center=new Oi(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),tg.setFromMatrixScale(this.matrixWorld),sg.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),ng.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&tg.multiplyScalar(-ng.z);const n=this.material.rotation;let i,r;0!==n&&(r=Math.cos(n),i=Math.sin(n));const s=this.center;dg(og.set(-.5,-.5,0),ng,s,tg,i,r),dg(ag.set(.5,-.5,0),ng,s,tg,i,r),dg(lg.set(.5,.5,0),ng,s,tg,i,r),cg.set(0,0),gg.set(1,0),ug.set(1,1);let o=e.ray.intersectTriangle(og,ag,lg,!1,eg);if(null===o&&(dg(ag.set(-.5,.5,0),ng,s,tg,i,r),gg.set(0,1),o=e.ray.intersectTriangle(og,lg,ag,!1,eg),null===o))return;const a=e.ray.origin.distanceTo(eg);a<e.near||a>e.far||t.push({distance:a,point:eg.clone(),uv:Qs.getInterpolation(eg,og,ag,lg,cg,gg,ug,new Oi),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function dg(e,t,n,i,r,s){ig.subVectors(e,n).addScalar(.5).multiply(i),void 0!==r?(rg.x=s*ig.x-r*ig.y,rg.y=r*ig.x+s*ig.y):rg.copy(ig),e.copy(t),e.x+=rg.x,e.y+=rg.y,e.applyMatrix4(sg)}const hg=new Sr,Ig=new Sr;class pg extends Rs{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,i=t.length;n<i;n++){const e=t[n];this.addLevel(e.object.clone(),e.distance,e.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;t=Math.abs(t);const i=this.levels;let r;for(r=0;r<i.length&&!(t<i[r].distance);r++);return i.splice(r,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,i;for(n=1,i=t.length;n<i;n++){let i=t[n].distance;if(t[n].object.visible&&(i-=i*t[n].hysteresis),e<i)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){hg.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(hg);this.getObjectForDistance(n).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){hg.setFromMatrixPosition(e.matrixWorld),Ig.setFromMatrixPosition(this.matrixWorld);const n=hg.distanceTo(Ig)/e.zoom;let i,r;for(t[0].object.visible=!0,i=1,r=t.length;i<r;i++){let e=t[i].distance;if(t[i].object.visible&&(e-=e*t[i].hysteresis),!(n>=e))break;t[i-1].object.visible=!1,t[i].object.visible=!0}for(this._currentLevel=i-1;i<r;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let i=0,r=n.length;i<r;i++){const e=n[i];t.object.levels.push({object:e.object.uuid,distance:e.distance,hysteresis:e.hysteresis})}return t}}const Cg=new Sr,mg=new fr,fg=new fr,yg=new Sr,bg=new rs,Bg=new Sr,vg=new Or,wg=new rs,Gg=new is;class Eg extends Qo{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=et,this.bindMatrix=new rs,this.bindMatrixInverse=new rs,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new Dr),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Bg),this.boundingBox.expandByPoint(Bg)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new Or),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Bg),this.boundingSphere.expandByPoint(Bg)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,i=this.matrixWorld;void 0!==n&&(null===this.boundingSphere&&this.computeBoundingSphere(),vg.copy(this.boundingSphere),vg.applyMatrix4(i),!1!==e.ray.intersectsSphere(vg)&&(wg.copy(i).invert(),Gg.copy(e.ray).applyMatrix4(wg),null!==this.boundingBox&&!1===Gg.intersectsBox(this.boundingBox)||this._computeIntersections(e,t,Gg)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new fr,t=this.geometry.attributes.skinWeight;for(let n=0,i=t.count;n<i;n++){e.fromBufferAttribute(t,n);const i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===et?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===tt?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,i=this.geometry;mg.fromBufferAttribute(i.attributes.skinIndex,e),fg.fromBufferAttribute(i.attributes.skinWeight,e),Cg.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let r=0;r<4;r++){const e=fg.getComponent(r);if(0!==e){const i=mg.getComponent(r);bg.multiplyMatrices(n.bones[i].matrixWorld,n.boneInverses[i]),t.addScaledVector(yg.copy(Cg).applyMatrix4(bg),e)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class xg extends Rs{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Sg extends mr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(null,arguments.length>5?arguments[5]:void 0,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8&&void 0!==arguments[8]?arguments[8]:ut,arguments.length>9&&void 0!==arguments[9]?arguments[9]:ut,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0,arguments.length>10?arguments[10]:void 0,arguments.length>11?arguments[11]:void 0),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Rg=new rs,Zg=new rs;class Dg{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.uuid=Hi(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new rs)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const t=new rs;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let r=0,s=e.length;r<s;r++){const i=e[r]?e[r].matrixWorld:Zg;Rg.multiplyMatrices(i,t[r]),Rg.toArray(n,16*r)}null!==i&&(i.needsUpdate=!0)}clone(){return new Dg(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Sg(t,e,e,Nt,xt);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const n=this.bones[t];if(n.name===e)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){const i=e.bones[n];let r=t[i];void 0===r&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),r=new xg),this.bones.push(r),this.boneInverses.push((new rs).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let i=0,r=t.length;i<r;i++){const r=t[i];e.bones.push(r.uuid);const s=n[i];e.boneInverses.push(s.toArray())}return e}}class Fg extends ro{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Ng=new rs,Mg=new rs,Wg=[],kg=new Dr,Tg=new rs,Vg=new Qo,Lg=new Or;class Hg extends Qo{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Fg(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<n;i++)this.setMatrixAt(i,Tg)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new Dr),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Ng),kg.copy(e.boundingBox).applyMatrix4(Ng),this.boundingBox.union(kg)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new Or),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Ng),Lg.copy(e.boundingSphere).applyMatrix4(Ng),this.boundingSphere.union(Lg)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const n=this.matrixWorld,i=this.count;if(Vg.geometry=this.geometry,Vg.material=this.material,void 0!==Vg.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),Lg.copy(this.boundingSphere),Lg.applyMatrix4(n),!1!==e.ray.intersectsSphere(Lg)))for(let r=0;r<i;r++){this.getMatrixAt(r,Ng),Mg.multiplyMatrices(n,Ng),Vg.matrixWorld=Mg,Vg.raycast(e,Wg);for(let e=0,n=Wg.length;e<n;e++){const n=Wg[e];n.instanceId=r,n.object=this,t.push(n)}Wg.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Fg(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}function Qg(e,t){return e.z-t.z}function Kg(e,t){return t.z-e.z}class Xg{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t){const n=this.pool,i=this.list;this.index>=n.length&&n.push({start:-1,count:-1,z:-1});const r=n[this.index];i.push(r),this.index++,r.start=e.start,r.count=e.count,r.z=t}reset(){this.list.length=0,this.index=0}}const Yg="batchId",zg=new rs,Pg=new rs,Ug=new rs,_g=new rs,Og=new aa,Jg=new Dr,jg=new Or,qg=new Sr,$g=new Xg,eu=new Qo,tu=[];function nu(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=t.itemSize;if(e.isInterleavedBufferAttribute||e.array.constructor!==t.array.constructor){const r=e.count;for(let s=0;s<r;s++)for(let r=0;r<i;r++)t.setComponent(s+n,r,e.getComponent(s,r))}else t.array.set(e.array,n*i);t.needsUpdate=!0}class iu extends Qo{get maxGeometryCount(){return this._maxGeometryCount}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2*t,i=arguments.length>3?arguments[3]:void 0;super(new vo,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let e=Math.sqrt(4*this._maxGeometryCount);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new Sg(t,e,e,Nt,xt);this._matricesTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,i=this._maxGeometryCount,r=this._maxIndexCount;if(!1===this._geometryInitialized){for(const i in e.attributes){const r=e.getAttribute(i),{array:s,itemSize:o,normalized:a}=r,l=new s.constructor(n*o),c=new r.constructor(l,o,a);c.setUsage(r.usage),t.setAttribute(i,c)}if(null!==e.getIndex()){const e=n>65536?new Uint32Array(r):new Uint16Array(r);t.setIndex(new ro(e,1))}const s=i>65536?new Uint32Array(n):new Uint16Array(n);t.setAttribute(Yg,new ro(s,1)),this._geometryInitialized=!0}}_validateGeometry(e){if(e.getAttribute(Yg))throw new Error('BatchedMesh: Geometry cannot use attribute "'.concat(Yg,'"'));const t=this.geometry;if(Boolean(e.getIndex())!==Boolean(t.getIndex()))throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(n===Yg)continue;if(!e.hasAttribute(n))throw new Error('BatchedMesh: Added geometry missing "'.concat(n,'". All geometries must have consistent attributes.'));const i=e.getAttribute(n),r=t.getAttribute(n);if(i.itemSize!==r.itemSize||i.normalized!==r.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Dr);const e=this._geometryCount,t=this.boundingBox,n=this._active;t.makeEmpty();for(let i=0;i<e;i++)!1!==n[i]&&(this.getMatrixAt(i,zg),this.getBoundingBoxAt(i,Jg).applyMatrix4(zg),t.union(Jg))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Or);const e=this._geometryCount,t=this.boundingSphere,n=this._active;t.makeEmpty();for(let i=0;i<e;i++)!1!==n[i]&&(this.getMatrixAt(i,zg),this.getBoundingSphereAt(i,jg).applyMatrix4(zg),t.union(jg))}addGeometry(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this._initializeGeometry(e),this._validateGeometry(e),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const i={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let r=null;const s=this._reservedRanges,o=this._drawRanges,a=this._bounds;0!==this._geometryCount&&(r=s[s.length-1]),i.vertexCount=-1===t?e.getAttribute("position").count:t,i.vertexStart=null===r?0:r.vertexStart+r.vertexCount;const l=e.getIndex(),c=null!==l;if(c&&(i.indexCount=-1===n?l.count:n,i.indexStart=null===r?0:r.indexStart+r.indexCount),-1!==i.indexStart&&i.indexStart+i.indexCount>this._maxIndexCount||i.vertexStart+i.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const g=this._visibility,u=this._active,A=this._matricesTexture,d=this._matricesTexture.image.data;g.push(!0),u.push(!0);const h=this._geometryCount;this._geometryCount++,Ug.toArray(d,16*h),A.needsUpdate=!0,s.push(i),o.push({start:c?i.indexStart:i.vertexStart,count:-1}),a.push({boxInitialized:!1,box:new Dr,sphereInitialized:!1,sphere:new Or});const I=this.geometry.getAttribute(Yg);for(let p=0;p<i.vertexCount;p++)I.setX(i.vertexStart+p,h);return I.needsUpdate=!0,this.setGeometryAt(h,e),h}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,i=null!==n.getIndex(),r=n.getIndex(),s=t.getIndex(),o=this._reservedRanges[e];if(i&&s.count>o.indexCount||t.attributes.position.count>o.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const a=o.vertexStart,l=o.vertexCount;for(const A in n.attributes){if(A===Yg)continue;const e=t.getAttribute(A),i=n.getAttribute(A);nu(e,i,a);const r=e.itemSize;for(let t=e.count,n=l;t<n;t++){const e=a+t;for(let t=0;t<r;t++)i.setComponent(e,t,0)}i.needsUpdate=!0}if(i){const e=o.indexStart;for(let t=0;t<s.count;t++)r.setX(e+t,a+s.getX(t));for(let t=s.count,n=o.indexCount;t<n;t++)r.setX(e+t,a);r.needsUpdate=!0}const c=this._bounds[e];null!==t.boundingBox?(c.box.copy(t.boundingBox),c.boxInitialized=!0):c.boxInitialized=!1,null!==t.boundingSphere?(c.sphere.copy(t.boundingSphere),c.sphereInitialized=!0):c.sphereInitialized=!1;const g=this._drawRanges[e],u=t.getAttribute("position");return g.count=i?s.count:u.count,this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._active;return e>=t.length||!1===t[e]||(t[e]=!1,this._visibilityChanged=!0),this}getBoundingBoxAt(e,t){if(!1===this._active[e])return this;const n=this._bounds[e],i=n.box,r=this.geometry;if(!1===n.boxInitialized){i.makeEmpty();const t=r.index,s=r.attributes.position,o=this._drawRanges[e];for(let e=o.start,n=o.start+o.count;e<n;e++){let n=e;t&&(n=t.getX(n)),i.expandByPoint(qg.fromBufferAttribute(s,n))}n.boxInitialized=!0}return t.copy(i),t}getBoundingSphereAt(e,t){if(!1===this._active[e])return this;const n=this._bounds[e],i=n.sphere,r=this.geometry;if(!1===n.sphereInitialized){i.makeEmpty(),this.getBoundingBoxAt(e,Jg),Jg.getCenter(i.center);const t=r.index,s=r.attributes.position,o=this._drawRanges[e];let a=0;for(let e=o.start,n=o.start+o.count;e<n;e++){let n=e;t&&(n=t.getX(n)),qg.fromBufferAttribute(s,n),a=Math.max(a,i.center.distanceToSquared(qg))}i.radius=Math.sqrt(a),n.sphereInitialized=!0}return t.copy(i),t}setMatrixAt(e,t){const n=this._active,i=this._matricesTexture,r=this._matricesTexture.image.data;return e>=this._geometryCount||!1===n[e]||(t.toArray(r,16*e),i.needsUpdate=!0),this}getMatrixAt(e,t){const n=this._active,i=this._matricesTexture.image.data;return e>=this._geometryCount||!1===n[e]?null:t.fromArray(i,16*e)}setVisibleAt(e,t){const n=this._visibility,i=this._active;return e>=this._geometryCount||!1===i[e]||n[e]===t||(n[e]=t,this._visibilityChanged=!0),this}getVisibleAt(e){const t=this._visibility,n=this._active;return!(e>=this._geometryCount||!1===n[e])&&t[e]}raycast(e,t){const n=this._visibility,i=this._active,r=this._drawRanges,s=this._geometryCount,o=this.matrixWorld,a=this.geometry;eu.material=this.material,eu.geometry.index=a.index,eu.geometry.attributes=a.attributes,null===eu.geometry.boundingBox&&(eu.geometry.boundingBox=new Dr),null===eu.geometry.boundingSphere&&(eu.geometry.boundingSphere=new Or);for(let l=0;l<s;l++){if(!n[l]||!i[l])continue;const s=r[l];eu.geometry.setDrawRange(s.start,s.count),this.getMatrixAt(l,eu.matrixWorld).premultiply(o),this.getBoundingBoxAt(l,eu.geometry.boundingBox),this.getBoundingSphereAt(l,eu.geometry.boundingSphere),eu.raycast(e,tu);for(let e=0,n=tu.length;e<n;e++){const n=tu[e];n.object=this,n.batchId=l,t.push(n)}tu.length=0}eu.material=null,eu.geometry.index=null,eu.geometry.attributes={},eu.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=null!==e.boundingBox?e.boundingBox.clone():null,this.boundingSphere=null!==e.boundingSphere?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map((e=>({...e}))),this._reservedRanges=e._reservedRanges.map((e=>({...e}))),this._visibility=e._visibility.slice(),this._active=e._active.slice(),this._bounds=e._bounds.map((e=>({boxInitialized:e.boxInitialized,box:e.box.clone(),sphereInitialized:e.sphereInitialized,sphere:e.sphere.clone()}))),this._maxGeometryCount=e._maxGeometryCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(e,t,n,i,r){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const s=i.getIndex(),o=null===s?1:s.array.BYTES_PER_ELEMENT,a=this._visibility,l=this._multiDrawStarts,c=this._multiDrawCounts,g=this._drawRanges,u=this.perObjectFrustumCulled;u&&(_g.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),Og.setFromProjectionMatrix(_g,e.isWebGPURenderer?Mi:Ni));let A=0;if(this.sortObjects){Pg.copy(this.matrixWorld).invert(),qg.setFromMatrixPosition(n.matrixWorld).applyMatrix4(Pg);for(let n=0,i=a.length;n<i;n++)if(a[n]){this.getMatrixAt(n,zg),this.getBoundingSphereAt(n,jg).applyMatrix4(zg);let e=!1;if(u&&(e=!Og.intersectsSphere(jg)),!e){const e=qg.distanceTo(jg.center);$g.push(g[n],e)}}const e=$g.list,t=this.customSort;null===t?e.sort(r.transparent?Kg:Qg):t.call(this,e,n);for(let n=0,i=e.length;n<i;n++){const t=e[n];l[A]=t.start*o,c[A]=t.count,A++}$g.reset()}else for(let d=0,h=a.length;d<h;d++)if(a[d]){let e=!1;if(u&&(this.getMatrixAt(d,zg),this.getBoundingSphereAt(d,jg).applyMatrix4(zg),e=!Og.intersectsSphere(jg)),!e){const e=g[d];l[A]=e.start*o,c[A]=e.count,A++}}this._multiDrawCount=A,this._visibilityChanged=!1}onBeforeShadow(e,t,n,i,r,s){this.onBeforeRender(e,null,i,r,s)}}class ru extends Os{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ps(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const su=new Sr,ou=new Sr,au=new rs,lu=new is,cu=new Or;class gu extends Rs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new vo,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ru;super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let e=1,i=t.count;e<i;e++)su.fromBufferAttribute(t,e-1),ou.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=su.distanceTo(ou);e.setAttribute("lineDistance",new ho(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,r=e.params.Line.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),cu.copy(n.boundingSphere),cu.applyMatrix4(i),cu.radius+=r,!1===e.ray.intersectsSphere(cu))return;au.copy(i).invert(),lu.copy(e.ray).applyMatrix4(au);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=new Sr,c=new Sr,g=new Sr,u=new Sr,A=this.isLineSegments?2:1,d=n.index,h=n.attributes.position;if(null!==d){for(let n=Math.max(0,s.start),i=Math.min(d.count,s.start+s.count)-1;n<i;n+=A){const i=d.getX(n),r=d.getX(n+1);l.fromBufferAttribute(h,i),c.fromBufferAttribute(h,r);if(lu.distanceSqToSegment(l,c,u,g)>a)continue;u.applyMatrix4(this.matrixWorld);const s=e.ray.origin.distanceTo(u);s<e.near||s>e.far||t.push({distance:s,point:g.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else{for(let n=Math.max(0,s.start),i=Math.min(h.count,s.start+s.count)-1;n<i;n+=A){l.fromBufferAttribute(h,n),c.fromBufferAttribute(h,n+1);if(lu.distanceSqToSegment(l,c,u,g)>a)continue;u.applyMatrix4(this.matrixWorld);const i=e.ray.origin.distanceTo(u);i<e.near||i>e.far||t.push({distance:i,point:g.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}const uu=new Sr,Au=new Sr;class du extends gu{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let e=0,i=t.count;e<i;e+=2)uu.fromBufferAttribute(t,e),Au.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+uu.distanceTo(Au);e.setAttribute("lineDistance",new ho(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class hu extends gu{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Iu extends Os{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ps(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const pu=new rs,Cu=new is,mu=new Or,fu=new Sr;class yu extends Rs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new vo,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Iu;super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,r=e.params.Points.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),mu.copy(n.boundingSphere),mu.applyMatrix4(i),mu.radius+=r,!1===e.ray.intersectsSphere(mu))return;pu.copy(i).invert(),Cu.copy(e.ray).applyMatrix4(pu);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=n.index,c=n.attributes.position;if(null!==l){for(let n=Math.max(0,s.start),r=Math.min(l.count,s.start+s.count);n<r;n++){const r=l.getX(n);fu.fromBufferAttribute(c,r),bu(fu,r,a,i,e,t,this)}}else{for(let n=Math.max(0,s.start),r=Math.min(c.count,s.start+s.count);n<r;n++)fu.fromBufferAttribute(c,n),bu(fu,n,a,i,e,t,this)}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function bu(e,t,n,i,r,s,o){const a=Cu.distanceSqToPoint(e);if(a<n){const n=new Sr;Cu.closestPointToPoint(e,n),n.applyMatrix4(i);const l=r.ray.origin.distanceTo(n);if(l<r.near||l>r.far)return;s.push({distance:l,distanceToRay:Math.sqrt(a),point:n,index:t,face:null,object:o})}}class Bu extends mr{constructor(e,t,n,i,r,s,o,a,l){super(e,t,n,i,r,s,o,a,l),this.isVideoTexture=!0,this.minFilter=void 0!==s?s:pt,this.magFilter=void 0!==r?r:pt,this.generateMipmaps=!1;const c=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){c.needsUpdate=!0,e.requestVideoFrameCallback(t)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!1==="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class vu extends mr{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=ut,this.minFilter=ut,this.generateMipmaps=!1,this.needsUpdate=!0}}class wu extends mr{constructor(e,t,n,i,r,s,o,a,l,c,g,u){super(null,s,o,a,l,c,i,r,g,u),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class Gu extends wu{constructor(e,t,n,i,r,s){super(e,t,n,r,s),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=ct}}class Eu extends wu{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,it),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class xu extends mr{constructor(e,t,n,i,r,s,o,a,l){super(e,t,n,i,r,s,o,a,l),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Su{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,i=this.getPoint(0),r=0;t.push(0);for(let s=1;s<=e;s++)n=this.getPoint(s/e),r+=n.distanceTo(i),t.push(r),i=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let i=0;const r=n.length;let s;s=t||e*n[r-1];let o,a=0,l=r-1;for(;a<=l;)if(i=Math.floor(a+(l-a)/2),o=n[i]-s,o<0)a=i+1;else{if(!(o>0)){l=i;break}l=i-1}if(i=l,n[i]===s)return i/(r-1);const c=n[i];return(i+(s-c)/(n[i+1]-c))/(r-1)}getTangent(e,t){const n=1e-4;let i=e-n,r=e+n;i<0&&(i=0),r>1&&(r=1);const s=this.getPoint(i),o=this.getPoint(r),a=t||(s.isVector2?new Oi:new Sr);return a.copy(o).sub(s).normalize(),a}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new Sr,i=[],r=[],s=[],o=new Sr,a=new rs;for(let A=0;A<=e;A++){const t=A/e;i[A]=this.getTangentAt(t,new Sr)}r[0]=new Sr,s[0]=new Sr;let l=Number.MAX_VALUE;const c=Math.abs(i[0].x),g=Math.abs(i[0].y),u=Math.abs(i[0].z);c<=l&&(l=c,n.set(1,0,0)),g<=l&&(l=g,n.set(0,1,0)),u<=l&&n.set(0,0,1),o.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],o),s[0].crossVectors(i[0],r[0]);for(let A=1;A<=e;A++){if(r[A]=r[A-1].clone(),s[A]=s[A-1].clone(),o.crossVectors(i[A-1],i[A]),o.length()>Number.EPSILON){o.normalize();const e=Math.acos(Qi(i[A-1].dot(i[A]),-1,1));r[A].applyMatrix4(a.makeRotationAxis(o,e))}s[A].crossVectors(i[A],r[A])}if(!0===t){let t=Math.acos(Qi(r[0].dot(r[e]),-1,1));t/=e,i[0].dot(o.crossVectors(r[0],r[e]))>0&&(t=-t);for(let n=1;n<=e;n++)r[n].applyMatrix4(a.makeRotationAxis(i[n],t*n)),s[n].crossVectors(i[n],r[n])}return{tangents:i,normals:r,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Ru extends Su{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=s,this.aClockwise=o,this.aRotation=a}getPoint(e,t){const n=t||new Oi,i=2*Math.PI;let r=this.aEndAngle-this.aStartAngle;const s=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(r=s?0:i),!0!==this.aClockwise||s||(r===i?r=-i:r-=i);const o=this.aStartAngle+e*r;let a=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){const e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),n=a-this.aX,i=l-this.aY;a=n*e-i*t+this.aX,l=n*t+i*e+this.aY}return n.set(a,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Zu extends Ru{constructor(e,t,n,i,r,s){super(e,t,n,n,i,r,s),this.isArcCurve=!0,this.type="ArcCurve"}}function Du(){let e=0,t=0,n=0,i=0;function r(r,s,o,a){e=r,t=o,n=-3*r+3*s-2*o-a,i=2*r-2*s+o+a}return{initCatmullRom:function(e,t,n,i,s){r(t,n,s*(n-e),s*(i-t))},initNonuniformCatmullRom:function(e,t,n,i,s,o,a){let l=(t-e)/s-(n-e)/(s+o)+(n-t)/o,c=(n-t)/o-(i-t)/(o+a)+(i-n)/a;l*=o,c*=o,r(t,n,l,c)},calc:function(r){const s=r*r;return e+t*r+n*s+i*(s*r)}}}const Fu=new Sr,Nu=new Du,Mu=new Du,Wu=new Du;class ku extends Su{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sr,n=this.points,i=n.length,r=(i-(this.closed?0:1))*e;let s,o,a=Math.floor(r),l=r-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/i)+1)*i:0===l&&a===i-1&&(a=i-2,l=1),this.closed||a>0?s=n[(a-1)%i]:(Fu.subVectors(n[0],n[1]).add(n[0]),s=Fu);const c=n[a%i],g=n[(a+1)%i];if(this.closed||a+2<i?o=n[(a+2)%i]:(Fu.subVectors(n[i-1],n[i-2]).add(n[i-1]),o=Fu),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(s.distanceToSquared(c),e),n=Math.pow(c.distanceToSquared(g),e),i=Math.pow(g.distanceToSquared(o),e);n<1e-4&&(n=1),t<1e-4&&(t=n),i<1e-4&&(i=n),Nu.initNonuniformCatmullRom(s.x,c.x,g.x,o.x,t,n,i),Mu.initNonuniformCatmullRom(s.y,c.y,g.y,o.y,t,n,i),Wu.initNonuniformCatmullRom(s.z,c.z,g.z,o.z,t,n,i)}else"catmullrom"===this.curveType&&(Nu.initCatmullRom(s.x,c.x,g.x,o.x,this.tension),Mu.initCatmullRom(s.y,c.y,g.y,o.y,this.tension),Wu.initCatmullRom(s.z,c.z,g.z,o.z,this.tension));return t.set(Nu.calc(l),Mu.calc(l),Wu.calc(l)),t}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new Sr).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Tu(e,t,n,i,r){const s=.5*(i-t),o=.5*(r-n),a=e*e;return(2*n-2*i+s+o)*(e*a)+(-3*n+3*i-2*s-o)*a+s*e+n}function Vu(e,t,n,i){return function(e,t){const n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,i)}function Lu(e,t,n,i,r){return function(e,t){const n=1-e;return n*n*n*t}(e,t)+function(e,t){const n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,i)+function(e,t){return e*e*e*t}(e,r)}class Hu extends Su{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Oi,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oi,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Oi,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Oi;super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oi,n=this.v0,i=this.v1,r=this.v2,s=this.v3;return t.set(Lu(e,n.x,i.x,r.x,s.x),Lu(e,n.y,i.y,r.y,s.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Qu extends Su{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Sr,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sr,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Sr,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Sr;super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sr,n=this.v0,i=this.v1,r=this.v2,s=this.v3;return t.set(Lu(e,n.x,i.x,r.x,s.x),Lu(e,n.y,i.y,r.y,s.y),Lu(e,n.z,i.z,r.z,s.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Ku extends Su{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Oi,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oi;super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oi;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oi).subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Xu extends Su{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Sr,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sr;super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sr;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sr).subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Yu extends Su{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Oi,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oi,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Oi;super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oi,n=this.v0,i=this.v1,r=this.v2;return t.set(Vu(e,n.x,i.x,r.x),Vu(e,n.y,i.y,r.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class zu extends Su{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Sr,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sr,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Sr;super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sr,n=this.v0,i=this.v1,r=this.v2;return t.set(Vu(e,n.x,i.x,r.x),Vu(e,n.y,i.y,r.y),Vu(e,n.z,i.z,r.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Pu extends Su{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oi,n=this.points,i=(n.length-1)*e,r=Math.floor(i),s=i-r,o=n[0===r?r:r-1],a=n[r],l=n[r>n.length-2?n.length-1:r+1],c=n[r>n.length-3?n.length-1:r+2];return t.set(Tu(s,o.x,a.x,l.x,c.x),Tu(s,o.y,a.y,l.y,c.y)),t}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new Oi).fromArray(n))}return this}}var Uu=Object.freeze({__proto__:null,ArcCurve:Zu,CatmullRomCurve3:ku,CubicBezierCurve:Hu,CubicBezierCurve3:Qu,EllipseCurve:Ru,LineCurve:Ku,LineCurve3:Xu,QuadraticBezierCurve:Yu,QuadraticBezierCurve3:zu,SplineCurve:Pu});class _u extends Su{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=!0===e.isVector2?"LineCurve":"LineCurve3";this.curves.push(new Uu[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),i=this.getCurveLengths();let r=0;for(;r<i.length;){if(i[r]>=n){const e=i[r]-n,s=this.curves[r],o=s.getLength(),a=0===o?0:1-e/o;return s.getPointAt(a,t)}r++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40;const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;const t=[];let n;for(let i=0,r=this.curves;i<r.length;i++){const s=r[i],o=s.isEllipseCurve?2*e:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,a=s.getPoints(o);for(let e=0;e<a.length;e++){const i=a[e];n&&n.equals(i)||(t.push(i),n=i)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push((new Uu[n.type]).fromJSON(n))}return this}}class Ou extends _u{constructor(e){super(),this.type="Path",this.currentPoint=new Oi,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new Ku(this.currentPoint.clone(),new Oi(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){const r=new Yu(this.currentPoint.clone(),new Oi(e,t),new Oi(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,r,s){const o=new Hu(this.currentPoint.clone(),new Oi(e,t),new Oi(n,i),new Oi(r,s));return this.curves.push(o),this.currentPoint.set(r,s),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new Pu(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,r,s){const o=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(e+o,t+a,n,i,r,s),this}absarc(e,t,n,i,r,s){return this.absellipse(e,t,n,n,i,r,s),this}ellipse(e,t,n,i,r,s,o,a){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,n,i,r,s,o,a),this}absellipse(e,t,n,i,r,s,o,a){const l=new Ru(e,t,n,i,r,s,o,a);if(this.curves.length>0){const e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Ju extends vo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[new Oi(0,-.5),new Oi(.5,0),new Oi(0,.5)],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t),i=Qi(i,0,2*Math.PI);const r=[],s=[],o=[],a=[],l=[],c=1/t,g=new Sr,u=new Oi,A=new Sr,d=new Sr,h=new Sr;let I=0,p=0;for(let C=0;C<=e.length-1;C++)switch(C){case 0:I=e[C+1].x-e[C].x,p=e[C+1].y-e[C].y,A.x=1*p,A.y=-I,A.z=0*p,h.copy(A),A.normalize(),a.push(A.x,A.y,A.z);break;case e.length-1:a.push(h.x,h.y,h.z);break;default:I=e[C+1].x-e[C].x,p=e[C+1].y-e[C].y,A.x=1*p,A.y=-I,A.z=0*p,d.copy(A),A.x+=h.x,A.y+=h.y,A.z+=h.z,A.normalize(),a.push(A.x,A.y,A.z),h.copy(d)}for(let C=0;C<=t;C++){const r=n+C*c*i,A=Math.sin(r),d=Math.cos(r);for(let n=0;n<=e.length-1;n++){g.x=e[n].x*A,g.y=e[n].y,g.z=e[n].x*d,s.push(g.x,g.y,g.z),u.x=C/t,u.y=n/(e.length-1),o.push(u.x,u.y);const i=a[3*n+0]*A,r=a[3*n+1],c=a[3*n+0]*d;l.push(i,r,c)}}for(let C=0;C<t;C++)for(let t=0;t<e.length-1;t++){const n=t+C*e.length,i=n,s=n+e.length,o=n+e.length+1,a=n+1;r.push(i,s,a),r.push(o,a,s)}this.setIndex(r),this.setAttribute("position",new ho(s,3)),this.setAttribute("uv",new ho(o,2)),this.setAttribute("normal",new ho(l,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ju(e.points,e.segments,e.phiStart,e.phiLength)}}class ju extends Ju{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8;const r=new Ou;r.absarc(0,-t/2,e,1.5*Math.PI,0),r.absarc(0,t/2,e,0,.5*Math.PI),super(r.getPoints(n),i),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:n,radialSegments:i}}static fromJSON(e){return new ju(e.radius,e.length,e.capSegments,e.radialSegments)}}class qu extends vo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},t=Math.max(3,t);const r=[],s=[],o=[],a=[],l=new Sr,c=new Oi;s.push(0,0,0),o.push(0,0,1),a.push(.5,.5);for(let g=0,u=3;g<=t;g++,u+=3){const r=n+g/t*i;l.x=e*Math.cos(r),l.y=e*Math.sin(r),s.push(l.x,l.y,l.z),o.push(0,0,1),c.x=(s[u]/e+1)/2,c.y=(s[u+1]/e+1)/2,a.push(c.x,c.y)}for(let g=1;g<=t;g++)r.push(g,g+1,0);this.setIndex(r),this.setAttribute("position",new ho(s,3)),this.setAttribute("normal",new ho(o,3)),this.setAttribute("uv",new ho(a,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new qu(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class $u extends vo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a};const l=this;i=Math.floor(i),r=Math.floor(r);const c=[],g=[],u=[],A=[];let d=0;const h=[],I=n/2;let p=0;function C(n){const r=d,s=new Oi,h=new Sr;let C=0;const m=!0===n?e:t,f=!0===n?1:-1;for(let e=1;e<=i;e++)g.push(0,I*f,0),u.push(0,f,0),A.push(.5,.5),d++;const y=d;for(let e=0;e<=i;e++){const t=e/i*a+o,n=Math.cos(t),r=Math.sin(t);h.x=m*r,h.y=I*f,h.z=m*n,g.push(h.x,h.y,h.z),u.push(0,f,0),s.x=.5*n+.5,s.y=.5*r*f+.5,A.push(s.x,s.y),d++}for(let e=0;e<i;e++){const t=r+e,i=y+e;!0===n?c.push(i,i+1,t):c.push(i+1,i,t),C+=3}l.addGroup(p,C,!0===n?1:2),p+=C}!function(){const s=new Sr,C=new Sr;let m=0;const f=(t-e)/n;for(let l=0;l<=r;l++){const c=[],p=l/r,m=p*(t-e)+e;for(let e=0;e<=i;e++){const t=e/i,r=t*a+o,l=Math.sin(r),h=Math.cos(r);C.x=m*l,C.y=-p*n+I,C.z=m*h,g.push(C.x,C.y,C.z),s.set(l,f,h).normalize(),u.push(s.x,s.y,s.z),A.push(t,1-p),c.push(d++)}h.push(c)}for(let e=0;e<i;e++)for(let t=0;t<r;t++){const n=h[t][e],i=h[t+1][e],r=h[t+1][e+1],s=h[t][e+1];c.push(n,i,s),c.push(i,r,s),m+=6}l.addGroup(p,m,0),p+=m}(),!1===s&&(e>0&&C(!0),t>0&&C(!1)),this.setIndex(c),this.setAttribute("position",new ho(g,3)),this.setAttribute("normal",new ho(u,3)),this.setAttribute("uv",new ho(A,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $u(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class eA extends $u{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI;super(0,e,t,n,i,r,s,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:s,thetaLength:o}}static fromJSON(e){return new eA(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class tA extends vo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i};const r=[],s=[];function o(e,t,n,i){const r=i+1,s=[];for(let o=0;o<=r;o++){s[o]=[];const i=e.clone().lerp(n,o/r),a=t.clone().lerp(n,o/r),l=r-o;for(let e=0;e<=l;e++)s[o][e]=0===e&&o===r?i:i.clone().lerp(a,e/l)}for(let o=0;o<r;o++)for(let e=0;e<2*(r-o)-1;e++){const t=Math.floor(e/2);e%2===0?(a(s[o][t+1]),a(s[o+1][t]),a(s[o][t])):(a(s[o][t+1]),a(s[o+1][t+1]),a(s[o+1][t]))}}function a(e){r.push(e.x,e.y,e.z)}function l(t,n){const i=3*t;n.x=e[i+0],n.y=e[i+1],n.z=e[i+2]}function c(e,t,n,i){i<0&&1===e.x&&(s[t]=e.x-1),0===n.x&&0===n.z&&(s[t]=i/2/Math.PI+.5)}function g(e){return Math.atan2(e.z,-e.x)}!function(e){const n=new Sr,i=new Sr,r=new Sr;for(let s=0;s<t.length;s+=3)l(t[s+0],n),l(t[s+1],i),l(t[s+2],r),o(n,i,r,e)}(i),function(e){const t=new Sr;for(let n=0;n<r.length;n+=3)t.x=r[n+0],t.y=r[n+1],t.z=r[n+2],t.normalize().multiplyScalar(e),r[n+0]=t.x,r[n+1]=t.y,r[n+2]=t.z}(n),function(){const e=new Sr;for(let n=0;n<r.length;n+=3){e.x=r[n+0],e.y=r[n+1],e.z=r[n+2];const i=g(e)/2/Math.PI+.5,o=(t=e,Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5);s.push(i,1-o)}var t;(function(){const e=new Sr,t=new Sr,n=new Sr,i=new Sr,o=new Oi,a=new Oi,l=new Oi;for(let u=0,A=0;u<r.length;u+=9,A+=6){e.set(r[u+0],r[u+1],r[u+2]),t.set(r[u+3],r[u+4],r[u+5]),n.set(r[u+6],r[u+7],r[u+8]),o.set(s[A+0],s[A+1]),a.set(s[A+2],s[A+3]),l.set(s[A+4],s[A+5]),i.copy(e).add(t).add(n).divideScalar(3);const d=g(i);c(o,A+0,e,d),c(a,A+2,t,d),c(l,A+4,n,d)}})(),function(){for(let e=0;e<s.length;e+=6){const t=s[e+0],n=s[e+2],i=s[e+4],r=Math.max(t,n,i),o=Math.min(t,n,i);r>.9&&o<.1&&(t<.2&&(s[e+0]+=1),n<.2&&(s[e+2]+=1),i<.2&&(s[e+4]+=1))}}()}(),this.setAttribute("position",new ho(r,3)),this.setAttribute("normal",new ho(r.slice(),3)),this.setAttribute("uv",new ho(s,2)),0===i?this.computeVertexNormals():this.normalizeNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new tA(e.vertices,e.indices,e.radius,e.details)}}class nA extends tA{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(1+Math.sqrt(5))/2,i=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new nA(e.radius,e.detail)}}const iA=new Sr,rA=new Sr,sA=new Sr,oA=new Qs;class aA extends vo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const n=4,i=Math.pow(10,n),r=Math.cos(Vi*t),s=e.getIndex(),o=e.getAttribute("position"),a=s?s.count:o.count,l=[0,0,0],c=["a","b","c"],g=new Array(3),u={},A=[];for(let e=0;e<a;e+=3){s?(l[0]=s.getX(e),l[1]=s.getX(e+1),l[2]=s.getX(e+2)):(l[0]=e,l[1]=e+1,l[2]=e+2);const{a:t,b:n,c:a}=oA;if(t.fromBufferAttribute(o,l[0]),n.fromBufferAttribute(o,l[1]),a.fromBufferAttribute(o,l[2]),oA.getNormal(sA),g[0]="".concat(Math.round(t.x*i),",").concat(Math.round(t.y*i),",").concat(Math.round(t.z*i)),g[1]="".concat(Math.round(n.x*i),",").concat(Math.round(n.y*i),",").concat(Math.round(n.z*i)),g[2]="".concat(Math.round(a.x*i),",").concat(Math.round(a.y*i),",").concat(Math.round(a.z*i)),g[0]!==g[1]&&g[1]!==g[2]&&g[2]!==g[0])for(let e=0;e<3;e++){const t=(e+1)%3,n=g[e],i=g[t],s=oA[c[e]],o=oA[c[t]],a="".concat(n,"_").concat(i),d="".concat(i,"_").concat(n);d in u&&u[d]?(sA.dot(u[d].normal)<=r&&(A.push(s.x,s.y,s.z),A.push(o.x,o.y,o.z)),u[d]=null):a in u||(u[a]={index0:l[e],index1:l[t],normal:sA.clone()})}}for(const e in u)if(u[e]){const{index0:t,index1:n}=u[e];iA.fromBufferAttribute(o,t),rA.fromBufferAttribute(o,n),A.push(iA.x,iA.y,iA.z),A.push(rA.x,rA.y,rA.z)}this.setAttribute("position",new ho(A,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class lA extends Ou{constructor(e){super(e),this.uuid=Hi(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push((new Ou).fromJSON(n))}return this}}const cA=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const i=t&&t.length,r=i?t[0]*n:e.length;let s=gA(e,0,r,n,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,g,u,A,d;if(i&&(s=function(e,t,n,i){const r=[];let s,o,a,l,c;for(s=0,o=t.length;s<o;s++)a=t[s]*i,l=s<o-1?t[s+1]*i:e.length,c=gA(e,a,l,i,!1),c===c.next&&(c.steiner=!0),r.push(bA(c));for(r.sort(CA),s=0;s<r.length;s++)n=mA(r[s],n);return n}(e,t,s,n)),e.length>80*n){a=c=e[0],l=g=e[1];for(let t=n;t<r;t+=n)u=e[t],A=e[t+1],u<a&&(a=u),A<l&&(l=A),u>c&&(c=u),A>g&&(g=A);d=Math.max(c-a,g-l),d=0!==d?32767/d:0}return AA(s,o,n,a,l,d,0),o};function gA(e,t,n,i,r){let s,o;if(r===function(e,t,n,i){let r=0;for(let s=t,o=n-i;s<n;s+=i)r+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return r}(e,t,n,i)>0)for(s=t;s<n;s+=i)o=DA(s,e[s],e[s+1],o);else for(s=n-i;s>=t;s-=i)o=DA(s,e[s],e[s+1],o);return o&&GA(o,o.next)&&(FA(o),o=o.next),o}function uA(e,t){if(!e)return e;t||(t=e);let n,i=e;do{if(n=!1,i.steiner||!GA(i,i.next)&&0!==wA(i.prev,i,i.next))i=i.next;else{if(FA(i),i=t=i.prev,i===i.next)break;n=!0}}while(n||i!==t);return t}function AA(e,t,n,i,r,s,o){if(!e)return;!o&&s&&function(e,t,n,i){let r=e;do{0===r.z&&(r.z=yA(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){let t,n,i,r,s,o,a,l,c=1;do{for(n=e,e=null,s=null,o=0;n;){for(o++,i=n,a=0,t=0;t<c&&(a++,i=i.nextZ,i);t++);for(l=c;a>0||l>0&&i;)0!==a&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:e=r,r.prevZ=s,s=r;n=i}s.nextZ=null,c*=2}while(o>1)}(r)}(e,i,r,s);let a,l,c=e;for(;e.prev!==e.next;)if(a=e.prev,l=e.next,s?hA(e,i,r,s):dA(e))t.push(a.i/n|0),t.push(e.i/n|0),t.push(l.i/n|0),FA(e),e=l.next,c=l.next;else if((e=l)===c){o?1===o?AA(e=IA(uA(e),t,n),t,n,i,r,s,2):2===o&&pA(e,t,n,i,r,s):AA(uA(e),t,n,i,r,s,1);break}}function dA(e){const t=e.prev,n=e,i=e.next;if(wA(t,n,i)>=0)return!1;const r=t.x,s=n.x,o=i.x,a=t.y,l=n.y,c=i.y,g=r<s?r<o?r:o:s<o?s:o,u=a<l?a<c?a:c:l<c?l:c,A=r>s?r>o?r:o:s>o?s:o,d=a>l?a>c?a:c:l>c?l:c;let h=i.next;for(;h!==t;){if(h.x>=g&&h.x<=A&&h.y>=u&&h.y<=d&&BA(r,a,s,l,o,c,h.x,h.y)&&wA(h.prev,h,h.next)>=0)return!1;h=h.next}return!0}function hA(e,t,n,i){const r=e.prev,s=e,o=e.next;if(wA(r,s,o)>=0)return!1;const a=r.x,l=s.x,c=o.x,g=r.y,u=s.y,A=o.y,d=a<l?a<c?a:c:l<c?l:c,h=g<u?g<A?g:A:u<A?u:A,I=a>l?a>c?a:c:l>c?l:c,p=g>u?g>A?g:A:u>A?u:A,C=yA(d,h,t,n,i),m=yA(I,p,t,n,i);let f=e.prevZ,y=e.nextZ;for(;f&&f.z>=C&&y&&y.z<=m;){if(f.x>=d&&f.x<=I&&f.y>=h&&f.y<=p&&f!==r&&f!==o&&BA(a,g,l,u,c,A,f.x,f.y)&&wA(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,y.x>=d&&y.x<=I&&y.y>=h&&y.y<=p&&y!==r&&y!==o&&BA(a,g,l,u,c,A,y.x,y.y)&&wA(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;f&&f.z>=C;){if(f.x>=d&&f.x<=I&&f.y>=h&&f.y<=p&&f!==r&&f!==o&&BA(a,g,l,u,c,A,f.x,f.y)&&wA(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;y&&y.z<=m;){if(y.x>=d&&y.x<=I&&y.y>=h&&y.y<=p&&y!==r&&y!==o&&BA(a,g,l,u,c,A,y.x,y.y)&&wA(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function IA(e,t,n){let i=e;do{const r=i.prev,s=i.next.next;!GA(r,s)&&EA(r,i,i.next,s)&&RA(r,s)&&RA(s,r)&&(t.push(r.i/n|0),t.push(i.i/n|0),t.push(s.i/n|0),FA(i),FA(i.next),i=e=s),i=i.next}while(i!==e);return uA(i)}function pA(e,t,n,i,r,s){let o=e;do{let e=o.next.next;for(;e!==o.prev;){if(o.i!==e.i&&vA(o,e)){let a=ZA(o,e);return o=uA(o,o.next),a=uA(a,a.next),AA(o,t,n,i,r,s,0),void AA(a,t,n,i,r,s,0)}e=e.next}o=o.next}while(o!==e)}function CA(e,t){return e.x-t.x}function mA(e,t){const n=function(e,t){let n,i=t,r=-1/0;const s=e.x,o=e.y;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){const e=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(e<=s&&e>r&&(r=e,n=i.x<i.next.x?i:i.next,e===s))return n}i=i.next}while(i!==t);if(!n)return null;const a=n,l=n.x,c=n.y;let g,u=1/0;i=n;do{s>=i.x&&i.x>=l&&s!==i.x&&BA(o<c?s:r,o,l,c,o<c?r:s,o,i.x,i.y)&&(g=Math.abs(o-i.y)/(s-i.x),RA(i,e)&&(g<u||g===u&&(i.x>n.x||i.x===n.x&&fA(n,i)))&&(n=i,u=g)),i=i.next}while(i!==a);return n}(e,t);if(!n)return t;const i=ZA(n,e);return uA(i,i.next),uA(n,n.next)}function fA(e,t){return wA(e.prev,e,t.prev)<0&&wA(t.next,e,e.next)<0}function yA(e,t,n,i,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function bA(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function BA(e,t,n,i,r,s,o,a){return(r-o)*(t-a)>=(e-o)*(s-a)&&(e-o)*(i-a)>=(n-o)*(t-a)&&(n-o)*(s-a)>=(r-o)*(i-a)}function vA(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&EA(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(RA(e,t)&&RA(t,e)&&function(e,t){let n=e,i=!1;const r=(e.x+t.x)/2,s=(e.y+t.y)/2;do{n.y>s!==n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}(e,t)&&(wA(e.prev,e,t.prev)||wA(e,t.prev,t))||GA(e,t)&&wA(e.prev,e,e.next)>0&&wA(t.prev,t,t.next)>0)}function wA(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function GA(e,t){return e.x===t.x&&e.y===t.y}function EA(e,t,n,i){const r=SA(wA(e,t,n)),s=SA(wA(e,t,i)),o=SA(wA(n,i,e)),a=SA(wA(n,i,t));return r!==s&&o!==a||(!(0!==r||!xA(e,n,t))||(!(0!==s||!xA(e,i,t))||(!(0!==o||!xA(n,e,i))||!(0!==a||!xA(n,t,i)))))}function xA(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function SA(e){return e>0?1:e<0?-1:0}function RA(e,t){return wA(e.prev,e,e.next)<0?wA(e,t,e.next)>=0&&wA(e,e.prev,t)>=0:wA(e,t,e.prev)<0||wA(e,e.next,t)<0}function ZA(e,t){const n=new NA(e.i,e.x,e.y),i=new NA(t.i,t.x,t.y),r=e.next,s=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function DA(e,t,n,i){const r=new NA(e,t,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function FA(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function NA(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class MA{static area(e){const t=e.length;let n=0;for(let i=t-1,r=0;r<t;i=r++)n+=e[i].x*e[r].y-e[r].x*e[i].y;return.5*n}static isClockWise(e){return MA.area(e)<0}static triangulateShape(e,t){const n=[],i=[],r=[];WA(e),kA(n,e);let s=e.length;t.forEach(WA);for(let a=0;a<t.length;a++)i.push(s),s+=t[a].length,kA(n,t[a]);const o=cA(n,i);for(let a=0;a<o.length;a+=3)r.push(o.slice(a,a+3));return r}}function WA(e){const t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function kA(e,t){for(let n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}class TA extends vo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new lA([new Oi(.5,.5),new Oi(-.5,.5),new Oi(-.5,-.5),new Oi(.5,-.5)]),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,i=[],r=[];for(let o=0,a=e.length;o<a;o++){s(e[o])}function s(e){const s=[],o=void 0!==t.curveSegments?t.curveSegments:12,a=void 0!==t.steps?t.steps:1,l=void 0!==t.depth?t.depth:1;let c=void 0===t.bevelEnabled||t.bevelEnabled,g=void 0!==t.bevelThickness?t.bevelThickness:.2,u=void 0!==t.bevelSize?t.bevelSize:g-.1,A=void 0!==t.bevelOffset?t.bevelOffset:0,d=void 0!==t.bevelSegments?t.bevelSegments:3;const h=t.extrudePath,I=void 0!==t.UVGenerator?t.UVGenerator:VA;let p,C,m,f,y,b=!1;h&&(p=h.getSpacedPoints(a),b=!0,c=!1,C=h.computeFrenetFrames(a,!1),m=new Sr,f=new Sr,y=new Sr),c||(d=0,g=0,u=0,A=0);const B=e.extractPoints(o);let v=B.shape;const w=B.holes;if(!MA.isClockWise(v)){v=v.reverse();for(let e=0,t=w.length;e<t;e++){const t=w[e];MA.isClockWise(t)&&(w[e]=t.reverse())}}const G=MA.triangulateShape(v,w),E=v;for(let t=0,n=w.length;t<n;t++){const e=w[t];v=v.concat(e)}function x(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().addScaledVector(t,n)}const S=v.length,R=G.length;function Z(e,t,n){let i,r,s;const o=e.x-t.x,a=e.y-t.y,l=n.x-e.x,c=n.y-e.y,g=o*o+a*a,u=o*c-a*l;if(Math.abs(u)>Number.EPSILON){const u=Math.sqrt(g),A=Math.sqrt(l*l+c*c),d=t.x-a/u,h=t.y+o/u,I=((n.x-c/A-d)*c-(n.y+l/A-h)*l)/(o*c-a*l);i=d+o*I-e.x,r=h+a*I-e.y;const p=i*i+r*r;if(p<=2)return new Oi(i,r);s=Math.sqrt(p/2)}else{let e=!1;o>Number.EPSILON?l>Number.EPSILON&&(e=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(a)===Math.sign(c)&&(e=!0),e?(i=-a,r=o,s=Math.sqrt(g)):(i=o,r=a,s=Math.sqrt(g/2))}return new Oi(i/s,r/s)}const D=[];for(let t=0,n=E.length,i=n-1,r=t+1;t<n;t++,i++,r++)i===n&&(i=0),r===n&&(r=0),D[t]=Z(E[t],E[i],E[r]);const F=[];let N,M=D.concat();for(let t=0,n=w.length;t<n;t++){const e=w[t];N=[];for(let t=0,n=e.length,i=n-1,r=t+1;t<n;t++,i++,r++)i===n&&(i=0),r===n&&(r=0),N[t]=Z(e[t],e[i],e[r]);F.push(N),M=M.concat(N)}for(let t=0;t<d;t++){const e=t/d,n=g*Math.cos(e*Math.PI/2),i=u*Math.sin(e*Math.PI/2)+A;for(let t=0,r=E.length;t<r;t++){const e=x(E[t],D[t],i);T(e.x,e.y,-n)}for(let t=0,r=w.length;t<r;t++){const e=w[t];N=F[t];for(let t=0,r=e.length;t<r;t++){const r=x(e[t],N[t],i);T(r.x,r.y,-n)}}}const W=u+A;for(let t=0;t<S;t++){const e=c?x(v[t],M[t],W):v[t];b?(f.copy(C.normals[0]).multiplyScalar(e.x),m.copy(C.binormals[0]).multiplyScalar(e.y),y.copy(p[0]).add(f).add(m),T(y.x,y.y,y.z)):T(e.x,e.y,0)}for(let t=1;t<=a;t++)for(let e=0;e<S;e++){const n=c?x(v[e],M[e],W):v[e];b?(f.copy(C.normals[t]).multiplyScalar(n.x),m.copy(C.binormals[t]).multiplyScalar(n.y),y.copy(p[t]).add(f).add(m),T(y.x,y.y,y.z)):T(n.x,n.y,l/a*t)}for(let t=d-1;t>=0;t--){const e=t/d,n=g*Math.cos(e*Math.PI/2),i=u*Math.sin(e*Math.PI/2)+A;for(let t=0,r=E.length;t<r;t++){const e=x(E[t],D[t],i);T(e.x,e.y,l+n)}for(let t=0,r=w.length;t<r;t++){const e=w[t];N=F[t];for(let t=0,r=e.length;t<r;t++){const r=x(e[t],N[t],i);b?T(r.x,r.y+p[a-1].y,p[a-1].x+n):T(r.x,r.y,l+n)}}}function k(e,t){let n=e.length;for(;--n>=0;){const i=n;let r=n-1;r<0&&(r=e.length-1);for(let e=0,n=a+2*d;e<n;e++){const n=S*e,s=S*(e+1);L(t+i+n,t+r+n,t+r+s,t+i+s)}}}function T(e,t,n){s.push(e),s.push(t),s.push(n)}function V(e,t,r){H(e),H(t),H(r);const s=i.length/3,o=I.generateTopUV(n,i,s-3,s-2,s-1);Q(o[0]),Q(o[1]),Q(o[2])}function L(e,t,r,s){H(e),H(t),H(s),H(t),H(r),H(s);const o=i.length/3,a=I.generateSideWallUV(n,i,o-6,o-3,o-2,o-1);Q(a[0]),Q(a[1]),Q(a[3]),Q(a[1]),Q(a[2]),Q(a[3])}function H(e){i.push(s[3*e+0]),i.push(s[3*e+1]),i.push(s[3*e+2])}function Q(e){r.push(e.x),r.push(e.y)}!function(){const e=i.length/3;if(c){let e=0,t=S*e;for(let n=0;n<R;n++){const e=G[n];V(e[2]+t,e[1]+t,e[0]+t)}e=a+2*d,t=S*e;for(let n=0;n<R;n++){const e=G[n];V(e[0]+t,e[1]+t,e[2]+t)}}else{for(let e=0;e<R;e++){const t=G[e];V(t[2],t[1],t[0])}for(let e=0;e<R;e++){const t=G[e];V(t[0]+S*a,t[1]+S*a,t[2]+S*a)}}n.addGroup(e,i.length/3-e,0)}(),function(){const e=i.length/3;let t=0;k(E,t),t+=E.length;for(let n=0,i=w.length;n<i;n++){const e=w[n];k(e,t),t+=e.length}n.addGroup(e,i.length/3-e,1)}()}this.setAttribute("position",new ho(i,3)),this.setAttribute("uv",new ho(r,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(let i=0,r=e.length;i<r;i++){const t=e[i];n.shapes.push(t.uuid)}else n.shapes.push(e.uuid);n.options=Object.assign({},t),void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let r=0,s=e.shapes.length;r<s;r++){const i=t[e.shapes[r]];n.push(i)}const i=e.options.extrudePath;return void 0!==i&&(e.options.extrudePath=(new Uu[i.type]).fromJSON(i)),new TA(n,e.options)}}const VA={generateTopUV:function(e,t,n,i,r){const s=t[3*n],o=t[3*n+1],a=t[3*i],l=t[3*i+1],c=t[3*r],g=t[3*r+1];return[new Oi(s,o),new Oi(a,l),new Oi(c,g)]},generateSideWallUV:function(e,t,n,i,r,s){const o=t[3*n],a=t[3*n+1],l=t[3*n+2],c=t[3*i],g=t[3*i+1],u=t[3*i+2],A=t[3*r],d=t[3*r+1],h=t[3*r+2],I=t[3*s],p=t[3*s+1],C=t[3*s+2];return Math.abs(a-g)<Math.abs(o-c)?[new Oi(o,1-l),new Oi(c,1-u),new Oi(A,1-h),new Oi(I,1-C)]:[new Oi(a,1-l),new Oi(g,1-u),new Oi(d,1-h),new Oi(p,1-C)]}};class LA extends tA{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new LA(e.radius,e.detail)}}class HA extends tA{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new HA(e.radius,e.detail)}}class QA extends vo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI;super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:s},n=Math.max(3,n),i=Math.max(1,i);const o=[],a=[],l=[],c=[];let g=e;const u=(t-e)/i,A=new Sr,d=new Oi;for(let h=0;h<=i;h++){for(let e=0;e<=n;e++){const i=r+e/n*s;A.x=g*Math.cos(i),A.y=g*Math.sin(i),a.push(A.x,A.y,A.z),l.push(0,0,1),d.x=(A.x/t+1)/2,d.y=(A.y/t+1)/2,c.push(d.x,d.y)}g+=u}for(let h=0;h<i;h++){const e=h*(n+1);for(let t=0;t<n;t++){const i=t+e,r=i,s=i+n+1,a=i+n+2,l=i+1;o.push(r,s,l),o.push(s,a,l)}}this.setIndex(o),this.setAttribute("position",new ho(a,3)),this.setAttribute("normal",new ho(l,3)),this.setAttribute("uv",new ho(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new QA(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class KA extends vo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new lA([new Oi(0,.5),new Oi(-.5,-.5),new Oi(.5,-.5)]),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],i=[],r=[],s=[];let o=0,a=0;if(!1===Array.isArray(e))l(e);else for(let c=0;c<e.length;c++)l(e[c]),this.addGroup(o,a,c),o+=a,a=0;function l(e){const o=i.length/3,l=e.extractPoints(t);let c=l.shape;const g=l.holes;!1===MA.isClockWise(c)&&(c=c.reverse());for(let t=0,n=g.length;t<n;t++){const e=g[t];!0===MA.isClockWise(e)&&(g[t]=e.reverse())}const u=MA.triangulateShape(c,g);for(let t=0,n=g.length;t<n;t++){const e=g[t];c=c.concat(e)}for(let t=0,n=c.length;t<n;t++){const e=c[t];i.push(e.x,e.y,0),r.push(0,0,1),s.push(e.x,e.y)}for(let t=0,i=u.length;t<i;t++){const e=u[t],i=e[0]+o,r=e[1]+o,s=e[2]+o;n.push(i,r,s),a+=3}}this.setIndex(n),this.setAttribute("position",new ho(i,3)),this.setAttribute("normal",new ho(r,3)),this.setAttribute("uv",new ho(s,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(e,t){if(t.shapes=[],Array.isArray(e))for(let n=0,i=e.length;n<i;n++){const i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let i=0,r=e.shapes.length;i<r;i++){const r=t[e.shapes[i]];n.push(r)}return new KA(n,e.curveSegments)}}class XA extends vo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:s,thetaLength:o},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const a=Math.min(s+o,Math.PI);let l=0;const c=[],g=new Sr,u=new Sr,A=[],d=[],h=[],I=[];for(let p=0;p<=n;p++){const A=[],C=p/n;let m=0;0===p&&0===s?m=.5/t:p===n&&a===Math.PI&&(m=-.5/t);for(let n=0;n<=t;n++){const a=n/t;g.x=-e*Math.cos(i+a*r)*Math.sin(s+C*o),g.y=e*Math.cos(s+C*o),g.z=e*Math.sin(i+a*r)*Math.sin(s+C*o),d.push(g.x,g.y,g.z),u.copy(g).normalize(),h.push(u.x,u.y,u.z),I.push(a+m,1-C),A.push(l++)}c.push(A)}for(let p=0;p<n;p++)for(let e=0;e<t;e++){const t=c[p][e+1],i=c[p][e],r=c[p+1][e],o=c[p+1][e+1];(0!==p||s>0)&&A.push(t,i,o),(p!==n-1||a<Math.PI)&&A.push(i,r,o)}this.setIndex(A),this.setAttribute("position",new ho(d,3)),this.setAttribute("normal",new ho(h,3)),this.setAttribute("uv",new ho(I,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new XA(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class YA extends tA{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new YA(e.radius,e.detail)}}class zA extends vo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:48,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},n=Math.floor(n),i=Math.floor(i);const s=[],o=[],a=[],l=[],c=new Sr,g=new Sr,u=new Sr;for(let A=0;A<=n;A++)for(let s=0;s<=i;s++){const d=s/i*r,h=A/n*Math.PI*2;g.x=(e+t*Math.cos(h))*Math.cos(d),g.y=(e+t*Math.cos(h))*Math.sin(d),g.z=t*Math.sin(h),o.push(g.x,g.y,g.z),c.x=e*Math.cos(d),c.y=e*Math.sin(d),u.subVectors(g,c).normalize(),a.push(u.x,u.y,u.z),l.push(s/i),l.push(A/n)}for(let A=1;A<=n;A++)for(let e=1;e<=i;e++){const t=(i+1)*A+e-1,n=(i+1)*(A-1)+e-1,r=(i+1)*(A-1)+e,o=(i+1)*A+e;s.push(t,n,o),s.push(n,r,o)}this.setIndex(s),this.setAttribute("position",new ho(o,3)),this.setAttribute("normal",new ho(a,3)),this.setAttribute("uv",new ho(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new zA(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class PA extends vo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3;super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:s},n=Math.floor(n),i=Math.floor(i);const o=[],a=[],l=[],c=[],g=new Sr,u=new Sr,A=new Sr,d=new Sr,h=new Sr,I=new Sr,p=new Sr;for(let m=0;m<=n;++m){const o=m/n*r*Math.PI*2;C(o,r,s,e,A),C(o+.01,r,s,e,d),I.subVectors(d,A),p.addVectors(d,A),h.crossVectors(I,p),p.crossVectors(h,I),h.normalize(),p.normalize();for(let e=0;e<=i;++e){const r=e/i*Math.PI*2,s=-t*Math.cos(r),o=t*Math.sin(r);g.x=A.x+(s*p.x+o*h.x),g.y=A.y+(s*p.y+o*h.y),g.z=A.z+(s*p.z+o*h.z),a.push(g.x,g.y,g.z),u.subVectors(g,A).normalize(),l.push(u.x,u.y,u.z),c.push(m/n),c.push(e/i)}}for(let m=1;m<=n;m++)for(let e=1;e<=i;e++){const t=(i+1)*(m-1)+(e-1),n=(i+1)*m+(e-1),r=(i+1)*m+e,s=(i+1)*(m-1)+e;o.push(t,n,s),o.push(n,r,s)}function C(e,t,n,i,r){const s=Math.cos(e),o=Math.sin(e),a=n/t*e,l=Math.cos(a);r.x=i*(2+l)*.5*s,r.y=i*(2+l)*o*.5,r.z=i*Math.sin(a)*.5}this.setIndex(o),this.setAttribute("position",new ho(a,3)),this.setAttribute("normal",new ho(l,3)),this.setAttribute("uv",new ho(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new PA(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class UA extends vo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new zu(new Sr(-1,-1,0),new Sr(-1,1,0),new Sr(1,1,0)),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:r};const s=e.computeFrenetFrames(t,r);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;const o=new Sr,a=new Sr,l=new Oi;let c=new Sr;const g=[],u=[],A=[],d=[];function h(r){c=e.getPointAt(r/t,c);const l=s.normals[r],A=s.binormals[r];for(let e=0;e<=i;e++){const t=e/i*Math.PI*2,r=Math.sin(t),s=-Math.cos(t);a.x=s*l.x+r*A.x,a.y=s*l.y+r*A.y,a.z=s*l.z+r*A.z,a.normalize(),u.push(a.x,a.y,a.z),o.x=c.x+n*a.x,o.y=c.y+n*a.y,o.z=c.z+n*a.z,g.push(o.x,o.y,o.z)}}!function(){for(let e=0;e<t;e++)h(e);h(!1===r?t:0),function(){for(let e=0;e<=t;e++)for(let n=0;n<=i;n++)l.x=e/t,l.y=n/i,A.push(l.x,l.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=i;t++){const n=(i+1)*(e-1)+(t-1),r=(i+1)*e+(t-1),s=(i+1)*e+t,o=(i+1)*(e-1)+t;d.push(n,r,o),d.push(r,s,o)}}()}(),this.setIndex(d),this.setAttribute("position",new ho(g,3)),this.setAttribute("normal",new ho(u,3)),this.setAttribute("uv",new ho(A,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new UA((new Uu[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class _A extends vo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],n=new Set,i=new Sr,r=new Sr;if(null!==e.index){const s=e.attributes.position,o=e.index;let a=e.groups;0===a.length&&(a=[{start:0,count:o.count,materialIndex:0}]);for(let e=0,l=a.length;e<l;++e){const l=a[e],c=l.start;for(let e=c,a=c+l.count;e<a;e+=3)for(let l=0;l<3;l++){const a=o.getX(e+l),c=o.getX(e+(l+1)%3);i.fromBufferAttribute(s,a),r.fromBufferAttribute(s,c),!0===OA(i,r,n)&&(t.push(i.x,i.y,i.z),t.push(r.x,r.y,r.z))}}}else{const s=e.attributes.position;for(let e=0,o=s.count/3;e<o;e++)for(let a=0;a<3;a++){const o=3*e+a,l=3*e+(a+1)%3;i.fromBufferAttribute(s,o),r.fromBufferAttribute(s,l),!0===OA(i,r,n)&&(t.push(i.x,i.y,i.z),t.push(r.x,r.y,r.z))}}this.setAttribute("position",new ho(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function OA(e,t,n){const i="".concat(e.x,",").concat(e.y,",").concat(e.z,"-").concat(t.x,",").concat(t.y,",").concat(t.z),r="".concat(t.x,",").concat(t.y,",").concat(t.z,"-").concat(e.x,",").concat(e.y,",").concat(e.z);return!0!==n.has(i)&&!0!==n.has(r)&&(n.add(i),n.add(r),!0)}var JA=Object.freeze({__proto__:null,BoxGeometry:Xo,CapsuleGeometry:ju,CircleGeometry:qu,ConeGeometry:eA,CylinderGeometry:$u,DodecahedronGeometry:nA,EdgesGeometry:aA,ExtrudeGeometry:TA,IcosahedronGeometry:LA,LatheGeometry:Ju,OctahedronGeometry:HA,PlaneGeometry:ga,PolyhedronGeometry:tA,RingGeometry:QA,ShapeGeometry:KA,SphereGeometry:XA,TetrahedronGeometry:YA,TorusGeometry:zA,TorusKnotGeometry:PA,TubeGeometry:UA,WireframeGeometry:_A});class jA extends Os{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Ps(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class qA extends _o{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class $A extends Os{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ps(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ps(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Hn,this.normalScale=new Oi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class ed extends $A{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Oi(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Qi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Ps(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Ps(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ps(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!==e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!==e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!==e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!==e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!==e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class td extends Os{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ps(16777215),this.specular=new Ps(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ps(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Hn,this.normalScale=new Oi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ye,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class nd extends Os{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ps(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ps(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Hn,this.normalScale=new Oi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class id extends Os{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Hn,this.normalScale=new Oi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class rd extends Os{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ps(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ps(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Hn,this.normalScale=new Oi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ye,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class sd extends Os{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ps(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Hn,this.normalScale=new Oi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class od extends ru{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function ad(e,t,n){return!e||!n&&e.constructor===t?e:"number"===typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}function ld(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function cd(e){const t=e.length,n=new Array(t);for(let i=0;i!==t;++i)n[i]=i;return n.sort((function(t,n){return e[t]-e[n]})),n}function gd(e,t,n){const i=e.length,r=new e.constructor(i);for(let s=0,o=0;o!==i;++s){const i=n[s]*t;for(let n=0;n!==t;++n)r[o++]=e[i+n]}return r}function ud(e,t,n,i){let r=1,s=e[0];for(;void 0!==s&&void 0===s[i];)s=e[r++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(t.push(s.time),n.push.apply(n,o)),s=e[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(t.push(s.time),o.toArray(n,n.length)),s=e[r++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(t.push(s.time),n.push(o)),s=e[r++]}while(void 0!==s)}const Ad={convertArray:ad,isTypedArray:ld,getKeyframeOrder:cd,sortedArray:gd,flattenJSON:ud,subclip:function(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30;const s=e.clone();s.name=t;const o=[];for(let l=0;l<s.tracks.length;++l){const e=s.tracks[l],t=e.getValueSize(),a=[],c=[];for(let s=0;s<e.times.length;++s){const o=e.times[s]*r;if(!(o<n||o>=i)){a.push(e.times[s]);for(let n=0;n<t;++n)c.push(e.values[s*t+n])}}0!==a.length&&(e.times=ad(a,e.times.constructor),e.values=ad(c,e.values.constructor),o.push(e))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s},makeClipAdditive:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;i<=0&&(i=30);const r=n.tracks.length,s=t/i;for(let o=0;o<r;++o){const t=n.tracks[o],i=t.ValueTypeName;if("bool"===i||"string"===i)continue;const r=e.tracks.find((function(e){return e.name===t.name&&e.ValueTypeName===i}));if(void 0===r)continue;let a=0;const l=t.getValueSize();t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(a=l/3);let c=0;const g=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=g/3);const u=t.times.length-1;let A;if(s<=t.times[0]){const e=a,n=l-a;A=t.values.slice(e,n)}else if(s>=t.times[u]){const e=u*l+a,n=e+l-a;A=t.values.slice(e,n)}else{const e=t.createInterpolant(),n=a,i=l-a;e.evaluate(s),A=e.resultBuffer.slice(n,i)}if("quaternion"===i){(new xr).fromArray(A).normalize().conjugate().toArray(A)}const d=r.times.length;for(let e=0;e<d;++e){const t=e*g+c;if("quaternion"===i)xr.multiplyQuaternionsFlat(r.values,t,A,0,r.values,t);else{const e=g-2*c;for(let n=0;n<e;++n)r.values[t+n]-=A[n]}}}return e.blendMode=Fn,e}};class dd{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],r=t[n-1];e:{t:{let s;n:{i:if(!(e<i)){for(let s=n+2;;){if(void 0===i){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===s)break;if(r=i,i=t[++n],e<i)break t}s=t.length;break n}if(e>=r)break e;{const o=t[1];e<o&&(n=2,r=o);for(let s=n-2;;){if(void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(n===s)break;if(i=r,r=t[--n-1],e>=r)break t}s=n,n=0}}for(;n<s;){const i=n+s>>>1;e<t[i]?s=i:n=i+1}if(i=t[n],r=t[n-1],void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===i)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i;for(let s=0;s!==i;++s)t[s]=n[r+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class hd extends dd{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Sn,endingEnd:Sn}}intervalChanged_(e,t,n){const i=this.parameterPositions;let r=e-2,s=e+1,o=i[r],a=i[s];if(void 0===o)switch(this.getSettings_().endingStart){case Rn:r=e,o=2*t-n;break;case Zn:r=i.length-2,o=t+i[r]-i[r+1];break;default:r=e,o=n}if(void 0===a)switch(this.getSettings_().endingEnd){case Rn:s=e,a=2*n-t;break;case Zn:s=1,a=n+i[1]-i[0];break;default:s=e-1,a=t}const l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(a-n),this._offsetPrev=r*c,this._offsetNext=s*c}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=e*o,l=a-o,c=this._offsetPrev,g=this._offsetNext,u=this._weightPrev,A=this._weightNext,d=(n-t)/(i-t),h=d*d,I=h*d,p=-u*I+2*u*h-u*d,C=(1+u)*I+(-1.5-2*u)*h+(-.5+u)*d+1,m=(-1-A)*I+(1.5+A)*h+.5*d,f=A*I-A*h;for(let y=0;y!==o;++y)r[y]=p*s[c+y]+C*s[l+y]+m*s[a+y]+f*s[g+y];return r}}class Id extends dd{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=e*o,l=a-o,c=(n-t)/(i-t),g=1-c;for(let u=0;u!==o;++u)r[u]=s[l+u]*g+s[a+u]*c;return r}}class pd extends dd{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class Cd{constructor(e,t,n,i){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ad(t,this.TimeBufferType),this.values=ad(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:ad(e.times,Array),values:ad(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new pd(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Id(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new hd(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Gn:t=this.InterpolantFactoryMethodDiscrete;break;case En:t=this.InterpolantFactoryMethodLinear;break;case xn:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Gn;case this.InterpolantFactoryMethodLinear:return En;case this.InterpolantFactoryMethodSmooth:return xn}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let r=0,s=i-1;for(;r!==i&&n[r]<e;)++r;for(;-1!==s&&n[s]>t;)--s;if(++s,0!==r||s!==i){r>=s&&(s=Math.max(s,1),r=s-1);const e=this.getValueSize();this.times=n.slice(r,s),this.values=this.values.slice(r*e,s*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let o=0;o!==r;o++){const t=n[o];if("number"===typeof t&&isNaN(t)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,t),e=!1;break}if(null!==s&&s>t){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,t,s),e=!1;break}s=t}if(void 0!==i&&ld(i))for(let o=0,a=i.length;o!==a;++o){const t=i[o];if(isNaN(t)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,t),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),i=this.getInterpolation()===xn,r=e.length-1;let s=1;for(let o=1;o<r;++o){let r=!1;const a=e[o];if(a!==e[o+1]&&(1!==o||a!==e[0]))if(i)r=!0;else{const e=o*n,i=e-n,s=e+n;for(let o=0;o!==n;++o){const n=t[e+o];if(n!==t[i+o]||n!==t[s+o]){r=!0;break}}}if(r){if(o!==s){e[s]=e[o];const i=o*n,r=s*n;for(let e=0;e!==n;++e)t[r+e]=t[i+e]}++s}}if(r>0){e[s]=e[r];for(let e=r*n,i=s*n,o=0;o!==n;++o)t[i+o]=t[e+o];++s}return s!==e.length?(this.times=e.slice(0,s),this.values=t.slice(0,s*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}Cd.prototype.TimeBufferType=Float32Array,Cd.prototype.ValueBufferType=Float32Array,Cd.prototype.DefaultInterpolation=En;class md extends Cd{}md.prototype.ValueTypeName="bool",md.prototype.ValueBufferType=Array,md.prototype.DefaultInterpolation=Gn,md.prototype.InterpolantFactoryMethodLinear=void 0,md.prototype.InterpolantFactoryMethodSmooth=void 0;class fd extends Cd{}fd.prototype.ValueTypeName="color";class yd extends Cd{}yd.prototype.ValueTypeName="number";class bd extends dd{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=(n-t)/(i-t);let l=e*o;for(let c=l+o;l!==c;l+=4)xr.slerpFlat(r,0,s,l-o,s,l,a);return r}}class Bd extends Cd{InterpolantFactoryMethodLinear(e){return new bd(this.times,this.values,this.getValueSize(),e)}}Bd.prototype.ValueTypeName="quaternion",Bd.prototype.DefaultInterpolation=En,Bd.prototype.InterpolantFactoryMethodSmooth=void 0;class vd extends Cd{}vd.prototype.ValueTypeName="string",vd.prototype.ValueBufferType=Array,vd.prototype.DefaultInterpolation=Gn,vd.prototype.InterpolantFactoryMethodLinear=void 0,vd.prototype.InterpolantFactoryMethodSmooth=void 0;class wd extends Cd{}wd.prototype.ValueTypeName="vector";class Gd{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Dn;this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=Hi(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,i=1/(e.fps||1);for(let s=0,o=n.length;s!==o;++s)t.push(Ed(n[s]).scale(i));const r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r}static toJSON(e){const t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let r=0,s=n.length;r!==s;++r)t.push(Cd.toJSON(n[r]));return i}static CreateFromMorphTargetSequence(e,t,n,i){const r=t.length,s=[];for(let o=0;o<r;o++){let e=[],a=[];e.push((o+r-1)%r,o,(o+1)%r),a.push(0,1,0);const l=cd(e);e=gd(e,1,l),a=gd(a,1,l),i||0!==e[0]||(e.push(r),a.push(a[0])),s.push(new yd(".morphTargetInfluences["+t[o].name+"]",e,a).scale(1/n))}return new this(e,-1,s)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const t=e;n=t.geometry&&t.geometry.animations||t.animations}for(let i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const i={},r=/^([\w-]*?)([\d]+)$/;for(let o=0,a=e.length;o<a;o++){const t=e[o],n=t.name.match(r);if(n&&n.length>1){const e=n[1];let r=i[e];r||(i[e]=r=[]),r.push(t)}}const s=[];for(const o in i)s.push(this.CreateFromMorphTargetSequence(o,i[o],t,n));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(e,t,n,i,r){if(0!==n.length){const s=[],o=[];ud(n,s,o,i),0!==s.length&&r.push(new e(t,s,o))}},i=[],r=e.name||"default",s=e.fps||30,o=e.blendMode;let a=e.length||-1;const l=e.hierarchy||[];for(let c=0;c<l.length;c++){const e=l[c].keys;if(e&&0!==e.length)if(e[0].morphTargets){const t={};let n;for(n=0;n<e.length;n++)if(e[n].morphTargets)for(let i=0;i<e[n].morphTargets.length;i++)t[e[n].morphTargets[i]]=-1;for(const r in t){const t=[],s=[];for(let i=0;i!==e[n].morphTargets.length;++i){const i=e[n];t.push(i.time),s.push(i.morphTarget===r?1:0)}i.push(new yd(".morphTargetInfluence["+r+"]",t,s))}a=t.length*s}else{const r=".bones["+t[c].name+"]";n(wd,r+".position",e,"pos",i),n(Bd,r+".quaternion",e,"rot",i),n(wd,r+".scale",e,"scl",i)}}if(0===i.length)return null;return new this(r,a,i,o)}resetDuration(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){const n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Ed(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return yd;case"vector":case"vector2":case"vector3":case"vector4":return wd;case"color":return fd;case"quaternion":return Bd;case"bool":case"boolean":return md;case"string":return vd}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){const t=[],n=[];ud(e.keys,t,n,"value"),e.times=t,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}const xd={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class Sd{constructor(e,t,n){const i=this;let r,s=!1,o=0,a=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){a++,!1===s&&void 0!==i.onStart&&i.onStart(e,o,a),s=!0},this.itemEnd=function(e){o++,void 0!==i.onProgress&&i.onProgress(e,o,a),o===a&&(s=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return r?r(e):e},this.setURLModifier=function(e){return r=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){const n=l[t],i=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return i}return null}}}const Rd=new Sd;class Zd{constructor(e){this.manager=void 0!==e?e:Rd,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise((function(i,r){n.load(e,i,t,r)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Zd.DEFAULT_MATERIAL_NAME="__DEFAULT";const Dd={};class Fd extends Error{constructor(e,t){super(e),this.response=t}}class Nd extends Zd{constructor(e){super(e)}load(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=xd.get(e);if(void 0!==r)return this.manager.itemStart(e),setTimeout((()=>{t&&t(r),this.manager.itemEnd(e)}),0),r;if(void 0!==Dd[e])return void Dd[e].push({onLoad:t,onProgress:n,onError:i});Dd[e]=[],Dd[e].push({onLoad:t,onProgress:n,onError:i});const s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,a=this.responseType;fetch(s).then((t=>{if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"===typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;const n=Dd[e],i=t.body.getReader(),r=t.headers.get("Content-Length")||t.headers.get("X-File-Size"),s=r?parseInt(r):0,o=0!==s;let a=0;const l=new ReadableStream({start(e){!function t(){i.read().then((i=>{let{done:r,value:l}=i;if(r)e.close();else{a+=l.byteLength;const i=new ProgressEvent("progress",{lengthComputable:o,loaded:a,total:s});for(let e=0,t=n.length;e<t;e++){const t=n[e];t.onProgress&&t.onProgress(i)}e.enqueue(l),t()}}))}()}});return new Response(l)}throw new Fd('fetch for "'.concat(t.url,'" responded with ').concat(t.status,": ").concat(t.statusText),t)})).then((e=>{switch(a){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then((e=>(new DOMParser).parseFromString(e,o)));case"json":return e.json();default:if(void 0===o)return e.text();{const t=/charset="?([^;"\s]*)"?/i.exec(o),n=t&&t[1]?t[1].toLowerCase():void 0,i=new TextDecoder(n);return e.arrayBuffer().then((e=>i.decode(e)))}}})).then((t=>{xd.add(e,t);const n=Dd[e];delete Dd[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];i.onLoad&&i.onLoad(t)}})).catch((t=>{const n=Dd[e];if(void 0===n)throw this.manager.itemError(e),t;delete Dd[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];i.onError&&i.onError(t)}this.manager.itemError(e)})).finally((()=>{this.manager.itemEnd(e)})),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Md extends Zd{constructor(e){super(e)}load(e,t,n,i){const r=this,s=new Nd(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(n){try{t(r.parse(JSON.parse(n)))}catch(Ow){i?i(Ow):console.error(Ow),r.manager.itemError(e)}}),n,i)}parse(e){const t=[];for(let n=0;n<e.length;n++){const i=Gd.parse(e[n]);t.push(i)}return t}}class Wd extends Zd{constructor(e){super(e)}load(e,t,n,i){const r=this,s=[],o=new wu,a=new Nd(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(r.withCredentials);let l=0;function c(c){a.load(e[c],(function(e){const n=r.parse(e,!0);s[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},l+=1,6===l&&(1===n.mipmapCount&&(o.minFilter=pt),o.image=s,o.format=n.format,o.needsUpdate=!0,t&&t(o))}),n,i)}if(Array.isArray(e))for(let g=0,u=e.length;g<u;++g)c(g);else a.load(e,(function(e){const n=r.parse(e,!0);if(n.isCubemap){const e=n.mipmaps.length/n.mipmapCount;for(let t=0;t<e;t++){s[t]={mipmaps:[]};for(let e=0;e<n.mipmapCount;e++)s[t].mipmaps.push(n.mipmaps[t*n.mipmapCount+e]),s[t].format=n.format,s[t].width=n.width,s[t].height=n.height}o.image=s}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=pt),o.format=n.format,o.needsUpdate=!0,t&&t(o)}),n,i);return o}}class kd extends Zd{constructor(e){super(e)}load(e,t,n,i){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,s=xd.get(e);if(void 0!==s)return r.manager.itemStart(e),setTimeout((function(){t&&t(s),r.manager.itemEnd(e)}),0),s;const o=tr("img");function a(){c(),xd.add(e,this),t&&t(this),r.manager.itemEnd(e)}function l(t){c(),i&&i(t),r.manager.itemError(e),r.manager.itemEnd(e)}function c(){o.removeEventListener("load",a,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",a,!1),o.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),r.manager.itemStart(e),o.src=e,o}}class Td extends Zd{constructor(e){super(e)}load(e,t,n,i){const r=new $o;r.colorSpace=Xn;const s=new kd(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let o=0;function a(n){s.load(e[n],(function(e){r.images[n]=e,o++,6===o&&(r.needsUpdate=!0,t&&t(r))}),void 0,i)}for(let l=0;l<e.length;++l)a(l);return r}}class Vd extends Zd{constructor(e){super(e)}load(e,t,n,i){const r=this,s=new Sg,o=new Nd(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(r.withCredentials),o.load(e,(function(e){let n;try{n=r.parse(e)}catch(HY){if(void 0===i)return void console.error(HY);i(HY)}void 0!==n.image?s.image=n.image:void 0!==n.data&&(s.image.width=n.width,s.image.height=n.height,s.image.data=n.data),s.wrapS=void 0!==n.wrapS?n.wrapS:ct,s.wrapT=void 0!==n.wrapT?n.wrapT:ct,s.magFilter=void 0!==n.magFilter?n.magFilter:pt,s.minFilter=void 0!==n.minFilter?n.minFilter:pt,s.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.colorSpace?s.colorSpace=n.colorSpace:void 0!==n.encoding&&(s.encoding=n.encoding),void 0!==n.flipY&&(s.flipY=n.flipY),void 0!==n.format&&(s.format=n.format),void 0!==n.type&&(s.type=n.type),void 0!==n.mipmaps&&(s.mipmaps=n.mipmaps,s.minFilter=ft),1===n.mipmapCount&&(s.minFilter=pt),void 0!==n.generateMipmaps&&(s.generateMipmaps=n.generateMipmaps),s.needsUpdate=!0,t&&t(s,n)}),n,i),s}}class Ld extends Zd{constructor(e){super(e)}load(e,t,n,i){const r=new mr,s=new kd(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,(function(e){r.image=e,r.needsUpdate=!0,void 0!==t&&t(r)}),n,i),r}}class Hd extends Rs{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(),this.isLight=!0,this.type="Light",this.color=new Ps(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}class Qd extends Hd{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Rs.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Ps(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const Kd=new rs,Xd=new Sr,Yd=new Sr;class zd{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Oi(512,512),this.map=null,this.mapPass=null,this.matrix=new rs,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new aa,this._frameExtents=new Oi(1,1),this._viewportCount=1,this._viewports=[new fr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Xd.setFromMatrixPosition(e.matrixWorld),t.position.copy(Xd),Yd.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Yd),t.updateMatrixWorld(),Kd.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Kd),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Kd)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Pd extends zd{constructor(){super(new Jo(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*Li*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;n===t.fov&&i===t.aspect&&r===t.far||(t.fov=n,t.aspect=i,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Ud extends Hd{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2;super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Rs.DEFAULT_UP),this.updateMatrix(),this.target=new Rs,this.distance=n,this.angle=i,this.penumbra=r,this.decay=s,this.map=null,this.shadow=new Pd}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const _d=new rs,Od=new Sr,Jd=new Sr;class jd extends zd{constructor(){super(new Jo(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Oi(4,2),this._viewportCount=6,this._viewports=[new fr(2,1,1,1),new fr(0,1,1,1),new fr(3,1,1,1),new fr(1,1,1,1),new fr(3,0,1,1),new fr(1,0,1,1)],this._cubeDirections=[new Sr(1,0,0),new Sr(-1,0,0),new Sr(0,0,1),new Sr(0,0,-1),new Sr(0,1,0),new Sr(0,-1,0)],this._cubeUps=[new Sr(0,1,0),new Sr(0,1,0),new Sr(0,1,0),new Sr(0,1,0),new Sr(0,0,1),new Sr(0,0,-1)]}updateMatrices(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.camera,i=this.matrix,r=e.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),Od.setFromMatrixPosition(e.matrixWorld),n.position.copy(Od),Jd.copy(n.position),Jd.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Jd),n.updateMatrixWorld(),i.makeTranslation(-Od.x,-Od.y,-Od.z),_d.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_d)}}class qd extends Hd{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new jd}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class $d extends zd{constructor(){super(new ba(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class eh extends Hd{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Rs.DEFAULT_UP),this.updateMatrix(),this.target=new Rs,this.shadow=new $d}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class th extends Hd{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class nh extends Hd{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class ih{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Sr)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,i=e.y,r=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.282095),t.addScaledVector(s[1],.488603*i),t.addScaledVector(s[2],.488603*r),t.addScaledVector(s[3],.488603*n),t.addScaledVector(s[4],n*i*1.092548),t.addScaledVector(s[5],i*r*1.092548),t.addScaledVector(s[6],.315392*(3*r*r-1)),t.addScaledVector(s[7],n*r*1.092548),t.addScaledVector(s[8],.546274*(n*n-i*i)),t}getIrradianceAt(e,t){const n=e.x,i=e.y,r=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.886227),t.addScaledVector(s[1],1.023328*i),t.addScaledVector(s[2],1.023328*r),t.addScaledVector(s[3],1.023328*n),t.addScaledVector(s[4],.858086*n*i),t.addScaledVector(s[5],.858086*i*r),t.addScaledVector(s[6],.743125*r*r-.247708),t.addScaledVector(s[7],.858086*n*r),t.addScaledVector(s[8],.429043*(n*n-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(e,t+3*i);return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(e,t+3*i);return e}static getBasisAt(e,t){const n=e.x,i=e.y,r=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*r,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*n*r,t[8]=.546274*(n*n-i*i)}}class rh extends Hd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ih;super(void 0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class sh extends Zd{constructor(e){super(e),this.textures={}}load(e,t,n,i){const r=this,s=new Nd(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(e,(function(n){try{t(r.parse(JSON.parse(n)))}catch(Ow){i?i(Ow):console.error(Ow),r.manager.itemError(e)}}),n,i)}parse(e){const t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}const i=sh.createMaterialFromType(e.type);if(void 0!==e.uuid&&(i.uuid=e.uuid),void 0!==e.name&&(i.name=e.name),void 0!==e.color&&void 0!==i.color&&i.color.setHex(e.color),void 0!==e.roughness&&(i.roughness=e.roughness),void 0!==e.metalness&&(i.metalness=e.metalness),void 0!==e.sheen&&(i.sheen=e.sheen),void 0!==e.sheenColor&&(i.sheenColor=(new Ps).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(i.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==i.emissive&&i.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==i.specular&&i.specular.setHex(e.specular),void 0!==e.specularIntensity&&(i.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==i.specularColor&&i.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(i.shininess=e.shininess),void 0!==e.clearcoat&&(i.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(i.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.iridescence&&(i.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(i.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(i.transmission=e.transmission),void 0!==e.thickness&&(i.thickness=e.thickness),void 0!==e.attenuationDistance&&(i.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==i.attenuationColor&&i.attenuationColor.setHex(e.attenuationColor),void 0!==e.anisotropy&&(i.anisotropy=e.anisotropy),void 0!==e.anisotropyRotation&&(i.anisotropyRotation=e.anisotropyRotation),void 0!==e.fog&&(i.fog=e.fog),void 0!==e.flatShading&&(i.flatShading=e.flatShading),void 0!==e.blending&&(i.blending=e.blending),void 0!==e.combine&&(i.combine=e.combine),void 0!==e.side&&(i.side=e.side),void 0!==e.shadowSide&&(i.shadowSide=e.shadowSide),void 0!==e.opacity&&(i.opacity=e.opacity),void 0!==e.transparent&&(i.transparent=e.transparent),void 0!==e.alphaTest&&(i.alphaTest=e.alphaTest),void 0!==e.alphaHash&&(i.alphaHash=e.alphaHash),void 0!==e.depthFunc&&(i.depthFunc=e.depthFunc),void 0!==e.depthTest&&(i.depthTest=e.depthTest),void 0!==e.depthWrite&&(i.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(i.colorWrite=e.colorWrite),void 0!==e.blendSrc&&(i.blendSrc=e.blendSrc),void 0!==e.blendDst&&(i.blendDst=e.blendDst),void 0!==e.blendEquation&&(i.blendEquation=e.blendEquation),void 0!==e.blendSrcAlpha&&(i.blendSrcAlpha=e.blendSrcAlpha),void 0!==e.blendDstAlpha&&(i.blendDstAlpha=e.blendDstAlpha),void 0!==e.blendEquationAlpha&&(i.blendEquationAlpha=e.blendEquationAlpha),void 0!==e.blendColor&&void 0!==i.blendColor&&i.blendColor.setHex(e.blendColor),void 0!==e.blendAlpha&&(i.blendAlpha=e.blendAlpha),void 0!==e.stencilWriteMask&&(i.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(i.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(i.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(i.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(i.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(i.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(i.stencilZPass=e.stencilZPass),void 0!==e.stencilWrite&&(i.stencilWrite=e.stencilWrite),void 0!==e.wireframe&&(i.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(i.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(i.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(i.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(i.rotation=e.rotation),void 0!==e.linewidth&&(i.linewidth=e.linewidth),void 0!==e.dashSize&&(i.dashSize=e.dashSize),void 0!==e.gapSize&&(i.gapSize=e.gapSize),void 0!==e.scale&&(i.scale=e.scale),void 0!==e.polygonOffset&&(i.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(i.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(i.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(i.dithering=e.dithering),void 0!==e.alphaToCoverage&&(i.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(i.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.forceSinglePass&&(i.forceSinglePass=e.forceSinglePass),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.toneMapped&&(i.toneMapped=e.toneMapped),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.vertexColors&&("number"===typeof e.vertexColors?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),void 0!==e.uniforms)for(const r in e.uniforms){const t=e.uniforms[r];switch(i.uniforms[r]={},t.type){case"t":i.uniforms[r].value=n(t.value);break;case"c":i.uniforms[r].value=(new Ps).setHex(t.value);break;case"v2":i.uniforms[r].value=(new Oi).fromArray(t.value);break;case"v3":i.uniforms[r].value=(new Sr).fromArray(t.value);break;case"v4":i.uniforms[r].value=(new fr).fromArray(t.value);break;case"m3":i.uniforms[r].value=(new Ji).fromArray(t.value);break;case"m4":i.uniforms[r].value=(new rs).fromArray(t.value);break;default:i.uniforms[r].value=t.value}}if(void 0!==e.defines&&(i.defines=e.defines),void 0!==e.vertexShader&&(i.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(i.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(i.glslVersion=e.glslVersion),void 0!==e.extensions)for(const r in e.extensions)i.extensions[r]=e.extensions[r];if(void 0!==e.lights&&(i.lights=e.lights),void 0!==e.clipping&&(i.clipping=e.clipping),void 0!==e.size&&(i.size=e.size),void 0!==e.sizeAttenuation&&(i.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(i.map=n(e.map)),void 0!==e.matcap&&(i.matcap=n(e.matcap)),void 0!==e.alphaMap&&(i.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(i.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(i.bumpScale=e.bumpScale),void 0!==e.normalMap&&(i.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(i.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),i.normalScale=(new Oi).fromArray(t)}return void 0!==e.displacementMap&&(i.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(i.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(i.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(i.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(i.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(i.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(i.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(i.specularMap=n(e.specularMap)),void 0!==e.specularIntensityMap&&(i.specularIntensityMap=n(e.specularIntensityMap)),void 0!==e.specularColorMap&&(i.specularColorMap=n(e.specularColorMap)),void 0!==e.envMap&&(i.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(i.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(i.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(i.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(i.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(i.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(i.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(i.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(i.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(i.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(i.clearcoatNormalScale=(new Oi).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(i.iridescenceMap=n(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(i.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(i.transmissionMap=n(e.transmissionMap)),void 0!==e.thicknessMap&&(i.thicknessMap=n(e.thicknessMap)),void 0!==e.anisotropyMap&&(i.anisotropyMap=n(e.anisotropyMap)),void 0!==e.sheenColorMap&&(i.sheenColorMap=n(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(i.sheenRoughnessMap=n(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){return new{ShadowMaterial:jA,SpriteMaterial:qc,RawShaderMaterial:qA,ShaderMaterial:_o,PointsMaterial:Iu,MeshPhysicalMaterial:ed,MeshStandardMaterial:$A,MeshPhongMaterial:td,MeshToonMaterial:nd,MeshNormalMaterial:id,MeshLambertMaterial:rd,MeshDepthMaterial:Dc,MeshDistanceMaterial:Fc,MeshBasicMaterial:Js,MeshMatcapMaterial:sd,LineDashedMaterial:od,LineBasicMaterial:ru,Material:Os}[e]}}class oh{static decodeText(e){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(Ow){return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!==typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class ah extends vo{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class lh extends Zd{constructor(e){super(e)}load(e,t,n,i){const r=this,s=new Nd(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(e,(function(n){try{t(r.parse(JSON.parse(n)))}catch(Ow){i?i(Ow):console.error(Ow),r.manager.itemError(e)}}),n,i)}parse(e){const t={},n={};function i(e,i){if(void 0!==t[i])return t[i];const r=e.interleavedBuffers[i],s=function(e,t){if(void 0!==n[t])return n[t];const i=e.arrayBuffers,r=i[t],s=new Uint32Array(r).buffer;return n[t]=s,s}(e,r.buffer),o=er(r.type,s),a=new Oc(o,r.stride);return a.uuid=r.uuid,t[i]=a,a}const r=e.isInstancedBufferGeometry?new ah:new vo,s=e.data.index;if(void 0!==s){const e=er(s.type,s.array);r.setIndex(new ro(e,1))}const o=e.data.attributes;for(const g in o){const t=o[g];let n;if(t.isInterleavedBufferAttribute){const r=i(e.data,t.data);n=new jc(r,t.itemSize,t.offset,t.normalized)}else{const e=er(t.type,t.array);n=new(t.isInstancedBufferAttribute?Fg:ro)(e,t.itemSize,t.normalized)}void 0!==t.name&&(n.name=t.name),void 0!==t.usage&&n.setUsage(t.usage),r.setAttribute(g,n)}const a=e.data.morphAttributes;if(a)for(const g in a){const t=a[g],n=[];for(let r=0,s=t.length;r<s;r++){const s=t[r];let o;if(s.isInterleavedBufferAttribute){const t=i(e.data,s.data);o=new jc(t,s.itemSize,s.offset,s.normalized)}else{const e=er(s.type,s.array);o=new ro(e,s.itemSize,s.normalized)}void 0!==s.name&&(o.name=s.name),n.push(o)}r.morphAttributes[g]=n}e.data.morphTargetsRelative&&(r.morphTargetsRelative=!0);const l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(let g=0,u=l.length;g!==u;++g){const e=l[g];r.addGroup(e.start,e.count,e.materialIndex)}const c=e.data.boundingSphere;if(void 0!==c){const e=new Sr;void 0!==c.center&&e.fromArray(c.center),r.boundingSphere=new Or(e,c.radius)}return e.name&&(r.name=e.name),e.userData&&(r.userData=e.userData),r}}class ch extends Zd{constructor(e){super(e)}load(e,t,n,i){const r=this,s=""===this.path?oh.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const o=new Nd(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){let s=null;try{s=JSON.parse(n)}catch(HY){return void 0!==i&&i(HY),void console.error("THREE:ObjectLoader: Can't parse "+e+".",HY.message)}const o=s.metadata;if(void 0===o||void 0===o.type||"geometry"===o.type.toLowerCase())return void 0!==i&&i(new Error("THREE.ObjectLoader: Can't load "+e)),void console.error("THREE.ObjectLoader: Can't load "+e);r.parse(s,t)}),n,i)}async loadAsync(e,t){const n=""===this.path?oh.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||n;const i=new Nd(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials);const r=await i.loadAsync(e,t),s=JSON.parse(r),o=s.metadata;if(void 0===o||void 0===o.type||"geometry"===o.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(s)}parse(e,t){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),s=this.parseImages(e.images,(function(){void 0!==t&&t(l)})),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,r,a,o,n),c=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,c),void 0!==t){let e=!1;for(const t in s)if(s[t].data instanceof HTMLImageElement){e=!0;break}!1===e&&t(l)}return l}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),r=await this.parseImagesAsync(e.images),s=this.parseTextures(e.textures,r),o=this.parseMaterials(e.materials,s),a=this.parseObject(e.object,i,o,s,t),l=this.parseSkeletons(e.skeletons,a);return this.bindSkeletons(a,l),a}parseShapes(e){const t={};if(void 0!==e)for(let n=0,i=e.length;n<i;n++){const i=(new lA).fromJSON(e[n]);t[i.uuid]=i}return t}parseSkeletons(e,t){const n={},i={};if(t.traverse((function(e){e.isBone&&(i[e.uuid]=e)})),void 0!==e)for(let r=0,s=e.length;r<s;r++){const t=(new Dg).fromJSON(e[r],i);n[t.uuid]=t}return n}parseGeometries(e,t){const n={};if(void 0!==e){const i=new lh;for(let r=0,s=e.length;r<s;r++){let s;const o=e[r];switch(o.type){case"BufferGeometry":case"InstancedBufferGeometry":s=i.parse(o);break;default:o.type in JA?s=JA[o.type].fromJSON(o,t):console.warn('THREE.ObjectLoader: Unsupported geometry type "'.concat(o.type,'"'))}s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),void 0!==o.userData&&(s.userData=o.userData),n[o.uuid]=s}}return n}parseMaterials(e,t){const n={},i={};if(void 0!==e){const r=new sh;r.setTextures(t);for(let t=0,s=e.length;t<s;t++){const s=e[t];void 0===n[s.uuid]&&(n[s.uuid]=r.parse(s)),i[s.uuid]=n[s.uuid]}}return i}parseAnimations(e){const t={};if(void 0!==e)for(let n=0;n<e.length;n++){const i=e[n],r=Gd.parse(i);t[r.uuid]=r}return t}parseImages(e,t){const n=this,i={};let r;function s(e){if("string"===typeof e){const t=e;return function(e){return n.manager.itemStart(e),r.load(e,(function(){n.manager.itemEnd(e)}),void 0,(function(){n.manager.itemError(e),n.manager.itemEnd(e)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:n.resourcePath+t)}return e.data?{data:er(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){const n=new Sd(t);r=new kd(n),r.setCrossOrigin(this.crossOrigin);for(let t=0,r=e.length;t<r;t++){const n=e[t],r=n.url;if(Array.isArray(r)){const e=[];for(let t=0,n=r.length;t<n;t++){const n=s(r[t]);null!==n&&(n instanceof HTMLImageElement?e.push(n):e.push(new Sg(n.data,n.width,n.height)))}i[n.uuid]=new Ir(e)}else{const e=s(n.url);i[n.uuid]=new Ir(e)}}}return i}async parseImagesAsync(e){const t=this,n={};let i;async function r(e){if("string"===typeof e){const n=e,r=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:t.resourcePath+n;return await i.loadAsync(r)}return e.data?{data:er(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){i=new kd(this.manager),i.setCrossOrigin(this.crossOrigin);for(let t=0,i=e.length;t<i;t++){const i=e[t],s=i.url;if(Array.isArray(s)){const e=[];for(let t=0,n=s.length;t<n;t++){const n=s[t],i=await r(n);null!==i&&(i instanceof HTMLImageElement?e.push(i):e.push(new Sg(i.data,i.width,i.height)))}n[i.uuid]=new Ir(e)}else{const e=await r(i.url);n[i.uuid]=new Ir(e)}}}return n}parseTextures(e,t){function n(e,t){return"number"===typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}const i={};if(void 0!==e)for(let r=0,s=e.length;r<s;r++){const s=e[r];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image);const o=t[s.image],a=o.data;let l;Array.isArray(a)?(l=new $o,6===a.length&&(l.needsUpdate=!0)):(l=a&&a.data?new Sg:new mr,a&&(l.needsUpdate=!0)),l.source=o,l.uuid=s.uuid,void 0!==s.name&&(l.name=s.name),void 0!==s.mapping&&(l.mapping=n(s.mapping,gh)),void 0!==s.channel&&(l.channel=s.channel),void 0!==s.offset&&l.offset.fromArray(s.offset),void 0!==s.repeat&&l.repeat.fromArray(s.repeat),void 0!==s.center&&l.center.fromArray(s.center),void 0!==s.rotation&&(l.rotation=s.rotation),void 0!==s.wrap&&(l.wrapS=n(s.wrap[0],uh),l.wrapT=n(s.wrap[1],uh)),void 0!==s.format&&(l.format=s.format),void 0!==s.internalFormat&&(l.internalFormat=s.internalFormat),void 0!==s.type&&(l.type=s.type),void 0!==s.colorSpace&&(l.colorSpace=s.colorSpace),void 0!==s.encoding&&(l.encoding=s.encoding),void 0!==s.minFilter&&(l.minFilter=n(s.minFilter,Ah)),void 0!==s.magFilter&&(l.magFilter=n(s.magFilter,Ah)),void 0!==s.anisotropy&&(l.anisotropy=s.anisotropy),void 0!==s.flipY&&(l.flipY=s.flipY),void 0!==s.generateMipmaps&&(l.generateMipmaps=s.generateMipmaps),void 0!==s.premultiplyAlpha&&(l.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(l.unpackAlignment=s.unpackAlignment),void 0!==s.compareFunction&&(l.compareFunction=s.compareFunction),void 0!==s.userData&&(l.userData=s.userData),i[s.uuid]=l}return i}parseObject(e,t,n,i,r){let s,o,a;function l(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function c(e){if(void 0!==e){if(Array.isArray(e)){const t=[];for(let i=0,r=e.length;i<r;i++){const r=e[i];void 0===n[r]&&console.warn("THREE.ObjectLoader: Undefined material",r),t.push(n[r])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}function g(e){return void 0===i[e]&&console.warn("THREE.ObjectLoader: Undefined texture",e),i[e]}switch(e.type){case"Scene":s=new _c,void 0!==e.background&&(Number.isInteger(e.background)?s.background=new Ps(e.background):s.background=g(e.background)),void 0!==e.environment&&(s.environment=g(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?s.fog=new Uc(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(s.fog=new Pc(e.fog.color,e.fog.density)),""!==e.fog.name&&(s.fog.name=e.fog.name)),void 0!==e.backgroundBlurriness&&(s.backgroundBlurriness=e.backgroundBlurriness),void 0!==e.backgroundIntensity&&(s.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":s=new Jo(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(s.focus=e.focus),void 0!==e.zoom&&(s.zoom=e.zoom),void 0!==e.filmGauge&&(s.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(s.filmOffset=e.filmOffset),void 0!==e.view&&(s.view=Object.assign({},e.view));break;case"OrthographicCamera":s=new ba(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(s.zoom=e.zoom),void 0!==e.view&&(s.view=Object.assign({},e.view));break;case"AmbientLight":s=new th(e.color,e.intensity);break;case"DirectionalLight":s=new eh(e.color,e.intensity);break;case"PointLight":s=new qd(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":s=new nh(e.color,e.intensity,e.width,e.height);break;case"SpotLight":s=new Ud(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":s=new Qd(e.color,e.groundColor,e.intensity);break;case"LightProbe":s=(new rh).fromJSON(e);break;case"SkinnedMesh":o=l(e.geometry),a=c(e.material),s=new Eg(o,a),void 0!==e.bindMode&&(s.bindMode=e.bindMode),void 0!==e.bindMatrix&&s.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(s.skeleton=e.skeleton);break;case"Mesh":o=l(e.geometry),a=c(e.material),s=new Qo(o,a);break;case"InstancedMesh":o=l(e.geometry),a=c(e.material);const t=e.count,n=e.instanceMatrix,i=e.instanceColor;s=new Hg(o,a,t),s.instanceMatrix=new Fg(new Float32Array(n.array),16),void 0!==i&&(s.instanceColor=new Fg(new Float32Array(i.array),i.itemSize));break;case"BatchedMesh":o=l(e.geometry),a=c(e.material),s=new iu(e.maxGeometryCount,e.maxVertexCount,e.maxIndexCount,a),s.geometry=o,s.perObjectFrustumCulled=e.perObjectFrustumCulled,s.sortObjects=e.sortObjects,s._drawRanges=e.drawRanges,s._reservedRanges=e.reservedRanges,s._visibility=e.visibility,s._active=e.active,s._bounds=e.bounds.map((e=>{const t=new Dr;t.min.fromArray(e.boxMin),t.max.fromArray(e.boxMax);const n=new Or;return n.radius=e.sphereRadius,n.center.fromArray(e.sphereCenter),{boxInitialized:e.boxInitialized,box:t,sphereInitialized:e.sphereInitialized,sphere:n}})),s._maxGeometryCount=e.maxGeometryCount,s._maxVertexCount=e.maxVertexCount,s._maxIndexCount=e.maxIndexCount,s._geometryInitialized=e.geometryInitialized,s._geometryCount=e.geometryCount,s._matricesTexture=g(e.matricesTexture.uuid);break;case"LOD":s=new pg;break;case"Line":s=new gu(l(e.geometry),c(e.material));break;case"LineLoop":s=new hu(l(e.geometry),c(e.material));break;case"LineSegments":s=new du(l(e.geometry),c(e.material));break;case"PointCloud":case"Points":s=new yu(l(e.geometry),c(e.material));break;case"Sprite":s=new Ag(c(e.material));break;case"Group":s=new Vc;break;case"Bone":s=new xg;break;default:s=new Rs}if(s.uuid=e.uuid,void 0!==e.name&&(s.name=e.name),void 0!==e.matrix?(s.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(s.matrixAutoUpdate=e.matrixAutoUpdate),s.matrixAutoUpdate&&s.matrix.decompose(s.position,s.quaternion,s.scale)):(void 0!==e.position&&s.position.fromArray(e.position),void 0!==e.rotation&&s.rotation.fromArray(e.rotation),void 0!==e.quaternion&&s.quaternion.fromArray(e.quaternion),void 0!==e.scale&&s.scale.fromArray(e.scale)),void 0!==e.up&&s.up.fromArray(e.up),void 0!==e.castShadow&&(s.castShadow=e.castShadow),void 0!==e.receiveShadow&&(s.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(s.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(s.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(s.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&s.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(s.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(s.visible=e.visible),void 0!==e.frustumCulled&&(s.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(s.renderOrder=e.renderOrder),void 0!==e.userData&&(s.userData=e.userData),void 0!==e.layers&&(s.layers.mask=e.layers),void 0!==e.children){const o=e.children;for(let e=0;e<o.length;e++)s.add(this.parseObject(o[e],t,n,i,r))}if(void 0!==e.animations){const t=e.animations;for(let e=0;e<t.length;e++){const n=t[e];s.animations.push(r[n])}}if("LOD"===e.type){void 0!==e.autoUpdate&&(s.autoUpdate=e.autoUpdate);const t=e.levels;for(let e=0;e<t.length;e++){const n=t[e],i=s.getObjectByProperty("uuid",n.object);void 0!==i&&s.addLevel(i,n.distance,n.hysteresis)}}return s}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse((function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){const n=t[e.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}}))}}const gh={UVMapping:nt,CubeReflectionMapping:it,CubeRefractionMapping:rt,EquirectangularReflectionMapping:st,EquirectangularRefractionMapping:ot,CubeUVReflectionMapping:at},uh={RepeatWrapping:lt,ClampToEdgeWrapping:ct,MirroredRepeatWrapping:gt},Ah={NearestFilter:ut,NearestMipmapNearestFilter:At,NearestMipmapLinearFilter:ht,LinearFilter:pt,LinearMipmapNearestFilter:Ct,LinearMipmapLinearFilter:ft};class dh extends Zd{constructor(e){super(e),this.isImageBitmapLoader=!0,"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,s=xd.get(e);if(void 0!==s)return r.manager.itemStart(e),s.then?void s.then((n=>{t&&t(n),r.manager.itemEnd(e)})).catch((e=>{i&&i(e)})):(setTimeout((function(){t&&t(s),r.manager.itemEnd(e)}),0),s);const o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader;const a=fetch(e,o).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(r.options,{colorSpaceConversion:"none"}))})).then((function(n){return xd.add(e,n),t&&t(n),r.manager.itemEnd(e),n})).catch((function(t){i&&i(t),xd.remove(e),r.manager.itemError(e),r.manager.itemEnd(e)}));xd.add(e,a),r.manager.itemStart(e)}}let hh;class Ih{static getContext(){return void 0===hh&&(hh=new(window.AudioContext||window.webkitAudioContext)),hh}static setContext(e){hh=e}}class ph extends Zd{constructor(e){super(e)}load(e,t,n,i){const r=this,s=new Nd(this.manager);function o(t){i?i(t):console.error(t),r.manager.itemError(e)}s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(e){try{const n=e.slice(0);Ih.getContext().decodeAudioData(n,(function(e){t(e)})).catch(o)}catch(Ow){o(Ow)}}),n,i)}}const Ch=new rs,mh=new rs,fh=new rs;class yh{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Jo,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Jo,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,fh.copy(e.projectionMatrix);const n=t.eyeSep/2,i=n*t.near/t.focus,r=t.near*Math.tan(Vi*t.fov*.5)/t.zoom;let s,o;mh.elements[12]=-n,Ch.elements[12]=n,s=-r*t.aspect+i,o=r*t.aspect+i,fh.elements[0]=2*t.near/(o-s),fh.elements[8]=(o+s)/(o-s),this.cameraL.projectionMatrix.copy(fh),s=-r*t.aspect-i,o=r*t.aspect-i,fh.elements[0]=2*t.near/(o-s),fh.elements[8]=(o+s)/(o-s),this.cameraR.projectionMatrix.copy(fh)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(mh),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Ch)}}class bh{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Bh(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=Bh();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function Bh(){return("undefined"===typeof performance?Date:performance).now()}const vh=new Sr,wh=new xr,Gh=new Sr,Eh=new Sr;class xh extends Rs{constructor(){super(),this.type="AudioListener",this.context=Ih.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new bh}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(vh,wh,Gh),Eh.set(0,0,-1).applyQuaternion(wh),t.positionX){const e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(vh.x,e),t.positionY.linearRampToValueAtTime(vh.y,e),t.positionZ.linearRampToValueAtTime(vh.z,e),t.forwardX.linearRampToValueAtTime(Eh.x,e),t.forwardY.linearRampToValueAtTime(Eh.y,e),t.forwardZ.linearRampToValueAtTime(Eh.z,e),t.upX.linearRampToValueAtTime(n.x,e),t.upY.linearRampToValueAtTime(n.y,e),t.upZ.linearRampToValueAtTime(n.z,e)}else t.setPosition(vh.x,vh.y,vh.z),t.setOrientation(Eh.x,Eh.y,Eh.z,n.x,n.y,n.z)}}class Sh extends Rs{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,null!==this.source&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(!1!==this._connected){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Rh=new Sr,Zh=new xr,Dh=new Sr,Fh=new Sr;class Nh extends Sh{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(Rh,Zh,Dh),Fh.set(0,0,1).applyQuaternion(Zh);const t=this.panner;if(t.positionX){const e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Rh.x,e),t.positionY.linearRampToValueAtTime(Rh.y,e),t.positionZ.linearRampToValueAtTime(Rh.z,e),t.orientationX.linearRampToValueAtTime(Fh.x,e),t.orientationY.linearRampToValueAtTime(Fh.y,e),t.orientationZ.linearRampToValueAtTime(Fh.z,e)}else t.setPosition(Rh.x,Rh.y,Rh.z),t.setOrientation(Fh.x,Fh.y,Fh.z)}}class Mh{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2048;this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class Wh{constructor(e,t,n){let i,r,s;switch(this.binding=e,this.valueSize=n,t){case"quaternion":i=this._slerp,r=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":i=this._select,r=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:i=this._lerp,r=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=r,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,i=this.valueSize,r=e*i+i;let s=this.cumulativeWeight;if(0===s){for(let e=0;e!==i;++e)n[r+e]=n[e];s=t}else{s+=t;const e=t/s;this._mixBufferRegion(n,r,0,e,i)}this.cumulativeWeight=s}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,i=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,i=e*t+t,r=this.cumulativeWeight,s=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const e=t*this._origIndex;this._mixBufferRegion(n,i,e,1-r,t)}s>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let a=t,l=t+t;a!==l;++a)if(n[a]!==n[a+t]){o.setValue(n,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let r=n,s=i;r!==s;++r)t[r]=t[i+r%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,i,r){if(i>=.5)for(let s=0;s!==r;++s)e[t+s]=e[n+s]}_slerp(e,t,n,i){xr.slerpFlat(e,t,e,t,e,n,i)}_slerpAdditive(e,t,n,i,r){const s=this._workIndex*r;xr.multiplyQuaternionsFlat(e,s,e,t,e,n),xr.slerpFlat(e,t,e,t,e,s,i)}_lerp(e,t,n,i,r){const s=1-i;for(let o=0;o!==r;++o){const r=t+o;e[r]=e[r]*s+e[n+o]*i}}_lerpAdditive(e,t,n,i,r){for(let s=0;s!==r;++s){const r=t+s;e[r]=e[r]+e[n+s]*i}}}const kh="\\[\\]\\.:\\/",Th=new RegExp("["+kh+"]","g"),Vh="[^"+kh+"]",Lh="[^"+kh.replace("\\.","")+"]",Hh=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",Vh)+/(WCOD+)?/.source.replace("WCOD",Lh)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Vh)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Vh)+"$"),Qh=["material","materials","bones","map"];class Kh{constructor(e,t,n){this.path=t,this.parsedPath=n||Kh.parseTrackName(t),this.node=Kh.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Kh.Composite(e,t,n):new Kh(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Th,"")}static parseTrackName(e){const t=Hh.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){const e=n.nodeName.substring(i+1);-1!==Qh.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let i=0;i<e.length;i++){const r=e[i];if(r.name===t||r.uuid===t)return r;const s=n(r.children);if(s)return s}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let r=t.propertyIndex;if(e||(e=Kh.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(n){let i=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===i){i=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==i){if(void 0===e[i])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[i]}}const s=e[i];if(void 0===s){const n=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+i+" but it wasn't found.",e)}let o=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?o=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(o=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[r]&&(r=e.morphTargetDictionary[r])}a=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(a=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Kh.Composite=class{constructor(e,t,n){const i=n||Kh.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},Kh.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Kh.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Kh.prototype.GetterByBindingType=[Kh.prototype._getValue_direct,Kh.prototype._getValue_array,Kh.prototype._getValue_arrayElement,Kh.prototype._getValue_toArray],Kh.prototype.SetterByBindingTypeAndVersioning=[[Kh.prototype._setValue_direct,Kh.prototype._setValue_direct_setNeedsUpdate,Kh.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Kh.prototype._setValue_array,Kh.prototype._setValue_array_setNeedsUpdate,Kh.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Kh.prototype._setValue_arrayElement,Kh.prototype._setValue_arrayElement_setNeedsUpdate,Kh.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Kh.prototype._setValue_fromArray,Kh.prototype._setValue_fromArray_setNeedsUpdate,Kh.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Xh{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Hi(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,i=arguments.length;n!==i;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,i=this._parsedPaths,r=this._bindings,s=r.length;let o,a=e.length,l=this.nCachedObjects_;for(let c=0,g=arguments.length;c!==g;++c){const g=arguments[c],u=g.uuid;let A=t[u];if(void 0===A){A=a++,t[u]=A,e.push(g);for(let e=0,t=s;e!==t;++e)r[e].push(new Kh(g,n[e],i[e]))}else if(A<l){o=e[A];const a=--l,c=e[a];t[c.uuid]=A,e[A]=c,t[u]=a,e[a]=g;for(let e=0,t=s;e!==t;++e){const t=r[e],s=t[a];let o=t[A];t[A]=s,void 0===o&&(o=new Kh(g,n[e],i[e])),t[a]=o}}else e[A]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_;for(let s=0,o=arguments.length;s!==o;++s){const o=arguments[s],a=o.uuid,l=t[a];if(void 0!==l&&l>=r){const s=r++,c=e[s];t[c.uuid]=l,e[l]=c,t[a]=s,e[s]=o;for(let e=0,t=i;e!==t;++e){const t=n[e],i=t[s],r=t[l];t[l]=i,t[s]=r}}}this.nCachedObjects_=r}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_,s=e.length;for(let o=0,a=arguments.length;o!==a;++o){const a=arguments[o].uuid,l=t[a];if(void 0!==l)if(delete t[a],l<r){const o=--r,a=e[o],c=--s,g=e[c];t[a.uuid]=l,e[l]=a,t[g.uuid]=o,e[o]=g,e.pop();for(let e=0,t=i;e!==t;++e){const t=n[e],i=t[o],r=t[c];t[l]=i,t[o]=r,t.pop()}}else{const r=--s,o=e[r];r>0&&(t[o.uuid]=l),e[l]=o,e.pop();for(let e=0,t=i;e!==t;++e){const t=n[e];t[l]=t[r],t.pop()}}}this.nCachedObjects_=r}subscribe_(e,t){const n=this._bindingsIndicesByPath;let i=n[e];const r=this._bindings;if(void 0!==i)return r[i];const s=this._paths,o=this._parsedPaths,a=this._objects,l=a.length,c=this.nCachedObjects_,g=new Array(l);i=r.length,n[e]=i,s.push(e),o.push(t),r.push(g);for(let u=c,A=a.length;u!==A;++u){const n=a[u];g[u]=new Kh(n,e,t)}return g}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){const i=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length-1,a=s[o];t[e[o]]=n,s[n]=a,s.pop(),r[n]=r[o],r.pop(),i[n]=i[o],i.pop()}}}class Yh{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.blendMode;this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=i;const r=t.tracks,s=r.length,o=new Array(s),a={endingStart:Sn,endingEnd:Sn};for(let l=0;l!==s;++l){const e=r[l].createInterpolant(null);o[l]=e,e.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=vn,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const n=this._clip.duration,i=e._clip.duration,r=i/n,s=n/i;e.warp(1,r,t),this.warp(s,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const i=this._mixer,r=i.time,s=this.timeScale;let o=this._timeScaleInterpolant;null===o&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=r,a[1]=r+n,l[0]=e/s,l[1]=t/s,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,i){if(!this.enabled)return void this._updateWeight(e);const r=this._startTime;if(null!==r){const i=(e-r)*n;i<0||0===n?t=0:(this._startTime=null,t=n*i)}t*=this._updateTimeScale(e);const s=this._updateTime(t),o=this._updateWeight(e);if(o>0){const e=this._interpolants,t=this._propertyBindings;if(this.blendMode===Fn)for(let n=0,i=e.length;n!==i;++n)e[n].evaluate(s),t[n].accumulateAdditive(o);else for(let n=0,r=e.length;n!==r;++n)e[n].evaluate(s),t[n].accumulate(i,o)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(null!==n){t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let i=this.time+e,r=this._loopCount;const s=n===wn;if(0===e)return-1===r?i:s&&1===(1&r)?t-i:i;if(n===Bn){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else{if(!(i<0)){this.time=i;break e}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===r&&(e>=0?(r=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),i>=t||i<0){const n=Math.floor(i/t);i-=t*n,r+=Math.abs(n);const o=this.repetitions-r;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===o){const t=e<0;this._setEndings(t,!t,s)}else this._setEndings(!1,!1,s);this._loopCount=r,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=i;if(s&&1===(1&r))return t-i}return i}_setEndings(e,t,n){const i=this._interpolantSettings;n?(i.endingStart=Rn,i.endingEnd=Rn):(i.endingStart=e?this.zeroSlopeAtStart?Rn:Sn:Zn,i.endingEnd=t?this.zeroSlopeAtEnd?Rn:Sn:Zn)}_scheduleFading(e,t,n){const i=this._mixer,r=i.time;let s=this._weightInterpolant;null===s&&(s=i._lendControlInterpolant(),this._weightInterpolant=s);const o=s.parameterPositions,a=s.sampleValues;return o[0]=r,a[0]=t,o[1]=r+e,a[1]=n,this}}const zh=new Float32Array(1);class Ph extends Wi{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,i=e._clip.tracks,r=i.length,s=e._propertyBindings,o=e._interpolants,a=n.uuid,l=this._bindingsByRootAndName;let c=l[a];void 0===c&&(c={},l[a]=c);for(let g=0;g!==r;++g){const e=i[g],r=e.name;let l=c[r];if(void 0!==l)++l.referenceCount,s[g]=l;else{if(l=s[g],void 0!==l){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,a,r));continue}const i=t&&t._propertyBindings[g].binding.parsedPath;l=new Wh(Kh.create(n,r,i),e.ValueTypeName,e.getValueSize()),++l.referenceCount,this._addInactiveBinding(l,a,r),s[g]=l}o[g].resultBuffer=l.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const t=(e._localRoot||this._root).uuid,n=e._clip.uuid,i=this._actionsByClip[n];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,n,t)}const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0===n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0===--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){const i=this._actions,r=this._actionsByClip;let s=r[t];if(void 0===s)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=s;else{const t=s.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=i.length,i.push(e),s.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;const r=e._clip.uuid,s=this._actionsByClip,o=s[r],a=o.knownActions,l=a[a.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,a[c]=l,a.pop(),e._byClipCacheIndex=null;delete o.actionByRoot[(e._localRoot||this._root).uuid],0===a.length&&delete s[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const e=t[n];0===--e.referenceCount&&this._removeInactiveBinding(e)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_addInactiveBinding(e,t,n){const i=this._bindingsByRootAndName,r=this._bindings;let s=i[t];void 0===s&&(s={},i[t]=s),s[n]=e,e._cacheIndex=r.length,r.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,i=n.rootNode.uuid,r=n.path,s=this._bindingsByRootAndName,o=s[i],a=t[t.length-1],l=e._cacheIndex;a._cacheIndex=l,t[l]=a,t.pop(),delete o[r],0===Object.keys(o).length&&delete s[i]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new Id(new Float32Array(2),new Float32Array(2),1,zh),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,r=t[i];e.__cacheIndex=i,t[i]=e,r.__cacheIndex=n,t[n]=r}clipAction(e,t,n){const i=t||this._root,r=i.uuid;let s="string"===typeof e?Gd.findByName(i,e):e;const o=null!==s?s.uuid:e,a=this._actionsByClip[o];let l=null;if(void 0===n&&(n=null!==s?s.blendMode:Dn),void 0!==a){const e=a.actionByRoot[r];if(void 0!==e&&e.blendMode===n)return e;l=a.knownActions[0],null===s&&(s=l._clip)}if(null===s)return null;const c=new Yh(this,s,t,n);return this._bindAction(c,l),this._addInactiveAction(c,o,r),c}existingAction(e,t){const n=t||this._root,i=n.uuid,r="string"===typeof e?Gd.findByName(n,e):e,s=r?r.uuid:e,o=this._actionsByClip[s];return void 0!==o&&o.actionByRoot[i]||null}stopAllAction(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,i=this.time+=e,r=Math.sign(e),s=this._accuIndex^=1;for(let l=0;l!==n;++l){t[l]._update(i,e,r,s)}const o=this._bindings,a=this._nActiveBindings;for(let l=0;l!==a;++l)o[l].apply(s);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){const e=r.knownActions;for(let n=0,i=e.length;n!==i;++n){const i=e[n];this._deactivateAction(i);const r=i._cacheIndex,s=t[t.length-1];i._cacheIndex=null,i._byClipCacheIndex=null,s._cacheIndex=r,t[r]=s,t.pop(),this._removeInactiveBindingsForAction(i)}delete i[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const r in n){const e=n[r].actionByRoot[t];void 0!==e&&(this._deactivateAction(e),this._removeInactiveAction(e))}const i=this._bindingsByRootAndName[t];if(void 0!==i)for(const r in i){const e=i[r];e.restoreOriginalState(),this._removeInactiveBinding(e)}}uncacheAction(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class Uh{constructor(e){this.value=e}clone(){return new Uh(void 0===this.value.clone?this.value:this.value.clone())}}let _h=0;class Oh extends Wi{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:_h++}),this.name="",this.usage=bi,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,i=t.length;n<i;n++){const e=Array.isArray(t[n])?t[n]:[t[n]];for(let t=0;t<e.length;t++)this.uniforms.push(e[t].clone())}return this}clone(){return(new this.constructor).copy(this)}}class Jh extends Oc{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class jh{constructor(e,t,n,i,r){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=i,this.count=r,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class qh{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;this.ray=new is(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new Is,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return eI(e,this,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]),t.sort($h),t}intersectObjects(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(let i=0,r=e.length;i<r;i++)eI(e[i],this,n,t);return n.sort($h),n}}function $h(e,t){return e.distance-t.distance}function eI(e,t,n,i){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===i){const i=e.children;for(let e=0,r=i.length;e<r;e++)eI(i[e],t,n,!0)}}class tI{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Qi(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class nI{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return(new this.constructor).copy(this)}}const iI=new Oi;class rI{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Oi(1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oi(-1/0,-1/0);this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=iI.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,iI).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const sI=new Sr,oI=new Sr;class aI{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Sr,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sr;this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){sI.subVectors(e,this.start),oI.subVectors(this.end,this.start);const n=oI.dot(oI);let i=oI.dot(sI)/n;return t&&(i=Qi(i,0,1)),i}closestPointToPoint(e,t,n){const i=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const lI=new Sr;class cI extends Rs{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new vo,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,o=1,a=32;s<a;s++,o++){const e=s/a*Math.PI*2,t=o/a*Math.PI*2;i.push(Math.cos(e),Math.sin(e),1,Math.cos(t),Math.sin(t),1)}n.setAttribute("position",new ho(i,3));const r=new ru({fog:!1,toneMapped:!1});this.cone=new du(n,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),lI.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(lI),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const gI=new Sr,uI=new rs,AI=new rs;class dI extends du{constructor(e){const t=hI(e),n=new vo,i=[],r=[],s=new Ps(0,0,1),o=new Ps(0,1,0);for(let a=0;a<t.length;a++){const e=t[a];e.parent&&e.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(s.r,s.g,s.b),r.push(o.r,o.g,o.b))}n.setAttribute("position",new ho(i,3)),n.setAttribute("color",new ho(r,3));super(n,new ru({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,i=n.getAttribute("position");AI.copy(this.root.matrixWorld).invert();for(let r=0,s=0;r<t.length;r++){const e=t[r];e.parent&&e.parent.isBone&&(uI.multiplyMatrices(AI,e.matrixWorld),gI.setFromMatrixPosition(uI),i.setXYZ(s,gI.x,gI.y,gI.z),uI.multiplyMatrices(AI,e.parent.matrixWorld),gI.setFromMatrixPosition(uI),i.setXYZ(s+1,gI.x,gI.y,gI.z),s+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function hI(e){const t=[];!0===e.isBone&&t.push(e);for(let n=0;n<e.children.length;n++)t.push.apply(t,hI(e.children[n]));return t}class II extends Qo{constructor(e,t,n){super(new XA(t,4,2),new Js({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const pI=new Sr,CI=new Ps,mI=new Ps;class fI extends Rs{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const i=new HA(t);i.rotateY(.5*Math.PI),this.material=new Js({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const r=i.getAttribute("position"),s=new Float32Array(3*r.count);i.setAttribute("color",new ro(s,3)),this.add(new Qo(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");CI.copy(this.light.color),mI.copy(this.light.groundColor);for(let e=0,n=t.count;e<n;e++){const i=e<n/2?CI:mI;t.setXYZ(e,i.r,i.g,i.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(pI.setFromMatrixPosition(this.light.matrixWorld).negate())}}class yI extends du{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4473924,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8947848;n=new Ps(n),i=new Ps(i);const r=t/2,s=e/t,o=e/2,a=[],l=[];for(let g=0,u=0,A=-o;g<=t;g++,A+=s){a.push(-o,0,A,o,0,A),a.push(A,0,-o,A,0,o);const e=g===r?n:i;e.toArray(l,u),u+=3,e.toArray(l,u),u+=3,e.toArray(l,u),u+=3,e.toArray(l,u),u+=3}const c=new vo;c.setAttribute("position",new ho(a,3)),c.setAttribute("color",new ho(l,3));super(c,new ru({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class bI extends du{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4473924,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:8947848;r=new Ps(r),s=new Ps(s);const o=[],a=[];if(t>1)for(let c=0;c<t;c++){const n=c/t*(2*Math.PI),i=Math.sin(n)*e,l=Math.cos(n)*e;o.push(0,0,0),o.push(i,0,l);const g=1&c?r:s;a.push(g.r,g.g,g.b),a.push(g.r,g.g,g.b)}for(let c=0;c<n;c++){const t=1&c?r:s,l=e-e/n*c;for(let e=0;e<i;e++){let n=e/i*(2*Math.PI),r=Math.sin(n)*l,s=Math.cos(n)*l;o.push(r,0,s),a.push(t.r,t.g,t.b),n=(e+1)/i*(2*Math.PI),r=Math.sin(n)*l,s=Math.cos(n)*l,o.push(r,0,s),a.push(t.r,t.g,t.b)}}const l=new vo;l.setAttribute("position",new ho(o,3)),l.setAttribute("color",new ho(a,3));super(l,new ru({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const BI=new Sr,vI=new Sr,wI=new Sr;class GI extends Rs{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",void 0===t&&(t=1);let i=new vo;i.setAttribute("position",new ho([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const r=new ru({fog:!1,toneMapped:!1});this.lightPlane=new gu(i,r),this.add(this.lightPlane),i=new vo,i.setAttribute("position",new ho([0,0,0,0,0,1],3)),this.targetLine=new gu(i,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),BI.setFromMatrixPosition(this.light.matrixWorld),vI.setFromMatrixPosition(this.light.target.matrixWorld),wI.subVectors(vI,BI),this.lightPlane.lookAt(vI),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(vI),this.targetLine.scale.z=wI.length()}}const EI=new Sr,xI=new Oo;class SI extends du{constructor(e){const t=new vo,n=new ru({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],s={};function o(e,t){a(e),a(t)}function a(e){i.push(0,0,0),r.push(0,0,0),void 0===s[e]&&(s[e]=[]),s[e].push(i.length/3-1)}o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4"),t.setAttribute("position",new ho(i,3)),t.setAttribute("color",new ho(r,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();const l=new Ps(16755200),c=new Ps(16711680),g=new Ps(43775),u=new Ps(16777215),A=new Ps(3355443);this.setColors(l,c,g,u,A)}setColors(e,t,n,i,r){const s=this.geometry.getAttribute("color");s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,t.r,t.g,t.b),s.setXYZ(25,t.r,t.g,t.b),s.setXYZ(26,t.r,t.g,t.b),s.setXYZ(27,t.r,t.g,t.b),s.setXYZ(28,t.r,t.g,t.b),s.setXYZ(29,t.r,t.g,t.b),s.setXYZ(30,t.r,t.g,t.b),s.setXYZ(31,t.r,t.g,t.b),s.setXYZ(32,n.r,n.g,n.b),s.setXYZ(33,n.r,n.g,n.b),s.setXYZ(34,n.r,n.g,n.b),s.setXYZ(35,n.r,n.g,n.b),s.setXYZ(36,n.r,n.g,n.b),s.setXYZ(37,n.r,n.g,n.b),s.setXYZ(38,i.r,i.g,i.b),s.setXYZ(39,i.r,i.g,i.b),s.setXYZ(40,r.r,r.g,r.b),s.setXYZ(41,r.r,r.g,r.b),s.setXYZ(42,r.r,r.g,r.b),s.setXYZ(43,r.r,r.g,r.b),s.setXYZ(44,r.r,r.g,r.b),s.setXYZ(45,r.r,r.g,r.b),s.setXYZ(46,r.r,r.g,r.b),s.setXYZ(47,r.r,r.g,r.b),s.setXYZ(48,r.r,r.g,r.b),s.setXYZ(49,r.r,r.g,r.b),s.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap;xI.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),RI("c",t,e,xI,0,0,-1),RI("t",t,e,xI,0,0,1),RI("n1",t,e,xI,-1,-1,-1),RI("n2",t,e,xI,1,-1,-1),RI("n3",t,e,xI,-1,1,-1),RI("n4",t,e,xI,1,1,-1),RI("f1",t,e,xI,-1,-1,1),RI("f2",t,e,xI,1,-1,1),RI("f3",t,e,xI,-1,1,1),RI("f4",t,e,xI,1,1,1),RI("u1",t,e,xI,.7,1.1,-1),RI("u2",t,e,xI,-.7,1.1,-1),RI("u3",t,e,xI,0,2,-1),RI("cf1",t,e,xI,-1,0,1),RI("cf2",t,e,xI,1,0,1),RI("cf3",t,e,xI,0,-1,1),RI("cf4",t,e,xI,0,1,1),RI("cn1",t,e,xI,-1,0,-1),RI("cn2",t,e,xI,1,0,-1),RI("cn3",t,e,xI,0,-1,-1),RI("cn4",t,e,xI,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function RI(e,t,n,i,r,s,o){EI.set(r,s,o).unproject(i);const a=t[e];if(void 0!==a){const e=n.getAttribute("position");for(let t=0,n=a.length;t<n;t++)e.setXYZ(a[t],EI.x,EI.y,EI.z)}}const ZI=new Dr;class DI extends du{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),r=new vo;r.setIndex(new ro(n,1)),r.setAttribute("position",new ro(i,3)),super(r,new ru({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&ZI.setFromObject(this.object),ZI.isEmpty())return;const t=ZI.min,n=ZI.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=t.x,r[4]=n.y,r[5]=n.z,r[6]=t.x,r[7]=t.y,r[8]=n.z,r[9]=n.x,r[10]=t.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=t.z,r[15]=t.x,r[16]=n.y,r[17]=t.z,r[18]=t.x,r[19]=t.y,r[20]=t.z,r[21]=n.x,r[22]=t.y,r[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class FI extends du{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new vo;i.setIndex(new ro(n,1)),i.setAttribute("position",new ho([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(i,new ru({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class NI extends gu{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16776960,i=new vo;i.setAttribute("position",new ho([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),i.computeBoundingSphere(),super(i,new ru({color:n,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const r=new vo;r.setAttribute("position",new ho([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),r.computeBoundingSphere(),this.add(new Qo(r,new Js({color:n,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const MI=new Sr;let WI,kI;class TI extends Rs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Sr(0,0,1),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sr(0,0,0),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16776960,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2*n,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.2*r;super(),this.type="ArrowHelper",void 0===WI&&(WI=new vo,WI.setAttribute("position",new ho([0,0,0,0,1,0],3)),kI=new $u(0,.5,1,5,1),kI.translate(0,-.5,0)),this.position.copy(t),this.line=new gu(WI,new ru({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Qo(kI,new Js({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,s)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{MI.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(MI,t)}}setLength(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2*e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2*t;this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class VI extends du{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new vo;n.setAttribute("position",new ho(t,3)),n.setAttribute("color",new ho([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));super(n,new ru({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const i=new Ps,r=this.geometry.attributes.color.array;return i.set(e),i.toArray(r,0),i.toArray(r,3),i.set(t),i.toArray(r,6),i.toArray(r,9),i.set(n),i.toArray(r,12),i.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class LI{constructor(){this.type="ShapePath",this.color=new Ps,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Ou,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this}bezierCurveTo(e,t,n,i,r,s){return this.currentPath.bezierCurveTo(e,t,n,i,r,s),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(e,t){const n=t.length;let i=!1;for(let r=n-1,s=0;s<n;r=s++){let n=t[r],o=t[s],a=o.x-n.x,l=o.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=t[s],a=-a,o=t[r],l=-l),e.y<n.y||e.y>o.y)continue;if(e.y===n.y){if(e.x===n.x)return!0}else{const t=l*(e.x-n.x)-a*(e.y-n.y);if(0===t)return!0;if(t<0)continue;i=!i}}else{if(e.y!==n.y)continue;if(o.x<=e.x&&e.x<=n.x||n.x<=e.x&&e.x<=o.x)return!0}}return i}const n=MA.isClockWise,i=this.subPaths;if(0===i.length)return[];let r,s,o;const a=[];if(1===i.length)return s=i[0],o=new lA,o.curves=s.curves,a.push(o),a;let l=!n(i[0].getPoints());l=e?!l:l;const c=[],g=[];let u,A,d=[],h=0;g[h]=void 0,d[h]=[];for(let I=0,p=i.length;I<p;I++)s=i[I],u=s.getPoints(),r=n(u),r=e?!r:r,r?(!l&&g[h]&&h++,g[h]={s:new lA,p:u},g[h].s.curves=s.curves,l&&h++,d[h]=[]):d[h].push({h:s,p:u[0]});if(!g[0])return function(e){const t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n],r=new lA;r.curves=i.curves,t.push(r)}return t}(i);if(g.length>1){let e=!1,n=0;for(let t=0,i=g.length;t<i;t++)c[t]=[];for(let i=0,r=g.length;i<r;i++){const r=d[i];for(let s=0;s<r.length;s++){const o=r[s];let a=!0;for(let r=0;r<g.length;r++)t(o.p,g[r].p)&&(i!==r&&n++,a?(a=!1,c[r].push(o)):e=!0);a&&c[i].push(o)}}n>0&&!1===e&&(d=c)}for(let I=0,p=g.length;I<p;I++){o=g[I].s,a.push(o),A=d[I];for(let e=0,t=A.length;e<t;e++)o.holes.push(A[e].h)}return a}}"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:O}})),"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=O);const HI=55;function QI(e){let{showUI:n=!0}=e;const i=(0,t.useRef)(null);(0,t.useEffect)((()=>{i.current&&(i.current.value=HI)}),[i]);const r=(0,t.useCallback)((e=>{if(window.stars){const t=1999,n=1,i=1e3,r=400,s=e||55,o=e=>(new Sr).setFromSpherical(new tI(e,Math.acos(1-2*Math.random()),2*Math.random()*Math.PI)),[a,l,c]=(()=>{const e=[],a=[],l=Array.from({length:t},(()=>(.5+.5*Math.random())*s)),c=new Ps;let g=i+r;const u=r/t;for(let i=0;i<t;i++)g-=u*Math.random(),e.push(...o(g).toArray()),c.setHSL(i/t,n,.9),a.push(c.r,c.g,c.b);return[new Float32Array(e),new Float32Array(a),new Float32Array(l)]})();window.stars.geometry.attributes.size.array=c,window.stars.geometry.attributes.size.needsUpdate=!0}}),[]);return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)("div",{id:"div-input-range-stars-pointSize",className:"range",style:{display:n?"block":"none",position:"absolute",left:30,bottom:195,border:"none",borderRadius:"4px"},children:(0,I.jsx)("input",{className:"range1",type:"range",ref:i,onChange:e=>r(e.target.value),min:0,max:1e3,step:1})})})}function KI(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"video",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;const[i,r]=(0,t.useState)(null);return(0,t.useEffect)((()=>{const t=setInterval((()=>{const n=document.getElementById(e);n&&0!==n.videoWidth&&0!==n.videoHeight&&(r(n),clearInterval(t))}),n);return()=>{clearInterval(t)}}),[e,n]),i}function XI(e){let{showUI:n=!0}=e;const i=KI(),r=(0,t.useRef)(null);(0,t.useEffect)((()=>{r.current&&(r.current.value=0)}),[]);const s=(0,t.useCallback)((e=>{const t=e/1e3-.01;null!==i&&void 0!==i&&i.currentTime&&(i.currentTime=t*i.duration)}));return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)("div",{id:"div-input-video-currentTime",className:"range",style:{display:n?"block":"none",position:"absolute",left:30,bottom:165,border:"none",borderRadius:"4px"},children:(0,I.jsx)("input",{className:"range1",type:"range",ref:r,onChange:e=>s(e.target.value),min:1,max:1e3,step:1})})})}var YI=n(205);function zI(e){let t;const n=new Set,i=(e,i)=>{const r="function"===typeof e?e(t):e;if(r!==t){const e=t;t=i?r:Object.assign({},t,r),n.forEach((n=>n(t,e)))}},r=()=>t,s={setState:i,getState:r,subscribe:(e,i,s)=>i||s?function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.is;console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let o=i(t);function a(){const n=i(t);if(!s(o,n)){const t=o;e(o=n,t)}}return n.add(a),()=>n.delete(a)}(e,i,s):(n.add(e),()=>n.delete(e)),destroy:()=>n.clear()};return t=e(i,r,s),s}const PI="undefined"===typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?t.useEffect:t.useLayoutEffect;function UI(e){const n="function"===typeof e?zI(e):e,i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.getState,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.is;const[,r]=(0,t.useReducer)((e=>e+1),0),s=n.getState(),o=(0,t.useRef)(s),a=(0,t.useRef)(e),l=(0,t.useRef)(i),c=(0,t.useRef)(!1),g=(0,t.useRef)();let u;void 0===g.current&&(g.current=e(s));let A=!1;(o.current!==s||a.current!==e||l.current!==i||c.current)&&(u=e(s),A=!i(g.current,u)),PI((()=>{A&&(g.current=u),o.current=s,a.current=e,l.current=i,c.current=!1}));const d=(0,t.useRef)(s);PI((()=>{const e=()=>{try{const e=n.getState(),t=a.current(e);l.current(g.current,t)||(o.current=e,g.current=t,r())}catch(HY){c.current=!0,r()}},t=n.subscribe(e);return n.getState()!==d.current&&e(),t}),[]);const h=A?u:g.current;return(0,t.useDebugValue)(h),h};return Object.assign(i,n),i[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const e=[i,n];return{next(){const t=e.length<=0;return{value:e.shift(),done:t}}}},i}var _I=n(16),OI=n.n(_I),JI=n(853);const jI=[];function qI(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e===t;if(e===t)return!0;if(!e||!t)return!1;const i=e.length;if(t.length!==i)return!1;for(let r=0;r<i;r++)if(!n(e[r],t[r]))return!1;return!0}function $I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};null===t&&(t=[e]);for(const o of jI)if(qI(t,o.keys,o.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(o,"error"))throw o.error;if(Object.prototype.hasOwnProperty.call(o,"response"))return i.lifespan&&i.lifespan>0&&(o.timeout&&clearTimeout(o.timeout),o.timeout=setTimeout(o.remove,i.lifespan)),o.response;if(!n)throw o.promise}const r={keys:t,equal:i.equal,remove:()=>{const e=jI.indexOf(r);-1!==e&&jI.splice(e,1)},promise:(s=e,"object"===typeof s&&"function"===typeof s.then?e:e(...t)).then((e=>{r.response=e,i.lifespan&&i.lifespan>0&&(r.timeout=setTimeout(r.remove,i.lifespan))})).catch((e=>r.error=e))};var s;if(jI.push(r),!n)throw r.promise}const ep=(e,t,n)=>$I(e,t,!1,n);const tp={},np=e=>{Object.assign(tp,e)};var ip,rp;const sp=e=>"colorSpace"in e||"outputColorSpace"in e,op=()=>{var e;return null!=(e=tp.ColorManagement)?e:null},ap=e=>e&&e.isOrthographicCamera,lp="undefined"!==typeof window&&(null!=(ip=window.document)&&ip.createElement||"ReactNative"===(null==(rp=window.navigator)?void 0:rp.product))?t.useLayoutEffect:t.useEffect;function cp(e){const n=t.useRef(e);return lp((()=>{n.current=e}),[e]),n}function gp(e){let{set:t}=e;return lp((()=>(t(new Promise((()=>null))),()=>t(!1))),[t]),null}class up extends t.Component{constructor(){super(...arguments),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}up.getDerivedStateFromError=()=>({error:!0});const Ap="__default",dp=new Map,hp=e=>e&&!!e.memoized&&!!e.changes;function Ip(e){var t;const n="undefined"!==typeof window?null!=(t=window.devicePixelRatio)?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],n),e[1]):e}const pp=e=>{var t;return null==(t=e.__r3f)?void 0:t.root.getState()};function Cp(e){let t=e.__r3f.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}const mp={obj:e=>e===Object(e)&&!mp.arr(e)&&"function"!==typeof e,fun:e=>"function"===typeof e,str:e=>"string"===typeof e,num:e=>"number"===typeof e,boo:e=>"boolean"===typeof e,und:e=>void 0===e,arr:e=>Array.isArray(e),equ(e,t){let{arrays:n="shallow",objects:i="reference",strict:r=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(typeof e!==typeof t||!!e!==!!t)return!1;if(mp.str(e)||mp.num(e)||mp.boo(e))return e===t;const s=mp.obj(e);if(s&&"reference"===i)return e===t;const o=mp.arr(e);if(o&&"reference"===n)return e===t;if((o||s)&&e===t)return!0;let a;for(a in e)if(!(a in t))return!1;if(s&&"shallow"===n&&"shallow"===i){for(a in r?t:e)if(!mp.equ(e[a],t[a],{strict:r,objects:"reference"}))return!1}else for(a in r?t:e)if(e[a]!==t[a])return!1;if(mp.und(a)){if(o&&0===e.length&&0===t.length)return!0;if(s&&0===Object.keys(e).length&&0===Object.keys(t).length)return!0;if(e!==t)return!1}return!0}};function fp(e){const t={nodes:{},materials:{}};return e&&e.traverse((e=>{e.name&&(t.nodes[e.name]=e),e.material&&!t.materials[e.material.name]&&(t.materials[e.material.name]=e.material)})),t}function yp(e,t){return e.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t},e}function bp(e,t){let n=e;if(t.includes("-")){const i=t.split("-"),r=i.pop();return n=i.reduce(((e,t)=>e[t]),e),{target:n,key:r}}return{target:n,key:t}}const Bp=/-\d+$/;function vp(e,t,n){if(mp.str(n)){if(Bp.test(n)){const t=n.replace(Bp,""),{target:i,key:r}=bp(e,t);Array.isArray(i[r])||(i[r]=[])}const{target:i,key:r}=bp(e,n);t.__r3f.previousAttach=i[r],i[r]=t}else t.__r3f.previousAttach=n(e,t)}function wp(e,t,n){var i,r;if(mp.str(n)){const{target:i,key:r}=bp(e,n),s=t.__r3f.previousAttach;void 0===s?delete i[r]:i[r]=s}else null==(i=t.__r3f)||null==i.previousAttach||i.previousAttach(e,t);null==(r=t.__r3f)||delete r.previousAttach}function Gp(e,t){let{children:n,key:i,ref:r,...s}=t,{children:o,key:a,ref:l,...c}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},g=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const u=e.__r3f,A=Object.entries(s),d=[];if(g){const e=Object.keys(c);for(let t=0;t<e.length;t++)s.hasOwnProperty(e[t])||A.unshift([e[t],Ap+"remove"])}A.forEach((t=>{let[n,i]=t;var r;if(null!=(r=e.__r3f)&&r.primitive&&"object"===n)return;if(mp.equ(i,c[n]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(n))return d.push([n,i,!0,[]]);let o=[];n.includes("-")&&(o=n.split("-")),d.push([n,i,!1,o]);for(const e in s){const t=s[e];e.startsWith("".concat(n,"-"))&&d.push([e,t,!1,e.split("-")])}}));const h={...s};return null!=u&&u.memoizedProps&&null!=u&&u.memoizedProps.args&&(h.args=u.memoizedProps.args),null!=u&&u.memoizedProps&&null!=u&&u.memoizedProps.attach&&(h.attach=u.memoizedProps.attach),{memoized:h,changes:d}}const Ep="undefined"!==typeof process&&!1;function xp(e,t){var n;const i=e.__r3f,r=null==i?void 0:i.root,s=null==r||null==r.getState?void 0:r.getState(),{memoized:o,changes:a}=hp(t)?t:Gp(e,t),l=null==i?void 0:i.eventCount;e.__r3f&&(e.__r3f.memoizedProps=o);for(let c=0;c<a.length;c++){let[t,n,r,o]=a[c];if(sp(e)){const e=3001,i="srgb",r="srgb-linear";"encoding"===t?(t="colorSpace",n=n===e?i:r):"outputEncoding"===t&&(t="outputColorSpace",n=n===e?i:r)}let l=e,g=l[t];if(o.length&&(g=o.reduce(((e,t)=>e[t]),e),!g||!g.set)){const[n,...i]=o.reverse();l=i.reverse().reduce(((e,t)=>e[t]),e),t=n}if(n===Ap+"remove")if(l.constructor){let e=dp.get(l.constructor);e||(e=new l.constructor,dp.set(l.constructor,e)),n=e[t]}else n=0;if(r&&i)n?i.handlers[t]=n:delete i.handlers[t],i.eventCount=Object.keys(i.handlers).length;else if(g&&g.set&&(g.copy||g instanceof Is)){if(Array.isArray(n))g.fromArray?g.fromArray(n):g.set(...n);else if(g.copy&&n&&n.constructor&&(Ep?g.constructor.name===n.constructor.name:g.constructor===n.constructor))g.copy(n);else if(void 0!==n){const e=g instanceof Ps;!e&&g.setScalar?g.setScalar(n):g instanceof Is&&n instanceof Is?g.mask=n.mask:g.set(n),!op()&&s&&!s.linear&&e&&g.convertSRGBToLinear()}}else if(l[t]=n,l[t]instanceof mr&&l[t].format===Nt&&l[t].type===bt&&s){const e=l[t];sp(e)&&sp(s.gl)?e.colorSpace=s.gl.outputColorSpace:e.encoding=s.gl.outputEncoding}Sp(e)}if(i&&i.parent&&e.raycast&&l!==i.eventCount){const t=Cp(e).getState().internal,n=t.interaction.indexOf(e);n>-1&&t.interaction.splice(n,1),i.eventCount&&t.interaction.push(e)}return!(1===a.length&&"onUpdate"===a[0][0])&&a.length&&null!=(n=e.__r3f)&&n.parent&&Rp(e),e}function Sp(e){var t,n;const i=null==(t=e.__r3f)||null==(n=t.root)||null==n.getState?void 0:n.getState();i&&0===i.internal.frames&&i.invalidate()}function Rp(e){null==e.onUpdate||e.onUpdate(e)}function Zp(e,t){e.manual||(ap(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function Dp(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function Fp(e,t,n,i){const r=n.get(t);r&&(n.delete(t),0===n.size&&(e.delete(i),r.target.releasePointerCapture(i)))}function Np(e){function t(e){return e.filter((e=>["Move","Over","Enter","Out","Leave"].some((t=>{var n;return null==(n=e.__r3f)?void 0:n.handlers["onPointer"+t]}))))}function n(t){const{internal:n}=e.getState();for(const e of n.hovered.values())if(!t.length||!t.find((t=>t.object===e.object&&t.index===e.index&&t.instanceId===e.instanceId))){const i=e.eventObject.__r3f,r=null==i?void 0:i.handlers;if(n.hovered.delete(Dp(e)),null!=i&&i.eventCount){const n={...e,intersections:t};null==r.onPointerOut||r.onPointerOut(n),null==r.onPointerLeave||r.onPointerLeave(n)}}}function i(e,t){for(let n=0;n<t.length;n++){const i=t[n].__r3f;null==i||null==i.handlers.onPointerMissed||i.handlers.onPointerMissed(e)}}return{handlePointer:function(r){switch(r){case"onPointerLeave":case"onPointerCancel":return()=>n([]);case"onLostPointerCapture":return t=>{const{internal:i}=e.getState();"pointerId"in t&&i.capturedMap.has(t.pointerId)&&requestAnimationFrame((()=>{i.capturedMap.has(t.pointerId)&&(i.capturedMap.delete(t.pointerId),n([]))}))}}return function(s){const{onPointerMissed:o,internal:a}=e.getState();a.lastEvent.current=s;const l="onPointerMove"===r,c="onClick"===r||"onContextMenu"===r||"onDoubleClick"===r,g=function(t,n){const i=e.getState(),r=new Set,s=[],o=n?n(i.internal.interaction):i.internal.interaction;for(let e=0;e<o.length;e++){const t=pp(o[e]);t&&(t.raycaster.camera=void 0)}i.previousRoot||null==i.events.compute||i.events.compute(t,i);let a=o.flatMap((function(e){const n=pp(e);return n&&n.events.enabled&&null!==n.raycaster.camera?(void 0===n.raycaster.camera&&(null==n.events.compute||n.events.compute(t,n,null==(i=n.previousRoot)?void 0:i.getState()),void 0===n.raycaster.camera&&(n.raycaster.camera=null)),n.raycaster.camera?n.raycaster.intersectObject(e,!0):[]):[];var i})).sort(((e,t)=>{const n=pp(e.object),i=pp(t.object);return n&&i&&i.events.priority-n.events.priority||e.distance-t.distance})).filter((e=>{const t=Dp(e);return!r.has(t)&&(r.add(t),!0)}));i.events.filter&&(a=i.events.filter(a,i));for(const e of a){let t=e.object;for(;t;){var l;null!=(l=t.__r3f)&&l.eventCount&&s.push({...e,eventObject:t}),t=t.parent}}if("pointerId"in t&&i.internal.capturedMap.has(t.pointerId))for(let e of i.internal.capturedMap.get(t.pointerId).values())r.has(Dp(e.intersection))||s.push(e.intersection);return s}(s,l?t:void 0),u=c?function(t){const{internal:n}=e.getState(),i=t.offsetX-n.initialClick[0],r=t.offsetY-n.initialClick[1];return Math.round(Math.sqrt(i*i+r*r))}(s):0;"onPointerDown"===r&&(a.initialClick=[s.offsetX,s.offsetY],a.initialHits=g.map((e=>e.eventObject))),c&&!g.length&&u<=2&&(i(s,a.interaction),o&&o(s)),l&&n(g),function(t,i,r,s){const o=e.getState();if(t.length){const e={stopped:!1};for(const a of t){const l=pp(a.object)||o,{raycaster:c,pointer:g,camera:u,internal:A}=l,d=new Sr(g.x,g.y,0).unproject(u),h=e=>{var t,n;return null!=(t=null==(n=A.capturedMap.get(e))?void 0:n.has(a.eventObject))&&t},I=e=>{const t={intersection:a,target:i.target};A.capturedMap.has(e)?A.capturedMap.get(e).set(a.eventObject,t):A.capturedMap.set(e,new Map([[a.eventObject,t]])),i.target.setPointerCapture(e)},p=e=>{const t=A.capturedMap.get(e);t&&Fp(A.capturedMap,a.eventObject,t,e)};let C={};for(let e in i){let t=i[e];"function"!==typeof t&&(C[e]=t)}let m={...a,...C,pointer:g,intersections:t,stopped:e.stopped,delta:r,unprojectedPoint:d,ray:c.ray,camera:u,stopPropagation(){const r="pointerId"in i&&A.capturedMap.get(i.pointerId);(!r||r.has(a.eventObject))&&(m.stopped=e.stopped=!0,A.hovered.size&&Array.from(A.hovered.values()).find((e=>e.eventObject===a.eventObject)))&&n([...t.slice(0,t.indexOf(a)),a])},target:{hasPointerCapture:h,setPointerCapture:I,releasePointerCapture:p},currentTarget:{hasPointerCapture:h,setPointerCapture:I,releasePointerCapture:p},nativeEvent:i};if(s(m),!0===e.stopped)break}}}(g,s,u,(function(e){const t=e.eventObject,n=t.__r3f,o=null==n?void 0:n.handlers;if(null!=n&&n.eventCount)if(l){if(o.onPointerOver||o.onPointerEnter||o.onPointerOut||o.onPointerLeave){const t=Dp(e),n=a.hovered.get(t);n?n.stopped&&e.stopPropagation():(a.hovered.set(t,e),null==o.onPointerOver||o.onPointerOver(e),null==o.onPointerEnter||o.onPointerEnter(e))}null==o.onPointerMove||o.onPointerMove(e)}else{const n=o[r];n?c&&!a.initialHits.includes(t)||(i(s,a.interaction.filter((e=>!a.initialHits.includes(e)))),n(e)):c&&a.initialHits.includes(t)&&i(s,a.interaction.filter((e=>!a.initialHits.includes(e))))}}))}}}}const Mp=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],Wp=e=>!(null==e||!e.render),kp=t.createContext(null),Tp=(e,n)=>{const i=UI(((i,r)=>{const s=new Sr,o=new Sr,a=new Sr;function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r().camera,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r().size;const{width:i,height:l,top:c,left:g}=n,u=i/l;t instanceof Sr?a.copy(t):a.set(...t);const A=e.getWorldPosition(s).distanceTo(a);if(ap(e))return{width:i/e.zoom,height:l/e.zoom,top:c,left:g,factor:1,distance:A,aspect:u};{const t=e.fov*Math.PI/180,n=2*Math.tan(t/2)*A,r=n*(i/l);return{width:r,height:n,top:c,left:g,factor:i/r,distance:A,aspect:u}}}let c;const g=e=>i((t=>({performance:{...t.performance,current:e}}))),u=new Oi,A={set:i,get:r,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e(r(),t)},advance:(e,t)=>n(e,t,r()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new bh,pointer:u,mouse:u,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const e=r();c&&clearTimeout(c),e.performance.current!==e.performance.min&&g(e.performance.min),c=setTimeout((()=>g(r().performance.max)),e.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:l},setEvents:e=>i((t=>({...t,events:{...t.events,...e}}))),setSize:(e,t,n,s,a)=>{const c=r().camera,g={width:e,height:t,top:s||0,left:a||0,updateStyle:n};i((e=>({size:g,viewport:{...e.viewport,...l(c,o,g)}})))},setDpr:e=>i((t=>{const n=Ip(e);return{viewport:{...t.viewport,dpr:n,initialDpr:t.viewport.initialDpr||n}}})),setFrameloop:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"always";const t=r().clock;t.stop(),t.elapsedTime=0,"never"!==e&&(t.start(),t.elapsedTime=0),i((()=>({frameloop:e})))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:t.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(e,t,n)=>{const i=r().internal;return i.priority=i.priority+(t>0?1:0),i.subscribers.push({ref:e,priority:t,store:n}),i.subscribers=i.subscribers.sort(((e,t)=>e.priority-t.priority)),()=>{const n=r().internal;null!=n&&n.subscribers&&(n.priority=n.priority-(t>0?1:0),n.subscribers=n.subscribers.filter((t=>t.ref!==e)))}}}};return A})),r=i.getState();let s=r.size,o=r.viewport.dpr,a=r.camera;return i.subscribe((()=>{const{camera:e,size:t,viewport:n,gl:r,set:l}=i.getState();if(t.width!==s.width||t.height!==s.height||n.dpr!==o){var c;s=t,o=n.dpr,Zp(e,t),r.setPixelRatio(n.dpr);const i=null!=(c=t.updateStyle)?c:"undefined"!==typeof HTMLCanvasElement&&r.domElement instanceof HTMLCanvasElement;r.setSize(t.width,t.height,i)}e!==a&&(a=e,l((t=>({viewport:{...t.viewport,...t.viewport.getCurrentViewport(e)}}))))})),i.subscribe((t=>e(t))),i};let Vp,Lp=new Set,Hp=new Set,Qp=new Set;function Kp(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function Xp(e,t){switch(e){case"before":return Kp(Lp,t);case"after":return Kp(Hp,t);case"tail":return Kp(Qp,t)}}let Yp,zp;function Pp(e,t,n){let i=t.clock.getDelta();for("never"===t.frameloop&&"number"===typeof e&&(i=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),Yp=t.internal.subscribers,Vp=0;Vp<Yp.length;Vp++)zp=Yp[Vp],zp.ref.current(zp.store.getState(),i,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),"always"===t.frameloop?1:t.internal.frames}function Up(){const e=t.useContext(kp);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function _p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>e,t=arguments.length>1?arguments[1]:void 0;return Up()(e,t)}function Op(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=Up(),i=n.getState().internal.subscribe,r=cp(e);return lp((()=>i(r,t,n)),[t,i,n]),null}const Jp=new WeakMap;function jp(e,t){return function(n){let i=Jp.get(n);i||(i=new n,Jp.set(n,i)),e&&e(i);for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];return Promise.all(s.map((e=>new Promise(((n,r)=>i.load(e,(e=>{e.scene&&Object.assign(e,fp(e.scene)),n(e)}),t,(t=>r(new Error("Could not load ".concat(e,": ").concat(null==t?void 0:t.message))))))))))}}function qp(e,t,n,i){const r=Array.isArray(t)?t:[t],s=ep(jp(n,i),[e,...r],{equal:mp.equ});return Array.isArray(t)?s:s[0]}qp.preload=function(e,t,n){const i=Array.isArray(t)?t:[t];return((e,t,n)=>{$I(e,t,!0,n)})(jp(n),[e,...i])},qp.clear=function(e,t){return(e=>{if(void 0===e||0===e.length)jI.splice(0,jI.length);else{const t=jI.find((t=>qI(e,t.keys,t.equal)));t&&t.remove()}})([e,...Array.isArray(t)?t:[t]])};const $p=new Map,{invalidate:eC,advance:tC}=function(e){let t,n,i,r=!1,s=!1;function o(a){n=requestAnimationFrame(o),r=!0,t=0,Xp("before",a),s=!0;for(const n of e.values()){var l;i=n.store.getState(),!i.internal.active||!("always"===i.frameloop||i.internal.frames>0)||null!=(l=i.gl.xr)&&l.isPresenting||(t+=Pp(a,i))}if(s=!1,Xp("after",a),0===t)return Xp("tail",a),r=!1,cancelAnimationFrame(n)}return{loop:o,invalidate:function t(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;var a;if(!n)return e.forEach((e=>t(e.store.getState(),i)));null!=(a=n.gl.xr)&&a.isPresenting||!n.internal.active||"never"===n.frameloop||(n.internal.frames=i>1?Math.min(60,n.internal.frames+i):s?2:1,r||(r=!0,requestAnimationFrame(o)))},advance:function(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(n&&Xp("before",t),i)Pp(t,i,r);else for(const s of e.values())Pp(t,s.store.getState());n&&Xp("after",t)}}}($p),{reconciler:nC,applyProps:iC}=function(e,t){function n(e,t,n){let i,{args:r=[],attach:s,...o}=t,a="".concat(e[0].toUpperCase()).concat(e.slice(1));if("primitive"===e){if(void 0===o.object)throw new Error("R3F: Primitives without 'object' are invalid!");i=yp(o.object,{type:e,root:n,attach:s,primitive:!0})}else{const t=tp[a];if(!t)throw new Error("R3F: ".concat(a," is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively"));if(!Array.isArray(r))throw new Error("R3F: The args prop must be an array!");i=yp(new t(...r),{type:e,root:n,attach:s,memoizedProps:{args:r}})}return void 0===i.__r3f.attach&&(i instanceof vo?i.__r3f.attach="geometry":i instanceof Os&&(i.__r3f.attach="material")),"inject"!==a&&xp(i,o),i}function i(e,t){let n=!1;var i,r;t&&(null!=(i=t.__r3f)&&i.attach?vp(e,t,t.__r3f.attach):t.isObject3D&&e.isObject3D&&(e.add(t),n=!0),n||null==(r=e.__r3f)||r.objects.push(t),t.__r3f||yp(t,{}),t.__r3f.parent=e,Rp(t),Sp(t))}function r(e,t,n){let i=!1;if(t){var r,s;if(null!=(r=t.__r3f)&&r.attach)vp(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){t.parent=e,t.dispatchEvent({type:"added"}),e.dispatchEvent({type:"childadded",child:t});const r=e.children.filter((e=>e!==t)),s=r.indexOf(n);e.children=[...r.slice(0,s),t,...r.slice(s)],i=!0}i||null==(s=e.__r3f)||s.objects.push(t),t.__r3f||yp(t,{}),t.__r3f.parent=e,Rp(t),Sp(t)}}function s(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e&&[...e].forEach((e=>o(t,e,n)))}function o(e,t,n){if(t){var i,r,o;if(t.__r3f&&(t.__r3f.parent=null),null!=(i=e.__r3f)&&i.objects&&(e.__r3f.objects=e.__r3f.objects.filter((e=>e!==t))),null!=(r=t.__r3f)&&r.attach)wp(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){var a;e.remove(t),null!=(a=t.__r3f)&&a.root&&function(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter((e=>e!==t)),n.initialHits=n.initialHits.filter((e=>e!==t)),n.hovered.forEach(((e,i)=>{e.eventObject!==t&&e.object!==t||n.hovered.delete(i)})),n.capturedMap.forEach(((e,i)=>{Fp(n.capturedMap,t,e,i)}))}(Cp(t),t)}const c=null==(o=t.__r3f)?void 0:o.primitive,g=!c&&(void 0===n?null!==t.dispose:n);var l;if(!c)s(null==(l=t.__r3f)?void 0:l.objects,t,g),s(t.children,t,g);if(delete t.__r3f,g&&t.dispose&&"Scene"!==t.type){const e=()=>{try{t.dispose()}catch(Ow){}};"undefined"===typeof IS_REACT_ACT_ENVIRONMENT?(0,JI.unstable_scheduleCallback)(JI.unstable_IdlePriority,e):e()}Sp(e)}}const a=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:OI()({createInstance:n,removeChild:o,appendChild:i,appendInitialChild:i,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(e,t)=>{if(!t)return;const n=e.getState().scene;n.__r3f&&(n.__r3f.root=e,i(n,t))},removeChildFromContainer:(e,t)=>{t&&o(e.getState().scene,t)},insertInContainerBefore:(e,t,n)=>{if(!t||!n)return;const i=e.getState().scene;i.__r3f&&r(i,t,n)},getRootHostContext:()=>null,getChildHostContext:e=>e,finalizeInitialChildren(e){var t;const n=null!=(t=null==e?void 0:e.__r3f)?t:{};return Boolean(n.handlers)},prepareUpdate(e,t,n,i){var r;if((null!=(r=null==e?void 0:e.__r3f)?r:{}).primitive&&i.object&&i.object!==e)return[!0];{const{args:t=[],children:r,...s}=i,{args:o=[],children:a,...l}=n;if(!Array.isArray(t))throw new Error("R3F: the args prop must be an array!");if(t.some(((e,t)=>e!==o[t])))return[!0];const c=Gp(e,s,l,!0);return c.changes.length?[!1,c]:null}},commitUpdate(e,t,r,s,a,l){let[c,g]=t;c?function(e,t,r,s){var a;const l=null==(a=e.__r3f)?void 0:a.parent;if(!l)return;const c=n(t,r,e.__r3f.root);if(e.children){for(const t of e.children)t.__r3f&&i(c,t);e.children=e.children.filter((e=>!e.__r3f))}e.__r3f.objects.forEach((e=>i(c,e))),e.__r3f.objects=[],e.__r3f.autoRemovedBeforeAppend||o(l,e),c.parent&&(c.__r3f.autoRemovedBeforeAppend=!0),i(l,c),c.raycast&&c.__r3f.eventCount&&Cp(c).getState().internal.interaction.push(c);[s,s.alternate].forEach((e=>{null!==e&&(e.stateNode=c,e.ref&&("function"===typeof e.ref?e.ref(c):e.ref.current=c))}))}(e,r,a,l):xp(e,g)},commitMount(e,t,n,i){var r;const s=null!=(r=e.__r3f)?r:{};e.raycast&&s.handlers&&s.eventCount&&Cp(e).getState().internal.interaction.push(e)},getPublicInstance:e=>e,prepareForCommit:()=>null,preparePortalMount:e=>yp(e.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(e){var t;const{attach:n,parent:i}=null!=(t=e.__r3f)?t:{};n&&i&&wp(i,e,n),e.isObject3D&&(e.visible=!1),Sp(e)},unhideInstance(e,t){var n;const{attach:i,parent:r}=null!=(n=e.__r3f)?n:{};i&&r&&vp(r,e,i),(e.isObject3D&&null==t.visible||t.visible)&&(e.visible=!0),Sp(e)},createTextInstance:a,hideTextInstance:a,unhideTextInstance:a,getCurrentEventPriority:()=>t?t():YI.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:"undefined"!==typeof performance&&mp.fun(performance.now)?performance.now:mp.fun(Date.now)?Date.now:()=>0,scheduleTimeout:mp.fun(setTimeout)?setTimeout:void 0,cancelTimeout:mp.fun(clearTimeout)?clearTimeout:void 0}),applyProps:xp}}(0,(function(){var e;const t="undefined"!==typeof self&&self||"undefined"!==typeof window&&window;if(!t)return YI.DefaultEventPriority;switch(null==(e=t.event)?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return YI.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return YI.ContinuousEventPriority;default:return YI.DefaultEventPriority}})),rC={objects:"shallow",strict:!1},sC=(e,t)=>{const n="function"===typeof e?e(t):e;return Wp(n)?n:new Yc({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function oC(e){const t=$p.get(e),n=null==t?void 0:t.fiber,i=null==t?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const r="function"===typeof reportError?reportError:console.error,s=i||Tp(eC,tC),o=n||nC.createContainer(s,YI.ConcurrentRoot,null,!1,null,"",r,null);let a;t||$p.set(e,{fiber:o,store:s});let l,c=!1;return{configure(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{gl:n,size:i,scene:r,events:o,onCreated:g,shadows:u=!1,linear:A=!1,flat:d=!1,legacy:h=!1,orthographic:I=!1,frameloop:p="always",dpr:C=[1,2],performance:m,raycaster:f,camera:y,onPointerMissed:b}=t,B=s.getState(),v=B.gl;B.gl||B.set({gl:v=sC(n,e)});let w=B.raycaster;w||B.set({raycaster:w=new qh});const{params:G,...E}=f||{};if(mp.equ(E,w,rC)||iC(w,{...E}),mp.equ(G,w.params,rC)||iC(w,{params:{...w.params,...G}}),!B.camera||B.camera===l&&!mp.equ(l,y,rC)){l=y;const e=y instanceof Oo,t=e?y:I?new ba(0,0,0,0,.1,1e3):new Jo(75,0,.1,1e3);e||(t.position.z=5,y&&(iC(t,y),("aspect"in y||"left"in y||"right"in y||"bottom"in y||"top"in y)&&(t.manual=!0,t.updateProjectionMatrix())),B.camera||null!=y&&y.rotation||t.lookAt(0,0,0)),B.set({camera:t}),w.camera=t}if(!B.scene){let e;r instanceof _c?e=r:(e=new _c,r&&iC(e,r)),B.set({scene:yp(e)})}if(!B.xr){var x;const e=(e,t)=>{const n=s.getState();"never"!==n.frameloop&&tC(e,!0,n,t)},t=()=>{const t=s.getState();t.gl.xr.enabled=t.gl.xr.isPresenting,t.gl.xr.setAnimationLoop(t.gl.xr.isPresenting?e:null),t.gl.xr.isPresenting||eC(t)},n={connect(){const e=s.getState().gl;e.xr.addEventListener("sessionstart",t),e.xr.addEventListener("sessionend",t)},disconnect(){const e=s.getState().gl;e.xr.removeEventListener("sessionstart",t),e.xr.removeEventListener("sessionend",t)}};"function"===typeof(null==(x=v.xr)?void 0:x.addEventListener)&&n.connect(),B.set({xr:n})}if(v.shadowMap){const e=v.shadowMap.enabled,t=v.shadowMap.type;if(v.shadowMap.enabled=!!u,mp.boo(u))v.shadowMap.type=re;else if(mp.str(u)){var S;const e={basic:ne,percentage:ie,soft:re,variance:se};v.shadowMap.type=null!=(S=e[u])?S:re}else mp.obj(u)&&Object.assign(v.shadowMap,u);e===v.shadowMap.enabled&&t===v.shadowMap.type||(v.shadowMap.needsUpdate=!0)}const R=op();if(R&&("enabled"in R?R.enabled=!h:"legacyMode"in R&&(R.legacyMode=h)),!c){iC(v,{outputEncoding:A?3e3:3001,toneMapping:d?Ue:je})}B.legacy!==h&&B.set((()=>({legacy:h}))),B.linear!==A&&B.set((()=>({linear:A}))),B.flat!==d&&B.set((()=>({flat:d}))),!n||mp.fun(n)||Wp(n)||mp.equ(n,v,rC)||iC(v,n),o&&!B.events.handlers&&B.set({events:o(s)});const Z=function(e,t){const n="undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement;if(t){const{width:e,height:i,top:r,left:s,updateStyle:o=n}=t;return{width:e,height:i,top:r,left:s,updateStyle:o}}if("undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:t,height:i,top:r,left:s}=e.parentElement.getBoundingClientRect();return{width:t,height:i,top:r,left:s,updateStyle:n}}return"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas?{width:e.width,height:e.height,top:0,left:0,updateStyle:n}:{width:0,height:0,top:0,left:0}}(e,i);return mp.equ(Z,B.size,rC)||B.setSize(Z.width,Z.height,Z.updateStyle,Z.top,Z.left),C&&B.viewport.dpr!==Ip(C)&&B.setDpr(C),B.frameloop!==p&&B.setFrameloop(p),B.onPointerMissed||B.set({onPointerMissed:b}),m&&!mp.equ(m,B.performance,rC)&&B.set((e=>({performance:{...e.performance,...m}}))),a=g,c=!0,this},render(t){return c||this.configure(),nC.updateContainer((0,I.jsx)(aC,{store:s,children:t,onCreated:a,rootElement:e}),o,null,(()=>{})),s},unmount(){lC(e)}}}function aC(e){let{store:t,children:n,onCreated:i,rootElement:r}=e;return lp((()=>{const e=t.getState();e.set((e=>({internal:{...e.internal,active:!0}}))),i&&i(e),t.getState().events.connected||null==e.events.connect||e.events.connect(r)}),[]),(0,I.jsx)(kp.Provider,{value:t,children:n})}function lC(e,t){const n=$p.get(e),i=null==n?void 0:n.fiber;if(i){const r=null==n?void 0:n.store.getState();r&&(r.internal.active=!1),nC.updateContainer(null,i,null,(()=>{r&&setTimeout((()=>{try{var n,i,s,o;null==r.events.disconnect||r.events.disconnect(),null==(n=r.gl)||null==(i=n.renderLists)||null==i.dispose||i.dispose(),null==(s=r.gl)||null==s.forceContextLoss||s.forceContextLoss(),null!=(o=r.gl)&&o.xr&&r.xr.disconnect(),function(e){e.dispose&&"Scene"!==e.type&&e.dispose();for(const t in e)null==t.dispose||t.dispose(),delete e[t]}(r),$p.delete(e),t&&t(e)}catch(Ow){}}),500)}))}}function cC(e,t,n){return(0,I.jsx)(gC,{children:e,container:t,state:n},t.uuid)}function gC(e){let{state:n={},children:i,container:r}=e;const{events:s,size:o,...a}=n,l=Up(),[c]=t.useState((()=>new qh)),[g]=t.useState((()=>new Oi)),u=t.useCallback(((e,t)=>{const n={...e};let i;if(Object.keys(e).forEach((i=>{(Mp.includes(i)||e[i]!==t[i]&&t[i])&&delete n[i]})),t&&o){const n=t.camera;i=e.viewport.getCurrentViewport(n,new Sr,o),n!==e.camera&&Zp(n,o)}return{...n,scene:r,raycaster:c,pointer:g,mouse:g,previousRoot:l,events:{...e.events,...null==t?void 0:t.events,...s},size:{...e.size,...o},viewport:{...e.viewport,...i},...a}}),[n]),[A]=t.useState((()=>{const e=l.getState(),t=UI(((t,n)=>({...e,scene:r,raycaster:c,pointer:g,mouse:g,previousRoot:l,events:{...e.events,...s},size:{...e.size,...o},...a,set:t,get:n,setEvents:e=>t((t=>({...t,events:{...t.events,...e}})))})));return t}));return t.useEffect((()=>{const e=l.subscribe((e=>A.setState((t=>u(e,t)))));return()=>{e()}}),[u]),t.useEffect((()=>{A.setState((e=>u(l.getState(),e)))}),[u]),t.useEffect((()=>()=>{A.destroy()}),[]),(0,I.jsx)(I.Fragment,{children:nC.createPortal((0,I.jsx)(kp.Provider,{value:A,children:i}),A,null)})}nC.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:t.version});t.unstable_act;function uC(e){const[n,i]=(0,t.useState)(!1);function r(t){let{key:n}=t;n===e&&i(!0)}const s=t=>{let{key:n}=t;n===e&&i(!1)};return(0,t.useEffect)((()=>(window.addEventListener("keydown",r),window.addEventListener("keyup",s),()=>{window.removeEventListener("keydown",r),window.removeEventListener("keyup",s)})),[]),n}function AC(e){return AC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},AC(e)}function dC(e){var t=function(e,t){if("object"!=AC(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=AC(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==AC(t)?t:t+""}function hC(e,t,n){return(t=dC(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function IC(e,t){if(t===Nn)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t===Wn||t===Mn){let n=e.getIndex();if(null===n){const t=[],i=e.getAttribute("position");if(void 0===i)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<i.count;e++)t.push(e);e.setIndex(t),n=e.getIndex()}const i=n.count-2,r=[];if(t===Wn)for(let e=1;e<=i;e++)r.push(n.getX(0)),r.push(n.getX(e)),r.push(n.getX(e+1));else for(let e=0;e<i;e++)e%2===0?(r.push(n.getX(e)),r.push(n.getX(e+1)),r.push(n.getX(e+2))):(r.push(n.getX(e+2)),r.push(n.getX(e+1)),r.push(n.getX(e)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=e.clone();return s.setIndex(r),s.clearGroups(),s}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}function pC(){let e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const CC={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class mC{constructor(e){this.parser=e,this.name=CC.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,i=t.length;n<i;n++){const i=t[n];i.extensions&&i.extensions[this.name]&&void 0!==i.extensions[this.name].light&&e._addNodeRef(this.cache,i.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let i=t.cache.get(n);if(i)return i;const r=t.json,s=((r.extensions&&r.extensions[this.name]||{}).lights||[])[e];let o;const a=new Ps(16777215);void 0!==s.color&&a.setRGB(s.color[0],s.color[1],s.color[2],Yn);const l=void 0!==s.range?s.range:0;switch(s.type){case"directional":o=new eh(a),o.target.position.set(0,0,-1),o.add(o.target);break;case"point":o=new qd(a),o.distance=l;break;case"spot":o=new Ud(a),o.distance=l,s.spot=s.spot||{},s.spot.innerConeAngle=void 0!==s.spot.innerConeAngle?s.spot.innerConeAngle:0,s.spot.outerConeAngle=void 0!==s.spot.outerConeAngle?s.spot.outerConeAngle:Math.PI/4,o.angle=s.spot.outerConeAngle,o.penumbra=1-s.spot.innerConeAngle/s.spot.outerConeAngle,o.target.position.set(0,0,-1),o.add(o.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+s.type)}return o.position.set(0,0,0),o.decay=2,im(o,s),void 0!==s.intensity&&(o.intensity=s.intensity),o.name=t.createUniqueName(s.name||"light_"+e),i=Promise.resolve(o),t.cache.add(n,i),i}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,i=n.json.nodes[e],r=(i.extensions&&i.extensions[this.name]||{}).light;return void 0===r?null:this._loadLight(r).then((function(e){return n._getNodeRef(t.cache,r,e)}))}}class fC{constructor(){this.name=CC.KHR_MATERIALS_UNLIT}getMaterialType(){return Js}extendParams(e,t,n){const i=[];e.color=new Ps(1,1,1),e.opacity=1;const r=t.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const t=r.baseColorFactor;e.color.setRGB(t[0],t[1],t[2],Yn),e.opacity=t[3]}void 0!==r.baseColorTexture&&i.push(n.assignTexture(e,"map",r.baseColorTexture,Xn))}return Promise.all(i)}}class yC{constructor(e){this.parser=e,this.name=CC.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const i=n.extensions[this.name].emissiveStrength;return void 0!==i&&(t.emissiveIntensity=i),Promise.resolve()}}class bC{constructor(e){this.parser=e,this.name=CC.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ed:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];if(void 0!==s.clearcoatFactor&&(t.clearcoat=s.clearcoatFactor),void 0!==s.clearcoatTexture&&r.push(n.assignTexture(t,"clearcoatMap",s.clearcoatTexture)),void 0!==s.clearcoatRoughnessFactor&&(t.clearcoatRoughness=s.clearcoatRoughnessFactor),void 0!==s.clearcoatRoughnessTexture&&r.push(n.assignTexture(t,"clearcoatRoughnessMap",s.clearcoatRoughnessTexture)),void 0!==s.clearcoatNormalTexture&&(r.push(n.assignTexture(t,"clearcoatNormalMap",s.clearcoatNormalTexture)),void 0!==s.clearcoatNormalTexture.scale)){const e=s.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Oi(e,e)}return Promise.all(r)}}class BC{constructor(e){this.parser=e,this.name=CC.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ed:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];return void 0!==s.iridescenceFactor&&(t.iridescence=s.iridescenceFactor),void 0!==s.iridescenceTexture&&r.push(n.assignTexture(t,"iridescenceMap",s.iridescenceTexture)),void 0!==s.iridescenceIor&&(t.iridescenceIOR=s.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==s.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=s.iridescenceThicknessMinimum),void 0!==s.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=s.iridescenceThicknessMaximum),void 0!==s.iridescenceThicknessTexture&&r.push(n.assignTexture(t,"iridescenceThicknessMap",s.iridescenceThicknessTexture)),Promise.all(r)}}class vC{constructor(e){this.parser=e,this.name=CC.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ed:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[];t.sheenColor=new Ps(0,0,0),t.sheenRoughness=0,t.sheen=1;const s=i.extensions[this.name];if(void 0!==s.sheenColorFactor){const e=s.sheenColorFactor;t.sheenColor.setRGB(e[0],e[1],e[2],Yn)}return void 0!==s.sheenRoughnessFactor&&(t.sheenRoughness=s.sheenRoughnessFactor),void 0!==s.sheenColorTexture&&r.push(n.assignTexture(t,"sheenColorMap",s.sheenColorTexture,Xn)),void 0!==s.sheenRoughnessTexture&&r.push(n.assignTexture(t,"sheenRoughnessMap",s.sheenRoughnessTexture)),Promise.all(r)}}class wC{constructor(e){this.parser=e,this.name=CC.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ed:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];return void 0!==s.transmissionFactor&&(t.transmission=s.transmissionFactor),void 0!==s.transmissionTexture&&r.push(n.assignTexture(t,"transmissionMap",s.transmissionTexture)),Promise.all(r)}}class GC{constructor(e){this.parser=e,this.name=CC.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ed:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];t.thickness=void 0!==s.thicknessFactor?s.thicknessFactor:0,void 0!==s.thicknessTexture&&r.push(n.assignTexture(t,"thicknessMap",s.thicknessTexture)),t.attenuationDistance=s.attenuationDistance||1/0;const o=s.attenuationColor||[1,1,1];return t.attenuationColor=(new Ps).setRGB(o[0],o[1],o[2],Yn),Promise.all(r)}}class EC{constructor(e){this.parser=e,this.name=CC.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ed:null}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const i=n.extensions[this.name];return t.ior=void 0!==i.ior?i.ior:1.5,Promise.resolve()}}class xC{constructor(e){this.parser=e,this.name=CC.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ed:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];t.specularIntensity=void 0!==s.specularFactor?s.specularFactor:1,void 0!==s.specularTexture&&r.push(n.assignTexture(t,"specularIntensityMap",s.specularTexture));const o=s.specularColorFactor||[1,1,1];return t.specularColor=(new Ps).setRGB(o[0],o[1],o[2],Yn),void 0!==s.specularColorTexture&&r.push(n.assignTexture(t,"specularColorMap",s.specularColorTexture,Xn)),Promise.all(r)}}class SC{constructor(e){this.parser=e,this.name=CC.EXT_MATERIALS_BUMP}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ed:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];return t.bumpScale=void 0!==s.bumpFactor?s.bumpFactor:1,void 0!==s.bumpTexture&&r.push(n.assignTexture(t,"bumpMap",s.bumpTexture)),Promise.all(r)}}class RC{constructor(e){this.parser=e,this.name=CC.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ed:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];return void 0!==s.anisotropyStrength&&(t.anisotropy=s.anisotropyStrength),void 0!==s.anisotropyRotation&&(t.anisotropyRotation=s.anisotropyRotation),void 0!==s.anisotropyTexture&&r.push(n.assignTexture(t,"anisotropyMap",s.anisotropyTexture)),Promise.all(r)}}class ZC{constructor(e){this.parser=e,this.name=CC.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,i=n.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const r=i.extensions[this.name],s=t.options.ktx2Loader;if(!s){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,r.source,s)}}class DC{constructor(e){this.parser=e,this.name=CC.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,i=n.json,r=i.textures[e];if(!r.extensions||!r.extensions[t])return null;const s=r.extensions[t],o=i.images[s.source];let a=n.textureLoader;if(o.uri){const e=n.options.manager.getHandler(o.uri);null!==e&&(a=e)}return this.detectSupport().then((function(r){if(r)return n.loadTextureImage(e,s.source,a);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class FC{constructor(e){this.parser=e,this.name=CC.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,i=n.json,r=i.textures[e];if(!r.extensions||!r.extensions[t])return null;const s=r.extensions[t],o=i.images[s.source];let a=n.textureLoader;if(o.uri){const e=n.options.manager.getHandler(o.uri);null!==e&&(a=e)}return this.detectSupport().then((function(r){if(r)return n.loadTextureImage(e,s.source,a);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class NC{constructor(e){this.name=CC.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const e=n.extensions[this.name],i=this.parser.getDependency("buffer",e.buffer),r=this.parser.options.meshoptDecoder;if(!r||!r.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return i.then((function(t){const n=e.byteOffset||0,i=e.byteLength||0,s=e.count,o=e.byteStride,a=new Uint8Array(t,n,i);return r.decodeGltfBufferAsync?r.decodeGltfBufferAsync(s,o,a,e.mode,e.filter).then((function(e){return e.buffer})):r.ready.then((function(){const t=new ArrayBuffer(s*o);return r.decodeGltfBuffer(new Uint8Array(t),s,o,a,e.mode,e.filter),t}))}))}return null}}class MC{constructor(e){this.name=CC.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||void 0===n.mesh)return null;const i=t.meshes[n.mesh];for(const a of i.primitives)if(a.mode!==zC.TRIANGLES&&a.mode!==zC.TRIANGLE_STRIP&&a.mode!==zC.TRIANGLE_FAN&&void 0!==a.mode)return null;const r=n.extensions[this.name].attributes,s=[],o={};for(const a in r)s.push(this.parser.getDependency("accessor",r[a]).then((e=>(o[a]=e,o[a]))));return s.length<1?null:(s.push(this.parser.createNodeMesh(e)),Promise.all(s).then((e=>{const t=e.pop(),n=t.isGroup?t.children:[t],i=e[0].count,r=[];for(const s of n){const e=new rs,t=new Sr,n=new xr,a=new Sr(1,1,1),l=new Hg(s.geometry,s.material,i);for(let r=0;r<i;r++)o.TRANSLATION&&t.fromBufferAttribute(o.TRANSLATION,r),o.ROTATION&&n.fromBufferAttribute(o.ROTATION,r),o.SCALE&&a.fromBufferAttribute(o.SCALE,r),l.setMatrixAt(r,e.compose(t,n,a));for(const i in o)if("_COLOR_0"===i){const e=o[i];l.instanceColor=new Fg(e.array,e.itemSize,e.normalized)}else"TRANSLATION"!==i&&"ROTATION"!==i&&"SCALE"!==i&&s.geometry.setAttribute(i,o[i]);Rs.prototype.copy.call(l,s),this.parser.assignFinalMaterial(l),r.push(l)}return t.isGroup?(t.clear(),t.add(...r),t):r[0]})))}}const WC="glTF",kC=1313821514,TC=5130562;class VC{constructor(e){this.name=CC.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==WC)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-12,r=new DataView(e,12);let s=0;for(;s<i;){const t=r.getUint32(s,!0);s+=4;const i=r.getUint32(s,!0);if(s+=4,i===kC){const i=new Uint8Array(e,12+s,t);this.content=n.decode(i)}else if(i===TC){const n=12+s;this.body=e.slice(n,n+t)}s+=t}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class LC{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=CC.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,i=this.dracoLoader,r=e.extensions[this.name].bufferView,s=e.extensions[this.name].attributes,o={},a={},l={};for(const c in s){const e=JC[c]||c.toLowerCase();o[e]=s[c]}for(const c in e.attributes){const t=JC[c]||c.toLowerCase();if(void 0!==s[c]){const i=n.accessors[e.attributes[c]],r=PC[i.componentType];l[t]=r.name,a[t]=!0===i.normalized}}return t.getDependency("bufferView",r).then((function(e){return new Promise((function(t,n){i.decodeDracoFile(e,(function(e){for(const t in e.attributes){const n=e.attributes[t],i=a[t];void 0!==i&&(n.normalized=i)}t(e)}),o,l,Yn,n)}))}))}}class HC{constructor(){this.name=CC.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&t.texCoord!==e.channel||void 0!==t.offset||void 0!==t.rotation||void 0!==t.scale?(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0,e):e}}class QC{constructor(){this.name=CC.KHR_MESH_QUANTIZATION}}class KC extends dd{constructor(e,t,n,i){super(e,t,n,i)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i*3+i;for(let s=0;s!==i;s++)t[s]=n[r+s];return t}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=2*o,l=3*o,c=i-t,g=(n-t)/c,u=g*g,A=u*g,d=e*l,h=d-l,I=-2*A+3*u,p=A-u,C=1-I,m=p-u+g;for(let f=0;f!==o;f++){const e=s[h+f+o],t=s[h+f+a]*c,n=s[d+f+o],i=s[d+f]*c;r[f]=C*e+m*t+I*n+p*i}return r}}const XC=new xr;class YC extends KC{interpolate_(e,t,n,i){const r=super.interpolate_(e,t,n,i);return XC.fromArray(r).normalize().toArray(r),r}}const zC={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},PC={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},UC={9728:ut,9729:pt,9984:At,9985:Ct,9986:ht,9987:ft},_C={33071:ct,33648:gt,10497:lt},OC={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},JC={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},jC={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},qC={CUBICSPLINE:void 0,LINEAR:En,STEP:Gn},$C="OPAQUE",em="MASK",tm="BLEND";function nm(e,t,n){for(const i in n.extensions)void 0===e[i]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[i]=n.extensions[i])}function im(e,t){void 0!==t.extras&&("object"===typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function rm(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let n=0,i=t.weights.length;n<i;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){const n=t.extras.targetNames;if(e.morphTargetInfluences.length===n.length){e.morphTargetDictionary={};for(let t=0,i=n.length;t<i;t++)e.morphTargetDictionary[n[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function sm(e){let t;const n=e.extensions&&e.extensions[CC.KHR_DRACO_MESH_COMPRESSION];if(t=n?"draco:"+n.bufferView+":"+n.indices+":"+om(n.attributes):e.indices+":"+om(e.attributes)+":"+e.mode,void 0!==e.targets)for(let i=0,r=e.targets.length;i<r;i++)t+=":"+om(e.targets[i]);return t}function om(e){let t="";const n=Object.keys(e).sort();for(let i=0,r=n.length;i<r;i++)t+=n[i]+":"+e[n[i]]+";";return t}function am(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const lm=new rs;class cm{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new pC,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,i=!1,r=-1;"undefined"!==typeof navigator&&(n=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),i=navigator.userAgent.indexOf("Firefox")>-1,r=i?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),"undefined"===typeof createImageBitmap||n||i&&r<98?this.textureLoader=new Ld(this.options.manager):this.textureLoader=new dh(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Nd(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,i=this.json,r=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(t){const s={scene:t[0][i.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:i.asset,parser:n,userData:{}};return nm(r,s,i),im(s,i),Promise.all(n._invokeAll((function(e){return e.afterRoot&&e.afterRoot(s)}))).then((function(){e(s)}))})).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let i=0,r=t.length;i<r;i++){const n=t[i].joints;for(let t=0,i=n.length;t<i;t++)e[n[t]].isBone=!0}for(let i=0,r=e.length;i<r;i++){const t=e[i];void 0!==t.mesh&&(this._addNodeRef(this.meshCache,t.mesh),void 0!==t.skin&&(n[t.mesh].isSkinnedMesh=!0)),void 0!==t.camera&&this._addNodeRef(this.cameraCache,t.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const i=n.clone(),r=(e,t)=>{const n=this.associations.get(e);null!=n&&this.associations.set(t,n);for(const[i,s]of e.children.entries())r(s,t.children[i])};return r(n,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const i=e(t[n]);if(i)return i}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let i=0;i<t.length;i++){const r=e(t[i]);r&&n.push(r)}return n}getDependency(e,t){const n=e+":"+t;let i=this.cache.get(n);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne((function(e){return e.loadNode&&e.loadNode(t)}));break;case"mesh":i=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":i=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne((function(e){return e.loadAnimation&&e.loadAnimation(t)}));break;case"camera":i=this.loadCamera(t);break;default:if(i=this._invokeOne((function(n){return n!=this&&n.getDependency&&n.getDependency(e,t)})),!i)throw new Error("Unknown type: "+e)}this.cache.add(n,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,i=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(i.map((function(t,i){return n.getDependency(e,i)}))),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[CC.KHR_BINARY_GLTF].body);const i=this.options;return new Promise((function(e,r){n.load(oh.resolveURL(t.uri,i.path),e,void 0,(function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){const n=t.byteLength||0,i=t.byteOffset||0;return e.slice(i,i+n)}))}loadAccessor(e){const t=this,n=this.json,i=this.json.accessors[e];if(void 0===i.bufferView&&void 0===i.sparse){const e=OC[i.type],t=PC[i.componentType],n=!0===i.normalized,r=new t(i.count*e);return Promise.resolve(new ro(r,e,n))}const r=[];return void 0!==i.bufferView?r.push(this.getDependency("bufferView",i.bufferView)):r.push(null),void 0!==i.sparse&&(r.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(r).then((function(e){const r=e[0],s=OC[i.type],o=PC[i.componentType],a=o.BYTES_PER_ELEMENT,l=a*s,c=i.byteOffset||0,g=void 0!==i.bufferView?n.bufferViews[i.bufferView].byteStride:void 0,u=!0===i.normalized;let A,d;if(g&&g!==l){const e=Math.floor(c/g),n="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+e+":"+i.count;let l=t.cache.get(n);l||(A=new o(r,e*g,i.count*g/a),l=new Oc(A,g/a),t.cache.add(n,l)),d=new jc(l,s,c%g/a,u)}else A=null===r?new o(i.count*s):new o(r,c,i.count*s),d=new ro(A,s,u);if(void 0!==i.sparse){const t=OC.SCALAR,n=PC[i.sparse.indices.componentType],a=i.sparse.indices.byteOffset||0,l=i.sparse.values.byteOffset||0,c=new n(e[1],a,i.sparse.count*t),g=new o(e[2],l,i.sparse.count*s);null!==r&&(d=new ro(d.array.slice(),d.itemSize,d.normalized));for(let e=0,i=c.length;e<i;e++){const t=c[e];if(d.setX(t,g[e*s]),s>=2&&d.setY(t,g[e*s+1]),s>=3&&d.setZ(t,g[e*s+2]),s>=4&&d.setW(t,g[e*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return d}))}loadTexture(e){const t=this.json,n=this.options,i=t.textures[e].source,r=t.images[i];let s=this.textureLoader;if(r.uri){const e=n.manager.getHandler(r.uri);null!==e&&(s=e)}return this.loadTextureImage(e,i,s)}loadTextureImage(e,t,n){const i=this,r=this.json,s=r.textures[e],o=r.images[t],a=(o.uri||o.bufferView)+":"+s.sampler;if(this.textureCache[a])return this.textureCache[a];const l=this.loadImageSource(t,n).then((function(t){t.flipY=!1,t.name=s.name||o.name||"",""===t.name&&"string"===typeof o.uri&&!1===o.uri.startsWith("data:image/")&&(t.name=o.uri);const n=(r.samplers||{})[s.sampler]||{};return t.magFilter=UC[n.magFilter]||pt,t.minFilter=UC[n.minFilter]||ft,t.wrapS=_C[n.wrapS]||lt,t.wrapT=_C[n.wrapT]||lt,i.associations.set(t,{textures:e}),t})).catch((function(){return null}));return this.textureCache[a]=l,l}loadImageSource(e,t){const n=this,i=this.json,r=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then((e=>e.clone()));const s=i.images[e],o=self.URL||self.webkitURL;let a=s.uri||"",l=!1;if(void 0!==s.bufferView)a=n.getDependency("bufferView",s.bufferView).then((function(e){l=!0;const t=new Blob([e],{type:s.mimeType});return a=o.createObjectURL(t),a}));else if(void 0===s.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const c=Promise.resolve(a).then((function(e){return new Promise((function(n,i){let s=n;!0===t.isImageBitmapLoader&&(s=function(e){const t=new mr(e);t.needsUpdate=!0,n(t)}),t.load(oh.resolveURL(e,r.path),s,void 0,i)}))})).then((function(e){var t;return!0===l&&o.revokeObjectURL(a),e.userData.mimeType=s.mimeType||((t=s.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":"image/png"),e})).catch((function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",a),e}));return this.sourceCache[e]=c,c}assignTexture(e,t,n,i){const r=this;return this.getDependency("texture",n.index).then((function(s){if(!s)return null;if(void 0!==n.texCoord&&n.texCoord>0&&((s=s.clone()).channel=n.texCoord),r.extensions[CC.KHR_TEXTURE_TRANSFORM]){const e=void 0!==n.extensions?n.extensions[CC.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const t=r.associations.get(s);s=r.extensions[CC.KHR_TEXTURE_TRANSFORM].extendTexture(s,e),r.associations.set(s,t)}}return void 0!==i&&(s.colorSpace=i),e[t]=s,s}))}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const i=void 0===t.attributes.tangent,r=void 0!==t.attributes.color,s=void 0===t.attributes.normal;if(e.isPoints){const e="PointsMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new Iu,Os.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,t.sizeAttenuation=!1,this.cache.add(e,t)),n=t}else if(e.isLine){const e="LineBasicMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new ru,Os.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,this.cache.add(e,t)),n=t}if(i||r||s){let e="ClonedMaterial:"+n.uuid+":";i&&(e+="derivative-tangents:"),r&&(e+="vertex-colors:"),s&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=n.clone(),r&&(t.vertexColors=!0),s&&(t.flatShading=!0),i&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(n))),n=t}e.material=n}getMaterialType(){return $A}loadMaterial(e){const t=this,n=this.json,i=this.extensions,r=n.materials[e];let s;const o={},a=[];if((r.extensions||{})[CC.KHR_MATERIALS_UNLIT]){const e=i[CC.KHR_MATERIALS_UNLIT];s=e.getMaterialType(),a.push(e.extendParams(o,r,t))}else{const n=r.pbrMetallicRoughness||{};if(o.color=new Ps(1,1,1),o.opacity=1,Array.isArray(n.baseColorFactor)){const e=n.baseColorFactor;o.color.setRGB(e[0],e[1],e[2],Yn),o.opacity=e[3]}void 0!==n.baseColorTexture&&a.push(t.assignTexture(o,"map",n.baseColorTexture,Xn)),o.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,o.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(a.push(t.assignTexture(o,"metalnessMap",n.metallicRoughnessTexture)),a.push(t.assignTexture(o,"roughnessMap",n.metallicRoughnessTexture))),s=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),a.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,o)}))))}!0===r.doubleSided&&(o.side=le);const l=r.alphaMode||$C;if(l===tm?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,l===em&&(o.alphaTest=void 0!==r.alphaCutoff?r.alphaCutoff:.5)),void 0!==r.normalTexture&&s!==Js&&(a.push(t.assignTexture(o,"normalMap",r.normalTexture)),o.normalScale=new Oi(1,1),void 0!==r.normalTexture.scale)){const e=r.normalTexture.scale;o.normalScale.set(e,e)}if(void 0!==r.occlusionTexture&&s!==Js&&(a.push(t.assignTexture(o,"aoMap",r.occlusionTexture)),void 0!==r.occlusionTexture.strength&&(o.aoMapIntensity=r.occlusionTexture.strength)),void 0!==r.emissiveFactor&&s!==Js){const e=r.emissiveFactor;o.emissive=(new Ps).setRGB(e[0],e[1],e[2],Yn)}return void 0!==r.emissiveTexture&&s!==Js&&a.push(t.assignTexture(o,"emissiveMap",r.emissiveTexture,Xn)),Promise.all(a).then((function(){const n=new s(o);return r.name&&(n.name=r.name),im(n,r),t.associations.set(n,{materials:e}),r.extensions&&nm(i,n,r),n}))}createUniqueName(e){const t=Kh.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,i=this.primitiveCache;function r(e){return n[CC.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return gm(n,e,t)}))}const s=[];for(let o=0,a=e.length;o<a;o++){const n=e[o],a=sm(n),l=i[a];if(l)s.push(l.promise);else{let e;e=n.extensions&&n.extensions[CC.KHR_DRACO_MESH_COMPRESSION]?r(n):gm(new vo,n,t),i[a]={primitive:n,promise:e},s.push(e)}}return Promise.all(s)}loadMesh(e){const t=this,n=this.json,i=this.extensions,r=n.meshes[e],s=r.primitives,o=[];for(let l=0,c=s.length;l<c;l++){const e=void 0===s[l].material?(void 0===(a=this.cache).DefaultMaterial&&(a.DefaultMaterial=new $A({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:oe})),a.DefaultMaterial):this.getDependency("material",s[l].material);o.push(e)}var a;return o.push(t.loadGeometries(s)),Promise.all(o).then((function(n){const o=n.slice(0,n.length-1),a=n[n.length-1],l=[];for(let g=0,u=a.length;g<u;g++){const n=a[g],c=s[g];let u;const A=o[g];if(c.mode===zC.TRIANGLES||c.mode===zC.TRIANGLE_STRIP||c.mode===zC.TRIANGLE_FAN||void 0===c.mode)u=!0===r.isSkinnedMesh?new Eg(n,A):new Qo(n,A),!0===u.isSkinnedMesh&&u.normalizeSkinWeights(),c.mode===zC.TRIANGLE_STRIP?u.geometry=IC(u.geometry,Mn):c.mode===zC.TRIANGLE_FAN&&(u.geometry=IC(u.geometry,Wn));else if(c.mode===zC.LINES)u=new du(n,A);else if(c.mode===zC.LINE_STRIP)u=new gu(n,A);else if(c.mode===zC.LINE_LOOP)u=new hu(n,A);else{if(c.mode!==zC.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+c.mode);u=new yu(n,A)}Object.keys(u.geometry.morphAttributes).length>0&&rm(u,r),u.name=t.createUniqueName(r.name||"mesh_"+e),im(u,r),c.extensions&&nm(i,u,c),t.assignFinalMaterial(u),l.push(u)}for(let i=0,r=l.length;i<r;i++)t.associations.set(l[i],{meshes:e,primitives:i});if(1===l.length)return r.extensions&&nm(i,l[0],r),l[0];const c=new Vc;r.extensions&&nm(i,c,r),t.associations.set(c,{meshes:e});for(let e=0,t=l.length;e<t;e++)c.add(l[e]);return c}))}loadCamera(e){let t;const n=this.json.cameras[e],i=n[n.type];if(i)return"perspective"===n.type?t=new Jo(_i.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===n.type&&(t=new ba(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),im(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n=[];for(let i=0,r=t.joints.length;i<r;i++)n.push(this._loadNodeShallow(t.joints[i]));return void 0!==t.inverseBindMatrices?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then((function(e){const n=e.pop(),i=e,r=[],s=[];for(let o=0,a=i.length;o<a;o++){const e=i[o];if(e){r.push(e);const t=new rs;null!==n&&t.fromArray(n.array,16*o),s.push(t)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[o])}return new Dg(r,s)}))}loadAnimation(e){const t=this.json,n=this,i=t.animations[e],r=i.name?i.name:"animation_"+e,s=[],o=[],a=[],l=[],c=[];for(let g=0,u=i.channels.length;g<u;g++){const e=i.channels[g],t=i.samplers[e.sampler],n=e.target,r=n.node,u=void 0!==i.parameters?i.parameters[t.input]:t.input,A=void 0!==i.parameters?i.parameters[t.output]:t.output;void 0!==n.node&&(s.push(this.getDependency("node",r)),o.push(this.getDependency("accessor",u)),a.push(this.getDependency("accessor",A)),l.push(t),c.push(n))}return Promise.all([Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c)]).then((function(e){const t=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=[];for(let r=0,c=t.length;r<c;r++){const e=t[r],c=i[r],g=s[r],u=o[r],A=a[r];if(void 0===e)continue;e.updateMatrix&&e.updateMatrix();const d=n._createAnimationTracks(e,c,g,u,A);if(d)for(let t=0;t<d.length;t++)l.push(d[t])}return new Gd(r,void 0,l)}))}createNodeMesh(e){const t=this.json,n=this,i=t.nodes[e];return void 0===i.mesh?null:n.getDependency("mesh",i.mesh).then((function(e){const t=n._getNodeRef(n.meshCache,i.mesh,e);return void 0!==i.weights&&t.traverse((function(e){if(e.isMesh)for(let t=0,n=i.weights.length;t<n;t++)e.morphTargetInfluences[t]=i.weights[t]})),t}))}loadNode(e){const t=this,n=this.json.nodes[e],i=t._loadNodeShallow(e),r=[],s=n.children||[];for(let a=0,l=s.length;a<l;a++)r.push(t.getDependency("node",s[a]));const o=void 0===n.skin?Promise.resolve(null):t.getDependency("skin",n.skin);return Promise.all([i,Promise.all(r),o]).then((function(e){const t=e[0],n=e[1],i=e[2];null!==i&&t.traverse((function(e){e.isSkinnedMesh&&e.bind(i,lm)}));for(let r=0,s=n.length;r<s;r++)t.add(n[r]);return t}))}_loadNodeShallow(e){const t=this.json,n=this.extensions,i=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const r=t.nodes[e],s=r.name?i.createUniqueName(r.name):"",o=[],a=i._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)}));return a&&o.push(a),void 0!==r.camera&&o.push(i.getDependency("camera",r.camera).then((function(e){return i._getNodeRef(i.cameraCache,r.camera,e)}))),i._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){o.push(e)})),this.nodeCache[e]=Promise.all(o).then((function(t){let o;if(o=!0===r.isBone?new xg:t.length>1?new Vc:1===t.length?t[0]:new Rs,o!==t[0])for(let e=0,n=t.length;e<n;e++)o.add(t[e]);if(r.name&&(o.userData.name=r.name,o.name=s),im(o,r),r.extensions&&nm(n,o,r),void 0!==r.matrix){const e=new rs;e.fromArray(r.matrix),o.applyMatrix4(e)}else void 0!==r.translation&&o.position.fromArray(r.translation),void 0!==r.rotation&&o.quaternion.fromArray(r.rotation),void 0!==r.scale&&o.scale.fromArray(r.scale);return i.associations.has(o)||i.associations.set(o,{}),i.associations.get(o).nodes=e,o})),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],i=this,r=new Vc;n.name&&(r.name=i.createUniqueName(n.name)),im(r,n),n.extensions&&nm(t,r,n);const s=n.nodes||[],o=[];for(let a=0,l=s.length;a<l;a++)o.push(i.getDependency("node",s[a]));return Promise.all(o).then((function(e){for(let t=0,n=e.length;t<n;t++)r.add(e[t]);return i.associations=(e=>{const t=new Map;for(const[n,r]of i.associations)(n instanceof Os||n instanceof mr)&&t.set(n,r);return e.traverse((e=>{const n=i.associations.get(e);null!=n&&t.set(e,n)})),t})(r),r}))}_createAnimationTracks(e,t,n,i,r){const s=[],o=e.name?e.name:e.uuid,a=[];let l;switch(jC[r.path]===jC.weights?e.traverse((function(e){e.morphTargetInfluences&&a.push(e.name?e.name:e.uuid)})):a.push(o),jC[r.path]){case jC.weights:l=yd;break;case jC.rotation:l=Bd;break;case jC.position:case jC.scale:l=wd;break;default:if(1===n.itemSize)l=yd;else l=wd}const c=void 0!==i.interpolation?qC[i.interpolation]:En,g=this._getArrayFromAccessor(n);for(let u=0,A=a.length;u<A;u++){const e=new l(a[u]+"."+jC[r.path],t.array,g,c);"CUBICSPLINE"===i.interpolation&&this._createCubicSplineTrackInterpolant(e),s.push(e)}return s}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const e=am(t.constructor),n=new Float32Array(t.length);for(let i=0,r=t.length;i<r;i++)n[i]=t[i]*e;t=n}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(e){return new(this instanceof Bd?YC:KC)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function gm(e,t,n){const i=t.attributes,r=[];function s(t,i){return n.getDependency("accessor",t).then((function(t){e.setAttribute(i,t)}))}for(const o in i){const t=JC[o]||o.toLowerCase();t in e.attributes||r.push(s(i[o],t))}if(void 0!==t.indices&&!e.index){const i=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));r.push(i)}return cr.workingColorSpace!==Yn&&"COLOR_0"in i&&console.warn('THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "'.concat(cr.workingColorSpace,'" not supported.')),im(e,t),function(e,t,n){const i=t.attributes,r=new Dr;if(void 0===i.POSITION)return;{const e=n.json.accessors[i.POSITION],t=e.min,s=e.max;if(void 0===t||void 0===s)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new Sr(t[0],t[1],t[2]),new Sr(s[0],s[1],s[2])),e.normalized){const t=am(PC[e.componentType]);r.min.multiplyScalar(t),r.max.multiplyScalar(t)}}const s=t.targets;if(void 0!==s){const e=new Sr,t=new Sr;for(let i=0,r=s.length;i<r;i++){const r=s[i];if(void 0!==r.POSITION){const i=n.json.accessors[r.POSITION],s=i.min,o=i.max;if(void 0!==s&&void 0!==o){if(t.setX(Math.max(Math.abs(s[0]),Math.abs(o[0]))),t.setY(Math.max(Math.abs(s[1]),Math.abs(o[1]))),t.setZ(Math.max(Math.abs(s[2]),Math.abs(o[2]))),i.normalized){const e=am(PC[i.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(e)}e.boundingBox=r;const o=new Or;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,e.boundingSphere=o}(e,t,n),Promise.all(r).then((function(){return void 0!==t.targets?function(e,t,n){let i=!1,r=!1,s=!1;for(let c=0,g=t.length;c<g;c++){const e=t[c];if(void 0!==e.POSITION&&(i=!0),void 0!==e.NORMAL&&(r=!0),void 0!==e.COLOR_0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(e);const o=[],a=[],l=[];for(let c=0,g=t.length;c<g;c++){const g=t[c];if(i){const t=void 0!==g.POSITION?n.getDependency("accessor",g.POSITION):e.attributes.position;o.push(t)}if(r){const t=void 0!==g.NORMAL?n.getDependency("accessor",g.NORMAL):e.attributes.normal;a.push(t)}if(s){const t=void 0!==g.COLOR_0?n.getDependency("accessor",g.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then((function(t){const n=t[0],o=t[1],a=t[2];return i&&(e.morphAttributes.position=n),r&&(e.morphAttributes.normal=o),s&&(e.morphAttributes.color=a),e.morphTargetsRelative=!0,e}))}(e,t.targets,n):e}))}function um(e,t,n,i,r){const s=i.getReferenceSpace();if(null==s||null==t||"visible-blurred"===t.session.visibilityState||"hidden"===t.session.visibilityState)return;const o=function(e,t,n,i){const r=e.fillPoses(n.values(),t,i);if(!r)return!1;Am.fromArray(i,0),Am.invert();for(let s=0;s<i.length;s+=16)dm.fromArray(i,s),dm.premultiply(Am),dm.toArray(i,s);return!0}(t,s,n,e.data);if(!o)return}const Am=new rs,dm=new rs;new rs,new rs,new xr,new xr;new Map;function hm(e){const t=new Map,n=new Map,i=e.clone();return Im(e,i,(function(e,i){t.set(i,e),n.set(e,i)})),i.traverse((function(e){if(!e.isSkinnedMesh)return;const i=e,r=t.get(e),s=r.skeleton.bones;i.skeleton=r.skeleton.clone(),i.bindMatrix.copy(r.bindMatrix),i.skeleton.bones=s.map((function(e){return n.get(e)})),i.bind(i.skeleton,i.bindMatrix)})),i}function Im(e,t,n){n(e,t);for(let i=0;i<e.children.length;i++)Im(e.children[i],t.children[i],n)}const pm="generic-hand";function Cm(e,t){var n,i;const r=null!==(n=null===t||void 0===t?void 0:t.baseAssetPath)&&void 0!==n?n:my,s=null!==(i=null===t||void 0===t?void 0:t.defaultXRHandProfileId)&&void 0!==i?i:pm;return new URL("".concat(s,"/").concat(e,".glb"),r).href}async function mm(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Cy;const{scene:n}=await t.loadAsync(e),i=hm(n),r=n.getObjectByProperty("type","SkinnedMesh");if(null==r)throw new Error("missing SkinnedMesh in loaded XRHand model");return r.frustumCulled=!1,i}function fm(e,t){var n;e.renderOrder=null!==(n=null===t||void 0===t?void 0:t.renderOrder)&&void 0!==n?n:0,e.traverse((e=>{var n;e instanceof Qo&&e.material instanceof Os&&(e.material.colorWrite=null===(n=null===t||void 0===t?void 0:t.colorWrite)||void 0===n||n)}))}function ym(e,t){return{type:"hand",inputSource:e,pose:(n=e.hand,{data:new Float32Array(16*n.size)}),assetPath:Cm(e.handedness,t)};var n}function bm(e,t,n){let{inputSource:i,pose:r}=e;um(r,t,i.hand,n,i.handedness)}const Bm=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"];function vm(e,t,n){const i=new Float32Array(16*e.size),r=Bm.map((e=>{const n=t.getObjectByName(e);if(null==n)throw new Error('missing joint "'.concat(e,'" in hand model'));return n.matrixAutoUpdate=!1,n}));return t=>{if(null==t)return;const s="function"===typeof n?n():n;if(null==s)return;t.fillPoses(e.values(),s,i);const o=r.length;for(let e=0;e<o;e++)r[e].matrix.fromArray(i,16*e)}}function wm(e){if(null!=e.hand)return"hand";switch(e.targetRayMode){case"gaze":return"gaze";case"screen":return"screenInput";case"tracked-pointer":return"controller";case"transient-pointer":return"transientPointer"}}function Gm(e,t){let n=new Set;const i=function(e){const t=new fy(e);return{controller:async(e,n)=>({state:await wy(n,t)}),hand:(t,n)=>({state:ym(n,e)}),gaze:(e,t)=>({state:{type:"gaze",inputSource:t}}),screenInput:(e,t)=>({state:{type:"screenInput",inputSource:t}}),transientPointer:(e,t)=>function(e,t){const n=[],i=e=>n.push(e);return t.addEventListener("selectstart",i),t.addEventListener("selectend",i),t.addEventListener("select",i),t.addEventListener("squeeze",i),t.addEventListener("squeezestart",i),t.addEventListener("squeezeend",i),{cleanup(){t.removeEventListener("selectstart",i),t.removeEventListener("selectend",i),t.removeEventListener("select",i),t.removeEventListener("squeeze",i),t.removeEventListener("squeezestart",i),t.removeEventListener("squeezeend",i)},state:{type:"transientPointer",inputSource:e,events:n}}}(t,e)}}(t),r=new Map;return(t,s,o,a)=>{n=new Set(t.inputSources);const l={};if("all"===a){l.controllerStates=[],l.gazeStates=[],l.handStates=[],l.screenInputStates=[],l.transientPointerStates=[];for(const e of r.values())e()}else if(null!=a){const e=a.length;for(let t=0;t<e;t++){var c;const e=a[t],n=wm(e),i=Em("".concat(n,"States"),l,s),o=i.findIndex((t=>{let{inputSource:n}=t;return n===e}));if(-1===o)throw new Error("unable to find removed input source ".concat(e));i.splice(o,1),null===(c=r.get(e))||void 0===c||c(),r.delete(e)}}return null!=o&&o.forEach((async o=>{const a=wm(o);let c,g=i[a](t,o);if(g instanceof Promise){if(c=await g,!n.has(o))return;e[a](c.state)}else c=g,Em("".concat(a,"States"),l,s).push(c.state);null!=c.cleanup&&r.set(o,c.cleanup)})),l}}function Em(e,t,n){let i=t[e];return null==i&&(t[e]=i=null==n?[]:[...n[e]]),i}class xm extends Js{constructor(){super({transparent:!0,toneMapped:!1,depthWrite:!1})}onBeforeCompile(e,t){super.onBeforeCompile(e,t),e.vertexShader="varying vec2 vLocalPosition;\n"+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <color_vertex>","#include <color_vertex>\n        vLocalPosition = position.xy * 2.0;"),e.fragmentShader="varying vec2 vLocalPosition;\n"+e.fragmentShader,e.fragmentShader=e.fragmentShader.replace("#include <color_fragment>","#include <color_fragment>\n          float value = max(0.0, 1.0 - sqrt(dot(vLocalPosition, vLocalPosition)));\n          diffuseColor.a = diffuseColor.a * value * value;")}}const Sm=new Sr(0,0,1),Rm=new xr,Zm=new Sr;function Dm(e,t,n,i){var r,s;const o=n.getIntersection();if(null==o||!n.getEnabled())return void(e.visible=!1);e.visible=!0;const a="function"===typeof i.color?i.color(n):i.color;var l;(Array.isArray(a)?t.color.set(...a):t.color.set(null!==a&&void 0!==a?a:"white"),t.opacity="function"===typeof i.opacity?i.opacity(n):null!==(r=i.opacity)&&void 0!==r?r:.4,e.position.copy(o.pointOnFace),e.scale.setScalar(null!==(s=i.size)&&void 0!==s?s:.1),null!=o.normal)&&(Rm.setFromUnitVectors(Sm,o.normal),o.object.getWorldQuaternion(e.quaternion),e.quaternion.multiply(Rm),Zm.set(0,0,null!==(l=i.cursorOffset)&&void 0!==l?l:.01),Zm.applyQuaternion(e.quaternion),e.position.add(Zm));e.updateMatrix()}class Fm extends Js{constructor(){super({transparent:!0,toneMapped:!1})}onBeforeCompile(e,t){super.onBeforeCompile(e,t),e.vertexShader="varying float vFade;\n"+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <color_vertex>","#include <color_vertex>\n            vFade = position.z + 0.5;"),e.fragmentShader="varying float vFade;\n"+e.fragmentShader,e.fragmentShader=e.fragmentShader.replace("#include <color_fragment>","#include <color_fragment>\n              diffuseColor.a *= vFade;")}}function Nm(e,t,n,i){var r,s,o;if(!n.getEnabled())return void(e.visible=!1);e.visible=!0;const a=n.getIntersection(),l="function"===typeof i.color?i.color(n):i.color;Array.isArray(l)?t.color.set(...l):t.color.set(null!==l&&void 0!==l?l:"white"),t.opacity="function"===typeof i.opacity?i.opacity(n):null!==(r=i.opacity)&&void 0!==r?r:.4;let c=null!==(s=i.maxLength)&&void 0!==s?s:1;null!=a&&(c=Math.min(c,a.distance)),e.position.z=-c/2;const g=null!==(o=i.size)&&void 0!==o?o:.005;e.scale.set(g,g,c),e.updateMatrix()}function Mm(e){var t,n;return e.getButtonsDown().size>0?.6:Tm(null!==(t=null===(n=e.getIntersection())||void 0===n?void 0:n.distance)&&void 0!==t?t:1/0,.07,0,.2,.4)}function Wm(e){return e.getButtonsDown().size>0?.6:.4}function km(e){var t,n;return Tm(null!==(t=null===(n=e.getIntersection())||void 0===n?void 0:n.distance)&&void 0!==t?t:1/0,.1,.03,.2,.6)}function Tm(e,t,n,i,r){return i+Math.max(0,Math.min(1,(e-t)/(n-t)))*(r-i)}function Vm(e,t){return(n,i)=>{const r=Lm(t),s=Lm(e);if(s===r)return n.identity(),!0;if(null==i||null==s||null==r)return!1;const o=i.getPose(s,r);return null!=o&&(n.fromArray(o.transform.matrix),!0)}}function Lm(e){return"function"===typeof e?e():e}function Hm(e,t,n,i){!1!==e&&(!0!==e?n.push(t):i.push(t))}function Qm(e,t,n){var i;return"function"===typeof e?e:("object"===typeof e&&(null!=t&&function(e,t){return t in e}(e,t)?e=e[t]:"default"in e&&(e=e.default)),!1!==e&&(!0===e?n:null!==(i=e)&&void 0!==i?i:n))}function Km(e,t,n){var i,r,s;return null!==(i=e)&&void 0!==i||(e=n),!1!==e&&("function"===typeof e?e:null!=t&&t in e?null!==(r=e[t])&&void 0!==r?r:n:"default"in e?null!==(s=e.default)&&void 0!==s?s:n:e)}const Xm={handStates:[],controllerStates:[],transientPointerStates:[],gazeStates:[],screenInputStates:[],detectedMeshes:[],detectedPlanes:[],mode:null};function Ym(e){const t=s((()=>({...Xm,controller:null===e||void 0===e?void 0:e.controller,hand:null===e||void 0===e?void 0:e.hand,gaze:null===e||void 0===e?void 0:e.gaze,screenInput:null===e||void 0===e?void 0:e.screenInput,transientPointer:null===e||void 0===e?void 0:e.transientPointer,detectedMesh:null===e||void 0===e?void 0:e.detectedMesh,detectedPlane:null===e||void 0===e?void 0:e.detectedPlane}))),n=Gm({controller:e=>t.setState({controllerStates:[...t.getState().controllerStates,e]})},e),i=function(e,t){let n;return(i,r)=>{var s;if(null===(s=n)||void 0===s||s(),null==i||null==r)return;const o=n=>e.setState(t(n.session,e.getState(),n.added,n.removed));i.addEventListener("inputsourceschange",o);const a=()=>e.setState({frameRate:i.frameRate,visibilityState:i.visibilityState}),l=()=>{var t;null===(t=n)||void 0===t||t(),n=void 0,e.setState(Xm)};i.addEventListener("end",l),i.addEventListener("frameratechange",a),i.addEventListener("visibilitychange",a),e.setState({...t(i,void 0,i.inputSources,void 0),frameRate:i.frameRate,visibilityState:i.visibilityState,detectedMeshes:[],detectedPlanes:[],mode:r,session:i}),n=()=>{t(i,e.getState(),void 0,"all"),i.removeEventListener("end",l),i.removeEventListener("frameratechange",a),i.removeEventListener("visibilitychange",a),i.removeEventListener("inputsourceschange",o)}}}(t,n),r=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_m,n=arguments.length>1?arguments[1]:void 0;if(!1===t)return;!0===t&&(t=_m);const i=async()=>{for(const i of t){var e;await(null===(e=navigator.xr)||void 0===e?void 0:e.isSessionSupported(i))&&n(i)}};return null===(e=navigator.xr)||void 0===e||e.addEventListener("sessiongranted",i),()=>{var e;return null===(e=navigator.xr)||void 0===e?void 0:e.removeEventListener("sessiongranted",i)}}(null===e||void 0===e?void 0:e.enterGrantedSession,(t=>Pm(t,e,void 0,a)));let o,a;return Object.assign(t,{setWebXRManager(n){var r;if(a===n)return;a=n;const{referenceSpaceType:s="local-floor",foveation:l}=null!==e&&void 0!==e?e:{};a.setReferenceSpaceType(s),null!=l&&a.setFoveation(l);const{session:c}=t.getState();null!=c&&Um(a,c,e),null===(r=o)||void 0===r||r(),o=function(e,t){const n=()=>{const n=e.getSession();t(n,"opaque"===n.environmentBlendMode?"immersive-vr":"immersive-ar")};return e.addEventListener("sessionstart",n),()=>e.removeEventListener("sessionstart",n)}(n,i)},setFrameRate(e){const{session:n}=t.getState();null!=n&&zm(n,e)},setHand(e,n){if(null==n)return void t.setState({hand:e});const i=t.getState().hand,r={};"object"===typeof i&&Object.assign(r,i),Object.assign(r,{default:Qm(i,void 0,{}),[n]:e}),t.setState({hand:r})},setController(e,n){if(null==n)return void t.setState({controller:e});const i=t.getState().controller,r={};"object"===typeof i&&Object.assign(r,i),Object.assign(r,{default:Qm(i,void 0,{}),[n]:e}),t.setState({controller:r})},setTransientPointer(e,n){if(null==n)return void t.setState({transientPointer:e});const i=t.getState().transientPointer,r={};"object"===typeof i&&Object.assign(r,i),Object.assign(r,{default:Qm(i,void 0,{}),[n]:e}),t.setState({transientPointer:r})},setGaze(e){t.setState({gaze:e})},setScreenInput(e){t.setState({screenInput:e})},setDetectedPlane(e,n){if(null==n)return void t.setState({detectedPlane:e});const i=t.getState().detectedPlane,r={};"object"===typeof i&&Object.assign(r,i),Object.assign(r,{default:Qm(i,void 0,{}),[n]:e}),t.setState({detectedPlane:r})},setDetectedMesh(e,n){if(null==n)return void t.setState({detectedMesh:e});const i=t.getState().detectedMesh,r={};"object"===typeof i&&Object.assign(r,i),Object.assign(r,{default:Qm(i,void 0,{}),[n]:e}),t.setState({detectedMesh:r})},destroy(){var e;null===(e=o)||void 0===e||e(),null===r||void 0===r||r(),i(void 0,void 0)},enterXR:(t,n)=>Pm(t,e,n,a),enterAR:t=>Pm("immersive-ar",e,t,a),enterVR:t=>Pm("immersive-vr",e,t,a),onBeforeFrame(e,n,i){var r;const{origin:s}=t.getState(),o=null!==(r=n.parent)&&void 0!==r?r:e;s!=o&&t.setState({origin:o}),null!=a&&function(e,t,n){const i=n.getReferenceSpace(),{detectedMeshes:r,detectedPlanes:s,session:o,controllerStates:a,handStates:l}=e.getState();if(null==t||null==i||null==o)return;const c=Jm(s,t.detectedPlanes),g=Jm(r,t.detectedMeshes);s==c&&r==g||e.setState({detectedPlanes:c,detectedMeshes:g});const u=a.length;for(let d=0;d<u;d++)Gy(a[d]);const A=l.length;for(let d=0;d<A;d++)bm(l[d],t,n)}(t,i,a)}})}async function zm(e,t){if(!1===t)return;const{supportedFrameRates:n}=e;if(null==n||0===n.length)return;if("function"===typeof t){const i=t(n);if(!1===i)return;return e.updateTargetFrameRate(i)}const i="high"===t?1:"mid"===t?.5:0;return e.updateTargetFrameRate(n[Math.ceil((n.length-1)*i)])}async function Pm(e,t,n,i){var r;if(null==navigator.xr)throw new Error("xr not supported");const s=await navigator.xr.requestSession(e,function(){let{anchors:e=!0,handTracking:t=!0,layers:n=!0,meshDetection:i=!0,planeDetection:r=!0,referenceSpaceType:s="local-floor",customSessionInit:o,depthSensing:a=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(null!=o)return o;const l=[s],c=[];return Hm(e,"anchors",l,c),Hm(t,"hand-tracking",l,c),Hm(n,"layers",l,c),Hm(i,"mesh-detection",l,c),Hm(r,"plane-detection",l,c),Hm(a,"depth-sensing",l,c),{requiredFeatures:l,optionalFeatures:c}}(Object.assign({},t,n)));return zm(s,null!==(r=null===t||void 0===t?void 0:t.frameRate)&&void 0!==r?r:"high"),Um(i,s,t),s}function Um(e,t,n){if(null==e)return;const i=XRWebGLLayer.getNativeFramebufferScaleFactor(t);let r=null===n||void 0===n?void 0:n.frameBufferScaling;"function"===typeof r&&(r=r(i)),"string"===typeof r&&(r="high"===r?i:"mid"===r?1:.5),null!=r&&(null===e||void 0===e||e.setFramebufferScaleFactor(r)),null===e||void 0===e||e.setSession(t)}const _m=["immersive-ar","immersive-vr","inline"];const Om=[];function Jm(e,t){return null==t?Om:null!=e&&function(e,t){if(e.size!=t.length)return!1;for(const n of t)if(!e.has(n))return!1;return!0}(t,e)?e:Array.from(t)}new Xo;new ga;async function jm(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Cy;const{scene:n}=await t.loadAsync(e.assetPath);return n.clone(!0)}function qm(e,t){var n;e.renderOrder=null!==(n=null===t||void 0===t?void 0:t.renderOrder)&&void 0!==n?n:0,e.traverse((e=>{var n;e instanceof Qo&&e.material instanceof Os&&(e.material.colorWrite=null===(n=null===t||void 0===t?void 0:t.colorWrite)||void 0===n||n)}))}function $m(e,t,n){const i=[];for(const r in t.components){const s=t.components[r];let o=n[r];null==o&&(n[r]=o={state:"default"}),i.push(...Object.values(s.visualResponses).map((t=>ef(e,o,t))))}return()=>{const e=i.length;for(let t=0;t<e;t++)i[t]()}}function ef(e,t,n){const i=e.getObjectByName(n.valueNodeName);if(t.object=i,null==i)return()=>{};if("visibility"===n.valueNodeProperty)return()=>i.visible=n.states.includes(t.state);const r=e.getObjectByName(n.minNodeName),s=e.getObjectByName(n.maxNodeName);return null==r||null==s?()=>{}:()=>{const e=function(e,t){var n;let{componentProperty:i,states:r}=t;const s=r.includes(e.state);switch(i){case"xAxis":return s?nf(e).x:.5;case"yAxis":return s?nf(e).y:.5;case"button":return s&&null!==(n=e.button)&&void 0!==n?n:0;case"state":return s?1:0}}(t,n);i.quaternion.slerpQuaternions(r.quaternion,s.quaternion,e),i.position.lerpVectors(r.position,s.position,e),i.updateMatrix()}}const tf=new Oi;function nf(e){let{xAxis:t=0,yAxis:n=0}=e;if(tf.lengthSq()>1){const e=Math.atan2(n,t);tf.set(Math.cos(e),Math.sin(e))}else tf.set(t,n);return tf.multiplyScalar(.5).addScalar(.5),tf}const rf={click:"onClick",contextmenu:"onContextMenu",dblclick:"onDoubleClick",pointercancel:"onPointerCancel",pointerdown:"onPointerDown",pointerenter:"onPointerEnter",pointerleave:"onPointerLeave",pointermove:"onPointerMove",pointerout:"onPointerOut",pointerover:"onPointerOver",pointerup:"onPointerUp",wheel:"onWheel"};class sf{get pointerId(){return this.pointer.id}get pointerType(){return this.pointer.type}get pointerState(){return this.pointer.state}get timeStamp(){return this.nativeEvent.timeStamp}get button(){return this.nativeEvent.button}get shiftKey(){var e;return null!==(e=this.nativeEvent.shiftKey)&&void 0!==e&&e}get metaKey(){var e;return null!==(e=this.nativeEvent.metaKey)&&void 0!==e&&e}get ctrlKey(){var e;return null!==(e=this.nativeEvent.ctrlKey)&&void 0!==e&&e}get altKey(){var e;return null!==(e=this.nativeEvent.altKey)&&void 0!==e&&e}get distance(){return this.intersection.distance}get distanceToRay(){return this.intersection.distanceToRay}get point(){return this.intersection.point}get index(){return this.intersection.index}get face(){return this.intersection.face}get faceIndex(){return this.intersection.faceIndex}get uv(){return this.intersection.uv}get uv1(){return this.intersection.uv1}get normal(){return this.intersection.normal}get instanceId(){return this.intersection.instanceId}get pointOnLine(){return this.intersection.pointOnLine}get batchId(){return this.intersection.batchId}get pointerPosition(){return this.intersection.pointerPosition}get pointerQuaternion(){return this.intersection.pointerQuaternion}get pointOnFace(){return this.intersection.pointOnFace}get localPoint(){return this.intersection.localPoint}get details(){return this.intersection.details}get target(){return this.object}get currentTarget(){return this.currentObject}constructor(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:r.object,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:s;hC(this,"type",void 0),hC(this,"bubbles",void 0),hC(this,"nativeEvent",void 0),hC(this,"pointer",void 0),hC(this,"intersection",void 0),hC(this,"currentObject",void 0),hC(this,"object",void 0),hC(this,"stopPropagation",void 0),hC(this,"stopImmediatePropagation",void 0),this.type=e,this.bubbles=t,this.nativeEvent=n,this.pointer=i,this.intersection=r,this.currentObject=s,this.object=o}retarget(e){const{type:t,bubbles:n,nativeEvent:i,pointer:r,intersection:s,target:o}=this;return new sf(t,n,i,r,s,e,o)}}class of extends sf{get deltaX(){return this.nativeEvent.deltaX}get deltaY(){return this.nativeEvent.deltaY}get deltaZ(){return this.nativeEvent.deltaZ}constructor(e,t,n){super("wheel",!0,e,t,n)}}function af(e){lf(e,e.currentObject)}function lf(e,t){if(null==t)return;const n=function(e,t){let{_listeners:n,__r3f:i}=e;if(null!=n&&t in n)return n[t];if(null==i)return;const r=i.handlers[rf[t]];return null!=r?[r]:void 0}(t,e.type);let i=!e.bubbles;if(null!=n&&n.length>0){const r=e.retarget(t),s=n.length;r.stopPropagation=()=>i=!0;let o=!1;r.stopImmediatePropagation=()=>{i=!0,o=!0};for(let e=0;e<s&&!o;e++)n[e](r)}i||lf(e,t.parent)}const cf=Symbol("buttonsDownTime"),gf=Symbol("buttonsClickTime"),uf=new Map;function Af(e){return uf.get(e)}Rs.prototype.setPointerCapture=function(e){var t;null===(t=Af(e))||void 0===t||t.setCapture(this)},Rs.prototype.releasePointerCapture=function(e){const t=Af(e);null!=t&&t.hasCaptured(this)&&t.setCapture(void 0)},Rs.prototype.hasPointerCapture=function(e){var t,n;return null!==(t=null===(n=Af(e))||void 0===n?void 0:n.hasCaptured(this))&&void 0!==t&&t};class df{constructor(e,t,n,i,r,s,o){let a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{};hC(this,"id",void 0),hC(this,"type",void 0),hC(this,"state",void 0),hC(this,"computeIntersection",void 0),hC(this,"onMoveCommited",void 0),hC(this,"parentSetPointerCapture",void 0),hC(this,"parentReleasePointerCapture",void 0),hC(this,"options",void 0),hC(this,"prevIntersection",void 0),hC(this,"intersection",void 0),hC(this,"prevEnabled",!0),hC(this,"enabled",!0),hC(this,"pointerEntered",[]),hC(this,"pointerEnteredHelper",[]),hC(this,"pointerCapture",void 0),hC(this,"buttonsDownTime",new Map),hC(this,"buttonsDown",new Set),hC(this,"wasMoved",!1),hC(this,"onFirstMove",[]),this.id=e,this.type=t,this.state=n,this.computeIntersection=i,this.onMoveCommited=r,this.parentSetPointerCapture=s,this.parentReleasePointerCapture=o,this.options=a,uf.set(e,this)}hasCaptured(e){var t;return(null===(t=this.pointerCapture)||void 0===t?void 0:t.object)===e}setCapture(e){var t;if((null===(t=this.pointerCapture)||void 0===t?void 0:t.object)!==e){var n,i;if(null!=this.pointerCapture)null===(n=this.parentReleasePointerCapture)||void 0===n||n.call(this),this.pointerCapture=void 0;if(null!=e&&null!=this.intersection)this.pointerCapture={object:e,intersection:this.intersection},null===(i=this.parentSetPointerCapture)||void 0===i||i.call(this)}}getButtonsDown(){return this.buttonsDown}getIntersection(){return this.intersection}getEnabled(){return this.enabled}setEnabled(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.enabled!==e){var i;if(!e&&null!=this.pointerCapture)null===(i=this.parentReleasePointerCapture)||void 0===i||i.call(this),this.pointerCapture=void 0;this.enabled=e,n&&this.commit(t)}}computeMove(e,t){this.intersection=this.computeIntersection(e,t,this.pointerCapture)}commit(e){var t;const n=this.prevEnabled?this.prevIntersection:void 0,i=this.enabled?this.intersection:void 0;null!=n&&n.object!=(null===i||void 0===i?void 0:i.object)&&af(new sf("pointerout",!0,e,this,n));const r=this.pointerEntered;this.pointerEntered=[],this.pointerEnteredHelper.length=0,hf(null===i||void 0===i?void 0:i.object,this.pointerEntered,r,this.pointerEnteredHelper);const s=r.length;for(let o=0;o<s;o++){const t=r[o];af(new sf("pointerleave",!1,e,this,n,t))}null!=i&&(null===n||void 0===n?void 0:n.object)!=i.object&&af(new sf("pointerover",!0,e,this,i));for(let o=this.pointerEnteredHelper.length-1;o>=0;o--){const t=this.pointerEnteredHelper[o];af(new sf("pointerenter",!1,e,this,i,t))}if(null!=i&&af(new sf("pointermove",!0,e,this,i)),this.prevIntersection=this.intersection,this.prevEnabled=this.enabled,!this.wasMoved){this.wasMoved=!0;const e=this.onFirstMove.length;for(let t=0;t<e;t++)this.onFirstMove[t]();this.onFirstMove.length=0}null===(t=this.onMoveCommited)||void 0===t||t.call(this,this)}move(e,t){this.computeMove(e,t),this.commit(t)}down(e){var t;if(this.buttonsDown.add(e.button),!this.enabled)return;if(!this.wasMoved)return void this.onFirstMove.push(this.down.bind(this,e));if(null==this.intersection)return;af(new sf("pointerdown",!0,e,this,this.intersection));const{object:n}=this.intersection;null!==(t=n[cf])&&void 0!==t||(n[cf]=new Map),n[cf].set(e.button,e.timeStamp),this.buttonsDownTime.set(e.button,e.timeStamp)}up(e){var t;if(this.buttonsDown.delete(e.button),!this.enabled)return;if(!this.wasMoved)return void this.onFirstMove.push(this.up.bind(this,e));if(null==this.intersection)return;const{contextMenuButton:n=2,dblClickThresholdMs:i=500,clickThesholdMs:r=300}=this.options;this.pointerCapture=void 0;const s=function(e,t,n,i,r){if(null==t)return!1;const s=t.get(n);if(null==s)return!1;if(i-s>r)return!1;if(s!=e.get(n))return!1;return!0}(this.buttonsDownTime,this.intersection.object[cf],e.button,e.timeStamp,r);if(s&&e.button===n&&af(new sf("contextmenu",!0,e,this,this.intersection)),af(new sf("pointerup",!0,e,this,this.intersection)),!s||e.button===n)return;af(new sf("click",!0,e,this,this.intersection));const{object:o}=this.intersection,a=null!==(t=o[gf])&&void 0!==t?t:o[gf]=new Map,l=a.get(e.button);null==l||e.timeStamp-l>i?a.set(e.button,e.timeStamp):(af(new sf("dblclick",!0,e,this,this.intersection)),a.delete(e.button))}cancel(e){this.enabled&&(this.wasMoved?null!=this.intersection&&af(new sf("pointercancel",!0,e,this,this.intersection)):this.onFirstMove.push(this.cancel.bind(this,e)))}wheel(e,t,n){if(!this.enabled)return;let i=this.intersection;n||(i=this.computeIntersection(e,t,this.pointerCapture)),this.wasMoved||!n?null!=i&&af(new of(t,this,i)):this.onFirstMove.push(this.cancel.bind(this,t))}exit(e){if(this.wasMoved){var t;if(null!=this.pointerCapture)null===(t=this.parentReleasePointerCapture)||void 0===t||t.call(this),this.pointerCapture=void 0;this.intersection=void 0,this.commit(e)}else this.onFirstMove.push(this.exit.bind(this,e))}}function hf(e,t,n,i){if(null==e)return;const r=n.indexOf(e);-1!=r?n.splice(r,1):i.push(e),t.push(e),hf(e.parent,t,n,i)}function If(e,t,n){return null!=t.face&&(e.setFromNormalAndCoplanarPoint(t.face.normal,t.localPoint),e.applyMatrix4(n.matrixWorld),!0)}function pf(e,t,n,i,r){var s,o,a,l;let c=arguments.length>6?arguments[6]:void 0,g=arguments.length>7?arguments[7]:void 0;const u=arguments.length>5&&void 0!==arguments[5]&&arguments[5]||function(e){let{_listeners:t,__r3f:n}=e;return null!=t&&Object.keys(t).length>0||null!=n&&(null===n||void 0===n?void 0:n.eventCount)>0}(e),A=null!==(s=null!==(o=e.pointerEvents)&&void 0!==o?o:c)&&void 0!==s?s:"listener",d=null!==(a=null!==(l=e.pointerEventsType)&&void 0!==l?l:g)&&void 0!==a?a:"all",h=function(e,t,n,i,r,s){if("none"===t)return!1;if("listener"===t&&!e)return!1;if("all"===n)return!0;if("function"===typeof n)return n(i,r,s);let o,a,l;return"deny"in n?(a=!0,o=n.deny):(a=!1,o=n.allow),l=Array.isArray(o)?o.includes(r):o===r,a?!l:l}(u,A,d,t,n,i);h&&r(e);const I=e.children.length;for(let p=0;p<I;p++)pf(e.children[p],t,n,i,r,u,A,d)}function Cf(e,t){let{customFilter:n,customSort:i=mf}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=t.length;for(let o=0;o<r;o++){var s;const r=t[o];(null===(s=null===n||void 0===n?void 0:n(r))||void 0===s||s)&&((null==e||i(e,r)>0)&&(e=r))}return e}function mf(e,t){const{pointerEventsOrder:n=0}=e.object,{pointerEventsOrder:i=0}=t.object;return n!=i?i-n:e.distance-t.distance}const ff=new qh,yf=new rs,bf=[];function Bf(e,t,n,i,r,s,o,a){if(null!=o)return function(e,t,n){var i;let{intersection:r,object:s}=n;const o=r.details;if("lines"!=o.type)return;vf.set(t[o.lineIndex],t[o.lineIndex+1]).applyMatrix4(e);const a=vf.at(o.distanceOnLine/vf.distance(),new Sr);If(wf,r,s);const l=null!==(i=function(e,t,n){for(let i=t.length-1;i>0;i--){const r=t[i-1],s=t[i];Ef.origin.copy(r).applyMatrix4(e),Ef.direction.copy(s).applyMatrix4(e).sub(ff.ray.origin).normalize();if(null!=Ef.intersectPlane(n,Gf))return Gf.clone()}return}(e,t,wf))&&void 0!==i?i:a;return{...r,pointOnFace:l,point:a,pointerPosition:(new Sr).setFromMatrixPosition(e),pointerQuaternion:(new xr).setFromRotationMatrix(e)}}(e,t,o);let l;return pf(n,i,r,s,(n=>{var i,r;let s=0;const o=(null!==(i=null===(r=l)||void 0===r?void 0:r.details.lineIndex)&&void 0!==i?i:t.length-2)+2;for(let c=1;c<o;c++){const i=t[c-1],r=t[c];ff.ray.origin.copy(i).applyMatrix4(e),ff.ray.direction.copy(r).applyMatrix4(e),ff.ray.direction.sub(ff.ray.origin);const o=ff.ray.direction.length();ff.ray.direction.divideScalar(o),ff.far=o,n.raycast(ff,bf);const g=bf.length;for(let e=0;e<g;e++){const t=bf[e],n=t.distance;t.distance+=s,Object.assign(t,{details:{lineIndex:c-1,distanceOnLine:n}})}l=Cf(l,bf,a),bf.length=0,s+=o}})),null!=l?Object.assign(l,{details:{...l.details,type:"lines"},pointerPosition:(new Sr).setFromMatrixPosition(e),pointerQuaternion:(new xr).setFromRotationMatrix(e),pointOnFace:l.point,localPoint:l.point.clone().applyMatrix4(yf.copy(l.object.matrixWorld).invert())}):void 0}const vf=new aI,wf=new ra;const Gf=new Sr,Ef=new is;const xf=new qh,Sf=new Sr,Rf=new ra,Zf=new rs,Df=[];function Ff(e,t,n,i,r,s,o,a,l){if(null!=a)return function(e,t,n,i){var r;let{intersection:s,object:o}=i;if("ray"!=s.details.type)return;Sf.copy(n).applyQuaternion(t),Nf.set(e,Sf),If(Rf,s,o);const a=null!==(r=Nf.intersectPlane(Rf,new Sr))&&void 0!==r?r:s.point;return{...s,object:o,pointOnFace:a,point:Sf.clone().multiplyScalar(s.distance).add(e),pointerPosition:e.clone(),pointerQuaternion:t.clone()}}(e,t,n,a);let c;return xf.ray.origin.copy(e),xf.ray.direction.copy(n).applyQuaternion(t),pf(i,r,s,o,(e=>{e.raycast(xf,Df),c=Cf(c,Df,l),Df.length=0})),null!=c?Object.assign(c,{details:{type:"ray"},pointerPosition:e.clone(),pointerQuaternion:t.clone(),pointOnFace:c.point,localPoint:c.point.clone().applyMatrix4(Zf.copy(c.object.matrixWorld).invert())}):void 0}const Nf=new is;const Mf=new Or,Wf=[];function kf(e,t,n,i,r,s,o,a,l){if(null!=a)return function(e,t,n){let{intersection:i,object:r}=n;if("sphere"!=i.details.type)return;Vf.copy(i.point).sub(i.pointerPosition),Lf.copy(i.pointerQuaternion).invert().multiply(t);const s=Vf.clone().applyQuaternion(Lf).add(e);If(Hf,i,r);const o=Hf.projectPoint(e,new Sr);return{details:{type:"sphere"},distance:i.distance,pointerPosition:e.clone(),pointerQuaternion:t.clone(),object:r,point:s,pointOnFace:o,face:i.face,localPoint:i.localPoint}}(e,t,a);let c;return Mf.center.copy(e),Mf.radius=n,pf(i,r,s,o,(e=>{!function(e,t,n){if(t.updateWorldMatrix(!0,!1),function(e){return"spherecast"in e}(t))return void t.spherecast(e,n);if(t instanceof Hg){null==t.geometry.boundingSphere&&t.geometry.computeBoundingSphere(),null==t.geometry.boundingBox&&t.geometry.computeBoundingBox();for(let i=0;i<t.count;i++){if(t.getMatrixAt(i,Tf),Tf.premultiply(t.matrixWorld),!Kf(e,t,Tf))continue;const r=_f(e,t,Tf,i);null!=r&&n.push(r)}}if(!(t instanceof Qo))return;if(!Kf(e,t,t.matrixWorld))return;Uf.copy(t.matrixWorld).invert();const i=_f(e,t,t.matrixWorld);if(null==i)return;n.push(i)}(Mf,e,Wf),c=Cf(c,Wf,l),Wf.length=0})),null!=c?Object.assign(c,{details:{type:"sphere"},pointOnFace:c.point,pointerPosition:e.clone(),pointerQuaternion:t.clone(),localPoint:c.point.clone().applyMatrix4(Uf.copy(c.object.matrixWorld).invert())}):void 0}const Tf=new rs;const Vf=new Sr,Lf=new xr,Hf=new ra;const Qf=new Or;function Kf(e,t,n){let{geometry:i}=t;return null==i.boundingSphere&&i.computeBoundingSphere(),Qf.copy(i.boundingSphere).applyMatrix4(n),Qf.center.distanceToSquared(e.center)<(e.radius+Qf.radius)**2}const Xf=new Sr,Yf=new Sr,zf=new Sr,Pf=new Sr(1e-4,1e-4,1e-4),Uf=new rs;function _f(e,t,n,i){Uf.copy(n).invert(),Qf.copy(e).applyMatrix4(Uf);const{geometry:r}=t;null==r.boundingBox&&r.computeBoundingBox(),r.boundingBox.getSize(Yf),r.boundingBox.getCenter(zf),r.boundingBox.clampPoint(Qf.center,Xf),Xf.applyMatrix4(n);const s=Xf.distanceToSquared(e.center);if(s>e.radius*e.radius)return;Yf.max(Pf);const o=Qf.center.clone().sub(zf);o.divide(Yf),function(e){const t=Math.abs(e.x),n=Math.abs(e.y),i=Math.abs(e.z);if(t>=n&&t>=i)return void e.set(e.x<0?-1:1,0,0);if(n>=t&&n>=i)return void e.set(0,e.y<0?-1:1,0);e.set(0,0,e.z<0?-1:1)}(o);const a=Xf.clone();return{distance:Math.sqrt(s),face:{a:0,b:0,c:0,materialIndex:0,normal:o},normal:o,point:a,instanceId:i,object:t}}const Of={radius:.07};const Jf={direction:new Sr(0,0,-1),minDistance:0,linePoints:null};const jf={button:0,downRadius:.03,hoverRadius:.1};function qf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:jf,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"touch";const r=new Sr,s=new xr,o=ey();return new df(o,i,t,((a,l,c)=>{var g;const u=e.current;if(null!=u)return u.updateWorldMatrix(!0,!1),r.setFromMatrixPosition(u.matrixWorld),s.setFromRotationMatrix(u.matrixWorld),kf(r,s,null!==(g=n.hoverRadius)&&void 0!==g?g:jf.hoverRadius,a,o,i,t,c,n)}),function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jf,t=!1;return n=>{var i,r;if(!n.getEnabled())return;const s=function(e,t){if(null==e)return!1;return e.distance<=t}(n.getIntersection(),null!==(i=e.downRadius)&&void 0!==i?i:jf.downRadius);if(s===t)return;const o={timeStamp:performance.now(),button:null!==(r=e.button)&&void 0!==r?r:jf.button};s?n.down(o):n.up(o),t=s}}(n),void 0,void 0,n)}let $f=23412;function ey(){return $f++}new Sr,new Oi,new xr;class ty{constructor(){hC(this,"pointers",[]),hC(this,"isDefaults",[]),hC(this,"enabled",!0)}register(e,t){return this.pointers.push(e),this.isDefaults.push(t),this.unregister.bind(this,e)}unregister(e){const t=this.pointers.indexOf(e);-1!==t&&(this.isDefaults.splice(t,1),this.pointers.splice(t,1))}move(e,t){var n,i;if(!this.enabled)return;const r=this.pointers.length;if(0===r)return;for(let c=0;c<r;c++)this.pointers[c].computeMove(e,t);let s=0,o=null!==(n=null===(i=this.pointers[0].getIntersection())||void 0===i?void 0:i.distance)&&void 0!==n?n:1/0;for(let c=1;c<r;c++){var a,l;const e=null!==(a=null===(l=this.pointers[c].getIntersection())||void 0===l?void 0:l.distance)&&void 0!==a?a:1/0;(this.isDefaults[c]&&e===o||e<o)&&(s=c,o=e)}for(let c=0;c<r;c++){const e=this.pointers[c];e.setEnabled(c===s,t,!1),e.commit(t)}}setEnabled(e,t){this.enabled=e;const n=this.pointers.length;for(let i=0;i<n;i++)this.pointers[i].setEnabled(e,t)}}Symbol("provide-xr-space");function ny(e,t){if(null!=t&&null!=t.createdAt&&t.createdAt>=e.lastChangedTime)return t;const n=new vo;return n.setIndex(new ro(e.indices,1)),n.setAttribute("position",new ro(e.vertices,3)),Object.assign(n,{creationTime:e.lastChangedTime})}function iy(e,t){return null!=t&&null!=t.createdAt&&t.createdAt>=e.lastChangedTime?t:Object.assign(function(e){const t=new lA,n=e.map((e=>{let{x:t,z:n}=e;return new Oi(t,n)}));ry.setFromPoints(n),ry.getSize(sy);for(const r of n)r.sub(ry.min),r.divide(sy);t.setFromPoints(n);const i=new KA(t);return i.scale(sy.x,sy.y,1),i.translate(ry.min.x,ry.min.y,0),i.rotateX(Math.PI/2),i}(e.polygon),{createdAt:e.lastChangedTime})}const ry=new rI,sy=new Oi;new Sr,new Sr,new Sr,new xr;var oy=Object.defineProperty,ay=(e,t,n)=>(((e,t,n)=>{t in e?oy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!==typeof t?t+"":t,n),n);function ly(e,t,n,i,r){let s;if(e=e.subarray||e.slice?e:e.buffer,n=n.subarray||n.slice?n:n.buffer,e=t?e.subarray?e.subarray(t,r&&t+r):e.slice(t,r&&t+r):e,n.set)n.set(e,i);else for(s=0;s<e.length;s++)n[s+i]=e[s];return n}class cy extends vo{constructor(){super(),ay(this,"type","MeshLine"),ay(this,"isMeshLine",!0),ay(this,"positions",[]),ay(this,"previous",[]),ay(this,"next",[]),ay(this,"side",[]),ay(this,"width",[]),ay(this,"indices_array",[]),ay(this,"uvs",[]),ay(this,"counters",[]),ay(this,"widthCallback",null),ay(this,"_attributes"),ay(this,"_points",[]),ay(this,"points"),ay(this,"matrixWorld",new rs),Object.defineProperties(this,{points:{enumerable:!0,get(){return this._points},set(e){this.setPoints(e,this.widthCallback)}}})}setMatrixWorld(e){this.matrixWorld=e}setPoints(e,t){if(e=function(e){return e instanceof Float32Array?e:e instanceof vo?e.getAttribute("position").array:e.map((e=>{const t=Array.isArray(e);return e instanceof Sr?[e.x,e.y,e.z]:e instanceof Oi?[e.x,e.y,0]:t&&3===e.length?[e[0],e[1],e[2]]:t&&2===e.length?[e[0],e[1],0]:e})).flat()}(e),this._points=e,this.widthCallback=null!=t?t:null,this.positions=[],this.counters=[],e.length&&e[0]instanceof Sr)for(let n=0;n<e.length;n++){const t=e[n],i=n/(e.length-1);this.positions.push(t.x,t.y,t.z),this.positions.push(t.x,t.y,t.z),this.counters.push(i),this.counters.push(i)}else for(let n=0;n<e.length;n+=3){const t=n/(e.length-1);this.positions.push(e[n],e[n+1],e[n+2]),this.positions.push(e[n],e[n+1],e[n+2]),this.counters.push(t),this.counters.push(t)}this.process()}compareV3(e,t){const n=6*e,i=6*t;return this.positions[n]===this.positions[i]&&this.positions[n+1]===this.positions[i+1]&&this.positions[n+2]===this.positions[i+2]}copyV3(e){const t=6*e;return[this.positions[t],this.positions[t+1],this.positions[t+2]]}process(){const e=this.positions.length/6;let t,n;this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[],n=this.compareV3(0,e-1)?this.copyV3(e-2):this.copyV3(0),this.previous.push(n[0],n[1],n[2]),this.previous.push(n[0],n[1],n[2]);for(let i=0;i<e;i++){if(this.side.push(1),this.side.push(-1),t=this.widthCallback?this.widthCallback(i/(e-1)):1,this.width.push(t),this.width.push(t),this.uvs.push(i/(e-1),0),this.uvs.push(i/(e-1),1),i<e-1){n=this.copyV3(i),this.previous.push(n[0],n[1],n[2]),this.previous.push(n[0],n[1],n[2]);const e=2*i;this.indices_array.push(e,e+1,e+2),this.indices_array.push(e+2,e+1,e+3)}i>0&&(n=this.copyV3(i),this.next.push(n[0],n[1],n[2]),this.next.push(n[0],n[1],n[2]))}n=this.compareV3(e-1,0)?this.copyV3(1):this.copyV3(e-1),this.next.push(n[0],n[1],n[2]),this.next.push(n[0],n[1],n[2]),this._attributes&&this._attributes.position.count===this.counters.length?(this._attributes.position.copyArray(new Float32Array(this.positions)),this._attributes.position.needsUpdate=!0,this._attributes.previous.copyArray(new Float32Array(this.previous)),this._attributes.previous.needsUpdate=!0,this._attributes.next.copyArray(new Float32Array(this.next)),this._attributes.next.needsUpdate=!0,this._attributes.side.copyArray(new Float32Array(this.side)),this._attributes.side.needsUpdate=!0,this._attributes.width.copyArray(new Float32Array(this.width)),this._attributes.width.needsUpdate=!0,this._attributes.uv.copyArray(new Float32Array(this.uvs)),this._attributes.uv.needsUpdate=!0,this._attributes.index.copyArray(new Uint16Array(this.indices_array)),this._attributes.index.needsUpdate=!0):this._attributes={position:new ro(new Float32Array(this.positions),3),previous:new ro(new Float32Array(this.previous),3),next:new ro(new Float32Array(this.next),3),side:new ro(new Float32Array(this.side),1),width:new ro(new Float32Array(this.width),1),uv:new ro(new Float32Array(this.uvs),2),index:new ro(new Uint16Array(this.indices_array),1),counters:new ro(new Float32Array(this.counters),1)},this.setAttribute("position",this._attributes.position),this.setAttribute("previous",this._attributes.previous),this.setAttribute("next",this._attributes.next),this.setAttribute("side",this._attributes.side),this.setAttribute("width",this._attributes.width),this.setAttribute("uv",this._attributes.uv),this.setAttribute("counters",this._attributes.counters),this.setAttribute("position",this._attributes.position),this.setAttribute("previous",this._attributes.previous),this.setAttribute("next",this._attributes.next),this.setAttribute("side",this._attributes.side),this.setAttribute("width",this._attributes.width),this.setAttribute("uv",this._attributes.uv),this.setAttribute("counters",this._attributes.counters),this.setIndex(this._attributes.index),this.computeBoundingSphere(),this.computeBoundingBox()}advance(e){let{x:t,y:n,z:i}=e;const r=this._attributes.position.array,s=this._attributes.previous.array,o=this._attributes.next.array,a=r.length;ly(r,0,s,0,a),ly(r,6,r,0,a-6),r[a-6]=t,r[a-5]=n,r[a-4]=i,r[a-3]=t,r[a-2]=n,r[a-1]=i,ly(r,6,o,0,a-6),o[a-6]=t,o[a-5]=n,o[a-4]=i,o[a-3]=t,o[a-2]=n,o[a-1]=i,this._attributes.position.needsUpdate=!0,this._attributes.previous.needsUpdate=!0,this._attributes.next.needsUpdate=!0}}const gy="\n  #include <fog_pars_fragment>\n  #include <logdepthbuf_pars_fragment>\n  #include <clipping_planes_pars_fragment>\n  \n  uniform sampler2D map;\n  uniform sampler2D alphaMap;\n  uniform float useGradient;\n  uniform float useMap;\n  uniform float useAlphaMap;\n  uniform float useDash;\n  uniform float dashArray;\n  uniform float dashOffset;\n  uniform float dashRatio;\n  uniform float visibility;\n  uniform float alphaTest;\n  uniform vec2 repeat;\n  uniform vec3 gradient[2];\n  \n  varying vec2 vUV;\n  varying vec4 vColor;\n  varying float vCounters;\n  \n  void main() {\n    #include <logdepthbuf_fragment>\n    vec4 diffuseColor = vColor;\n    if (useGradient == 1.) diffuseColor = vec4(mix(gradient[0], gradient[1], vCounters), 1.0);\n    if (useMap == 1.) diffuseColor *= texture2D(map, vUV * repeat);\n    if (useAlphaMap == 1.) diffuseColor.a *= texture2D(alphaMap, vUV * repeat).a;\n    if (diffuseColor.a < alphaTest) discard;\n    if (useDash == 1.) diffuseColor.a *= ceil(mod(vCounters + dashOffset, dashArray) - (dashArray * dashRatio));\n    diffuseColor.a *= step(vCounters, visibility);\n    #include <clipping_planes_fragment>\n    gl_FragColor = diffuseColor;     \n    #include <fog_fragment>\n    #include <tonemapping_fragment>\n    #include <".concat((()=>parseInt(O.replace(/\D+/g,"")))()>=154?"colorspace_fragment":"encodings_fragment",">\n  }\n");class uy extends _o{constructor(e){super({uniforms:{...Aa.fog,lineWidth:{value:1},map:{value:null},useMap:{value:0},alphaMap:{value:null},useAlphaMap:{value:0},color:{value:new Ps(16777215)},gradient:{value:[new Ps(16711680),new Ps(65280)]},opacity:{value:1},resolution:{value:new Oi(1,1)},sizeAttenuation:{value:1},dashArray:{value:0},dashOffset:{value:0},dashRatio:{value:.5},useDash:{value:0},useGradient:{value:0},visibility:{value:1},alphaTest:{value:0},repeat:{value:new Oi(1,1)}},vertexShader:"\n  #include <common>\n  #include <logdepthbuf_pars_vertex>\n  #include <fog_pars_vertex>\n  #include <clipping_planes_pars_vertex>\n\n  attribute vec3 previous;\n  attribute vec3 next;\n  attribute float side;\n  attribute float width;\n  attribute float counters;\n  \n  uniform vec2 resolution;\n  uniform float lineWidth;\n  uniform vec3 color;\n  uniform float opacity;\n  uniform float sizeAttenuation;\n  \n  varying vec2 vUV;\n  varying vec4 vColor;\n  varying float vCounters;\n  \n  vec2 fix(vec4 i, float aspect) {\n    vec2 res = i.xy / i.w;\n    res.x *= aspect;\n    return res;\n  }\n  \n  void main() {\n    float aspect = resolution.x / resolution.y;\n    vColor = vec4(color, opacity);\n    vUV = uv;\n    vCounters = counters;\n  \n    mat4 m = projectionMatrix * modelViewMatrix;\n    vec4 finalPosition = m * vec4(position, 1.0) * aspect;\n    vec4 prevPos = m * vec4(previous, 1.0);\n    vec4 nextPos = m * vec4(next, 1.0);\n  \n    vec2 currentP = fix(finalPosition, aspect);\n    vec2 prevP = fix(prevPos, aspect);\n    vec2 nextP = fix(nextPos, aspect);\n  \n    float w = lineWidth * width;\n  \n    vec2 dir;\n    if (nextP == currentP) dir = normalize(currentP - prevP);\n    else if (prevP == currentP) dir = normalize(nextP - currentP);\n    else {\n      vec2 dir1 = normalize(currentP - prevP);\n      vec2 dir2 = normalize(nextP - currentP);\n      dir = normalize(dir1 + dir2);\n  \n      vec2 perp = vec2(-dir1.y, dir1.x);\n      vec2 miter = vec2(-dir.y, dir.x);\n      //w = clamp(w / dot(miter, perp), 0., 4. * lineWidth * width);\n    }\n  \n    //vec2 normal = (cross(vec3(dir, 0.), vec3(0., 0., 1.))).xy;\n    vec4 normal = vec4(-dir.y, dir.x, 0., 1.);\n    normal.xy *= .5 * w;\n    //normal *= projectionMatrix;\n    if (sizeAttenuation == 0.) {\n      normal.xy *= finalPosition.w;\n      normal.xy /= (vec4(resolution, 0., 1.) * projectionMatrix).xy * aspect;\n    }\n  \n    finalPosition.xy += normal.xy * side;\n    gl_Position = finalPosition;\n    #include <logdepthbuf_vertex>\n    #include <fog_vertex>\n    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n    #include <clipping_planes_vertex>\n    #include <fog_vertex>\n  }\n",fragmentShader:gy}),ay(this,"lineWidth"),ay(this,"map"),ay(this,"useMap"),ay(this,"alphaMap"),ay(this,"useAlphaMap"),ay(this,"color"),ay(this,"gradient"),ay(this,"resolution"),ay(this,"sizeAttenuation"),ay(this,"dashArray"),ay(this,"dashOffset"),ay(this,"dashRatio"),ay(this,"useDash"),ay(this,"useGradient"),ay(this,"visibility"),ay(this,"repeat"),this.type="MeshLineMaterial",Object.defineProperties(this,{lineWidth:{enumerable:!0,get(){return this.uniforms.lineWidth.value},set(e){this.uniforms.lineWidth.value=e}},map:{enumerable:!0,get(){return this.uniforms.map.value},set(e){this.uniforms.map.value=e}},useMap:{enumerable:!0,get(){return this.uniforms.useMap.value},set(e){this.uniforms.useMap.value=e}},alphaMap:{enumerable:!0,get(){return this.uniforms.alphaMap.value},set(e){this.uniforms.alphaMap.value=e}},useAlphaMap:{enumerable:!0,get(){return this.uniforms.useAlphaMap.value},set(e){this.uniforms.useAlphaMap.value=e}},color:{enumerable:!0,get(){return this.uniforms.color.value},set(e){this.uniforms.color.value=e}},gradient:{enumerable:!0,get(){return this.uniforms.gradient.value},set(e){this.uniforms.gradient.value=e}},opacity:{enumerable:!0,get(){return this.uniforms.opacity.value},set(e){this.uniforms.opacity.value=e}},resolution:{enumerable:!0,get(){return this.uniforms.resolution.value},set(e){this.uniforms.resolution.value.copy(e)}},sizeAttenuation:{enumerable:!0,get(){return this.uniforms.sizeAttenuation.value},set(e){this.uniforms.sizeAttenuation.value=e}},dashArray:{enumerable:!0,get(){return this.uniforms.dashArray.value},set(e){this.uniforms.dashArray.value=e,this.useDash=0!==e?1:0}},dashOffset:{enumerable:!0,get(){return this.uniforms.dashOffset.value},set(e){this.uniforms.dashOffset.value=e}},dashRatio:{enumerable:!0,get(){return this.uniforms.dashRatio.value},set(e){this.uniforms.dashRatio.value=e}},useDash:{enumerable:!0,get(){return this.uniforms.useDash.value},set(e){this.uniforms.useDash.value=e}},useGradient:{enumerable:!0,get(){return this.uniforms.useGradient.value},set(e){this.uniforms.useGradient.value=e}},visibility:{enumerable:!0,get(){return this.uniforms.visibility.value},set(e){this.uniforms.visibility.value=e}},alphaTest:{enumerable:!0,get(){return this.uniforms.alphaTest.value},set(e){this.uniforms.alphaTest.value=e}},repeat:{enumerable:!0,get(){return this.uniforms.repeat.value},set(e){this.uniforms.repeat.value.copy(e)}}}),this.setValues(e)}copy(e){return super.copy(e),this.lineWidth=e.lineWidth,this.map=e.map,this.useMap=e.useMap,this.alphaMap=e.alphaMap,this.useAlphaMap=e.useAlphaMap,this.color.copy(e.color),this.gradient=e.gradient,this.opacity=e.opacity,this.resolution.copy(e.resolution),this.sizeAttenuation=e.sizeAttenuation,this.dashArray=e.dashArray,this.dashOffset=e.dashOffset,this.dashRatio=e.dashRatio,this.useDash=e.useDash,this.useGradient=e.useGradient,this.visibility=e.visibility,this.alphaTest=e.alphaTest,this.repeat.copy(e.repeat),this}}Math.PI,Math.PI;function Ay(e,t,n){return Math.max(t,Math.min(n,e))}const dy=new hs(0,0,0,"YXZ"),hy=new xr;function Iy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>!0===t.object.userData.teleportTarget&&!(null!=e.customFilter&&!e.customFilter(t))}class py extends Qo{constructor(e){const t=new cy,n=new Float32Array(3*e.length);for(let s=0;s<e.length;s++)e[s].toArray(n,3*s);t.setPoints(n);const i=(3*e.length-3)/(3*e.length-1),r=new uy({lineWidth:.1,resolution:void 0,visibility:i});super(t,r),hC(this,"multiplier",void 0),hC(this,"lineLengths",void 0),hC(this,"options",{}),this.material.transparent=!0,this.multiplier=i,this.material=r,this.lineLengths=e.slice(0,-1).map(((t,n)=>t.distanceTo(e[n+1])))}update(e){if(!e.getEnabled()||0===e.getButtonsDown().size)return void(this.visible=!1);this.visible=!0;const t=e.getIntersection();if("lines"!=(null===t||void 0===t?void 0:t.details.type))return void(this.material.visibility=this.multiplier);const{distanceOnLine:n,lineIndex:i}=t.details,r=this.lineLengths[i];this.material.visibility=this.multiplier*(i+n/r)/this.lineLengths.length;const{color:s="white",opacity:o=.4,size:a=.01}=this.options;this.material.lineWidth=a,this.material.opacity="function"===typeof o?o(e):o;const l="function"===typeof s?s(e):s;Array.isArray(l)?this.material.color.set(...l):this.material.color.set(l),console.log(this.material.visibility,this.multiplier,i,r,n,this.lineLengths.length)}}const Cy=new class extends Zd{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new bC(e)})),this.register((function(e){return new ZC(e)})),this.register((function(e){return new DC(e)})),this.register((function(e){return new FC(e)})),this.register((function(e){return new vC(e)})),this.register((function(e){return new wC(e)})),this.register((function(e){return new GC(e)})),this.register((function(e){return new EC(e)})),this.register((function(e){return new yC(e)})),this.register((function(e){return new xC(e)})),this.register((function(e){return new BC(e)})),this.register((function(e){return new RC(e)})),this.register((function(e){return new SC(e)})),this.register((function(e){return new mC(e)})),this.register((function(e){return new NC(e)})),this.register((function(e){return new MC(e)}))}load(e,t,n,i){const r=this;let s;if(""!==this.resourcePath)s=this.resourcePath;else if(""!==this.path){const t=oh.extractUrlBase(e);s=oh.resolveURL(t,this.path)}else s=oh.extractUrlBase(e);this.manager.itemStart(e);const o=function(t){i?i(t):console.error(t),r.manager.itemError(e),r.manager.itemEnd(e)},a=new Nd(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){try{r.parse(n,s,(function(n){t(n),r.manager.itemEnd(e)}),o)}catch(Ow){o(Ow)}}),n,o)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,i){let r;const s={},o={},a=new TextDecoder;if("string"===typeof e)r=JSON.parse(e);else if(e instanceof ArrayBuffer){if(a.decode(new Uint8Array(e,0,4))===WC){try{s[CC.KHR_BINARY_GLTF]=new VC(e)}catch(HY){return void(i&&i(HY))}r=JSON.parse(s[CC.KHR_BINARY_GLTF].content)}else r=JSON.parse(a.decode(e))}else r=e;if(void 0===r.asset||r.asset.version[0]<2)return void(i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const l=new cm(r,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const e=this.pluginCallbacks[c](l);e.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),o[e.name]=e,s[e.name]=!0}if(r.extensionsUsed)for(let c=0;c<r.extensionsUsed.length;++c){const e=r.extensionsUsed[c],t=r.extensionsRequired||[];switch(e){case CC.KHR_MATERIALS_UNLIT:s[e]=new fC;break;case CC.KHR_DRACO_MESH_COMPRESSION:s[e]=new LC(r,this.dracoLoader);break;case CC.KHR_TEXTURE_TRANSFORM:s[e]=new HC;break;case CC.KHR_MESH_QUANTIZATION:s[e]=new QC;break;default:t.indexOf(e)>=0&&void 0===o[e]&&console.warn('THREE.GLTFLoader: Unknown extension "'+e+'".')}}l.setExtensions(s),l.setPlugins(o),l.parse(n,i)}parseAsync(e,t){const n=this;return new Promise((function(i,r){n.parse(e,t,i,r)}))}},my="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles/";class fy{constructor(e){var t,n;hC(this,"baseAssetPath",void 0),hC(this,"defaultProfileId",void 0),hC(this,"profilesListPromise",void 0),hC(this,"profilePromisesMap",new Map),hC(this,"loadAsync",this.load),this.baseAssetPath=null!==(t=null===e||void 0===e?void 0:e.baseAssetPath)&&void 0!==t?t:my,this.defaultProfileId=null!==(n=null===e||void 0===e?void 0:e.defaultControllerProfileId)&&void 0!==n?n:"generic-trigger"}async load(e,t){const n=await this.loadProfile(e);for(const i in n.layouts)if(i.includes(t))return n.layouts[i];throw new Error('No matching layout for "'.concat(t,'", in profile ').concat(n.profileId," with layouts ").concat(Object.keys(n.layouts).join(", "),"."))}async loadProfile(e){var t;null!==(t=this.profilesListPromise)&&void 0!==t||(this.profilesListPromise=yy(new URL("profilesList.json",this.baseAssetPath).href));const n=await this.profilesListPromise,i=e.length;for(let s=0;s<i;s++){const t=n[e[s]];if(null!=t)return this.loadProfileFromPathCached(t.path)}const r=n[this.defaultProfileId];if(null!=r)return this.loadProfileFromPathCached(r.path);throw new Error('no matching profile found for profiles "'.concat(e.join(", "),'" in profile list ').concat(JSON.stringify(n)))}loadProfileFromPathCached(e){let t=this.profilePromisesMap.get(e);return null==t&&this.profilePromisesMap.set(e,t=this.loadProfileFromPath(e)),t}async loadProfileFromPath(e){const t=new URL(e,this.baseAssetPath).href,n=await yy(t);for(const i in n.layouts){const e=n.layouts[i];null!=e&&(e.assetPath=new URL(e.assetPath,t).href)}return n}}async function yy(e){let t=await fetch(e);return t.ok?t.json():Promise.reject(new Error(t.statusText))}const by=.05,By=.1;function vy(e,t,n){const i=t.gamepad;if(null==i)return;const r=n.components;for(const s in r){let t=e[s];null==t&&(e[s]=t={});const{gamepadIndices:n}=r[s];let o=!1,a=!1;if(null!=n.button&&n.button<i.buttons.length){const e=i.buttons[n.button];t.button=Ay(e.value,0,1),o||(o=e.pressed||1===t.button),a||(a=e.touched||t.button>by)}null!=n.xAxis&&n.xAxis<i.axes.length&&(t.xAxis=Ay(i.axes[n.xAxis],-1,1),a||(a=Math.abs(t.xAxis)>By)),null!=n.yAxis&&n.yAxis<i.axes.length&&(t.yAxis=Ay(i.axes[n.yAxis],-1,1),a||(a=Math.abs(t.yAxis)>By)),t.state=o?"pressed":a?"touched":"default"}}async function wy(e,t){const n=await t.load(e.profiles,e.handedness),i={};return vy(i,e,n),{type:"controller",inputSource:e,gamepad:i,layout:n}}function Gy(e){let{gamepad:t,inputSource:n,layout:i}=e;vy(t,n,i)}const Ey=(0,t.createContext)(void 0),xy=(0,t.createContext)(void 0),Sy=(0,t.createContext)(void 0),Ry=(0,t.createContext)(void 0),Zy=(0,t.createContext)(void 0),Dy=(0,t.createContext)(void 0),Fy=(0,t.forwardRef)(((e,n)=>{let{space:i,children:r}=e;const s=(0,t.useRef)(null);return(0,t.useImperativeHandle)(n,(()=>s.current),[]),function(e,n,i){const r=function(e){const n=Ny();return(0,t.useMemo)((()=>Vm(e,n)),[e,n])}(n);Op(((t,n,s)=>{null!=e.current&&(r(e.current.matrix,s),null===i||void 0===i||i(t,n,s))}),-100)}(s,i,((e,t,n)=>{null!=s.current&&(s.current.visible=null!=n)})),(0,I.jsx)("group",{visible:!1,matrixAutoUpdate:!1,ref:s,children:(0,I.jsx)(Zy.Provider,{value:i,children:r})})}));function Ny(){const e=(0,t.useContext)(Zy);if(null==e)throw new Error("XR objects must be placed inside the XROrigin");return e}let My=0;const Wy=new Map;function ky(e){let t=Wy.get(e);return null==t&&Wy.set(e,t=My++),t}function Ty(e){if(null!=e)return mb((t=>t.handStates.find((t=>t.inputSource.handedness===e))));const n=(0,t.useContext)(Ry);if(null==n||"hand"!=n.type)throw new Error('useXRHandState() can only be used inside a <XRHand> or with using useXRHandState("left")');return n}const Vy=Symbol("loadXRHandModel"),Ly=(0,t.forwardRef)(((e,n)=>{const i=Ty(),r=ep(mm,[i.assetPath,void 0,Vy]);fm(r,e),(0,t.useImperativeHandle)(n,(()=>r),[r]);const s=Ny(),o=(0,t.useMemo)((()=>vm(i.inputSource.hand,r,s)),[i.inputSource,r,s]);return Op(((e,t,n)=>o(n))),(0,I.jsx)("primitive",{object:r})}));(0,t.forwardRef)(((e,t)=>{let{joint:n,children:i}=e;const r=Ty();return(0,I.jsx)(Fy,{ref:t,space:()=>r.inputSource.hand.get(n),children:i})}));function Hy(e){let{children:n}=e;const i=(0,t.useMemo)((()=>new ty),[]);return Uy(i),Op((e=>i.move(e.scene,{timeStamp:performance.now()})),-50),(0,I.jsx)(Dy.Provider,{value:i,children:n})}function Qy(e,n,i,r){const s=(0,t.useMemo)((()=>({})),[]);Object.assign(s,Of,i);const o=(0,t.useMemo)((()=>function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Of,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"grab";const r=new Sr,s=new xr,o=ey();return new df(o,i,t,((a,l,c)=>{var g;const u=e.current;if(null!=u)return u.updateWorldMatrix(!0,!1),r.setFromMatrixPosition(u.matrixWorld),s.setFromRotationMatrix(u.matrixWorld),kf(r,s,null!==(g=n.radius)&&void 0!==g?g:Of.radius,a,o,i,t,c,n)}),void 0,void 0,void 0,n)}(e,n,s,r)),[e,n,s,r]);return Py(o,null===i||void 0===i?void 0:i.makeDefault),o}function Ky(e,n,i,r){const s=(0,t.useMemo)((()=>({})),[]);Object.assign(s,Jf,i);const o=(0,t.useMemo)((()=>function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Jf,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"ray";const r=new Sr,s=new xr,o=ey();return new df(o,i,t,((a,l,c)=>{var g,u;const A=e.current;if(null==A)return;let d;A.updateWorldMatrix(!0,!1);const h=null!==(g=n.linePoints)&&void 0!==g?g:Jf.linePoints;var I;return null==h?(r.setFromMatrixPosition(A.matrixWorld),s.setFromRotationMatrix(A.matrixWorld),d=Ff(r,s,null!==(I=n.direction)&&void 0!==I?I:Jf.direction,a,o,i,t,c,n)):d=Bf(A.matrixWorld,h,a,o,i,t,c,n),null==d||d.distance<(null!==(u=n.minDistance)&&void 0!==u?u:Jf.minDistance)?void 0:d}),void 0,void 0,void 0,n)}(e,n,s,r)),[e,n,s,r]);return Py(o,null===i||void 0===i?void 0:i.makeDefault),o}const Xy=(0,t.forwardRef)(((e,n)=>{var i;const r=(0,t.useMemo)((()=>new Fm),[]),s=(0,t.useRef)(null);return(0,t.useImperativeHandle)(n,(()=>s.current),[]),Op((()=>null!=s.current&&Nm(s.current,r,e.pointer,e))),(0,I.jsx)("mesh",{matrixAutoUpdate:!1,renderOrder:null!==(i=e.renderOrder)&&void 0!==i?i:2,ref:s,material:r,children:(0,I.jsx)("boxGeometry",{})})})),Yy=(0,t.forwardRef)(((e,n)=>{var i;const r=(0,t.useMemo)((()=>new xm),[]),s=(0,t.useRef)(null);(0,t.useImperativeHandle)(n,(()=>s.current),[]),Op((()=>null!=s.current&&Dm(s.current,r,e.pointer,e)));const o=_p((e=>e.scene));return cC((0,I.jsx)("mesh",{renderOrder:null!==(i=e.renderOrder)&&void 0!==i?i:1,ref:s,matrixAutoUpdate:!1,material:r,children:(0,I.jsx)("planeGeometry",{})}),o)}));function zy(e,n,i,r){const s=mb((e=>e.session));(0,t.useEffect)((()=>{if(null!=s)return function(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=t=>{var i;t.inputSource===n&&e.down(Object.assign(t,{button:null!==(i=s.button)&&void 0!==i?i:0}))},a=t=>{var i;t.inputSource===n&&e.up(Object.assign(t,{button:null!==(i=s.button)&&void 0!==i?i:0}))},l="".concat(i,"start"),c="".concat(i,"end");if(null!=r){const e=r.length;for(let t=0;t<e;t++){const e=r[t];switch(e.type){case l:o(e);break;case c:a(e)}}}return t.addEventListener(l,o),t.addEventListener(c,a),()=>{t.removeEventListener(l,o),t.removeEventListener(c,a)}}(e,s,n,i,r)}),[i,n,e,s,r])}function Py(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=(0,t.useContext)(Dy);null==i?(Uy(e),Op((t=>e.move(t.scene,{timeStamp:performance.now()})),-50)):(0,t.useEffect)((()=>i.register(e,n)),[i,e,n]),(0,t.useEffect)((()=>()=>e.exit({timeStamp:performance.now()})),[e])}function Uy(e){const n=Cb();(0,t.useEffect)((()=>function(e,t){const n=(e,n)=>{null!=n&&e.visibilityState===n.visibilityState||t("visible"===e.visibilityState)};return n(e.getState()),e.subscribe(n)}(n,(t=>e.setEnabled(t,{timeStamp:performance.now()})))),[n,e])}const _y=(0,t.forwardRef)(((e,n)=>{let{pointer:i,linePoints:r,...s}=e;const o=(0,t.useMemo)((()=>new py(r)),[r]);return(0,t.useImperativeHandle)(n,(()=>o),[o]),o.options=s,Op((()=>o.update(i))),(0,I.jsx)("primitive",{object:o})}));function Oy(e,n,i){const r=(0,t.useContext)(Ry);if(null==r)throw new Error("DefaultXRInputSourceGrabPointer can only be used inside a XRInputSource");const s=(0,t.useRef)(null),o=Qy(s,r,i);zy(o,r.inputSource,e);const a=i.cursorModel;return(0,I.jsx)(Fy,{ref:s,space:n(r.inputSource),children:!1!==a&&(0,I.jsx)(Yy,{pointer:o,opacity:Mm,...ob(a)})})}const Jy=Oy.bind(null,"select",(e=>()=>e.hand.get("index-finger-tip"))),jy=Oy.bind(null,"squeeze",(e=>e.gripSpace));function qy(e){const n=(0,t.useContext)(Ry);if(null==n)throw new Error("DefaultXRInputSourceRayPointer can only be used inside a XRInputSource");const i=(0,t.useRef)(null),r=Ky(i,n,e);zy(r,n.inputSource,"select");const s=e.rayModel,o=e.cursorModel;return(0,I.jsxs)(Fy,{ref:i,space:n.inputSource.targetRaySpace,children:[!1!==s&&(0,I.jsx)(Xy,{pointer:r,opacity:Wm,...ob(s)}),!1!==o&&(0,I.jsx)(Yy,{pointer:r,opacity:Wm,...ob(o)})]})}function $y(e){const n=Ty(),i=(0,t.useRef)(null),r=function(e,n,i,r){const s=(0,t.useMemo)((()=>({})),[]);Object.assign(s,jf,i);const o=(0,t.useMemo)((()=>qf(e,n,s,r)),[e,n,s,r]);return Py(o,null===i||void 0===i?void 0:i.makeDefault),o}(i,n,e),s=e.cursorModel;return(0,I.jsx)(Fy,{ref:i,space:()=>n.inputSource.hand.get("index-finger-tip"),children:!1!==s&&(0,I.jsx)(Yy,{pointer:r,opacity:km,...ob(s)})})}function eb(e){var n;const i=e.model,r=e.grabPointer,s=e.rayPointer,o=null!==(n=e.teleportPointer)&&void 0!==n&&n;return(0,I.jsxs)(I.Fragment,{children:[!1!==i&&(0,I.jsx)(t.Suspense,{children:(0,I.jsx)(bb,{...ob(i)})}),(0,I.jsxs)(Hy,{children:[!1!==r&&(0,I.jsx)(jy,{...ob(r)}),!1!==s&&(0,I.jsx)(qy,{makeDefault:!0,minDistance:.2,...ob(s)}),!1!==o&&(0,I.jsx)(sb,{...ob(o)})]})]})}function tb(e){var n,i;const r=e.model,s=e.grabPointer,o=e.rayPointer,a=e.touchPointer,l=null!==(n=e.teleportPointer)&&void 0!==n&&n,c=!1!==o&&(null===(i=ob(o))||void 0===i?void 0:i.rayModel);return(0,I.jsxs)(I.Fragment,{children:[!1!==r&&(0,I.jsx)(t.Suspense,{children:(0,I.jsx)(Ly,{...ob(r)})}),(0,I.jsxs)(Hy,{children:[!1!==s&&(0,I.jsx)(Jy,{...ob(s)}),!1!==a&&(0,I.jsx)($y,{...ob(a)}),!1!==o&&(0,I.jsx)(qy,{makeDefault:!0,minDistance:.2,...ob(o),rayModel:!1!==c&&{maxLength:.2,...ob(c)}}),!1!==l&&(0,I.jsx)(sb,{...ob(l)})]})]})}function nb(e){return(0,I.jsx)(qy,{...e,rayModel:!1})}function ib(e){return(0,I.jsx)(qy,{...e,rayModel:!1})}function rb(e){return(0,I.jsx)(qy,{...e,cursorModel:!1,rayModel:!1})}function sb(e){const n=(0,t.useContext)(Ry);if(null==n)throw new Error("DefaultXRInputSourceRayPointer can only be used inside a XRInputSource");const i=(0,t.useRef)(null),r=(0,t.useRef)(null),s=(0,t.useMemo)((()=>new zu(new Sr(0,0,0),new Sr(0,0,-8),new Sr(0,-20,-15)).getPoints(20)),[]),o=Ky(r,n,{...e,linePoints:s,customFilter:Iy(e)},"teleport");zy(o,n.inputSource,"select");const a=e.rayModel,l=e.cursorModel,c=_p((e=>e.scene)),g=(0,t.useRef)(null);return Op(((e,t)=>{null!=g.current&&(g.current.visible=o.getEnabled()&&o.getButtonsDown().size>0);const n=r.current,s=i.current;var a,l;null!=n&&null!=s&&(a=n,l=1e3*t,s.matrixWorld.decompose(a.position,hy,a.scale),dy.setFromQuaternion(hy),dy.z=0,dy.x=Ay(dy.x-10*Math.PI/180,-Math.PI/2,1.1*Math.PI/4),hy.setFromEuler(dy),a.quaternion.slerp(hy,l/100))})),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(Fy,{ref:i,space:n.inputSource.targetRaySpace}),cC((0,I.jsxs)("group",{ref:r,children:[!1!==a&&(0,I.jsx)(_y,{linePoints:s,pointer:o,opacity:Wm,...ob(a)}),!1!==l&&(0,I.jsx)(Yy,{ref:g,pointer:o,opacity:Wm,...ob(l)})]}),c)]})}function ob(e){if(!0!==e)return e}function ab(e){let{children:n}=e;const i=_p((e=>e.gl.xr)),r=mb((e=>e.origin)),s=(0,t.useCallback)((()=>i.getReferenceSpace()),[i]),o="visible"===mb((e=>e.visibilityState)),a=Up(),l=(0,t.useMemo)((()=>Object.assign({},a,{getState:()=>({...a.getState(),scene:r})})),[r,a]);return null==r?null:(0,I.jsx)(I.Fragment,{children:nC.createPortal((0,I.jsx)(kp.Provider,{value:a,children:(0,I.jsxs)(Zy.Provider,{value:s,children:[(0,I.jsxs)("group",{matrixAutoUpdate:!1,visible:o,children:[(0,I.jsx)(lb,{}),(0,I.jsx)(cb,{}),(0,I.jsx)(gb,{}),(0,I.jsx)(ub,{}),(0,I.jsx)(Ab,{})]}),(0,I.jsx)(hb,{}),(0,I.jsx)(Ib,{}),n]})}),l,null)})}function lb(){const e=mb((e=>e.controllerStates));let n=mb((e=>e.controller));return!1===n?null:(0,I.jsx)(I.Fragment,{children:e.map((e=>{const i=Qm(n,e.inputSource.handedness,{});return!1===i?null:(0,I.jsx)(Fy,{space:e.inputSource.gripSpace,children:(0,I.jsx)(Ry.Provider,{value:e,children:(0,I.jsx)(t.Suspense,{children:"function"===typeof i?(0,I.jsx)(i,{}):(0,I.jsx)(eb,{...i})})})},ky(e))}))})}function cb(){const e=mb((e=>e.handStates)),n=mb((e=>e.hand));return!1===n?null:(0,I.jsx)(I.Fragment,{children:e.map((e=>{const i=Qm(n,e.inputSource.handedness,{});return!1===i?null:(0,I.jsx)(Fy,{space:()=>e.inputSource.hand.get("wrist"),children:(0,I.jsx)(Ry.Provider,{value:e,children:(0,I.jsx)(t.Suspense,{children:"function"===typeof i?(0,I.jsx)(i,{}):(0,I.jsx)(tb,{...i})})})},ky(e))}))})}function gb(){const e=mb((e=>e.transientPointerStates)),n=mb((e=>e.transientPointer));return!1===n?null:(0,I.jsx)(I.Fragment,{children:e.map((e=>{const i=Qm(n,e.inputSource.handedness,{});return!1===i?null:(0,I.jsx)(Fy,{space:()=>e.inputSource.targetRaySpace,children:(0,I.jsx)(Ry.Provider,{value:e,children:(0,I.jsx)(t.Suspense,{children:"function"===typeof i?(0,I.jsx)(i,{}):(0,I.jsx)(nb,{...i})})})},ky(e))}))})}function ub(){const e=mb((e=>e.gazeStates)),n=mb((e=>e.gaze));return!1===n?null:(0,I.jsx)(I.Fragment,{children:e.map((e=>(0,I.jsx)(Fy,{space:()=>e.inputSource.targetRaySpace,children:(0,I.jsx)(Ry.Provider,{value:e,children:(0,I.jsx)(t.Suspense,{children:"function"===typeof n?(0,I.jsx)(n,{}):(0,I.jsx)(ib,{...db(n)})})})},ky(e))))})}function Ab(){const e=mb((e=>e.screenInputStates)),n=mb((e=>e.screenInput));return!1===n?null:(0,I.jsx)(I.Fragment,{children:e.map((e=>(0,I.jsx)(Fy,{space:()=>e.inputSource.targetRaySpace,children:(0,I.jsx)(Ry.Provider,{value:e,children:(0,I.jsx)(t.Suspense,{children:"function"===typeof n?(0,I.jsx)(n,{}):(0,I.jsx)(rb,{...db(n)})})})},ky(e))))})}function db(e){if(!0!==e)return e}function hb(){const e=mb((e=>e.detectedMeshes)),n=mb((e=>e.detectedMesh));if(!1!==n)return(0,I.jsx)(I.Fragment,{children:e.map((e=>{const i=Km(n,e.semanticLabel,!1);return!1===i?null:(0,I.jsx)(Fy,{space:e.meshSpace,children:(0,I.jsx)(xy.Provider,{value:e,children:(0,I.jsx)(t.Suspense,{children:(0,I.jsx)(i,{})})})},ky(e))}))})}function Ib(){const e=mb((e=>e.detectedPlanes)),n=mb((e=>e.detectedPlane));if(null!=n)return(0,I.jsx)(I.Fragment,{children:e.map((e=>{const i=Km(n,e.semanticLabel,!1);return!1===i?null:(0,I.jsx)(Fy,{space:e.planeSpace,children:(0,I.jsx)(Sy.Provider,{value:e,children:(0,I.jsx)(t.Suspense,{children:(0,I.jsx)(i,{})})})},ky(e))}))})}function pb(e){let{children:n,store:i}=e;i.setWebXRManager(_p((e=>e.gl.xr)));const r=Up();return(0,t.useEffect)((()=>{let e;return i.subscribe(((t,n)=>{const i=null!=t.mode;if(i!==(null!=n.mode)){if(i){const{camera:t,gl:n}=r.getState();return e=t,void r.setState({camera:n.xr.getCamera()})}null!=e&&r.setState({camera:e})}}))}),[r,i]),Op(((e,t,n)=>i.onBeforeFrame(e.scene,e.camera,n)),-1e3),(0,I.jsxs)(Ey.Provider,{value:i,children:[(0,I.jsx)(ab,{}),n]})}function Cb(){const e=(0,t.useContext)(Ey);if(null==e)throw new Error("XR features can only be used inside the <XR> component");return e}function mb(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>e;return u(Cb(),e)}(0,t.forwardRef)(((e,n)=>{let{id:i,children:r,onPress:s,onRelease:o}=e;const a=fb(),[l,c]=(0,t.useState)(void 0);if((0,t.useImperativeHandle)(n,(()=>l),[l]),function(e,n,i){const r=null==i?fb():fb(i),s=(0,t.useRef)();Op((()=>{var t;const i=null===r||void 0===r||null===(t=r.gamepad[e])||void 0===t?void 0:t.state;null!=i&&i!=s.current&&n(i),s.current=i}))}(i,(e=>"pressed"===e?null===s||void 0===s?void 0:s():null===o||void 0===o?void 0:o())),Op((()=>{var e;return c(null===(e=a.gamepad[i])||void 0===e?void 0:e.object)})),null!=l)return cC(r,l)}));function fb(e){if(null!=e)return mb((t=>t.controllerStates.find((t=>t.inputSource.handedness===e))));const n=(0,t.useContext)(Ry);if(null==n||"controller"!=n.type)throw new Error('useXRControllerState() can only be used inside a <XRController> or using useXRControllerState("left")');return n}const yb=Symbol("loadXRControllerModel"),bb=(0,t.forwardRef)(((e,n)=>{const i=fb(),r=ep(jm,[i.layout,void 0,yb]);qm(r,e),i.object=r,(0,t.useImperativeHandle)(n,(()=>r),[r]);return Op((0,t.useMemo)((()=>$m(r,i.layout,i.gamepad)),[r,i.layout,i.gamepad])),(0,I.jsx)("primitive",{object:r})}));(0,t.forwardRef)(((e,n)=>{const i=function(){const e=(0,t.useContext)(xy);if(null==e)throw new Error("useXRMesh can only be used inside XRMesh or ForEachXRMesh");return e}(),r=function(e){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const[i,r]=(0,t.useState)(ny(e,void 0));return Op((()=>r((t=>ny(e,t))))),(0,t.useEffect)((()=>{if(n)return()=>i.dispose()}),[i]),i}(i);return(0,I.jsx)("mesh",{ref:n,geometry:r,...e})}));(0,t.forwardRef)(((e,n)=>{const i=function(){const e=(0,t.useContext)(Sy);if(null==e)throw new Error("useXRPlane can only be used inside XRPlane or ForEachXRPlane");return e}(),r=function(e){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const[i,r]=(0,t.useState)(iy(e,void 0));return Op((()=>r((t=>iy(e,t))))),(0,t.useEffect)((()=>{if(n)return()=>i.dispose()}),[i]),i}(i);return(0,I.jsx)("mesh",{ref:n,geometry:r,...e})}));const Bb=(0,t.forwardRef)(((e,n)=>{let{children:i,...r}=e;const s=_p((e=>e.gl.xr.getCamera())),o=_p((e=>e.gl.xr)),a=(0,t.useCallback)((()=>o.getReferenceSpace()),[o]);return(0,I.jsxs)("group",{ref:n,...r,children:[(0,I.jsx)("primitive",{object:s}),(0,I.jsx)(Zy.Provider,{value:a,children:i})]})})),vb=(0,t.forwardRef)(((e,n)=>{let{store:i,mode:r,onError:s,options:o,children:a,...l}=e;const c=u(i,(e=>e.session)),g=function(e,n){const i=(0,t.useRef)(n);i.current=n;const[r,s]=(0,t.useMemo)((()=>{let t;return[n=>{let r=!1;return null==navigator.xr?(t=!1,()=>{}):(navigator.xr.isSessionSupported(e).then((e=>{t=e,r||n()})).catch((e=>{var t;r||null===(t=i.current)||void 0===t||t.call(i,e)})),()=>r=!0)},()=>t]}),[e]);return(0,t.useSyncExternalStore)(r,s)}(r,s);return(0,I.jsx)("button",{ref:n,...l,onClick:()=>null!=c?c.end():i.enterXR(r,o).catch(s),children:"function"===typeof a?a(g?null!=c?"entered":"exited":"unsupported"):a})})),wb=((0,t.forwardRef)(((e,t)=>(0,I.jsx)(vb,{ref:t,mode:"immersive-ar",...e}))),(0,t.forwardRef)(((e,t)=>(0,I.jsx)(vb,{ref:t,mode:"immersive-vr",...e}))),{onBlur:"pointerleave",onHover:"pointerenter",onMove:"pointermove",onSelect:{type:"click",filter:e=>"ray"===e.pointerType},onSelectEnd:{type:"pointerup",filter:e=>"ray"===e.pointerType},onSelectStart:{type:"pointerdown",filter:e=>"ray"===e.pointerType},onSqueeze:{type:"click",filter:e=>"grab"===e.pointerType},onSqueezeEnd:{type:"pointerup",filter:e=>"grab"===e.pointerType},onSqueezeStart:{type:"pointerdown",filter:e=>"grab"===e.pointerType}});function Gb(e,n,i){const r=(0,t.useRef)(i);r.current=i,(0,t.useEffect)((()=>{const{current:t}=e;if(null==t)return;const i=wb[n],s="string"===typeof i?e=>{var t;return null===(t=r.current)||void 0===t?void 0:t.call(r,{intersection:e,intersections:[e],target:e.pointerState})}:e=>{var t;e instanceof sf&&!i.filter(e)||null===(t=r.current)||void 0===t||t.call(r,{intersection:e,intersections:[e],target:e.pointerState})},o="string"===typeof i?i:i.type;return t.addEventListener(o,s),()=>t.removeEventListener(o,s)}),[e,n])}const Eb=(0,t.forwardRef)(((e,n)=>{let{onHover:i,onBlur:r,onSelectStart:s,onSelectEnd:o,onSelect:a,onSqueezeStart:l,onSqueezeEnd:c,onSqueeze:g,onMove:u,children:A}=e;const d=(0,t.useRef)(null);return(0,t.useImperativeHandle)(n,(()=>d.current)),Gb(d,"onHover",i),Gb(d,"onBlur",r),Gb(d,"onSelectStart",s),Gb(d,"onSelectEnd",o),Gb(d,"onSelect",a),Gb(d,"onSqueezeStart",l),Gb(d,"onSqueezeEnd",c),Gb(d,"onSqueeze",g),Gb(d,"onMove",u),(0,I.jsx)("group",{ref:d,children:A})})),xb=((0,t.forwardRef)((function(e,n){let{onSelectStart:i,onSelectEnd:r,children:s,...o}=e;const a=(0,t.useRef)(),l=(0,t.useRef)(null),c=(0,t.useMemo)((()=>new rs),[]);return(0,t.useImperativeHandle)(n,(()=>l.current)),Op((()=>{const e=a.current,t=l.current;t&&e&&(t.applyMatrix4(c),t.applyMatrix4(e.matrixWorld),t.updateMatrixWorld(),c.copy(e.matrixWorld).invert())})),(0,I.jsx)(Eb,{ref:l,onSelectStart:e=>{var t;null==(t=e.target)||"object"!==typeof t||!("type"in t)||"controller"!==e.target.type&&"hand"!==e.target.type||null==e.target.object||(a.current=e.target.object,c.copy(e.target.object.matrixWorld).invert(),null===i||void 0===i||i(e))},onSelectEnd:e=>{e.target.controller===a.current&&(a.current=void 0),null===r||void 0===r||r(e)},...o,children:s})})),100),Sb=500;function Rb(e){let{position:n}=e;const{camera:i}=_p(),[r,s]=(0,t.useState)(0),[o,a]=(0,t.useState)(0);(0,t.useEffect)((()=>{n&&i.position.set(n[0],n[1],n[2])}),[n,i]),(0,t.useEffect)((()=>{window.camera=i}),[i]);const l=uC("ShiftLeft"),c=uC("w"),g=uC("s"),u=uC("a"),A=uC("d"),d=uC("e"),h=uC("q"),I=uC("l"),p=uC("k"),C=uC("i"),m=uC("j"),f=(0,t.useCallback)((e=>{const t=new Sr;i.getWorldDirection(t),t.y=0,t.normalize(),i.position.addScaledVector(t,e)}),[i]),y=(0,t.useCallback)((e=>{const t=new Sr;i.getWorldDirection(t),t.y=0,t.normalize(),t.cross(i.up),i.position.addScaledVector(t,e)}),[i]),b=(0,t.useCallback)((e=>{i.position.y+=e}),[i]),B=(0,t.useCallback)(((e,t)=>{s((t=>t+e)),a((e=>Math.max(-Math.PI/2,Math.min(Math.PI/2,e+t))))}),[]);return Op(((e,t)=>{const n=l?Sb:xb,s=1*t;c&&f(t*n),g&&f(-t*n),A&&y(t*n),u&&y(-t*n),d&&b(t*n),h&&b(-t*n),I&&B(-s,0),m&&B(s,0),p&&B(0,-s),C&&B(0,s),i.rotation.set(o,r,0,"YXZ")})),null}function Zb(e){let{name:n="train",interval:i=1}=e;const{scene:r,camera:s}=_p(),[o,a]=(0,t.useState)(),l=(0,t.useRef)();return(0,t.useEffect)((()=>{const e=setInterval((()=>{const t=r.getObjectByName(n);t&&(clearInterval(e),l.current=t,a((e=>t)))}),i)}),[n]),(0,t.useEffect)((()=>(l.current&&l.current.add(s),()=>{l.current&&l.current.remove(s)})),[l.current,o]),null}function Db(){return Db=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Db.apply(null,arguments)}var Fb=Object.defineProperty,Nb=(e,t,n)=>(((e,t,n)=>{t in e?Fb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!==typeof t?t+"":t,n),n);const Mb=new is,Wb=new ra,kb=Math.cos(Math.PI/180*70),Tb=(e,t)=>(e%t+t)%t;class Vb extends Wi{constructor(e,t){super(),Nb(this,"object"),Nb(this,"domElement"),Nb(this,"enabled",!0),Nb(this,"target",new Sr),Nb(this,"minDistance",0),Nb(this,"maxDistance",1/0),Nb(this,"minZoom",0),Nb(this,"maxZoom",1/0),Nb(this,"minPolarAngle",0),Nb(this,"maxPolarAngle",Math.PI),Nb(this,"minAzimuthAngle",-1/0),Nb(this,"maxAzimuthAngle",1/0),Nb(this,"enableDamping",!1),Nb(this,"dampingFactor",.05),Nb(this,"enableZoom",!0),Nb(this,"zoomSpeed",1),Nb(this,"enableRotate",!0),Nb(this,"rotateSpeed",1),Nb(this,"enablePan",!0),Nb(this,"panSpeed",1),Nb(this,"screenSpacePanning",!0),Nb(this,"keyPanSpeed",7),Nb(this,"zoomToCursor",!1),Nb(this,"autoRotate",!1),Nb(this,"autoRotateSpeed",2),Nb(this,"reverseOrbit",!1),Nb(this,"reverseHorizontalOrbit",!1),Nb(this,"reverseVerticalOrbit",!1),Nb(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Nb(this,"mouseButtons",{LEFT:J.ROTATE,MIDDLE:J.DOLLY,RIGHT:J.PAN}),Nb(this,"touches",{ONE:j.ROTATE,TWO:j.DOLLY_PAN}),Nb(this,"target0"),Nb(this,"position0"),Nb(this,"zoom0"),Nb(this,"_domElementKeyEvents",null),Nb(this,"getPolarAngle"),Nb(this,"getAzimuthalAngle"),Nb(this,"setPolarAngle"),Nb(this,"setAzimuthalAngle"),Nb(this,"getDistance"),Nb(this,"listenToKeyEvents"),Nb(this,"stopListenToKeyEvents"),Nb(this,"saveState"),Nb(this,"reset"),Nb(this,"update"),Nb(this,"connect"),Nb(this,"dispose"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>c.phi,this.getAzimuthalAngle=()=>c.theta,this.setPolarAngle=e=>{let t=Tb(e,2*Math.PI),i=c.phi;i<0&&(i+=2*Math.PI),t<0&&(t+=2*Math.PI);let r=Math.abs(t-i);2*Math.PI-r<r&&(t<i?t+=2*Math.PI:i+=2*Math.PI),g.phi=t-i,n.update()},this.setAzimuthalAngle=e=>{let t=Tb(e,2*Math.PI),i=c.theta;i<0&&(i+=2*Math.PI),t<0&&(t+=2*Math.PI);let r=Math.abs(t-i);2*Math.PI-r<r&&(t<i?t+=2*Math.PI:i+=2*Math.PI),g.theta=t-i,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=e=>{e.addEventListener("keydown",O),this._domElementKeyEvents=e},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",O),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(i),n.update(),a=o.NONE},this.update=(()=>{const t=new Sr,r=new Sr(0,1,0),s=(new xr).setFromUnitVectors(e.up,r),d=s.clone().invert(),h=new Sr,I=new xr,p=2*Math.PI;return function(){const C=n.object.position;s.setFromUnitVectors(e.up,r),d.copy(s).invert(),t.copy(C).sub(n.target),t.applyQuaternion(s),c.setFromVector3(t),n.autoRotate&&a===o.NONE&&S(2*Math.PI/60/60*n.autoRotateSpeed),n.enableDamping?(c.theta+=g.theta*n.dampingFactor,c.phi+=g.phi*n.dampingFactor):(c.theta+=g.theta,c.phi+=g.phi);let m=n.minAzimuthAngle,f=n.maxAzimuthAngle;isFinite(m)&&isFinite(f)&&(m<-Math.PI?m+=p:m>Math.PI&&(m-=p),f<-Math.PI?f+=p:f>Math.PI&&(f-=p),c.theta=m<=f?Math.max(m,Math.min(f,c.theta)):c.theta>(m+f)/2?Math.max(m,c.theta):Math.min(f,c.theta)),c.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,c.phi)),c.makeSafe(),!0===n.enableDamping?n.target.addScaledVector(A,n.dampingFactor):n.target.add(A),n.zoomToCursor&&w||n.object.isOrthographicCamera?c.radius=k(c.radius):c.radius=k(c.radius*u),t.setFromSpherical(c),t.applyQuaternion(d),C.copy(n.target).add(t),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),!0===n.enableDamping?(g.theta*=1-n.dampingFactor,g.phi*=1-n.dampingFactor,A.multiplyScalar(1-n.dampingFactor)):(g.set(0,0,0),A.set(0,0,0));let y=!1;if(n.zoomToCursor&&w){let i=null;if(n.object instanceof Jo&&n.object.isPerspectiveCamera){const e=t.length();i=k(e*u);const r=e-i;n.object.position.addScaledVector(B,r),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const e=new Sr(v.x,v.y,0);e.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/u)),n.object.updateProjectionMatrix(),y=!0;const r=new Sr(v.x,v.y,0);r.unproject(n.object),n.object.position.sub(r).add(e),n.object.updateMatrixWorld(),i=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;null!==i&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(i).add(n.object.position):(Mb.origin.copy(n.object.position),Mb.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(Mb.direction))<kb?e.lookAt(n.target):(Wb.setFromNormalAndCoplanarPoint(n.object.up,n.target),Mb.intersectPlane(Wb,n.target))))}else n.object instanceof ba&&n.object.isOrthographicCamera&&(y=1!==u,y&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/u)),n.object.updateProjectionMatrix()));return u=1,w=!1,!!(y||h.distanceToSquared(n.object.position)>l||8*(1-I.dot(n.object.quaternion))>l)&&(n.dispatchEvent(i),h.copy(n.object.position),I.copy(n.object.quaternion),y=!1,!0)}})(),this.connect=e=>{e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),n.domElement=e,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",q),n.domElement.addEventListener("pointerdown",z),n.domElement.addEventListener("pointercancel",U),n.domElement.addEventListener("wheel",_)},this.dispose=()=>{var e,t,i,r,s,o;n.domElement&&(n.domElement.style.touchAction="auto"),null==(e=n.domElement)||e.removeEventListener("contextmenu",q),null==(t=n.domElement)||t.removeEventListener("pointerdown",z),null==(i=n.domElement)||i.removeEventListener("pointercancel",U),null==(r=n.domElement)||r.removeEventListener("wheel",_),null==(s=n.domElement)||s.ownerDocument.removeEventListener("pointermove",P),null==(o=n.domElement)||o.ownerDocument.removeEventListener("pointerup",U),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",O)};const n=this,i={type:"change"},r={type:"start"},s={type:"end"},o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let a=o.NONE;const l=1e-6,c=new tI,g=new tI;let u=1;const A=new Sr,d=new Oi,h=new Oi,I=new Oi,p=new Oi,C=new Oi,m=new Oi,f=new Oi,y=new Oi,b=new Oi,B=new Sr,v=new Oi;let w=!1;const G=[],E={};function x(){return Math.pow(.95,n.zoomSpeed)}function S(e){n.reverseOrbit||n.reverseHorizontalOrbit?g.theta+=e:g.theta-=e}function R(e){n.reverseOrbit||n.reverseVerticalOrbit?g.phi+=e:g.phi-=e}const Z=(()=>{const e=new Sr;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),A.add(e)}})(),D=(()=>{const e=new Sr;return function(t,i){!0===n.screenSpacePanning?e.setFromMatrixColumn(i,1):(e.setFromMatrixColumn(i,0),e.crossVectors(n.object.up,e)),e.multiplyScalar(t),A.add(e)}})(),F=(()=>{const e=new Sr;return function(t,i){const r=n.domElement;if(r&&n.object instanceof Jo&&n.object.isPerspectiveCamera){const s=n.object.position;e.copy(s).sub(n.target);let o=e.length();o*=Math.tan(n.object.fov/2*Math.PI/180),Z(2*t*o/r.clientHeight,n.object.matrix),D(2*i*o/r.clientHeight,n.object.matrix)}else r&&n.object instanceof ba&&n.object.isOrthographicCamera?(Z(t*(n.object.right-n.object.left)/n.object.zoom/r.clientWidth,n.object.matrix),D(i*(n.object.top-n.object.bottom)/n.object.zoom/r.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function N(e){n.object instanceof Jo&&n.object.isPerspectiveCamera||n.object instanceof ba&&n.object.isOrthographicCamera?u/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function M(e){n.object instanceof Jo&&n.object.isPerspectiveCamera||n.object instanceof ba&&n.object.isOrthographicCamera?u*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function W(e){if(!n.zoomToCursor||!n.domElement)return;w=!0;const t=n.domElement.getBoundingClientRect(),i=e.clientX-t.left,r=e.clientY-t.top,s=t.width,o=t.height;v.x=i/s*2-1,v.y=-r/o*2+1,B.set(v.x,v.y,1).unproject(n.object).sub(n.object.position).normalize()}function k(e){return Math.max(n.minDistance,Math.min(n.maxDistance,e))}function T(e){d.set(e.clientX,e.clientY)}function V(e){p.set(e.clientX,e.clientY)}function L(){if(1==G.length)d.set(G[0].pageX,G[0].pageY);else{const e=.5*(G[0].pageX+G[1].pageX),t=.5*(G[0].pageY+G[1].pageY);d.set(e,t)}}function H(){if(1==G.length)p.set(G[0].pageX,G[0].pageY);else{const e=.5*(G[0].pageX+G[1].pageX),t=.5*(G[0].pageY+G[1].pageY);p.set(e,t)}}function Q(){const e=G[0].pageX-G[1].pageX,t=G[0].pageY-G[1].pageY,n=Math.sqrt(e*e+t*t);f.set(0,n)}function K(e){if(1==G.length)h.set(e.pageX,e.pageY);else{const t=ee(e),n=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);h.set(n,i)}I.subVectors(h,d).multiplyScalar(n.rotateSpeed);const t=n.domElement;t&&(S(2*Math.PI*I.x/t.clientHeight),R(2*Math.PI*I.y/t.clientHeight)),d.copy(h)}function X(e){if(1==G.length)C.set(e.pageX,e.pageY);else{const t=ee(e),n=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);C.set(n,i)}m.subVectors(C,p).multiplyScalar(n.panSpeed),F(m.x,m.y),p.copy(C)}function Y(e){const t=ee(e),i=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(i*i+r*r);y.set(0,s),b.set(0,Math.pow(y.y/f.y,n.zoomSpeed)),N(b.y),f.copy(y)}function z(e){var t,i;!1!==n.enabled&&(0===G.length&&(null==(t=n.domElement)||t.ownerDocument.addEventListener("pointermove",P),null==(i=n.domElement)||i.ownerDocument.addEventListener("pointerup",U)),function(e){G.push(e)}(e),"touch"===e.pointerType?function(e){switch($(e),G.length){case 1:switch(n.touches.ONE){case j.ROTATE:if(!1===n.enableRotate)return;L(),a=o.TOUCH_ROTATE;break;case j.PAN:if(!1===n.enablePan)return;H(),a=o.TOUCH_PAN;break;default:a=o.NONE}break;case 2:switch(n.touches.TWO){case j.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;n.enableZoom&&Q(),n.enablePan&&H(),a=o.TOUCH_DOLLY_PAN;break;case j.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;n.enableZoom&&Q(),n.enableRotate&&L(),a=o.TOUCH_DOLLY_ROTATE;break;default:a=o.NONE}break;default:a=o.NONE}a!==o.NONE&&n.dispatchEvent(r)}(e):function(e){let t;switch(e.button){case 0:t=n.mouseButtons.LEFT;break;case 1:t=n.mouseButtons.MIDDLE;break;case 2:t=n.mouseButtons.RIGHT;break;default:t=-1}switch(t){case J.DOLLY:if(!1===n.enableZoom)return;!function(e){W(e),f.set(e.clientX,e.clientY)}(e),a=o.DOLLY;break;case J.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enablePan)return;V(e),a=o.PAN}else{if(!1===n.enableRotate)return;T(e),a=o.ROTATE}break;case J.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enableRotate)return;T(e),a=o.ROTATE}else{if(!1===n.enablePan)return;V(e),a=o.PAN}break;default:a=o.NONE}a!==o.NONE&&n.dispatchEvent(r)}(e))}function P(e){!1!==n.enabled&&("touch"===e.pointerType?function(e){switch($(e),a){case o.TOUCH_ROTATE:if(!1===n.enableRotate)return;K(e),n.update();break;case o.TOUCH_PAN:if(!1===n.enablePan)return;X(e),n.update();break;case o.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;!function(e){n.enableZoom&&Y(e),n.enablePan&&X(e)}(e),n.update();break;case o.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;!function(e){n.enableZoom&&Y(e),n.enableRotate&&K(e)}(e),n.update();break;default:a=o.NONE}}(e):function(e){if(!1===n.enabled)return;switch(a){case o.ROTATE:if(!1===n.enableRotate)return;!function(e){h.set(e.clientX,e.clientY),I.subVectors(h,d).multiplyScalar(n.rotateSpeed);const t=n.domElement;t&&(S(2*Math.PI*I.x/t.clientHeight),R(2*Math.PI*I.y/t.clientHeight)),d.copy(h),n.update()}(e);break;case o.DOLLY:if(!1===n.enableZoom)return;!function(e){y.set(e.clientX,e.clientY),b.subVectors(y,f),b.y>0?N(x()):b.y<0&&M(x()),f.copy(y),n.update()}(e);break;case o.PAN:if(!1===n.enablePan)return;!function(e){C.set(e.clientX,e.clientY),m.subVectors(C,p).multiplyScalar(n.panSpeed),F(m.x,m.y),p.copy(C),n.update()}(e)}}(e))}function U(e){var t,i,r;!function(e){delete E[e.pointerId];for(let t=0;t<G.length;t++)if(G[t].pointerId==e.pointerId)return void G.splice(t,1)}(e),0===G.length&&(null==(t=n.domElement)||t.releasePointerCapture(e.pointerId),null==(i=n.domElement)||i.ownerDocument.removeEventListener("pointermove",P),null==(r=n.domElement)||r.ownerDocument.removeEventListener("pointerup",U)),n.dispatchEvent(s),a=o.NONE}function _(e){!1===n.enabled||!1===n.enableZoom||a!==o.NONE&&a!==o.ROTATE||(e.preventDefault(),n.dispatchEvent(r),function(e){W(e),e.deltaY<0?M(x()):e.deltaY>0&&N(x()),n.update()}(e),n.dispatchEvent(s))}function O(e){!1!==n.enabled&&!1!==n.enablePan&&function(e){let t=!1;switch(e.code){case n.keys.UP:F(0,n.keyPanSpeed),t=!0;break;case n.keys.BOTTOM:F(0,-n.keyPanSpeed),t=!0;break;case n.keys.LEFT:F(n.keyPanSpeed,0),t=!0;break;case n.keys.RIGHT:F(-n.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),n.update())}(e)}function q(e){!1!==n.enabled&&e.preventDefault()}function $(e){let t=E[e.pointerId];void 0===t&&(t=new Oi,E[e.pointerId]=t),t.set(e.pageX,e.pageY)}function ee(e){const t=e.pointerId===G[0].pointerId?G[1]:G[0];return E[t.pointerId]}void 0!==t&&this.connect(t),this.update()}}const Lb=t.forwardRef(((e,n)=>{let{makeDefault:i,camera:r,regress:s,domElement:o,enableDamping:a=!0,keyEvents:l=!1,onChange:c,onStart:g,onEnd:u,...A}=e;const d=_p((e=>e.invalidate)),h=_p((e=>e.camera)),I=_p((e=>e.gl)),p=_p((e=>e.events)),C=_p((e=>e.setEvents)),m=_p((e=>e.set)),f=_p((e=>e.get)),y=_p((e=>e.performance)),b=r||h,B=o||p.connected||I.domElement,v=t.useMemo((()=>new Vb(b)),[b]);return Op((()=>{v.enabled&&v.update()}),-1),t.useEffect((()=>(l&&v.connect(!0===l?B:l),v.connect(B),()=>{v.dispose()})),[l,B,s,v,d]),t.useEffect((()=>{const e=e=>{d(),s&&y.regress(),c&&c(e)},t=e=>{g&&g(e)},n=e=>{u&&u(e)};return v.addEventListener("change",e),v.addEventListener("start",t),v.addEventListener("end",n),()=>{v.removeEventListener("start",t),v.removeEventListener("end",n),v.removeEventListener("change",e)}}),[c,g,u,v,d,C]),t.useEffect((()=>{if(i){const e=f().controls;return m({controls:v}),()=>m({controls:e})}}),[i,v]),t.createElement("primitive",Db({ref:n,object:v,enableDamping:a},A))}));function Hb(e){let{position:n,targetPosition:i}=e;const{camera:r}=_p(),s=(0,t.useRef)();return(0,t.useEffect)((()=>{var e,t;n&&(null===r||void 0===r||r.position.set(n[0],n[1],n[2]),i?null===(e=s.current)||void 0===e||e.target.set(i[0],i[1],i[2]):null===(t=s.current)||void 0===t||t.target.set(0,0,0))}),[n]),(0,t.useEffect)((()=>{window.orbitControls=null===s||void 0===s?void 0:s.current}),[s]),(0,t.useEffect)((()=>{window.camera=r}),[r]),(0,I.jsx)(Lb,{ref:s})}var Qb,Kb={exports:{}},Xb="object"===typeof Reflect?Reflect:null,Yb=Xb&&"function"===typeof Xb.apply?Xb.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};Qb=Xb&&"function"===typeof Xb.ownKeys?Xb.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var zb=Number.isNaN||function(e){return e!==e};function Pb(){Pb.init.call(this)}Kb.exports=Pb,Kb.exports.once=function(e,t){return new Promise((function(n,i){function r(n){e.removeListener(t,s),i(n)}function s(){"function"===typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}nB(e,t,s,{once:!0}),"error"!==t&&function(e,t,n){"function"===typeof e.on&&nB(e,"error",t,n)}(e,r,{once:!0})}))},Pb.EventEmitter=Pb,Pb.prototype._events=void 0,Pb.prototype._eventsCount=0,Pb.prototype._maxListeners=void 0;var Ub=10;function _b(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function Ob(e){return void 0===e._maxListeners?Pb.defaultMaxListeners:e._maxListeners}function Jb(e,t,n,i){var r,s,o,a;if(_b(n),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),o=s[t]),void 0===o)o=s[t]=n,++e._eventsCount;else if("function"===typeof o?o=s[t]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),(r=Ob(e))>0&&o.length>r&&!o.warned){o.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=o.length,a=l,console&&console.warn&&console.warn(a)}return e}function jb(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function qb(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=jb.bind(i);return r.listener=n,i.wrapFn=r,r}function $b(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"===typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):tB(r,r.length)}function eB(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function tB(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function nB(e,t,n,i){if("function"===typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(s){i.once&&e.removeEventListener(t,r),n(s)}))}}Object.defineProperty(Pb,"defaultMaxListeners",{enumerable:!0,get:function(){return Ub},set:function(e){if("number"!==typeof e||e<0||zb(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Ub=e}}),Pb.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Pb.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||zb(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},Pb.prototype.getMaxListeners=function(){return Ob(this)},Pb.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var a=r[e];if(void 0===a)return!1;if("function"===typeof a)Yb(a,this,t);else{var l=a.length,c=tB(a,l);for(n=0;n<l;++n)Yb(c[n],this,t)}return!0},Pb.prototype.addListener=function(e,t){return Jb(this,e,t,!1)},Pb.prototype.on=Pb.prototype.addListener,Pb.prototype.prependListener=function(e,t){return Jb(this,e,t,!0)},Pb.prototype.once=function(e,t){return _b(t),this.on(e,qb(this,e,t)),this},Pb.prototype.prependOnceListener=function(e,t){return _b(t),this.prependListener(e,qb(this,e,t)),this},Pb.prototype.removeListener=function(e,t){var n,i,r,s,o;if(_b(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!==typeof n){for(r=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){o=n[s].listener,r=s;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,o||t)}return this},Pb.prototype.off=Pb.prototype.removeListener,Pb.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,s=Object.keys(n);for(i=0;i<s.length;++i)"removeListener"!==(r=s[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},Pb.prototype.listeners=function(e){return $b(this,e,!0)},Pb.prototype.rawListeners=function(e){return $b(this,e,!1)},Pb.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):eB.call(e,t)},Pb.prototype.listenerCount=eB,Pb.prototype.eventNames=function(){return this._eventsCount>0?Qb(this._events):[]};var iB=Kb.exports;function rB(e,t,n){var i=void 0===t?null:t,r=function(e,t){var n=atob(e);if(t){for(var i=new Uint8Array(n.length),r=0,s=n.length;r<s;++r)i[r]=n.charCodeAt(r);return String.fromCharCode.apply(null,new Uint16Array(i.buffer))}return n}(e,void 0!==n&&n),s=r.indexOf("\n",10)+1,o=r.substring(s)+(i?"//# sourceMappingURL="+i:""),a=new Blob([o],{type:"application/javascript"});return URL.createObjectURL(a)}var sB=function(e,t,n){var i;return function(r){return i=i||rB(e,t,n),new Worker(i,r)}}("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgLyoqCiAgICogUmVjb3JkcyB3aGF0IG9iamVjdHMgYXJlIGNvbGxpZGluZyB3aXRoIGVhY2ggb3RoZXIKICAgKi8KCiAgLyoqCiAgICogQSAzeDMgbWF0cml4LgogICAqIEF1dGhvcmVkIGJ5IHtAbGluayBodHRwOi8vZ2l0aHViLmNvbS9zY2h0ZXBwZS8gc2NodGVwcGV9CiAgICovCiAgY2xhc3MgTWF0MyB7CiAgICAvKioKICAgICAqIEEgdmVjdG9yIG9mIGxlbmd0aCA5LCBjb250YWluaW5nIGFsbCBtYXRyaXggZWxlbWVudHMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEBwYXJhbSBlbGVtZW50cyBBIHZlY3RvciBvZiBsZW5ndGggOSwgY29udGFpbmluZyBhbGwgbWF0cml4IGVsZW1lbnRzLgogICAgICovCiAgICBjb25zdHJ1Y3RvcihlbGVtZW50cykgewogICAgICBpZiAoZWxlbWVudHMgPT09IHZvaWQgMCkgewogICAgICAgIGVsZW1lbnRzID0gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdOwogICAgICB9CgogICAgICB0aGlzLmVsZW1lbnRzID0gZWxlbWVudHM7CiAgICB9CiAgICAvKioKICAgICAqIFNldHMgdGhlIG1hdHJpeCB0byBpZGVudGl0eQogICAgICogQHRvZG8gU2hvdWxkIHBlcmhhcHMgYmUgcmVuYW1lZCB0byBgc2V0SWRlbnRpdHkoKWAgdG8gYmUgbW9yZSBjbGVhci4KICAgICAqIEB0b2RvIENyZWF0ZSBhbm90aGVyIGZ1bmN0aW9uIHRoYXQgaW1tZWRpYXRlbHkgY3JlYXRlcyBhbiBpZGVudGl0eSBtYXRyaXggZWcuIGBleWUoKWAKICAgICAqLwoKCiAgICBpZGVudGl0eSgpIHsKICAgICAgY29uc3QgZSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIGVbMF0gPSAxOwogICAgICBlWzFdID0gMDsKICAgICAgZVsyXSA9IDA7CiAgICAgIGVbM10gPSAwOwogICAgICBlWzRdID0gMTsKICAgICAgZVs1XSA9IDA7CiAgICAgIGVbNl0gPSAwOwogICAgICBlWzddID0gMDsKICAgICAgZVs4XSA9IDE7CiAgICB9CiAgICAvKioKICAgICAqIFNldCBhbGwgZWxlbWVudHMgdG8gemVybwogICAgICovCgoKICAgIHNldFplcm8oKSB7CiAgICAgIGNvbnN0IGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICBlWzBdID0gMDsKICAgICAgZVsxXSA9IDA7CiAgICAgIGVbMl0gPSAwOwogICAgICBlWzNdID0gMDsKICAgICAgZVs0XSA9IDA7CiAgICAgIGVbNV0gPSAwOwogICAgICBlWzZdID0gMDsKICAgICAgZVs3XSA9IDA7CiAgICAgIGVbOF0gPSAwOwogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIHRoZSBtYXRyaXggZGlhZ29uYWwgZWxlbWVudHMgZnJvbSBhIFZlYzMKICAgICAqLwoKCiAgICBzZXRUcmFjZSh2ZWN0b3IpIHsKICAgICAgY29uc3QgZSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIGVbMF0gPSB2ZWN0b3IueDsKICAgICAgZVs0XSA9IHZlY3Rvci55OwogICAgICBlWzhdID0gdmVjdG9yLno7CiAgICB9CiAgICAvKioKICAgICAqIEdldHMgdGhlIG1hdHJpeCBkaWFnb25hbCBlbGVtZW50cwogICAgICovCgoKICAgIGdldFRyYWNlKHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCBlID0gdGhpcy5lbGVtZW50czsKICAgICAgdGFyZ2V0LnggPSBlWzBdOwogICAgICB0YXJnZXQueSA9IGVbNF07CiAgICAgIHRhcmdldC56ID0gZVs4XTsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogTWF0cml4LVZlY3RvciBtdWx0aXBsaWNhdGlvbgogICAgICogQHBhcmFtIHYgVGhlIHZlY3RvciB0byBtdWx0aXBseSB3aXRoCiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsLCB0YXJnZXQgdG8gc2F2ZSB0aGUgcmVzdWx0IGluLgogICAgICovCgoKICAgIHZtdWx0KHYsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCBlID0gdGhpcy5lbGVtZW50czsKICAgICAgY29uc3QgeCA9IHYueDsKICAgICAgY29uc3QgeSA9IHYueTsKICAgICAgY29uc3QgeiA9IHYuejsKICAgICAgdGFyZ2V0LnggPSBlWzBdICogeCArIGVbMV0gKiB5ICsgZVsyXSAqIHo7CiAgICAgIHRhcmdldC55ID0gZVszXSAqIHggKyBlWzRdICogeSArIGVbNV0gKiB6OwogICAgICB0YXJnZXQueiA9IGVbNl0gKiB4ICsgZVs3XSAqIHkgKyBlWzhdICogejsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogTWF0cml4LXNjYWxhciBtdWx0aXBsaWNhdGlvbgogICAgICovCgoKICAgIHNtdWx0KHMpIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGhpcy5lbGVtZW50c1tpXSAqPSBzOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIE1hdHJpeCBtdWx0aXBsaWNhdGlvbgogICAgICogQHBhcmFtIG1hdHJpeCBNYXRyaXggdG8gbXVsdGlwbHkgd2l0aCBmcm9tIGxlZnQgc2lkZS4KICAgICAqLwoKCiAgICBtbXVsdChtYXRyaXgsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgTWF0MygpOwogICAgICB9CgogICAgICBjb25zdCBBID0gdGhpcy5lbGVtZW50czsKICAgICAgY29uc3QgQiA9IG1hdHJpeC5lbGVtZW50czsKICAgICAgY29uc3QgVCA9IHRhcmdldC5lbGVtZW50czsKICAgICAgY29uc3QgYTExID0gQVswXSwKICAgICAgICAgICAgYTEyID0gQVsxXSwKICAgICAgICAgICAgYTEzID0gQVsyXSwKICAgICAgICAgICAgYTIxID0gQVszXSwKICAgICAgICAgICAgYTIyID0gQVs0XSwKICAgICAgICAgICAgYTIzID0gQVs1XSwKICAgICAgICAgICAgYTMxID0gQVs2XSwKICAgICAgICAgICAgYTMyID0gQVs3XSwKICAgICAgICAgICAgYTMzID0gQVs4XTsKICAgICAgY29uc3QgYjExID0gQlswXSwKICAgICAgICAgICAgYjEyID0gQlsxXSwKICAgICAgICAgICAgYjEzID0gQlsyXSwKICAgICAgICAgICAgYjIxID0gQlszXSwKICAgICAgICAgICAgYjIyID0gQls0XSwKICAgICAgICAgICAgYjIzID0gQls1XSwKICAgICAgICAgICAgYjMxID0gQls2XSwKICAgICAgICAgICAgYjMyID0gQls3XSwKICAgICAgICAgICAgYjMzID0gQls4XTsKICAgICAgVFswXSA9IGExMSAqIGIxMSArIGExMiAqIGIyMSArIGExMyAqIGIzMTsKICAgICAgVFsxXSA9IGExMSAqIGIxMiArIGExMiAqIGIyMiArIGExMyAqIGIzMjsKICAgICAgVFsyXSA9IGExMSAqIGIxMyArIGExMiAqIGIyMyArIGExMyAqIGIzMzsKICAgICAgVFszXSA9IGEyMSAqIGIxMSArIGEyMiAqIGIyMSArIGEyMyAqIGIzMTsKICAgICAgVFs0XSA9IGEyMSAqIGIxMiArIGEyMiAqIGIyMiArIGEyMyAqIGIzMjsKICAgICAgVFs1XSA9IGEyMSAqIGIxMyArIGEyMiAqIGIyMyArIGEyMyAqIGIzMzsKICAgICAgVFs2XSA9IGEzMSAqIGIxMSArIGEzMiAqIGIyMSArIGEzMyAqIGIzMTsKICAgICAgVFs3XSA9IGEzMSAqIGIxMiArIGEzMiAqIGIyMiArIGEzMyAqIGIzMjsKICAgICAgVFs4XSA9IGEzMSAqIGIxMyArIGEzMiAqIGIyMyArIGEzMyAqIGIzMzsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogU2NhbGUgZWFjaCBjb2x1bW4gb2YgdGhlIG1hdHJpeAogICAgICovCgoKICAgIHNjYWxlKHZlY3RvciwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBNYXQzKCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICBjb25zdCB0ID0gdGFyZ2V0LmVsZW1lbnRzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IDM7IGkrKykgewogICAgICAgIHRbMyAqIGkgKyAwXSA9IHZlY3Rvci54ICogZVszICogaSArIDBdOwogICAgICAgIHRbMyAqIGkgKyAxXSA9IHZlY3Rvci55ICogZVszICogaSArIDFdOwogICAgICAgIHRbMyAqIGkgKyAyXSA9IHZlY3Rvci56ICogZVszICogaSArIDJdOwogICAgICB9CgogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBTb2x2ZSBBeD1iCiAgICAgKiBAcGFyYW0gYiBUaGUgcmlnaHQgaGFuZCBzaWRlCiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsLiBUYXJnZXQgdmVjdG9yIHRvIHNhdmUgaW4uCiAgICAgKiBAcmV0dXJuIFRoZSBzb2x1dGlvbiB4CiAgICAgKiBAdG9kbyBzaG91bGQgcmV1c2UgYXJyYXlzCiAgICAgKi8KCgogICAgc29sdmUoYiwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIC8vIENvbnN0cnVjdCBlcXVhdGlvbnMKICAgICAgY29uc3QgbnIgPSAzOyAvLyBudW0gcm93cwoKICAgICAgY29uc3QgbmMgPSA0OyAvLyBudW0gY29scwoKICAgICAgY29uc3QgZXFucyA9IFtdOwogICAgICBsZXQgaTsKICAgICAgbGV0IGo7CgogICAgICBmb3IgKGkgPSAwOyBpIDwgbnIgKiBuYzsgaSsrKSB7CiAgICAgICAgZXFucy5wdXNoKDApOwogICAgICB9CgogICAgICBmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKSB7CiAgICAgICAgZm9yIChqID0gMDsgaiA8IDM7IGorKykgewogICAgICAgICAgZXFuc1tpICsgbmMgKiBqXSA9IHRoaXMuZWxlbWVudHNbaSArIDMgKiBqXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGVxbnNbMyArIDQgKiAwXSA9IGIueDsKICAgICAgZXFuc1szICsgNCAqIDFdID0gYi55OwogICAgICBlcW5zWzMgKyA0ICogMl0gPSBiLno7IC8vIENvbXB1dGUgcmlnaHQgdXBwZXIgdHJpYW5ndWxhciB2ZXJzaW9uIG9mIHRoZSBtYXRyaXggLSBHYXVzcyBlbGltaW5hdGlvbgoKICAgICAgbGV0IG4gPSAzOwogICAgICBjb25zdCBrID0gbjsKICAgICAgbGV0IG5wOwogICAgICBjb25zdCBrcCA9IDQ7IC8vIG51bSByb3dzCgogICAgICBsZXQgcDsKCiAgICAgIGRvIHsKICAgICAgICBpID0gayAtIG47CgogICAgICAgIGlmIChlcW5zW2kgKyBuYyAqIGldID09PSAwKSB7CiAgICAgICAgICAvLyB0aGUgcGl2b3QgaXMgbnVsbCwgc3dhcCBsaW5lcwogICAgICAgICAgZm9yIChqID0gaSArIDE7IGogPCBrOyBqKyspIHsKICAgICAgICAgICAgaWYgKGVxbnNbaSArIG5jICogal0gIT09IDApIHsKICAgICAgICAgICAgICBucCA9IGtwOwoKICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAvLyBkbyBsaWduZSggaSApID0gbGlnbmUoIGkgKSArIGxpZ25lKCBrICkKICAgICAgICAgICAgICAgIHAgPSBrcCAtIG5wOwogICAgICAgICAgICAgICAgZXFuc1twICsgbmMgKiBpXSArPSBlcW5zW3AgKyBuYyAqIGpdOwogICAgICAgICAgICAgIH0gd2hpbGUgKC0tbnApOwoKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGVxbnNbaSArIG5jICogaV0gIT09IDApIHsKICAgICAgICAgIGZvciAoaiA9IGkgKyAxOyBqIDwgazsgaisrKSB7CiAgICAgICAgICAgIGNvbnN0IG11bHRpcGxpZXIgPSBlcW5zW2kgKyBuYyAqIGpdIC8gZXFuc1tpICsgbmMgKiBpXTsKICAgICAgICAgICAgbnAgPSBrcDsKCiAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAvLyBkbyBsaWduZSggayApID0gbGlnbmUoIGsgKSAtIG11bHRpcGxpZXIgKiBsaWduZSggaSApCiAgICAgICAgICAgICAgcCA9IGtwIC0gbnA7CiAgICAgICAgICAgICAgZXFuc1twICsgbmMgKiBqXSA9IHAgPD0gaSA/IDAgOiBlcW5zW3AgKyBuYyAqIGpdIC0gZXFuc1twICsgbmMgKiBpXSAqIG11bHRpcGxpZXI7CiAgICAgICAgICAgIH0gd2hpbGUgKC0tbnApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSB3aGlsZSAoLS1uKTsgLy8gR2V0IHRoZSBzb2x1dGlvbgoKCiAgICAgIHRhcmdldC56ID0gZXFuc1syICogbmMgKyAzXSAvIGVxbnNbMiAqIG5jICsgMl07CiAgICAgIHRhcmdldC55ID0gKGVxbnNbMSAqIG5jICsgM10gLSBlcW5zWzEgKiBuYyArIDJdICogdGFyZ2V0LnopIC8gZXFuc1sxICogbmMgKyAxXTsKICAgICAgdGFyZ2V0LnggPSAoZXFuc1swICogbmMgKyAzXSAtIGVxbnNbMCAqIG5jICsgMl0gKiB0YXJnZXQueiAtIGVxbnNbMCAqIG5jICsgMV0gKiB0YXJnZXQueSkgLyBlcW5zWzAgKiBuYyArIDBdOwoKICAgICAgaWYgKGlzTmFOKHRhcmdldC54KSB8fCBpc05hTih0YXJnZXQueSkgfHwgaXNOYU4odGFyZ2V0LnopIHx8IHRhcmdldC54ID09PSBJbmZpbml0eSB8fCB0YXJnZXQueSA9PT0gSW5maW5pdHkgfHwgdGFyZ2V0LnogPT09IEluZmluaXR5KSB7CiAgICAgICAgdGhyb3cgYENvdWxkIG5vdCBzb2x2ZSBlcXVhdGlvbiEgR290IHg9WyR7dGFyZ2V0LnRvU3RyaW5nKCl9XSwgYj1bJHtiLnRvU3RyaW5nKCl9XSwgQT1bJHt0aGlzLnRvU3RyaW5nKCl9XWA7CiAgICAgIH0KCiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBlbGVtZW50IGluIHRoZSBtYXRyaXggYnkgaW5kZXguIEluZGV4IHN0YXJ0cyBhdCAwLCBub3QgMSEhIQogICAgICogQHBhcmFtIHZhbHVlIElmIHByb3ZpZGVkLCB0aGUgbWF0cml4IGVsZW1lbnQgd2lsbCBiZSBzZXQgdG8gdGhpcyB2YWx1ZS4KICAgICAqLwoKCiAgICBlKHJvdywgY29sdW1uLCB2YWx1ZSkgewogICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnRzW2NvbHVtbiArIDMgKiByb3ddOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIFNldCB2YWx1ZQogICAgICAgIHRoaXMuZWxlbWVudHNbY29sdW1uICsgMyAqIHJvd10gPSB2YWx1ZTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDb3B5IGFub3RoZXIgbWF0cml4IGludG8gdGhpcyBtYXRyaXggb2JqZWN0LgogICAgICovCgoKICAgIGNvcHkobWF0cml4KSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWF0cml4LmVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGhpcy5lbGVtZW50c1tpXSA9IG1hdHJpeC5lbGVtZW50c1tpXTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgYSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIG1hdHJpeC4KICAgICAqLwoKCiAgICB0b1N0cmluZygpIHsKICAgICAgbGV0IHIgPSAnJzsKICAgICAgY29uc3Qgc2VwID0gJywnOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA5OyBpKyspIHsKICAgICAgICByICs9IHRoaXMuZWxlbWVudHNbaV0gKyBzZXA7CiAgICAgIH0KCiAgICAgIHJldHVybiByOwogICAgfQogICAgLyoqCiAgICAgKiByZXZlcnNlIHRoZSBtYXRyaXgKICAgICAqIEBwYXJhbSB0YXJnZXQgVGFyZ2V0IG1hdHJpeCB0byBzYXZlIGluLgogICAgICogQHJldHVybiBUaGUgc29sdXRpb24geAogICAgICovCgoKICAgIHJldmVyc2UodGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBNYXQzKCk7CiAgICAgIH0KCiAgICAgIC8vIENvbnN0cnVjdCBlcXVhdGlvbnMKICAgICAgY29uc3QgbnIgPSAzOyAvLyBudW0gcm93cwoKICAgICAgY29uc3QgbmMgPSA2OyAvLyBudW0gY29scwoKICAgICAgY29uc3QgZXFucyA9IHJldmVyc2VfZXFuczsKICAgICAgbGV0IGk7CiAgICAgIGxldCBqOwoKICAgICAgZm9yIChpID0gMDsgaSA8IDM7IGkrKykgewogICAgICAgIGZvciAoaiA9IDA7IGogPCAzOyBqKyspIHsKICAgICAgICAgIGVxbnNbaSArIG5jICogal0gPSB0aGlzLmVsZW1lbnRzW2kgKyAzICogal07CiAgICAgICAgfQogICAgICB9CgogICAgICBlcW5zWzMgKyA2ICogMF0gPSAxOwogICAgICBlcW5zWzMgKyA2ICogMV0gPSAwOwogICAgICBlcW5zWzMgKyA2ICogMl0gPSAwOwogICAgICBlcW5zWzQgKyA2ICogMF0gPSAwOwogICAgICBlcW5zWzQgKyA2ICogMV0gPSAxOwogICAgICBlcW5zWzQgKyA2ICogMl0gPSAwOwogICAgICBlcW5zWzUgKyA2ICogMF0gPSAwOwogICAgICBlcW5zWzUgKyA2ICogMV0gPSAwOwogICAgICBlcW5zWzUgKyA2ICogMl0gPSAxOyAvLyBDb21wdXRlIHJpZ2h0IHVwcGVyIHRyaWFuZ3VsYXIgdmVyc2lvbiBvZiB0aGUgbWF0cml4IC0gR2F1c3MgZWxpbWluYXRpb24KCiAgICAgIGxldCBuID0gMzsKICAgICAgY29uc3QgayA9IG47CiAgICAgIGxldCBucDsKICAgICAgY29uc3Qga3AgPSBuYzsgLy8gbnVtIHJvd3MKCiAgICAgIGxldCBwOwoKICAgICAgZG8gewogICAgICAgIGkgPSBrIC0gbjsKCiAgICAgICAgaWYgKGVxbnNbaSArIG5jICogaV0gPT09IDApIHsKICAgICAgICAgIC8vIHRoZSBwaXZvdCBpcyBudWxsLCBzd2FwIGxpbmVzCiAgICAgICAgICBmb3IgKGogPSBpICsgMTsgaiA8IGs7IGorKykgewogICAgICAgICAgICBpZiAoZXFuc1tpICsgbmMgKiBqXSAhPT0gMCkgewogICAgICAgICAgICAgIG5wID0ga3A7CgogICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgIC8vIGRvIGxpbmUoIGkgKSA9IGxpbmUoIGkgKSArIGxpbmUoIGsgKQogICAgICAgICAgICAgICAgcCA9IGtwIC0gbnA7CiAgICAgICAgICAgICAgICBlcW5zW3AgKyBuYyAqIGldICs9IGVxbnNbcCArIG5jICogal07CiAgICAgICAgICAgICAgfSB3aGlsZSAoLS1ucCk7CgogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoZXFuc1tpICsgbmMgKiBpXSAhPT0gMCkgewogICAgICAgICAgZm9yIChqID0gaSArIDE7IGogPCBrOyBqKyspIHsKICAgICAgICAgICAgY29uc3QgbXVsdGlwbGllciA9IGVxbnNbaSArIG5jICogal0gLyBlcW5zW2kgKyBuYyAqIGldOwogICAgICAgICAgICBucCA9IGtwOwoKICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgIC8vIGRvIGxpbmUoIGsgKSA9IGxpbmUoIGsgKSAtIG11bHRpcGxpZXIgKiBsaW5lKCBpICkKICAgICAgICAgICAgICBwID0ga3AgLSBucDsKICAgICAgICAgICAgICBlcW5zW3AgKyBuYyAqIGpdID0gcCA8PSBpID8gMCA6IGVxbnNbcCArIG5jICogal0gLSBlcW5zW3AgKyBuYyAqIGldICogbXVsdGlwbGllcjsKICAgICAgICAgICAgfSB3aGlsZSAoLS1ucCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IHdoaWxlICgtLW4pOyAvLyBlbGltaW5hdGUgdGhlIHVwcGVyIGxlZnQgdHJpYW5nbGUgb2YgdGhlIG1hdHJpeAoKCiAgICAgIGkgPSAyOwoKICAgICAgZG8gewogICAgICAgIGogPSBpIC0gMTsKCiAgICAgICAgZG8gewogICAgICAgICAgY29uc3QgbXVsdGlwbGllciA9IGVxbnNbaSArIG5jICogal0gLyBlcW5zW2kgKyBuYyAqIGldOwogICAgICAgICAgbnAgPSBuYzsKCiAgICAgICAgICBkbyB7CiAgICAgICAgICAgIHAgPSBuYyAtIG5wOwogICAgICAgICAgICBlcW5zW3AgKyBuYyAqIGpdID0gZXFuc1twICsgbmMgKiBqXSAtIGVxbnNbcCArIG5jICogaV0gKiBtdWx0aXBsaWVyOwogICAgICAgICAgfSB3aGlsZSAoLS1ucCk7CiAgICAgICAgfSB3aGlsZSAoai0tKTsKICAgICAgfSB3aGlsZSAoLS1pKTsgLy8gb3BlcmF0aW9ucyBvbiB0aGUgZGlhZ29uYWwKCgogICAgICBpID0gMjsKCiAgICAgIGRvIHsKICAgICAgICBjb25zdCBtdWx0aXBsaWVyID0gMSAvIGVxbnNbaSArIG5jICogaV07CiAgICAgICAgbnAgPSBuYzsKCiAgICAgICAgZG8gewogICAgICAgICAgcCA9IG5jIC0gbnA7CiAgICAgICAgICBlcW5zW3AgKyBuYyAqIGldID0gZXFuc1twICsgbmMgKiBpXSAqIG11bHRpcGxpZXI7CiAgICAgICAgfSB3aGlsZSAoLS1ucCk7CiAgICAgIH0gd2hpbGUgKGktLSk7CgogICAgICBpID0gMjsKCiAgICAgIGRvIHsKICAgICAgICBqID0gMjsKCiAgICAgICAgZG8gewogICAgICAgICAgcCA9IGVxbnNbbnIgKyBqICsgbmMgKiBpXTsKCiAgICAgICAgICBpZiAoaXNOYU4ocCkgfHwgcCA9PT0gSW5maW5pdHkpIHsKICAgICAgICAgICAgdGhyb3cgYENvdWxkIG5vdCByZXZlcnNlISBBPVske3RoaXMudG9TdHJpbmcoKX1dYDsKICAgICAgICAgIH0KCiAgICAgICAgICB0YXJnZXQuZShpLCBqLCBwKTsKICAgICAgICB9IHdoaWxlIChqLS0pOwogICAgICB9IHdoaWxlIChpLS0pOwoKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBtYXRyaXggZnJvbSBhIHF1YXRlcmlvbgogICAgICovCgoKICAgIHNldFJvdGF0aW9uRnJvbVF1YXRlcm5pb24ocSkgewogICAgICBjb25zdCB4ID0gcS54OwogICAgICBjb25zdCB5ID0gcS55OwogICAgICBjb25zdCB6ID0gcS56OwogICAgICBjb25zdCB3ID0gcS53OwogICAgICBjb25zdCB4MiA9IHggKyB4OwogICAgICBjb25zdCB5MiA9IHkgKyB5OwogICAgICBjb25zdCB6MiA9IHogKyB6OwogICAgICBjb25zdCB4eCA9IHggKiB4MjsKICAgICAgY29uc3QgeHkgPSB4ICogeTI7CiAgICAgIGNvbnN0IHh6ID0geCAqIHoyOwogICAgICBjb25zdCB5eSA9IHkgKiB5MjsKICAgICAgY29uc3QgeXogPSB5ICogejI7CiAgICAgIGNvbnN0IHp6ID0geiAqIHoyOwogICAgICBjb25zdCB3eCA9IHcgKiB4MjsKICAgICAgY29uc3Qgd3kgPSB3ICogeTI7CiAgICAgIGNvbnN0IHd6ID0gdyAqIHoyOwogICAgICBjb25zdCBlID0gdGhpcy5lbGVtZW50czsKICAgICAgZVszICogMCArIDBdID0gMSAtICh5eSArIHp6KTsKICAgICAgZVszICogMCArIDFdID0geHkgLSB3ejsKICAgICAgZVszICogMCArIDJdID0geHogKyB3eTsKICAgICAgZVszICogMSArIDBdID0geHkgKyB3ejsKICAgICAgZVszICogMSArIDFdID0gMSAtICh4eCArIHp6KTsKICAgICAgZVszICogMSArIDJdID0geXogLSB3eDsKICAgICAgZVszICogMiArIDBdID0geHogLSB3eTsKICAgICAgZVszICogMiArIDFdID0geXogKyB3eDsKICAgICAgZVszICogMiArIDJdID0gMSAtICh4eCArIHl5KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIFRyYW5zcG9zZSB0aGUgbWF0cml4CiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsLiBXaGVyZSB0byBzdG9yZSB0aGUgcmVzdWx0LgogICAgICogQHJldHVybiBUaGUgdGFyZ2V0IE1hdDMsIG9yIGEgbmV3IE1hdDMgaWYgdGFyZ2V0IHdhcyBvbWl0dGVkLgogICAgICovCgoKICAgIHRyYW5zcG9zZSh0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IE1hdDMoKTsKICAgICAgfQoKICAgICAgY29uc3QgTSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIGNvbnN0IFQgPSB0YXJnZXQuZWxlbWVudHM7CiAgICAgIGxldCB0bXA7IC8vU2V0IGRpYWdvbmFscwoKICAgICAgVFswXSA9IE1bMF07CiAgICAgIFRbNF0gPSBNWzRdOwogICAgICBUWzhdID0gTVs4XTsKICAgICAgdG1wID0gTVsxXTsKICAgICAgVFsxXSA9IE1bM107CiAgICAgIFRbM10gPSB0bXA7CiAgICAgIHRtcCA9IE1bMl07CiAgICAgIFRbMl0gPSBNWzZdOwogICAgICBUWzZdID0gdG1wOwogICAgICB0bXAgPSBNWzVdOwogICAgICBUWzVdID0gTVs3XTsKICAgICAgVFs3XSA9IHRtcDsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KCiAgfQogIGNvbnN0IHJldmVyc2VfZXFucyA9IFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXTsKCiAgLyoqCiAgICogMy1kaW1lbnNpb25hbCB2ZWN0b3IKICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCB2ID0gbmV3IFZlYzMoMSwgMiwgMykKICAgKiAgICAgY29uc29sZS5sb2coJ3g9JyArIHYueCkgLy8geD0xCiAgICovCgogIGNsYXNzIFZlYzMgewogICAgY29uc3RydWN0b3IoeCwgeSwgeikgewogICAgICBpZiAoeCA9PT0gdm9pZCAwKSB7CiAgICAgICAgeCA9IDAuMDsKICAgICAgfQoKICAgICAgaWYgKHkgPT09IHZvaWQgMCkgewogICAgICAgIHkgPSAwLjA7CiAgICAgIH0KCiAgICAgIGlmICh6ID09PSB2b2lkIDApIHsKICAgICAgICB6ID0gMC4wOwogICAgICB9CgogICAgICB0aGlzLnggPSB4OwogICAgICB0aGlzLnkgPSB5OwogICAgICB0aGlzLnogPSB6OwogICAgfQogICAgLyoqCiAgICAgKiBWZWN0b3IgY3Jvc3MgcHJvZHVjdAogICAgICogQHBhcmFtIHRhcmdldCBPcHRpb25hbCB0YXJnZXQgdG8gc2F2ZSBpbi4KICAgICAqLwoKCiAgICBjcm9zcyh2ZWN0b3IsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCB2eCA9IHZlY3Rvci54OwogICAgICBjb25zdCB2eSA9IHZlY3Rvci55OwogICAgICBjb25zdCB2eiA9IHZlY3Rvci56OwogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICB0YXJnZXQueCA9IHkgKiB2eiAtIHogKiB2eTsKICAgICAgdGFyZ2V0LnkgPSB6ICogdnggLSB4ICogdno7CiAgICAgIHRhcmdldC56ID0geCAqIHZ5IC0geSAqIHZ4OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIHZlY3RvcnMnIDMgZWxlbWVudHMKICAgICAqLwoKCiAgICBzZXQoeCwgeSwgeikgewogICAgICB0aGlzLnggPSB4OwogICAgICB0aGlzLnkgPSB5OwogICAgICB0aGlzLnogPSB6OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogU2V0IGFsbCBjb21wb25lbnRzIG9mIHRoZSB2ZWN0b3IgdG8gemVyby4KICAgICAqLwoKCiAgICBzZXRaZXJvKCkgewogICAgICB0aGlzLnggPSB0aGlzLnkgPSB0aGlzLnogPSAwOwogICAgfQogICAgLyoqCiAgICAgKiBWZWN0b3IgYWRkaXRpb24KICAgICAqLwoKCiAgICB2YWRkKHZlY3RvciwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQpIHsKICAgICAgICB0YXJnZXQueCA9IHZlY3Rvci54ICsgdGhpcy54OwogICAgICAgIHRhcmdldC55ID0gdmVjdG9yLnkgKyB0aGlzLnk7CiAgICAgICAgdGFyZ2V0LnogPSB2ZWN0b3IueiArIHRoaXMuejsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gbmV3IFZlYzModGhpcy54ICsgdmVjdG9yLngsIHRoaXMueSArIHZlY3Rvci55LCB0aGlzLnogKyB2ZWN0b3Iueik7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogVmVjdG9yIHN1YnRyYWN0aW9uCiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsIHRhcmdldCB0byBzYXZlIGluLgogICAgICovCgoKICAgIHZzdWIodmVjdG9yLCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCkgewogICAgICAgIHRhcmdldC54ID0gdGhpcy54IC0gdmVjdG9yLng7CiAgICAgICAgdGFyZ2V0LnkgPSB0aGlzLnkgLSB2ZWN0b3IueTsKICAgICAgICB0YXJnZXQueiA9IHRoaXMueiAtIHZlY3Rvci56OwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBuZXcgVmVjMyh0aGlzLnggLSB2ZWN0b3IueCwgdGhpcy55IC0gdmVjdG9yLnksIHRoaXMueiAtIHZlY3Rvci56KTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGNyb3NzIHByb2R1Y3QgbWF0cml4IGFfY3Jvc3MgZnJvbSBhIHZlY3Rvciwgc3VjaCB0aGF0IGEgeCBiID0gYV9jcm9zcyAqIGIgPSBjCiAgICAgKgogICAgICogU2VlIHtAbGluayBodHRwczovL3d3dzguY3MudW11LnNlL2t1cnNlci9UREJEMjQvVlQwNi9sZWN0dXJlcy9MZWN0dXJlNi5wZGYgVW1lw6UgVW5pdmVyc2l0eSBMZWN0dXJlfQogICAgICovCgoKICAgIGNyb3NzbWF0KCkgewogICAgICByZXR1cm4gbmV3IE1hdDMoWzAsIC10aGlzLnosIHRoaXMueSwgdGhpcy56LCAwLCAtdGhpcy54LCAtdGhpcy55LCB0aGlzLngsIDBdKTsKICAgIH0KICAgIC8qKgogICAgICogTm9ybWFsaXplIHRoZSB2ZWN0b3IuIE5vdGUgdGhhdCB0aGlzIGNoYW5nZXMgdGhlIHZhbHVlcyBpbiB0aGUgdmVjdG9yLgogICAgICAqIEByZXR1cm4gUmV0dXJucyB0aGUgbm9ybSBvZiB0aGUgdmVjdG9yCiAgICAgKi8KCgogICAgbm9ybWFsaXplKCkgewogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICBjb25zdCBuID0gTWF0aC5zcXJ0KHggKiB4ICsgeSAqIHkgKyB6ICogeik7CgogICAgICBpZiAobiA+IDAuMCkgewogICAgICAgIGNvbnN0IGludk4gPSAxIC8gbjsKICAgICAgICB0aGlzLnggKj0gaW52TjsKICAgICAgICB0aGlzLnkgKj0gaW52TjsKICAgICAgICB0aGlzLnogKj0gaW52TjsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBNYWtlIHNvbWV0aGluZyB1cAogICAgICAgIHRoaXMueCA9IDA7CiAgICAgICAgdGhpcy55ID0gMDsKICAgICAgICB0aGlzLnogPSAwOwogICAgICB9CgogICAgICByZXR1cm4gbjsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSB2ZXJzaW9uIG9mIHRoaXMgdmVjdG9yIHRoYXQgaXMgb2YgbGVuZ3RoIDEuCiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsIHRhcmdldCB0byBzYXZlIGluCiAgICAgKiBAcmV0dXJuIFJldHVybnMgdGhlIHVuaXQgdmVjdG9yCiAgICAgKi8KCgogICAgdW5pdCh0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgY29uc3QgeCA9IHRoaXMueDsKICAgICAgY29uc3QgeSA9IHRoaXMueTsKICAgICAgY29uc3QgeiA9IHRoaXMuejsKICAgICAgbGV0IG5pbnYgPSBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSArIHogKiB6KTsKCiAgICAgIGlmIChuaW52ID4gMC4wKSB7CiAgICAgICAgbmludiA9IDEuMCAvIG5pbnY7CiAgICAgICAgdGFyZ2V0LnggPSB4ICogbmludjsKICAgICAgICB0YXJnZXQueSA9IHkgKiBuaW52OwogICAgICAgIHRhcmdldC56ID0geiAqIG5pbnY7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGFyZ2V0LnggPSAxOwogICAgICAgIHRhcmdldC55ID0gMDsKICAgICAgICB0YXJnZXQueiA9IDA7CiAgICAgIH0KCiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgbGVuZ3RoIG9mIHRoZSB2ZWN0b3IKICAgICAqLwoKCiAgICBsZW5ndGgoKSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIHJldHVybiBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSArIHogKiB6KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBzcXVhcmVkIGxlbmd0aCBvZiB0aGUgdmVjdG9yLgogICAgICovCgoKICAgIGxlbmd0aFNxdWFyZWQoKSB7CiAgICAgIHJldHVybiB0aGlzLmRvdCh0aGlzKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGRpc3RhbmNlIGZyb20gdGhpcyBwb2ludCB0byBhbm90aGVyIHBvaW50CiAgICAgKi8KCgogICAgZGlzdGFuY2VUbyhwKSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIGNvbnN0IHB4ID0gcC54OwogICAgICBjb25zdCBweSA9IHAueTsKICAgICAgY29uc3QgcHogPSBwLno7CiAgICAgIHJldHVybiBNYXRoLnNxcnQoKHB4IC0geCkgKiAocHggLSB4KSArIChweSAtIHkpICogKHB5IC0geSkgKyAocHogLSB6KSAqIChweiAtIHopKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHNxdWFyZWQgZGlzdGFuY2UgZnJvbSB0aGlzIHBvaW50IHRvIGFub3RoZXIgcG9pbnQKICAgICAqLwoKCiAgICBkaXN0YW5jZVNxdWFyZWQocCkgewogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICBjb25zdCBweCA9IHAueDsKICAgICAgY29uc3QgcHkgPSBwLnk7CiAgICAgIGNvbnN0IHB6ID0gcC56OwogICAgICByZXR1cm4gKHB4IC0geCkgKiAocHggLSB4KSArIChweSAtIHkpICogKHB5IC0geSkgKyAocHogLSB6KSAqIChweiAtIHopOwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSBhbGwgdGhlIGNvbXBvbmVudHMgb2YgdGhlIHZlY3RvciB3aXRoIGEgc2NhbGFyLgogICAgICogQHBhcmFtIHRhcmdldCBUaGUgdmVjdG9yIHRvIHNhdmUgdGhlIHJlc3VsdCBpbi4KICAgICAqLwoKCiAgICBzY2FsZShzY2FsYXIsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICB0YXJnZXQueCA9IHNjYWxhciAqIHg7CiAgICAgIHRhcmdldC55ID0gc2NhbGFyICogeTsKICAgICAgdGFyZ2V0LnogPSBzY2FsYXIgKiB6OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSB0aGUgdmVjdG9yIHdpdGggYW4gb3RoZXIgdmVjdG9yLCBjb21wb25lbnQtd2lzZS4KICAgICAqIEBwYXJhbSB0YXJnZXQgVGhlIHZlY3RvciB0byBzYXZlIHRoZSByZXN1bHQgaW4uCiAgICAgKi8KCgogICAgdm11bCh2ZWN0b3IsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0YXJnZXQueCA9IHZlY3Rvci54ICogdGhpcy54OwogICAgICB0YXJnZXQueSA9IHZlY3Rvci55ICogdGhpcy55OwogICAgICB0YXJnZXQueiA9IHZlY3Rvci56ICogdGhpcy56OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBTY2FsZSBhIHZlY3RvciBhbmQgYWRkIGl0IHRvIHRoaXMgdmVjdG9yLiBTYXZlIHRoZSByZXN1bHQgaW4gInRhcmdldCIuICh0YXJnZXQgPSB0aGlzICsgdmVjdG9yICogc2NhbGFyKQogICAgICogQHBhcmFtIHRhcmdldCBUaGUgdmVjdG9yIHRvIHNhdmUgdGhlIHJlc3VsdCBpbi4KICAgICAqLwoKCiAgICBhZGRTY2FsZWRWZWN0b3Ioc2NhbGFyLCB2ZWN0b3IsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0YXJnZXQueCA9IHRoaXMueCArIHNjYWxhciAqIHZlY3Rvci54OwogICAgICB0YXJnZXQueSA9IHRoaXMueSArIHNjYWxhciAqIHZlY3Rvci55OwogICAgICB0YXJnZXQueiA9IHRoaXMueiArIHNjYWxhciAqIHZlY3Rvci56OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBDYWxjdWxhdGUgZG90IHByb2R1Y3QKICAgICAqIEBwYXJhbSB2ZWN0b3IKICAgICAqLwoKCiAgICBkb3QodmVjdG9yKSB7CiAgICAgIHJldHVybiB0aGlzLnggKiB2ZWN0b3IueCArIHRoaXMueSAqIHZlY3Rvci55ICsgdGhpcy56ICogdmVjdG9yLno7CiAgICB9CgogICAgaXNaZXJvKCkgewogICAgICByZXR1cm4gdGhpcy54ID09PSAwICYmIHRoaXMueSA9PT0gMCAmJiB0aGlzLnogPT09IDA7CiAgICB9CiAgICAvKioKICAgICAqIE1ha2UgdGhlIHZlY3RvciBwb2ludCBpbiB0aGUgb3Bwb3NpdGUgZGlyZWN0aW9uLgogICAgICogQHBhcmFtIHRhcmdldCBPcHRpb25hbCB0YXJnZXQgdG8gc2F2ZSBpbgogICAgICovCgoKICAgIG5lZ2F0ZSh0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgdGFyZ2V0LnggPSAtdGhpcy54OwogICAgICB0YXJnZXQueSA9IC10aGlzLnk7CiAgICAgIHRhcmdldC56ID0gLXRoaXMuejsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0d28gYXJ0aWZpY2lhbCB0YW5nZW50cyB0byB0aGUgdmVjdG9yCiAgICAgKiBAcGFyYW0gdDEgVmVjdG9yIG9iamVjdCB0byBzYXZlIHRoZSBmaXJzdCB0YW5nZW50IGluCiAgICAgKiBAcGFyYW0gdDIgVmVjdG9yIG9iamVjdCB0byBzYXZlIHRoZSBzZWNvbmQgdGFuZ2VudCBpbgogICAgICovCgoKICAgIHRhbmdlbnRzKHQxLCB0MikgewogICAgICBjb25zdCBub3JtID0gdGhpcy5sZW5ndGgoKTsKCiAgICAgIGlmIChub3JtID4gMC4wKSB7CiAgICAgICAgY29uc3QgbiA9IFZlYzNfdGFuZ2VudHNfbjsKICAgICAgICBjb25zdCBpbm9ybSA9IDEgLyBub3JtOwogICAgICAgIG4uc2V0KHRoaXMueCAqIGlub3JtLCB0aGlzLnkgKiBpbm9ybSwgdGhpcy56ICogaW5vcm0pOwogICAgICAgIGNvbnN0IHJhbmRWZWMgPSBWZWMzX3RhbmdlbnRzX3JhbmRWZWM7CgogICAgICAgIGlmIChNYXRoLmFicyhuLngpIDwgMC45KSB7CiAgICAgICAgICByYW5kVmVjLnNldCgxLCAwLCAwKTsKICAgICAgICAgIG4uY3Jvc3MocmFuZFZlYywgdDEpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByYW5kVmVjLnNldCgwLCAxLCAwKTsKICAgICAgICAgIG4uY3Jvc3MocmFuZFZlYywgdDEpOwogICAgICAgIH0KCiAgICAgICAgbi5jcm9zcyh0MSwgdDIpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIFRoZSBub3JtYWwgbGVuZ3RoIGlzIHplcm8sIG1ha2Ugc29tZXRoaW5nIHVwCiAgICAgICAgdDEuc2V0KDEsIDAsIDApOwogICAgICAgIHQyLnNldCgwLCAxLCAwKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDb252ZXJ0cyB0byBhIG1vcmUgcmVhZGFibGUgZm9ybWF0CiAgICAgKi8KCgogICAgdG9TdHJpbmcoKSB7CiAgICAgIHJldHVybiBgJHt0aGlzLnh9LCR7dGhpcy55fSwke3RoaXMuen1gOwogICAgfQogICAgLyoqCiAgICAgKiBDb252ZXJ0cyB0byBhbiBhcnJheQogICAgICovCgoKICAgIHRvQXJyYXkoKSB7CiAgICAgIHJldHVybiBbdGhpcy54LCB0aGlzLnksIHRoaXMuel07CiAgICB9CiAgICAvKioKICAgICAqIENvcGllcyB2YWx1ZSBvZiBzb3VyY2UgdG8gdGhpcyB2ZWN0b3IuCiAgICAgKi8KCgogICAgY29weSh2ZWN0b3IpIHsKICAgICAgdGhpcy54ID0gdmVjdG9yLng7CiAgICAgIHRoaXMueSA9IHZlY3Rvci55OwogICAgICB0aGlzLnogPSB2ZWN0b3IuejsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIERvIGEgbGluZWFyIGludGVycG9sYXRpb24gYmV0d2VlbiB0d28gdmVjdG9ycwogICAgICogQHBhcmFtIHQgQSBudW1iZXIgYmV0d2VlbiAwIGFuZCAxLiAwIHdpbGwgbWFrZSB0aGlzIGZ1bmN0aW9uIHJldHVybiB1LCBhbmQgMSB3aWxsIG1ha2UgaXQgcmV0dXJuIHYuIE51bWJlcnMgaW4gYmV0d2VlbiB3aWxsIGdlbmVyYXRlIGEgdmVjdG9yIGluIGJldHdlZW4gdGhlbS4KICAgICAqLwoKCiAgICBsZXJwKHZlY3RvciwgdCwgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIHRhcmdldC54ID0geCArICh2ZWN0b3IueCAtIHgpICogdDsKICAgICAgdGFyZ2V0LnkgPSB5ICsgKHZlY3Rvci55IC0geSkgKiB0OwogICAgICB0YXJnZXQueiA9IHogKyAodmVjdG9yLnogLSB6KSAqIHQ7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIGEgdmVjdG9yIGVxdWFscyBpcyBhbG1vc3QgZXF1YWwgdG8gYW5vdGhlciBvbmUuCiAgICAgKi8KCgogICAgYWxtb3N0RXF1YWxzKHZlY3RvciwgcHJlY2lzaW9uKSB7CiAgICAgIGlmIChwcmVjaXNpb24gPT09IHZvaWQgMCkgewogICAgICAgIHByZWNpc2lvbiA9IDFlLTY7CiAgICAgIH0KCiAgICAgIGlmIChNYXRoLmFicyh0aGlzLnggLSB2ZWN0b3IueCkgPiBwcmVjaXNpb24gfHwgTWF0aC5hYnModGhpcy55IC0gdmVjdG9yLnkpID4gcHJlY2lzaW9uIHx8IE1hdGguYWJzKHRoaXMueiAtIHZlY3Rvci56KSA+IHByZWNpc2lvbikgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIGEgdmVjdG9yIGlzIGFsbW9zdCB6ZXJvCiAgICAgKi8KCgogICAgYWxtb3N0WmVybyhwcmVjaXNpb24pIHsKICAgICAgaWYgKHByZWNpc2lvbiA9PT0gdm9pZCAwKSB7CiAgICAgICAgcHJlY2lzaW9uID0gMWUtNjsKICAgICAgfQoKICAgICAgaWYgKE1hdGguYWJzKHRoaXMueCkgPiBwcmVjaXNpb24gfHwgTWF0aC5hYnModGhpcy55KSA+IHByZWNpc2lvbiB8fCBNYXRoLmFicyh0aGlzLnopID4gcHJlY2lzaW9uKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhlIHZlY3RvciBpcyBhbnRpLXBhcmFsbGVsIHRvIGFub3RoZXIgdmVjdG9yLgogICAgICogQHBhcmFtIHByZWNpc2lvbiBTZXQgdG8gemVybyBmb3IgZXhhY3QgY29tcGFyaXNvbnMKICAgICAqLwoKCiAgICBpc0FudGlwYXJhbGxlbFRvKHZlY3RvciwgcHJlY2lzaW9uKSB7CiAgICAgIHRoaXMubmVnYXRlKGFudGlwX25lZyk7CiAgICAgIHJldHVybiBhbnRpcF9uZWcuYWxtb3N0RXF1YWxzKHZlY3RvciwgcHJlY2lzaW9uKTsKICAgIH0KICAgIC8qKgogICAgICogQ2xvbmUgdGhlIHZlY3RvcgogICAgICovCgoKICAgIGNsb25lKCkgewogICAgICByZXR1cm4gbmV3IFZlYzModGhpcy54LCB0aGlzLnksIHRoaXMueik7CiAgICB9CgogIH0KICBWZWMzLlpFUk8gPSBuZXcgVmVjMygwLCAwLCAwKTsKICBWZWMzLlVOSVRfWCA9IG5ldyBWZWMzKDEsIDAsIDApOwogIFZlYzMuVU5JVF9ZID0gbmV3IFZlYzMoMCwgMSwgMCk7CiAgVmVjMy5VTklUX1ogPSBuZXcgVmVjMygwLCAwLCAxKTsKICBjb25zdCBWZWMzX3RhbmdlbnRzX24gPSBuZXcgVmVjMygpOwogIGNvbnN0IFZlYzNfdGFuZ2VudHNfcmFuZFZlYyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYW50aXBfbmVnID0gbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQXhpcyBhbGlnbmVkIGJvdW5kaW5nIGJveCBjbGFzcy4KICAgKi8KICBjbGFzcyBBQUJCIHsKICAgIC8qKgogICAgICogVGhlIGxvd2VyIGJvdW5kIG9mIHRoZSBib3VuZGluZyBib3gKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHVwcGVyIGJvdW5kIG9mIHRoZSBib3VuZGluZyBib3gKICAgICAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICB0aGlzLmxvd2VyQm91bmQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnVwcGVyQm91bmQgPSBuZXcgVmVjMygpOwoKICAgICAgaWYgKG9wdGlvbnMubG93ZXJCb3VuZCkgewogICAgICAgIHRoaXMubG93ZXJCb3VuZC5jb3B5KG9wdGlvbnMubG93ZXJCb3VuZCk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLnVwcGVyQm91bmQpIHsKICAgICAgICB0aGlzLnVwcGVyQm91bmQuY29weShvcHRpb25zLnVwcGVyQm91bmQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgQUFCQiBib3VuZHMgZnJvbSBhIHNldCBvZiBwb2ludHMuCiAgICAgKiBAcGFyYW0gcG9pbnRzIEFuIGFycmF5IG9mIFZlYzMncy4KICAgICAqIEByZXR1cm4gVGhlIHNlbGYgb2JqZWN0CiAgICAgKi8KCgogICAgc2V0RnJvbVBvaW50cyhwb2ludHMsIHBvc2l0aW9uLCBxdWF0ZXJuaW9uLCBza2luU2l6ZSkgewogICAgICBjb25zdCBsID0gdGhpcy5sb3dlckJvdW5kOwogICAgICBjb25zdCB1ID0gdGhpcy51cHBlckJvdW5kOwogICAgICBjb25zdCBxID0gcXVhdGVybmlvbjsgLy8gU2V0IHRvIHRoZSBmaXJzdCBwb2ludAoKICAgICAgbC5jb3B5KHBvaW50c1swXSk7CgogICAgICBpZiAocSkgewogICAgICAgIHEudm11bHQobCwgbCk7CiAgICAgIH0KCiAgICAgIHUuY29weShsKTsKCiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgcG9pbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgbGV0IHAgPSBwb2ludHNbaV07CgogICAgICAgIGlmIChxKSB7CiAgICAgICAgICBxLnZtdWx0KHAsIHRtcCQxKTsKICAgICAgICAgIHAgPSB0bXAkMTsKICAgICAgICB9CgogICAgICAgIGlmIChwLnggPiB1LngpIHsKICAgICAgICAgIHUueCA9IHAueDsKICAgICAgICB9CgogICAgICAgIGlmIChwLnggPCBsLngpIHsKICAgICAgICAgIGwueCA9IHAueDsKICAgICAgICB9CgogICAgICAgIGlmIChwLnkgPiB1LnkpIHsKICAgICAgICAgIHUueSA9IHAueTsKICAgICAgICB9CgogICAgICAgIGlmIChwLnkgPCBsLnkpIHsKICAgICAgICAgIGwueSA9IHAueTsKICAgICAgICB9CgogICAgICAgIGlmIChwLnogPiB1LnopIHsKICAgICAgICAgIHUueiA9IHAuejsKICAgICAgICB9CgogICAgICAgIGlmIChwLnogPCBsLnopIHsKICAgICAgICAgIGwueiA9IHAuejsKICAgICAgICB9CiAgICAgIH0gLy8gQWRkIG9mZnNldAoKCiAgICAgIGlmIChwb3NpdGlvbikgewogICAgICAgIHBvc2l0aW9uLnZhZGQobCwgbCk7CiAgICAgICAgcG9zaXRpb24udmFkZCh1LCB1KTsKICAgICAgfQoKICAgICAgaWYgKHNraW5TaXplKSB7CiAgICAgICAgbC54IC09IHNraW5TaXplOwogICAgICAgIGwueSAtPSBza2luU2l6ZTsKICAgICAgICBsLnogLT0gc2tpblNpemU7CiAgICAgICAgdS54ICs9IHNraW5TaXplOwogICAgICAgIHUueSArPSBza2luU2l6ZTsKICAgICAgICB1LnogKz0gc2tpblNpemU7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBDb3B5IGJvdW5kcyBmcm9tIGFuIEFBQkIgdG8gdGhpcyBBQUJCCiAgICAgKiBAcGFyYW0gYWFiYiBTb3VyY2UgdG8gY29weSBmcm9tCiAgICAgKiBAcmV0dXJuIFRoZSB0aGlzIG9iamVjdCwgZm9yIGNoYWluYWJpbGl0eQogICAgICovCgoKICAgIGNvcHkoYWFiYikgewogICAgICB0aGlzLmxvd2VyQm91bmQuY29weShhYWJiLmxvd2VyQm91bmQpOwogICAgICB0aGlzLnVwcGVyQm91bmQuY29weShhYWJiLnVwcGVyQm91bmQpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogQ2xvbmUgYW4gQUFCQgogICAgICovCgoKICAgIGNsb25lKCkgewogICAgICByZXR1cm4gbmV3IEFBQkIoKS5jb3B5KHRoaXMpOwogICAgfQogICAgLyoqCiAgICAgKiBFeHRlbmQgdGhpcyBBQUJCIHNvIHRoYXQgaXQgY292ZXJzIHRoZSBnaXZlbiBBQUJCIHRvby4KICAgICAqLwoKCiAgICBleHRlbmQoYWFiYikgewogICAgICB0aGlzLmxvd2VyQm91bmQueCA9IE1hdGgubWluKHRoaXMubG93ZXJCb3VuZC54LCBhYWJiLmxvd2VyQm91bmQueCk7CiAgICAgIHRoaXMudXBwZXJCb3VuZC54ID0gTWF0aC5tYXgodGhpcy51cHBlckJvdW5kLngsIGFhYmIudXBwZXJCb3VuZC54KTsKICAgICAgdGhpcy5sb3dlckJvdW5kLnkgPSBNYXRoLm1pbih0aGlzLmxvd2VyQm91bmQueSwgYWFiYi5sb3dlckJvdW5kLnkpOwogICAgICB0aGlzLnVwcGVyQm91bmQueSA9IE1hdGgubWF4KHRoaXMudXBwZXJCb3VuZC55LCBhYWJiLnVwcGVyQm91bmQueSk7CiAgICAgIHRoaXMubG93ZXJCb3VuZC56ID0gTWF0aC5taW4odGhpcy5sb3dlckJvdW5kLnosIGFhYmIubG93ZXJCb3VuZC56KTsKICAgICAgdGhpcy51cHBlckJvdW5kLnogPSBNYXRoLm1heCh0aGlzLnVwcGVyQm91bmQueiwgYWFiYi51cHBlckJvdW5kLnopOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIGdpdmVuIEFBQkIgb3ZlcmxhcHMgdGhpcyBBQUJCLgogICAgICovCgoKICAgIG92ZXJsYXBzKGFhYmIpIHsKICAgICAgY29uc3QgbDEgPSB0aGlzLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUxID0gdGhpcy51cHBlckJvdW5kOwogICAgICBjb25zdCBsMiA9IGFhYmIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdTIgPSBhYWJiLnVwcGVyQm91bmQ7IC8vICAgICAgbDIgICAgICAgIHUyCiAgICAgIC8vICAgICAgfC0tLS0tLS0tLXwKICAgICAgLy8gfC0tLS0tLS0tfAogICAgICAvLyBsMSAgICAgICB1MQoKICAgICAgY29uc3Qgb3ZlcmxhcHNYID0gbDIueCA8PSB1MS54ICYmIHUxLnggPD0gdTIueCB8fCBsMS54IDw9IHUyLnggJiYgdTIueCA8PSB1MS54OwogICAgICBjb25zdCBvdmVybGFwc1kgPSBsMi55IDw9IHUxLnkgJiYgdTEueSA8PSB1Mi55IHx8IGwxLnkgPD0gdTIueSAmJiB1Mi55IDw9IHUxLnk7CiAgICAgIGNvbnN0IG92ZXJsYXBzWiA9IGwyLnogPD0gdTEueiAmJiB1MS56IDw9IHUyLnogfHwgbDEueiA8PSB1Mi56ICYmIHUyLnogPD0gdTEuejsKICAgICAgcmV0dXJuIG92ZXJsYXBzWCAmJiBvdmVybGFwc1kgJiYgb3ZlcmxhcHNaOwogICAgfSAvLyBNb3N0bHkgZm9yIGRlYnVnZ2luZwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIGNvbnN0IGwgPSB0aGlzLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUgPSB0aGlzLnVwcGVyQm91bmQ7CiAgICAgIHJldHVybiAodS54IC0gbC54KSAqICh1LnkgLSBsLnkpICogKHUueiAtIGwueik7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgZ2l2ZW4gQUFCQiBpcyBmdWxseSBjb250YWluZWQgaW4gdGhpcyBBQUJCLgogICAgICovCgoKICAgIGNvbnRhaW5zKGFhYmIpIHsKICAgICAgY29uc3QgbDEgPSB0aGlzLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUxID0gdGhpcy51cHBlckJvdW5kOwogICAgICBjb25zdCBsMiA9IGFhYmIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdTIgPSBhYWJiLnVwcGVyQm91bmQ7IC8vICAgICAgbDIgICAgICAgIHUyCiAgICAgIC8vICAgICAgfC0tLS0tLS0tLXwKICAgICAgLy8gfC0tLS0tLS0tLS0tLS0tLXwKICAgICAgLy8gbDEgICAgICAgICAgICAgIHUxCgogICAgICByZXR1cm4gbDEueCA8PSBsMi54ICYmIHUxLnggPj0gdTIueCAmJiBsMS55IDw9IGwyLnkgJiYgdTEueSA+PSB1Mi55ICYmIGwxLnogPD0gbDIueiAmJiB1MS56ID49IHUyLno7CiAgICB9CgogICAgZ2V0Q29ybmVycyhhLCBiLCBjLCBkLCBlLCBmLCBnLCBoKSB7CiAgICAgIGNvbnN0IGwgPSB0aGlzLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUgPSB0aGlzLnVwcGVyQm91bmQ7CiAgICAgIGEuY29weShsKTsKICAgICAgYi5zZXQodS54LCBsLnksIGwueik7CiAgICAgIGMuc2V0KHUueCwgdS55LCBsLnopOwogICAgICBkLnNldChsLngsIHUueSwgdS56KTsKICAgICAgZS5zZXQodS54LCBsLnksIHUueik7CiAgICAgIGYuc2V0KGwueCwgdS55LCBsLnopOwogICAgICBnLnNldChsLngsIGwueSwgdS56KTsKICAgICAgaC5jb3B5KHUpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHJlcHJlc2VudGF0aW9uIG9mIGFuIEFBQkIgaW4gYW5vdGhlciBmcmFtZS4KICAgICAqIEByZXR1cm4gVGhlICJ0YXJnZXQiIEFBQkIgb2JqZWN0LgogICAgICovCgoKICAgIHRvTG9jYWxGcmFtZShmcmFtZSwgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IGNvcm5lcnMgPSB0cmFuc2Zvcm1JbnRvRnJhbWVfY29ybmVyczsKICAgICAgY29uc3QgYSA9IGNvcm5lcnNbMF07CiAgICAgIGNvbnN0IGIgPSBjb3JuZXJzWzFdOwogICAgICBjb25zdCBjID0gY29ybmVyc1syXTsKICAgICAgY29uc3QgZCA9IGNvcm5lcnNbM107CiAgICAgIGNvbnN0IGUgPSBjb3JuZXJzWzRdOwogICAgICBjb25zdCBmID0gY29ybmVyc1s1XTsKICAgICAgY29uc3QgZyA9IGNvcm5lcnNbNl07CiAgICAgIGNvbnN0IGggPSBjb3JuZXJzWzddOyAvLyBHZXQgY29ybmVycyBpbiBjdXJyZW50IGZyYW1lCgogICAgICB0aGlzLmdldENvcm5lcnMoYSwgYiwgYywgZCwgZSwgZiwgZywgaCk7IC8vIFRyYW5zZm9ybSB0aGVtIHRvIG5ldyBsb2NhbCBmcmFtZQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IDg7IGkrKykgewogICAgICAgIGNvbnN0IGNvcm5lciA9IGNvcm5lcnNbaV07CiAgICAgICAgZnJhbWUucG9pbnRUb0xvY2FsKGNvcm5lciwgY29ybmVyKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRhcmdldC5zZXRGcm9tUG9pbnRzKGNvcm5lcnMpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHJlcHJlc2VudGF0aW9uIG9mIGFuIEFBQkIgaW4gdGhlIGdsb2JhbCBmcmFtZS4KICAgICAqIEByZXR1cm4gVGhlICJ0YXJnZXQiIEFBQkIgb2JqZWN0LgogICAgICovCgoKICAgIHRvV29ybGRGcmFtZShmcmFtZSwgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IGNvcm5lcnMgPSB0cmFuc2Zvcm1JbnRvRnJhbWVfY29ybmVyczsKICAgICAgY29uc3QgYSA9IGNvcm5lcnNbMF07CiAgICAgIGNvbnN0IGIgPSBjb3JuZXJzWzFdOwogICAgICBjb25zdCBjID0gY29ybmVyc1syXTsKICAgICAgY29uc3QgZCA9IGNvcm5lcnNbM107CiAgICAgIGNvbnN0IGUgPSBjb3JuZXJzWzRdOwogICAgICBjb25zdCBmID0gY29ybmVyc1s1XTsKICAgICAgY29uc3QgZyA9IGNvcm5lcnNbNl07CiAgICAgIGNvbnN0IGggPSBjb3JuZXJzWzddOyAvLyBHZXQgY29ybmVycyBpbiBjdXJyZW50IGZyYW1lCgogICAgICB0aGlzLmdldENvcm5lcnMoYSwgYiwgYywgZCwgZSwgZiwgZywgaCk7IC8vIFRyYW5zZm9ybSB0aGVtIHRvIG5ldyBsb2NhbCBmcmFtZQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IDg7IGkrKykgewogICAgICAgIGNvbnN0IGNvcm5lciA9IGNvcm5lcnNbaV07CiAgICAgICAgZnJhbWUucG9pbnRUb1dvcmxkKGNvcm5lciwgY29ybmVyKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRhcmdldC5zZXRGcm9tUG9pbnRzKGNvcm5lcnMpOwogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgQUFCQiBpcyBoaXQgYnkgYSByYXkuCiAgICAgKi8KCgogICAgb3ZlcmxhcHNSYXkocmF5KSB7CiAgICAgIGNvbnN0IHsKICAgICAgICBkaXJlY3Rpb24sCiAgICAgICAgZnJvbQogICAgICB9ID0gcmF5OyAvLyBjb25zdCB0ID0gMAogICAgICAvLyByYXkuZGlyZWN0aW9uIGlzIHVuaXQgZGlyZWN0aW9uIHZlY3RvciBvZiByYXkKCiAgICAgIGNvbnN0IGRpckZyYWNYID0gMSAvIGRpcmVjdGlvbi54OwogICAgICBjb25zdCBkaXJGcmFjWSA9IDEgLyBkaXJlY3Rpb24ueTsKICAgICAgY29uc3QgZGlyRnJhY1ogPSAxIC8gZGlyZWN0aW9uLno7IC8vIHRoaXMubG93ZXJCb3VuZCBpcyB0aGUgY29ybmVyIG9mIEFBQkIgd2l0aCBtaW5pbWFsIGNvb3JkaW5hdGVzIC0gbGVmdCBib3R0b20sIHJ0IGlzIG1heGltYWwgY29ybmVyCgogICAgICBjb25zdCB0MSA9ICh0aGlzLmxvd2VyQm91bmQueCAtIGZyb20ueCkgKiBkaXJGcmFjWDsKICAgICAgY29uc3QgdDIgPSAodGhpcy51cHBlckJvdW5kLnggLSBmcm9tLngpICogZGlyRnJhY1g7CiAgICAgIGNvbnN0IHQzID0gKHRoaXMubG93ZXJCb3VuZC55IC0gZnJvbS55KSAqIGRpckZyYWNZOwogICAgICBjb25zdCB0NCA9ICh0aGlzLnVwcGVyQm91bmQueSAtIGZyb20ueSkgKiBkaXJGcmFjWTsKICAgICAgY29uc3QgdDUgPSAodGhpcy5sb3dlckJvdW5kLnogLSBmcm9tLnopICogZGlyRnJhY1o7CiAgICAgIGNvbnN0IHQ2ID0gKHRoaXMudXBwZXJCb3VuZC56IC0gZnJvbS56KSAqIGRpckZyYWNaOyAvLyBjb25zdCB0bWluID0gTWF0aC5tYXgoTWF0aC5tYXgoTWF0aC5taW4odDEsIHQyKSwgTWF0aC5taW4odDMsIHQ0KSkpOwogICAgICAvLyBjb25zdCB0bWF4ID0gTWF0aC5taW4oTWF0aC5taW4oTWF0aC5tYXgodDEsIHQyKSwgTWF0aC5tYXgodDMsIHQ0KSkpOwoKICAgICAgY29uc3QgdG1pbiA9IE1hdGgubWF4KE1hdGgubWF4KE1hdGgubWluKHQxLCB0MiksIE1hdGgubWluKHQzLCB0NCkpLCBNYXRoLm1pbih0NSwgdDYpKTsKICAgICAgY29uc3QgdG1heCA9IE1hdGgubWluKE1hdGgubWluKE1hdGgubWF4KHQxLCB0MiksIE1hdGgubWF4KHQzLCB0NCkpLCBNYXRoLm1heCh0NSwgdDYpKTsgLy8gaWYgdG1heCA8IDAsIHJheSAobGluZSkgaXMgaW50ZXJzZWN0aW5nIEFBQkIsIGJ1dCB3aG9sZSBBQUJCIGlzIGJlaGluZyB1cwoKICAgICAgaWYgKHRtYXggPCAwKSB7CiAgICAgICAgLy90ID0gdG1heDsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gLy8gaWYgdG1pbiA+IHRtYXgsIHJheSBkb2Vzbid0IGludGVyc2VjdCBBQUJCCgoKICAgICAgaWYgKHRtaW4gPiB0bWF4KSB7CiAgICAgICAgLy90ID0gdG1heDsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICB9CiAgY29uc3QgdG1wJDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRyYW5zZm9ybUludG9GcmFtZV9jb3JuZXJzID0gW25ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCldOwoKICAvKioKICAgKiBDb2xsaXNpb24gIm1hdHJpeCIuCiAgICogSXQncyBhY3R1YWxseSBhIHRyaWFuZ3VsYXItc2hhcGVkIGFycmF5IG9mIHdoZXRoZXIgdHdvIGJvZGllcyBhcmUgdG91Y2hpbmcgdGhpcyBzdGVwLCBmb3IgcmVmZXJlbmNlIG5leHQgc3RlcAogICAqLwogIGNsYXNzIEFycmF5Q29sbGlzaW9uTWF0cml4IHsKICAgIC8qKgogICAgICogVGhlIG1hdHJpeCBzdG9yYWdlLgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgdGhpcy5tYXRyaXggPSBbXTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFuIGVsZW1lbnQKICAgICAqLwoKCiAgICBnZXQoYmksIGJqKSB7CiAgICAgIGxldCB7CiAgICAgICAgaW5kZXg6IGkKICAgICAgfSA9IGJpOwogICAgICBsZXQgewogICAgICAgIGluZGV4OiBqCiAgICAgIH0gPSBiajsKCiAgICAgIGlmIChqID4gaSkgewogICAgICAgIGNvbnN0IHRlbXAgPSBqOwogICAgICAgIGogPSBpOwogICAgICAgIGkgPSB0ZW1wOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5tYXRyaXhbKGkgKiAoaSArIDEpID4+IDEpICsgaiAtIDFdOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgYW4gZWxlbWVudAogICAgICovCgoKICAgIHNldChiaSwgYmosIHZhbHVlKSB7CiAgICAgIGxldCB7CiAgICAgICAgaW5kZXg6IGkKICAgICAgfSA9IGJpOwogICAgICBsZXQgewogICAgICAgIGluZGV4OiBqCiAgICAgIH0gPSBiajsKCiAgICAgIGlmIChqID4gaSkgewogICAgICAgIGNvbnN0IHRlbXAgPSBqOwogICAgICAgIGogPSBpOwogICAgICAgIGkgPSB0ZW1wOwogICAgICB9CgogICAgICB0aGlzLm1hdHJpeFsoaSAqIChpICsgMSkgPj4gMSkgKyBqIC0gMV0gPSB2YWx1ZSA/IDEgOiAwOwogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIGFsbCBlbGVtZW50cyB0byB6ZXJvCiAgICAgKi8KCgogICAgcmVzZXQoKSB7CiAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gdGhpcy5tYXRyaXgubGVuZ3RoOyBpICE9PSBsOyBpKyspIHsKICAgICAgICB0aGlzLm1hdHJpeFtpXSA9IDA7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogU2V0cyB0aGUgbWF4IG51bWJlciBvZiBvYmplY3RzCiAgICAgKi8KCgogICAgc2V0TnVtT2JqZWN0cyhuKSB7CiAgICAgIHRoaXMubWF0cml4Lmxlbmd0aCA9IG4gKiAobiAtIDEpID4+IDE7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQmFzZSBjbGFzcyBmb3Igb2JqZWN0cyB0aGF0IGRpc3BhdGNoZXMgZXZlbnRzLgogICAqLwogIGNsYXNzIEV2ZW50VGFyZ2V0IHsKICAgIC8qKgogICAgICogQWRkIGFuIGV2ZW50IGxpc3RlbmVyCiAgICAgKiBAcmV0dXJuIFRoZSBzZWxmIG9iamVjdCwgZm9yIGNoYWluYWJpbGl0eS4KICAgICAqLwogICAgYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikgewogICAgICBpZiAodGhpcy5fbGlzdGVuZXJzID09PSB1bmRlZmluZWQpIHsKICAgICAgICB0aGlzLl9saXN0ZW5lcnMgPSB7fTsKICAgICAgfQoKICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzOwoKICAgICAgaWYgKGxpc3RlbmVyc1t0eXBlXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgbGlzdGVuZXJzW3R5cGVdID0gW107CiAgICAgIH0KCiAgICAgIGlmICghbGlzdGVuZXJzW3R5cGVdLmluY2x1ZGVzKGxpc3RlbmVyKSkgewogICAgICAgIGxpc3RlbmVyc1t0eXBlXS5wdXNoKGxpc3RlbmVyKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIGFuIGV2ZW50IGxpc3RlbmVyIGlzIGFkZGVkCiAgICAgKi8KCgogICAgaGFzRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikgewogICAgICBpZiAodGhpcy5fbGlzdGVuZXJzID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVyczsKCiAgICAgIGlmIChsaXN0ZW5lcnNbdHlwZV0gIT09IHVuZGVmaW5lZCAmJiBsaXN0ZW5lcnNbdHlwZV0uaW5jbHVkZXMobGlzdGVuZXIpKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogQ2hlY2sgaWYgYW55IGV2ZW50IGxpc3RlbmVyIG9mIHRoZSBnaXZlbiB0eXBlIGlzIGFkZGVkCiAgICAgKi8KCgogICAgaGFzQW55RXZlbnRMaXN0ZW5lcih0eXBlKSB7CiAgICAgIGlmICh0aGlzLl9saXN0ZW5lcnMgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzOwogICAgICByZXR1cm4gbGlzdGVuZXJzW3R5cGVdICE9PSB1bmRlZmluZWQ7CiAgICB9CiAgICAvKioKICAgICAqIFJlbW92ZSBhbiBldmVudCBsaXN0ZW5lcgogICAgICogQHJldHVybiBUaGUgc2VsZiBvYmplY3QsIGZvciBjaGFpbmFiaWxpdHkuCiAgICAgKi8KCgogICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikgewogICAgICBpZiAodGhpcy5fbGlzdGVuZXJzID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQoKICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzOwoKICAgICAgaWYgKGxpc3RlbmVyc1t0eXBlXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICAgIGNvbnN0IGluZGV4ID0gbGlzdGVuZXJzW3R5cGVdLmluZGV4T2YobGlzdGVuZXIpOwoKICAgICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICAgIGxpc3RlbmVyc1t0eXBlXS5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogRW1pdCBhbiBldmVudC4KICAgICAqIEByZXR1cm4gVGhlIHNlbGYgb2JqZWN0LCBmb3IgY2hhaW5hYmlsaXR5LgogICAgICovCgoKICAgIGRpc3BhdGNoRXZlbnQoZXZlbnQpIHsKICAgICAgaWYgKHRoaXMuX2xpc3RlbmVycyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVyczsKICAgICAgY29uc3QgbGlzdGVuZXJBcnJheSA9IGxpc3RlbmVyc1tldmVudC50eXBlXTsKCiAgICAgIGlmIChsaXN0ZW5lckFycmF5ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBldmVudC50YXJnZXQgPSB0aGlzOwoKICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGxpc3RlbmVyQXJyYXkubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgICBsaXN0ZW5lckFycmF5W2ldLmNhbGwodGhpcywgZXZlbnQpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQSBRdWF0ZXJuaW9uIGRlc2NyaWJlcyBhIHJvdGF0aW9uIGluIDNEIHNwYWNlLiBUaGUgUXVhdGVybmlvbiBpcyBtYXRoZW1hdGljYWxseSBkZWZpbmVkIGFzIFEgPSB4KmkgKyB5KmogKyB6KmsgKyB3LCB3aGVyZSAoaSxqLGspIGFyZSBpbWFnaW5hcnkgYmFzaXMgdmVjdG9ycy4gKHgseSx6KSBjYW4gYmUgc2VlbiBhcyBhIHZlY3RvciByZWxhdGVkIHRvIHRoZSBheGlzIG9mIHJvdGF0aW9uLCB3aGlsZSB0aGUgcmVhbCBtdWx0aXBsaWVyLCB3LCBpcyByZWxhdGVkIHRvIHRoZSBhbW91bnQgb2Ygcm90YXRpb24uCiAgICogQHBhcmFtIHggTXVsdGlwbGllciBvZiB0aGUgaW1hZ2luYXJ5IGJhc2lzIHZlY3RvciBpLgogICAqIEBwYXJhbSB5IE11bHRpcGxpZXIgb2YgdGhlIGltYWdpbmFyeSBiYXNpcyB2ZWN0b3Igai4KICAgKiBAcGFyYW0geiBNdWx0aXBsaWVyIG9mIHRoZSBpbWFnaW5hcnkgYmFzaXMgdmVjdG9yIGsuCiAgICogQHBhcmFtIHcgTXVsdGlwbGllciBvZiB0aGUgcmVhbCBwYXJ0LgogICAqIEBzZWUgaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9RdWF0ZXJuaW9uCiAgICovCgogIGNsYXNzIFF1YXRlcm5pb24gewogICAgY29uc3RydWN0b3IoeCwgeSwgeiwgdykgewogICAgICBpZiAoeCA9PT0gdm9pZCAwKSB7CiAgICAgICAgeCA9IDA7CiAgICAgIH0KCiAgICAgIGlmICh5ID09PSB2b2lkIDApIHsKICAgICAgICB5ID0gMDsKICAgICAgfQoKICAgICAgaWYgKHogPT09IHZvaWQgMCkgewogICAgICAgIHogPSAwOwogICAgICB9CgogICAgICBpZiAodyA9PT0gdm9pZCAwKSB7CiAgICAgICAgdyA9IDE7CiAgICAgIH0KCiAgICAgIHRoaXMueCA9IHg7CiAgICAgIHRoaXMueSA9IHk7CiAgICAgIHRoaXMueiA9IHo7CiAgICAgIHRoaXMudyA9IHc7CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgdmFsdWUgb2YgdGhlIHF1YXRlcm5pb24uCiAgICAgKi8KCgogICAgc2V0KHgsIHksIHosIHcpIHsKICAgICAgdGhpcy54ID0geDsKICAgICAgdGhpcy55ID0geTsKICAgICAgdGhpcy56ID0gejsKICAgICAgdGhpcy53ID0gdzsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgdG8gYSByZWFkYWJsZSBmb3JtYXQKICAgICAqIEByZXR1cm4gIngseSx6LHciCiAgICAgKi8KCgogICAgdG9TdHJpbmcoKSB7CiAgICAgIHJldHVybiBgJHt0aGlzLnh9LCR7dGhpcy55fSwke3RoaXMuen0sJHt0aGlzLnd9YDsKICAgIH0KICAgIC8qKgogICAgICogQ29udmVydCB0byBhbiBBcnJheQogICAgICogQHJldHVybiBbeCwgeSwgeiwgd10KICAgICAqLwoKCiAgICB0b0FycmF5KCkgewogICAgICByZXR1cm4gW3RoaXMueCwgdGhpcy55LCB0aGlzLnosIHRoaXMud107CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgcXVhdGVybmlvbiBjb21wb25lbnRzIGdpdmVuIGFuIGF4aXMgYW5kIGFuIGFuZ2xlIGluIHJhZGlhbnMuCiAgICAgKi8KCgogICAgc2V0RnJvbUF4aXNBbmdsZSh2ZWN0b3IsIGFuZ2xlKSB7CiAgICAgIGNvbnN0IHMgPSBNYXRoLnNpbihhbmdsZSAqIDAuNSk7CiAgICAgIHRoaXMueCA9IHZlY3Rvci54ICogczsKICAgICAgdGhpcy55ID0gdmVjdG9yLnkgKiBzOwogICAgICB0aGlzLnogPSB2ZWN0b3IueiAqIHM7CiAgICAgIHRoaXMudyA9IE1hdGguY29zKGFuZ2xlICogMC41KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnRzIHRoZSBxdWF0ZXJuaW9uIHRvIFsgYXhpcywgYW5nbGUgXSByZXByZXNlbnRhdGlvbi4KICAgICAqIEBwYXJhbSB0YXJnZXRBeGlzIEEgdmVjdG9yIG9iamVjdCB0byByZXVzZSBmb3Igc3RvcmluZyB0aGUgYXhpcy4KICAgICAqIEByZXR1cm4gQW4gYXJyYXksIGZpcnN0IGVsZW1lbnQgaXMgdGhlIGF4aXMgYW5kIHRoZSBzZWNvbmQgaXMgdGhlIGFuZ2xlIGluIHJhZGlhbnMuCiAgICAgKi8KCgogICAgdG9BeGlzQW5nbGUodGFyZ2V0QXhpcykgewogICAgICBpZiAodGFyZ2V0QXhpcyA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0QXhpcyA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHRoaXMubm9ybWFsaXplKCk7IC8vIGlmIHc+MSBhY29zIGFuZCBzcXJ0IHdpbGwgcHJvZHVjZSBlcnJvcnMsIHRoaXMgY2FudCBoYXBwZW4gaWYgcXVhdGVybmlvbiBpcyBub3JtYWxpc2VkCgogICAgICBjb25zdCBhbmdsZSA9IDIgKiBNYXRoLmFjb3ModGhpcy53KTsKICAgICAgY29uc3QgcyA9IE1hdGguc3FydCgxIC0gdGhpcy53ICogdGhpcy53KTsgLy8gYXNzdW1pbmcgcXVhdGVybmlvbiBub3JtYWxpc2VkIHRoZW4gdyBpcyBsZXNzIHRoYW4gMSwgc28gdGVybSBhbHdheXMgcG9zaXRpdmUuCgogICAgICBpZiAocyA8IDAuMDAxKSB7CiAgICAgICAgLy8gdGVzdCB0byBhdm9pZCBkaXZpZGUgYnkgemVybywgcyBpcyBhbHdheXMgcG9zaXRpdmUgZHVlIHRvIHNxcnQKICAgICAgICAvLyBpZiBzIGNsb3NlIHRvIHplcm8gdGhlbiBkaXJlY3Rpb24gb2YgYXhpcyBub3QgaW1wb3J0YW50CiAgICAgICAgdGFyZ2V0QXhpcy54ID0gdGhpcy54OyAvLyBpZiBpdCBpcyBpbXBvcnRhbnQgdGhhdCBheGlzIGlzIG5vcm1hbGlzZWQgdGhlbiByZXBsYWNlIHdpdGggeD0xOyB5PXo9MDsKCiAgICAgICAgdGFyZ2V0QXhpcy55ID0gdGhpcy55OwogICAgICAgIHRhcmdldEF4aXMueiA9IHRoaXMuejsKICAgICAgfSBlbHNlIHsKICAgICAgICB0YXJnZXRBeGlzLnggPSB0aGlzLnggLyBzOyAvLyBub3JtYWxpc2UgYXhpcwoKICAgICAgICB0YXJnZXRBeGlzLnkgPSB0aGlzLnkgLyBzOwogICAgICAgIHRhcmdldEF4aXMueiA9IHRoaXMueiAvIHM7CiAgICAgIH0KCiAgICAgIHJldHVybiBbdGFyZ2V0QXhpcywgYW5nbGVdOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIHF1YXRlcm5pb24gdmFsdWUgZ2l2ZW4gdHdvIHZlY3RvcnMuIFRoZSByZXN1bHRpbmcgcm90YXRpb24gd2lsbCBiZSB0aGUgbmVlZGVkIHJvdGF0aW9uIHRvIHJvdGF0ZSB1IHRvIHYuCiAgICAgKi8KCgogICAgc2V0RnJvbVZlY3RvcnModSwgdikgewogICAgICBpZiAodS5pc0FudGlwYXJhbGxlbFRvKHYpKSB7CiAgICAgICAgY29uc3QgdDEgPSBzZnZfdDE7CiAgICAgICAgY29uc3QgdDIgPSBzZnZfdDI7CiAgICAgICAgdS50YW5nZW50cyh0MSwgdDIpOwogICAgICAgIHRoaXMuc2V0RnJvbUF4aXNBbmdsZSh0MSwgTWF0aC5QSSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgYSA9IHUuY3Jvc3Modik7CiAgICAgICAgdGhpcy54ID0gYS54OwogICAgICAgIHRoaXMueSA9IGEueTsKICAgICAgICB0aGlzLnogPSBhLno7CiAgICAgICAgdGhpcy53ID0gTWF0aC5zcXJ0KHUubGVuZ3RoKCkgKiogMiAqIHYubGVuZ3RoKCkgKiogMikgKyB1LmRvdCh2KTsKICAgICAgICB0aGlzLm5vcm1hbGl6ZSgpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogTXVsdGlwbHkgdGhlIHF1YXRlcm5pb24gd2l0aCBhbiBvdGhlciBxdWF0ZXJuaW9uLgogICAgICovCgoKICAgIG11bHQocXVhdCwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGF4ID0gdGhpcy54OwogICAgICBjb25zdCBheSA9IHRoaXMueTsKICAgICAgY29uc3QgYXogPSB0aGlzLno7CiAgICAgIGNvbnN0IGF3ID0gdGhpcy53OwogICAgICBjb25zdCBieCA9IHF1YXQueDsKICAgICAgY29uc3QgYnkgPSBxdWF0Lnk7CiAgICAgIGNvbnN0IGJ6ID0gcXVhdC56OwogICAgICBjb25zdCBidyA9IHF1YXQudzsKICAgICAgdGFyZ2V0LnggPSBheCAqIGJ3ICsgYXcgKiBieCArIGF5ICogYnogLSBheiAqIGJ5OwogICAgICB0YXJnZXQueSA9IGF5ICogYncgKyBhdyAqIGJ5ICsgYXogKiBieCAtIGF4ICogYno7CiAgICAgIHRhcmdldC56ID0gYXogKiBidyArIGF3ICogYnogKyBheCAqIGJ5IC0gYXkgKiBieDsKICAgICAgdGFyZ2V0LncgPSBhdyAqIGJ3IC0gYXggKiBieCAtIGF5ICogYnkgLSBheiAqIGJ6OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGludmVyc2UgcXVhdGVybmlvbiByb3RhdGlvbi4KICAgICAqLwoKCiAgICBpbnZlcnNlKHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgUXVhdGVybmlvbigpOwogICAgICB9CgogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICBjb25zdCB3ID0gdGhpcy53OwogICAgICB0aGlzLmNvbmp1Z2F0ZSh0YXJnZXQpOwogICAgICBjb25zdCBpbm9ybTIgPSAxIC8gKHggKiB4ICsgeSAqIHkgKyB6ICogeiArIHcgKiB3KTsKICAgICAgdGFyZ2V0LnggKj0gaW5vcm0yOwogICAgICB0YXJnZXQueSAqPSBpbm9ybTI7CiAgICAgIHRhcmdldC56ICo9IGlub3JtMjsKICAgICAgdGFyZ2V0LncgKj0gaW5vcm0yOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHF1YXRlcm5pb24gY29uanVnYXRlCiAgICAgKi8KCgogICAgY29uanVnYXRlKHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgUXVhdGVybmlvbigpOwogICAgICB9CgogICAgICB0YXJnZXQueCA9IC10aGlzLng7CiAgICAgIHRhcmdldC55ID0gLXRoaXMueTsKICAgICAgdGFyZ2V0LnogPSAtdGhpcy56OwogICAgICB0YXJnZXQudyA9IHRoaXMudzsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogTm9ybWFsaXplIHRoZSBxdWF0ZXJuaW9uLiBOb3RlIHRoYXQgdGhpcyBjaGFuZ2VzIHRoZSB2YWx1ZXMgb2YgdGhlIHF1YXRlcm5pb24uCiAgICAgKi8KCgogICAgbm9ybWFsaXplKCkgewogICAgICBsZXQgbCA9IE1hdGguc3FydCh0aGlzLnggKiB0aGlzLnggKyB0aGlzLnkgKiB0aGlzLnkgKyB0aGlzLnogKiB0aGlzLnogKyB0aGlzLncgKiB0aGlzLncpOwoKICAgICAgaWYgKGwgPT09IDApIHsKICAgICAgICB0aGlzLnggPSAwOwogICAgICAgIHRoaXMueSA9IDA7CiAgICAgICAgdGhpcy56ID0gMDsKICAgICAgICB0aGlzLncgPSAwOwogICAgICB9IGVsc2UgewogICAgICAgIGwgPSAxIC8gbDsKICAgICAgICB0aGlzLnggKj0gbDsKICAgICAgICB0aGlzLnkgKj0gbDsKICAgICAgICB0aGlzLnogKj0gbDsKICAgICAgICB0aGlzLncgKj0gbDsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIEFwcHJveGltYXRpb24gb2YgcXVhdGVybmlvbiBub3JtYWxpemF0aW9uLiBXb3JrcyBiZXN0IHdoZW4gcXVhdCBpcyBhbHJlYWR5IGFsbW9zdC1ub3JtYWxpemVkLgogICAgICogQGF1dGhvciB1bnBoYXNlZCwgaHR0cHM6Ly9naXRodWIuY29tL3VucGhhc2VkCiAgICAgKi8KCgogICAgbm9ybWFsaXplRmFzdCgpIHsKICAgICAgY29uc3QgZiA9ICgzLjAgLSAodGhpcy54ICogdGhpcy54ICsgdGhpcy55ICogdGhpcy55ICsgdGhpcy56ICogdGhpcy56ICsgdGhpcy53ICogdGhpcy53KSkgLyAyLjA7CgogICAgICBpZiAoZiA9PT0gMCkgewogICAgICAgIHRoaXMueCA9IDA7CiAgICAgICAgdGhpcy55ID0gMDsKICAgICAgICB0aGlzLnogPSAwOwogICAgICAgIHRoaXMudyA9IDA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy54ICo9IGY7CiAgICAgICAgdGhpcy55ICo9IGY7CiAgICAgICAgdGhpcy56ICo9IGY7CiAgICAgICAgdGhpcy53ICo9IGY7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSB0aGUgcXVhdGVybmlvbiBieSBhIHZlY3RvcgogICAgICovCgoKICAgIHZtdWx0KHYsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCB4ID0gdi54OwogICAgICBjb25zdCB5ID0gdi55OwogICAgICBjb25zdCB6ID0gdi56OwogICAgICBjb25zdCBxeCA9IHRoaXMueDsKICAgICAgY29uc3QgcXkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHF6ID0gdGhpcy56OwogICAgICBjb25zdCBxdyA9IHRoaXMudzsgLy8gcSp2CgogICAgICBjb25zdCBpeCA9IHF3ICogeCArIHF5ICogeiAtIHF6ICogeTsKICAgICAgY29uc3QgaXkgPSBxdyAqIHkgKyBxeiAqIHggLSBxeCAqIHo7CiAgICAgIGNvbnN0IGl6ID0gcXcgKiB6ICsgcXggKiB5IC0gcXkgKiB4OwogICAgICBjb25zdCBpdyA9IC1xeCAqIHggLSBxeSAqIHkgLSBxeiAqIHo7CiAgICAgIHRhcmdldC54ID0gaXggKiBxdyArIGl3ICogLXF4ICsgaXkgKiAtcXogLSBpeiAqIC1xeTsKICAgICAgdGFyZ2V0LnkgPSBpeSAqIHF3ICsgaXcgKiAtcXkgKyBpeiAqIC1xeCAtIGl4ICogLXF6OwogICAgICB0YXJnZXQueiA9IGl6ICogcXcgKyBpdyAqIC1xeiArIGl4ICogLXF5IC0gaXkgKiAtcXg7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIENvcGllcyB2YWx1ZSBvZiBzb3VyY2UgdG8gdGhpcyBxdWF0ZXJuaW9uLgogICAgICogQHJldHVybiB0aGlzCiAgICAgKi8KCgogICAgY29weShxdWF0KSB7CiAgICAgIHRoaXMueCA9IHF1YXQueDsKICAgICAgdGhpcy55ID0gcXVhdC55OwogICAgICB0aGlzLnogPSBxdWF0Lno7CiAgICAgIHRoaXMudyA9IHF1YXQudzsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgdGhlIHF1YXRlcm5pb24gdG8gZXVsZXIgYW5nbGUgcmVwcmVzZW50YXRpb24uIE9yZGVyOiBZWlgsIGFzIHRoaXMgcGFnZSBkZXNjcmliZXM6IGh0dHBzOi8vd3d3LmV1Y2xpZGVhbnNwYWNlLmNvbS9tYXRocy9zdGFuZGFyZHMvaW5kZXguaHRtCiAgICAgKiBAcGFyYW0gb3JkZXIgVGhyZWUtY2hhcmFjdGVyIHN0cmluZywgZGVmYXVsdHMgdG8gIllaWCIKICAgICAqLwoKCiAgICB0b0V1bGVyKHRhcmdldCwgb3JkZXIpIHsKICAgICAgaWYgKG9yZGVyID09PSB2b2lkIDApIHsKICAgICAgICBvcmRlciA9ICdZWlgnOwogICAgICB9CgogICAgICBsZXQgaGVhZGluZzsKICAgICAgbGV0IGF0dGl0dWRlOwogICAgICBsZXQgYmFuazsKICAgICAgY29uc3QgeCA9IHRoaXMueDsKICAgICAgY29uc3QgeSA9IHRoaXMueTsKICAgICAgY29uc3QgeiA9IHRoaXMuejsKICAgICAgY29uc3QgdyA9IHRoaXMudzsKCiAgICAgIHN3aXRjaCAob3JkZXIpIHsKICAgICAgICBjYXNlICdZWlgnOgogICAgICAgICAgY29uc3QgdGVzdCA9IHggKiB5ICsgeiAqIHc7CgogICAgICAgICAgaWYgKHRlc3QgPiAwLjQ5OSkgewogICAgICAgICAgICAvLyBzaW5ndWxhcml0eSBhdCBub3J0aCBwb2xlCiAgICAgICAgICAgIGhlYWRpbmcgPSAyICogTWF0aC5hdGFuMih4LCB3KTsKICAgICAgICAgICAgYXR0aXR1ZGUgPSBNYXRoLlBJIC8gMjsKICAgICAgICAgICAgYmFuayA9IDA7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHRlc3QgPCAtMC40OTkpIHsKICAgICAgICAgICAgLy8gc2luZ3VsYXJpdHkgYXQgc291dGggcG9sZQogICAgICAgICAgICBoZWFkaW5nID0gLTIgKiBNYXRoLmF0YW4yKHgsIHcpOwogICAgICAgICAgICBhdHRpdHVkZSA9IC1NYXRoLlBJIC8gMjsKICAgICAgICAgICAgYmFuayA9IDA7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGhlYWRpbmcgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjb25zdCBzcXggPSB4ICogeDsKICAgICAgICAgICAgY29uc3Qgc3F5ID0geSAqIHk7CiAgICAgICAgICAgIGNvbnN0IHNxeiA9IHogKiB6OwogICAgICAgICAgICBoZWFkaW5nID0gTWF0aC5hdGFuMigyICogeSAqIHcgLSAyICogeCAqIHosIDEgLSAyICogc3F5IC0gMiAqIHNxeik7IC8vIEhlYWRpbmcKCiAgICAgICAgICAgIGF0dGl0dWRlID0gTWF0aC5hc2luKDIgKiB0ZXN0KTsgLy8gYXR0aXR1ZGUKCiAgICAgICAgICAgIGJhbmsgPSBNYXRoLmF0YW4yKDIgKiB4ICogdyAtIDIgKiB5ICogeiwgMSAtIDIgKiBzcXggLSAyICogc3F6KTsgLy8gYmFuawogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFdWxlciBvcmRlciAke29yZGVyfSBub3Qgc3VwcG9ydGVkIHlldC5gKTsKICAgICAgfQoKICAgICAgdGFyZ2V0LnkgPSBoZWFkaW5nOwogICAgICB0YXJnZXQueiA9IGF0dGl0dWRlOwogICAgICB0YXJnZXQueCA9IGJhbms7CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgcXVhdGVybmlvbiBjb21wb25lbnRzIGdpdmVuIEV1bGVyIGFuZ2xlIHJlcHJlc2VudGF0aW9uLgogICAgICoKICAgICAqIEBwYXJhbSBvcmRlciBUaGUgb3JkZXIgdG8gYXBwbHkgYW5nbGVzOiAnWFlaJyBvciAnWVhaJyBvciBhbnkgb3RoZXIgY29tYmluYXRpb24uCiAgICAgKgogICAgICogU2VlIHtAbGluayBodHRwczovL3d3dy5tYXRod29ya3MuY29tL21hdGxhYmNlbnRyYWwvZmlsZWV4Y2hhbmdlLzIwNjk2LWZ1bmN0aW9uLXRvLWNvbnZlcnQtYmV0d2Vlbi1kY20tZXVsZXItYW5nbGVzLXF1YXRlcm5pb25zLWFuZC1ldWxlci12ZWN0b3JzIE1hdGhXb3Jrc30gcmVmZXJlbmNlCiAgICAgKi8KCgogICAgc2V0RnJvbUV1bGVyKHgsIHksIHosIG9yZGVyKSB7CiAgICAgIGlmIChvcmRlciA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3JkZXIgPSAnWFlaJzsKICAgICAgfQoKICAgICAgY29uc3QgYzEgPSBNYXRoLmNvcyh4IC8gMik7CiAgICAgIGNvbnN0IGMyID0gTWF0aC5jb3MoeSAvIDIpOwogICAgICBjb25zdCBjMyA9IE1hdGguY29zKHogLyAyKTsKICAgICAgY29uc3QgczEgPSBNYXRoLnNpbih4IC8gMik7CiAgICAgIGNvbnN0IHMyID0gTWF0aC5zaW4oeSAvIDIpOwogICAgICBjb25zdCBzMyA9IE1hdGguc2luKHogLyAyKTsKCiAgICAgIGlmIChvcmRlciA9PT0gJ1hZWicpIHsKICAgICAgICB0aGlzLnggPSBzMSAqIGMyICogYzMgKyBjMSAqIHMyICogczM7CiAgICAgICAgdGhpcy55ID0gYzEgKiBzMiAqIGMzIC0gczEgKiBjMiAqIHMzOwogICAgICAgIHRoaXMueiA9IGMxICogYzIgKiBzMyArIHMxICogczIgKiBjMzsKICAgICAgICB0aGlzLncgPSBjMSAqIGMyICogYzMgLSBzMSAqIHMyICogczM7CiAgICAgIH0gZWxzZSBpZiAob3JkZXIgPT09ICdZWFonKSB7CiAgICAgICAgdGhpcy54ID0gczEgKiBjMiAqIGMzICsgYzEgKiBzMiAqIHMzOwogICAgICAgIHRoaXMueSA9IGMxICogczIgKiBjMyAtIHMxICogYzIgKiBzMzsKICAgICAgICB0aGlzLnogPSBjMSAqIGMyICogczMgLSBzMSAqIHMyICogYzM7CiAgICAgICAgdGhpcy53ID0gYzEgKiBjMiAqIGMzICsgczEgKiBzMiAqIHMzOwogICAgICB9IGVsc2UgaWYgKG9yZGVyID09PSAnWlhZJykgewogICAgICAgIHRoaXMueCA9IHMxICogYzIgKiBjMyAtIGMxICogczIgKiBzMzsKICAgICAgICB0aGlzLnkgPSBjMSAqIHMyICogYzMgKyBzMSAqIGMyICogczM7CiAgICAgICAgdGhpcy56ID0gYzEgKiBjMiAqIHMzICsgczEgKiBzMiAqIGMzOwogICAgICAgIHRoaXMudyA9IGMxICogYzIgKiBjMyAtIHMxICogczIgKiBzMzsKICAgICAgfSBlbHNlIGlmIChvcmRlciA9PT0gJ1pZWCcpIHsKICAgICAgICB0aGlzLnggPSBzMSAqIGMyICogYzMgLSBjMSAqIHMyICogczM7CiAgICAgICAgdGhpcy55ID0gYzEgKiBzMiAqIGMzICsgczEgKiBjMiAqIHMzOwogICAgICAgIHRoaXMueiA9IGMxICogYzIgKiBzMyAtIHMxICogczIgKiBjMzsKICAgICAgICB0aGlzLncgPSBjMSAqIGMyICogYzMgKyBzMSAqIHMyICogczM7CiAgICAgIH0gZWxzZSBpZiAob3JkZXIgPT09ICdZWlgnKSB7CiAgICAgICAgdGhpcy54ID0gczEgKiBjMiAqIGMzICsgYzEgKiBzMiAqIHMzOwogICAgICAgIHRoaXMueSA9IGMxICogczIgKiBjMyArIHMxICogYzIgKiBzMzsKICAgICAgICB0aGlzLnogPSBjMSAqIGMyICogczMgLSBzMSAqIHMyICogYzM7CiAgICAgICAgdGhpcy53ID0gYzEgKiBjMiAqIGMzIC0gczEgKiBzMiAqIHMzOwogICAgICB9IGVsc2UgaWYgKG9yZGVyID09PSAnWFpZJykgewogICAgICAgIHRoaXMueCA9IHMxICogYzIgKiBjMyAtIGMxICogczIgKiBzMzsKICAgICAgICB0aGlzLnkgPSBjMSAqIHMyICogYzMgLSBzMSAqIGMyICogczM7CiAgICAgICAgdGhpcy56ID0gYzEgKiBjMiAqIHMzICsgczEgKiBzMiAqIGMzOwogICAgICAgIHRoaXMudyA9IGMxICogYzIgKiBjMyArIHMxICogczIgKiBzMzsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgY2xvbmUoKSB7CiAgICAgIHJldHVybiBuZXcgUXVhdGVybmlvbih0aGlzLngsIHRoaXMueSwgdGhpcy56LCB0aGlzLncpOwogICAgfQogICAgLyoqCiAgICAgKiBQZXJmb3JtcyBhIHNwaGVyaWNhbCBsaW5lYXIgaW50ZXJwb2xhdGlvbiBiZXR3ZWVuIHR3byBxdWF0CiAgICAgKgogICAgICogQHBhcmFtIHRvUXVhdCBzZWNvbmQgb3BlcmFuZAogICAgICogQHBhcmFtIHQgaW50ZXJwb2xhdGlvbiBhbW91bnQgYmV0d2VlbiB0aGUgc2VsZiBxdWF0ZXJuaW9uIGFuZCB0b1F1YXQKICAgICAqIEBwYXJhbSB0YXJnZXQgQSBxdWF0ZXJuaW9uIHRvIHN0b3JlIHRoZSByZXN1bHQgaW4uIElmIG5vdCBwcm92aWRlZCwgYSBuZXcgb25lIHdpbGwgYmUgY3JlYXRlZC4KICAgICAqIEByZXR1cm5zIHtRdWF0ZXJuaW9ufSBUaGUgInRhcmdldCIgb2JqZWN0CiAgICAgKi8KCgogICAgc2xlcnAodG9RdWF0LCB0LCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgfQoKICAgICAgY29uc3QgYXggPSB0aGlzLng7CiAgICAgIGNvbnN0IGF5ID0gdGhpcy55OwogICAgICBjb25zdCBheiA9IHRoaXMuejsKICAgICAgY29uc3QgYXcgPSB0aGlzLnc7CiAgICAgIGxldCBieCA9IHRvUXVhdC54OwogICAgICBsZXQgYnkgPSB0b1F1YXQueTsKICAgICAgbGV0IGJ6ID0gdG9RdWF0Lno7CiAgICAgIGxldCBidyA9IHRvUXVhdC53OwogICAgICBsZXQgb21lZ2E7CiAgICAgIGxldCBjb3NvbTsKICAgICAgbGV0IHNpbm9tOwogICAgICBsZXQgc2NhbGUwOwogICAgICBsZXQgc2NhbGUxOyAvLyBjYWxjIGNvc2luZQoKICAgICAgY29zb20gPSBheCAqIGJ4ICsgYXkgKiBieSArIGF6ICogYnogKyBhdyAqIGJ3OyAvLyBhZGp1c3Qgc2lnbnMgKGlmIG5lY2Vzc2FyeSkKCiAgICAgIGlmIChjb3NvbSA8IDAuMCkgewogICAgICAgIGNvc29tID0gLWNvc29tOwogICAgICAgIGJ4ID0gLWJ4OwogICAgICAgIGJ5ID0gLWJ5OwogICAgICAgIGJ6ID0gLWJ6OwogICAgICAgIGJ3ID0gLWJ3OwogICAgICB9IC8vIGNhbGN1bGF0ZSBjb2VmZmljaWVudHMKCgogICAgICBpZiAoMS4wIC0gY29zb20gPiAwLjAwMDAwMSkgewogICAgICAgIC8vIHN0YW5kYXJkIGNhc2UgKHNsZXJwKQogICAgICAgIG9tZWdhID0gTWF0aC5hY29zKGNvc29tKTsKICAgICAgICBzaW5vbSA9IE1hdGguc2luKG9tZWdhKTsKICAgICAgICBzY2FsZTAgPSBNYXRoLnNpbigoMS4wIC0gdCkgKiBvbWVnYSkgLyBzaW5vbTsKICAgICAgICBzY2FsZTEgPSBNYXRoLnNpbih0ICogb21lZ2EpIC8gc2lub207CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gImZyb20iIGFuZCAidG8iIHF1YXRlcm5pb25zIGFyZSB2ZXJ5IGNsb3NlCiAgICAgICAgLy8gIC4uLiBzbyB3ZSBjYW4gZG8gYSBsaW5lYXIgaW50ZXJwb2xhdGlvbgogICAgICAgIHNjYWxlMCA9IDEuMCAtIHQ7CiAgICAgICAgc2NhbGUxID0gdDsKICAgICAgfSAvLyBjYWxjdWxhdGUgZmluYWwgdmFsdWVzCgoKICAgICAgdGFyZ2V0LnggPSBzY2FsZTAgKiBheCArIHNjYWxlMSAqIGJ4OwogICAgICB0YXJnZXQueSA9IHNjYWxlMCAqIGF5ICsgc2NhbGUxICogYnk7CiAgICAgIHRhcmdldC56ID0gc2NhbGUwICogYXogKyBzY2FsZTEgKiBiejsKICAgICAgdGFyZ2V0LncgPSBzY2FsZTAgKiBhdyArIHNjYWxlMSAqIGJ3OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBSb3RhdGUgYW4gYWJzb2x1dGUgb3JpZW50YXRpb24gcXVhdGVybmlvbiBnaXZlbiBhbiBhbmd1bGFyIHZlbG9jaXR5IGFuZCBhIHRpbWUgc3RlcC4KICAgICAqLwoKCiAgICBpbnRlZ3JhdGUoYW5ndWxhclZlbG9jaXR5LCBkdCwgYW5ndWxhckZhY3RvciwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGF4ID0gYW5ndWxhclZlbG9jaXR5LnggKiBhbmd1bGFyRmFjdG9yLngsCiAgICAgICAgICAgIGF5ID0gYW5ndWxhclZlbG9jaXR5LnkgKiBhbmd1bGFyRmFjdG9yLnksCiAgICAgICAgICAgIGF6ID0gYW5ndWxhclZlbG9jaXR5LnogKiBhbmd1bGFyRmFjdG9yLnosCiAgICAgICAgICAgIGJ4ID0gdGhpcy54LAogICAgICAgICAgICBieSA9IHRoaXMueSwKICAgICAgICAgICAgYnogPSB0aGlzLnosCiAgICAgICAgICAgIGJ3ID0gdGhpcy53OwogICAgICBjb25zdCBoYWxmX2R0ID0gZHQgKiAwLjU7CiAgICAgIHRhcmdldC54ICs9IGhhbGZfZHQgKiAoYXggKiBidyArIGF5ICogYnogLSBheiAqIGJ5KTsKICAgICAgdGFyZ2V0LnkgKz0gaGFsZl9kdCAqIChheSAqIGJ3ICsgYXogKiBieCAtIGF4ICogYnopOwogICAgICB0YXJnZXQueiArPSBoYWxmX2R0ICogKGF6ICogYncgKyBheCAqIGJ5IC0gYXkgKiBieCk7CiAgICAgIHRhcmdldC53ICs9IGhhbGZfZHQgKiAoLWF4ICogYnggLSBheSAqIGJ5IC0gYXogKiBieik7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CgogIH0KICBjb25zdCBzZnZfdDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNmdl90MiA9IG5ldyBWZWMzKCk7CgogIC8qKgogICAqIFRoZSBhdmFpbGFibGUgc2hhcGUgdHlwZXMuCiAgICovCiAgY29uc3QgU0hBUEVfVFlQRVMgPSB7CiAgICAvKiogU1BIRVJFICovCiAgICBTUEhFUkU6IDEsCgogICAgLyoqIFBMQU5FICovCiAgICBQTEFORTogMiwKCiAgICAvKiogQk9YICovCiAgICBCT1g6IDQsCgogICAgLyoqIENPTVBPVU5EICovCiAgICBDT01QT1VORDogOCwKCiAgICAvKiogQ09OVkVYUE9MWUhFRFJPTiAqLwogICAgQ09OVkVYUE9MWUhFRFJPTjogMTYsCgogICAgLyoqIEhFSUdIVEZJRUxEICovCiAgICBIRUlHSFRGSUVMRDogMzIsCgogICAgLyoqIFBBUlRJQ0xFICovCiAgICBQQVJUSUNMRTogNjQsCgogICAgLyoqIENZTElOREVSICovCiAgICBDWUxJTkRFUjogMTI4LAoKICAgIC8qKiBUUklNRVNIICovCiAgICBUUklNRVNIOiAyNTYKICB9OwogIC8qKgogICAqIFNoYXBlVHlwZQogICAqLwoKICAvKioKICAgKiBCYXNlIGNsYXNzIGZvciBzaGFwZXMKICAgKi8KICBjbGFzcyBTaGFwZSB7CiAgICAvKioKICAgICAqIElkZW50aWZpZXIgb2YgdGhlIFNoYXBlLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgdHlwZSBvZiB0aGlzIHNoYXBlLiBNdXN0IGJlIHNldCB0byBhbiBpbnQgPiAwIGJ5IHN1YmNsYXNzZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBsb2NhbCBib3VuZGluZyBzcGhlcmUgcmFkaXVzIG9mIHRoaXMgc2hhcGUuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gcHJvZHVjZSBjb250YWN0IGZvcmNlcyB3aGVuIGluIGNvbnRhY3Qgd2l0aCBvdGhlciBib2RpZXMuIE5vdGUgdGhhdCBjb250YWN0cyB3aWxsIGJlIGdlbmVyYXRlZCwgYnV0IHRoZXkgd2lsbCBiZSBkaXNhYmxlZC4KICAgICAqIEBkZWZhdWx0IHRydWUKICAgICAqLwoKICAgIC8qKgogICAgICogQGRlZmF1bHQgMQogICAgICovCgogICAgLyoqCiAgICAgKiBAZGVmYXVsdCAtMQogICAgICovCgogICAgLyoqCiAgICAgKiBPcHRpb25hbCBtYXRlcmlhbCBvZiB0aGUgc2hhcGUgdGhhdCByZWd1bGF0ZXMgY29udGFjdCBwcm9wZXJ0aWVzLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgYm9keSB0byB3aGljaCB0aGUgc2hhcGUgaXMgYWRkZWQgdG8uCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFsbCB0aGUgU2hhcGUgdHlwZXMuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgdGhpcy5pZCA9IFNoYXBlLmlkQ291bnRlcisrOwogICAgICB0aGlzLnR5cGUgPSBvcHRpb25zLnR5cGUgfHwgMDsKICAgICAgdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyA9IDA7CiAgICAgIHRoaXMuY29sbGlzaW9uUmVzcG9uc2UgPSBvcHRpb25zLmNvbGxpc2lvblJlc3BvbnNlID8gb3B0aW9ucy5jb2xsaXNpb25SZXNwb25zZSA6IHRydWU7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgPSBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwIDogMTsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJNYXNrID0gb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJNYXNrICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlck1hc2sgOiAtMTsKICAgICAgdGhpcy5tYXRlcmlhbCA9IG9wdGlvbnMubWF0ZXJpYWwgPyBvcHRpb25zLm1hdGVyaWFsIDogbnVsbDsKICAgICAgdGhpcy5ib2R5ID0gbnVsbDsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZXMgdGhlIGJvdW5kaW5nIHNwaGVyZSByYWRpdXMuCiAgICAgKiBUaGUgcmVzdWx0IGlzIHN0b3JlZCBpbiB0aGUgcHJvcGVydHkgYC5ib3VuZGluZ1NwaGVyZVJhZGl1c2AKICAgICAqLwoKCiAgICB1cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpIHsKICAgICAgdGhyb3cgYGNvbXB1dGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpIG5vdCBpbXBsZW1lbnRlZCBmb3Igc2hhcGUgdHlwZSAke3RoaXMudHlwZX1gOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHZvbHVtZSBvZiB0aGlzIHNoYXBlCiAgICAgKi8KCgogICAgdm9sdW1lKCkgewogICAgICB0aHJvdyBgdm9sdW1lKCkgbm90IGltcGxlbWVudGVkIGZvciBzaGFwZSB0eXBlICR7dGhpcy50eXBlfWA7CiAgICB9CiAgICAvKioKICAgICAqIENhbGN1bGF0ZXMgdGhlIGluZXJ0aWEgaW4gdGhlIGxvY2FsIGZyYW1lIGZvciB0aGlzIHNoYXBlLgogICAgICogQHNlZSBodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0xpc3Rfb2ZfbW9tZW50c19vZl9pbmVydGlhCiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICB0aHJvdyBgY2FsY3VsYXRlTG9jYWxJbmVydGlhKCkgbm90IGltcGxlbWVudGVkIGZvciBzaGFwZSB0eXBlICR7dGhpcy50eXBlfWA7CiAgICB9CiAgICAvKioKICAgICAqIEB0b2RvIHVzZSBhYnN0cmFjdCBmb3IgdGhlc2Uga2luZCBvZiBtZXRob2RzCiAgICAgKi8KCgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgdGhyb3cgYGNhbGN1bGF0ZVdvcmxkQUFCQigpIG5vdCBpbXBsZW1lbnRlZCBmb3Igc2hhcGUgdHlwZSAke3RoaXMudHlwZX1gOwogICAgfQoKICB9CiAgU2hhcGUuaWRDb3VudGVyID0gMDsKICBTaGFwZS50eXBlcyA9IFNIQVBFX1RZUEVTOwoKICAvKioKICAgKiBUcmFuc2Zvcm1hdGlvbiB1dGlsaXRpZXMuCiAgICovCiAgY2xhc3MgVHJhbnNmb3JtIHsKICAgIC8qKgogICAgICogcG9zaXRpb24KICAgICAqLwoKICAgIC8qKgogICAgICogcXVhdGVybmlvbgogICAgICovCiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIHRoaXMucG9zaXRpb24gPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnF1YXRlcm5pb24gPSBuZXcgUXVhdGVybmlvbigpOwoKICAgICAgaWYgKG9wdGlvbnMucG9zaXRpb24pIHsKICAgICAgICB0aGlzLnBvc2l0aW9uLmNvcHkob3B0aW9ucy5wb3NpdGlvbik7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLnF1YXRlcm5pb24pIHsKICAgICAgICB0aGlzLnF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhIGdsb2JhbCBwb2ludCBpbiBsb2NhbCB0cmFuc2Zvcm0gY29vcmRpbmF0ZXMuCiAgICAgKi8KCgogICAgcG9pbnRUb0xvY2FsKHdvcmxkUG9pbnQsIHJlc3VsdCkgewogICAgICByZXR1cm4gVHJhbnNmb3JtLnBvaW50VG9Mb2NhbEZyYW1lKHRoaXMucG9zaXRpb24sIHRoaXMucXVhdGVybmlvbiwgd29ybGRQb2ludCwgcmVzdWx0KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGEgbG9jYWwgcG9pbnQgaW4gZ2xvYmFsIHRyYW5zZm9ybSBjb29yZGluYXRlcy4KICAgICAqLwoKCiAgICBwb2ludFRvV29ybGQobG9jYWxQb2ludCwgcmVzdWx0KSB7CiAgICAgIHJldHVybiBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUodGhpcy5wb3NpdGlvbiwgdGhpcy5xdWF0ZXJuaW9uLCBsb2NhbFBvaW50LCByZXN1bHQpOwogICAgfQogICAgLyoqCiAgICAgKiB2ZWN0b3JUb1dvcmxkRnJhbWUKICAgICAqLwoKCiAgICB2ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxWZWN0b3IsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0aGlzLnF1YXRlcm5pb24udm11bHQobG9jYWxWZWN0b3IsIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIHBvaW50VG9Mb2NhbEZyYW1lCiAgICAgKi8KCgogICAgc3RhdGljIHBvaW50VG9Mb2NhbEZyYW1lKHBvc2l0aW9uLCBxdWF0ZXJuaW9uLCB3b3JsZFBvaW50LCByZXN1bHQpIHsKICAgICAgaWYgKHJlc3VsdCA9PT0gdm9pZCAwKSB7CiAgICAgICAgcmVzdWx0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgd29ybGRQb2ludC52c3ViKHBvc2l0aW9uLCByZXN1bHQpOwogICAgICBxdWF0ZXJuaW9uLmNvbmp1Z2F0ZSh0bXBRdWF0JDEpOwogICAgICB0bXBRdWF0JDEudm11bHQocmVzdWx0LCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBwb2ludFRvV29ybGRGcmFtZQogICAgICovCgoKICAgIHN0YXRpYyBwb2ludFRvV29ybGRGcmFtZShwb3NpdGlvbiwgcXVhdGVybmlvbiwgbG9jYWxQb2ludCwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHF1YXRlcm5pb24udm11bHQobG9jYWxQb2ludCwgcmVzdWx0KTsKICAgICAgcmVzdWx0LnZhZGQocG9zaXRpb24sIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIHZlY3RvclRvV29ybGRGcmFtZQogICAgICovCgoKICAgIHN0YXRpYyB2ZWN0b3JUb1dvcmxkRnJhbWUocXVhdGVybmlvbiwgbG9jYWxWZWN0b3IsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBxdWF0ZXJuaW9uLnZtdWx0KGxvY2FsVmVjdG9yLCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiB2ZWN0b3JUb0xvY2FsRnJhbWUKICAgICAqLwoKCiAgICBzdGF0aWMgdmVjdG9yVG9Mb2NhbEZyYW1lKHBvc2l0aW9uLCBxdWF0ZXJuaW9uLCB3b3JsZFZlY3RvciwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHF1YXRlcm5pb24udyAqPSAtMTsKICAgICAgcXVhdGVybmlvbi52bXVsdCh3b3JsZFZlY3RvciwgcmVzdWx0KTsKICAgICAgcXVhdGVybmlvbi53ICo9IC0xOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICB9CiAgY29uc3QgdG1wUXVhdCQxID0gbmV3IFF1YXRlcm5pb24oKTsKCiAgLyoqCiAgICogQSBzZXQgb2YgcG9seWdvbnMgZGVzY3JpYmluZyBhIGNvbnZleCBzaGFwZS4KICAgKgogICAqIFRoZSBzaGFwZSBNVVNUIGJlIGNvbnZleCBmb3IgdGhlIGNvZGUgdG8gd29yayBwcm9wZXJseS4gTm8gcG9seWdvbnMgbWF5IGJlIGNvcGxhbmFyIChjb250YWluZWQKICAgKiBpbiB0aGUgc2FtZSAzRCBwbGFuZSksIGluc3RlYWQgdGhlc2Ugc2hvdWxkIGJlIG1lcmdlZCBpbnRvIG9uZSBwb2x5Z29uLgogICAqCiAgICogQGF1dGhvciBxaWFvIC8gaHR0cHM6Ly9naXRodWIuY29tL3FpYW8gKG9yaWdpbmFsIGF1dGhvciwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9xaWFvL3RocmVlLmpzL2NvbW1pdC84NTAyNmYwYzc2OWU0MDAwMTQ4YTY3ZDQ1YTllOWI5YzUxMDg4MzZmKQogICAqIEBhdXRob3Igc2NodGVwcGUgLyBodHRwczovL2dpdGh1Yi5jb20vc2NodGVwcGUKICAgKiBAc2VlIGh0dHBzOi8vd3d3LmFsdGRldmJsb2dhZGF5LmNvbS8yMDExLzA1LzEzL2NvbnRhY3QtZ2VuZXJhdGlvbi1iZXR3ZWVuLTNkLWNvbnZleC1tZXNoZXMvCiAgICoKICAgKiBAdG9kbyBNb3ZlIHRoZSBjbGlwcGluZyBmdW5jdGlvbnMgdG8gQ29udGFjdEdlbmVyYXRvcj8KICAgKiBAdG9kbyBBdXRvbWF0aWNhbGx5IG1lcmdlIGNvcGxhbmFyIHBvbHlnb25zIGluIGNvbnN0cnVjdG9yLgogICAqIEBleGFtcGxlCiAgICogICAgIGNvbnN0IGNvbnZleFNoYXBlID0gbmV3IENBTk5PTi5Db252ZXhQb2x5aGVkcm9uKHsgdmVydGljZXMsIGZhY2VzIH0pCiAgICogICAgIGNvbnN0IGNvbnZleEJvZHkgPSBuZXcgQ0FOTk9OLkJvZHkoeyBtYXNzOiAxLCBzaGFwZTogY29udmV4U2hhcGUgfSkKICAgKiAgICAgd29ybGQuYWRkQm9keShjb252ZXhCb2R5KQogICAqLwogIGNsYXNzIENvbnZleFBvbHloZWRyb24gZXh0ZW5kcyBTaGFwZSB7CiAgICAvKiogdmVydGljZXMgKi8KCiAgICAvKioKICAgICAqIEFycmF5IG9mIGludGVnZXIgYXJyYXlzLCBpbmRpY2F0aW5nIHdoaWNoIHZlcnRpY2VzIGVhY2ggZmFjZSBjb25zaXN0cyBvZgogICAgICovCgogICAgLyoqIGZhY2VOb3JtYWxzICovCgogICAgLyoqIHdvcmxkVmVydGljZXMgKi8KCiAgICAvKiogd29ybGRWZXJ0aWNlc05lZWRzVXBkYXRlICovCgogICAgLyoqIHdvcmxkRmFjZU5vcm1hbHMgKi8KCiAgICAvKiogd29ybGRGYWNlTm9ybWFsc05lZWRzVXBkYXRlICovCgogICAgLyoqCiAgICAgKiBJZiBnaXZlbiwgdGhlc2UgbG9jYWxseSBkZWZpbmVkLCBub3JtYWxpemVkIGF4ZXMgYXJlIHRoZSBvbmx5IG9uZXMgYmVpbmcgY2hlY2tlZCB3aGVuIGRvaW5nIHNlcGFyYXRpbmcgYXhpcyBjaGVjay4KICAgICAqLwoKICAgIC8qKiB1bmlxdWVFZGdlcyAqLwoKICAgIC8qKgogICAgICogQHBhcmFtIHZlcnRpY2VzIEFuIGFycmF5IG9mIFZlYzMncwogICAgICogQHBhcmFtIGZhY2VzIEFycmF5IG9mIGludGVnZXIgYXJyYXlzLCBkZXNjcmliaW5nIHdoaWNoIHZlcnRpY2VzIHRoYXQgaXMgaW5jbHVkZWQgaW4gZWFjaCBmYWNlLgogICAgICovCiAgICBjb25zdHJ1Y3Rvcihwcm9wcykgewogICAgICBpZiAocHJvcHMgPT09IHZvaWQgMCkgewogICAgICAgIHByb3BzID0ge307CiAgICAgIH0KCiAgICAgIGNvbnN0IHsKICAgICAgICB2ZXJ0aWNlcyA9IFtdLAogICAgICAgIGZhY2VzID0gW10sCiAgICAgICAgbm9ybWFscyA9IFtdLAogICAgICAgIGF4ZXMsCiAgICAgICAgYm91bmRpbmdTcGhlcmVSYWRpdXMKICAgICAgfSA9IHByb3BzOwogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTgogICAgICB9KTsKICAgICAgdGhpcy52ZXJ0aWNlcyA9IHZlcnRpY2VzOwogICAgICB0aGlzLmZhY2VzID0gZmFjZXM7CiAgICAgIHRoaXMuZmFjZU5vcm1hbHMgPSBub3JtYWxzOwoKICAgICAgaWYgKHRoaXMuZmFjZU5vcm1hbHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgdGhpcy5jb21wdXRlTm9ybWFscygpOwogICAgICB9CgogICAgICBpZiAoIWJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSBib3VuZGluZ1NwaGVyZVJhZGl1czsKICAgICAgfQoKICAgICAgdGhpcy53b3JsZFZlcnRpY2VzID0gW107IC8vIFdvcmxkIHRyYW5zZm9ybWVkIHZlcnNpb24gb2YgLnZlcnRpY2VzCgogICAgICB0aGlzLndvcmxkVmVydGljZXNOZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgIHRoaXMud29ybGRGYWNlTm9ybWFscyA9IFtdOyAvLyBXb3JsZCB0cmFuc2Zvcm1lZCB2ZXJzaW9uIG9mIC5mYWNlTm9ybWFscwoKICAgICAgdGhpcy53b3JsZEZhY2VOb3JtYWxzTmVlZHNVcGRhdGUgPSB0cnVlOwogICAgICB0aGlzLnVuaXF1ZUF4ZXMgPSBheGVzID8gYXhlcy5zbGljZSgpIDogbnVsbDsKICAgICAgdGhpcy51bmlxdWVFZGdlcyA9IFtdOwogICAgICB0aGlzLmNvbXB1dGVFZGdlcygpOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyB1bmlxdWVFZGdlcwogICAgICovCgoKICAgIGNvbXB1dGVFZGdlcygpIHsKICAgICAgY29uc3QgZmFjZXMgPSB0aGlzLmZhY2VzOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7CiAgICAgIGNvbnN0IGVkZ2VzID0gdGhpcy51bmlxdWVFZGdlczsKICAgICAgZWRnZXMubGVuZ3RoID0gMDsKICAgICAgY29uc3QgZWRnZSA9IG5ldyBWZWMzKCk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gZmFjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBmYWNlID0gZmFjZXNbaV07CiAgICAgICAgY29uc3QgbnVtVmVydGljZXMgPSBmYWNlLmxlbmd0aDsKCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogIT09IG51bVZlcnRpY2VzOyBqKyspIHsKICAgICAgICAgIGNvbnN0IGsgPSAoaiArIDEpICUgbnVtVmVydGljZXM7CiAgICAgICAgICB2ZXJ0aWNlc1tmYWNlW2pdXS52c3ViKHZlcnRpY2VzW2ZhY2Vba11dLCBlZGdlKTsKICAgICAgICAgIGVkZ2Uubm9ybWFsaXplKCk7CiAgICAgICAgICBsZXQgZm91bmQgPSBmYWxzZTsKCiAgICAgICAgICBmb3IgKGxldCBwID0gMDsgcCAhPT0gZWRnZXMubGVuZ3RoOyBwKyspIHsKICAgICAgICAgICAgaWYgKGVkZ2VzW3BdLmFsbW9zdEVxdWFscyhlZGdlKSB8fCBlZGdlc1twXS5hbG1vc3RFcXVhbHMoZWRnZSkpIHsKICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIWZvdW5kKSB7CiAgICAgICAgICAgIGVkZ2VzLnB1c2goZWRnZS5jbG9uZSgpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0aGUgbm9ybWFscyBvZiB0aGUgZmFjZXMuCiAgICAgKiBXaWxsIHJldXNlIGV4aXN0aW5nIFZlYzMgb2JqZWN0cyBpbiB0aGUgYGZhY2VOb3JtYWxzYCBhcnJheSBpZiB0aGV5IGV4aXN0LgogICAgICovCgoKICAgIGNvbXB1dGVOb3JtYWxzKCkgewogICAgICB0aGlzLmZhY2VOb3JtYWxzLmxlbmd0aCA9IHRoaXMuZmFjZXMubGVuZ3RoOyAvLyBHZW5lcmF0ZSBub3JtYWxzCgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZmFjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAvLyBDaGVjayBzbyBhbGwgdmVydGljZXMgZXhpc3RzIGZvciB0aGlzIGZhY2UKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuZmFjZXNbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIGlmICghdGhpcy52ZXJ0aWNlc1t0aGlzLmZhY2VzW2ldW2pdXSkgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFZlcnRleCAke3RoaXMuZmFjZXNbaV1bal19IG5vdCBmb3VuZCFgKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGNvbnN0IG4gPSB0aGlzLmZhY2VOb3JtYWxzW2ldIHx8IG5ldyBWZWMzKCk7CiAgICAgICAgdGhpcy5nZXRGYWNlTm9ybWFsKGksIG4pOwogICAgICAgIG4ubmVnYXRlKG4pOwogICAgICAgIHRoaXMuZmFjZU5vcm1hbHNbaV0gPSBuOwogICAgICAgIGNvbnN0IHZlcnRleCA9IHRoaXMudmVydGljZXNbdGhpcy5mYWNlc1tpXVswXV07CgogICAgICAgIGlmIChuLmRvdCh2ZXJ0ZXgpIDwgMCkgewogICAgICAgICAgY29uc29sZS5lcnJvcihgLmZhY2VOb3JtYWxzWyR7aX1dID0gVmVjMygke24udG9TdHJpbmcoKX0pIGxvb2tzIGxpa2UgaXQgcG9pbnRzIGludG8gdGhlIHNoYXBlPyBUaGUgdmVydGljZXMgZm9sbG93LiBNYWtlIHN1cmUgdGhleSBhcmUgb3JkZXJlZCBDQ1cgYXJvdW5kIHRoZSBub3JtYWwsIHVzaW5nIHRoZSByaWdodCBoYW5kIHJ1bGUuYCk7CgogICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmZhY2VzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIGNvbnNvbGUud2FybihgLnZlcnRpY2VzWyR7dGhpcy5mYWNlc1tpXVtqXX1dID0gVmVjMygke3RoaXMudmVydGljZXNbdGhpcy5mYWNlc1tpXVtqXV0udG9TdHJpbmcoKX0pYCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGUgdGhlIG5vcm1hbCBvZiBhIGZhY2UgZnJvbSBpdHMgdmVydGljZXMKICAgICAqLwoKCiAgICBnZXRGYWNlTm9ybWFsKGksIHRhcmdldCkgewogICAgICBjb25zdCBmID0gdGhpcy5mYWNlc1tpXTsKICAgICAgY29uc3QgdmEgPSB0aGlzLnZlcnRpY2VzW2ZbMF1dOwogICAgICBjb25zdCB2YiA9IHRoaXMudmVydGljZXNbZlsxXV07CiAgICAgIGNvbnN0IHZjID0gdGhpcy52ZXJ0aWNlc1tmWzJdXTsKICAgICAgQ29udmV4UG9seWhlZHJvbi5jb21wdXRlTm9ybWFsKHZhLCB2YiwgdmMsIHRhcmdldCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBmYWNlIG5vcm1hbCBnaXZlbiAzIHZlcnRpY2VzCiAgICAgKi8KCgogICAgc3RhdGljIGNvbXB1dGVOb3JtYWwodmEsIHZiLCB2YywgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IGNiID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgYWIgPSBuZXcgVmVjMygpOwogICAgICB2Yi52c3ViKHZhLCBhYik7CiAgICAgIHZjLnZzdWIodmIsIGNiKTsKICAgICAgY2IuY3Jvc3MoYWIsIHRhcmdldCk7CgogICAgICBpZiAoIXRhcmdldC5pc1plcm8oKSkgewogICAgICAgIHRhcmdldC5ub3JtYWxpemUoKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBAcGFyYW0gbWluRGlzdCBDbGFtcCBkaXN0YW5jZQogICAgICogQHBhcmFtIHJlc3VsdCBUaGUgYW4gYXJyYXkgb2YgY29udGFjdCBwb2ludCBvYmplY3RzLCBzZWUgY2xpcEZhY2VBZ2FpbnN0SHVsbAogICAgICovCgoKICAgIGNsaXBBZ2FpbnN0SHVsbChwb3NBLCBxdWF0QSwgaHVsbEIsIHBvc0IsIHF1YXRCLCBzZXBhcmF0aW5nTm9ybWFsLCBtaW5EaXN0LCBtYXhEaXN0LCByZXN1bHQpIHsKICAgICAgY29uc3QgV29ybGROb3JtYWwgPSBuZXcgVmVjMygpOwogICAgICBsZXQgY2xvc2VzdEZhY2VCID0gLTE7CiAgICAgIGxldCBkbWF4ID0gLU51bWJlci5NQVhfVkFMVUU7CgogICAgICBmb3IgKGxldCBmYWNlID0gMDsgZmFjZSA8IGh1bGxCLmZhY2VzLmxlbmd0aDsgZmFjZSsrKSB7CiAgICAgICAgV29ybGROb3JtYWwuY29weShodWxsQi5mYWNlTm9ybWFsc1tmYWNlXSk7CiAgICAgICAgcXVhdEIudm11bHQoV29ybGROb3JtYWwsIFdvcmxkTm9ybWFsKTsKICAgICAgICBjb25zdCBkID0gV29ybGROb3JtYWwuZG90KHNlcGFyYXRpbmdOb3JtYWwpOwoKICAgICAgICBpZiAoZCA+IGRtYXgpIHsKICAgICAgICAgIGRtYXggPSBkOwogICAgICAgICAgY2xvc2VzdEZhY2VCID0gZmFjZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IHdvcmxkVmVydHNCMSA9IFtdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBodWxsQi5mYWNlc1tjbG9zZXN0RmFjZUJdLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgYiA9IGh1bGxCLnZlcnRpY2VzW2h1bGxCLmZhY2VzW2Nsb3Nlc3RGYWNlQl1baV1dOwogICAgICAgIGNvbnN0IHdvcmxkYiA9IG5ldyBWZWMzKCk7CiAgICAgICAgd29ybGRiLmNvcHkoYik7CiAgICAgICAgcXVhdEIudm11bHQod29ybGRiLCB3b3JsZGIpOwogICAgICAgIHBvc0IudmFkZCh3b3JsZGIsIHdvcmxkYik7CiAgICAgICAgd29ybGRWZXJ0c0IxLnB1c2god29ybGRiKTsKICAgICAgfQoKICAgICAgaWYgKGNsb3Nlc3RGYWNlQiA+PSAwKSB7CiAgICAgICAgdGhpcy5jbGlwRmFjZUFnYWluc3RIdWxsKHNlcGFyYXRpbmdOb3JtYWwsIHBvc0EsIHF1YXRBLCB3b3JsZFZlcnRzQjEsIG1pbkRpc3QsIG1heERpc3QsIHJlc3VsdCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogRmluZCB0aGUgc2VwYXJhdGluZyBheGlzIGJldHdlZW4gdGhpcyBodWxsIGFuZCBhbm90aGVyCiAgICAgKiBAcGFyYW0gdGFyZ2V0IFRoZSB0YXJnZXQgdmVjdG9yIHRvIHNhdmUgdGhlIGF4aXMgaW4KICAgICAqIEByZXR1cm4gUmV0dXJucyBmYWxzZSBpZiBhIHNlcGFyYXRpb24gaXMgZm91bmQsIGVsc2UgdHJ1ZQogICAgICovCgoKICAgIGZpbmRTZXBhcmF0aW5nQXhpcyhodWxsQiwgcG9zQSwgcXVhdEEsIHBvc0IsIHF1YXRCLCB0YXJnZXQsIGZhY2VMaXN0QSwgZmFjZUxpc3RCKSB7CiAgICAgIGNvbnN0IGZhY2VBTm9ybWFsV1MzID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgV29ybGRub3JtYWwxID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgZGVsdGFDID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3Qgd29ybGRFZGdlMCA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHdvcmxkRWRnZTEgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBDcm9zcyA9IG5ldyBWZWMzKCk7CiAgICAgIGxldCBkbWluID0gTnVtYmVyLk1BWF9WQUxVRTsKICAgICAgY29uc3QgaHVsbEEgPSB0aGlzOwoKICAgICAgaWYgKCFodWxsQS51bmlxdWVBeGVzKSB7CiAgICAgICAgY29uc3QgbnVtRmFjZXNBID0gZmFjZUxpc3RBID8gZmFjZUxpc3RBLmxlbmd0aCA6IGh1bGxBLmZhY2VzLmxlbmd0aDsgLy8gVGVzdCBmYWNlIG5vcm1hbHMgZnJvbSBodWxsQQoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bUZhY2VzQTsgaSsrKSB7CiAgICAgICAgICBjb25zdCBmaSA9IGZhY2VMaXN0QSA/IGZhY2VMaXN0QVtpXSA6IGk7IC8vIEdldCB3b3JsZCBmYWNlIG5vcm1hbAoKICAgICAgICAgIGZhY2VBTm9ybWFsV1MzLmNvcHkoaHVsbEEuZmFjZU5vcm1hbHNbZmldKTsKICAgICAgICAgIHF1YXRBLnZtdWx0KGZhY2VBTm9ybWFsV1MzLCBmYWNlQU5vcm1hbFdTMyk7CiAgICAgICAgICBjb25zdCBkID0gaHVsbEEudGVzdFNlcEF4aXMoZmFjZUFOb3JtYWxXUzMsIGh1bGxCLCBwb3NBLCBxdWF0QSwgcG9zQiwgcXVhdEIpOwoKICAgICAgICAgIGlmIChkID09PSBmYWxzZSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGQgPCBkbWluKSB7CiAgICAgICAgICAgIGRtaW4gPSBkOwogICAgICAgICAgICB0YXJnZXQuY29weShmYWNlQU5vcm1hbFdTMyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIFRlc3QgdW5pcXVlIGF4ZXMKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gaHVsbEEudW5pcXVlQXhlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgLy8gR2V0IHdvcmxkIGF4aXMKICAgICAgICAgIHF1YXRBLnZtdWx0KGh1bGxBLnVuaXF1ZUF4ZXNbaV0sIGZhY2VBTm9ybWFsV1MzKTsKICAgICAgICAgIGNvbnN0IGQgPSBodWxsQS50ZXN0U2VwQXhpcyhmYWNlQU5vcm1hbFdTMywgaHVsbEIsIHBvc0EsIHF1YXRBLCBwb3NCLCBxdWF0Qik7CgogICAgICAgICAgaWYgKGQgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZCA8IGRtaW4pIHsKICAgICAgICAgICAgZG1pbiA9IGQ7CiAgICAgICAgICAgIHRhcmdldC5jb3B5KGZhY2VBTm9ybWFsV1MzKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICghaHVsbEIudW5pcXVlQXhlcykgewogICAgICAgIC8vIFRlc3QgZmFjZSBub3JtYWxzIGZyb20gaHVsbEIKICAgICAgICBjb25zdCBudW1GYWNlc0IgPSBmYWNlTGlzdEIgPyBmYWNlTGlzdEIubGVuZ3RoIDogaHVsbEIuZmFjZXMubGVuZ3RoOwoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bUZhY2VzQjsgaSsrKSB7CiAgICAgICAgICBjb25zdCBmaSA9IGZhY2VMaXN0QiA/IGZhY2VMaXN0QltpXSA6IGk7CiAgICAgICAgICBXb3JsZG5vcm1hbDEuY29weShodWxsQi5mYWNlTm9ybWFsc1tmaV0pOwogICAgICAgICAgcXVhdEIudm11bHQoV29ybGRub3JtYWwxLCBXb3JsZG5vcm1hbDEpOwogICAgICAgICAgY29uc3QgZCA9IGh1bGxBLnRlc3RTZXBBeGlzKFdvcmxkbm9ybWFsMSwgaHVsbEIsIHBvc0EsIHF1YXRBLCBwb3NCLCBxdWF0Qik7CgogICAgICAgICAgaWYgKGQgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZCA8IGRtaW4pIHsKICAgICAgICAgICAgZG1pbiA9IGQ7CiAgICAgICAgICAgIHRhcmdldC5jb3B5KFdvcmxkbm9ybWFsMSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIFRlc3QgdW5pcXVlIGF4ZXMgaW4gQgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBodWxsQi51bmlxdWVBeGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBxdWF0Qi52bXVsdChodWxsQi51bmlxdWVBeGVzW2ldLCBXb3JsZG5vcm1hbDEpOwogICAgICAgICAgY29uc3QgZCA9IGh1bGxBLnRlc3RTZXBBeGlzKFdvcmxkbm9ybWFsMSwgaHVsbEIsIHBvc0EsIHF1YXRBLCBwb3NCLCBxdWF0Qik7CgogICAgICAgICAgaWYgKGQgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZCA8IGRtaW4pIHsKICAgICAgICAgICAgZG1pbiA9IGQ7CiAgICAgICAgICAgIHRhcmdldC5jb3B5KFdvcmxkbm9ybWFsMSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIFRlc3QgZWRnZXMKCgogICAgICBmb3IgKGxldCBlMCA9IDA7IGUwICE9PSBodWxsQS51bmlxdWVFZGdlcy5sZW5ndGg7IGUwKyspIHsKICAgICAgICAvLyBHZXQgd29ybGQgZWRnZQogICAgICAgIHF1YXRBLnZtdWx0KGh1bGxBLnVuaXF1ZUVkZ2VzW2UwXSwgd29ybGRFZGdlMCk7CgogICAgICAgIGZvciAobGV0IGUxID0gMDsgZTEgIT09IGh1bGxCLnVuaXF1ZUVkZ2VzLmxlbmd0aDsgZTErKykgewogICAgICAgICAgLy8gR2V0IHdvcmxkIGVkZ2UgMgogICAgICAgICAgcXVhdEIudm11bHQoaHVsbEIudW5pcXVlRWRnZXNbZTFdLCB3b3JsZEVkZ2UxKTsKICAgICAgICAgIHdvcmxkRWRnZTAuY3Jvc3Mod29ybGRFZGdlMSwgQ3Jvc3MpOwoKICAgICAgICAgIGlmICghQ3Jvc3MuYWxtb3N0WmVybygpKSB7CiAgICAgICAgICAgIENyb3NzLm5vcm1hbGl6ZSgpOwogICAgICAgICAgICBjb25zdCBkaXN0ID0gaHVsbEEudGVzdFNlcEF4aXMoQ3Jvc3MsIGh1bGxCLCBwb3NBLCBxdWF0QSwgcG9zQiwgcXVhdEIpOwoKICAgICAgICAgICAgaWYgKGRpc3QgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZGlzdCA8IGRtaW4pIHsKICAgICAgICAgICAgICBkbWluID0gZGlzdDsKICAgICAgICAgICAgICB0YXJnZXQuY29weShDcm9zcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHBvc0IudnN1Yihwb3NBLCBkZWx0YUMpOwoKICAgICAgaWYgKGRlbHRhQy5kb3QodGFyZ2V0KSA+IDAuMCkgewogICAgICAgIHRhcmdldC5uZWdhdGUodGFyZ2V0KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIFRlc3Qgc2VwYXJhdGluZyBheGlzIGFnYWluc3QgdHdvIGh1bGxzLiBCb3RoIGh1bGxzIGFyZSBwcm9qZWN0ZWQgb250byB0aGUgYXhpcyBhbmQgdGhlIG92ZXJsYXAgc2l6ZSBpcyByZXR1cm5lZCBpZiB0aGVyZSBpcyBvbmUuCiAgICAgKiBAcmV0dXJuIFRoZSBvdmVybGFwIGRlcHRoLCBvciBGQUxTRSBpZiBubyBwZW5ldHJhdGlvbi4KICAgICAqLwoKCiAgICB0ZXN0U2VwQXhpcyhheGlzLCBodWxsQiwgcG9zQSwgcXVhdEEsIHBvc0IsIHF1YXRCKSB7CiAgICAgIGNvbnN0IGh1bGxBID0gdGhpczsKICAgICAgQ29udmV4UG9seWhlZHJvbi5wcm9qZWN0KGh1bGxBLCBheGlzLCBwb3NBLCBxdWF0QSwgbWF4bWluQSk7CiAgICAgIENvbnZleFBvbHloZWRyb24ucHJvamVjdChodWxsQiwgYXhpcywgcG9zQiwgcXVhdEIsIG1heG1pbkIpOwogICAgICBjb25zdCBtYXhBID0gbWF4bWluQVswXTsKICAgICAgY29uc3QgbWluQSA9IG1heG1pbkFbMV07CiAgICAgIGNvbnN0IG1heEIgPSBtYXhtaW5CWzBdOwogICAgICBjb25zdCBtaW5CID0gbWF4bWluQlsxXTsKCiAgICAgIGlmIChtYXhBIDwgbWluQiB8fCBtYXhCIDwgbWluQSkgewogICAgICAgIHJldHVybiBmYWxzZTsgLy8gU2VwYXJhdGVkCiAgICAgIH0KCiAgICAgIGNvbnN0IGQwID0gbWF4QSAtIG1pbkI7CiAgICAgIGNvbnN0IGQxID0gbWF4QiAtIG1pbkE7CiAgICAgIGNvbnN0IGRlcHRoID0gZDAgPCBkMSA/IGQwIDogZDE7CiAgICAgIHJldHVybiBkZXB0aDsKICAgIH0KICAgIC8qKgogICAgICogY2FsY3VsYXRlTG9jYWxJbmVydGlhCiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICAvLyBBcHByb3hpbWF0ZSB3aXRoIGJveCBpbmVydGlhCiAgICAgIC8vIEV4YWN0IGluZXJ0aWEgY2FsY3VsYXRpb24gaXMgb3ZlcmtpbGwsIGJ1dCBzZWUgaHR0cDovL2dlb21ldHJpY3Rvb2xzLmNvbS9Eb2N1bWVudGF0aW9uL1BvbHloZWRyYWxNYXNzUHJvcGVydGllcy5wZGYgZm9yIHRoZSBjb3JyZWN0IHdheSB0byBkbyBpdAogICAgICBjb25zdCBhYWJibWF4ID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgYWFiYm1pbiA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuY29tcHV0ZUxvY2FsQUFCQihhYWJibWluLCBhYWJibWF4KTsKICAgICAgY29uc3QgeCA9IGFhYmJtYXgueCAtIGFhYmJtaW4ueDsKICAgICAgY29uc3QgeSA9IGFhYmJtYXgueSAtIGFhYmJtaW4ueTsKICAgICAgY29uc3QgeiA9IGFhYmJtYXgueiAtIGFhYmJtaW4uejsKICAgICAgdGFyZ2V0LnggPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogeSAqIDIgKiB5ICsgMiAqIHogKiAyICogeik7CiAgICAgIHRhcmdldC55ID0gMS4wIC8gMTIuMCAqIG1hc3MgKiAoMiAqIHggKiAyICogeCArIDIgKiB6ICogMiAqIHopOwogICAgICB0YXJnZXQueiA9IDEuMCAvIDEyLjAgKiBtYXNzICogKDIgKiB5ICogMiAqIHkgKyAyICogeCAqIDIgKiB4KTsKICAgIH0KICAgIC8qKgogICAgICogQHBhcmFtIGZhY2VfaSBJbmRleCBvZiB0aGUgZmFjZQogICAgICovCgoKICAgIGdldFBsYW5lQ29uc3RhbnRPZkZhY2UoZmFjZV9pKSB7CiAgICAgIGNvbnN0IGYgPSB0aGlzLmZhY2VzW2ZhY2VfaV07CiAgICAgIGNvbnN0IG4gPSB0aGlzLmZhY2VOb3JtYWxzW2ZhY2VfaV07CiAgICAgIGNvbnN0IHYgPSB0aGlzLnZlcnRpY2VzW2ZbMF1dOwogICAgICBjb25zdCBjID0gLW4uZG90KHYpOwogICAgICByZXR1cm4gYzsKICAgIH0KICAgIC8qKgogICAgICogQ2xpcCBhIGZhY2UgYWdhaW5zdCBhIGh1bGwuCiAgICAgKiBAcGFyYW0gd29ybGRWZXJ0c0IxIEFuIGFycmF5IG9mIFZlYzMgd2l0aCB2ZXJ0aWNlcyBpbiB0aGUgd29ybGQgZnJhbWUuCiAgICAgKiBAcGFyYW0gbWluRGlzdCBEaXN0YW5jZSBjbGFtcGluZwogICAgICogQHBhcmFtIEFycmF5IHJlc3VsdCBBcnJheSB0byBzdG9yZSByZXN1bHRpbmcgY29udGFjdCBwb2ludHMgaW4uIFdpbGwgYmUgb2JqZWN0cyB3aXRoIHByb3BlcnRpZXM6IHBvaW50LCBkZXB0aCwgbm9ybWFsLiBUaGVzZSBhcmUgcmVwcmVzZW50ZWQgaW4gd29ybGQgY29vcmRpbmF0ZXMuCiAgICAgKi8KCgogICAgY2xpcEZhY2VBZ2FpbnN0SHVsbChzZXBhcmF0aW5nTm9ybWFsLCBwb3NBLCBxdWF0QSwgd29ybGRWZXJ0c0IxLCBtaW5EaXN0LCBtYXhEaXN0LCByZXN1bHQpIHsKICAgICAgY29uc3QgZmFjZUFOb3JtYWxXUyA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGVkZ2UwID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgV29ybGRFZGdlMCA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHdvcmxkUGxhbmVBbm9ybWFsMSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHBsYW5lTm9ybWFsV1MxID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3Qgd29ybGRBMSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGxvY2FsUGxhbmVOb3JtYWwgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBwbGFuZU5vcm1hbFdTID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgaHVsbEEgPSB0aGlzOwogICAgICBjb25zdCB3b3JsZFZlcnRzQjIgPSBbXTsKICAgICAgY29uc3QgcFZ0eEluID0gd29ybGRWZXJ0c0IxOwogICAgICBjb25zdCBwVnR4T3V0ID0gd29ybGRWZXJ0c0IyOwogICAgICBsZXQgY2xvc2VzdEZhY2VBID0gLTE7CiAgICAgIGxldCBkbWluID0gTnVtYmVyLk1BWF9WQUxVRTsgLy8gRmluZCB0aGUgZmFjZSB3aXRoIG5vcm1hbCBjbG9zZXN0IHRvIHRoZSBzZXBhcmF0aW5nIGF4aXMKCiAgICAgIGZvciAobGV0IGZhY2UgPSAwOyBmYWNlIDwgaHVsbEEuZmFjZXMubGVuZ3RoOyBmYWNlKyspIHsKICAgICAgICBmYWNlQU5vcm1hbFdTLmNvcHkoaHVsbEEuZmFjZU5vcm1hbHNbZmFjZV0pOwogICAgICAgIHF1YXRBLnZtdWx0KGZhY2VBTm9ybWFsV1MsIGZhY2VBTm9ybWFsV1MpOwogICAgICAgIGNvbnN0IGQgPSBmYWNlQU5vcm1hbFdTLmRvdChzZXBhcmF0aW5nTm9ybWFsKTsKCiAgICAgICAgaWYgKGQgPCBkbWluKSB7CiAgICAgICAgICBkbWluID0gZDsKICAgICAgICAgIGNsb3Nlc3RGYWNlQSA9IGZhY2U7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoY2xvc2VzdEZhY2VBIDwgMCkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBHZXQgdGhlIGZhY2UgYW5kIGNvbnN0cnVjdCBjb25uZWN0ZWQgZmFjZXMKCgogICAgICBjb25zdCBwb2x5QSA9IGh1bGxBLmZhY2VzW2Nsb3Nlc3RGYWNlQV07CiAgICAgIHBvbHlBLmNvbm5lY3RlZEZhY2VzID0gW107CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGh1bGxBLmZhY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBodWxsQS5mYWNlc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgaWYgKAogICAgICAgICAgLyogU2hhcmluZyBhIHZlcnRleCovCiAgICAgICAgICBwb2x5QS5pbmRleE9mKGh1bGxBLmZhY2VzW2ldW2pdKSAhPT0gLTEgJiYKICAgICAgICAgIC8qIE5vdCB0aGUgb25lIHdlIGFyZSBsb29raW5nIGZvciBjb25uZWN0aW9ucyBmcm9tICovCiAgICAgICAgICBpICE9PSBjbG9zZXN0RmFjZUEgJiYKICAgICAgICAgIC8qIE5vdCBhbHJlYWR5IGFkZGVkICovCiAgICAgICAgICBwb2x5QS5jb25uZWN0ZWRGYWNlcy5pbmRleE9mKGkpID09PSAtMSkgewogICAgICAgICAgICBwb2x5QS5jb25uZWN0ZWRGYWNlcy5wdXNoKGkpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSAvLyBDbGlwIHRoZSBwb2x5Z29uIHRvIHRoZSBiYWNrIG9mIHRoZSBwbGFuZXMgb2YgYWxsIGZhY2VzIG9mIGh1bGwgQSwKICAgICAgLy8gdGhhdCBhcmUgYWRqYWNlbnQgdG8gdGhlIHdpdG5lc3MgZmFjZQoKCiAgICAgIGNvbnN0IG51bVZlcnRpY2VzQSA9IHBvbHlBLmxlbmd0aDsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtVmVydGljZXNBOyBpKyspIHsKICAgICAgICBjb25zdCBhID0gaHVsbEEudmVydGljZXNbcG9seUFbaV1dOwogICAgICAgIGNvbnN0IGIgPSBodWxsQS52ZXJ0aWNlc1twb2x5QVsoaSArIDEpICUgbnVtVmVydGljZXNBXV07CiAgICAgICAgYS52c3ViKGIsIGVkZ2UwKTsKICAgICAgICBXb3JsZEVkZ2UwLmNvcHkoZWRnZTApOwogICAgICAgIHF1YXRBLnZtdWx0KFdvcmxkRWRnZTAsIFdvcmxkRWRnZTApOwogICAgICAgIHBvc0EudmFkZChXb3JsZEVkZ2UwLCBXb3JsZEVkZ2UwKTsKICAgICAgICB3b3JsZFBsYW5lQW5vcm1hbDEuY29weSh0aGlzLmZhY2VOb3JtYWxzW2Nsb3Nlc3RGYWNlQV0pOwogICAgICAgIHF1YXRBLnZtdWx0KHdvcmxkUGxhbmVBbm9ybWFsMSwgd29ybGRQbGFuZUFub3JtYWwxKTsKICAgICAgICBwb3NBLnZhZGQod29ybGRQbGFuZUFub3JtYWwxLCB3b3JsZFBsYW5lQW5vcm1hbDEpOwogICAgICAgIFdvcmxkRWRnZTAuY3Jvc3Mod29ybGRQbGFuZUFub3JtYWwxLCBwbGFuZU5vcm1hbFdTMSk7CiAgICAgICAgcGxhbmVOb3JtYWxXUzEubmVnYXRlKHBsYW5lTm9ybWFsV1MxKTsKICAgICAgICB3b3JsZEExLmNvcHkoYSk7CiAgICAgICAgcXVhdEEudm11bHQod29ybGRBMSwgd29ybGRBMSk7CiAgICAgICAgcG9zQS52YWRkKHdvcmxkQTEsIHdvcmxkQTEpOwogICAgICAgIGNvbnN0IG90aGVyRmFjZSA9IHBvbHlBLmNvbm5lY3RlZEZhY2VzW2ldOwogICAgICAgIGxvY2FsUGxhbmVOb3JtYWwuY29weSh0aGlzLmZhY2VOb3JtYWxzW290aGVyRmFjZV0pOwogICAgICAgIGNvbnN0IGxvY2FsUGxhbmVFcSA9IHRoaXMuZ2V0UGxhbmVDb25zdGFudE9mRmFjZShvdGhlckZhY2UpOwogICAgICAgIHBsYW5lTm9ybWFsV1MuY29weShsb2NhbFBsYW5lTm9ybWFsKTsKICAgICAgICBxdWF0QS52bXVsdChwbGFuZU5vcm1hbFdTLCBwbGFuZU5vcm1hbFdTKTsKICAgICAgICBjb25zdCBwbGFuZUVxV1MgPSBsb2NhbFBsYW5lRXEgLSBwbGFuZU5vcm1hbFdTLmRvdChwb3NBKTsgLy8gQ2xpcCBmYWNlIGFnYWluc3Qgb3VyIGNvbnN0cnVjdGVkIHBsYW5lCgogICAgICAgIHRoaXMuY2xpcEZhY2VBZ2FpbnN0UGxhbmUocFZ0eEluLCBwVnR4T3V0LCBwbGFuZU5vcm1hbFdTLCBwbGFuZUVxV1MpOyAvLyBUaHJvdyBhd2F5IGFsbCBjbGlwcGVkIHBvaW50cywgYnV0IHNhdmUgdGhlIHJlbWFpbmluZyB1bnRpbCBuZXh0IGNsaXAKCiAgICAgICAgd2hpbGUgKHBWdHhJbi5sZW5ndGgpIHsKICAgICAgICAgIHBWdHhJbi5zaGlmdCgpOwogICAgICAgIH0KCiAgICAgICAgd2hpbGUgKHBWdHhPdXQubGVuZ3RoKSB7CiAgICAgICAgICBwVnR4SW4ucHVzaChwVnR4T3V0LnNoaWZ0KCkpOwogICAgICAgIH0KICAgICAgfSAvLyBvbmx5IGtlZXAgY29udGFjdCBwb2ludHMgdGhhdCBhcmUgYmVoaW5kIHRoZSB3aXRuZXNzIGZhY2UKCgogICAgICBsb2NhbFBsYW5lTm9ybWFsLmNvcHkodGhpcy5mYWNlTm9ybWFsc1tjbG9zZXN0RmFjZUFdKTsKICAgICAgY29uc3QgbG9jYWxQbGFuZUVxID0gdGhpcy5nZXRQbGFuZUNvbnN0YW50T2ZGYWNlKGNsb3Nlc3RGYWNlQSk7CiAgICAgIHBsYW5lTm9ybWFsV1MuY29weShsb2NhbFBsYW5lTm9ybWFsKTsKICAgICAgcXVhdEEudm11bHQocGxhbmVOb3JtYWxXUywgcGxhbmVOb3JtYWxXUyk7CiAgICAgIGNvbnN0IHBsYW5lRXFXUyA9IGxvY2FsUGxhbmVFcSAtIHBsYW5lTm9ybWFsV1MuZG90KHBvc0EpOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwVnR4SW4ubGVuZ3RoOyBpKyspIHsKICAgICAgICBsZXQgZGVwdGggPSBwbGFuZU5vcm1hbFdTLmRvdChwVnR4SW5baV0pICsgcGxhbmVFcVdTOyAvLyA/Pz8KCiAgICAgICAgaWYgKGRlcHRoIDw9IG1pbkRpc3QpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGBjbGFtcGVkOiBkZXB0aD0ke2RlcHRofSB0byBtaW5EaXN0PSR7bWluRGlzdH1gKTsKICAgICAgICAgIGRlcHRoID0gbWluRGlzdDsKICAgICAgICB9CgogICAgICAgIGlmIChkZXB0aCA8PSBtYXhEaXN0KSB7CiAgICAgICAgICBjb25zdCBwb2ludCA9IHBWdHhJbltpXTsKCiAgICAgICAgICBpZiAoZGVwdGggPD0gMWUtNikgewogICAgICAgICAgICBjb25zdCBwID0gewogICAgICAgICAgICAgIHBvaW50LAogICAgICAgICAgICAgIG5vcm1hbDogcGxhbmVOb3JtYWxXUywKICAgICAgICAgICAgICBkZXB0aAogICAgICAgICAgICB9OwogICAgICAgICAgICByZXN1bHQucHVzaChwKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ2xpcCBhIGZhY2UgaW4gYSBodWxsIGFnYWluc3QgdGhlIGJhY2sgb2YgYSBwbGFuZS4KICAgICAqIEBwYXJhbSBwbGFuZUNvbnN0YW50IFRoZSBjb25zdGFudCBpbiB0aGUgbWF0aGVtYXRpY2FsIHBsYW5lIGVxdWF0aW9uCiAgICAgKi8KCgogICAgY2xpcEZhY2VBZ2FpbnN0UGxhbmUoaW5WZXJ0aWNlcywgb3V0VmVydGljZXMsIHBsYW5lTm9ybWFsLCBwbGFuZUNvbnN0YW50KSB7CiAgICAgIGxldCBuX2RvdF9maXJzdDsKICAgICAgbGV0IG5fZG90X2xhc3Q7CiAgICAgIGNvbnN0IG51bVZlcnRzID0gaW5WZXJ0aWNlcy5sZW5ndGg7CgogICAgICBpZiAobnVtVmVydHMgPCAyKSB7CiAgICAgICAgcmV0dXJuIG91dFZlcnRpY2VzOwogICAgICB9CgogICAgICBsZXQgZmlyc3RWZXJ0ZXggPSBpblZlcnRpY2VzW2luVmVydGljZXMubGVuZ3RoIC0gMV07CiAgICAgIGxldCBsYXN0VmVydGV4ID0gaW5WZXJ0aWNlc1swXTsKICAgICAgbl9kb3RfZmlyc3QgPSBwbGFuZU5vcm1hbC5kb3QoZmlyc3RWZXJ0ZXgpICsgcGxhbmVDb25zdGFudDsKCiAgICAgIGZvciAobGV0IHZpID0gMDsgdmkgPCBudW1WZXJ0czsgdmkrKykgewogICAgICAgIGxhc3RWZXJ0ZXggPSBpblZlcnRpY2VzW3ZpXTsKICAgICAgICBuX2RvdF9sYXN0ID0gcGxhbmVOb3JtYWwuZG90KGxhc3RWZXJ0ZXgpICsgcGxhbmVDb25zdGFudDsKCiAgICAgICAgaWYgKG5fZG90X2ZpcnN0IDwgMCkgewogICAgICAgICAgaWYgKG5fZG90X2xhc3QgPCAwKSB7CiAgICAgICAgICAgIC8vIFN0YXJ0IDwgMCwgZW5kIDwgMCwgc28gb3V0cHV0IGxhc3RWZXJ0ZXgKICAgICAgICAgICAgY29uc3QgbmV3diA9IG5ldyBWZWMzKCk7CiAgICAgICAgICAgIG5ld3YuY29weShsYXN0VmVydGV4KTsKICAgICAgICAgICAgb3V0VmVydGljZXMucHVzaChuZXd2KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIFN0YXJ0IDwgMCwgZW5kID49IDAsIHNvIG91dHB1dCBpbnRlcnNlY3Rpb24KICAgICAgICAgICAgY29uc3QgbmV3diA9IG5ldyBWZWMzKCk7CiAgICAgICAgICAgIGZpcnN0VmVydGV4LmxlcnAobGFzdFZlcnRleCwgbl9kb3RfZmlyc3QgLyAobl9kb3RfZmlyc3QgLSBuX2RvdF9sYXN0KSwgbmV3dik7CiAgICAgICAgICAgIG91dFZlcnRpY2VzLnB1c2gobmV3dik7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChuX2RvdF9sYXN0IDwgMCkgewogICAgICAgICAgICAvLyBTdGFydCA+PSAwLCBlbmQgPCAwIHNvIG91dHB1dCBpbnRlcnNlY3Rpb24gYW5kIGVuZAogICAgICAgICAgICBjb25zdCBuZXd2ID0gbmV3IFZlYzMoKTsKICAgICAgICAgICAgZmlyc3RWZXJ0ZXgubGVycChsYXN0VmVydGV4LCBuX2RvdF9maXJzdCAvIChuX2RvdF9maXJzdCAtIG5fZG90X2xhc3QpLCBuZXd2KTsKICAgICAgICAgICAgb3V0VmVydGljZXMucHVzaChuZXd2KTsKICAgICAgICAgICAgb3V0VmVydGljZXMucHVzaChsYXN0VmVydGV4KTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZpcnN0VmVydGV4ID0gbGFzdFZlcnRleDsKICAgICAgICBuX2RvdF9maXJzdCA9IG5fZG90X2xhc3Q7CiAgICAgIH0KCiAgICAgIHJldHVybiBvdXRWZXJ0aWNlczsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyBgLndvcmxkVmVydGljZXNgIGFuZCBzZXRzIGAud29ybGRWZXJ0aWNlc05lZWRzVXBkYXRlYCB0byBmYWxzZS4KICAgICAqLwoKCiAgICBjb21wdXRlV29ybGRWZXJ0aWNlcyhwb3NpdGlvbiwgcXVhdCkgewogICAgICB3aGlsZSAodGhpcy53b3JsZFZlcnRpY2VzLmxlbmd0aCA8IHRoaXMudmVydGljZXMubGVuZ3RoKSB7CiAgICAgICAgdGhpcy53b3JsZFZlcnRpY2VzLnB1c2gobmV3IFZlYzMoKSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHZlcnRzID0gdGhpcy52ZXJ0aWNlczsKICAgICAgY29uc3Qgd29ybGRWZXJ0cyA9IHRoaXMud29ybGRWZXJ0aWNlczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSB0aGlzLnZlcnRpY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgcXVhdC52bXVsdCh2ZXJ0c1tpXSwgd29ybGRWZXJ0c1tpXSk7CiAgICAgICAgcG9zaXRpb24udmFkZCh3b3JsZFZlcnRzW2ldLCB3b3JsZFZlcnRzW2ldKTsKICAgICAgfQoKICAgICAgdGhpcy53b3JsZFZlcnRpY2VzTmVlZHNVcGRhdGUgPSBmYWxzZTsKICAgIH0KCiAgICBjb21wdXRlTG9jYWxBQUJCKGFhYmJtaW4sIGFhYmJtYXgpIHsKICAgICAgY29uc3QgdmVydGljZXMgPSB0aGlzLnZlcnRpY2VzOwogICAgICBhYWJibWluLnNldChOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFKTsKICAgICAgYWFiYm1heC5zZXQoLU51bWJlci5NQVhfVkFMVUUsIC1OdW1iZXIuTUFYX1ZBTFVFLCAtTnVtYmVyLk1BWF9WQUxVRSk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudmVydGljZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCB2ID0gdmVydGljZXNbaV07CgogICAgICAgIGlmICh2LnggPCBhYWJibWluLngpIHsKICAgICAgICAgIGFhYmJtaW4ueCA9IHYueDsKICAgICAgICB9IGVsc2UgaWYgKHYueCA+IGFhYmJtYXgueCkgewogICAgICAgICAgYWFiYm1heC54ID0gdi54OwogICAgICAgIH0KCiAgICAgICAgaWYgKHYueSA8IGFhYmJtaW4ueSkgewogICAgICAgICAgYWFiYm1pbi55ID0gdi55OwogICAgICAgIH0gZWxzZSBpZiAodi55ID4gYWFiYm1heC55KSB7CiAgICAgICAgICBhYWJibWF4LnkgPSB2Lnk7CiAgICAgICAgfQoKICAgICAgICBpZiAodi56IDwgYWFiYm1pbi56KSB7CiAgICAgICAgICBhYWJibWluLnogPSB2Lno7CiAgICAgICAgfSBlbHNlIGlmICh2LnogPiBhYWJibWF4LnopIHsKICAgICAgICAgIGFhYmJtYXgueiA9IHYuejsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyBgd29ybGRWZXJ0aWNlc2AgYW5kIHNldHMgYHdvcmxkVmVydGljZXNOZWVkc1VwZGF0ZWAgdG8gZmFsc2UuCiAgICAgKi8KCgogICAgY29tcHV0ZVdvcmxkRmFjZU5vcm1hbHMocXVhdCkgewogICAgICBjb25zdCBOID0gdGhpcy5mYWNlTm9ybWFscy5sZW5ndGg7CgogICAgICB3aGlsZSAodGhpcy53b3JsZEZhY2VOb3JtYWxzLmxlbmd0aCA8IE4pIHsKICAgICAgICB0aGlzLndvcmxkRmFjZU5vcm1hbHMucHVzaChuZXcgVmVjMygpKTsKICAgICAgfQoKICAgICAgY29uc3Qgbm9ybWFscyA9IHRoaXMuZmFjZU5vcm1hbHM7CiAgICAgIGNvbnN0IHdvcmxkTm9ybWFscyA9IHRoaXMud29ybGRGYWNlTm9ybWFsczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBxdWF0LnZtdWx0KG5vcm1hbHNbaV0sIHdvcmxkTm9ybWFsc1tpXSk7CiAgICAgIH0KCiAgICAgIHRoaXMud29ybGRGYWNlTm9ybWFsc05lZWRzVXBkYXRlID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzCiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIC8vIEFzc3VtZSBwb2ludHMgYXJlIGRpc3RyaWJ1dGVkIHdpdGggbG9jYWwgKDAsMCwwKSBhcyBjZW50ZXIKICAgICAgbGV0IG1heDIgPSAwOwogICAgICBjb25zdCB2ZXJ0cyA9IHRoaXMudmVydGljZXM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBub3JtMiA9IHZlcnRzW2ldLmxlbmd0aFNxdWFyZWQoKTsKCiAgICAgICAgaWYgKG5vcm0yID4gbWF4MikgewogICAgICAgICAgbWF4MiA9IG5vcm0yOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyA9IE1hdGguc3FydChtYXgyKTsKICAgIH0KICAgIC8qKgogICAgICogY2FsY3VsYXRlV29ybGRBQUJCCiAgICAgKi8KCgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgY29uc3QgdmVydHMgPSB0aGlzLnZlcnRpY2VzOwogICAgICBsZXQgbWlueDsKICAgICAgbGV0IG1pbnk7CiAgICAgIGxldCBtaW56OwogICAgICBsZXQgbWF4eDsKICAgICAgbGV0IG1heHk7CiAgICAgIGxldCBtYXh6OwogICAgICBsZXQgdGVtcFdvcmxkVmVydGV4ID0gbmV3IFZlYzMoKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICB0ZW1wV29ybGRWZXJ0ZXguY29weSh2ZXJ0c1tpXSk7CiAgICAgICAgcXVhdC52bXVsdCh0ZW1wV29ybGRWZXJ0ZXgsIHRlbXBXb3JsZFZlcnRleCk7CiAgICAgICAgcG9zLnZhZGQodGVtcFdvcmxkVmVydGV4LCB0ZW1wV29ybGRWZXJ0ZXgpOwogICAgICAgIGNvbnN0IHYgPSB0ZW1wV29ybGRWZXJ0ZXg7CgogICAgICAgIGlmIChtaW54ID09PSB1bmRlZmluZWQgfHwgdi54IDwgbWlueCkgewogICAgICAgICAgbWlueCA9IHYueDsKICAgICAgICB9CgogICAgICAgIGlmIChtYXh4ID09PSB1bmRlZmluZWQgfHwgdi54ID4gbWF4eCkgewogICAgICAgICAgbWF4eCA9IHYueDsKICAgICAgICB9CgogICAgICAgIGlmIChtaW55ID09PSB1bmRlZmluZWQgfHwgdi55IDwgbWlueSkgewogICAgICAgICAgbWlueSA9IHYueTsKICAgICAgICB9CgogICAgICAgIGlmIChtYXh5ID09PSB1bmRlZmluZWQgfHwgdi55ID4gbWF4eSkgewogICAgICAgICAgbWF4eSA9IHYueTsKICAgICAgICB9CgogICAgICAgIGlmIChtaW56ID09PSB1bmRlZmluZWQgfHwgdi56IDwgbWlueikgewogICAgICAgICAgbWlueiA9IHYuejsKICAgICAgICB9CgogICAgICAgIGlmIChtYXh6ID09PSB1bmRlZmluZWQgfHwgdi56ID4gbWF4eikgewogICAgICAgICAgbWF4eiA9IHYuejsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIG1pbi5zZXQobWlueCwgbWlueSwgbWlueik7CiAgICAgIG1heC5zZXQobWF4eCwgbWF4eSwgbWF4eik7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhcHByb3hpbWF0ZSBjb252ZXggdm9sdW1lCiAgICAgKi8KCgogICAgdm9sdW1lKCkgewogICAgICByZXR1cm4gNC4wICogTWF0aC5QSSAqIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgLyAzLjA7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBhdmVyYWdlIG9mIGFsbCB0aGUgdmVydGljZXMgcG9zaXRpb25zCiAgICAgKi8KCgogICAgZ2V0QXZlcmFnZVBvaW50TG9jYWwodGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHZlcnRzID0gdGhpcy52ZXJ0aWNlczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICB0YXJnZXQudmFkZCh2ZXJ0c1tpXSwgdGFyZ2V0KTsKICAgICAgfQoKICAgICAgdGFyZ2V0LnNjYWxlKDEgLyB2ZXJ0cy5sZW5ndGgsIHRhcmdldCk7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIFRyYW5zZm9ybSBhbGwgbG9jYWwgcG9pbnRzLiBXaWxsIGNoYW5nZSB0aGUgLnZlcnRpY2VzCiAgICAgKi8KCgogICAgdHJhbnNmb3JtQWxsUG9pbnRzKG9mZnNldCwgcXVhdCkgewogICAgICBjb25zdCBuID0gdGhpcy52ZXJ0aWNlcy5sZW5ndGg7CiAgICAgIGNvbnN0IHZlcnRzID0gdGhpcy52ZXJ0aWNlczsgLy8gQXBwbHkgcm90YXRpb24KCiAgICAgIGlmIChxdWF0KSB7CiAgICAgICAgLy8gUm90YXRlIHZlcnRpY2VzCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHYgPSB2ZXJ0c1tpXTsKICAgICAgICAgIHF1YXQudm11bHQodiwgdik7CiAgICAgICAgfSAvLyBSb3RhdGUgZmFjZSBub3JtYWxzCgoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZmFjZU5vcm1hbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHYgPSB0aGlzLmZhY2VOb3JtYWxzW2ldOwogICAgICAgICAgcXVhdC52bXVsdCh2LCB2KTsKICAgICAgICB9CiAgICAgICAgLyoKICAgICAgICAgICAgICAvLyBSb3RhdGUgZWRnZXMKICAgICAgICAgICAgICBmb3IobGV0IGk9MDsgaTx0aGlzLnVuaXF1ZUVkZ2VzLmxlbmd0aDsgaSsrKXsKICAgICAgICAgICAgICAgICAgY29uc3QgdiA9IHRoaXMudW5pcXVlRWRnZXNbaV07CiAgICAgICAgICAgICAgICAgIHF1YXQudm11bHQodix2KTsKICAgICAgICAgICAgICB9Ki8KCiAgICAgIH0gLy8gQXBwbHkgb2Zmc2V0CgoKICAgICAgaWYgKG9mZnNldCkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgICBjb25zdCB2ID0gdmVydHNbaV07CiAgICAgICAgICB2LnZhZGQob2Zmc2V0LCB2KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ2hlY2tzIHdoZXRoZXIgcCBpcyBpbnNpZGUgdGhlIHBvbHloZWRyYS4gTXVzdCBiZSBpbiBsb2NhbCBjb29yZHMuCiAgICAgKiBUaGUgcG9pbnQgbGllcyBvdXRzaWRlIG9mIHRoZSBjb252ZXggaHVsbCBvZiB0aGUgb3RoZXIgcG9pbnRzIGlmIGFuZCBvbmx5IGlmIHRoZSBkaXJlY3Rpb24KICAgICAqIG9mIGFsbCB0aGUgdmVjdG9ycyBmcm9tIGl0IHRvIHRob3NlIG90aGVyIHBvaW50cyBhcmUgb24gbGVzcyB0aGFuIG9uZSBoYWxmIG9mIGEgc3BoZXJlIGFyb3VuZCBpdC4KICAgICAqIEBwYXJhbSBwIEEgcG9pbnQgZ2l2ZW4gaW4gbG9jYWwgY29vcmRpbmF0ZXMKICAgICAqLwoKCiAgICBwb2ludElzSW5zaWRlKHApIHsKICAgICAgY29uc3QgdmVydHMgPSB0aGlzLnZlcnRpY2VzOwogICAgICBjb25zdCBmYWNlcyA9IHRoaXMuZmFjZXM7CiAgICAgIGNvbnN0IG5vcm1hbHMgPSB0aGlzLmZhY2VOb3JtYWxzOwogICAgICBjb25zdCBwb3NpdGl2ZVJlc3VsdCA9IG51bGw7CiAgICAgIGNvbnN0IHBvaW50SW5zaWRlID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5nZXRBdmVyYWdlUG9pbnRMb2NhbChwb2ludEluc2lkZSk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZmFjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBsZXQgbiA9IG5vcm1hbHNbaV07CiAgICAgICAgY29uc3QgdiA9IHZlcnRzW2ZhY2VzW2ldWzBdXTsgLy8gV2Ugb25seSBuZWVkIG9uZSBwb2ludCBpbiB0aGUgZmFjZQogICAgICAgIC8vIFRoaXMgZG90IHByb2R1Y3QgZGV0ZXJtaW5lcyB3aGljaCBzaWRlIG9mIHRoZSBlZGdlIHRoZSBwb2ludCBpcwoKICAgICAgICBjb25zdCB2VG9QID0gbmV3IFZlYzMoKTsKICAgICAgICBwLnZzdWIodiwgdlRvUCk7CiAgICAgICAgY29uc3QgcjEgPSBuLmRvdCh2VG9QKTsKICAgICAgICBjb25zdCB2VG9Qb2ludEluc2lkZSA9IG5ldyBWZWMzKCk7CiAgICAgICAgcG9pbnRJbnNpZGUudnN1Yih2LCB2VG9Qb2ludEluc2lkZSk7CiAgICAgICAgY29uc3QgcjIgPSBuLmRvdCh2VG9Qb2ludEluc2lkZSk7CgogICAgICAgIGlmIChyMSA8IDAgJiYgcjIgPiAwIHx8IHIxID4gMCAmJiByMiA8IDApIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsgLy8gRW5jb3VudGVyZWQgc29tZSBvdGhlciBzaWduLiBFeGl0LgogICAgICAgIH0KICAgICAgfSAvLyBJZiB3ZSBnb3QgaGVyZSwgYWxsIGRvdCBwcm9kdWN0cyB3ZXJlIG9mIHRoZSBzYW1lIHNpZ24uCgoKICAgICAgcmV0dXJuIHBvc2l0aXZlUmVzdWx0ID8gMSA6IC0xOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgbWF4IGFuZCBtaW4gZG90IHByb2R1Y3Qgb2YgYSBjb252ZXggaHVsbCBhdCBwb3NpdGlvbiAocG9zLHF1YXQpIHByb2plY3RlZCBvbnRvIGFuIGF4aXMuCiAgICAgKiBSZXN1bHRzIGFyZSBzYXZlZCBpbiB0aGUgYXJyYXkgbWF4bWluLgogICAgICogQHBhcmFtIHJlc3VsdCByZXN1bHRbMF0gYW5kIHJlc3VsdFsxXSB3aWxsIGJlIHNldCB0byBtYXhpbXVtIGFuZCBtaW5pbXVtLCByZXNwZWN0aXZlbHkuCiAgICAgKi8KCgogICAgc3RhdGljIHByb2plY3Qoc2hhcGUsIGF4aXMsIHBvcywgcXVhdCwgcmVzdWx0KSB7CiAgICAgIGNvbnN0IG4gPSBzaGFwZS52ZXJ0aWNlcy5sZW5ndGg7CiAgICAgIGNvbnN0IGxvY2FsQXhpcyA9IHByb2plY3RfbG9jYWxBeGlzOwogICAgICBsZXQgbWF4ID0gMDsKICAgICAgbGV0IG1pbiA9IDA7CiAgICAgIGNvbnN0IGxvY2FsT3JpZ2luID0gcHJvamVjdF9sb2NhbE9yaWdpbjsKICAgICAgY29uc3QgdnMgPSBzaGFwZS52ZXJ0aWNlczsKICAgICAgbG9jYWxPcmlnaW4uc2V0WmVybygpOyAvLyBUcmFuc2Zvcm0gdGhlIGF4aXMgdG8gbG9jYWwKCiAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb0xvY2FsRnJhbWUocG9zLCBxdWF0LCBheGlzLCBsb2NhbEF4aXMpOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb0xvY2FsRnJhbWUocG9zLCBxdWF0LCBsb2NhbE9yaWdpbiwgbG9jYWxPcmlnaW4pOwogICAgICBjb25zdCBhZGQgPSBsb2NhbE9yaWdpbi5kb3QobG9jYWxBeGlzKTsKICAgICAgbWluID0gbWF4ID0gdnNbMF0uZG90KGxvY2FsQXhpcyk7CgogICAgICBmb3IgKGxldCBpID0gMTsgaSA8IG47IGkrKykgewogICAgICAgIGNvbnN0IHZhbCA9IHZzW2ldLmRvdChsb2NhbEF4aXMpOwoKICAgICAgICBpZiAodmFsID4gbWF4KSB7CiAgICAgICAgICBtYXggPSB2YWw7CiAgICAgICAgfQoKICAgICAgICBpZiAodmFsIDwgbWluKSB7CiAgICAgICAgICBtaW4gPSB2YWw7CiAgICAgICAgfQogICAgICB9CgogICAgICBtaW4gLT0gYWRkOwogICAgICBtYXggLT0gYWRkOwoKICAgICAgaWYgKG1pbiA+IG1heCkgewogICAgICAgIC8vIEluY29uc2lzdGVudCAtIHN3YXAKICAgICAgICBjb25zdCB0ZW1wID0gbWluOwogICAgICAgIG1pbiA9IG1heDsKICAgICAgICBtYXggPSB0ZW1wOwogICAgICB9IC8vIE91dHB1dAoKCiAgICAgIHJlc3VsdFswXSA9IG1heDsKICAgICAgcmVzdWx0WzFdID0gbWluOwogICAgfQoKICB9CiAgY29uc3QgbWF4bWluQSA9IFtdOwogIGNvbnN0IG1heG1pbkIgPSBbXTsKICBuZXcgVmVjMygpOwogIGNvbnN0IHByb2plY3RfbG9jYWxBeGlzID0gbmV3IFZlYzMoKTsKICBjb25zdCBwcm9qZWN0X2xvY2FsT3JpZ2luID0gbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQSAzZCBib3ggc2hhcGUuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3Qgc2l6ZSA9IDEKICAgKiAgICAgY29uc3QgaGFsZkV4dGVudHMgPSBuZXcgQ0FOTk9OLlZlYzMoc2l6ZSwgc2l6ZSwgc2l6ZSkKICAgKiAgICAgY29uc3QgYm94U2hhcGUgPSBuZXcgQ0FOTk9OLkJveChoYWxmRXh0ZW50cykKICAgKiAgICAgY29uc3QgYm94Qm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDEsIHNoYXBlOiBib3hTaGFwZSB9KQogICAqICAgICB3b3JsZC5hZGRCb2R5KGJveEJvZHkpCiAgICovCiAgY2xhc3MgQm94IGV4dGVuZHMgU2hhcGUgewogICAgLyoqCiAgICAgKiBUaGUgaGFsZiBleHRlbnRzIG9mIHRoZSBib3guCiAgICAgKi8KCiAgICAvKioKICAgICAqIFVzZWQgYnkgdGhlIGNvbnRhY3QgZ2VuZXJhdG9yIHRvIG1ha2UgY29udGFjdHMgd2l0aCBvdGhlciBjb252ZXggcG9seWhlZHJhIGZvciBleGFtcGxlLgogICAgICovCiAgICBjb25zdHJ1Y3RvcihoYWxmRXh0ZW50cykgewogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuQk9YCiAgICAgIH0pOwogICAgICB0aGlzLmhhbGZFeHRlbnRzID0gaGFsZkV4dGVudHM7CiAgICAgIHRoaXMuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uID0gbnVsbDsKICAgICAgdGhpcy51cGRhdGVDb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24oKTsKICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGVzIHRoZSBsb2NhbCBjb252ZXggcG9seWhlZHJvbiByZXByZXNlbnRhdGlvbiB1c2VkIGZvciBzb21lIGNvbGxpc2lvbnMuCiAgICAgKi8KCgogICAgdXBkYXRlQ29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uKCkgewogICAgICBjb25zdCBzeCA9IHRoaXMuaGFsZkV4dGVudHMueDsKICAgICAgY29uc3Qgc3kgPSB0aGlzLmhhbGZFeHRlbnRzLnk7CiAgICAgIGNvbnN0IHN6ID0gdGhpcy5oYWxmRXh0ZW50cy56OwogICAgICBjb25zdCBWID0gVmVjMzsKICAgICAgY29uc3QgdmVydGljZXMgPSBbbmV3IFYoLXN4LCAtc3ksIC1zeiksIG5ldyBWKHN4LCAtc3ksIC1zeiksIG5ldyBWKHN4LCBzeSwgLXN6KSwgbmV3IFYoLXN4LCBzeSwgLXN6KSwgbmV3IFYoLXN4LCAtc3ksIHN6KSwgbmV3IFYoc3gsIC1zeSwgc3opLCBuZXcgVihzeCwgc3ksIHN6KSwgbmV3IFYoLXN4LCBzeSwgc3opXTsKICAgICAgY29uc3QgZmFjZXMgPSBbWzMsIDIsIDEsIDBdLCAvLyAtegogICAgICBbNCwgNSwgNiwgN10sIC8vICt6CiAgICAgIFs1LCA0LCAwLCAxXSwgLy8gLXkKICAgICAgWzIsIDMsIDcsIDZdLCAvLyAreQogICAgICBbMCwgNCwgNywgM10sIC8vIC14CiAgICAgIFsxLCAyLCA2LCA1XSAvLyAreAogICAgICBdOwogICAgICBjb25zdCBheGVzID0gW25ldyBWKDAsIDAsIDEpLCBuZXcgVigwLCAxLCAwKSwgbmV3IFYoMSwgMCwgMCldOwogICAgICBjb25zdCBoID0gbmV3IENvbnZleFBvbHloZWRyb24oewogICAgICAgIHZlcnRpY2VzLAogICAgICAgIGZhY2VzLAogICAgICAgIGF4ZXMKICAgICAgfSk7CiAgICAgIHRoaXMuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uID0gaDsKICAgICAgaC5tYXRlcmlhbCA9IHRoaXMubWF0ZXJpYWw7CiAgICB9CiAgICAvKioKICAgICAqIENhbGN1bGF0ZSB0aGUgaW5lcnRpYSBvZiB0aGUgYm94LgogICAgICovCgoKICAgIGNhbGN1bGF0ZUxvY2FsSW5lcnRpYShtYXNzLCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgQm94LmNhbGN1bGF0ZUluZXJ0aWEodGhpcy5oYWxmRXh0ZW50cywgbWFzcywgdGFyZ2V0KTsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KCiAgICBzdGF0aWMgY2FsY3VsYXRlSW5lcnRpYShoYWxmRXh0ZW50cywgbWFzcywgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IGUgPSBoYWxmRXh0ZW50czsKICAgICAgdGFyZ2V0LnggPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogZS55ICogMiAqIGUueSArIDIgKiBlLnogKiAyICogZS56KTsKICAgICAgdGFyZ2V0LnkgPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogZS54ICogMiAqIGUueCArIDIgKiBlLnogKiAyICogZS56KTsKICAgICAgdGFyZ2V0LnogPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogZS55ICogMiAqIGUueSArIDIgKiBlLnggKiAyICogZS54KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBib3ggNiBzaWRlIG5vcm1hbHMKICAgICAqIEBwYXJhbSBzaXhUYXJnZXRWZWN0b3JzIEFuIGFycmF5IG9mIDYgdmVjdG9ycywgdG8gc3RvcmUgdGhlIHJlc3VsdGluZyBzaWRlIG5vcm1hbHMgaW4uCiAgICAgKiBAcGFyYW0gcXVhdCBPcmllbnRhdGlvbiB0byBhcHBseSB0byB0aGUgbm9ybWFsIHZlY3RvcnMuIElmIG5vdCBwcm92aWRlZCwgdGhlIHZlY3RvcnMgd2lsbCBiZSBpbiByZXNwZWN0IHRvIHRoZSBsb2NhbCBmcmFtZS4KICAgICAqLwoKCiAgICBnZXRTaWRlTm9ybWFscyhzaXhUYXJnZXRWZWN0b3JzLCBxdWF0KSB7CiAgICAgIGNvbnN0IHNpZGVzID0gc2l4VGFyZ2V0VmVjdG9yczsKICAgICAgY29uc3QgZXggPSB0aGlzLmhhbGZFeHRlbnRzOwogICAgICBzaWRlc1swXS5zZXQoZXgueCwgMCwgMCk7CiAgICAgIHNpZGVzWzFdLnNldCgwLCBleC55LCAwKTsKICAgICAgc2lkZXNbMl0uc2V0KDAsIDAsIGV4LnopOwogICAgICBzaWRlc1szXS5zZXQoLWV4LngsIDAsIDApOwogICAgICBzaWRlc1s0XS5zZXQoMCwgLWV4LnksIDApOwogICAgICBzaWRlc1s1XS5zZXQoMCwgMCwgLWV4LnopOwoKICAgICAgaWYgKHF1YXQgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBzaWRlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgcXVhdC52bXVsdChzaWRlc1tpXSwgc2lkZXNbaV0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHNpZGVzOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSB2b2x1bWUgb2YgdGhlIGJveC4KICAgICAqLwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIHJldHVybiA4LjAgKiB0aGlzLmhhbGZFeHRlbnRzLnggKiB0aGlzLmhhbGZFeHRlbnRzLnkgKiB0aGlzLmhhbGZFeHRlbnRzLno7CiAgICB9CiAgICAvKioKICAgICAqIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzCiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSB0aGlzLmhhbGZFeHRlbnRzLmxlbmd0aCgpOwogICAgfQogICAgLyoqCiAgICAgKiBmb3JFYWNoV29ybGRDb3JuZXIKICAgICAqLwoKCiAgICBmb3JFYWNoV29ybGRDb3JuZXIocG9zLCBxdWF0LCBjYWxsYmFjaykgewogICAgICBjb25zdCBlID0gdGhpcy5oYWxmRXh0ZW50czsKICAgICAgY29uc3QgY29ybmVycyA9IFtbZS54LCBlLnksIGUuel0sIFstZS54LCBlLnksIGUuel0sIFstZS54LCAtZS55LCBlLnpdLCBbLWUueCwgLWUueSwgLWUuel0sIFtlLngsIC1lLnksIC1lLnpdLCBbZS54LCBlLnksIC1lLnpdLCBbLWUueCwgZS55LCAtZS56XSwgW2UueCwgLWUueSwgZS56XV07CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvcm5lcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICB3b3JsZENvcm5lclRlbXBQb3Muc2V0KGNvcm5lcnNbaV1bMF0sIGNvcm5lcnNbaV1bMV0sIGNvcm5lcnNbaV1bMl0pOwogICAgICAgIHF1YXQudm11bHQod29ybGRDb3JuZXJUZW1wUG9zLCB3b3JsZENvcm5lclRlbXBQb3MpOwogICAgICAgIHBvcy52YWRkKHdvcmxkQ29ybmVyVGVtcFBvcywgd29ybGRDb3JuZXJUZW1wUG9zKTsKICAgICAgICBjYWxsYmFjayh3b3JsZENvcm5lclRlbXBQb3MueCwgd29ybGRDb3JuZXJUZW1wUG9zLnksIHdvcmxkQ29ybmVyVGVtcFBvcy56KTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBjYWxjdWxhdGVXb3JsZEFBQkIKICAgICAqLwoKCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICBjb25zdCBlID0gdGhpcy5oYWxmRXh0ZW50czsKICAgICAgd29ybGRDb3JuZXJzVGVtcFswXS5zZXQoZS54LCBlLnksIGUueik7CiAgICAgIHdvcmxkQ29ybmVyc1RlbXBbMV0uc2V0KC1lLngsIGUueSwgZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFsyXS5zZXQoLWUueCwgLWUueSwgZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFszXS5zZXQoLWUueCwgLWUueSwgLWUueik7CiAgICAgIHdvcmxkQ29ybmVyc1RlbXBbNF0uc2V0KGUueCwgLWUueSwgLWUueik7CiAgICAgIHdvcmxkQ29ybmVyc1RlbXBbNV0uc2V0KGUueCwgZS55LCAtZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFs2XS5zZXQoLWUueCwgZS55LCAtZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFs3XS5zZXQoZS54LCAtZS55LCBlLnopOwogICAgICBjb25zdCB3YyA9IHdvcmxkQ29ybmVyc1RlbXBbMF07CiAgICAgIHF1YXQudm11bHQod2MsIHdjKTsKICAgICAgcG9zLnZhZGQod2MsIHdjKTsKICAgICAgbWF4LmNvcHkod2MpOwogICAgICBtaW4uY29weSh3Yyk7CgogICAgICBmb3IgKGxldCBpID0gMTsgaSA8IDg7IGkrKykgewogICAgICAgIGNvbnN0IHdjID0gd29ybGRDb3JuZXJzVGVtcFtpXTsKICAgICAgICBxdWF0LnZtdWx0KHdjLCB3Yyk7CiAgICAgICAgcG9zLnZhZGQod2MsIHdjKTsKICAgICAgICBjb25zdCB4ID0gd2MueDsKICAgICAgICBjb25zdCB5ID0gd2MueTsKICAgICAgICBjb25zdCB6ID0gd2MuejsKCiAgICAgICAgaWYgKHggPiBtYXgueCkgewogICAgICAgICAgbWF4LnggPSB4OwogICAgICAgIH0KCiAgICAgICAgaWYgKHkgPiBtYXgueSkgewogICAgICAgICAgbWF4LnkgPSB5OwogICAgICAgIH0KCiAgICAgICAgaWYgKHogPiBtYXgueikgewogICAgICAgICAgbWF4LnogPSB6OwogICAgICAgIH0KCiAgICAgICAgaWYgKHggPCBtaW4ueCkgewogICAgICAgICAgbWluLnggPSB4OwogICAgICAgIH0KCiAgICAgICAgaWYgKHkgPCBtaW4ueSkgewogICAgICAgICAgbWluLnkgPSB5OwogICAgICAgIH0KCiAgICAgICAgaWYgKHogPCBtaW4ueikgewogICAgICAgICAgbWluLnogPSB6OwogICAgICAgIH0KICAgICAgfSAvLyBHZXQgZWFjaCBheGlzIG1heAogICAgICAvLyBtaW4uc2V0KEluZmluaXR5LEluZmluaXR5LEluZmluaXR5KTsKICAgICAgLy8gbWF4LnNldCgtSW5maW5pdHksLUluZmluaXR5LC1JbmZpbml0eSk7CiAgICAgIC8vIHRoaXMuZm9yRWFjaFdvcmxkQ29ybmVyKHBvcyxxdWF0LGZ1bmN0aW9uKHgseSx6KXsKICAgICAgLy8gICAgIGlmKHggPiBtYXgueCl7CiAgICAgIC8vICAgICAgICAgbWF4LnggPSB4OwogICAgICAvLyAgICAgfQogICAgICAvLyAgICAgaWYoeSA+IG1heC55KXsKICAgICAgLy8gICAgICAgICBtYXgueSA9IHk7CiAgICAgIC8vICAgICB9CiAgICAgIC8vICAgICBpZih6ID4gbWF4LnopewogICAgICAvLyAgICAgICAgIG1heC56ID0gejsKICAgICAgLy8gICAgIH0KICAgICAgLy8gICAgIGlmKHggPCBtaW4ueCl7CiAgICAgIC8vICAgICAgICAgbWluLnggPSB4OwogICAgICAvLyAgICAgfQogICAgICAvLyAgICAgaWYoeSA8IG1pbi55KXsKICAgICAgLy8gICAgICAgICBtaW4ueSA9IHk7CiAgICAgIC8vICAgICB9CiAgICAgIC8vICAgICBpZih6IDwgbWluLnopewogICAgICAvLyAgICAgICAgIG1pbi56ID0gejsKICAgICAgLy8gICAgIH0KICAgICAgLy8gfSk7CgogICAgfQoKICB9CiAgY29uc3Qgd29ybGRDb3JuZXJUZW1wUG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCB3b3JsZENvcm5lcnNUZW1wID0gW25ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCldOwoKICAvKioKICAgKiBCT0RZX1RZUEVTCiAgICovCiAgY29uc3QgQk9EWV9UWVBFUyA9IHsKICAgIC8qKiBEWU5BTUlDICovCiAgICBEWU5BTUlDOiAxLAoKICAgIC8qKiBTVEFUSUMgKi8KICAgIFNUQVRJQzogMiwKCiAgICAvKiogS0lORU1BVElDICovCiAgICBLSU5FTUFUSUM6IDQKICB9OwogIC8qKgogICAqIEJvZHlUeXBlCiAgICovCgogIC8qKgogICAqIEJPRFlfU0xFRVBfU1RBVEVTCiAgICovCiAgY29uc3QgQk9EWV9TTEVFUF9TVEFURVMgPSB7CiAgICAvKiogQVdBS0UgKi8KICAgIEFXQUtFOiAwLAoKICAgIC8qKiBTTEVFUFkgKi8KICAgIFNMRUVQWTogMSwKCiAgICAvKiogU0xFRVBJTkcgKi8KICAgIFNMRUVQSU5HOiAyCiAgfTsKICAvKioKICAgKiBCb2R5U2xlZXBTdGF0ZQogICAqLwoKICAvKioKICAgKiBCYXNlIGNsYXNzIGZvciBhbGwgYm9keSB0eXBlcy4KICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCBzaGFwZSA9IG5ldyBDQU5OT04uU3BoZXJlKDEpCiAgICogICAgIGNvbnN0IGJvZHkgPSBuZXcgQ0FOTk9OLkJvZHkoewogICAqICAgICAgIG1hc3M6IDEsCiAgICogICAgICAgc2hhcGUsCiAgICogICAgIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoYm9keSkKICAgKi8KICBjbGFzcyBCb2R5IGV4dGVuZHMgRXZlbnRUYXJnZXQgewogICAgLyoqCiAgICAgKiBEaXNwYXRjaGVkIGFmdGVyIHR3byBib2RpZXMgY29sbGlkZS4gVGhpcyBldmVudCBpcyBkaXNwYXRjaGVkIG9uIGVhY2gKICAgICAqIG9mIHRoZSB0d28gYm9kaWVzIGludm9sdmVkIGluIHRoZSBjb2xsaXNpb24uCiAgICAgKiBAZXZlbnQgY29sbGlkZQogICAgICogQHBhcmFtIGJvZHkgVGhlIGJvZHkgdGhhdCB3YXMgaW52b2x2ZWQgaW4gdGhlIGNvbGxpc2lvbi4KICAgICAqIEBwYXJhbSBjb250YWN0IFRoZSBkZXRhaWxzIG9mIHRoZSBjb2xsaXNpb24uCiAgICAgKi8KCiAgICAvKioKICAgICAqIEEgZHluYW1pYyBib2R5IGlzIGZ1bGx5IHNpbXVsYXRlZC4gQ2FuIGJlIG1vdmVkIG1hbnVhbGx5IGJ5IHRoZSB1c2VyLCBidXQgbm9ybWFsbHkgdGhleSBtb3ZlIGFjY29yZGluZyB0byBmb3JjZXMuIEEgZHluYW1pYyBib2R5IGNhbiBjb2xsaWRlIHdpdGggYWxsIGJvZHkgdHlwZXMuIEEgZHluYW1pYyBib2R5IGFsd2F5cyBoYXMgZmluaXRlLCBub24temVybyBtYXNzLgogICAgICovCgogICAgLyoqCiAgICAgKiBBIHN0YXRpYyBib2R5IGRvZXMgbm90IG1vdmUgZHVyaW5nIHNpbXVsYXRpb24gYW5kIGJlaGF2ZXMgYXMgaWYgaXQgaGFzIGluZmluaXRlIG1hc3MuIFN0YXRpYyBib2RpZXMgY2FuIGJlIG1vdmVkIG1hbnVhbGx5IGJ5IHNldHRpbmcgdGhlIHBvc2l0aW9uIG9mIHRoZSBib2R5LiBUaGUgdmVsb2NpdHkgb2YgYSBzdGF0aWMgYm9keSBpcyBhbHdheXMgemVyby4gU3RhdGljIGJvZGllcyBkbyBub3QgY29sbGlkZSB3aXRoIG90aGVyIHN0YXRpYyBvciBraW5lbWF0aWMgYm9kaWVzLgogICAgICovCgogICAgLyoqCiAgICAgKiBBIGtpbmVtYXRpYyBib2R5IG1vdmVzIHVuZGVyIHNpbXVsYXRpb24gYWNjb3JkaW5nIHRvIGl0cyB2ZWxvY2l0eS4gVGhleSBkbyBub3QgcmVzcG9uZCB0byBmb3JjZXMuIFRoZXkgY2FuIGJlIG1vdmVkIG1hbnVhbGx5LCBidXQgbm9ybWFsbHkgYSBraW5lbWF0aWMgYm9keSBpcyBtb3ZlZCBieSBzZXR0aW5nIGl0cyB2ZWxvY2l0eS4gQSBraW5lbWF0aWMgYm9keSBiZWhhdmVzIGFzIGlmIGl0IGhhcyBpbmZpbml0ZSBtYXNzLiBLaW5lbWF0aWMgYm9kaWVzIGRvIG5vdCBjb2xsaWRlIHdpdGggb3RoZXIgc3RhdGljIG9yIGtpbmVtYXRpYyBib2RpZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFXQUtFCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNMRUVQWQogICAgICovCgogICAgLyoqCiAgICAgKiBTTEVFUElORwogICAgICovCgogICAgLyoqCiAgICAgKiBEaXNwYXRjaGVkIGFmdGVyIGEgc2xlZXBpbmcgYm9keSBoYXMgd29rZW4gdXAuCiAgICAgKiBAZXZlbnQgd2FrZXVwCiAgICAgKi8KCiAgICAvKioKICAgICAqIERpc3BhdGNoZWQgYWZ0ZXIgYSBib2R5IGhhcyBnb25lIGluIHRvIHRoZSBzbGVlcHkgc3RhdGUuCiAgICAgKiBAZXZlbnQgc2xlZXB5CiAgICAgKi8KCiAgICAvKioKICAgICAqIERpc3BhdGNoZWQgYWZ0ZXIgYSBib2R5IGhhcyBmYWxsZW4gYXNsZWVwLgogICAgICogQGV2ZW50IHNsZWVwCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgc3VwZXIoKTsKICAgICAgdGhpcy5pZCA9IEJvZHkuaWRDb3VudGVyKys7CiAgICAgIHRoaXMuaW5kZXggPSAtMTsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICAgIHRoaXMudmxhbWJkYSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgPSB0eXBlb2Ygb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJHcm91cCA9PT0gJ251bWJlcicgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwIDogMTsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJNYXNrID0gdHlwZW9mIG9wdGlvbnMuY29sbGlzaW9uRmlsdGVyTWFzayA9PT0gJ251bWJlcicgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlck1hc2sgOiAtMTsKICAgICAgdGhpcy5jb2xsaXNpb25SZXNwb25zZSA9IHR5cGVvZiBvcHRpb25zLmNvbGxpc2lvblJlc3BvbnNlID09PSAnYm9vbGVhbicgPyBvcHRpb25zLmNvbGxpc2lvblJlc3BvbnNlIDogdHJ1ZTsKICAgICAgdGhpcy5wb3NpdGlvbiA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMucHJldmlvdXNQb3NpdGlvbiA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuaW50ZXJwb2xhdGVkUG9zaXRpb24gPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmluaXRQb3NpdGlvbiA9IG5ldyBWZWMzKCk7CgogICAgICBpZiAob3B0aW9ucy5wb3NpdGlvbikgewogICAgICAgIHRoaXMucG9zaXRpb24uY29weShvcHRpb25zLnBvc2l0aW9uKTsKICAgICAgICB0aGlzLnByZXZpb3VzUG9zaXRpb24uY29weShvcHRpb25zLnBvc2l0aW9uKTsKICAgICAgICB0aGlzLmludGVycG9sYXRlZFBvc2l0aW9uLmNvcHkob3B0aW9ucy5wb3NpdGlvbik7CiAgICAgICAgdGhpcy5pbml0UG9zaXRpb24uY29weShvcHRpb25zLnBvc2l0aW9uKTsKICAgICAgfQoKICAgICAgdGhpcy52ZWxvY2l0eSA9IG5ldyBWZWMzKCk7CgogICAgICBpZiAob3B0aW9ucy52ZWxvY2l0eSkgewogICAgICAgIHRoaXMudmVsb2NpdHkuY29weShvcHRpb25zLnZlbG9jaXR5KTsKICAgICAgfQoKICAgICAgdGhpcy5pbml0VmVsb2NpdHkgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmZvcmNlID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgbWFzcyA9IHR5cGVvZiBvcHRpb25zLm1hc3MgPT09ICdudW1iZXInID8gb3B0aW9ucy5tYXNzIDogMDsKICAgICAgdGhpcy5tYXNzID0gbWFzczsKICAgICAgdGhpcy5pbnZNYXNzID0gbWFzcyA+IDAgPyAxLjAgLyBtYXNzIDogMDsKICAgICAgdGhpcy5tYXRlcmlhbCA9IG9wdGlvbnMubWF0ZXJpYWwgfHwgbnVsbDsKICAgICAgdGhpcy5saW5lYXJEYW1waW5nID0gdHlwZW9mIG9wdGlvbnMubGluZWFyRGFtcGluZyA9PT0gJ251bWJlcicgPyBvcHRpb25zLmxpbmVhckRhbXBpbmcgOiAwLjAxOwogICAgICB0aGlzLnR5cGUgPSBtYXNzIDw9IDAuMCA/IEJvZHkuU1RBVElDIDogQm9keS5EWU5BTUlDOwoKICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLnR5cGUgPT09IHR5cGVvZiBCb2R5LlNUQVRJQykgewogICAgICAgIHRoaXMudHlwZSA9IG9wdGlvbnMudHlwZTsKICAgICAgfQoKICAgICAgdGhpcy5hbGxvd1NsZWVwID0gdHlwZW9mIG9wdGlvbnMuYWxsb3dTbGVlcCAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmFsbG93U2xlZXAgOiB0cnVlOwogICAgICB0aGlzLnNsZWVwU3RhdGUgPSBCb2R5LkFXQUtFOwogICAgICB0aGlzLnNsZWVwU3BlZWRMaW1pdCA9IHR5cGVvZiBvcHRpb25zLnNsZWVwU3BlZWRMaW1pdCAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLnNsZWVwU3BlZWRMaW1pdCA6IDAuMTsKICAgICAgdGhpcy5zbGVlcFRpbWVMaW1pdCA9IHR5cGVvZiBvcHRpb25zLnNsZWVwVGltZUxpbWl0ICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuc2xlZXBUaW1lTGltaXQgOiAxOwogICAgICB0aGlzLnRpbWVMYXN0U2xlZXB5ID0gMDsKICAgICAgdGhpcy53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CiAgICAgIHRoaXMudG9ycXVlID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5xdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgdGhpcy5pbml0UXVhdGVybmlvbiA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgICAgIHRoaXMucHJldmlvdXNRdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgdGhpcy5pbnRlcnBvbGF0ZWRRdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKCiAgICAgIGlmIChvcHRpb25zLnF1YXRlcm5pb24pIHsKICAgICAgICB0aGlzLnF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICAgIHRoaXMuaW5pdFF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICAgIHRoaXMucHJldmlvdXNRdWF0ZXJuaW9uLmNvcHkob3B0aW9ucy5xdWF0ZXJuaW9uKTsKICAgICAgICB0aGlzLmludGVycG9sYXRlZFF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICB9CgogICAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eSA9IG5ldyBWZWMzKCk7CgogICAgICBpZiAob3B0aW9ucy5hbmd1bGFyVmVsb2NpdHkpIHsKICAgICAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eS5jb3B5KG9wdGlvbnMuYW5ndWxhclZlbG9jaXR5KTsKICAgICAgfQoKICAgICAgdGhpcy5pbml0QW5ndWxhclZlbG9jaXR5ID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5zaGFwZXMgPSBbXTsKICAgICAgdGhpcy5zaGFwZU9mZnNldHMgPSBbXTsKICAgICAgdGhpcy5zaGFwZU9yaWVudGF0aW9ucyA9IFtdOwogICAgICB0aGlzLmluZXJ0aWEgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmludkluZXJ0aWEgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmludkluZXJ0aWFXb3JsZCA9IG5ldyBNYXQzKCk7CiAgICAgIHRoaXMuaW52TWFzc1NvbHZlID0gMDsKICAgICAgdGhpcy5pbnZJbmVydGlhU29sdmUgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmludkluZXJ0aWFXb3JsZFNvbHZlID0gbmV3IE1hdDMoKTsKICAgICAgdGhpcy5maXhlZFJvdGF0aW9uID0gdHlwZW9mIG9wdGlvbnMuZml4ZWRSb3RhdGlvbiAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmZpeGVkUm90YXRpb24gOiBmYWxzZTsKICAgICAgdGhpcy5hbmd1bGFyRGFtcGluZyA9IHR5cGVvZiBvcHRpb25zLmFuZ3VsYXJEYW1waW5nICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuYW5ndWxhckRhbXBpbmcgOiAwLjAxOwogICAgICB0aGlzLmxpbmVhckZhY3RvciA9IG5ldyBWZWMzKDEsIDEsIDEpOwoKICAgICAgaWYgKG9wdGlvbnMubGluZWFyRmFjdG9yKSB7CiAgICAgICAgdGhpcy5saW5lYXJGYWN0b3IuY29weShvcHRpb25zLmxpbmVhckZhY3Rvcik7CiAgICAgIH0KCiAgICAgIHRoaXMuYW5ndWxhckZhY3RvciA9IG5ldyBWZWMzKDEsIDEsIDEpOwoKICAgICAgaWYgKG9wdGlvbnMuYW5ndWxhckZhY3RvcikgewogICAgICAgIHRoaXMuYW5ndWxhckZhY3Rvci5jb3B5KG9wdGlvbnMuYW5ndWxhckZhY3Rvcik7CiAgICAgIH0KCiAgICAgIHRoaXMuYWFiYiA9IG5ldyBBQUJCKCk7CiAgICAgIHRoaXMuYWFiYk5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgdGhpcy5ib3VuZGluZ1JhZGl1cyA9IDA7CiAgICAgIHRoaXMud2xhbWJkYSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuaXNUcmlnZ2VyID0gQm9vbGVhbihvcHRpb25zLmlzVHJpZ2dlcik7CgogICAgICBpZiAob3B0aW9ucy5zaGFwZSkgewogICAgICAgIHRoaXMuYWRkU2hhcGUob3B0aW9ucy5zaGFwZSk7CiAgICAgIH0KCiAgICAgIHRoaXMudXBkYXRlTWFzc1Byb3BlcnRpZXMoKTsKICAgIH0KICAgIC8qKgogICAgICogV2FrZSB0aGUgYm9keSB1cC4KICAgICAqLwoKCiAgICB3YWtlVXAoKSB7CiAgICAgIGNvbnN0IHByZXZTdGF0ZSA9IHRoaXMuc2xlZXBTdGF0ZTsKICAgICAgdGhpcy5zbGVlcFN0YXRlID0gQm9keS5BV0FLRTsKICAgICAgdGhpcy53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CgogICAgICBpZiAocHJldlN0YXRlID09PSBCb2R5LlNMRUVQSU5HKSB7CiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KEJvZHkud2FrZXVwRXZlbnQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEZvcmNlIGJvZHkgc2xlZXAKICAgICAqLwoKCiAgICBzbGVlcCgpIHsKICAgICAgdGhpcy5zbGVlcFN0YXRlID0gQm9keS5TTEVFUElORzsKICAgICAgdGhpcy52ZWxvY2l0eS5zZXQoMCwgMCwgMCk7CiAgICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5LnNldCgwLCAwLCAwKTsKICAgICAgdGhpcy53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIENhbGxlZCBldmVyeSB0aW1lc3RlcCB0byB1cGRhdGUgaW50ZXJuYWwgc2xlZXAgdGltZXIgYW5kIGNoYW5nZSBzbGVlcCBzdGF0ZSBpZiBuZWVkZWQuCiAgICAgKiBAcGFyYW0gdGltZSBUaGUgd29ybGQgdGltZSBpbiBzZWNvbmRzCiAgICAgKi8KCgogICAgc2xlZXBUaWNrKHRpbWUpIHsKICAgICAgaWYgKHRoaXMuYWxsb3dTbGVlcCkgewogICAgICAgIGNvbnN0IHNsZWVwU3RhdGUgPSB0aGlzLnNsZWVwU3RhdGU7CiAgICAgICAgY29uc3Qgc3BlZWRTcXVhcmVkID0gdGhpcy52ZWxvY2l0eS5sZW5ndGhTcXVhcmVkKCkgKyB0aGlzLmFuZ3VsYXJWZWxvY2l0eS5sZW5ndGhTcXVhcmVkKCk7CiAgICAgICAgY29uc3Qgc3BlZWRMaW1pdFNxdWFyZWQgPSB0aGlzLnNsZWVwU3BlZWRMaW1pdCAqKiAyOwoKICAgICAgICBpZiAoc2xlZXBTdGF0ZSA9PT0gQm9keS5BV0FLRSAmJiBzcGVlZFNxdWFyZWQgPCBzcGVlZExpbWl0U3F1YXJlZCkgewogICAgICAgICAgdGhpcy5zbGVlcFN0YXRlID0gQm9keS5TTEVFUFk7IC8vIFNsZWVweQoKICAgICAgICAgIHRoaXMudGltZUxhc3RTbGVlcHkgPSB0aW1lOwogICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KEJvZHkuc2xlZXB5RXZlbnQpOwogICAgICAgIH0gZWxzZSBpZiAoc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUFkgJiYgc3BlZWRTcXVhcmVkID4gc3BlZWRMaW1pdFNxdWFyZWQpIHsKICAgICAgICAgIHRoaXMud2FrZVVwKCk7IC8vIFdha2UgdXAKICAgICAgICB9IGVsc2UgaWYgKHNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBZICYmIHRpbWUgLSB0aGlzLnRpbWVMYXN0U2xlZXB5ID4gdGhpcy5zbGVlcFRpbWVMaW1pdCkgewogICAgICAgICAgdGhpcy5zbGVlcCgpOyAvLyBTbGVlcGluZwoKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChCb2R5LnNsZWVwRXZlbnQpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBJZiB0aGUgYm9keSBpcyBzbGVlcGluZywgaXQgc2hvdWxkIGJlIGltbW92YWJsZSAvIGhhdmUgaW5maW5pdGUgbWFzcyBkdXJpbmcgc29sdmUuIFdlIHNvbHZlIGl0IGJ5IGhhdmluZyBhIHNlcGFyYXRlICJzb2x2ZSBtYXNzIi4KICAgICAqLwoKCiAgICB1cGRhdGVTb2x2ZU1hc3NQcm9wZXJ0aWVzKCkgewogICAgICBpZiAodGhpcy5zbGVlcFN0YXRlID09PSBCb2R5LlNMRUVQSU5HIHx8IHRoaXMudHlwZSA9PT0gQm9keS5LSU5FTUFUSUMpIHsKICAgICAgICB0aGlzLmludk1hc3NTb2x2ZSA9IDA7CiAgICAgICAgdGhpcy5pbnZJbmVydGlhU29sdmUuc2V0WmVybygpOwogICAgICAgIHRoaXMuaW52SW5lcnRpYVdvcmxkU29sdmUuc2V0WmVybygpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuaW52TWFzc1NvbHZlID0gdGhpcy5pbnZNYXNzOwogICAgICAgIHRoaXMuaW52SW5lcnRpYVNvbHZlLmNvcHkodGhpcy5pbnZJbmVydGlhKTsKICAgICAgICB0aGlzLmludkluZXJ0aWFXb3JsZFNvbHZlLmNvcHkodGhpcy5pbnZJbmVydGlhV29ybGQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgYSB3b3JsZCBwb2ludCB0byBsb2NhbCBib2R5IGZyYW1lLgogICAgICovCgoKICAgIHBvaW50VG9Mb2NhbEZyYW1lKHdvcmxkUG9pbnQsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB3b3JsZFBvaW50LnZzdWIodGhpcy5wb3NpdGlvbiwgcmVzdWx0KTsKICAgICAgdGhpcy5xdWF0ZXJuaW9uLmNvbmp1Z2F0ZSgpLnZtdWx0KHJlc3VsdCwgcmVzdWx0KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKgogICAgICogQ29udmVydCBhIHdvcmxkIHZlY3RvciB0byBsb2NhbCBib2R5IGZyYW1lLgogICAgICovCgoKICAgIHZlY3RvclRvTG9jYWxGcmFtZSh3b3JsZFZlY3RvciwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHRoaXMucXVhdGVybmlvbi5jb25qdWdhdGUoKS52bXVsdCh3b3JsZFZlY3RvciwgcmVzdWx0KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKgogICAgICogQ29udmVydCBhIGxvY2FsIGJvZHkgcG9pbnQgdG8gd29ybGQgZnJhbWUuCiAgICAgKi8KCgogICAgcG9pbnRUb1dvcmxkRnJhbWUobG9jYWxQb2ludCwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHRoaXMucXVhdGVybmlvbi52bXVsdChsb2NhbFBvaW50LCByZXN1bHQpOwogICAgICByZXN1bHQudmFkZCh0aGlzLnBvc2l0aW9uLCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBDb252ZXJ0IGEgbG9jYWwgYm9keSBwb2ludCB0byB3b3JsZCBmcmFtZS4KICAgICAqLwoKCiAgICB2ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxWZWN0b3IsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0aGlzLnF1YXRlcm5pb24udm11bHQobG9jYWxWZWN0b3IsIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIEFkZCBhIHNoYXBlIHRvIHRoZSBib2R5IHdpdGggYSBsb2NhbCBvZmZzZXQgYW5kIG9yaWVudGF0aW9uLgogICAgICogQHJldHVybiBUaGUgYm9keSBvYmplY3QsIGZvciBjaGFpbmFiaWxpdHkuCiAgICAgKi8KCgogICAgYWRkU2hhcGUoc2hhcGUsIF9vZmZzZXQsIF9vcmllbnRhdGlvbikgewogICAgICBjb25zdCBvZmZzZXQgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBvcmllbnRhdGlvbiA9IG5ldyBRdWF0ZXJuaW9uKCk7CgogICAgICBpZiAoX29mZnNldCkgewogICAgICAgIG9mZnNldC5jb3B5KF9vZmZzZXQpOwogICAgICB9CgogICAgICBpZiAoX29yaWVudGF0aW9uKSB7CiAgICAgICAgb3JpZW50YXRpb24uY29weShfb3JpZW50YXRpb24pOwogICAgICB9CgogICAgICB0aGlzLnNoYXBlcy5wdXNoKHNoYXBlKTsKICAgICAgdGhpcy5zaGFwZU9mZnNldHMucHVzaChvZmZzZXQpOwogICAgICB0aGlzLnNoYXBlT3JpZW50YXRpb25zLnB1c2gob3JpZW50YXRpb24pOwogICAgICB0aGlzLnVwZGF0ZU1hc3NQcm9wZXJ0aWVzKCk7CiAgICAgIHRoaXMudXBkYXRlQm91bmRpbmdSYWRpdXMoKTsKICAgICAgdGhpcy5hYWJiTmVlZHNVcGRhdGUgPSB0cnVlOwogICAgICBzaGFwZS5ib2R5ID0gdGhpczsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIFJlbW92ZSBhIHNoYXBlIGZyb20gdGhlIGJvZHkuCiAgICAgKiBAcmV0dXJuIFRoZSBib2R5IG9iamVjdCwgZm9yIGNoYWluYWJpbGl0eS4KICAgICAqLwoKCiAgICByZW1vdmVTaGFwZShzaGFwZSkgewogICAgICBjb25zdCBpbmRleCA9IHRoaXMuc2hhcGVzLmluZGV4T2Yoc2hhcGUpOwoKICAgICAgaWYgKGluZGV4ID09PSAtMSkgewogICAgICAgIGNvbnNvbGUud2FybignU2hhcGUgZG9lcyBub3QgYmVsb25nIHRvIHRoZSBib2R5Jyk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICAgIHRoaXMuc2hhcGVzLnNwbGljZShpbmRleCwgMSk7CiAgICAgIHRoaXMuc2hhcGVPZmZzZXRzLnNwbGljZShpbmRleCwgMSk7CiAgICAgIHRoaXMuc2hhcGVPcmllbnRhdGlvbnMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgdGhpcy51cGRhdGVNYXNzUHJvcGVydGllcygpOwogICAgICB0aGlzLnVwZGF0ZUJvdW5kaW5nUmFkaXVzKCk7CiAgICAgIHRoaXMuYWFiYk5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgc2hhcGUuYm9keSA9IG51bGw7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGUgdGhlIGJvdW5kaW5nIHJhZGl1cyBvZiB0aGUgYm9keS4gU2hvdWxkIGJlIGRvbmUgaWYgYW55IG9mIHRoZSBzaGFwZXMgYXJlIGNoYW5nZWQuCiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdSYWRpdXMoKSB7CiAgICAgIGNvbnN0IHNoYXBlcyA9IHRoaXMuc2hhcGVzOwogICAgICBjb25zdCBzaGFwZU9mZnNldHMgPSB0aGlzLnNoYXBlT2Zmc2V0czsKICAgICAgY29uc3QgTiA9IHNoYXBlcy5sZW5ndGg7CiAgICAgIGxldCByYWRpdXMgPSAwOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGNvbnN0IHNoYXBlID0gc2hhcGVzW2ldOwogICAgICAgIHNoYXBlLnVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCk7CiAgICAgICAgY29uc3Qgb2Zmc2V0ID0gc2hhcGVPZmZzZXRzW2ldLmxlbmd0aCgpOwogICAgICAgIGNvbnN0IHIgPSBzaGFwZS5ib3VuZGluZ1NwaGVyZVJhZGl1czsKCiAgICAgICAgaWYgKG9mZnNldCArIHIgPiByYWRpdXMpIHsKICAgICAgICAgIHJhZGl1cyA9IG9mZnNldCArIHI7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmJvdW5kaW5nUmFkaXVzID0gcmFkaXVzOwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGVzIHRoZSAuYWFiYgogICAgICovCgoKICAgIHVwZGF0ZUFBQkIoKSB7CiAgICAgIGNvbnN0IHNoYXBlcyA9IHRoaXMuc2hhcGVzOwogICAgICBjb25zdCBzaGFwZU9mZnNldHMgPSB0aGlzLnNoYXBlT2Zmc2V0czsKICAgICAgY29uc3Qgc2hhcGVPcmllbnRhdGlvbnMgPSB0aGlzLnNoYXBlT3JpZW50YXRpb25zOwogICAgICBjb25zdCBOID0gc2hhcGVzLmxlbmd0aDsKICAgICAgY29uc3Qgb2Zmc2V0ID0gdG1wVmVjOwogICAgICBjb25zdCBvcmllbnRhdGlvbiA9IHRtcFF1YXQ7CiAgICAgIGNvbnN0IGJvZHlRdWF0ID0gdGhpcy5xdWF0ZXJuaW9uOwogICAgICBjb25zdCBhYWJiID0gdGhpcy5hYWJiOwogICAgICBjb25zdCBzaGFwZUFBQkIgPSB1cGRhdGVBQUJCX3NoYXBlQUFCQjsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBzaGFwZSA9IHNoYXBlc1tpXTsgLy8gR2V0IHNoYXBlIHdvcmxkIHBvc2l0aW9uCgogICAgICAgIGJvZHlRdWF0LnZtdWx0KHNoYXBlT2Zmc2V0c1tpXSwgb2Zmc2V0KTsKICAgICAgICBvZmZzZXQudmFkZCh0aGlzLnBvc2l0aW9uLCBvZmZzZXQpOyAvLyBHZXQgc2hhcGUgd29ybGQgcXVhdGVybmlvbgoKICAgICAgICBib2R5UXVhdC5tdWx0KHNoYXBlT3JpZW50YXRpb25zW2ldLCBvcmllbnRhdGlvbik7IC8vIEdldCBzaGFwZSBBQUJCCgogICAgICAgIHNoYXBlLmNhbGN1bGF0ZVdvcmxkQUFCQihvZmZzZXQsIG9yaWVudGF0aW9uLCBzaGFwZUFBQkIubG93ZXJCb3VuZCwgc2hhcGVBQUJCLnVwcGVyQm91bmQpOwoKICAgICAgICBpZiAoaSA9PT0gMCkgewogICAgICAgICAgYWFiYi5jb3B5KHNoYXBlQUFCQik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGFhYmIuZXh0ZW5kKHNoYXBlQUFCQik7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmFhYmJOZWVkc1VwZGF0ZSA9IGZhbHNlOwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGUgYC5pbmVydGlhV29ybGRgIGFuZCBgLmludkluZXJ0aWFXb3JsZGAKICAgICAqLwoKCiAgICB1cGRhdGVJbmVydGlhV29ybGQoZm9yY2UpIHsKICAgICAgY29uc3QgSSA9IHRoaXMuaW52SW5lcnRpYTsKCiAgICAgIGlmIChJLnggPT09IEkueSAmJiBJLnkgPT09IEkueiAmJiAhZm9yY2UpIDsgZWxzZSB7CiAgICAgICAgY29uc3QgbTEgPSB1aXdfbTE7CiAgICAgICAgY29uc3QgbTIgPSB1aXdfbTI7CiAgICAgICAgbTEuc2V0Um90YXRpb25Gcm9tUXVhdGVybmlvbih0aGlzLnF1YXRlcm5pb24pOwogICAgICAgIG0xLnRyYW5zcG9zZShtMik7CiAgICAgICAgbTEuc2NhbGUoSSwgbTEpOwogICAgICAgIG0xLm1tdWx0KG0yLCB0aGlzLmludkluZXJ0aWFXb3JsZCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQXBwbHkgZm9yY2UgdG8gYSBwb2ludCBvZiB0aGUgYm9keS4gVGhpcyBjb3VsZCBmb3IgZXhhbXBsZSBiZSBhIHBvaW50IG9uIHRoZSBCb2R5IHN1cmZhY2UuCiAgICAgKiBBcHBseWluZyBmb3JjZSB0aGlzIHdheSB3aWxsIGFkZCB0byBCb2R5LmZvcmNlIGFuZCBCb2R5LnRvcnF1ZS4KICAgICAqIEBwYXJhbSBmb3JjZSBUaGUgYW1vdW50IG9mIGZvcmNlIHRvIGFkZC4KICAgICAqIEBwYXJhbSByZWxhdGl2ZVBvaW50IEEgcG9pbnQgcmVsYXRpdmUgdG8gdGhlIGNlbnRlciBvZiBtYXNzIHRvIGFwcGx5IHRoZSBmb3JjZSBvbi4KICAgICAqLwoKCiAgICBhcHBseUZvcmNlKGZvcmNlLCByZWxhdGl2ZVBvaW50KSB7CiAgICAgIGlmIChyZWxhdGl2ZVBvaW50ID09PSB2b2lkIDApIHsKICAgICAgICByZWxhdGl2ZVBvaW50ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgLy8gTmVlZGVkPwogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpIHsKICAgICAgICB0aGlzLndha2VVcCgpOwogICAgICB9IC8vIENvbXB1dGUgcHJvZHVjZWQgcm90YXRpb25hbCBmb3JjZQoKCiAgICAgIGNvbnN0IHJvdEZvcmNlID0gQm9keV9hcHBseUZvcmNlX3JvdEZvcmNlOwogICAgICByZWxhdGl2ZVBvaW50LmNyb3NzKGZvcmNlLCByb3RGb3JjZSk7IC8vIEFkZCBsaW5lYXIgZm9yY2UKCiAgICAgIHRoaXMuZm9yY2UudmFkZChmb3JjZSwgdGhpcy5mb3JjZSk7IC8vIEFkZCByb3RhdGlvbmFsIGZvcmNlCgogICAgICB0aGlzLnRvcnF1ZS52YWRkKHJvdEZvcmNlLCB0aGlzLnRvcnF1ZSk7CiAgICB9CiAgICAvKioKICAgICAqIEFwcGx5IGZvcmNlIHRvIGEgbG9jYWwgcG9pbnQgaW4gdGhlIGJvZHkuCiAgICAgKiBAcGFyYW0gZm9yY2UgVGhlIGZvcmNlIHZlY3RvciB0byBhcHBseSwgZGVmaW5lZCBsb2NhbGx5IGluIHRoZSBib2R5IGZyYW1lLgogICAgICogQHBhcmFtIGxvY2FsUG9pbnQgQSBsb2NhbCBwb2ludCBpbiB0aGUgYm9keSB0byBhcHBseSB0aGUgZm9yY2Ugb24uCiAgICAgKi8KCgogICAgYXBwbHlMb2NhbEZvcmNlKGxvY2FsRm9yY2UsIGxvY2FsUG9pbnQpIHsKICAgICAgaWYgKGxvY2FsUG9pbnQgPT09IHZvaWQgMCkgewogICAgICAgIGxvY2FsUG9pbnQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IHdvcmxkRm9yY2UgPSBCb2R5X2FwcGx5TG9jYWxGb3JjZV93b3JsZEZvcmNlOwogICAgICBjb25zdCByZWxhdGl2ZVBvaW50V29ybGQgPSBCb2R5X2FwcGx5TG9jYWxGb3JjZV9yZWxhdGl2ZVBvaW50V29ybGQ7IC8vIFRyYW5zZm9ybSB0aGUgZm9yY2UgdmVjdG9yIHRvIHdvcmxkIHNwYWNlCgogICAgICB0aGlzLnZlY3RvclRvV29ybGRGcmFtZShsb2NhbEZvcmNlLCB3b3JsZEZvcmNlKTsKICAgICAgdGhpcy52ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxQb2ludCwgcmVsYXRpdmVQb2ludFdvcmxkKTsKICAgICAgdGhpcy5hcHBseUZvcmNlKHdvcmxkRm9yY2UsIHJlbGF0aXZlUG9pbnRXb3JsZCk7CiAgICB9CiAgICAvKioKICAgICAqIEFwcGx5IHRvcnF1ZSB0byB0aGUgYm9keS4KICAgICAqIEBwYXJhbSB0b3JxdWUgVGhlIGFtb3VudCBvZiB0b3JxdWUgdG8gYWRkLgogICAgICovCgoKICAgIGFwcGx5VG9ycXVlKHRvcnF1ZSkgewogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpIHsKICAgICAgICB0aGlzLndha2VVcCgpOwogICAgICB9IC8vIEFkZCByb3RhdGlvbmFsIGZvcmNlCgoKICAgICAgdGhpcy50b3JxdWUudmFkZCh0b3JxdWUsIHRoaXMudG9ycXVlKTsKICAgIH0KICAgIC8qKgogICAgICogQXBwbHkgaW1wdWxzZSB0byBhIHBvaW50IG9mIHRoZSBib2R5LiBUaGlzIGNvdWxkIGZvciBleGFtcGxlIGJlIGEgcG9pbnQgb24gdGhlIEJvZHkgc3VyZmFjZS4KICAgICAqIEFuIGltcHVsc2UgaXMgYSBmb3JjZSBhZGRlZCB0byBhIGJvZHkgZHVyaW5nIGEgc2hvcnQgcGVyaW9kIG9mIHRpbWUgKGltcHVsc2UgPSBmb3JjZSAqIHRpbWUpLgogICAgICogSW1wdWxzZXMgd2lsbCBiZSBhZGRlZCB0byBCb2R5LnZlbG9jaXR5IGFuZCBCb2R5LmFuZ3VsYXJWZWxvY2l0eS4KICAgICAqIEBwYXJhbSBpbXB1bHNlIFRoZSBhbW91bnQgb2YgaW1wdWxzZSB0byBhZGQuCiAgICAgKiBAcGFyYW0gcmVsYXRpdmVQb2ludCBBIHBvaW50IHJlbGF0aXZlIHRvIHRoZSBjZW50ZXIgb2YgbWFzcyB0byBhcHBseSB0aGUgZm9yY2Ugb24uCiAgICAgKi8KCgogICAgYXBwbHlJbXB1bHNlKGltcHVsc2UsIHJlbGF0aXZlUG9pbnQpIHsKICAgICAgaWYgKHJlbGF0aXZlUG9pbnQgPT09IHZvaWQgMCkgewogICAgICAgIHJlbGF0aXZlUG9pbnQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpIHsKICAgICAgICB0aGlzLndha2VVcCgpOwogICAgICB9IC8vIENvbXB1dGUgcG9pbnQgcG9zaXRpb24gcmVsYXRpdmUgdG8gdGhlIGJvZHkgY2VudGVyCgoKICAgICAgY29uc3QgciA9IHJlbGF0aXZlUG9pbnQ7IC8vIENvbXB1dGUgcHJvZHVjZWQgY2VudHJhbCBpbXB1bHNlIHZlbG9jaXR5CgogICAgICBjb25zdCB2ZWxvID0gQm9keV9hcHBseUltcHVsc2VfdmVsbzsKICAgICAgdmVsby5jb3B5KGltcHVsc2UpOwogICAgICB2ZWxvLnNjYWxlKHRoaXMuaW52TWFzcywgdmVsbyk7IC8vIEFkZCBsaW5lYXIgaW1wdWxzZQoKICAgICAgdGhpcy52ZWxvY2l0eS52YWRkKHZlbG8sIHRoaXMudmVsb2NpdHkpOyAvLyBDb21wdXRlIHByb2R1Y2VkIHJvdGF0aW9uYWwgaW1wdWxzZSB2ZWxvY2l0eQoKICAgICAgY29uc3Qgcm90VmVsbyA9IEJvZHlfYXBwbHlJbXB1bHNlX3JvdFZlbG87CiAgICAgIHIuY3Jvc3MoaW1wdWxzZSwgcm90VmVsbyk7CiAgICAgIC8qCiAgICAgICByb3RWZWxvLnggKj0gdGhpcy5pbnZJbmVydGlhLng7CiAgICAgICByb3RWZWxvLnkgKj0gdGhpcy5pbnZJbmVydGlhLnk7CiAgICAgICByb3RWZWxvLnogKj0gdGhpcy5pbnZJbmVydGlhLno7CiAgICAgICAqLwoKICAgICAgdGhpcy5pbnZJbmVydGlhV29ybGQudm11bHQocm90VmVsbywgcm90VmVsbyk7IC8vIEFkZCByb3RhdGlvbmFsIEltcHVsc2UKCiAgICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5LnZhZGQocm90VmVsbywgdGhpcy5hbmd1bGFyVmVsb2NpdHkpOwogICAgfQogICAgLyoqCiAgICAgKiBBcHBseSBsb2NhbGx5LWRlZmluZWQgaW1wdWxzZSB0byBhIGxvY2FsIHBvaW50IGluIHRoZSBib2R5LgogICAgICogQHBhcmFtIGZvcmNlIFRoZSBmb3JjZSB2ZWN0b3IgdG8gYXBwbHksIGRlZmluZWQgbG9jYWxseSBpbiB0aGUgYm9keSBmcmFtZS4KICAgICAqIEBwYXJhbSBsb2NhbFBvaW50IEEgbG9jYWwgcG9pbnQgaW4gdGhlIGJvZHkgdG8gYXBwbHkgdGhlIGZvcmNlIG9uLgogICAgICovCgoKICAgIGFwcGx5TG9jYWxJbXB1bHNlKGxvY2FsSW1wdWxzZSwgbG9jYWxQb2ludCkgewogICAgICBpZiAobG9jYWxQb2ludCA9PT0gdm9pZCAwKSB7CiAgICAgICAgbG9jYWxQb2ludCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnR5cGUgIT09IEJvZHkuRFlOQU1JQykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3Qgd29ybGRJbXB1bHNlID0gQm9keV9hcHBseUxvY2FsSW1wdWxzZV93b3JsZEltcHVsc2U7CiAgICAgIGNvbnN0IHJlbGF0aXZlUG9pbnRXb3JsZCA9IEJvZHlfYXBwbHlMb2NhbEltcHVsc2VfcmVsYXRpdmVQb2ludDsgLy8gVHJhbnNmb3JtIHRoZSBmb3JjZSB2ZWN0b3IgdG8gd29ybGQgc3BhY2UKCiAgICAgIHRoaXMudmVjdG9yVG9Xb3JsZEZyYW1lKGxvY2FsSW1wdWxzZSwgd29ybGRJbXB1bHNlKTsKICAgICAgdGhpcy52ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxQb2ludCwgcmVsYXRpdmVQb2ludFdvcmxkKTsKICAgICAgdGhpcy5hcHBseUltcHVsc2Uod29ybGRJbXB1bHNlLCByZWxhdGl2ZVBvaW50V29ybGQpOwogICAgfQogICAgLyoqCiAgICAgKiBTaG91bGQgYmUgY2FsbGVkIHdoZW5ldmVyIHlvdSBjaGFuZ2UgdGhlIGJvZHkgc2hhcGUgb3IgbWFzcy4KICAgICAqLwoKCiAgICB1cGRhdGVNYXNzUHJvcGVydGllcygpIHsKICAgICAgY29uc3QgaGFsZkV4dGVudHMgPSBCb2R5X3VwZGF0ZU1hc3NQcm9wZXJ0aWVzX2hhbGZFeHRlbnRzOwogICAgICB0aGlzLmludk1hc3MgPSB0aGlzLm1hc3MgPiAwID8gMS4wIC8gdGhpcy5tYXNzIDogMDsKICAgICAgY29uc3QgSSA9IHRoaXMuaW5lcnRpYTsKICAgICAgY29uc3QgZml4ZWQgPSB0aGlzLmZpeGVkUm90YXRpb247IC8vIEFwcHJveGltYXRlIHdpdGggQUFCQiBib3gKCiAgICAgIHRoaXMudXBkYXRlQUFCQigpOwogICAgICBoYWxmRXh0ZW50cy5zZXQoKHRoaXMuYWFiYi51cHBlckJvdW5kLnggLSB0aGlzLmFhYmIubG93ZXJCb3VuZC54KSAvIDIsICh0aGlzLmFhYmIudXBwZXJCb3VuZC55IC0gdGhpcy5hYWJiLmxvd2VyQm91bmQueSkgLyAyLCAodGhpcy5hYWJiLnVwcGVyQm91bmQueiAtIHRoaXMuYWFiYi5sb3dlckJvdW5kLnopIC8gMik7CiAgICAgIEJveC5jYWxjdWxhdGVJbmVydGlhKGhhbGZFeHRlbnRzLCB0aGlzLm1hc3MsIEkpOwogICAgICB0aGlzLmludkluZXJ0aWEuc2V0KEkueCA+IDAgJiYgIWZpeGVkID8gMS4wIC8gSS54IDogMCwgSS55ID4gMCAmJiAhZml4ZWQgPyAxLjAgLyBJLnkgOiAwLCBJLnogPiAwICYmICFmaXhlZCA/IDEuMCAvIEkueiA6IDApOwogICAgICB0aGlzLnVwZGF0ZUluZXJ0aWFXb3JsZCh0cnVlKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHdvcmxkIHZlbG9jaXR5IG9mIGEgcG9pbnQgaW4gdGhlIGJvZHkuCiAgICAgKiBAcGFyYW0gd29ybGRQb2ludAogICAgICogQHBhcmFtIHJlc3VsdAogICAgICogQHJldHVybiBUaGUgcmVzdWx0IHZlY3Rvci4KICAgICAqLwoKCiAgICBnZXRWZWxvY2l0eUF0V29ybGRQb2ludCh3b3JsZFBvaW50LCByZXN1bHQpIHsKICAgICAgY29uc3QgciA9IG5ldyBWZWMzKCk7CiAgICAgIHdvcmxkUG9pbnQudnN1Yih0aGlzLnBvc2l0aW9uLCByKTsKICAgICAgdGhpcy5hbmd1bGFyVmVsb2NpdHkuY3Jvc3MociwgcmVzdWx0KTsKICAgICAgdGhpcy52ZWxvY2l0eS52YWRkKHJlc3VsdCwgcmVzdWx0KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKgogICAgICogTW92ZSB0aGUgYm9keSBmb3J3YXJkIGluIHRpbWUuCiAgICAgKiBAcGFyYW0gZHQgVGltZSBzdGVwCiAgICAgKiBAcGFyYW0gcXVhdE5vcm1hbGl6ZSBTZXQgdG8gdHJ1ZSB0byBub3JtYWxpemUgdGhlIGJvZHkgcXVhdGVybmlvbgogICAgICogQHBhcmFtIHF1YXROb3JtYWxpemVGYXN0IElmIHRoZSBxdWF0ZXJuaW9uIHNob3VsZCBiZSBub3JtYWxpemVkIHVzaW5nICJmYXN0IiBxdWF0ZXJuaW9uIG5vcm1hbGl6YXRpb24KICAgICAqLwoKCiAgICBpbnRlZ3JhdGUoZHQsIHF1YXROb3JtYWxpemUsIHF1YXROb3JtYWxpemVGYXN0KSB7CiAgICAgIC8vIFNhdmUgcHJldmlvdXMgcG9zaXRpb24KICAgICAgdGhpcy5wcmV2aW91c1Bvc2l0aW9uLmNvcHkodGhpcy5wb3NpdGlvbik7CiAgICAgIHRoaXMucHJldmlvdXNRdWF0ZXJuaW9uLmNvcHkodGhpcy5xdWF0ZXJuaW9uKTsKCiAgICAgIGlmICghKHRoaXMudHlwZSA9PT0gQm9keS5EWU5BTUlDIHx8IHRoaXMudHlwZSA9PT0gQm9keS5LSU5FTUFUSUMpIHx8IHRoaXMuc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORykgewogICAgICAgIC8vIE9ubHkgZm9yIGR5bmFtaWMKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IHZlbG8gPSB0aGlzLnZlbG9jaXR5OwogICAgICBjb25zdCBhbmd1bGFyVmVsbyA9IHRoaXMuYW5ndWxhclZlbG9jaXR5OwogICAgICBjb25zdCBwb3MgPSB0aGlzLnBvc2l0aW9uOwogICAgICBjb25zdCBmb3JjZSA9IHRoaXMuZm9yY2U7CiAgICAgIGNvbnN0IHRvcnF1ZSA9IHRoaXMudG9ycXVlOwogICAgICBjb25zdCBxdWF0ID0gdGhpcy5xdWF0ZXJuaW9uOwogICAgICBjb25zdCBpbnZNYXNzID0gdGhpcy5pbnZNYXNzOwogICAgICBjb25zdCBpbnZJbmVydGlhID0gdGhpcy5pbnZJbmVydGlhV29ybGQ7CiAgICAgIGNvbnN0IGxpbmVhckZhY3RvciA9IHRoaXMubGluZWFyRmFjdG9yOwogICAgICBjb25zdCBpTWR0ID0gaW52TWFzcyAqIGR0OwogICAgICB2ZWxvLnggKz0gZm9yY2UueCAqIGlNZHQgKiBsaW5lYXJGYWN0b3IueDsKICAgICAgdmVsby55ICs9IGZvcmNlLnkgKiBpTWR0ICogbGluZWFyRmFjdG9yLnk7CiAgICAgIHZlbG8ueiArPSBmb3JjZS56ICogaU1kdCAqIGxpbmVhckZhY3Rvci56OwogICAgICBjb25zdCBlID0gaW52SW5lcnRpYS5lbGVtZW50czsKICAgICAgY29uc3QgYW5ndWxhckZhY3RvciA9IHRoaXMuYW5ndWxhckZhY3RvcjsKICAgICAgY29uc3QgdHggPSB0b3JxdWUueCAqIGFuZ3VsYXJGYWN0b3IueDsKICAgICAgY29uc3QgdHkgPSB0b3JxdWUueSAqIGFuZ3VsYXJGYWN0b3IueTsKICAgICAgY29uc3QgdHogPSB0b3JxdWUueiAqIGFuZ3VsYXJGYWN0b3IuejsKICAgICAgYW5ndWxhclZlbG8ueCArPSBkdCAqIChlWzBdICogdHggKyBlWzFdICogdHkgKyBlWzJdICogdHopOwogICAgICBhbmd1bGFyVmVsby55ICs9IGR0ICogKGVbM10gKiB0eCArIGVbNF0gKiB0eSArIGVbNV0gKiB0eik7CiAgICAgIGFuZ3VsYXJWZWxvLnogKz0gZHQgKiAoZVs2XSAqIHR4ICsgZVs3XSAqIHR5ICsgZVs4XSAqIHR6KTsgLy8gVXNlIG5ldyB2ZWxvY2l0eSAgLSBsZWFwIGZyb2cKCiAgICAgIHBvcy54ICs9IHZlbG8ueCAqIGR0OwogICAgICBwb3MueSArPSB2ZWxvLnkgKiBkdDsKICAgICAgcG9zLnogKz0gdmVsby56ICogZHQ7CiAgICAgIHF1YXQuaW50ZWdyYXRlKHRoaXMuYW5ndWxhclZlbG9jaXR5LCBkdCwgdGhpcy5hbmd1bGFyRmFjdG9yLCBxdWF0KTsKCiAgICAgIGlmIChxdWF0Tm9ybWFsaXplKSB7CiAgICAgICAgaWYgKHF1YXROb3JtYWxpemVGYXN0KSB7CiAgICAgICAgICBxdWF0Lm5vcm1hbGl6ZUZhc3QoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcXVhdC5ub3JtYWxpemUoKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuYWFiYk5lZWRzVXBkYXRlID0gdHJ1ZTsgLy8gVXBkYXRlIHdvcmxkIGluZXJ0aWEKCiAgICAgIHRoaXMudXBkYXRlSW5lcnRpYVdvcmxkKCk7CiAgICB9CgogIH0KICBCb2R5LmlkQ291bnRlciA9IDA7CiAgQm9keS5DT0xMSURFX0VWRU5UX05BTUUgPSAnY29sbGlkZSc7CiAgQm9keS5EWU5BTUlDID0gQk9EWV9UWVBFUy5EWU5BTUlDOwogIEJvZHkuU1RBVElDID0gQk9EWV9UWVBFUy5TVEFUSUM7CiAgQm9keS5LSU5FTUFUSUMgPSBCT0RZX1RZUEVTLktJTkVNQVRJQzsKICBCb2R5LkFXQUtFID0gQk9EWV9TTEVFUF9TVEFURVMuQVdBS0U7CiAgQm9keS5TTEVFUFkgPSBCT0RZX1NMRUVQX1NUQVRFUy5TTEVFUFk7CiAgQm9keS5TTEVFUElORyA9IEJPRFlfU0xFRVBfU1RBVEVTLlNMRUVQSU5HOwogIEJvZHkud2FrZXVwRXZlbnQgPSB7CiAgICB0eXBlOiAnd2FrZXVwJwogIH07CiAgQm9keS5zbGVlcHlFdmVudCA9IHsKICAgIHR5cGU6ICdzbGVlcHknCiAgfTsKICBCb2R5LnNsZWVwRXZlbnQgPSB7CiAgICB0eXBlOiAnc2xlZXAnCiAgfTsKICBjb25zdCB0bXBWZWMgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFF1YXQgPSBuZXcgUXVhdGVybmlvbigpOwogIGNvbnN0IHVwZGF0ZUFBQkJfc2hhcGVBQUJCID0gbmV3IEFBQkIoKTsKICBjb25zdCB1aXdfbTEgPSBuZXcgTWF0MygpOwogIGNvbnN0IHVpd19tMiA9IG5ldyBNYXQzKCk7CiAgbmV3IE1hdDMoKTsKICBjb25zdCBCb2R5X2FwcGx5Rm9yY2Vfcm90Rm9yY2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IEJvZHlfYXBwbHlMb2NhbEZvcmNlX3dvcmxkRm9yY2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IEJvZHlfYXBwbHlMb2NhbEZvcmNlX3JlbGF0aXZlUG9pbnRXb3JsZCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV9hcHBseUltcHVsc2VfdmVsbyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV9hcHBseUltcHVsc2Vfcm90VmVsbyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV9hcHBseUxvY2FsSW1wdWxzZV93b3JsZEltcHVsc2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IEJvZHlfYXBwbHlMb2NhbEltcHVsc2VfcmVsYXRpdmVQb2ludCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV91cGRhdGVNYXNzUHJvcGVydGllc19oYWxmRXh0ZW50cyA9IG5ldyBWZWMzKCk7CgogIC8qKgogICAqIEJhc2UgY2xhc3MgZm9yIGJyb2FkcGhhc2UgaW1wbGVtZW50YXRpb25zCiAgICogQGF1dGhvciBzY2h0ZXBwZQogICAqLwogIGNsYXNzIEJyb2FkcGhhc2UgewogICAgLyoqCiAgICAgKiBUaGUgd29ybGQgdG8gc2VhcmNoIGZvciBjb2xsaXNpb25zIGluLgogICAgICovCgogICAgLyoqCiAgICAgKiBJZiBzZXQgdG8gdHJ1ZSwgdGhlIGJyb2FkcGhhc2UgdXNlcyBib3VuZGluZyBib3hlcyBmb3IgaW50ZXJzZWN0aW9uIHRlc3RzLCBlbHNlIGl0IHVzZXMgYm91bmRpbmcgc3BoZXJlcy4KICAgICAqLwoKICAgIC8qKgogICAgICogU2V0IHRvIHRydWUgaWYgdGhlIG9iamVjdHMgaW4gdGhlIHdvcmxkIG1vdmVkLgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICAgIHRoaXMudXNlQm91bmRpbmdCb3hlcyA9IGZhbHNlOwogICAgICB0aGlzLmRpcnR5ID0gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBjb2xsaXNpb24gcGFpcnMgZnJvbSB0aGUgd29ybGQKICAgICAqIEBwYXJhbSB3b3JsZCBUaGUgd29ybGQgdG8gc2VhcmNoIGluCiAgICAgKiBAcGFyYW0gcDEgRW1wdHkgYXJyYXkgdG8gYmUgZmlsbGVkIHdpdGggYm9keSBvYmplY3RzCiAgICAgKiBAcGFyYW0gcDIgRW1wdHkgYXJyYXkgdG8gYmUgZmlsbGVkIHdpdGggYm9keSBvYmplY3RzCiAgICAgKi8KCgogICAgY29sbGlzaW9uUGFpcnMod29ybGQsIHAxLCBwMikgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvbGxpc2lvblBhaXJzIG5vdCBpbXBsZW1lbnRlZCBmb3IgdGhpcyBCcm9hZFBoYXNlIGNsYXNzIScpOwogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiBhIGJvZHkgcGFpciBuZWVkcyB0byBiZSBpbnRlcnNlY3Rpb24gdGVzdGVkIGF0IGFsbC4KICAgICAqLwoKCiAgICBuZWVkQnJvYWRwaGFzZUNvbGxpc2lvbihib2R5QSwgYm9keUIpIHsKICAgICAgLy8gQ2hlY2sgY29sbGlzaW9uIGZpbHRlciBtYXNrcwogICAgICBpZiAoKGJvZHlBLmNvbGxpc2lvbkZpbHRlckdyb3VwICYgYm9keUIuY29sbGlzaW9uRmlsdGVyTWFzaykgPT09IDAgfHwgKGJvZHlCLmNvbGxpc2lvbkZpbHRlckdyb3VwICYgYm9keUEuY29sbGlzaW9uRmlsdGVyTWFzaykgPT09IDApIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gLy8gQ2hlY2sgdHlwZXMKCgogICAgICBpZiAoKChib2R5QS50eXBlICYgQm9keS5TVEFUSUMpICE9PSAwIHx8IGJvZHlBLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpICYmICgoYm9keUIudHlwZSAmIEJvZHkuU1RBVElDKSAhPT0gMCB8fCBib2R5Qi5zbGVlcFN0YXRlID09PSBCb2R5LlNMRUVQSU5HKSkgewogICAgICAgIC8vIEJvdGggYm9kaWVzIGFyZSBzdGF0aWMgb3Igc2xlZXBpbmcuIFNraXAuCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhlIGJvdW5kaW5nIHZvbHVtZXMgb2YgdHdvIGJvZGllcyBpbnRlcnNlY3QuCiAgICAgKi8KCgogICAgaW50ZXJzZWN0aW9uVGVzdChib2R5QSwgYm9keUIsIHBhaXJzMSwgcGFpcnMyKSB7CiAgICAgIGlmICh0aGlzLnVzZUJvdW5kaW5nQm94ZXMpIHsKICAgICAgICB0aGlzLmRvQm91bmRpbmdCb3hCcm9hZHBoYXNlKGJvZHlBLCBib2R5QiwgcGFpcnMxLCBwYWlyczIpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZG9Cb3VuZGluZ1NwaGVyZUJyb2FkcGhhc2UoYm9keUEsIGJvZHlCLCBwYWlyczEsIHBhaXJzMik7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhlIGJvdW5kaW5nIHNwaGVyZXMgb2YgdHdvIGJvZGllcyBhcmUgaW50ZXJzZWN0aW5nLgogICAgICogQHBhcmFtIHBhaXJzMSBib2R5QSBpcyBhcHBlbmRlZCB0byB0aGlzIGFycmF5IGlmIGludGVyc2VjdGlvbgogICAgICogQHBhcmFtIHBhaXJzMiBib2R5QiBpcyBhcHBlbmRlZCB0byB0aGlzIGFycmF5IGlmIGludGVyc2VjdGlvbgogICAgICovCgoKICAgIGRvQm91bmRpbmdTcGhlcmVCcm9hZHBoYXNlKGJvZHlBLCBib2R5QiwgcGFpcnMxLCBwYWlyczIpIHsKICAgICAgY29uc3QgciA9IEJyb2FkcGhhc2VfY29sbGlzaW9uUGFpcnNfcjsKICAgICAgYm9keUIucG9zaXRpb24udnN1Yihib2R5QS5wb3NpdGlvbiwgcik7CiAgICAgIGNvbnN0IGJvdW5kaW5nUmFkaXVzU3VtMiA9IChib2R5QS5ib3VuZGluZ1JhZGl1cyArIGJvZHlCLmJvdW5kaW5nUmFkaXVzKSAqKiAyOwogICAgICBjb25zdCBub3JtMiA9IHIubGVuZ3RoU3F1YXJlZCgpOwoKICAgICAgaWYgKG5vcm0yIDwgYm91bmRpbmdSYWRpdXNTdW0yKSB7CiAgICAgICAgcGFpcnMxLnB1c2goYm9keUEpOwogICAgICAgIHBhaXJzMi5wdXNoKGJvZHlCKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgYm91bmRpbmcgYm94ZXMgb2YgdHdvIGJvZGllcyBhcmUgaW50ZXJzZWN0aW5nLgogICAgICovCgoKICAgIGRvQm91bmRpbmdCb3hCcm9hZHBoYXNlKGJvZHlBLCBib2R5QiwgcGFpcnMxLCBwYWlyczIpIHsKICAgICAgaWYgKGJvZHlBLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgIGJvZHlBLnVwZGF0ZUFBQkIoKTsKICAgICAgfQoKICAgICAgaWYgKGJvZHlCLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgIGJvZHlCLnVwZGF0ZUFBQkIoKTsKICAgICAgfSAvLyBDaGVjayBBQUJCIC8gQUFCQgoKCiAgICAgIGlmIChib2R5QS5hYWJiLm92ZXJsYXBzKGJvZHlCLmFhYmIpKSB7CiAgICAgICAgcGFpcnMxLnB1c2goYm9keUEpOwogICAgICAgIHBhaXJzMi5wdXNoKGJvZHlCKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmVzIGR1cGxpY2F0ZSBwYWlycyBmcm9tIHRoZSBwYWlyIGFycmF5cy4KICAgICAqLwoKCiAgICBtYWtlUGFpcnNVbmlxdWUocGFpcnMxLCBwYWlyczIpIHsKICAgICAgY29uc3QgdCA9IEJyb2FkcGhhc2VfbWFrZVBhaXJzVW5pcXVlX3RlbXA7CiAgICAgIGNvbnN0IHAxID0gQnJvYWRwaGFzZV9tYWtlUGFpcnNVbmlxdWVfcDE7CiAgICAgIGNvbnN0IHAyID0gQnJvYWRwaGFzZV9tYWtlUGFpcnNVbmlxdWVfcDI7CiAgICAgIGNvbnN0IE4gPSBwYWlyczEubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIHAxW2ldID0gcGFpcnMxW2ldOwogICAgICAgIHAyW2ldID0gcGFpcnMyW2ldOwogICAgICB9CgogICAgICBwYWlyczEubGVuZ3RoID0gMDsKICAgICAgcGFpcnMyLmxlbmd0aCA9IDA7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgaWQxID0gcDFbaV0uaWQ7CiAgICAgICAgY29uc3QgaWQyID0gcDJbaV0uaWQ7CiAgICAgICAgY29uc3Qga2V5ID0gaWQxIDwgaWQyID8gYCR7aWQxfSwke2lkMn1gIDogYCR7aWQyfSwke2lkMX1gOwogICAgICAgIHRba2V5XSA9IGk7CiAgICAgICAgdC5rZXlzLnB1c2goa2V5KTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IHQua2V5cy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGtleSA9IHQua2V5cy5wb3AoKTsKICAgICAgICBjb25zdCBwYWlySW5kZXggPSB0W2tleV07CiAgICAgICAgcGFpcnMxLnB1c2gocDFbcGFpckluZGV4XSk7CiAgICAgICAgcGFpcnMyLnB1c2gocDJbcGFpckluZGV4XSk7CiAgICAgICAgZGVsZXRlIHRba2V5XTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBUbyBiZSBpbXBsZW1lbnRlZCBieSBzdWJjYXNzZXMKICAgICAqLwoKCiAgICBzZXRXb3JsZCh3b3JsZCkge30KICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhlIGJvdW5kaW5nIHNwaGVyZXMgb2YgdHdvIGJvZGllcyBvdmVybGFwLgogICAgICovCgoKICAgIHN0YXRpYyBib3VuZGluZ1NwaGVyZUNoZWNrKGJvZHlBLCBib2R5QikgewogICAgICBjb25zdCBkaXN0ID0gbmV3IFZlYzMoKTsgLy8gYnNjX2Rpc3Q7CgogICAgICBib2R5QS5wb3NpdGlvbi52c3ViKGJvZHlCLnBvc2l0aW9uLCBkaXN0KTsKICAgICAgY29uc3Qgc2EgPSBib2R5QS5zaGFwZXNbMF07CiAgICAgIGNvbnN0IHNiID0gYm9keUIuc2hhcGVzWzBdOwogICAgICByZXR1cm4gTWF0aC5wb3coc2EuYm91bmRpbmdTcGhlcmVSYWRpdXMgKyBzYi5ib3VuZGluZ1NwaGVyZVJhZGl1cywgMikgPiBkaXN0Lmxlbmd0aFNxdWFyZWQoKTsKICAgIH0KICAgIC8qKgogICAgICogUmV0dXJucyBhbGwgdGhlIGJvZGllcyB3aXRoaW4gdGhlIEFBQkIuCiAgICAgKi8KCgogICAgYWFiYlF1ZXJ5KHdvcmxkLCBhYWJiLCByZXN1bHQpIHsKICAgICAgY29uc29sZS53YXJuKCcuYWFiYlF1ZXJ5IGlzIG5vdCBpbXBsZW1lbnRlZCBpbiB0aGlzIEJyb2FkcGhhc2Ugc3ViY2xhc3MuJyk7CiAgICAgIHJldHVybiBbXTsKICAgIH0KCiAgfSAvLyBUZW1wIG9iamVjdHMKCiAgY29uc3QgQnJvYWRwaGFzZV9jb2xsaXNpb25QYWlyc19yID0gbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIG5ldyBRdWF0ZXJuaW9uKCk7CiAgbmV3IFZlYzMoKTsKICBjb25zdCBCcm9hZHBoYXNlX21ha2VQYWlyc1VuaXF1ZV90ZW1wID0gewogICAga2V5czogW10KICB9OwogIGNvbnN0IEJyb2FkcGhhc2VfbWFrZVBhaXJzVW5pcXVlX3AxID0gW107CiAgY29uc3QgQnJvYWRwaGFzZV9tYWtlUGFpcnNVbmlxdWVfcDIgPSBbXTsKICBuZXcgVmVjMygpOwogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogTmFpdmUgYnJvYWRwaGFzZSBpbXBsZW1lbnRhdGlvbiwgdXNlZCBpbiBsYWNrIG9mIGJldHRlciBvbmVzLgogICAqCiAgICogVGhlIG5haXZlIGJyb2FkcGhhc2UgbG9va3MgYXQgYWxsIHBvc3NpYmxlIHBhaXJzIHdpdGhvdXQgcmVzdHJpY3Rpb24sIHRoZXJlZm9yZSBpdCBoYXMgY29tcGxleGl0eSBOXjIgXyh3aGljaCBpcyBiYWQpXwogICAqLwogIGNsYXNzIE5haXZlQnJvYWRwaGFzZSBleHRlbmRzIEJyb2FkcGhhc2UgewogICAgLyoqCiAgICAgKiBAdG9kbyBSZW1vdmUgdXNlbGVzcyBjb25zdHJ1Y3RvcgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgc3VwZXIoKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFsbCB0aGUgY29sbGlzaW9uIHBhaXJzIGluIHRoZSBwaHlzaWNzIHdvcmxkCiAgICAgKi8KCgogICAgY29sbGlzaW9uUGFpcnMod29ybGQsIHBhaXJzMSwgcGFpcnMyKSB7CiAgICAgIGNvbnN0IGJvZGllcyA9IHdvcmxkLmJvZGllczsKICAgICAgY29uc3QgbiA9IGJvZGllcy5sZW5ndGg7CiAgICAgIGxldCBiaTsKICAgICAgbGV0IGJqOyAvLyBOYWl2ZSBOXjIgZnR3IQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IG47IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBpOyBqKyspIHsKICAgICAgICAgIGJpID0gYm9kaWVzW2ldOwogICAgICAgICAgYmogPSBib2RpZXNbal07CgogICAgICAgICAgaWYgKCF0aGlzLm5lZWRCcm9hZHBoYXNlQ29sbGlzaW9uKGJpLCBiaikpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5pbnRlcnNlY3Rpb25UZXN0KGJpLCBiaiwgcGFpcnMxLCBwYWlyczIpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFsbCB0aGUgYm9kaWVzIHdpdGhpbiBhbiBBQUJCLgogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSB0byBzdG9yZSByZXN1bHRpbmcgYm9kaWVzIGluLgogICAgICovCgoKICAgIGFhYmJRdWVyeSh3b3JsZCwgYWFiYiwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IFtdOwogICAgICB9CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHdvcmxkLmJvZGllcy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGIgPSB3b3JsZC5ib2RpZXNbaV07CgogICAgICAgIGlmIChiLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgICAgYi51cGRhdGVBQUJCKCk7CiAgICAgICAgfSAvLyBVZ2x5IGhhY2sgdW50aWwgQm9keSBnZXRzIGFhYmIKCgogICAgICAgIGlmIChiLmFhYmIub3ZlcmxhcHMoYWFiYikpIHsKICAgICAgICAgIHJlc3VsdC5wdXNoKGIpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAgfQoKICAvKioKICAgKiBTdG9yYWdlIGZvciBSYXkgY2FzdGluZyBkYXRhCiAgICovCiAgY2xhc3MgUmF5Y2FzdFJlc3VsdCB7CiAgICAvKioKICAgICAqIHJheUZyb21Xb3JsZAogICAgICovCgogICAgLyoqCiAgICAgKiByYXlUb1dvcmxkCiAgICAgKi8KCiAgICAvKioKICAgICAqIGhpdE5vcm1hbFdvcmxkCiAgICAgKi8KCiAgICAvKioKICAgICAqIGhpdFBvaW50V29ybGQKICAgICAqLwoKICAgIC8qKgogICAgICogaGFzSGl0CiAgICAgKi8KCiAgICAvKioKICAgICAqIHNoYXBlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGJvZHkKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGluZGV4IG9mIHRoZSBoaXQgdHJpYW5nbGUsIGlmIHRoZSBoaXQgc2hhcGUgd2FzIGEgdHJpbWVzaAogICAgICovCgogICAgLyoqCiAgICAgKiBEaXN0YW5jZSB0byB0aGUgaGl0LiBXaWxsIGJlIHNldCB0byAtMSBpZiB0aGVyZSB3YXMgbm8gaGl0CiAgICAgKi8KCiAgICAvKioKICAgICAqIElmIHRoZSByYXkgc2hvdWxkIHN0b3AgdHJhdmVyc2luZyB0aGUgYm9kaWVzCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKCkgewogICAgICB0aGlzLnJheUZyb21Xb3JsZCA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMucmF5VG9Xb3JsZCA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuaGl0Tm9ybWFsV29ybGQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmhpdFBvaW50V29ybGQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmhhc0hpdCA9IGZhbHNlOwogICAgICB0aGlzLnNoYXBlID0gbnVsbDsKICAgICAgdGhpcy5ib2R5ID0gbnVsbDsKICAgICAgdGhpcy5oaXRGYWNlSW5kZXggPSAtMTsKICAgICAgdGhpcy5kaXN0YW5jZSA9IC0xOwogICAgICB0aGlzLnNob3VsZFN0b3AgPSBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogUmVzZXQgYWxsIHJlc3VsdCBkYXRhLgogICAgICovCgoKICAgIHJlc2V0KCkgewogICAgICB0aGlzLnJheUZyb21Xb3JsZC5zZXRaZXJvKCk7CiAgICAgIHRoaXMucmF5VG9Xb3JsZC5zZXRaZXJvKCk7CiAgICAgIHRoaXMuaGl0Tm9ybWFsV29ybGQuc2V0WmVybygpOwogICAgICB0aGlzLmhpdFBvaW50V29ybGQuc2V0WmVybygpOwogICAgICB0aGlzLmhhc0hpdCA9IGZhbHNlOwogICAgICB0aGlzLnNoYXBlID0gbnVsbDsKICAgICAgdGhpcy5ib2R5ID0gbnVsbDsKICAgICAgdGhpcy5oaXRGYWNlSW5kZXggPSAtMTsKICAgICAgdGhpcy5kaXN0YW5jZSA9IC0xOwogICAgICB0aGlzLnNob3VsZFN0b3AgPSBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogYWJvcnQKICAgICAqLwoKCiAgICBhYm9ydCgpIHsKICAgICAgdGhpcy5zaG91bGRTdG9wID0gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHJlc3VsdCBkYXRhLgogICAgICovCgoKICAgIHNldChyYXlGcm9tV29ybGQsIHJheVRvV29ybGQsIGhpdE5vcm1hbFdvcmxkLCBoaXRQb2ludFdvcmxkLCBzaGFwZSwgYm9keSwgZGlzdGFuY2UpIHsKICAgICAgdGhpcy5yYXlGcm9tV29ybGQuY29weShyYXlGcm9tV29ybGQpOwogICAgICB0aGlzLnJheVRvV29ybGQuY29weShyYXlUb1dvcmxkKTsKICAgICAgdGhpcy5oaXROb3JtYWxXb3JsZC5jb3B5KGhpdE5vcm1hbFdvcmxkKTsKICAgICAgdGhpcy5oaXRQb2ludFdvcmxkLmNvcHkoaGl0UG9pbnRXb3JsZCk7CiAgICAgIHRoaXMuc2hhcGUgPSBzaGFwZTsKICAgICAgdGhpcy5ib2R5ID0gYm9keTsKICAgICAgdGhpcy5kaXN0YW5jZSA9IGRpc3RhbmNlOwogICAgfQoKICB9CgogIGxldCBfU2hhcGUkdHlwZXMkU1BIRVJFLCBfU2hhcGUkdHlwZXMkUExBTkUsIF9TaGFwZSR0eXBlcyRCT1gsIF9TaGFwZSR0eXBlcyRDWUxJTkRFUiwgX1NoYXBlJHR5cGVzJENPTlZFWFBPLCBfU2hhcGUkdHlwZXMkSEVJR0hURkksIF9TaGFwZSR0eXBlcyRUUklNRVNIOwoKICAvKioKICAgKiBSQVlfTU9ERVMKICAgKi8KICBjb25zdCBSQVlfTU9ERVMgPSB7CiAgICAvKiogQ0xPU0VTVCAqLwogICAgQ0xPU0VTVDogMSwKCiAgICAvKiogQU5ZICovCiAgICBBTlk6IDIsCgogICAgLyoqIEFMTCAqLwogICAgQUxMOiA0CiAgfTsKICAvKioKICAgKiBSYXlNb2RlCiAgICovCgogIF9TaGFwZSR0eXBlcyRTUEhFUkUgPSBTaGFwZS50eXBlcy5TUEhFUkU7CiAgX1NoYXBlJHR5cGVzJFBMQU5FID0gU2hhcGUudHlwZXMuUExBTkU7CiAgX1NoYXBlJHR5cGVzJEJPWCA9IFNoYXBlLnR5cGVzLkJPWDsKICBfU2hhcGUkdHlwZXMkQ1lMSU5ERVIgPSBTaGFwZS50eXBlcy5DWUxJTkRFUjsKICBfU2hhcGUkdHlwZXMkQ09OVkVYUE8gPSBTaGFwZS50eXBlcy5DT05WRVhQT0xZSEVEUk9OOwogIF9TaGFwZSR0eXBlcyRIRUlHSFRGSSA9IFNoYXBlLnR5cGVzLkhFSUdIVEZJRUxEOwogIF9TaGFwZSR0eXBlcyRUUklNRVNIID0gU2hhcGUudHlwZXMuVFJJTUVTSDsKCiAgLyoqCiAgICogQSBsaW5lIGluIDNEIHNwYWNlIHRoYXQgaW50ZXJzZWN0cyBib2RpZXMgYW5kIHJldHVybiBwb2ludHMuCiAgICovCiAgY2xhc3MgUmF5IHsKICAgIC8qKgogICAgICogZnJvbQogICAgICovCgogICAgLyoqCiAgICAgKiB0bwogICAgICovCgogICAgLyoqCiAgICAgKiBkaXJlY3Rpb24KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHByZWNpc2lvbiBvZiB0aGUgcmF5LiBVc2VkIHdoZW4gY2hlY2tpbmcgcGFyYWxsZWxpdHkgZXRjLgogICAgICogQGRlZmF1bHQgMC4wMDAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNldCB0byBgZmFsc2VgIGlmIHlvdSBkb24ndCB3YW50IHRoZSBSYXkgdG8gdGFrZSBgY29sbGlzaW9uUmVzcG9uc2VgIGZsYWdzIGludG8gYWNjb3VudCBvbiBib2RpZXMgYW5kIHNoYXBlcy4KICAgICAqIEBkZWZhdWx0IHRydWUKICAgICAqLwoKICAgIC8qKgogICAgICogSWYgc2V0IHRvIGB0cnVlYCwgdGhlIHJheSBza2lwcyBhbnkgaGl0cyB3aXRoIG5vcm1hbC5kb3QocmF5RGlyZWN0aW9uKSA8IDAuCiAgICAgKiBAZGVmYXVsdCBmYWxzZQogICAgICovCgogICAgLyoqCiAgICAgKiBjb2xsaXNpb25GaWx0ZXJNYXNrCiAgICAgKiBAZGVmYXVsdCAtMQogICAgICovCgogICAgLyoqCiAgICAgKiBjb2xsaXNpb25GaWx0ZXJHcm91cAogICAgICogQGRlZmF1bHQgLTEKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGludGVyc2VjdGlvbiBtb2RlLiBTaG91bGQgYmUgUmF5LkFOWSwgUmF5LkFMTCBvciBSYXkuQ0xPU0VTVC4KICAgICAqIEBkZWZhdWx0IFJBWS5BTlkKICAgICAqLwoKICAgIC8qKgogICAgICogQ3VycmVudCByZXN1bHQgb2JqZWN0LgogICAgICovCgogICAgLyoqCiAgICAgKiBXaWxsIGJlIHNldCB0byBgdHJ1ZWAgZHVyaW5nIGludGVyc2VjdFdvcmxkKCkgaWYgdGhlIHJheSBoaXQgYW55dGhpbmcuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFVzZXItcHJvdmlkZWQgcmVzdWx0IGNhbGxiYWNrLiBXaWxsIGJlIHVzZWQgaWYgbW9kZSBpcyBSYXkuQUxMLgogICAgICovCgogICAgLyoqCiAgICAgKiBDTE9TRVNUCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFOWQogICAgICovCgogICAgLyoqCiAgICAgKiBBTEwKICAgICAqLwogICAgZ2V0IFtfU2hhcGUkdHlwZXMkU1BIRVJFXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdFNwaGVyZTsKICAgIH0KCiAgICBnZXQgW19TaGFwZSR0eXBlcyRQTEFORV0oKSB7CiAgICAgIHJldHVybiB0aGlzLl9pbnRlcnNlY3RQbGFuZTsKICAgIH0KCiAgICBnZXQgW19TaGFwZSR0eXBlcyRCT1hdKCkgewogICAgICByZXR1cm4gdGhpcy5faW50ZXJzZWN0Qm94OwogICAgfQoKICAgIGdldCBbX1NoYXBlJHR5cGVzJENZTElOREVSXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdENvbnZleDsKICAgIH0KCiAgICBnZXQgW19TaGFwZSR0eXBlcyRDT05WRVhQT10oKSB7CiAgICAgIHJldHVybiB0aGlzLl9pbnRlcnNlY3RDb252ZXg7CiAgICB9CgogICAgZ2V0IFtfU2hhcGUkdHlwZXMkSEVJR0hURkldKCkgewogICAgICByZXR1cm4gdGhpcy5faW50ZXJzZWN0SGVpZ2h0ZmllbGQ7CiAgICB9CgogICAgZ2V0IFtfU2hhcGUkdHlwZXMkVFJJTUVTSF0oKSB7CiAgICAgIHJldHVybiB0aGlzLl9pbnRlcnNlY3RUcmltZXNoOwogICAgfQoKICAgIGNvbnN0cnVjdG9yKGZyb20sIHRvKSB7CiAgICAgIGlmIChmcm9tID09PSB2b2lkIDApIHsKICAgICAgICBmcm9tID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgaWYgKHRvID09PSB2b2lkIDApIHsKICAgICAgICB0byA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHRoaXMuZnJvbSA9IGZyb20uY2xvbmUoKTsKICAgICAgdGhpcy50byA9IHRvLmNsb25lKCk7CiAgICAgIHRoaXMuZGlyZWN0aW9uID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5wcmVjaXNpb24gPSAwLjAwMDE7CiAgICAgIHRoaXMuY2hlY2tDb2xsaXNpb25SZXNwb25zZSA9IHRydWU7CiAgICAgIHRoaXMuc2tpcEJhY2tmYWNlcyA9IGZhbHNlOwogICAgICB0aGlzLmNvbGxpc2lvbkZpbHRlck1hc2sgPSAtMTsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJHcm91cCA9IC0xOwogICAgICB0aGlzLm1vZGUgPSBSYXkuQU5ZOwogICAgICB0aGlzLnJlc3VsdCA9IG5ldyBSYXljYXN0UmVzdWx0KCk7CiAgICAgIHRoaXMuaGFzSGl0ID0gZmFsc2U7CgogICAgICB0aGlzLmNhbGxiYWNrID0gcmVzdWx0ID0+IHt9OwogICAgfQogICAgLyoqCiAgICAgKiBEbyBpdGVyc2VjdGlvbiBhZ2FpbnN0IGFsbCBib2RpZXMgaW4gdGhlIGdpdmVuIFdvcmxkLgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSByYXkgaGl0IGFueXRoaW5nLCBvdGhlcndpc2UgZmFsc2UuCiAgICAgKi8KCgogICAgaW50ZXJzZWN0V29ybGQod29ybGQsIG9wdGlvbnMpIHsKICAgICAgdGhpcy5tb2RlID0gb3B0aW9ucy5tb2RlIHx8IFJheS5BTlk7CiAgICAgIHRoaXMucmVzdWx0ID0gb3B0aW9ucy5yZXN1bHQgfHwgbmV3IFJheWNhc3RSZXN1bHQoKTsKICAgICAgdGhpcy5za2lwQmFja2ZhY2VzID0gISFvcHRpb25zLnNraXBCYWNrZmFjZXM7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyTWFzayA9IHR5cGVvZiBvcHRpb25zLmNvbGxpc2lvbkZpbHRlck1hc2sgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJNYXNrIDogLTE7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgPSB0eXBlb2Ygb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJHcm91cCAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwIDogLTE7CiAgICAgIHRoaXMuY2hlY2tDb2xsaXNpb25SZXNwb25zZSA9IHR5cGVvZiBvcHRpb25zLmNoZWNrQ29sbGlzaW9uUmVzcG9uc2UgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5jaGVja0NvbGxpc2lvblJlc3BvbnNlIDogdHJ1ZTsKCiAgICAgIGlmIChvcHRpb25zLmZyb20pIHsKICAgICAgICB0aGlzLmZyb20uY29weShvcHRpb25zLmZyb20pOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy50bykgewogICAgICAgIHRoaXMudG8uY29weShvcHRpb25zLnRvKTsKICAgICAgfQoKICAgICAgdGhpcy5jYWxsYmFjayA9IG9wdGlvbnMuY2FsbGJhY2sgfHwgKCgpID0+IHt9KTsKCiAgICAgIHRoaXMuaGFzSGl0ID0gZmFsc2U7CiAgICAgIHRoaXMucmVzdWx0LnJlc2V0KCk7CiAgICAgIHRoaXMudXBkYXRlRGlyZWN0aW9uKCk7CiAgICAgIHRoaXMuZ2V0QUFCQih0bXBBQUJCJDEpOwogICAgICB0bXBBcnJheS5sZW5ndGggPSAwOwogICAgICB3b3JsZC5icm9hZHBoYXNlLmFhYmJRdWVyeSh3b3JsZCwgdG1wQUFCQiQxLCB0bXBBcnJheSk7CiAgICAgIHRoaXMuaW50ZXJzZWN0Qm9kaWVzKHRtcEFycmF5KTsKICAgICAgcmV0dXJuIHRoaXMuaGFzSGl0OwogICAgfQogICAgLyoqCiAgICAgKiBTaG9vdCBhIHJheSBhdCBhIGJvZHksIGdldCBiYWNrIGluZm9ybWF0aW9uIGFib3V0IHRoZSBoaXQuCiAgICAgKiBAZGVwcmVjYXRlZCBAcGFyYW0gcmVzdWx0IHNldCB0aGUgcmVzdWx0IHByb3BlcnR5IG9mIHRoZSBSYXkgaW5zdGVhZC4KICAgICAqLwoKCiAgICBpbnRlcnNlY3RCb2R5KGJvZHksIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgdGhpcy5yZXN1bHQgPSByZXN1bHQ7CiAgICAgICAgdGhpcy51cGRhdGVEaXJlY3Rpb24oKTsKICAgICAgfQoKICAgICAgY29uc3QgY2hlY2tDb2xsaXNpb25SZXNwb25zZSA9IHRoaXMuY2hlY2tDb2xsaXNpb25SZXNwb25zZTsKCiAgICAgIGlmIChjaGVja0NvbGxpc2lvblJlc3BvbnNlICYmICFib2R5LmNvbGxpc2lvblJlc3BvbnNlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoKHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgJiBib2R5LmNvbGxpc2lvbkZpbHRlck1hc2spID09PSAwIHx8IChib2R5LmNvbGxpc2lvbkZpbHRlckdyb3VwICYgdGhpcy5jb2xsaXNpb25GaWx0ZXJNYXNrKSA9PT0gMCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3QgeGkgPSBpbnRlcnNlY3RCb2R5X3hpOwogICAgICBjb25zdCBxaSA9IGludGVyc2VjdEJvZHlfcWk7CgogICAgICBmb3IgKGxldCBpID0gMCwgTiA9IGJvZHkuc2hhcGVzLmxlbmd0aDsgaSA8IE47IGkrKykgewogICAgICAgIGNvbnN0IHNoYXBlID0gYm9keS5zaGFwZXNbaV07CgogICAgICAgIGlmIChjaGVja0NvbGxpc2lvblJlc3BvbnNlICYmICFzaGFwZS5jb2xsaXNpb25SZXNwb25zZSkgewogICAgICAgICAgY29udGludWU7IC8vIFNraXAKICAgICAgICB9CgogICAgICAgIGJvZHkucXVhdGVybmlvbi5tdWx0KGJvZHkuc2hhcGVPcmllbnRhdGlvbnNbaV0sIHFpKTsKICAgICAgICBib2R5LnF1YXRlcm5pb24udm11bHQoYm9keS5zaGFwZU9mZnNldHNbaV0sIHhpKTsKICAgICAgICB4aS52YWRkKGJvZHkucG9zaXRpb24sIHhpKTsKICAgICAgICB0aGlzLmludGVyc2VjdFNoYXBlKHNoYXBlLCBxaSwgeGksIGJvZHkpOwoKICAgICAgICBpZiAodGhpcy5yZXN1bHQuc2hvdWxkU3RvcCkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFNob290IGEgcmF5IGF0IGFuIGFycmF5IGJvZGllcywgZ2V0IGJhY2sgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGhpdC4KICAgICAqIEBwYXJhbSBib2RpZXMgQW4gYXJyYXkgb2YgQm9keSBvYmplY3RzLgogICAgICogQGRlcHJlY2F0ZWQgQHBhcmFtIHJlc3VsdCBzZXQgdGhlIHJlc3VsdCBwcm9wZXJ0eSBvZiB0aGUgUmF5IGluc3RlYWQuCiAgICAgKgogICAgICovCgoKICAgIGludGVyc2VjdEJvZGllcyhib2RpZXMsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgdGhpcy5yZXN1bHQgPSByZXN1bHQ7CiAgICAgICAgdGhpcy51cGRhdGVEaXJlY3Rpb24oKTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBib2RpZXMubGVuZ3RoOyAhdGhpcy5yZXN1bHQuc2hvdWxkU3RvcCAmJiBpIDwgbDsgaSsrKSB7CiAgICAgICAgdGhpcy5pbnRlcnNlY3RCb2R5KGJvZGllc1tpXSk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyB0aGUgZGlyZWN0aW9uIHZlY3Rvci4KICAgICAqLwoKCiAgICB1cGRhdGVEaXJlY3Rpb24oKSB7CiAgICAgIHRoaXMudG8udnN1Yih0aGlzLmZyb20sIHRoaXMuZGlyZWN0aW9uKTsKICAgICAgdGhpcy5kaXJlY3Rpb24ubm9ybWFsaXplKCk7CiAgICB9CgogICAgaW50ZXJzZWN0U2hhcGUoc2hhcGUsIHF1YXQsIHBvc2l0aW9uLCBib2R5KSB7CiAgICAgIGNvbnN0IGZyb20gPSB0aGlzLmZyb207IC8vIENoZWNraW5nIGJvdW5kaW5nU3BoZXJlCgogICAgICBjb25zdCBkaXN0YW5jZSA9IGRpc3RhbmNlRnJvbUludGVyc2VjdGlvbihmcm9tLCB0aGlzLmRpcmVjdGlvbiwgcG9zaXRpb24pOwoKICAgICAgaWYgKGRpc3RhbmNlID4gc2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IGludGVyc2VjdE1ldGhvZCA9IHRoaXNbc2hhcGUudHlwZV07CgogICAgICBpZiAoaW50ZXJzZWN0TWV0aG9kKSB7CiAgICAgICAgaW50ZXJzZWN0TWV0aG9kLmNhbGwodGhpcywgc2hhcGUsIHF1YXQsIHBvc2l0aW9uLCBib2R5LCBzaGFwZSk7CiAgICAgIH0KICAgIH0KCiAgICBfaW50ZXJzZWN0Qm94KGJveCwgcXVhdCwgcG9zaXRpb24sIGJvZHksIHJlcG9ydGVkU2hhcGUpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdENvbnZleChib3guY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSk7CiAgICB9CgogICAgX2ludGVyc2VjdFBsYW5lKHNoYXBlLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSkgewogICAgICBjb25zdCBmcm9tID0gdGhpcy5mcm9tOwogICAgICBjb25zdCB0byA9IHRoaXMudG87CiAgICAgIGNvbnN0IGRpcmVjdGlvbiA9IHRoaXMuZGlyZWN0aW9uOyAvLyBHZXQgcGxhbmUgbm9ybWFsCgogICAgICBjb25zdCB3b3JsZE5vcm1hbCA9IG5ldyBWZWMzKDAsIDAsIDEpOwogICAgICBxdWF0LnZtdWx0KHdvcmxkTm9ybWFsLCB3b3JsZE5vcm1hbCk7CiAgICAgIGNvbnN0IGxlbiA9IG5ldyBWZWMzKCk7CiAgICAgIGZyb20udnN1Yihwb3NpdGlvbiwgbGVuKTsKICAgICAgY29uc3QgcGxhbmVUb0Zyb20gPSBsZW4uZG90KHdvcmxkTm9ybWFsKTsKICAgICAgdG8udnN1Yihwb3NpdGlvbiwgbGVuKTsKICAgICAgY29uc3QgcGxhbmVUb1RvID0gbGVuLmRvdCh3b3JsZE5vcm1hbCk7CgogICAgICBpZiAocGxhbmVUb0Zyb20gKiBwbGFuZVRvVG8gPiAwKSB7CiAgICAgICAgLy8gImZyb20iIGFuZCAidG8iIGFyZSBvbiB0aGUgc2FtZSBzaWRlIG9mIHRoZSBwbGFuZS4uLiBiYWlsIG91dAogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGZyb20uZGlzdGFuY2VUbyh0bykgPCBwbGFuZVRvRnJvbSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3Qgbl9kb3RfZGlyID0gd29ybGROb3JtYWwuZG90KGRpcmVjdGlvbik7CgogICAgICBpZiAoTWF0aC5hYnMobl9kb3RfZGlyKSA8IHRoaXMucHJlY2lzaW9uKSB7CiAgICAgICAgLy8gTm8gaW50ZXJzZWN0aW9uCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCBwbGFuZVBvaW50VG9Gcm9tID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgZGlyX3NjYWxlZF93aXRoX3QgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBoaXRQb2ludFdvcmxkID0gbmV3IFZlYzMoKTsKICAgICAgZnJvbS52c3ViKHBvc2l0aW9uLCBwbGFuZVBvaW50VG9Gcm9tKTsKICAgICAgY29uc3QgdCA9IC13b3JsZE5vcm1hbC5kb3QocGxhbmVQb2ludFRvRnJvbSkgLyBuX2RvdF9kaXI7CiAgICAgIGRpcmVjdGlvbi5zY2FsZSh0LCBkaXJfc2NhbGVkX3dpdGhfdCk7CiAgICAgIGZyb20udmFkZChkaXJfc2NhbGVkX3dpdGhfdCwgaGl0UG9pbnRXb3JsZCk7CiAgICAgIHRoaXMucmVwb3J0SW50ZXJzZWN0aW9uKHdvcmxkTm9ybWFsLCBoaXRQb2ludFdvcmxkLCByZXBvcnRlZFNoYXBlLCBib2R5LCAtMSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgd29ybGQgQUFCQiBvZiB0aGUgcmF5LgogICAgICovCgoKICAgIGdldEFBQkIoYWFiYikgewogICAgICBjb25zdCB7CiAgICAgICAgbG93ZXJCb3VuZCwKICAgICAgICB1cHBlckJvdW5kCiAgICAgIH0gPSBhYWJiOwogICAgICBjb25zdCB0byA9IHRoaXMudG87CiAgICAgIGNvbnN0IGZyb20gPSB0aGlzLmZyb207CiAgICAgIGxvd2VyQm91bmQueCA9IE1hdGgubWluKHRvLngsIGZyb20ueCk7CiAgICAgIGxvd2VyQm91bmQueSA9IE1hdGgubWluKHRvLnksIGZyb20ueSk7CiAgICAgIGxvd2VyQm91bmQueiA9IE1hdGgubWluKHRvLnosIGZyb20ueik7CiAgICAgIHVwcGVyQm91bmQueCA9IE1hdGgubWF4KHRvLngsIGZyb20ueCk7CiAgICAgIHVwcGVyQm91bmQueSA9IE1hdGgubWF4KHRvLnksIGZyb20ueSk7CiAgICAgIHVwcGVyQm91bmQueiA9IE1hdGgubWF4KHRvLnosIGZyb20ueik7CiAgICB9CgogICAgX2ludGVyc2VjdEhlaWdodGZpZWxkKHNoYXBlLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSkgewogICAgICBzaGFwZS5kYXRhOwogICAgICBzaGFwZS5lbGVtZW50U2l6ZTsgLy8gQ29udmVydCB0aGUgcmF5IHRvIGxvY2FsIGhlaWdodGZpZWxkIGNvb3JkaW5hdGVzCgogICAgICBjb25zdCBsb2NhbFJheSA9IGludGVyc2VjdEhlaWdodGZpZWxkX2xvY2FsUmF5OyAvL25ldyBSYXkodGhpcy5mcm9tLCB0aGlzLnRvKTsKCiAgICAgIGxvY2FsUmF5LmZyb20uY29weSh0aGlzLmZyb20pOwogICAgICBsb2NhbFJheS50by5jb3B5KHRoaXMudG8pOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb0xvY2FsRnJhbWUocG9zaXRpb24sIHF1YXQsIGxvY2FsUmF5LmZyb20sIGxvY2FsUmF5LmZyb20pOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb0xvY2FsRnJhbWUocG9zaXRpb24sIHF1YXQsIGxvY2FsUmF5LnRvLCBsb2NhbFJheS50byk7CiAgICAgIGxvY2FsUmF5LnVwZGF0ZURpcmVjdGlvbigpOyAvLyBHZXQgdGhlIGluZGV4IG9mIHRoZSBkYXRhIHBvaW50cyB0byB0ZXN0IGFnYWluc3QKCiAgICAgIGNvbnN0IGluZGV4ID0gaW50ZXJzZWN0SGVpZ2h0ZmllbGRfaW5kZXg7CiAgICAgIGxldCBpTWluWDsKICAgICAgbGV0IGlNaW5ZOwogICAgICBsZXQgaU1heFg7CiAgICAgIGxldCBpTWF4WTsgLy8gU2V0IHRvIG1heAoKICAgICAgaU1pblggPSBpTWluWSA9IDA7CiAgICAgIGlNYXhYID0gaU1heFkgPSBzaGFwZS5kYXRhLmxlbmd0aCAtIDE7CiAgICAgIGNvbnN0IGFhYmIgPSBuZXcgQUFCQigpOwogICAgICBsb2NhbFJheS5nZXRBQUJCKGFhYmIpOwogICAgICBzaGFwZS5nZXRJbmRleE9mUG9zaXRpb24oYWFiYi5sb3dlckJvdW5kLngsIGFhYmIubG93ZXJCb3VuZC55LCBpbmRleCwgdHJ1ZSk7CiAgICAgIGlNaW5YID0gTWF0aC5tYXgoaU1pblgsIGluZGV4WzBdKTsKICAgICAgaU1pblkgPSBNYXRoLm1heChpTWluWSwgaW5kZXhbMV0pOwogICAgICBzaGFwZS5nZXRJbmRleE9mUG9zaXRpb24oYWFiYi51cHBlckJvdW5kLngsIGFhYmIudXBwZXJCb3VuZC55LCBpbmRleCwgdHJ1ZSk7CiAgICAgIGlNYXhYID0gTWF0aC5taW4oaU1heFgsIGluZGV4WzBdICsgMSk7CiAgICAgIGlNYXhZID0gTWF0aC5taW4oaU1heFksIGluZGV4WzFdICsgMSk7CgogICAgICBmb3IgKGxldCBpID0gaU1pblg7IGkgPCBpTWF4WDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IGlNaW5ZOyBqIDwgaU1heFk7IGorKykgewogICAgICAgICAgaWYgKHRoaXMucmVzdWx0LnNob3VsZFN0b3ApIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIHNoYXBlLmdldEFhYmJBdEluZGV4KGksIGosIGFhYmIpOwoKICAgICAgICAgIGlmICghYWFiYi5vdmVybGFwc1JheShsb2NhbFJheSkpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9IC8vIExvd2VyIHRyaWFuZ2xlCgoKICAgICAgICAgIHNoYXBlLmdldENvbnZleFRyaWFuZ2xlUGlsbGFyKGksIGosIGZhbHNlKTsKICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZShwb3NpdGlvbiwgcXVhdCwgc2hhcGUucGlsbGFyT2Zmc2V0LCB3b3JsZFBpbGxhck9mZnNldCk7CgogICAgICAgICAgdGhpcy5faW50ZXJzZWN0Q29udmV4KHNoYXBlLnBpbGxhckNvbnZleCwgcXVhdCwgd29ybGRQaWxsYXJPZmZzZXQsIGJvZHksIHJlcG9ydGVkU2hhcGUsIGludGVyc2VjdENvbnZleE9wdGlvbnMpOwoKICAgICAgICAgIGlmICh0aGlzLnJlc3VsdC5zaG91bGRTdG9wKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0gLy8gVXBwZXIgdHJpYW5nbGUKCgogICAgICAgICAgc2hhcGUuZ2V0Q29udmV4VHJpYW5nbGVQaWxsYXIoaSwgaiwgdHJ1ZSk7CiAgICAgICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUocG9zaXRpb24sIHF1YXQsIHNoYXBlLnBpbGxhck9mZnNldCwgd29ybGRQaWxsYXJPZmZzZXQpOwoKICAgICAgICAgIHRoaXMuX2ludGVyc2VjdENvbnZleChzaGFwZS5waWxsYXJDb252ZXgsIHF1YXQsIHdvcmxkUGlsbGFyT2Zmc2V0LCBib2R5LCByZXBvcnRlZFNoYXBlLCBpbnRlcnNlY3RDb252ZXhPcHRpb25zKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBfaW50ZXJzZWN0U3BoZXJlKHNwaGVyZSwgcXVhdCwgcG9zaXRpb24sIGJvZHksIHJlcG9ydGVkU2hhcGUpIHsKICAgICAgY29uc3QgZnJvbSA9IHRoaXMuZnJvbTsKICAgICAgY29uc3QgdG8gPSB0aGlzLnRvOwogICAgICBjb25zdCByID0gc3BoZXJlLnJhZGl1czsKICAgICAgY29uc3QgYSA9ICh0by54IC0gZnJvbS54KSAqKiAyICsgKHRvLnkgLSBmcm9tLnkpICoqIDIgKyAodG8ueiAtIGZyb20ueikgKiogMjsKICAgICAgY29uc3QgYiA9IDIgKiAoKHRvLnggLSBmcm9tLngpICogKGZyb20ueCAtIHBvc2l0aW9uLngpICsgKHRvLnkgLSBmcm9tLnkpICogKGZyb20ueSAtIHBvc2l0aW9uLnkpICsgKHRvLnogLSBmcm9tLnopICogKGZyb20ueiAtIHBvc2l0aW9uLnopKTsKICAgICAgY29uc3QgYyA9IChmcm9tLnggLSBwb3NpdGlvbi54KSAqKiAyICsgKGZyb20ueSAtIHBvc2l0aW9uLnkpICoqIDIgKyAoZnJvbS56IC0gcG9zaXRpb24ueikgKiogMiAtIHIgKiogMjsKICAgICAgY29uc3QgZGVsdGEgPSBiICoqIDIgLSA0ICogYSAqIGM7CiAgICAgIGNvbnN0IGludGVyc2VjdGlvblBvaW50ID0gUmF5X2ludGVyc2VjdFNwaGVyZV9pbnRlcnNlY3Rpb25Qb2ludDsKICAgICAgY29uc3Qgbm9ybWFsID0gUmF5X2ludGVyc2VjdFNwaGVyZV9ub3JtYWw7CgogICAgICBpZiAoZGVsdGEgPCAwKSB7CiAgICAgICAgLy8gTm8gaW50ZXJzZWN0aW9uCiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKGRlbHRhID09PSAwKSB7CiAgICAgICAgLy8gc2luZ2xlIGludGVyc2VjdGlvbiBwb2ludAogICAgICAgIGZyb20ubGVycCh0bywgZGVsdGEsIGludGVyc2VjdGlvblBvaW50KTsKICAgICAgICBpbnRlcnNlY3Rpb25Qb2ludC52c3ViKHBvc2l0aW9uLCBub3JtYWwpOwogICAgICAgIG5vcm1hbC5ub3JtYWxpemUoKTsKICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGludGVyc2VjdGlvblBvaW50LCByZXBvcnRlZFNoYXBlLCBib2R5LCAtMSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgZDEgPSAoLWIgLSBNYXRoLnNxcnQoZGVsdGEpKSAvICgyICogYSk7CiAgICAgICAgY29uc3QgZDIgPSAoLWIgKyBNYXRoLnNxcnQoZGVsdGEpKSAvICgyICogYSk7CgogICAgICAgIGlmIChkMSA+PSAwICYmIGQxIDw9IDEpIHsKICAgICAgICAgIGZyb20ubGVycCh0bywgZDEsIGludGVyc2VjdGlvblBvaW50KTsKICAgICAgICAgIGludGVyc2VjdGlvblBvaW50LnZzdWIocG9zaXRpb24sIG5vcm1hbCk7CiAgICAgICAgICBub3JtYWwubm9ybWFsaXplKCk7CiAgICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGludGVyc2VjdGlvblBvaW50LCByZXBvcnRlZFNoYXBlLCBib2R5LCAtMSk7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5yZXN1bHQuc2hvdWxkU3RvcCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKGQyID49IDAgJiYgZDIgPD0gMSkgewogICAgICAgICAgZnJvbS5sZXJwKHRvLCBkMiwgaW50ZXJzZWN0aW9uUG9pbnQpOwogICAgICAgICAgaW50ZXJzZWN0aW9uUG9pbnQudnN1Yihwb3NpdGlvbiwgbm9ybWFsKTsKICAgICAgICAgIG5vcm1hbC5ub3JtYWxpemUoKTsKICAgICAgICAgIHRoaXMucmVwb3J0SW50ZXJzZWN0aW9uKG5vcm1hbCwgaW50ZXJzZWN0aW9uUG9pbnQsIHJlcG9ydGVkU2hhcGUsIGJvZHksIC0xKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBfaW50ZXJzZWN0Q29udmV4KHNoYXBlLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSwgb3B0aW9ucykgewogICAgICBjb25zdCBub3JtYWwgPSBpbnRlcnNlY3RDb252ZXhfbm9ybWFsOwogICAgICBjb25zdCB2ZWN0b3IgPSBpbnRlcnNlY3RDb252ZXhfdmVjdG9yOwogICAgICBjb25zdCBmYWNlTGlzdCA9IG9wdGlvbnMgJiYgb3B0aW9ucy5mYWNlTGlzdCB8fCBudWxsOyAvLyBDaGVja2luZyBmYWNlcwoKICAgICAgY29uc3QgZmFjZXMgPSBzaGFwZS5mYWNlczsKICAgICAgY29uc3QgdmVydGljZXMgPSBzaGFwZS52ZXJ0aWNlczsKICAgICAgY29uc3Qgbm9ybWFscyA9IHNoYXBlLmZhY2VOb3JtYWxzOwogICAgICBjb25zdCBkaXJlY3Rpb24gPSB0aGlzLmRpcmVjdGlvbjsKICAgICAgY29uc3QgZnJvbSA9IHRoaXMuZnJvbTsKICAgICAgY29uc3QgdG8gPSB0aGlzLnRvOwogICAgICBjb25zdCBmcm9tVG9EaXN0YW5jZSA9IGZyb20uZGlzdGFuY2VUbyh0byk7CiAgICAgIGNvbnN0IE5mYWNlcyA9IGZhY2VMaXN0ID8gZmFjZUxpc3QubGVuZ3RoIDogZmFjZXMubGVuZ3RoOwogICAgICBjb25zdCByZXN1bHQgPSB0aGlzLnJlc3VsdDsKCiAgICAgIGZvciAobGV0IGogPSAwOyAhcmVzdWx0LnNob3VsZFN0b3AgJiYgaiA8IE5mYWNlczsgaisrKSB7CiAgICAgICAgY29uc3QgZmkgPSBmYWNlTGlzdCA/IGZhY2VMaXN0W2pdIDogajsKICAgICAgICBjb25zdCBmYWNlID0gZmFjZXNbZmldOwogICAgICAgIGNvbnN0IGZhY2VOb3JtYWwgPSBub3JtYWxzW2ZpXTsKICAgICAgICBjb25zdCBxID0gcXVhdDsKICAgICAgICBjb25zdCB4ID0gcG9zaXRpb247IC8vIGRldGVybWluZSBpZiByYXkgaW50ZXJzZWN0cyB0aGUgcGxhbmUgb2YgdGhlIGZhY2UKICAgICAgICAvLyBub3RlOiB0aGlzIHdvcmtzIHJlZ2FyZGxlc3Mgb2YgdGhlIGRpcmVjdGlvbiBvZiB0aGUgZmFjZSBub3JtYWwKICAgICAgICAvLyBHZXQgcGxhbmUgcG9pbnQgaW4gd29ybGQgY29vcmRpbmF0ZXMuLi4KCiAgICAgICAgdmVjdG9yLmNvcHkodmVydGljZXNbZmFjZVswXV0pOwogICAgICAgIHEudm11bHQodmVjdG9yLCB2ZWN0b3IpOwogICAgICAgIHZlY3Rvci52YWRkKHgsIHZlY3Rvcik7IC8vIC4uLmJ1dCBtYWtlIGl0IHJlbGF0aXZlIHRvIHRoZSByYXkgZnJvbS4gV2UnbGwgZml4IHRoaXMgbGF0ZXIuCgogICAgICAgIHZlY3Rvci52c3ViKGZyb20sIHZlY3Rvcik7IC8vIEdldCBwbGFuZSBub3JtYWwKCiAgICAgICAgcS52bXVsdChmYWNlTm9ybWFsLCBub3JtYWwpOyAvLyBJZiB0aGlzIGRvdCBwcm9kdWN0IGlzIG5lZ2F0aXZlLCB3ZSBoYXZlIHNvbWV0aGluZyBpbnRlcmVzdGluZwoKICAgICAgICBjb25zdCBkb3QgPSBkaXJlY3Rpb24uZG90KG5vcm1hbCk7IC8vIEJhaWwgb3V0IGlmIHJheSBhbmQgcGxhbmUgYXJlIHBhcmFsbGVsCgogICAgICAgIGlmIChNYXRoLmFicyhkb3QpIDwgdGhpcy5wcmVjaXNpb24pIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0gLy8gY2FsYyBkaXN0YW5jZSB0byBwbGFuZQoKCiAgICAgICAgY29uc3Qgc2NhbGFyID0gbm9ybWFsLmRvdCh2ZWN0b3IpIC8gZG90OyAvLyBpZiBuZWdhdGl2ZSBkaXN0YW5jZSwgdGhlbiBwbGFuZSBpcyBiZWhpbmQgcmF5CgogICAgICAgIGlmIChzY2FsYXIgPCAwKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9IC8vIGlmIChkb3QgPCAwKSB7CiAgICAgICAgLy8gSW50ZXJzZWN0aW9uIHBvaW50IGlzIGZyb20gKyBkaXJlY3Rpb24gKiBzY2FsYXIKCgogICAgICAgIGRpcmVjdGlvbi5zY2FsZShzY2FsYXIsIGludGVyc2VjdFBvaW50KTsKICAgICAgICBpbnRlcnNlY3RQb2ludC52YWRkKGZyb20sIGludGVyc2VjdFBvaW50KTsgLy8gYSBpcyB0aGUgcG9pbnQgd2UgY29tcGFyZSBwb2ludHMgYiBhbmQgYyB3aXRoLgoKICAgICAgICBhLmNvcHkodmVydGljZXNbZmFjZVswXV0pOwogICAgICAgIHEudm11bHQoYSwgYSk7CiAgICAgICAgeC52YWRkKGEsIGEpOwoKICAgICAgICBmb3IgKGxldCBpID0gMTsgIXJlc3VsdC5zaG91bGRTdG9wICYmIGkgPCBmYWNlLmxlbmd0aCAtIDE7IGkrKykgewogICAgICAgICAgLy8gVHJhbnNmb3JtIDMgdmVydGljZXMgdG8gd29ybGQgY29vcmRzCiAgICAgICAgICBiLmNvcHkodmVydGljZXNbZmFjZVtpXV0pOwogICAgICAgICAgYy5jb3B5KHZlcnRpY2VzW2ZhY2VbaSArIDFdXSk7CiAgICAgICAgICBxLnZtdWx0KGIsIGIpOwogICAgICAgICAgcS52bXVsdChjLCBjKTsKICAgICAgICAgIHgudmFkZChiLCBiKTsKICAgICAgICAgIHgudmFkZChjLCBjKTsKICAgICAgICAgIGNvbnN0IGRpc3RhbmNlID0gaW50ZXJzZWN0UG9pbnQuZGlzdGFuY2VUbyhmcm9tKTsKCiAgICAgICAgICBpZiAoIShSYXkucG9pbnRJblRyaWFuZ2xlKGludGVyc2VjdFBvaW50LCBhLCBiLCBjKSB8fCBSYXkucG9pbnRJblRyaWFuZ2xlKGludGVyc2VjdFBvaW50LCBiLCBhLCBjKSkgfHwgZGlzdGFuY2UgPiBmcm9tVG9EaXN0YW5jZSkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGludGVyc2VjdFBvaW50LCByZXBvcnRlZFNoYXBlLCBib2R5LCBmaSk7CiAgICAgICAgfSAvLyB9CgogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEB0b2RvIE9wdGltaXplIGJ5IHRyYW5zZm9ybWluZyB0aGUgd29ybGQgdG8gbG9jYWwgc3BhY2UgZmlyc3QuCiAgICAgKiBAdG9kbyBVc2UgT2N0cmVlIGxvb2t1cAogICAgICovCgoKICAgIF9pbnRlcnNlY3RUcmltZXNoKG1lc2gsIHF1YXQsIHBvc2l0aW9uLCBib2R5LCByZXBvcnRlZFNoYXBlLCBvcHRpb25zKSB7CiAgICAgIGNvbnN0IG5vcm1hbCA9IGludGVyc2VjdFRyaW1lc2hfbm9ybWFsOwogICAgICBjb25zdCB0cmlhbmdsZXMgPSBpbnRlcnNlY3RUcmltZXNoX3RyaWFuZ2xlczsKICAgICAgY29uc3QgdHJlZVRyYW5zZm9ybSA9IGludGVyc2VjdFRyaW1lc2hfdHJlZVRyYW5zZm9ybTsKICAgICAgY29uc3QgdmVjdG9yID0gaW50ZXJzZWN0Q29udmV4X3ZlY3RvcjsKICAgICAgY29uc3QgbG9jYWxEaXJlY3Rpb24gPSBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRGlyZWN0aW9uOwogICAgICBjb25zdCBsb2NhbEZyb20gPSBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRnJvbTsKICAgICAgY29uc3QgbG9jYWxUbyA9IGludGVyc2VjdFRyaW1lc2hfbG9jYWxUbzsKICAgICAgY29uc3Qgd29ybGRJbnRlcnNlY3RQb2ludCA9IGludGVyc2VjdFRyaW1lc2hfd29ybGRJbnRlcnNlY3RQb2ludDsKICAgICAgY29uc3Qgd29ybGROb3JtYWwgPSBpbnRlcnNlY3RUcmltZXNoX3dvcmxkTm9ybWFsOyAvLyBDaGVja2luZyBmYWNlcwoKICAgICAgY29uc3QgaW5kaWNlcyA9IG1lc2guaW5kaWNlczsKICAgICAgbWVzaC52ZXJ0aWNlczsgLy8gY29uc3Qgbm9ybWFscyA9IG1lc2guZmFjZU5vcm1hbHMKCiAgICAgIGNvbnN0IGZyb20gPSB0aGlzLmZyb207CiAgICAgIGNvbnN0IHRvID0gdGhpcy50bzsKICAgICAgY29uc3QgZGlyZWN0aW9uID0gdGhpcy5kaXJlY3Rpb247CiAgICAgIHRyZWVUcmFuc2Zvcm0ucG9zaXRpb24uY29weShwb3NpdGlvbik7CiAgICAgIHRyZWVUcmFuc2Zvcm0ucXVhdGVybmlvbi5jb3B5KHF1YXQpOyAvLyBUcmFuc2Zvcm0gcmF5IHRvIGxvY2FsIHNwYWNlIQoKICAgICAgVHJhbnNmb3JtLnZlY3RvclRvTG9jYWxGcmFtZShwb3NpdGlvbiwgcXVhdCwgZGlyZWN0aW9uLCBsb2NhbERpcmVjdGlvbik7CiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZShwb3NpdGlvbiwgcXVhdCwgZnJvbSwgbG9jYWxGcm9tKTsKICAgICAgVHJhbnNmb3JtLnBvaW50VG9Mb2NhbEZyYW1lKHBvc2l0aW9uLCBxdWF0LCB0bywgbG9jYWxUbyk7CiAgICAgIGxvY2FsVG8ueCAqPSBtZXNoLnNjYWxlLng7CiAgICAgIGxvY2FsVG8ueSAqPSBtZXNoLnNjYWxlLnk7CiAgICAgIGxvY2FsVG8ueiAqPSBtZXNoLnNjYWxlLno7CiAgICAgIGxvY2FsRnJvbS54ICo9IG1lc2guc2NhbGUueDsKICAgICAgbG9jYWxGcm9tLnkgKj0gbWVzaC5zY2FsZS55OwogICAgICBsb2NhbEZyb20ueiAqPSBtZXNoLnNjYWxlLno7CiAgICAgIGxvY2FsVG8udnN1Yihsb2NhbEZyb20sIGxvY2FsRGlyZWN0aW9uKTsKICAgICAgbG9jYWxEaXJlY3Rpb24ubm9ybWFsaXplKCk7CiAgICAgIGNvbnN0IGZyb21Ub0Rpc3RhbmNlU3F1YXJlZCA9IGxvY2FsRnJvbS5kaXN0YW5jZVNxdWFyZWQobG9jYWxUbyk7CiAgICAgIG1lc2gudHJlZS5yYXlRdWVyeSh0aGlzLCB0cmVlVHJhbnNmb3JtLCB0cmlhbmdsZXMpOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIE4gPSB0cmlhbmdsZXMubGVuZ3RoOyAhdGhpcy5yZXN1bHQuc2hvdWxkU3RvcCAmJiBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCB0cmlhbmdsZXNJbmRleCA9IHRyaWFuZ2xlc1tpXTsKICAgICAgICBtZXNoLmdldE5vcm1hbCh0cmlhbmdsZXNJbmRleCwgbm9ybWFsKTsgLy8gZGV0ZXJtaW5lIGlmIHJheSBpbnRlcnNlY3RzIHRoZSBwbGFuZSBvZiB0aGUgZmFjZQogICAgICAgIC8vIG5vdGU6IHRoaXMgd29ya3MgcmVnYXJkbGVzcyBvZiB0aGUgZGlyZWN0aW9uIG9mIHRoZSBmYWNlIG5vcm1hbAogICAgICAgIC8vIEdldCBwbGFuZSBwb2ludCBpbiB3b3JsZCBjb29yZGluYXRlcy4uLgoKICAgICAgICBtZXNoLmdldFZlcnRleChpbmRpY2VzW3RyaWFuZ2xlc0luZGV4ICogM10sIGEpOyAvLyAuLi5idXQgbWFrZSBpdCByZWxhdGl2ZSB0byB0aGUgcmF5IGZyb20uIFdlJ2xsIGZpeCB0aGlzIGxhdGVyLgoKICAgICAgICBhLnZzdWIobG9jYWxGcm9tLCB2ZWN0b3IpOyAvLyBJZiB0aGlzIGRvdCBwcm9kdWN0IGlzIG5lZ2F0aXZlLCB3ZSBoYXZlIHNvbWV0aGluZyBpbnRlcmVzdGluZwoKICAgICAgICBjb25zdCBkb3QgPSBsb2NhbERpcmVjdGlvbi5kb3Qobm9ybWFsKTsgLy8gQmFpbCBvdXQgaWYgcmF5IGFuZCBwbGFuZSBhcmUgcGFyYWxsZWwKICAgICAgICAvLyBpZiAoTWF0aC5hYnMoIGRvdCApIDwgdGhpcy5wcmVjaXNpb24pewogICAgICAgIC8vICAgICBjb250aW51ZTsKICAgICAgICAvLyB9CiAgICAgICAgLy8gY2FsYyBkaXN0YW5jZSB0byBwbGFuZQoKICAgICAgICBjb25zdCBzY2FsYXIgPSBub3JtYWwuZG90KHZlY3RvcikgLyBkb3Q7IC8vIGlmIG5lZ2F0aXZlIGRpc3RhbmNlLCB0aGVuIHBsYW5lIGlzIGJlaGluZCByYXkKCiAgICAgICAgaWYgKHNjYWxhciA8IDApIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0gLy8gSW50ZXJzZWN0aW9uIHBvaW50IGlzIGZyb20gKyBkaXJlY3Rpb24gKiBzY2FsYXIKCgogICAgICAgIGxvY2FsRGlyZWN0aW9uLnNjYWxlKHNjYWxhciwgaW50ZXJzZWN0UG9pbnQpOwogICAgICAgIGludGVyc2VjdFBvaW50LnZhZGQobG9jYWxGcm9tLCBpbnRlcnNlY3RQb2ludCk7IC8vIEdldCB0cmlhbmdsZSB2ZXJ0aWNlcwoKICAgICAgICBtZXNoLmdldFZlcnRleChpbmRpY2VzW3RyaWFuZ2xlc0luZGV4ICogMyArIDFdLCBiKTsKICAgICAgICBtZXNoLmdldFZlcnRleChpbmRpY2VzW3RyaWFuZ2xlc0luZGV4ICogMyArIDJdLCBjKTsKICAgICAgICBjb25zdCBzcXVhcmVkRGlzdGFuY2UgPSBpbnRlcnNlY3RQb2ludC5kaXN0YW5jZVNxdWFyZWQobG9jYWxGcm9tKTsKCiAgICAgICAgaWYgKCEoUmF5LnBvaW50SW5UcmlhbmdsZShpbnRlcnNlY3RQb2ludCwgYiwgYSwgYykgfHwgUmF5LnBvaW50SW5UcmlhbmdsZShpbnRlcnNlY3RQb2ludCwgYSwgYiwgYykpIHx8IHNxdWFyZWREaXN0YW5jZSA+IGZyb21Ub0Rpc3RhbmNlU3F1YXJlZCkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfSAvLyB0cmFuc2Zvcm0gaW50ZXJzZWN0cG9pbnQgYW5kIG5vcm1hbCB0byB3b3JsZAoKCiAgICAgICAgVHJhbnNmb3JtLnZlY3RvclRvV29ybGRGcmFtZShxdWF0LCBub3JtYWwsIHdvcmxkTm9ybWFsKTsKICAgICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUocG9zaXRpb24sIHF1YXQsIGludGVyc2VjdFBvaW50LCB3b3JsZEludGVyc2VjdFBvaW50KTsKICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbih3b3JsZE5vcm1hbCwgd29ybGRJbnRlcnNlY3RQb2ludCwgcmVwb3J0ZWRTaGFwZSwgYm9keSwgdHJpYW5nbGVzSW5kZXgpOwogICAgICB9CgogICAgICB0cmlhbmdsZXMubGVuZ3RoID0gMDsKICAgIH0KICAgIC8qKgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSBpbnRlcnNlY3Rpb25zIHNob3VsZCBjb250aW51ZQogICAgICovCgoKICAgIHJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGhpdFBvaW50V29ybGQsIHNoYXBlLCBib2R5LCBoaXRGYWNlSW5kZXgpIHsKICAgICAgY29uc3QgZnJvbSA9IHRoaXMuZnJvbTsKICAgICAgY29uc3QgdG8gPSB0aGlzLnRvOwogICAgICBjb25zdCBkaXN0YW5jZSA9IGZyb20uZGlzdGFuY2VUbyhoaXRQb2ludFdvcmxkKTsKICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5yZXN1bHQ7IC8vIFNraXAgYmFjayBmYWNlcz8KCiAgICAgIGlmICh0aGlzLnNraXBCYWNrZmFjZXMgJiYgbm9ybWFsLmRvdCh0aGlzLmRpcmVjdGlvbikgPiAwKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICByZXN1bHQuaGl0RmFjZUluZGV4ID0gdHlwZW9mIGhpdEZhY2VJbmRleCAhPT0gJ3VuZGVmaW5lZCcgPyBoaXRGYWNlSW5kZXggOiAtMTsKCiAgICAgIHN3aXRjaCAodGhpcy5tb2RlKSB7CiAgICAgICAgY2FzZSBSYXkuQUxMOgogICAgICAgICAgdGhpcy5oYXNIaXQgPSB0cnVlOwogICAgICAgICAgcmVzdWx0LnNldChmcm9tLCB0bywgbm9ybWFsLCBoaXRQb2ludFdvcmxkLCBzaGFwZSwgYm9keSwgZGlzdGFuY2UpOwogICAgICAgICAgcmVzdWx0Lmhhc0hpdCA9IHRydWU7CiAgICAgICAgICB0aGlzLmNhbGxiYWNrKHJlc3VsdCk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBSYXkuQ0xPU0VTVDoKICAgICAgICAgIC8vIFN0b3JlIGlmIGNsb3NlciB0aGFuIGN1cnJlbnQgY2xvc2VzdAogICAgICAgICAgaWYgKGRpc3RhbmNlIDwgcmVzdWx0LmRpc3RhbmNlIHx8ICFyZXN1bHQuaGFzSGl0KSB7CiAgICAgICAgICAgIHRoaXMuaGFzSGl0ID0gdHJ1ZTsKICAgICAgICAgICAgcmVzdWx0Lmhhc0hpdCA9IHRydWU7CiAgICAgICAgICAgIHJlc3VsdC5zZXQoZnJvbSwgdG8sIG5vcm1hbCwgaGl0UG9pbnRXb3JsZCwgc2hhcGUsIGJvZHksIGRpc3RhbmNlKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBSYXkuQU5ZOgogICAgICAgICAgLy8gUmVwb3J0IGFuZCBzdG9wLgogICAgICAgICAgdGhpcy5oYXNIaXQgPSB0cnVlOwogICAgICAgICAgcmVzdWx0Lmhhc0hpdCA9IHRydWU7CiAgICAgICAgICByZXN1bHQuc2V0KGZyb20sIHRvLCBub3JtYWwsIGhpdFBvaW50V29ybGQsIHNoYXBlLCBib2R5LCBkaXN0YW5jZSk7CiAgICAgICAgICByZXN1bHQuc2hvdWxkU3RvcCA9IHRydWU7CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBBcyBwZXIgIkJhcnljZW50cmljIFRlY2huaXF1ZSIgYXMgbmFtZWQKICAgICAqIHtAbGluayBodHRwczovL3d3dy5ibGFja3Bhd24uY29tL3RleHRzL3BvaW50aW5wb2x5L2RlZmF1bHQuaHRtbCBoZXJlfSBidXQgd2l0aG91dCB0aGUgZGl2aXNpb24KICAgICAqLwoKCiAgICBzdGF0aWMgcG9pbnRJblRyaWFuZ2xlKHAsIGEsIGIsIGMpIHsKICAgICAgYy52c3ViKGEsIHYwKTsKICAgICAgYi52c3ViKGEsIHYxKTsKICAgICAgcC52c3ViKGEsIHYyKTsKICAgICAgY29uc3QgZG90MDAgPSB2MC5kb3QodjApOwogICAgICBjb25zdCBkb3QwMSA9IHYwLmRvdCh2MSk7CiAgICAgIGNvbnN0IGRvdDAyID0gdjAuZG90KHYyKTsKICAgICAgY29uc3QgZG90MTEgPSB2MS5kb3QodjEpOwogICAgICBjb25zdCBkb3QxMiA9IHYxLmRvdCh2Mik7CiAgICAgIGxldCB1OwogICAgICBsZXQgdjsKICAgICAgcmV0dXJuICh1ID0gZG90MTEgKiBkb3QwMiAtIGRvdDAxICogZG90MTIpID49IDAgJiYgKHYgPSBkb3QwMCAqIGRvdDEyIC0gZG90MDEgKiBkb3QwMikgPj0gMCAmJiB1ICsgdiA8IGRvdDAwICogZG90MTEgLSBkb3QwMSAqIGRvdDAxOwogICAgfQoKICB9CiAgUmF5LkNMT1NFU1QgPSBSQVlfTU9ERVMuQ0xPU0VTVDsKICBSYXkuQU5ZID0gUkFZX01PREVTLkFOWTsKICBSYXkuQUxMID0gUkFZX01PREVTLkFMTDsKICBjb25zdCB0bXBBQUJCJDEgPSBuZXcgQUFCQigpOwogIGNvbnN0IHRtcEFycmF5ID0gW107CiAgY29uc3QgdjEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHYyID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RCb2R5X3hpID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RCb2R5X3FpID0gbmV3IFF1YXRlcm5pb24oKTsKICBjb25zdCBpbnRlcnNlY3RQb2ludCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYyA9IG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgUmF5Y2FzdFJlc3VsdCgpOwogIGNvbnN0IGludGVyc2VjdENvbnZleE9wdGlvbnMgPSB7CiAgICBmYWNlTGlzdDogWzBdCiAgfTsKICBjb25zdCB3b3JsZFBpbGxhck9mZnNldCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0SGVpZ2h0ZmllbGRfbG9jYWxSYXkgPSBuZXcgUmF5KCk7CiAgY29uc3QgaW50ZXJzZWN0SGVpZ2h0ZmllbGRfaW5kZXggPSBbXTsKICBjb25zdCBSYXlfaW50ZXJzZWN0U3BoZXJlX2ludGVyc2VjdGlvblBvaW50ID0gbmV3IFZlYzMoKTsKICBjb25zdCBSYXlfaW50ZXJzZWN0U3BoZXJlX25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0Q29udmV4X25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdENvbnZleF92ZWN0b3IgPSBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdFRyaW1lc2hfbm9ybWFsID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRGlyZWN0aW9uID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRnJvbSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0VHJpbWVzaF9sb2NhbFRvID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX3dvcmxkTm9ybWFsID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX3dvcmxkSW50ZXJzZWN0UG9pbnQgPSBuZXcgVmVjMygpOwogIG5ldyBBQUJCKCk7CiAgY29uc3QgaW50ZXJzZWN0VHJpbWVzaF90cmlhbmdsZXMgPSBbXTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX3RyZWVUcmFuc2Zvcm0gPSBuZXcgVHJhbnNmb3JtKCk7CiAgY29uc3QgdjAgPSBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdCA9IG5ldyBWZWMzKCk7CgogIGZ1bmN0aW9uIGRpc3RhbmNlRnJvbUludGVyc2VjdGlvbihmcm9tLCBkaXJlY3Rpb24sIHBvc2l0aW9uKSB7CiAgICAvLyB2MCBpcyB2ZWN0b3IgZnJvbSBmcm9tIHRvIHBvc2l0aW9uCiAgICBwb3NpdGlvbi52c3ViKGZyb20sIHYwKTsKICAgIGNvbnN0IGRvdCA9IHYwLmRvdChkaXJlY3Rpb24pOyAvLyBpbnRlcnNlY3QgPSBkaXJlY3Rpb24qZG90ICsgZnJvbQoKICAgIGRpcmVjdGlvbi5zY2FsZShkb3QsIGludGVyc2VjdCk7CiAgICBpbnRlcnNlY3QudmFkZChmcm9tLCBpbnRlcnNlY3QpOwogICAgY29uc3QgZGlzdGFuY2UgPSBwb3NpdGlvbi5kaXN0YW5jZVRvKGludGVyc2VjdCk7CiAgICByZXR1cm4gZGlzdGFuY2U7CiAgfQoKICAvKioKICAgKiBTd2VlcCBhbmQgcHJ1bmUgYnJvYWRwaGFzZSBhbG9uZyBvbmUgYXhpcy4KICAgKi8KICBjbGFzcyBTQVBCcm9hZHBoYXNlIGV4dGVuZHMgQnJvYWRwaGFzZSB7CiAgICAvKioKICAgICAqIExpc3Qgb2YgYm9kaWVzIGN1cnJlbnRseSBpbiB0aGUgYnJvYWRwaGFzZS4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHdvcmxkIHRvIHNlYXJjaCBpbi4KICAgICAqLwoKICAgIC8qKgogICAgICogQXhpcyB0byBzb3J0IHRoZSBib2RpZXMgYWxvbmcuCiAgICAgKiBTZXQgdG8gMCBmb3IgeCBheGlzLCBhbmQgMSBmb3IgeSBheGlzLgogICAgICogRm9yIGJlc3QgcGVyZm9ybWFuY2UsIHBpY2sgdGhlIGF4aXMgd2hlcmUgYm9kaWVzIGFyZSBtb3N0IGRpc3RyaWJ1dGVkLgogICAgICovCgogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgYm91bmRzIG9mIHR3byBib2RpZXMgb3ZlcmxhcCwgYWxvbmcgdGhlIGdpdmVuIFNBUCBheGlzLgogICAgICovCiAgICBzdGF0aWMgY2hlY2tCb3VuZHMoYmksIGJqLCBheGlzSW5kZXgpIHsKICAgICAgbGV0IGJpUG9zOwogICAgICBsZXQgYmpQb3M7CgogICAgICBpZiAoYXhpc0luZGV4ID09PSAwKSB7CiAgICAgICAgYmlQb3MgPSBiaS5wb3NpdGlvbi54OwogICAgICAgIGJqUG9zID0gYmoucG9zaXRpb24ueDsKICAgICAgfSBlbHNlIGlmIChheGlzSW5kZXggPT09IDEpIHsKICAgICAgICBiaVBvcyA9IGJpLnBvc2l0aW9uLnk7CiAgICAgICAgYmpQb3MgPSBiai5wb3NpdGlvbi55OwogICAgICB9IGVsc2UgaWYgKGF4aXNJbmRleCA9PT0gMikgewogICAgICAgIGJpUG9zID0gYmkucG9zaXRpb24uejsKICAgICAgICBialBvcyA9IGJqLnBvc2l0aW9uLno7CiAgICAgIH0KCiAgICAgIGNvbnN0IHJpID0gYmkuYm91bmRpbmdSYWRpdXMsCiAgICAgICAgICAgIHJqID0gYmouYm91bmRpbmdSYWRpdXMsCiAgICAgICAgICAgIGJvdW5kQTIgPSBiaVBvcyArIHJpLAogICAgICAgICAgICBib3VuZEIxID0gYmpQb3MgLSByajsKICAgICAgcmV0dXJuIGJvdW5kQjEgPCBib3VuZEEyOwogICAgfSAvLyBOb3RlOiB0aGVzZSBhcmUgaWRlbnRpY2FsLCBzYXZlIGZvciB4L3kveiBsb3dlcmJvdW5kCgogICAgLyoqCiAgICAgKiBpbnNlcnRpb25Tb3J0WAogICAgICovCgoKICAgIHN0YXRpYyBpbnNlcnRpb25Tb3J0WChhKSB7CiAgICAgIGZvciAobGV0IGkgPSAxLCBsID0gYS5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBjb25zdCB2ID0gYVtpXTsKICAgICAgICBsZXQgajsKCiAgICAgICAgZm9yIChqID0gaSAtIDE7IGogPj0gMDsgai0tKSB7CiAgICAgICAgICBpZiAoYVtqXS5hYWJiLmxvd2VyQm91bmQueCA8PSB2LmFhYmIubG93ZXJCb3VuZC54KSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGFbaiArIDFdID0gYVtqXTsKICAgICAgICB9CgogICAgICAgIGFbaiArIDFdID0gdjsKICAgICAgfQoKICAgICAgcmV0dXJuIGE7CiAgICB9CiAgICAvKioKICAgICAqIGluc2VydGlvblNvcnRZCiAgICAgKi8KCgogICAgc3RhdGljIGluc2VydGlvblNvcnRZKGEpIHsKICAgICAgZm9yIChsZXQgaSA9IDEsIGwgPSBhLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIGNvbnN0IHYgPSBhW2ldOwogICAgICAgIGxldCBqOwoKICAgICAgICBmb3IgKGogPSBpIC0gMTsgaiA+PSAwOyBqLS0pIHsKICAgICAgICAgIGlmIChhW2pdLmFhYmIubG93ZXJCb3VuZC55IDw9IHYuYWFiYi5sb3dlckJvdW5kLnkpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgYVtqICsgMV0gPSBhW2pdOwogICAgICAgIH0KCiAgICAgICAgYVtqICsgMV0gPSB2OwogICAgICB9CgogICAgICByZXR1cm4gYTsKICAgIH0KICAgIC8qKgogICAgICogaW5zZXJ0aW9uU29ydFoKICAgICAqLwoKCiAgICBzdGF0aWMgaW5zZXJ0aW9uU29ydFooYSkgewogICAgICBmb3IgKGxldCBpID0gMSwgbCA9IGEubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgY29uc3QgdiA9IGFbaV07CiAgICAgICAgbGV0IGo7CgogICAgICAgIGZvciAoaiA9IGkgLSAxOyBqID49IDA7IGotLSkgewogICAgICAgICAgaWYgKGFbal0uYWFiYi5sb3dlckJvdW5kLnogPD0gdi5hYWJiLmxvd2VyQm91bmQueikgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBhW2ogKyAxXSA9IGFbal07CiAgICAgICAgfQoKICAgICAgICBhW2ogKyAxXSA9IHY7CiAgICAgIH0KCiAgICAgIHJldHVybiBhOwogICAgfQoKICAgIGNvbnN0cnVjdG9yKHdvcmxkKSB7CiAgICAgIHN1cGVyKCk7CiAgICAgIHRoaXMuYXhpc0xpc3QgPSBbXTsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICAgIHRoaXMuYXhpc0luZGV4ID0gMDsKICAgICAgY29uc3QgYXhpc0xpc3QgPSB0aGlzLmF4aXNMaXN0OwoKICAgICAgdGhpcy5fYWRkQm9keUhhbmRsZXIgPSBldmVudCA9PiB7CiAgICAgICAgYXhpc0xpc3QucHVzaChldmVudC5ib2R5KTsKICAgICAgfTsKCiAgICAgIHRoaXMuX3JlbW92ZUJvZHlIYW5kbGVyID0gZXZlbnQgPT4gewogICAgICAgIGNvbnN0IGlkeCA9IGF4aXNMaXN0LmluZGV4T2YoZXZlbnQuYm9keSk7CgogICAgICAgIGlmIChpZHggIT09IC0xKSB7CiAgICAgICAgICBheGlzTGlzdC5zcGxpY2UoaWR4LCAxKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAod29ybGQpIHsKICAgICAgICB0aGlzLnNldFdvcmxkKHdvcmxkKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDaGFuZ2UgdGhlIHdvcmxkCiAgICAgKi8KCgogICAgc2V0V29ybGQod29ybGQpIHsKICAgICAgLy8gQ2xlYXIgdGhlIG9sZCBheGlzIGFycmF5CiAgICAgIHRoaXMuYXhpc0xpc3QubGVuZ3RoID0gMDsgLy8gQWRkIGFsbCBib2RpZXMgZnJvbSB0aGUgbmV3IHdvcmxkCgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHdvcmxkLmJvZGllcy5sZW5ndGg7IGkrKykgewogICAgICAgIHRoaXMuYXhpc0xpc3QucHVzaCh3b3JsZC5ib2RpZXNbaV0pOwogICAgICB9IC8vIFJlbW92ZSBvbGQgaGFuZGxlcnMsIGlmIGFueQoKCiAgICAgIHdvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2FkZEJvZHknLCB0aGlzLl9hZGRCb2R5SGFuZGxlcik7CiAgICAgIHdvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3JlbW92ZUJvZHknLCB0aGlzLl9yZW1vdmVCb2R5SGFuZGxlcik7IC8vIEFkZCBoYW5kbGVycyB0byB1cGRhdGUgdGhlIGxpc3Qgb2YgYm9kaWVzLgoKICAgICAgd29ybGQuYWRkRXZlbnRMaXN0ZW5lcignYWRkQm9keScsIHRoaXMuX2FkZEJvZHlIYW5kbGVyKTsKICAgICAgd29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncmVtb3ZlQm9keScsIHRoaXMuX3JlbW92ZUJvZHlIYW5kbGVyKTsKICAgICAgdGhpcy53b3JsZCA9IHdvcmxkOwogICAgICB0aGlzLmRpcnR5ID0gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogQ29sbGVjdCBhbGwgY29sbGlzaW9uIHBhaXJzCiAgICAgKi8KCgogICAgY29sbGlzaW9uUGFpcnMod29ybGQsIHAxLCBwMikgewogICAgICBjb25zdCBib2RpZXMgPSB0aGlzLmF4aXNMaXN0OwogICAgICBjb25zdCBOID0gYm9kaWVzLmxlbmd0aDsKICAgICAgY29uc3QgYXhpc0luZGV4ID0gdGhpcy5heGlzSW5kZXg7CiAgICAgIGxldCBpOwogICAgICBsZXQgajsKCiAgICAgIGlmICh0aGlzLmRpcnR5KSB7CiAgICAgICAgdGhpcy5zb3J0TGlzdCgpOwogICAgICAgIHRoaXMuZGlydHkgPSBmYWxzZTsKICAgICAgfSAvLyBMb29rIHRocm91Z2ggdGhlIGxpc3QKCgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKCiAgICAgICAgZm9yIChqID0gaSArIDE7IGogPCBOOyBqKyspIHsKICAgICAgICAgIGNvbnN0IGJqID0gYm9kaWVzW2pdOwoKICAgICAgICAgIGlmICghdGhpcy5uZWVkQnJvYWRwaGFzZUNvbGxpc2lvbihiaSwgYmopKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghU0FQQnJvYWRwaGFzZS5jaGVja0JvdW5kcyhiaSwgYmosIGF4aXNJbmRleCkpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5pbnRlcnNlY3Rpb25UZXN0KGJpLCBiaiwgcDEsIHAyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBzb3J0TGlzdCgpIHsKICAgICAgY29uc3QgYXhpc0xpc3QgPSB0aGlzLmF4aXNMaXN0OwogICAgICBjb25zdCBheGlzSW5kZXggPSB0aGlzLmF4aXNJbmRleDsKICAgICAgY29uc3QgTiA9IGF4aXNMaXN0Lmxlbmd0aDsgLy8gVXBkYXRlIEFBQkJzCgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgYmkgPSBheGlzTGlzdFtpXTsKCiAgICAgICAgaWYgKGJpLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgICAgYmkudXBkYXRlQUFCQigpOwogICAgICAgIH0KICAgICAgfSAvLyBTb3J0IHRoZSBsaXN0CgoKICAgICAgaWYgKGF4aXNJbmRleCA9PT0gMCkgewogICAgICAgIFNBUEJyb2FkcGhhc2UuaW5zZXJ0aW9uU29ydFgoYXhpc0xpc3QpOwogICAgICB9IGVsc2UgaWYgKGF4aXNJbmRleCA9PT0gMSkgewogICAgICAgIFNBUEJyb2FkcGhhc2UuaW5zZXJ0aW9uU29ydFkoYXhpc0xpc3QpOwogICAgICB9IGVsc2UgaWYgKGF4aXNJbmRleCA9PT0gMikgewogICAgICAgIFNBUEJyb2FkcGhhc2UuaW5zZXJ0aW9uU29ydFooYXhpc0xpc3QpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGVzIHRoZSB2YXJpYW5jZSBvZiB0aGUgYm9keSBwb3NpdGlvbnMgYW5kIGVzdGltYXRlcyB0aGUgYmVzdCBheGlzIHRvIHVzZS4KICAgICAqIFdpbGwgYXV0b21hdGljYWxseSBzZXQgcHJvcGVydHkgYGF4aXNJbmRleGAuCiAgICAgKi8KCgogICAgYXV0b0RldGVjdEF4aXMoKSB7CiAgICAgIGxldCBzdW1YID0gMDsKICAgICAgbGV0IHN1bVgyID0gMDsKICAgICAgbGV0IHN1bVkgPSAwOwogICAgICBsZXQgc3VtWTIgPSAwOwogICAgICBsZXQgc3VtWiA9IDA7CiAgICAgIGxldCBzdW1aMiA9IDA7CiAgICAgIGNvbnN0IGJvZGllcyA9IHRoaXMuYXhpc0xpc3Q7CiAgICAgIGNvbnN0IE4gPSBib2RpZXMubGVuZ3RoOwogICAgICBjb25zdCBpbnZOID0gMSAvIE47CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgYiA9IGJvZGllc1tpXTsKICAgICAgICBjb25zdCBjZW50ZXJYID0gYi5wb3NpdGlvbi54OwogICAgICAgIHN1bVggKz0gY2VudGVyWDsKICAgICAgICBzdW1YMiArPSBjZW50ZXJYICogY2VudGVyWDsKICAgICAgICBjb25zdCBjZW50ZXJZID0gYi5wb3NpdGlvbi55OwogICAgICAgIHN1bVkgKz0gY2VudGVyWTsKICAgICAgICBzdW1ZMiArPSBjZW50ZXJZICogY2VudGVyWTsKICAgICAgICBjb25zdCBjZW50ZXJaID0gYi5wb3NpdGlvbi56OwogICAgICAgIHN1bVogKz0gY2VudGVyWjsKICAgICAgICBzdW1aMiArPSBjZW50ZXJaICogY2VudGVyWjsKICAgICAgfQoKICAgICAgY29uc3QgdmFyaWFuY2VYID0gc3VtWDIgLSBzdW1YICogc3VtWCAqIGludk47CiAgICAgIGNvbnN0IHZhcmlhbmNlWSA9IHN1bVkyIC0gc3VtWSAqIHN1bVkgKiBpbnZOOwogICAgICBjb25zdCB2YXJpYW5jZVogPSBzdW1aMiAtIHN1bVogKiBzdW1aICogaW52TjsKCiAgICAgIGlmICh2YXJpYW5jZVggPiB2YXJpYW5jZVkpIHsKICAgICAgICBpZiAodmFyaWFuY2VYID4gdmFyaWFuY2VaKSB7CiAgICAgICAgICB0aGlzLmF4aXNJbmRleCA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuYXhpc0luZGV4ID0gMjsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodmFyaWFuY2VZID4gdmFyaWFuY2VaKSB7CiAgICAgICAgdGhpcy5heGlzSW5kZXggPSAxOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYXhpc0luZGV4ID0gMjsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFsbCB0aGUgYm9kaWVzIHdpdGhpbiBhbiBBQUJCLgogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSB0byBzdG9yZSByZXN1bHRpbmcgYm9kaWVzIGluLgogICAgICovCgoKICAgIGFhYmJRdWVyeSh3b3JsZCwgYWFiYiwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IFtdOwogICAgICB9CgogICAgICBpZiAodGhpcy5kaXJ0eSkgewogICAgICAgIHRoaXMuc29ydExpc3QoKTsKICAgICAgICB0aGlzLmRpcnR5ID0gZmFsc2U7CiAgICAgIH0KCiAgICAgIGNvbnN0IGF4aXNJbmRleCA9IHRoaXMuYXhpc0luZGV4OwogICAgICBsZXQgYXhpcyA9ICd4JzsKCiAgICAgIGlmIChheGlzSW5kZXggPT09IDEpIHsKICAgICAgICBheGlzID0gJ3knOwogICAgICB9CgogICAgICBpZiAoYXhpc0luZGV4ID09PSAyKSB7CiAgICAgICAgYXhpcyA9ICd6JzsKICAgICAgfQoKICAgICAgY29uc3QgYXhpc0xpc3QgPSB0aGlzLmF4aXNMaXN0OwogICAgICBhYWJiLmxvd2VyQm91bmRbYXhpc107CiAgICAgIGFhYmIudXBwZXJCb3VuZFtheGlzXTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXhpc0xpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBiID0gYXhpc0xpc3RbaV07CgogICAgICAgIGlmIChiLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgICAgYi51cGRhdGVBQUJCKCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoYi5hYWJiLm92ZXJsYXBzKGFhYmIpKSB7CiAgICAgICAgICByZXN1bHQucHVzaChiKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogIH0KCiAgY2xhc3MgVXRpbHMgewogICAgLyoqCiAgICAgKiBFeHRlbmQgYW4gb3B0aW9ucyBvYmplY3Qgd2l0aCBkZWZhdWx0IHZhbHVlcy4KICAgICAqIEBwYXJhbSBvcHRpb25zIFRoZSBvcHRpb25zIG9iamVjdC4gTWF5IGJlIGZhbHN5OiBpbiB0aGlzIGNhc2UsIGEgbmV3IG9iamVjdCBpcyBjcmVhdGVkIGFuZCByZXR1cm5lZC4KICAgICAqIEBwYXJhbSBkZWZhdWx0cyBBbiBvYmplY3QgY29udGFpbmluZyBkZWZhdWx0IHZhbHVlcy4KICAgICAqIEByZXR1cm4gVGhlIG1vZGlmaWVkIG9wdGlvbnMgb2JqZWN0LgogICAgICovCiAgICBzdGF0aWMgZGVmYXVsdHMob3B0aW9ucywgZGVmYXVsdHMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgZm9yIChsZXQga2V5IGluIGRlZmF1bHRzKSB7CiAgICAgICAgaWYgKCEoa2V5IGluIG9wdGlvbnMpKSB7CiAgICAgICAgICBvcHRpb25zW2tleV0gPSBkZWZhdWx0c1trZXldOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG9wdGlvbnM7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQ29uc3RyYWludCBiYXNlIGNsYXNzCiAgICovCiAgY2xhc3MgQ29uc3RyYWludCB7CiAgICAvKioKICAgICAqIEVxdWF0aW9ucyB0byBiZSBzb2x2ZWQgaW4gdGhpcyBjb25zdHJhaW50LgogICAgICovCgogICAgLyoqCiAgICAgKiBCb2R5IEEuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEJvZHkgQi4KICAgICAqLwoKICAgIC8qKgogICAgICogU2V0IHRvIGZhbHNlIGlmIHlvdSBkb24ndCB3YW50IHRoZSBib2RpZXMgdG8gY29sbGlkZSB3aGVuIHRoZXkgYXJlIGNvbm5lY3RlZC4KICAgICAqLwogICAgY29uc3RydWN0b3IoYm9keUEsIGJvZHlCLCBvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIG9wdGlvbnMgPSBVdGlscy5kZWZhdWx0cyhvcHRpb25zLCB7CiAgICAgICAgY29sbGlkZUNvbm5lY3RlZDogdHJ1ZSwKICAgICAgICB3YWtlVXBCb2RpZXM6IHRydWUKICAgICAgfSk7CiAgICAgIHRoaXMuZXF1YXRpb25zID0gW107CiAgICAgIHRoaXMuYm9keUEgPSBib2R5QTsKICAgICAgdGhpcy5ib2R5QiA9IGJvZHlCOwogICAgICB0aGlzLmlkID0gQ29uc3RyYWludC5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5jb2xsaWRlQ29ubmVjdGVkID0gb3B0aW9ucy5jb2xsaWRlQ29ubmVjdGVkOwoKICAgICAgaWYgKG9wdGlvbnMud2FrZVVwQm9kaWVzKSB7CiAgICAgICAgaWYgKGJvZHlBKSB7CiAgICAgICAgICBib2R5QS53YWtlVXAoKTsKICAgICAgICB9CgogICAgICAgIGlmIChib2R5QikgewogICAgICAgICAgYm9keUIud2FrZVVwKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFVwZGF0ZSBhbGwgdGhlIGVxdWF0aW9ucyB3aXRoIGRhdGEuCiAgICAgKi8KCgogICAgdXBkYXRlKCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ21ldGhvZCB1cGRhdGUoKSBub3QgaW1wbG1lbWVudGVkIGluIHRoaXMgQ29uc3RyYWludCBzdWJjbGFzcyEnKTsKICAgIH0KICAgIC8qKgogICAgICogRW5hYmxlcyBhbGwgZXF1YXRpb25zIGluIHRoZSBjb25zdHJhaW50LgogICAgICovCgoKICAgIGVuYWJsZSgpIHsKICAgICAgY29uc3QgZXFzID0gdGhpcy5lcXVhdGlvbnM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVxcy5sZW5ndGg7IGkrKykgewogICAgICAgIGVxc1tpXS5lbmFibGVkID0gdHJ1ZTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBEaXNhYmxlcyBhbGwgZXF1YXRpb25zIGluIHRoZSBjb25zdHJhaW50LgogICAgICovCgoKICAgIGRpc2FibGUoKSB7CiAgICAgIGNvbnN0IGVxcyA9IHRoaXMuZXF1YXRpb25zOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlcXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBlcXNbaV0uZW5hYmxlZCA9IGZhbHNlOwogICAgICB9CiAgICB9CgogIH0KICBDb25zdHJhaW50LmlkQ291bnRlciA9IDA7CgogIC8qKgogICAqIEFuIGVsZW1lbnQgY29udGFpbmluZyA2IGVudHJpZXMsIDMgc3BhdGlhbCBhbmQgMyByb3RhdGlvbmFsIGRlZ3JlZXMgb2YgZnJlZWRvbS4KICAgKi8KCiAgY2xhc3MgSmFjb2JpYW5FbGVtZW50IHsKICAgIC8qKgogICAgICogc3BhdGlhbAogICAgICovCgogICAgLyoqCiAgICAgKiByb3RhdGlvbmFsCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKCkgewogICAgICB0aGlzLnNwYXRpYWwgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnJvdGF0aW9uYWwgPSBuZXcgVmVjMygpOwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSB3aXRoIG90aGVyIEphY29iaWFuRWxlbWVudAogICAgICovCgoKICAgIG11bHRpcGx5RWxlbWVudChlbGVtZW50KSB7CiAgICAgIHJldHVybiBlbGVtZW50LnNwYXRpYWwuZG90KHRoaXMuc3BhdGlhbCkgKyBlbGVtZW50LnJvdGF0aW9uYWwuZG90KHRoaXMucm90YXRpb25hbCk7CiAgICB9CiAgICAvKioKICAgICAqIE11bHRpcGx5IHdpdGggdHdvIHZlY3RvcnMKICAgICAqLwoKCiAgICBtdWx0aXBseVZlY3RvcnMoc3BhdGlhbCwgcm90YXRpb25hbCkgewogICAgICByZXR1cm4gc3BhdGlhbC5kb3QodGhpcy5zcGF0aWFsKSArIHJvdGF0aW9uYWwuZG90KHRoaXMucm90YXRpb25hbCk7CiAgICB9CgogIH0KCiAgLyoqCiAgICogRXF1YXRpb24gYmFzZSBjbGFzcy4KICAgKgogICAqIGBhYCwgYGJgIGFuZCBgZXBzYCBhcmUge0BsaW5rIGh0dHBzOi8vd3d3OC5jcy51bXUuc2Uva3Vyc2VyLzVEVjA1OC9WVDE1L2xlY3R1cmVzL1NQT09LbGFibm90ZXMucGRmIFNQT09LfSBwYXJhbWV0ZXJzIHRoYXQgZGVmYXVsdCB0byBgMC4wYC4gU2VlIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vc2NodGVwcGUvY2Fubm9uLmpzL2lzc3Vlcy8yMzgjaXNzdWVjb21tZW50LTE0NzE3MjMyNyB0aGlzIGV4Y2hhbmdlfSBmb3IgbW9yZSBkZXRhaWxzIG9uIENhbm5vbidzIHBoeXNpY3MgaW1wbGVtZW50YXRpb24uCiAgICovCiAgY2xhc3MgRXF1YXRpb24gewogICAgLyoqCiAgICAgKiBNaW5pbXVtIChyZWFkOiBuZWdhdGl2ZSBtYXgpIGZvcmNlIHRvIGJlIGFwcGxpZWQgYnkgdGhlIGNvbnN0cmFpbnQuCiAgICAgKi8KCiAgICAvKioKICAgICAqIE1heGltdW0gKHJlYWQ6IHBvc2l0aXZlIG1heCkgZm9yY2UgdG8gYmUgYXBwbGllZCBieSB0aGUgY29uc3RyYWludC4KICAgICAqLwoKICAgIC8qKgogICAgICogU1BPT0sgcGFyYW1ldGVyCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNQT09LIHBhcmFtZXRlcgogICAgICovCgogICAgLyoqCiAgICAgKiBTUE9PSyBwYXJhbWV0ZXIKICAgICAqLwoKICAgIC8qKgogICAgICogQSBudW1iZXIsIHByb3BvcnRpb25hbCB0byB0aGUgZm9yY2UgYWRkZWQgdG8gdGhlIGJvZGllcy4KICAgICAqLwogICAgY29uc3RydWN0b3IoYmksIGJqLCBtaW5Gb3JjZSwgbWF4Rm9yY2UpIHsKICAgICAgaWYgKG1pbkZvcmNlID09PSB2b2lkIDApIHsKICAgICAgICBtaW5Gb3JjZSA9IC0xZTY7CiAgICAgIH0KCiAgICAgIGlmIChtYXhGb3JjZSA9PT0gdm9pZCAwKSB7CiAgICAgICAgbWF4Rm9yY2UgPSAxZTY7CiAgICAgIH0KCiAgICAgIHRoaXMuaWQgPSBFcXVhdGlvbi5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5taW5Gb3JjZSA9IG1pbkZvcmNlOwogICAgICB0aGlzLm1heEZvcmNlID0gbWF4Rm9yY2U7CiAgICAgIHRoaXMuYmkgPSBiaTsKICAgICAgdGhpcy5iaiA9IGJqOwogICAgICB0aGlzLmEgPSAwLjA7IC8vIFNQT09LIHBhcmFtZXRlcgoKICAgICAgdGhpcy5iID0gMC4wOyAvLyBTUE9PSyBwYXJhbWV0ZXIKCiAgICAgIHRoaXMuZXBzID0gMC4wOyAvLyBTUE9PSyBwYXJhbWV0ZXIKCiAgICAgIHRoaXMuamFjb2JpYW5FbGVtZW50QSA9IG5ldyBKYWNvYmlhbkVsZW1lbnQoKTsKICAgICAgdGhpcy5qYWNvYmlhbkVsZW1lbnRCID0gbmV3IEphY29iaWFuRWxlbWVudCgpOwogICAgICB0aGlzLmVuYWJsZWQgPSB0cnVlOwogICAgICB0aGlzLm11bHRpcGxpZXIgPSAwOwogICAgICB0aGlzLnNldFNwb29rUGFyYW1zKDFlNywgNCwgMSAvIDYwKTsgLy8gU2V0IHR5cGljYWwgc3Bvb2sgcGFyYW1zCiAgICB9CiAgICAvKioKICAgICAqIFJlY2FsY3VsYXRlcyBhLCBiLCBhbmQgZXBzLgogICAgICoKICAgICAqIFRoZSBFcXVhdGlvbiBjb25zdHJ1Y3RvciBzZXRzIHR5cGljYWwgU1BPT0sgcGFyYW1ldGVycyBhcyBzdWNoOgogICAgICogKiBgc3RpZmZuZXNzYCA9IDFlNwogICAgICogKiBgcmVsYXhhdGlvbmAgPSA0CiAgICAgKiAqIGB0aW1lU3RlcGA9IDEgLyA2MCwgX25vdGUgdGhlIGhhcmRjb2RlZCByZWZyZXNoIHJhdGUuXwogICAgICovCgoKICAgIHNldFNwb29rUGFyYW1zKHN0aWZmbmVzcywgcmVsYXhhdGlvbiwgdGltZVN0ZXApIHsKICAgICAgY29uc3QgZCA9IHJlbGF4YXRpb247CiAgICAgIGNvbnN0IGsgPSBzdGlmZm5lc3M7CiAgICAgIGNvbnN0IGggPSB0aW1lU3RlcDsKICAgICAgdGhpcy5hID0gNC4wIC8gKGggKiAoMSArIDQgKiBkKSk7CiAgICAgIHRoaXMuYiA9IDQuMCAqIGQgLyAoMSArIDQgKiBkKTsKICAgICAgdGhpcy5lcHMgPSA0LjAgLyAoaCAqIGggKiBrICogKDEgKyA0ICogZCkpOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyB0aGUgcmlnaHQgaGFuZCBzaWRlIG9mIHRoZSBTUE9PSyBlcXVhdGlvbgogICAgICovCgoKICAgIGNvbXB1dGVCKGEsIGIsIGgpIHsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpOwogICAgICBjb25zdCBHcSA9IHRoaXMuY29tcHV0ZUdxKCk7CiAgICAgIGNvbnN0IEdpTWYgPSB0aGlzLmNvbXB1dGVHaU1mKCk7CiAgICAgIHJldHVybiAtR3EgKiBhIC0gR1cgKiBiIC0gR2lNZiAqIGg7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGVzIEcqcSwgd2hlcmUgcSBhcmUgdGhlIGdlbmVyYWxpemVkIGJvZHkgY29vcmRpbmF0ZXMKICAgICAqLwoKCiAgICBjb21wdXRlR3EoKSB7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsKICAgICAgY29uc3QgYmkgPSB0aGlzLmJpOwogICAgICBjb25zdCBiaiA9IHRoaXMuYmo7CiAgICAgIGNvbnN0IHhpID0gYmkucG9zaXRpb247CiAgICAgIGNvbnN0IHhqID0gYmoucG9zaXRpb247CiAgICAgIHJldHVybiBHQS5zcGF0aWFsLmRvdCh4aSkgKyBHQi5zcGF0aWFsLmRvdCh4aik7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGVzIEcqVywgd2hlcmUgVyBhcmUgdGhlIGJvZHkgdmVsb2NpdGllcwogICAgICovCgoKICAgIGNvbXB1dGVHVygpIHsKICAgICAgY29uc3QgR0EgPSB0aGlzLmphY29iaWFuRWxlbWVudEE7CiAgICAgIGNvbnN0IEdCID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRCOwogICAgICBjb25zdCBiaSA9IHRoaXMuYmk7CiAgICAgIGNvbnN0IGJqID0gdGhpcy5iajsKICAgICAgY29uc3QgdmkgPSBiaS52ZWxvY2l0eTsKICAgICAgY29uc3QgdmogPSBiai52ZWxvY2l0eTsKICAgICAgY29uc3Qgd2kgPSBiaS5hbmd1bGFyVmVsb2NpdHk7CiAgICAgIGNvbnN0IHdqID0gYmouYW5ndWxhclZlbG9jaXR5OwogICAgICByZXR1cm4gR0EubXVsdGlwbHlWZWN0b3JzKHZpLCB3aSkgKyBHQi5tdWx0aXBseVZlY3RvcnModmosIHdqKTsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZXMgRypXbGFtYmRhLCB3aGVyZSBXIGFyZSB0aGUgYm9keSB2ZWxvY2l0aWVzCiAgICAgKi8KCgogICAgY29tcHV0ZUdXbGFtYmRhKCkgewogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IGJpID0gdGhpcy5iaTsKICAgICAgY29uc3QgYmogPSB0aGlzLmJqOwogICAgICBjb25zdCB2aSA9IGJpLnZsYW1iZGE7CiAgICAgIGNvbnN0IHZqID0gYmoudmxhbWJkYTsKICAgICAgY29uc3Qgd2kgPSBiaS53bGFtYmRhOwogICAgICBjb25zdCB3aiA9IGJqLndsYW1iZGE7CiAgICAgIHJldHVybiBHQS5tdWx0aXBseVZlY3RvcnModmksIHdpKSArIEdCLm11bHRpcGx5VmVjdG9ycyh2aiwgd2opOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyBHKmludihNKSpmLCB3aGVyZSBNIGlzIHRoZSBtYXNzIG1hdHJpeCB3aXRoIGRpYWdvbmFsIGJsb2NrcyBmb3IgZWFjaCBib2R5LCBhbmQgZiBhcmUgdGhlIGZvcmNlcyBvbiB0aGUgYm9kaWVzLgogICAgICovCgoKICAgIGNvbXB1dGVHaU1mKCkgewogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IGJpID0gdGhpcy5iaTsKICAgICAgY29uc3QgYmogPSB0aGlzLmJqOwogICAgICBjb25zdCBmaSA9IGJpLmZvcmNlOwogICAgICBjb25zdCB0aSA9IGJpLnRvcnF1ZTsKICAgICAgY29uc3QgZmogPSBiai5mb3JjZTsKICAgICAgY29uc3QgdGogPSBiai50b3JxdWU7CiAgICAgIGNvbnN0IGludk1hc3NpID0gYmkuaW52TWFzc1NvbHZlOwogICAgICBjb25zdCBpbnZNYXNzaiA9IGJqLmludk1hc3NTb2x2ZTsKICAgICAgZmkuc2NhbGUoaW52TWFzc2ksIGlNZmkpOwogICAgICBmai5zY2FsZShpbnZNYXNzaiwgaU1maik7CiAgICAgIGJpLmludkluZXJ0aWFXb3JsZFNvbHZlLnZtdWx0KHRpLCBpbnZJaV92bXVsdF90YXVpKTsKICAgICAgYmouaW52SW5lcnRpYVdvcmxkU29sdmUudm11bHQodGosIGludklqX3ZtdWx0X3RhdWopOwogICAgICByZXR1cm4gR0EubXVsdGlwbHlWZWN0b3JzKGlNZmksIGludklpX3ZtdWx0X3RhdWkpICsgR0IubXVsdGlwbHlWZWN0b3JzKGlNZmosIGludklqX3ZtdWx0X3RhdWopOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyBHKmludihNKSpHJwogICAgICovCgoKICAgIGNvbXB1dGVHaU1HdCgpIHsKICAgICAgY29uc3QgR0EgPSB0aGlzLmphY29iaWFuRWxlbWVudEE7CiAgICAgIGNvbnN0IEdCID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRCOwogICAgICBjb25zdCBiaSA9IHRoaXMuYmk7CiAgICAgIGNvbnN0IGJqID0gdGhpcy5iajsKICAgICAgY29uc3QgaW52TWFzc2kgPSBiaS5pbnZNYXNzU29sdmU7CiAgICAgIGNvbnN0IGludk1hc3NqID0gYmouaW52TWFzc1NvbHZlOwogICAgICBjb25zdCBpbnZJaSA9IGJpLmludkluZXJ0aWFXb3JsZFNvbHZlOwogICAgICBjb25zdCBpbnZJaiA9IGJqLmludkluZXJ0aWFXb3JsZFNvbHZlOwogICAgICBsZXQgcmVzdWx0ID0gaW52TWFzc2kgKyBpbnZNYXNzajsKICAgICAgaW52SWkudm11bHQoR0Eucm90YXRpb25hbCwgdG1wKTsKICAgICAgcmVzdWx0ICs9IHRtcC5kb3QoR0Eucm90YXRpb25hbCk7CiAgICAgIGludklqLnZtdWx0KEdCLnJvdGF0aW9uYWwsIHRtcCk7CiAgICAgIHJlc3VsdCArPSB0bXAuZG90KEdCLnJvdGF0aW9uYWwpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgY29uc3RyYWludCB2ZWxvY2l0eSB0byB0aGUgYm9kaWVzLgogICAgICovCgoKICAgIGFkZFRvV2xhbWJkYShkZWx0YWxhbWJkYSkgewogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IGJpID0gdGhpcy5iaTsKICAgICAgY29uc3QgYmogPSB0aGlzLmJqOwogICAgICBjb25zdCB0ZW1wID0gYWRkVG9XbGFtYmRhX3RlbXA7IC8vIEFkZCB0byBsaW5lYXIgdmVsb2NpdHkKICAgICAgLy8gdl9sYW1iZGEgKz0gaW52KE0pICogZGVsdGFfbGFtYmEgKiBHCgogICAgICBiaS52bGFtYmRhLmFkZFNjYWxlZFZlY3RvcihiaS5pbnZNYXNzU29sdmUgKiBkZWx0YWxhbWJkYSwgR0Euc3BhdGlhbCwgYmkudmxhbWJkYSk7CiAgICAgIGJqLnZsYW1iZGEuYWRkU2NhbGVkVmVjdG9yKGJqLmludk1hc3NTb2x2ZSAqIGRlbHRhbGFtYmRhLCBHQi5zcGF0aWFsLCBiai52bGFtYmRhKTsgLy8gQWRkIHRvIGFuZ3VsYXIgdmVsb2NpdHkKCiAgICAgIGJpLmludkluZXJ0aWFXb3JsZFNvbHZlLnZtdWx0KEdBLnJvdGF0aW9uYWwsIHRlbXApOwogICAgICBiaS53bGFtYmRhLmFkZFNjYWxlZFZlY3RvcihkZWx0YWxhbWJkYSwgdGVtcCwgYmkud2xhbWJkYSk7CiAgICAgIGJqLmludkluZXJ0aWFXb3JsZFNvbHZlLnZtdWx0KEdCLnJvdGF0aW9uYWwsIHRlbXApOwogICAgICBiai53bGFtYmRhLmFkZFNjYWxlZFZlY3RvcihkZWx0YWxhbWJkYSwgdGVtcCwgYmoud2xhbWJkYSk7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGUgdGhlIGRlbm9taW5hdG9yIHBhcnQgb2YgdGhlIFNQT09LIGVxdWF0aW9uOiBDID0gRyppbnYoTSkqRycgKyBlcHMKICAgICAqLwoKCiAgICBjb21wdXRlQygpIHsKICAgICAgcmV0dXJuIHRoaXMuY29tcHV0ZUdpTUd0KCkgKyB0aGlzLmVwczsKICAgIH0KCiAgfQogIEVxdWF0aW9uLmlkQ291bnRlciA9IDA7CiAgY29uc3QgaU1maSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaU1maiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW52SWlfdm11bHRfdGF1aSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW52SWpfdm11bHRfdGF1aiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wID0gbmV3IFZlYzMoKTsKICBjb25zdCBhZGRUb1dsYW1iZGFfdGVtcCA9IG5ldyBWZWMzKCk7CgogIC8qKgogICAqIENvbnRhY3Qvbm9uLXBlbmV0cmF0aW9uIGNvbnN0cmFpbnQgZXF1YXRpb24KICAgKi8KICBjbGFzcyBDb250YWN0RXF1YXRpb24gZXh0ZW5kcyBFcXVhdGlvbiB7CiAgICAvKioKICAgICAqICJib3VuY2luZXNzIjogdTEgPSAtZSp1MAogICAgICovCgogICAgLyoqCiAgICAgKiBXb3JsZC1vcmllbnRlZCB2ZWN0b3IgdGhhdCBnb2VzIGZyb20gdGhlIGNlbnRlciBvZiBiaSB0byB0aGUgY29udGFjdCBwb2ludC4KICAgICAqLwoKICAgIC8qKgogICAgICogV29ybGQtb3JpZW50ZWQgdmVjdG9yIHRoYXQgc3RhcnRzIGluIGJvZHkgaiBwb3NpdGlvbiBhbmQgZ29lcyB0byB0aGUgY29udGFjdCBwb2ludC4KICAgICAqLwoKICAgIC8qKgogICAgICogQ29udGFjdCBub3JtYWwsIHBvaW50aW5nIG91dCBvZiBib2R5IGkuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5QiwgbWF4Rm9yY2UpIHsKICAgICAgaWYgKG1heEZvcmNlID09PSB2b2lkIDApIHsKICAgICAgICBtYXhGb3JjZSA9IDFlNjsKICAgICAgfQoKICAgICAgc3VwZXIoYm9keUEsIGJvZHlCLCAwLCBtYXhGb3JjZSk7CiAgICAgIHRoaXMucmVzdGl0dXRpb24gPSAwLjA7CiAgICAgIHRoaXMucmkgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnJqID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5uaSA9IG5ldyBWZWMzKCk7CiAgICB9CgogICAgY29tcHV0ZUIoaCkgewogICAgICBjb25zdCBhID0gdGhpcy5hOwogICAgICBjb25zdCBiID0gdGhpcy5iOwogICAgICBjb25zdCBiaSA9IHRoaXMuYmk7CiAgICAgIGNvbnN0IGJqID0gdGhpcy5iajsKICAgICAgY29uc3QgcmkgPSB0aGlzLnJpOwogICAgICBjb25zdCByaiA9IHRoaXMucmo7CiAgICAgIGNvbnN0IHJpeG4gPSBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDE7CiAgICAgIGNvbnN0IHJqeG4gPSBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDI7CiAgICAgIGNvbnN0IHZpID0gYmkudmVsb2NpdHk7CiAgICAgIGNvbnN0IHdpID0gYmkuYW5ndWxhclZlbG9jaXR5OwogICAgICBiaS5mb3JjZTsKICAgICAgYmkudG9ycXVlOwogICAgICBjb25zdCB2aiA9IGJqLnZlbG9jaXR5OwogICAgICBjb25zdCB3aiA9IGJqLmFuZ3VsYXJWZWxvY2l0eTsKICAgICAgYmouZm9yY2U7CiAgICAgIGJqLnRvcnF1ZTsKICAgICAgY29uc3QgcGVuZXRyYXRpb25WZWMgPSBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDM7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsKICAgICAgY29uc3QgbiA9IHRoaXMubmk7IC8vIENhbHVjbGF0ZSBjcm9zcyBwcm9kdWN0cwoKICAgICAgcmkuY3Jvc3Mobiwgcml4bik7CiAgICAgIHJqLmNyb3NzKG4sIHJqeG4pOyAvLyBnID0geGorcmogLSh4aStyaSkKICAgICAgLy8gRyA9IFsgLW5pICAtcml4biAgbmkgIHJqeG4gXQoKICAgICAgbi5uZWdhdGUoR0Euc3BhdGlhbCk7CiAgICAgIHJpeG4ubmVnYXRlKEdBLnJvdGF0aW9uYWwpOwogICAgICBHQi5zcGF0aWFsLmNvcHkobik7CiAgICAgIEdCLnJvdGF0aW9uYWwuY29weShyanhuKTsgLy8gQ2FsY3VsYXRlIHRoZSBwZW5ldHJhdGlvbiB2ZWN0b3IKCiAgICAgIHBlbmV0cmF0aW9uVmVjLmNvcHkoYmoucG9zaXRpb24pOwogICAgICBwZW5ldHJhdGlvblZlYy52YWRkKHJqLCBwZW5ldHJhdGlvblZlYyk7CiAgICAgIHBlbmV0cmF0aW9uVmVjLnZzdWIoYmkucG9zaXRpb24sIHBlbmV0cmF0aW9uVmVjKTsKICAgICAgcGVuZXRyYXRpb25WZWMudnN1YihyaSwgcGVuZXRyYXRpb25WZWMpOwogICAgICBjb25zdCBnID0gbi5kb3QocGVuZXRyYXRpb25WZWMpOyAvLyBDb21wdXRlIGl0ZXJhdGlvbgoKICAgICAgY29uc3QgZVBsdXNPbmUgPSB0aGlzLnJlc3RpdHV0aW9uICsgMTsKICAgICAgY29uc3QgR1cgPSBlUGx1c09uZSAqIHZqLmRvdChuKSAtIGVQbHVzT25lICogdmkuZG90KG4pICsgd2ouZG90KHJqeG4pIC0gd2kuZG90KHJpeG4pOwogICAgICBjb25zdCBHaU1mID0gdGhpcy5jb21wdXRlR2lNZigpOwogICAgICBjb25zdCBCID0gLWcgKiBhIC0gR1cgKiBiIC0gaCAqIEdpTWY7CiAgICAgIHJldHVybiBCOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgcmVsYXRpdmUgdmVsb2NpdHkgaW4gdGhlIGNvbnRhY3QgcG9pbnQuCiAgICAgKi8KCgogICAgZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbCgpIHsKICAgICAgY29uc3QgdmkgPSBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF92aTsKICAgICAgY29uc3QgdmogPSBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF92ajsKICAgICAgY29uc3QgeGkgPSBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF94aTsKICAgICAgY29uc3QgeGogPSBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF94ajsKICAgICAgY29uc3QgcmVsVmVsID0gQ29udGFjdEVxdWF0aW9uX2dldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWxfcmVsVmVsOwogICAgICB0aGlzLmJpLnBvc2l0aW9uLnZhZGQodGhpcy5yaSwgeGkpOwogICAgICB0aGlzLmJqLnBvc2l0aW9uLnZhZGQodGhpcy5yaiwgeGopOwogICAgICB0aGlzLmJpLmdldFZlbG9jaXR5QXRXb3JsZFBvaW50KHhpLCB2aSk7CiAgICAgIHRoaXMuYmouZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQoeGosIHZqKTsKICAgICAgdmkudnN1Yih2aiwgcmVsVmVsKTsKICAgICAgcmV0dXJuIHRoaXMubmkuZG90KHJlbFZlbCk7CiAgICB9CgogIH0KICBjb25zdCBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDEgPSBuZXcgVmVjMygpOyAvLyBUZW1wIHZlY3RvcnMKCiAgY29uc3QgQ29udGFjdEVxdWF0aW9uX2NvbXB1dGVCX3RlbXAyID0gbmV3IFZlYzMoKTsKICBjb25zdCBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDMgPSBuZXcgVmVjMygpOwogIGNvbnN0IENvbnRhY3RFcXVhdGlvbl9nZXRJbXBhY3RWZWxvY2l0eUFsb25nTm9ybWFsX3ZpID0gbmV3IFZlYzMoKTsKICBjb25zdCBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF92aiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQ29udGFjdEVxdWF0aW9uX2dldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWxfeGkgPSBuZXcgVmVjMygpOwogIGNvbnN0IENvbnRhY3RFcXVhdGlvbl9nZXRJbXBhY3RWZWxvY2l0eUFsb25nTm9ybWFsX3hqID0gbmV3IFZlYzMoKTsKICBjb25zdCBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF9yZWxWZWwgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBDb25uZWN0cyB0d28gYm9kaWVzIGF0IGdpdmVuIG9mZnNldCBwb2ludHMuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3QgYm9keUEgPSBuZXcgQm9keSh7IG1hc3M6IDEgfSkKICAgKiAgICAgY29uc3QgYm9keUIgPSBuZXcgQm9keSh7IG1hc3M6IDEgfSkKICAgKiAgICAgYm9keUEucG9zaXRpb24uc2V0KC0xLCAwLCAwKQogICAqICAgICBib2R5Qi5wb3NpdGlvbi5zZXQoMSwgMCwgMCkKICAgKiAgICAgYm9keUEuYWRkU2hhcGUoc2hhcGVBKQogICAqICAgICBib2R5Qi5hZGRTaGFwZShzaGFwZUIpCiAgICogICAgIHdvcmxkLmFkZEJvZHkoYm9keUEpCiAgICogICAgIHdvcmxkLmFkZEJvZHkoYm9keUIpCiAgICogICAgIGNvbnN0IGxvY2FsUGl2b3RBID0gbmV3IFZlYzMoMSwgMCwgMCkKICAgKiAgICAgY29uc3QgbG9jYWxQaXZvdEIgPSBuZXcgVmVjMygtMSwgMCwgMCkKICAgKiAgICAgY29uc3QgY29uc3RyYWludCA9IG5ldyBQb2ludFRvUG9pbnRDb25zdHJhaW50KGJvZHlBLCBsb2NhbFBpdm90QSwgYm9keUIsIGxvY2FsUGl2b3RCKQogICAqICAgICB3b3JsZC5hZGRDb25zdHJhaW50KGNvbnN0cmFpbnQpCiAgICovCiAgY2xhc3MgUG9pbnRUb1BvaW50Q29uc3RyYWludCBleHRlbmRzIENvbnN0cmFpbnQgewogICAgLyoqCiAgICAgKiBQaXZvdCwgZGVmaW5lZCBsb2NhbGx5IGluIGJvZHlBLgogICAgICovCgogICAgLyoqCiAgICAgKiBQaXZvdCwgZGVmaW5lZCBsb2NhbGx5IGluIGJvZHlCLgogICAgICovCgogICAgLyoqCiAgICAgKiBAcGFyYW0gcGl2b3RBIFRoZSBwb2ludCByZWxhdGl2ZSB0byB0aGUgY2VudGVyIG9mIG1hc3Mgb2YgYm9keUEgd2hpY2ggYm9keUEgaXMgY29uc3RyYWluZWQgdG8uCiAgICAgKiBAcGFyYW0gYm9keUIgQm9keSB0aGF0IHdpbGwgYmUgY29uc3RyYWluZWQgaW4gYSBzaW1pbGFyIHdheSB0byB0aGUgc2FtZSBwb2ludCBhcyBib2R5QS4gV2Ugd2lsbCB0aGVyZWZvcmUgZ2V0IGEgbGluayBiZXR3ZWVuIGJvZHlBIGFuZCBib2R5Qi4gSWYgbm90IHNwZWNpZmllZCwgYm9keUEgd2lsbCBiZSBjb25zdHJhaW5lZCB0byBhIHN0YXRpYyBwb2ludC4KICAgICAqIEBwYXJhbSBwaXZvdEIgVGhlIHBvaW50IHJlbGF0aXZlIHRvIHRoZSBjZW50ZXIgb2YgbWFzcyBvZiBib2R5QiB3aGljaCBib2R5QiBpcyBjb25zdHJhaW5lZCB0by4KICAgICAqIEBwYXJhbSBtYXhGb3JjZSBUaGUgbWF4aW11bSBmb3JjZSB0aGF0IHNob3VsZCBiZSBhcHBsaWVkIHRvIGNvbnN0cmFpbiB0aGUgYm9kaWVzLgogICAgICovCiAgICBjb25zdHJ1Y3Rvcihib2R5QSwgcGl2b3RBLCBib2R5QiwgcGl2b3RCLCBtYXhGb3JjZSkgewogICAgICBpZiAocGl2b3RBID09PSB2b2lkIDApIHsKICAgICAgICBwaXZvdEEgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBpZiAocGl2b3RCID09PSB2b2lkIDApIHsKICAgICAgICBwaXZvdEIgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBpZiAobWF4Rm9yY2UgPT09IHZvaWQgMCkgewogICAgICAgIG1heEZvcmNlID0gMWU2OwogICAgICB9CgogICAgICBzdXBlcihib2R5QSwgYm9keUIpOwogICAgICB0aGlzLnBpdm90QSA9IHBpdm90QS5jbG9uZSgpOwogICAgICB0aGlzLnBpdm90QiA9IHBpdm90Qi5jbG9uZSgpOwogICAgICBjb25zdCB4ID0gdGhpcy5lcXVhdGlvblggPSBuZXcgQ29udGFjdEVxdWF0aW9uKGJvZHlBLCBib2R5Qik7CiAgICAgIGNvbnN0IHkgPSB0aGlzLmVxdWF0aW9uWSA9IG5ldyBDb250YWN0RXF1YXRpb24oYm9keUEsIGJvZHlCKTsKICAgICAgY29uc3QgeiA9IHRoaXMuZXF1YXRpb25aID0gbmV3IENvbnRhY3RFcXVhdGlvbihib2R5QSwgYm9keUIpOyAvLyBFcXVhdGlvbnMgdG8gYmUgZmVkIHRvIHRoZSBzb2x2ZXIKCiAgICAgIHRoaXMuZXF1YXRpb25zLnB1c2goeCwgeSwgeik7IC8vIE1ha2UgdGhlIGVxdWF0aW9ucyBiaWRpcmVjdGlvbmFsCgogICAgICB4Lm1pbkZvcmNlID0geS5taW5Gb3JjZSA9IHoubWluRm9yY2UgPSAtbWF4Rm9yY2U7CiAgICAgIHgubWF4Rm9yY2UgPSB5Lm1heEZvcmNlID0gei5tYXhGb3JjZSA9IG1heEZvcmNlOwogICAgICB4Lm5pLnNldCgxLCAwLCAwKTsKICAgICAgeS5uaS5zZXQoMCwgMSwgMCk7CiAgICAgIHoubmkuc2V0KDAsIDAsIDEpOwogICAgfQoKICAgIHVwZGF0ZSgpIHsKICAgICAgY29uc3QgYm9keUEgPSB0aGlzLmJvZHlBOwogICAgICBjb25zdCBib2R5QiA9IHRoaXMuYm9keUI7CiAgICAgIGNvbnN0IHggPSB0aGlzLmVxdWF0aW9uWDsKICAgICAgY29uc3QgeSA9IHRoaXMuZXF1YXRpb25ZOwogICAgICBjb25zdCB6ID0gdGhpcy5lcXVhdGlvblo7IC8vIFJvdGF0ZSB0aGUgcGl2b3RzIHRvIHdvcmxkIHNwYWNlCgogICAgICBib2R5QS5xdWF0ZXJuaW9uLnZtdWx0KHRoaXMucGl2b3RBLCB4LnJpKTsKICAgICAgYm9keUIucXVhdGVybmlvbi52bXVsdCh0aGlzLnBpdm90QiwgeC5yaik7CiAgICAgIHkucmkuY29weSh4LnJpKTsKICAgICAgeS5yai5jb3B5KHgucmopOwogICAgICB6LnJpLmNvcHkoeC5yaSk7CiAgICAgIHoucmouY29weSh4LnJqKTsKICAgIH0KCiAgfQoKICAvKioKICAgKiBDb25lIGVxdWF0aW9uLiBXb3JrcyB0byBrZWVwIHRoZSBnaXZlbiBib2R5IHdvcmxkIHZlY3RvcnMgYWxpZ25lZCwgb3IgdGlsdGVkIHdpdGhpbiBhIGdpdmVuIGFuZ2xlIGZyb20gZWFjaCBvdGhlci4KICAgKi8KICBjbGFzcyBDb25lRXF1YXRpb24gZXh0ZW5kcyBFcXVhdGlvbiB7CiAgICAvKioKICAgICAqIExvY2FsIGF4aXMgaW4gQQogICAgICovCgogICAgLyoqCiAgICAgKiBMb2NhbCBheGlzIGluIEIKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlICJjb25lIGFuZ2xlIiB0byBrZWVwCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBjb25zdCBtYXhGb3JjZSA9IHR5cGVvZiBvcHRpb25zLm1heEZvcmNlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMubWF4Rm9yY2UgOiAxZTY7CiAgICAgIHN1cGVyKGJvZHlBLCBib2R5QiwgLW1heEZvcmNlLCBtYXhGb3JjZSk7CiAgICAgIHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoMCwgMSwgMCk7CiAgICAgIHRoaXMuYW5nbGUgPSB0eXBlb2Ygb3B0aW9ucy5hbmdsZSAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmFuZ2xlIDogMDsKICAgIH0KCiAgICBjb21wdXRlQihoKSB7CiAgICAgIGNvbnN0IGEgPSB0aGlzLmE7CiAgICAgIGNvbnN0IGIgPSB0aGlzLmI7CiAgICAgIGNvbnN0IG5pID0gdGhpcy5heGlzQTsKICAgICAgY29uc3QgbmogPSB0aGlzLmF4aXNCOwogICAgICBjb25zdCBuaXhuaiA9IHRtcFZlYzEkMjsKICAgICAgY29uc3Qgbmp4bmkgPSB0bXBWZWMyJDI7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsgLy8gQ2FsdWNsYXRlIGNyb3NzIHByb2R1Y3RzCgogICAgICBuaS5jcm9zcyhuaiwgbml4bmopOwogICAgICBuai5jcm9zcyhuaSwgbmp4bmkpOyAvLyBUaGUgYW5nbGUgYmV0d2VlbiB0d28gdmVjdG9yIGlzOgogICAgICAvLyBjb3ModGhldGEpID0gYSAqIGIgLyAobGVuZ3RoKGEpICogbGVuZ3RoKGIpID0geyBsZW4oYSkgPSBsZW4oYikgPSAxIH0gPSBhICogYgogICAgICAvLyBnID0gYSAqIGIKICAgICAgLy8gZ2RvdCA9IChiIHggYSkgKiB3aSArIChhIHggYikgKiB3agogICAgICAvLyBHID0gWzAgYnhhIDAgYXhiXQogICAgICAvLyBXID0gW3ZpIHdpIHZqIHdqXQoKICAgICAgR0Eucm90YXRpb25hbC5jb3B5KG5qeG5pKTsKICAgICAgR0Iucm90YXRpb25hbC5jb3B5KG5peG5qKTsKICAgICAgY29uc3QgZyA9IE1hdGguY29zKHRoaXMuYW5nbGUpIC0gbmkuZG90KG5qKTsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpOwogICAgICBjb25zdCBHaU1mID0gdGhpcy5jb21wdXRlR2lNZigpOwogICAgICBjb25zdCBCID0gLWcgKiBhIC0gR1cgKiBiIC0gaCAqIEdpTWY7CiAgICAgIHJldHVybiBCOwogICAgfQoKICB9CiAgY29uc3QgdG1wVmVjMSQyID0gbmV3IFZlYzMoKTsKICBjb25zdCB0bXBWZWMyJDIgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBSb3RhdGlvbmFsIGNvbnN0cmFpbnQuIFdvcmtzIHRvIGtlZXAgdGhlIGxvY2FsIHZlY3RvcnMgb3J0aG9nb25hbCB0byBlYWNoIG90aGVyIGluIHdvcmxkIHNwYWNlLgogICAqLwogIGNsYXNzIFJvdGF0aW9uYWxFcXVhdGlvbiBleHRlbmRzIEVxdWF0aW9uIHsKICAgIC8qKgogICAgICogV29ybGQgb3JpZW50ZWQgcm90YXRpb25hbCBheGlzLgogICAgICovCgogICAgLyoqCiAgICAgKiBXb3JsZCBvcmllbnRlZCByb3RhdGlvbmFsIGF4aXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIG1heEFuZ2xlCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBjb25zdCBtYXhGb3JjZSA9IHR5cGVvZiBvcHRpb25zLm1heEZvcmNlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMubWF4Rm9yY2UgOiAxZTY7CiAgICAgIHN1cGVyKGJvZHlBLCBib2R5QiwgLW1heEZvcmNlLCBtYXhGb3JjZSk7CiAgICAgIHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoMCwgMSwgMCk7CiAgICAgIHRoaXMubWF4QW5nbGUgPSBNYXRoLlBJIC8gMjsKICAgIH0KCiAgICBjb21wdXRlQihoKSB7CiAgICAgIGNvbnN0IGEgPSB0aGlzLmE7CiAgICAgIGNvbnN0IGIgPSB0aGlzLmI7CiAgICAgIGNvbnN0IG5pID0gdGhpcy5heGlzQTsKICAgICAgY29uc3QgbmogPSB0aGlzLmF4aXNCOwogICAgICBjb25zdCBuaXhuaiA9IHRtcFZlYzEkMTsKICAgICAgY29uc3Qgbmp4bmkgPSB0bXBWZWMyJDE7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsgLy8gQ2FsdWNsYXRlIGNyb3NzIHByb2R1Y3RzCgogICAgICBuaS5jcm9zcyhuaiwgbml4bmopOwogICAgICBuai5jcm9zcyhuaSwgbmp4bmkpOyAvLyBnID0gbmkgKiBuagogICAgICAvLyBnZG90ID0gKG5qIHggbmkpICogd2kgKyAobmkgeCBuaikgKiB3agogICAgICAvLyBHID0gWzAgbmp4bmkgMCBuaXhual0KICAgICAgLy8gVyA9IFt2aSB3aSB2aiB3al0KCiAgICAgIEdBLnJvdGF0aW9uYWwuY29weShuanhuaSk7CiAgICAgIEdCLnJvdGF0aW9uYWwuY29weShuaXhuaik7CiAgICAgIGNvbnN0IGcgPSBNYXRoLmNvcyh0aGlzLm1heEFuZ2xlKSAtIG5pLmRvdChuaik7CiAgICAgIGNvbnN0IEdXID0gdGhpcy5jb21wdXRlR1coKTsKICAgICAgY29uc3QgR2lNZiA9IHRoaXMuY29tcHV0ZUdpTWYoKTsKICAgICAgY29uc3QgQiA9IC1nICogYSAtIEdXICogYiAtIGggKiBHaU1mOwogICAgICByZXR1cm4gQjsKICAgIH0KCiAgfQogIGNvbnN0IHRtcFZlYzEkMSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wVmVjMiQxID0gbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQSBDb25lIFR3aXN0IGNvbnN0cmFpbnQsIHVzZWZ1bCBmb3IgcmFnZG9sbHMuCiAgICovCiAgY2xhc3MgQ29uZVR3aXN0Q29uc3RyYWludCBleHRlbmRzIFBvaW50VG9Qb2ludENvbnN0cmFpbnQgewogICAgLyoqCiAgICAgKiBUaGUgYXhpcyBkaXJlY3Rpb24gZm9yIHRoZSBjb25zdHJhaW50IG9mIHRoZSBib2R5IEEuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBheGlzIGRpcmVjdGlvbiBmb3IgdGhlIGNvbnN0cmFpbnQgb2YgdGhlIGJvZHkgQi4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGFwZXJ0dXJlIGFuZ2xlIG9mIHRoZSBjb25lLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgdHdpc3QgYW5nbGUgb2YgdGhlIGpvaW50LgogICAgICovCiAgICBjb25zdHJ1Y3Rvcihib2R5QSwgYm9keUIsIG9wdGlvbnMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgY29uc3QgbWF4Rm9yY2UgPSB0eXBlb2Ygb3B0aW9ucy5tYXhGb3JjZSAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLm1heEZvcmNlIDogMWU2OyAvLyBTZXQgcGl2b3QgcG9pbnQgaW4gYmV0d2VlbgoKICAgICAgY29uc3QgcGl2b3RBID0gb3B0aW9ucy5waXZvdEEgPyBvcHRpb25zLnBpdm90QS5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcGl2b3RCID0gb3B0aW9ucy5waXZvdEIgPyBvcHRpb25zLnBpdm90Qi5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgc3VwZXIoYm9keUEsIHBpdm90QSwgYm9keUIsIHBpdm90QiwgbWF4Rm9yY2UpOwogICAgICB0aGlzLmF4aXNBID0gb3B0aW9ucy5heGlzQSA/IG9wdGlvbnMuYXhpc0EuY2xvbmUoKSA6IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgdGhpcy5jb2xsaWRlQ29ubmVjdGVkID0gISFvcHRpb25zLmNvbGxpZGVDb25uZWN0ZWQ7CiAgICAgIHRoaXMuYW5nbGUgPSB0eXBlb2Ygb3B0aW9ucy5hbmdsZSAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmFuZ2xlIDogMDsKICAgICAgY29uc3QgYyA9IHRoaXMuY29uZUVxdWF0aW9uID0gbmV3IENvbmVFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICBjb25zdCB0ID0gdGhpcy50d2lzdEVxdWF0aW9uID0gbmV3IFJvdGF0aW9uYWxFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICB0aGlzLnR3aXN0QW5nbGUgPSB0eXBlb2Ygb3B0aW9ucy50d2lzdEFuZ2xlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMudHdpc3RBbmdsZSA6IDA7IC8vIE1ha2UgdGhlIGNvbmUgZXF1YXRpb24gcHVzaCB0aGUgYm9kaWVzIHRvd2FyZCB0aGUgY29uZSBheGlzLCBub3Qgb3V0d2FyZAoKICAgICAgYy5tYXhGb3JjZSA9IDA7CiAgICAgIGMubWluRm9yY2UgPSAtbWF4Rm9yY2U7IC8vIE1ha2UgdGhlIHR3aXN0IGVxdWF0aW9uIGFkZCB0b3JxdWUgdG93YXJkIHRoZSBpbml0aWFsIHBvc2l0aW9uCgogICAgICB0Lm1heEZvcmNlID0gMDsKICAgICAgdC5taW5Gb3JjZSA9IC1tYXhGb3JjZTsKICAgICAgdGhpcy5lcXVhdGlvbnMucHVzaChjLCB0KTsKICAgIH0KCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICBjb25zdCBjb25lID0gdGhpcy5jb25lRXF1YXRpb247CiAgICAgIGNvbnN0IHR3aXN0ID0gdGhpcy50d2lzdEVxdWF0aW9uOwogICAgICBzdXBlci51cGRhdGUoKTsgLy8gVXBkYXRlIHRoZSBheGVzIHRvIHRoZSBjb25lIGNvbnN0cmFpbnQKCiAgICAgIGJvZHlBLnZlY3RvclRvV29ybGRGcmFtZSh0aGlzLmF4aXNBLCBjb25lLmF4aXNBKTsKICAgICAgYm9keUIudmVjdG9yVG9Xb3JsZEZyYW1lKHRoaXMuYXhpc0IsIGNvbmUuYXhpc0IpOyAvLyBVcGRhdGUgdGhlIHdvcmxkIGF4ZXMgaW4gdGhlIHR3aXN0IGNvbnN0cmFpbnQKCiAgICAgIHRoaXMuYXhpc0EudGFuZ2VudHModHdpc3QuYXhpc0EsIHR3aXN0LmF4aXNBKTsKICAgICAgYm9keUEudmVjdG9yVG9Xb3JsZEZyYW1lKHR3aXN0LmF4aXNBLCB0d2lzdC5heGlzQSk7CiAgICAgIHRoaXMuYXhpc0IudGFuZ2VudHModHdpc3QuYXhpc0IsIHR3aXN0LmF4aXNCKTsKICAgICAgYm9keUIudmVjdG9yVG9Xb3JsZEZyYW1lKHR3aXN0LmF4aXNCLCB0d2lzdC5heGlzQik7CiAgICAgIGNvbmUuYW5nbGUgPSB0aGlzLmFuZ2xlOwogICAgICB0d2lzdC5tYXhBbmdsZSA9IHRoaXMudHdpc3RBbmdsZTsKICAgIH0KCiAgfQogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQ29uc3RyYWlucyB0d28gYm9kaWVzIHRvIGJlIGF0IGEgY29uc3RhbnQgZGlzdGFuY2UgZnJvbSBlYWNoIG90aGVycyBjZW50ZXIgb2YgbWFzcy4KICAgKi8KICBjbGFzcyBEaXN0YW5jZUNvbnN0cmFpbnQgZXh0ZW5kcyBDb25zdHJhaW50IHsKICAgIC8qKgogICAgICogVGhlIGRpc3RhbmNlIHRvIGtlZXAuIElmIHVuZGVmaW5lZCwgaXQgd2lsbCBiZSBzZXQgdG8gdGhlIGN1cnJlbnQgZGlzdGFuY2UgYmV0d2VlbiBib2R5QSBhbmQgYm9keUIKICAgICAqLwoKICAgIC8qKgogICAgICogQHBhcmFtIGRpc3RhbmNlIFRoZSBkaXN0YW5jZSB0byBrZWVwLiBJZiB1bmRlZmluZWQsIGl0IHdpbGwgYmUgc2V0IHRvIHRoZSBjdXJyZW50IGRpc3RhbmNlIGJldHdlZW4gYm9keUEgYW5kIGJvZHlCLgogICAgICogQHBhcmFtIG1heEZvcmNlIFRoZSBtYXhpbXVtIGZvcmNlIHRoYXQgc2hvdWxkIGJlIGFwcGxpZWQgdG8gY29uc3RyYWluIHRoZSBib2RpZXMuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5QiwgZGlzdGFuY2UsIG1heEZvcmNlKSB7CiAgICAgIGlmIChtYXhGb3JjZSA9PT0gdm9pZCAwKSB7CiAgICAgICAgbWF4Rm9yY2UgPSAxZTY7CiAgICAgIH0KCiAgICAgIHN1cGVyKGJvZHlBLCBib2R5Qik7CgogICAgICBpZiAodHlwZW9mIGRpc3RhbmNlID09PSAndW5kZWZpbmVkJykgewogICAgICAgIGRpc3RhbmNlID0gYm9keUEucG9zaXRpb24uZGlzdGFuY2VUbyhib2R5Qi5wb3NpdGlvbik7CiAgICAgIH0KCiAgICAgIHRoaXMuZGlzdGFuY2UgPSBkaXN0YW5jZTsKICAgICAgY29uc3QgZXEgPSB0aGlzLmRpc3RhbmNlRXF1YXRpb24gPSBuZXcgQ29udGFjdEVxdWF0aW9uKGJvZHlBLCBib2R5Qik7CiAgICAgIHRoaXMuZXF1YXRpb25zLnB1c2goZXEpOyAvLyBNYWtlIGl0IGJpZGlyZWN0aW9uYWwKCiAgICAgIGVxLm1pbkZvcmNlID0gLW1heEZvcmNlOwogICAgICBlcS5tYXhGb3JjZSA9IG1heEZvcmNlOwogICAgfQogICAgLyoqCiAgICAgKiB1cGRhdGUKICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICBjb25zdCBlcSA9IHRoaXMuZGlzdGFuY2VFcXVhdGlvbjsKICAgICAgY29uc3QgaGFsZkRpc3QgPSB0aGlzLmRpc3RhbmNlICogMC41OwogICAgICBjb25zdCBub3JtYWwgPSBlcS5uaTsKICAgICAgYm9keUIucG9zaXRpb24udnN1Yihib2R5QS5wb3NpdGlvbiwgbm9ybWFsKTsKICAgICAgbm9ybWFsLm5vcm1hbGl6ZSgpOwogICAgICBub3JtYWwuc2NhbGUoaGFsZkRpc3QsIGVxLnJpKTsKICAgICAgbm9ybWFsLnNjYWxlKC1oYWxmRGlzdCwgZXEucmopOwogICAgfQoKICB9CgogIC8qKgogICAqIExvY2sgY29uc3RyYWludC4gV2lsbCByZW1vdmUgYWxsIGRlZ3JlZXMgb2YgZnJlZWRvbSBiZXR3ZWVuIHRoZSBib2RpZXMuCiAgICovCiAgY2xhc3MgTG9ja0NvbnN0cmFpbnQgZXh0ZW5kcyBQb2ludFRvUG9pbnRDb25zdHJhaW50IHsKICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBjb25zdCBtYXhGb3JjZSA9IHR5cGVvZiBvcHRpb25zLm1heEZvcmNlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMubWF4Rm9yY2UgOiAxZTY7IC8vIFNldCBwaXZvdCBwb2ludCBpbiBiZXR3ZWVuCgogICAgICBjb25zdCBwaXZvdEEgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBwaXZvdEIgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBoYWxmV2F5ID0gbmV3IFZlYzMoKTsKICAgICAgYm9keUEucG9zaXRpb24udmFkZChib2R5Qi5wb3NpdGlvbiwgaGFsZldheSk7CiAgICAgIGhhbGZXYXkuc2NhbGUoMC41LCBoYWxmV2F5KTsKICAgICAgYm9keUIucG9pbnRUb0xvY2FsRnJhbWUoaGFsZldheSwgcGl2b3RCKTsKICAgICAgYm9keUEucG9pbnRUb0xvY2FsRnJhbWUoaGFsZldheSwgcGl2b3RBKTsgLy8gVGhlIHBvaW50LXRvLXBvaW50IGNvbnN0cmFpbnQgd2lsbCBrZWVwIGEgcG9pbnQgc2hhcmVkIGJldHdlZW4gdGhlIGJvZGllcwoKICAgICAgc3VwZXIoYm9keUEsIHBpdm90QSwgYm9keUIsIHBpdm90QiwgbWF4Rm9yY2UpOyAvLyBTdG9yZSBpbml0aWFsIHJvdGF0aW9uIG9mIHRoZSBib2RpZXMgYXMgdW5pdCB2ZWN0b3JzIGluIHRoZSBsb2NhbCBib2R5IHNwYWNlcwoKICAgICAgdGhpcy54QSA9IGJvZHlBLnZlY3RvclRvTG9jYWxGcmFtZShWZWMzLlVOSVRfWCk7CiAgICAgIHRoaXMueEIgPSBib2R5Qi52ZWN0b3JUb0xvY2FsRnJhbWUoVmVjMy5VTklUX1gpOwogICAgICB0aGlzLnlBID0gYm9keUEudmVjdG9yVG9Mb2NhbEZyYW1lKFZlYzMuVU5JVF9ZKTsKICAgICAgdGhpcy55QiA9IGJvZHlCLnZlY3RvclRvTG9jYWxGcmFtZShWZWMzLlVOSVRfWSk7CiAgICAgIHRoaXMuekEgPSBib2R5QS52ZWN0b3JUb0xvY2FsRnJhbWUoVmVjMy5VTklUX1opOwogICAgICB0aGlzLnpCID0gYm9keUIudmVjdG9yVG9Mb2NhbEZyYW1lKFZlYzMuVU5JVF9aKTsgLy8gLi4uYW5kIHRoZSBmb2xsb3dpbmcgcm90YXRpb25hbCBlcXVhdGlvbnMgd2lsbCBrZWVwIGFsbCByb3RhdGlvbmFsIERPRidzIGluIHBsYWNlCgogICAgICBjb25zdCByMSA9IHRoaXMucm90YXRpb25hbEVxdWF0aW9uMSA9IG5ldyBSb3RhdGlvbmFsRXF1YXRpb24oYm9keUEsIGJvZHlCLCBvcHRpb25zKTsKICAgICAgY29uc3QgcjIgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjIgPSBuZXcgUm90YXRpb25hbEVxdWF0aW9uKGJvZHlBLCBib2R5Qiwgb3B0aW9ucyk7CiAgICAgIGNvbnN0IHIzID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24zID0gbmV3IFJvdGF0aW9uYWxFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICB0aGlzLmVxdWF0aW9ucy5wdXNoKHIxLCByMiwgcjMpOwogICAgfQogICAgLyoqCiAgICAgKiB1cGRhdGUKICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICB0aGlzLm1vdG9yRXF1YXRpb247CiAgICAgIGNvbnN0IHIxID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24xOwogICAgICBjb25zdCByMiA9IHRoaXMucm90YXRpb25hbEVxdWF0aW9uMjsKICAgICAgY29uc3QgcjMgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjM7CiAgICAgIHN1cGVyLnVwZGF0ZSgpOyAvLyBUaGVzZSB2ZWN0b3IgcGFpcnMgbXVzdCBiZSBvcnRob2dvbmFsCgogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy54QSwgcjEuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy55QiwgcjEuYXhpc0IpOwogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy55QSwgcjIuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy56QiwgcjIuYXhpc0IpOwogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy56QSwgcjMuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy54QiwgcjMuYXhpc0IpOwogICAgfQoKICB9CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwoKICAvKioKICAgKiBSb3RhdGlvbmFsIG1vdG9yIGNvbnN0cmFpbnQuIFRyaWVzIHRvIGtlZXAgdGhlIHJlbGF0aXZlIGFuZ3VsYXIgdmVsb2NpdHkgb2YgdGhlIGJvZGllcyB0byBhIGdpdmVuIHZhbHVlLgogICAqLwogIGNsYXNzIFJvdGF0aW9uYWxNb3RvckVxdWF0aW9uIGV4dGVuZHMgRXF1YXRpb24gewogICAgLyoqCiAgICAgKiBXb3JsZCBvcmllbnRlZCByb3RhdGlvbmFsIGF4aXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdvcmxkIG9yaWVudGVkIHJvdGF0aW9uYWwgYXhpcy4KICAgICAqLwoKICAgIC8qKgogICAgICogTW90b3IgdmVsb2NpdHkuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5QiwgbWF4Rm9yY2UpIHsKICAgICAgaWYgKG1heEZvcmNlID09PSB2b2lkIDApIHsKICAgICAgICBtYXhGb3JjZSA9IDFlNjsKICAgICAgfQoKICAgICAgc3VwZXIoYm9keUEsIGJvZHlCLCAtbWF4Rm9yY2UsIG1heEZvcmNlKTsKICAgICAgdGhpcy5heGlzQSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuYXhpc0IgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnRhcmdldFZlbG9jaXR5ID0gMDsKICAgIH0KCiAgICBjb21wdXRlQihoKSB7CiAgICAgIHRoaXMuYTsKICAgICAgY29uc3QgYiA9IHRoaXMuYjsKICAgICAgdGhpcy5iaTsKICAgICAgdGhpcy5iajsKICAgICAgY29uc3QgYXhpc0EgPSB0aGlzLmF4aXNBOwogICAgICBjb25zdCBheGlzQiA9IHRoaXMuYXhpc0I7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsgLy8gZyA9IDAKICAgICAgLy8gZ2RvdCA9IGF4aXNBICogd2kgLSBheGlzQiAqIHdqCiAgICAgIC8vIGdkb3QgPSBHICogVyA9IEcgKiBbdmkgd2kgdmogd2pdCiAgICAgIC8vID0+CiAgICAgIC8vIEcgPSBbMCBheGlzQSAwIC1heGlzQl0KCiAgICAgIEdBLnJvdGF0aW9uYWwuY29weShheGlzQSk7CiAgICAgIGF4aXNCLm5lZ2F0ZShHQi5yb3RhdGlvbmFsKTsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpIC0gdGhpcy50YXJnZXRWZWxvY2l0eTsKICAgICAgY29uc3QgR2lNZiA9IHRoaXMuY29tcHV0ZUdpTWYoKTsKICAgICAgY29uc3QgQiA9IC1HVyAqIGIgLSBoICogR2lNZjsKICAgICAgcmV0dXJuIEI7CiAgICB9CgogIH0KCiAgLyoqCiAgICogSGluZ2UgY29uc3RyYWludC4gVGhpbmsgb2YgaXQgYXMgYSBkb29yIGhpbmdlLiBJdCB0cmllcyB0byBrZWVwIHRoZSBkb29yIGluIHRoZSBjb3JyZWN0IHBsYWNlIGFuZCB3aXRoIHRoZSBjb3JyZWN0IG9yaWVudGF0aW9uLgogICAqLwogIGNsYXNzIEhpbmdlQ29uc3RyYWludCBleHRlbmRzIFBvaW50VG9Qb2ludENvbnN0cmFpbnQgewogICAgLyoqCiAgICAgKiBSb3RhdGlvbiBheGlzLCBkZWZpbmVkIGxvY2FsbHkgaW4gYm9keUEuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFJvdGF0aW9uIGF4aXMsIGRlZmluZWQgbG9jYWxseSBpbiBib2R5Qi4KICAgICAqLwogICAgY29uc3RydWN0b3IoYm9keUEsIGJvZHlCLCBvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIGNvbnN0IG1heEZvcmNlID0gdHlwZW9mIG9wdGlvbnMubWF4Rm9yY2UgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5tYXhGb3JjZSA6IDFlNjsKICAgICAgY29uc3QgcGl2b3RBID0gb3B0aW9ucy5waXZvdEEgPyBvcHRpb25zLnBpdm90QS5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcGl2b3RCID0gb3B0aW9ucy5waXZvdEIgPyBvcHRpb25zLnBpdm90Qi5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgc3VwZXIoYm9keUEsIHBpdm90QSwgYm9keUIsIHBpdm90QiwgbWF4Rm9yY2UpOwogICAgICBjb25zdCBheGlzQSA9IHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIGF4aXNBLm5vcm1hbGl6ZSgpOwogICAgICBjb25zdCBheGlzQiA9IHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIGF4aXNCLm5vcm1hbGl6ZSgpOwogICAgICB0aGlzLmNvbGxpZGVDb25uZWN0ZWQgPSAhIW9wdGlvbnMuY29sbGlkZUNvbm5lY3RlZDsKICAgICAgY29uc3Qgcm90YXRpb25hbDEgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjEgPSBuZXcgUm90YXRpb25hbEVxdWF0aW9uKGJvZHlBLCBib2R5Qiwgb3B0aW9ucyk7CiAgICAgIGNvbnN0IHJvdGF0aW9uYWwyID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24yID0gbmV3IFJvdGF0aW9uYWxFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICBjb25zdCBtb3RvciA9IHRoaXMubW90b3JFcXVhdGlvbiA9IG5ldyBSb3RhdGlvbmFsTW90b3JFcXVhdGlvbihib2R5QSwgYm9keUIsIG1heEZvcmNlKTsKICAgICAgbW90b3IuZW5hYmxlZCA9IGZhbHNlOyAvLyBOb3QgZW5hYmxlZCBieSBkZWZhdWx0CiAgICAgIC8vIEVxdWF0aW9ucyB0byBiZSBmZWQgdG8gdGhlIHNvbHZlcgoKICAgICAgdGhpcy5lcXVhdGlvbnMucHVzaChyb3RhdGlvbmFsMSwgcm90YXRpb25hbDIsIG1vdG9yKTsKICAgIH0KICAgIC8qKgogICAgICogZW5hYmxlTW90b3IKICAgICAqLwoKCiAgICBlbmFibGVNb3RvcigpIHsKICAgICAgdGhpcy5tb3RvckVxdWF0aW9uLmVuYWJsZWQgPSB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBkaXNhYmxlTW90b3IKICAgICAqLwoKCiAgICBkaXNhYmxlTW90b3IoKSB7CiAgICAgIHRoaXMubW90b3JFcXVhdGlvbi5lbmFibGVkID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIHNldE1vdG9yU3BlZWQKICAgICAqLwoKCiAgICBzZXRNb3RvclNwZWVkKHNwZWVkKSB7CiAgICAgIHRoaXMubW90b3JFcXVhdGlvbi50YXJnZXRWZWxvY2l0eSA9IHNwZWVkOwogICAgfQogICAgLyoqCiAgICAgKiBzZXRNb3Rvck1heEZvcmNlCiAgICAgKi8KCgogICAgc2V0TW90b3JNYXhGb3JjZShtYXhGb3JjZSkgewogICAgICB0aGlzLm1vdG9yRXF1YXRpb24ubWF4Rm9yY2UgPSBtYXhGb3JjZTsKICAgICAgdGhpcy5tb3RvckVxdWF0aW9uLm1pbkZvcmNlID0gLW1heEZvcmNlOwogICAgfQogICAgLyoqCiAgICAgKiB1cGRhdGUKICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICBjb25zdCBtb3RvciA9IHRoaXMubW90b3JFcXVhdGlvbjsKICAgICAgY29uc3QgcjEgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjE7CiAgICAgIGNvbnN0IHIyID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24yOwogICAgICBjb25zdCB3b3JsZEF4aXNBID0gSGluZ2VDb25zdHJhaW50X3VwZGF0ZV90bXBWZWMxOwogICAgICBjb25zdCB3b3JsZEF4aXNCID0gSGluZ2VDb25zdHJhaW50X3VwZGF0ZV90bXBWZWMyOwogICAgICBjb25zdCBheGlzQSA9IHRoaXMuYXhpc0E7CiAgICAgIGNvbnN0IGF4aXNCID0gdGhpcy5heGlzQjsKICAgICAgc3VwZXIudXBkYXRlKCk7IC8vIEdldCB3b3JsZCBheGVzCgogICAgICBib2R5QS5xdWF0ZXJuaW9uLnZtdWx0KGF4aXNBLCB3b3JsZEF4aXNBKTsKICAgICAgYm9keUIucXVhdGVybmlvbi52bXVsdChheGlzQiwgd29ybGRBeGlzQik7CiAgICAgIHdvcmxkQXhpc0EudGFuZ2VudHMocjEuYXhpc0EsIHIyLmF4aXNBKTsKICAgICAgcjEuYXhpc0IuY29weSh3b3JsZEF4aXNCKTsKICAgICAgcjIuYXhpc0IuY29weSh3b3JsZEF4aXNCKTsKCiAgICAgIGlmICh0aGlzLm1vdG9yRXF1YXRpb24uZW5hYmxlZCkgewogICAgICAgIGJvZHlBLnF1YXRlcm5pb24udm11bHQodGhpcy5heGlzQSwgbW90b3IuYXhpc0EpOwogICAgICAgIGJvZHlCLnF1YXRlcm5pb24udm11bHQodGhpcy5heGlzQiwgbW90b3IuYXhpc0IpOwogICAgICB9CiAgICB9CgogIH0KICBjb25zdCBIaW5nZUNvbnN0cmFpbnRfdXBkYXRlX3RtcFZlYzEgPSBuZXcgVmVjMygpOwogIGNvbnN0IEhpbmdlQ29uc3RyYWludF91cGRhdGVfdG1wVmVjMiA9IG5ldyBWZWMzKCk7CgogIC8qKgogICAqIENvbnN0cmFpbnMgdGhlIHNsaXBwaW5nIGluIGEgY29udGFjdCBhbG9uZyBhIHRhbmdlbnQKICAgKi8KICBjbGFzcyBGcmljdGlvbkVxdWF0aW9uIGV4dGVuZHMgRXF1YXRpb24gewogICAgLy8gVGFuZ2VudAoKICAgIC8qKgogICAgICogQHBhcmFtIHNsaXBGb3JjZSBzaG91bGQgYmUgKy1GX2ZyaWN0aW9uID0gKy1tdSAqIEZfbm9ybWFsID0gKy1tdSAqIG0gKiBnCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgc2xpcEZvcmNlKSB7CiAgICAgIHN1cGVyKGJvZHlBLCBib2R5QiwgLXNsaXBGb3JjZSwgc2xpcEZvcmNlKTsKICAgICAgdGhpcy5yaSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMucmogPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnQgPSBuZXcgVmVjMygpOwogICAgfQoKICAgIGNvbXB1dGVCKGgpIHsKICAgICAgdGhpcy5hOwogICAgICBjb25zdCBiID0gdGhpcy5iOwogICAgICB0aGlzLmJpOwogICAgICB0aGlzLmJqOwogICAgICBjb25zdCByaSA9IHRoaXMucmk7CiAgICAgIGNvbnN0IHJqID0gdGhpcy5yajsKICAgICAgY29uc3Qgcml4dCA9IEZyaWN0aW9uRXF1YXRpb25fY29tcHV0ZUJfdGVtcDE7CiAgICAgIGNvbnN0IHJqeHQgPSBGcmljdGlvbkVxdWF0aW9uX2NvbXB1dGVCX3RlbXAyOwogICAgICBjb25zdCB0ID0gdGhpcy50OyAvLyBDYWx1Y2xhdGUgY3Jvc3MgcHJvZHVjdHMKCiAgICAgIHJpLmNyb3NzKHQsIHJpeHQpOwogICAgICByai5jcm9zcyh0LCByanh0KTsgLy8gRyA9IFstdCAtcml4dCB0IHJqeHRdCiAgICAgIC8vIEFuZCByZW1lbWJlciwgdGhpcyBpcyBhIHB1cmUgdmVsb2NpdHkgY29uc3RyYWludCwgZyBpcyBhbHdheXMgemVybyEKCiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsKICAgICAgdC5uZWdhdGUoR0Euc3BhdGlhbCk7CiAgICAgIHJpeHQubmVnYXRlKEdBLnJvdGF0aW9uYWwpOwogICAgICBHQi5zcGF0aWFsLmNvcHkodCk7CiAgICAgIEdCLnJvdGF0aW9uYWwuY29weShyanh0KTsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpOwogICAgICBjb25zdCBHaU1mID0gdGhpcy5jb21wdXRlR2lNZigpOwogICAgICBjb25zdCBCID0gLUdXICogYiAtIGggKiBHaU1mOwogICAgICByZXR1cm4gQjsKICAgIH0KCiAgfQogIGNvbnN0IEZyaWN0aW9uRXF1YXRpb25fY29tcHV0ZUJfdGVtcDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IEZyaWN0aW9uRXF1YXRpb25fY29tcHV0ZUJfdGVtcDIgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBEZWZpbmVzIHdoYXQgaGFwcGVucyB3aGVuIHR3byBtYXRlcmlhbHMgbWVldC4KICAgKiBAdG9kbyBSZWZhY3RvciBtYXRlcmlhbHMgdG8gbWF0ZXJpYWxBIGFuZCBtYXRlcmlhbEIKICAgKi8KICBjbGFzcyBDb250YWN0TWF0ZXJpYWwgewogICAgLyoqCiAgICAgKiBJZGVudGlmaWVyIG9mIHRoaXMgbWF0ZXJpYWwuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFBhcnRpY2lwYXRpbmcgbWF0ZXJpYWxzLgogICAgICovCgogICAgLyoqCiAgICAgKiBGcmljdGlvbiBjb2VmZmljaWVudC4KICAgICAqIEBkZWZhdWx0IDAuMwogICAgICovCgogICAgLyoqCiAgICAgKiBSZXN0aXR1dGlvbiBjb2VmZmljaWVudC4KICAgICAqIEBkZWZhdWx0IDAuMwogICAgICovCgogICAgLyoqCiAgICAgKiBTdGlmZm5lc3Mgb2YgdGhlIHByb2R1Y2VkIGNvbnRhY3QgZXF1YXRpb25zLgogICAgICogQGRlZmF1bHQgMWU3CiAgICAgKi8KCiAgICAvKioKICAgICAqIFJlbGF4YXRpb24gdGltZSBvZiB0aGUgcHJvZHVjZWQgY29udGFjdCBlcXVhdGlvbnMuCiAgICAgKiBAZGVmYXVsdCAzCiAgICAgKi8KCiAgICAvKioKICAgICAqIFN0aWZmbmVzcyBvZiB0aGUgcHJvZHVjZWQgZnJpY3Rpb24gZXF1YXRpb25zLgogICAgICogQGRlZmF1bHQgMWU3CiAgICAgKi8KCiAgICAvKioKICAgICAqIFJlbGF4YXRpb24gdGltZSBvZiB0aGUgcHJvZHVjZWQgZnJpY3Rpb24gZXF1YXRpb25zCiAgICAgKiBAZGVmYXVsdCAzCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG0xLCBtMiwgb3B0aW9ucykgewogICAgICBvcHRpb25zID0gVXRpbHMuZGVmYXVsdHMob3B0aW9ucywgewogICAgICAgIGZyaWN0aW9uOiAwLjMsCiAgICAgICAgcmVzdGl0dXRpb246IDAuMywKICAgICAgICBjb250YWN0RXF1YXRpb25TdGlmZm5lc3M6IDFlNywKICAgICAgICBjb250YWN0RXF1YXRpb25SZWxheGF0aW9uOiAzLAogICAgICAgIGZyaWN0aW9uRXF1YXRpb25TdGlmZm5lc3M6IDFlNywKICAgICAgICBmcmljdGlvbkVxdWF0aW9uUmVsYXhhdGlvbjogMwogICAgICB9KTsKICAgICAgdGhpcy5pZCA9IENvbnRhY3RNYXRlcmlhbC5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5tYXRlcmlhbHMgPSBbbTEsIG0yXTsKICAgICAgdGhpcy5mcmljdGlvbiA9IG9wdGlvbnMuZnJpY3Rpb247CiAgICAgIHRoaXMucmVzdGl0dXRpb24gPSBvcHRpb25zLnJlc3RpdHV0aW9uOwogICAgICB0aGlzLmNvbnRhY3RFcXVhdGlvblN0aWZmbmVzcyA9IG9wdGlvbnMuY29udGFjdEVxdWF0aW9uU3RpZmZuZXNzOwogICAgICB0aGlzLmNvbnRhY3RFcXVhdGlvblJlbGF4YXRpb24gPSBvcHRpb25zLmNvbnRhY3RFcXVhdGlvblJlbGF4YXRpb247CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcyA9IG9wdGlvbnMuZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzczsKICAgICAgdGhpcy5mcmljdGlvbkVxdWF0aW9uUmVsYXhhdGlvbiA9IG9wdGlvbnMuZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb247CiAgICB9CgogIH0KICBDb250YWN0TWF0ZXJpYWwuaWRDb3VudGVyID0gMDsKCiAgLyoqCiAgICogRGVmaW5lcyBhIHBoeXNpY3MgbWF0ZXJpYWwuCiAgICovCiAgY2xhc3MgTWF0ZXJpYWwgewogICAgLyoqCiAgICAgKiBNYXRlcmlhbCBuYW1lLgogICAgICogSWYgb3B0aW9ucyBpcyBhIHN0cmluZywgbmFtZSB3aWxsIGJlIHNldCB0byB0aGF0IHN0cmluZy4KICAgICAqIEB0b2RvIERlcHJlY2F0ZSB0aGlzCiAgICAgKi8KCiAgICAvKiogTWF0ZXJpYWwgaWQuICovCgogICAgLyoqCiAgICAgKiBGcmljdGlvbiBmb3IgdGhpcyBtYXRlcmlhbC4KICAgICAqIElmIG5vbi1uZWdhdGl2ZSwgaXQgd2lsbCBiZSB1c2VkIGluc3RlYWQgb2YgdGhlIGZyaWN0aW9uIGdpdmVuIGJ5IENvbnRhY3RNYXRlcmlhbHMuIElmIHRoZXJlJ3Mgbm8gbWF0Y2hpbmcgQ29udGFjdE1hdGVyaWFsLCB0aGUgdmFsdWUgZnJvbSBgZGVmYXVsdENvbnRhY3RNYXRlcmlhbGAgaW4gdGhlIFdvcmxkIHdpbGwgYmUgdXNlZC4KICAgICAqLwoKICAgIC8qKgogICAgICogUmVzdGl0dXRpb24gZm9yIHRoaXMgbWF0ZXJpYWwuCiAgICAgKiBJZiBub24tbmVnYXRpdmUsIGl0IHdpbGwgYmUgdXNlZCBpbnN0ZWFkIG9mIHRoZSByZXN0aXR1dGlvbiBnaXZlbiBieSBDb250YWN0TWF0ZXJpYWxzLiBJZiB0aGVyZSdzIG5vIG1hdGNoaW5nIENvbnRhY3RNYXRlcmlhbCwgdGhlIHZhbHVlIGZyb20gYGRlZmF1bHRDb250YWN0TWF0ZXJpYWxgIGluIHRoZSBXb3JsZCB3aWxsIGJlIHVzZWQuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgbGV0IG5hbWUgPSAnJzsgLy8gQmFja3dhcmRzIGNvbXBhdGliaWxpdHkgZml4CgogICAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgLy9jb25zb2xlLndhcm4oYFBhc3NpbmcgYSBzdHJpbmcgdG8gTWF0ZXJpYWxPcHRpb25zIGlzIGRlcHJlY2F0ZWQsIGFuZCBoYXMgbm8gZWZmZWN0YCkKICAgICAgICBuYW1lID0gb3B0aW9uczsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIHRoaXMubmFtZSA9IG5hbWU7CiAgICAgIHRoaXMuaWQgPSBNYXRlcmlhbC5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5mcmljdGlvbiA9IHR5cGVvZiBvcHRpb25zLmZyaWN0aW9uICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuZnJpY3Rpb24gOiAtMTsKICAgICAgdGhpcy5yZXN0aXR1dGlvbiA9IHR5cGVvZiBvcHRpb25zLnJlc3RpdHV0aW9uICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMucmVzdGl0dXRpb24gOiAtMTsKICAgIH0KCiAgfQogIE1hdGVyaWFsLmlkQ291bnRlciA9IDA7CgogIC8qKgogICAqIEEgc3ByaW5nLCBjb25uZWN0aW5nIHR3byBib2RpZXMuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3Qgc3ByaW5nID0gbmV3IFNwcmluZyhib3hCb2R5LCBzcGhlcmVCb2R5LCB7CiAgICogICAgICAgcmVzdExlbmd0aDogMCwKICAgKiAgICAgICBzdGlmZm5lc3M6IDUwLAogICAqICAgICAgIGRhbXBpbmc6IDEsCiAgICogICAgIH0pCiAgICoKICAgKiAgICAgLy8gQ29tcHV0ZSB0aGUgZm9yY2UgYWZ0ZXIgZWFjaCBzdGVwCiAgICogICAgIHdvcmxkLmFkZEV2ZW50TGlzdGVuZXIoJ3Bvc3RTdGVwJywgKGV2ZW50KSA9PiB7CiAgICogICAgICAgc3ByaW5nLmFwcGx5Rm9yY2UoKQogICAqICAgICB9KQogICAqLwogIGNsYXNzIFNwcmluZyB7CiAgICAvKioKICAgICAqIFJlc3QgbGVuZ3RoIG9mIHRoZSBzcHJpbmcuIEEgbnVtYmVyID4gMC4KICAgICAqIEBkZWZhdWx0IDEKICAgICAqLwoKICAgIC8qKgogICAgICogU3RpZmZuZXNzIG9mIHRoZSBzcHJpbmcuIEEgbnVtYmVyID49IDAuCiAgICAgKiBAZGVmYXVsdCAxMDAKICAgICAqLwoKICAgIC8qKgogICAgICogRGFtcGluZyBvZiB0aGUgc3ByaW5nLiBBIG51bWJlciA+PSAwLgogICAgICogQGRlZmF1bHQgMQogICAgICovCgogICAgLyoqCiAgICAgKiBGaXJzdCBjb25uZWN0ZWQgYm9keS4KICAgICAqLwoKICAgIC8qKgogICAgICogU2Vjb25kIGNvbm5lY3RlZCBib2R5LgogICAgICovCgogICAgLyoqCiAgICAgKiBBbmNob3IgZm9yIGJvZHlBIGluIGxvY2FsIGJvZHlBIGNvb3JkaW5hdGVzLgogICAgICogV2hlcmUgdG8gaG9vayB0aGUgc3ByaW5nIHRvIGJvZHkgQSwgaW4gbG9jYWwgYm9keSBjb29yZGluYXRlcy4KICAgICAqIEBkZWZhdWx0IG5ldyBWZWMzKCkKICAgICAqLwoKICAgIC8qKgogICAgICogQW5jaG9yIGZvciBib2R5QiBpbiBsb2NhbCBib2R5QiBjb29yZGluYXRlcy4KICAgICAqIFdoZXJlIHRvIGhvb2sgdGhlIHNwcmluZyB0byBib2R5IEIsIGluIGxvY2FsIGJvZHkgY29vcmRpbmF0ZXMuCiAgICAgKiBAZGVmYXVsdCBuZXcgVmVjMygpCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICB0aGlzLnJlc3RMZW5ndGggPSB0eXBlb2Ygb3B0aW9ucy5yZXN0TGVuZ3RoID09PSAnbnVtYmVyJyA/IG9wdGlvbnMucmVzdExlbmd0aCA6IDE7CiAgICAgIHRoaXMuc3RpZmZuZXNzID0gb3B0aW9ucy5zdGlmZm5lc3MgfHwgMTAwOwogICAgICB0aGlzLmRhbXBpbmcgPSBvcHRpb25zLmRhbXBpbmcgfHwgMTsKICAgICAgdGhpcy5ib2R5QSA9IGJvZHlBOwogICAgICB0aGlzLmJvZHlCID0gYm9keUI7CiAgICAgIHRoaXMubG9jYWxBbmNob3JBID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5sb2NhbEFuY2hvckIgPSBuZXcgVmVjMygpOwoKICAgICAgaWYgKG9wdGlvbnMubG9jYWxBbmNob3JBKSB7CiAgICAgICAgdGhpcy5sb2NhbEFuY2hvckEuY29weShvcHRpb25zLmxvY2FsQW5jaG9yQSk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLmxvY2FsQW5jaG9yQikgewogICAgICAgIHRoaXMubG9jYWxBbmNob3JCLmNvcHkob3B0aW9ucy5sb2NhbEFuY2hvckIpOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy53b3JsZEFuY2hvckEpIHsKICAgICAgICB0aGlzLnNldFdvcmxkQW5jaG9yQShvcHRpb25zLndvcmxkQW5jaG9yQSk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLndvcmxkQW5jaG9yQikgewogICAgICAgIHRoaXMuc2V0V29ybGRBbmNob3JCKG9wdGlvbnMud29ybGRBbmNob3JCKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIGFuY2hvciBwb2ludCBvbiBib2R5IEEsIHVzaW5nIHdvcmxkIGNvb3JkaW5hdGVzLgogICAgICovCgoKICAgIHNldFdvcmxkQW5jaG9yQSh3b3JsZEFuY2hvckEpIHsKICAgICAgdGhpcy5ib2R5QS5wb2ludFRvTG9jYWxGcmFtZSh3b3JsZEFuY2hvckEsIHRoaXMubG9jYWxBbmNob3JBKTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBhbmNob3IgcG9pbnQgb24gYm9keSBCLCB1c2luZyB3b3JsZCBjb29yZGluYXRlcy4KICAgICAqLwoKCiAgICBzZXRXb3JsZEFuY2hvckIod29ybGRBbmNob3JCKSB7CiAgICAgIHRoaXMuYm9keUIucG9pbnRUb0xvY2FsRnJhbWUod29ybGRBbmNob3JCLCB0aGlzLmxvY2FsQW5jaG9yQik7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgYW5jaG9yIHBvaW50IG9uIGJvZHkgQSwgaW4gd29ybGQgY29vcmRpbmF0ZXMuCiAgICAgKiBAcGFyYW0gcmVzdWx0IFRoZSB2ZWN0b3IgdG8gc3RvcmUgdGhlIHJlc3VsdCBpbi4KICAgICAqLwoKCiAgICBnZXRXb3JsZEFuY2hvckEocmVzdWx0KSB7CiAgICAgIHRoaXMuYm9keUEucG9pbnRUb1dvcmxkRnJhbWUodGhpcy5sb2NhbEFuY2hvckEsIHJlc3VsdCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgYW5jaG9yIHBvaW50IG9uIGJvZHkgQiwgaW4gd29ybGQgY29vcmRpbmF0ZXMuCiAgICAgKiBAcGFyYW0gcmVzdWx0IFRoZSB2ZWN0b3IgdG8gc3RvcmUgdGhlIHJlc3VsdCBpbi4KICAgICAqLwoKCiAgICBnZXRXb3JsZEFuY2hvckIocmVzdWx0KSB7CiAgICAgIHRoaXMuYm9keUIucG9pbnRUb1dvcmxkRnJhbWUodGhpcy5sb2NhbEFuY2hvckIsIHJlc3VsdCk7CiAgICB9CiAgICAvKioKICAgICAqIEFwcGx5IHRoZSBzcHJpbmcgZm9yY2UgdG8gdGhlIGNvbm5lY3RlZCBib2RpZXMuCiAgICAgKi8KCgogICAgYXBwbHlGb3JjZSgpIHsKICAgICAgY29uc3QgayA9IHRoaXMuc3RpZmZuZXNzOwogICAgICBjb25zdCBkID0gdGhpcy5kYW1waW5nOwogICAgICBjb25zdCBsID0gdGhpcy5yZXN0TGVuZ3RoOwogICAgICBjb25zdCBib2R5QSA9IHRoaXMuYm9keUE7CiAgICAgIGNvbnN0IGJvZHlCID0gdGhpcy5ib2R5QjsKICAgICAgY29uc3QgciA9IGFwcGx5Rm9yY2VfcjsKICAgICAgY29uc3Qgcl91bml0ID0gYXBwbHlGb3JjZV9yX3VuaXQ7CiAgICAgIGNvbnN0IHUgPSBhcHBseUZvcmNlX3U7CiAgICAgIGNvbnN0IGYgPSBhcHBseUZvcmNlX2Y7CiAgICAgIGNvbnN0IHRtcCA9IGFwcGx5Rm9yY2VfdG1wOwogICAgICBjb25zdCB3b3JsZEFuY2hvckEgPSBhcHBseUZvcmNlX3dvcmxkQW5jaG9yQTsKICAgICAgY29uc3Qgd29ybGRBbmNob3JCID0gYXBwbHlGb3JjZV93b3JsZEFuY2hvckI7CiAgICAgIGNvbnN0IHJpID0gYXBwbHlGb3JjZV9yaTsKICAgICAgY29uc3QgcmogPSBhcHBseUZvcmNlX3JqOwogICAgICBjb25zdCByaV94X2YgPSBhcHBseUZvcmNlX3JpX3hfZjsKICAgICAgY29uc3QgcmpfeF9mID0gYXBwbHlGb3JjZV9yal94X2Y7IC8vIEdldCB3b3JsZCBhbmNob3JzCgogICAgICB0aGlzLmdldFdvcmxkQW5jaG9yQSh3b3JsZEFuY2hvckEpOwogICAgICB0aGlzLmdldFdvcmxkQW5jaG9yQih3b3JsZEFuY2hvckIpOyAvLyBHZXQgb2Zmc2V0IHBvaW50cwoKICAgICAgd29ybGRBbmNob3JBLnZzdWIoYm9keUEucG9zaXRpb24sIHJpKTsKICAgICAgd29ybGRBbmNob3JCLnZzdWIoYm9keUIucG9zaXRpb24sIHJqKTsgLy8gQ29tcHV0ZSBkaXN0YW5jZSB2ZWN0b3IgYmV0d2VlbiB3b3JsZCBhbmNob3IgcG9pbnRzCgogICAgICB3b3JsZEFuY2hvckIudnN1Yih3b3JsZEFuY2hvckEsIHIpOwogICAgICBjb25zdCBybGVuID0gci5sZW5ndGgoKTsKICAgICAgcl91bml0LmNvcHkocik7CiAgICAgIHJfdW5pdC5ub3JtYWxpemUoKTsgLy8gQ29tcHV0ZSByZWxhdGl2ZSB2ZWxvY2l0eSBvZiB0aGUgYW5jaG9yIHBvaW50cywgdQoKICAgICAgYm9keUIudmVsb2NpdHkudnN1Yihib2R5QS52ZWxvY2l0eSwgdSk7IC8vIEFkZCByb3RhdGlvbmFsIHZlbG9jaXR5CgogICAgICBib2R5Qi5hbmd1bGFyVmVsb2NpdHkuY3Jvc3MocmosIHRtcCk7CiAgICAgIHUudmFkZCh0bXAsIHUpOwogICAgICBib2R5QS5hbmd1bGFyVmVsb2NpdHkuY3Jvc3MocmksIHRtcCk7CiAgICAgIHUudnN1Yih0bXAsIHUpOyAvLyBGID0gLSBrICogKCB4IC0gTCApIC0gRCAqICggdSApCgogICAgICByX3VuaXQuc2NhbGUoLWsgKiAocmxlbiAtIGwpIC0gZCAqIHUuZG90KHJfdW5pdCksIGYpOyAvLyBBZGQgZm9yY2VzIHRvIGJvZGllcwoKICAgICAgYm9keUEuZm9yY2UudnN1YihmLCBib2R5QS5mb3JjZSk7CiAgICAgIGJvZHlCLmZvcmNlLnZhZGQoZiwgYm9keUIuZm9yY2UpOyAvLyBBbmd1bGFyIGZvcmNlCgogICAgICByaS5jcm9zcyhmLCByaV94X2YpOwogICAgICByai5jcm9zcyhmLCByal94X2YpOwogICAgICBib2R5QS50b3JxdWUudnN1YihyaV94X2YsIGJvZHlBLnRvcnF1ZSk7CiAgICAgIGJvZHlCLnRvcnF1ZS52YWRkKHJqX3hfZiwgYm9keUIudG9ycXVlKTsKICAgIH0KCiAgfQogIGNvbnN0IGFwcGx5Rm9yY2VfciA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV9yX3VuaXQgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2VfdSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV9mID0gbmV3IFZlYzMoKTsKICBjb25zdCBhcHBseUZvcmNlX3dvcmxkQW5jaG9yQSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV93b3JsZEFuY2hvckIgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2VfcmkgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2VfcmogPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2VfcmlfeF9mID0gbmV3IFZlYzMoKTsKICBjb25zdCBhcHBseUZvcmNlX3JqX3hfZiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV90bXAgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBXaGVlbEluZm8KICAgKi8KICBjbGFzcyBXaGVlbEluZm8gewogICAgLyoqCiAgICAgKiBNYXggdHJhdmVsIGRpc3RhbmNlIG9mIHRoZSBzdXNwZW5zaW9uLCBpbiBtZXRlcnMuCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNwZWVkIHRvIGFwcGx5IHRvIHRoZSB3aGVlbCByb3RhdGlvbiB3aGVuIHRoZSB3aGVlbCBpcyBzbGlkaW5nLgogICAgICogQGRlZmF1bHQgLTAuMQogICAgICovCgogICAgLyoqCiAgICAgKiBJZiB0aGUgY3VzdG9tU2xpZGluZ1JvdGF0aW9uYWxTcGVlZCBzaG91bGQgYmUgdXNlZC4KICAgICAqIEBkZWZhdWx0IGZhbHNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIHNsaWRpbmcKICAgICAqLwoKICAgIC8qKgogICAgICogQ29ubmVjdGlvbiBwb2ludCwgZGVmaW5lZCBsb2NhbGx5IGluIHRoZSBjaGFzc2lzIGJvZHkgZnJhbWUuCiAgICAgKi8KCiAgICAvKioKICAgICAqIGNoYXNzaXNDb25uZWN0aW9uUG9pbnRXb3JsZAogICAgICovCgogICAgLyoqCiAgICAgKiBkaXJlY3Rpb25Mb2NhbAogICAgICovCgogICAgLyoqCiAgICAgKiBkaXJlY3Rpb25Xb3JsZAogICAgICovCgogICAgLyoqCiAgICAgKiBheGxlTG9jYWwKICAgICAqLwoKICAgIC8qKgogICAgICogYXhsZVdvcmxkCiAgICAgKi8KCiAgICAvKioKICAgICAqIHN1c3BlbnNpb25SZXN0TGVuZ3RoCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIHN1c3BlbnNpb25NYXhMZW5ndGgKICAgICAqIEBkZWZhdWx0IDIKICAgICAqLwoKICAgIC8qKgogICAgICogcmFkaXVzCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIHN1c3BlbnNpb25TdGlmZm5lc3MKICAgICAqIEBkZWZhdWx0IDEwMAogICAgICovCgogICAgLyoqCiAgICAgKiBkYW1waW5nQ29tcHJlc3Npb24KICAgICAqIEBkZWZhdWx0IDEwCiAgICAgKi8KCiAgICAvKioKICAgICAqIGRhbXBpbmdSZWxheGF0aW9uCiAgICAgKiBAZGVmYXVsdCAxMAogICAgICovCgogICAgLyoqCiAgICAgKiBmcmljdGlvblNsaXAKICAgICAqIEBkZWZhdWx0IDEwLjUKICAgICAqLwoKICAgIC8qKiBmb3J3YXJkQWNjZWxlcmF0aW9uICovCgogICAgLyoqIHNpZGVBY2NlbGVyYXRpb24gKi8KCiAgICAvKioKICAgICAqIHN0ZWVyaW5nCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIFJvdGF0aW9uIHZhbHVlLCBpbiByYWRpYW5zLgogICAgICogQGRlZmF1bHQgMAogICAgICovCgogICAgLyoqCiAgICAgKiBkZWx0YVJvdGF0aW9uCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIHJvbGxJbmZsdWVuY2UKICAgICAqIEBkZWZhdWx0IDAuMDEKICAgICAqLwoKICAgIC8qKgogICAgICogbWF4U3VzcGVuc2lvbkZvcmNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGVuZ2luZUZvcmNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGJyYWtlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGlzRnJvbnRXaGVlbAogICAgICogQGRlZmF1bHQgdHJ1ZQogICAgICovCgogICAgLyoqCiAgICAgKiBjbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24KICAgICAqIEBkZWZhdWx0IDEKICAgICAqLwoKICAgIC8qKgogICAgICogc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHkKICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwoKICAgIC8qKgogICAgICogc3VzcGVuc2lvbkZvcmNlCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIHNsaXBJbmZvCiAgICAgKi8KCiAgICAvKioKICAgICAqIHNraWRJbmZvCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIHN1c3BlbnNpb25MZW5ndGgKICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwoKICAgIC8qKgogICAgICogc2lkZUltcHVsc2UKICAgICAqLwoKICAgIC8qKgogICAgICogZm9yd2FyZEltcHVsc2UKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHJlc3VsdCBmcm9tIHJheWNhc3RpbmcuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZWVsIHdvcmxkIHRyYW5zZm9ybS4KICAgICAqLwoKICAgIC8qKgogICAgICogaXNJbkNvbnRhY3QKICAgICAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBvcHRpb25zID0gVXRpbHMuZGVmYXVsdHMob3B0aW9ucywgewogICAgICAgIGNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbDogbmV3IFZlYzMoKSwKICAgICAgICBjaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQ6IG5ldyBWZWMzKCksCiAgICAgICAgZGlyZWN0aW9uTG9jYWw6IG5ldyBWZWMzKCksCiAgICAgICAgZGlyZWN0aW9uV29ybGQ6IG5ldyBWZWMzKCksCiAgICAgICAgYXhsZUxvY2FsOiBuZXcgVmVjMygpLAogICAgICAgIGF4bGVXb3JsZDogbmV3IFZlYzMoKSwKICAgICAgICBzdXNwZW5zaW9uUmVzdExlbmd0aDogMSwKICAgICAgICBzdXNwZW5zaW9uTWF4TGVuZ3RoOiAyLAogICAgICAgIHJhZGl1czogMSwKICAgICAgICBzdXNwZW5zaW9uU3RpZmZuZXNzOiAxMDAsCiAgICAgICAgZGFtcGluZ0NvbXByZXNzaW9uOiAxMCwKICAgICAgICBkYW1waW5nUmVsYXhhdGlvbjogMTAsCiAgICAgICAgZnJpY3Rpb25TbGlwOiAxMC41LAogICAgICAgIGZvcndhcmRBY2NlbGVyYXRpb246IDEsCiAgICAgICAgc2lkZUFjY2VsZXJhdGlvbjogMSwKICAgICAgICBzdGVlcmluZzogMCwKICAgICAgICByb3RhdGlvbjogMCwKICAgICAgICBkZWx0YVJvdGF0aW9uOiAwLAogICAgICAgIHJvbGxJbmZsdWVuY2U6IDAuMDEsCiAgICAgICAgbWF4U3VzcGVuc2lvbkZvcmNlOiBOdW1iZXIuTUFYX1ZBTFVFLAogICAgICAgIGlzRnJvbnRXaGVlbDogdHJ1ZSwKICAgICAgICBjbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb246IDEsCiAgICAgICAgc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHk6IDAsCiAgICAgICAgc3VzcGVuc2lvbkZvcmNlOiAwLAogICAgICAgIHNsaXBJbmZvOiAwLAogICAgICAgIHNraWRJbmZvOiAwLAogICAgICAgIHN1c3BlbnNpb25MZW5ndGg6IDAsCiAgICAgICAgbWF4U3VzcGVuc2lvblRyYXZlbDogMSwKICAgICAgICB1c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkOiBmYWxzZSwKICAgICAgICBjdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkOiAtMC4xCiAgICAgIH0pOwogICAgICB0aGlzLm1heFN1c3BlbnNpb25UcmF2ZWwgPSBvcHRpb25zLm1heFN1c3BlbnNpb25UcmF2ZWw7CiAgICAgIHRoaXMuY3VzdG9tU2xpZGluZ1JvdGF0aW9uYWxTcGVlZCA9IG9wdGlvbnMuY3VzdG9tU2xpZGluZ1JvdGF0aW9uYWxTcGVlZDsKICAgICAgdGhpcy51c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkID0gb3B0aW9ucy51c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkOwogICAgICB0aGlzLnNsaWRpbmcgPSBmYWxzZTsKICAgICAgdGhpcy5jaGFzc2lzQ29ubmVjdGlvblBvaW50TG9jYWwgPSBvcHRpb25zLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbC5jbG9uZSgpOwogICAgICB0aGlzLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRXb3JsZCA9IG9wdGlvbnMuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkLmNsb25lKCk7CiAgICAgIHRoaXMuZGlyZWN0aW9uTG9jYWwgPSBvcHRpb25zLmRpcmVjdGlvbkxvY2FsLmNsb25lKCk7CiAgICAgIHRoaXMuZGlyZWN0aW9uV29ybGQgPSBvcHRpb25zLmRpcmVjdGlvbldvcmxkLmNsb25lKCk7CiAgICAgIHRoaXMuYXhsZUxvY2FsID0gb3B0aW9ucy5heGxlTG9jYWwuY2xvbmUoKTsKICAgICAgdGhpcy5heGxlV29ybGQgPSBvcHRpb25zLmF4bGVXb3JsZC5jbG9uZSgpOwogICAgICB0aGlzLnN1c3BlbnNpb25SZXN0TGVuZ3RoID0gb3B0aW9ucy5zdXNwZW5zaW9uUmVzdExlbmd0aDsKICAgICAgdGhpcy5zdXNwZW5zaW9uTWF4TGVuZ3RoID0gb3B0aW9ucy5zdXNwZW5zaW9uTWF4TGVuZ3RoOwogICAgICB0aGlzLnJhZGl1cyA9IG9wdGlvbnMucmFkaXVzOwogICAgICB0aGlzLnN1c3BlbnNpb25TdGlmZm5lc3MgPSBvcHRpb25zLnN1c3BlbnNpb25TdGlmZm5lc3M7CiAgICAgIHRoaXMuZGFtcGluZ0NvbXByZXNzaW9uID0gb3B0aW9ucy5kYW1waW5nQ29tcHJlc3Npb247CiAgICAgIHRoaXMuZGFtcGluZ1JlbGF4YXRpb24gPSBvcHRpb25zLmRhbXBpbmdSZWxheGF0aW9uOwogICAgICB0aGlzLmZyaWN0aW9uU2xpcCA9IG9wdGlvbnMuZnJpY3Rpb25TbGlwOwogICAgICB0aGlzLmZvcndhcmRBY2NlbGVyYXRpb24gPSBvcHRpb25zLmZvcndhcmRBY2NlbGVyYXRpb247CiAgICAgIHRoaXMuc2lkZUFjY2VsZXJhdGlvbiA9IG9wdGlvbnMuc2lkZUFjY2VsZXJhdGlvbjsKICAgICAgdGhpcy5zdGVlcmluZyA9IDA7CiAgICAgIHRoaXMucm90YXRpb24gPSAwOwogICAgICB0aGlzLmRlbHRhUm90YXRpb24gPSAwOwogICAgICB0aGlzLnJvbGxJbmZsdWVuY2UgPSBvcHRpb25zLnJvbGxJbmZsdWVuY2U7CiAgICAgIHRoaXMubWF4U3VzcGVuc2lvbkZvcmNlID0gb3B0aW9ucy5tYXhTdXNwZW5zaW9uRm9yY2U7CiAgICAgIHRoaXMuZW5naW5lRm9yY2UgPSAwOwogICAgICB0aGlzLmJyYWtlID0gMDsKICAgICAgdGhpcy5pc0Zyb250V2hlZWwgPSBvcHRpb25zLmlzRnJvbnRXaGVlbDsKICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxOwogICAgICB0aGlzLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMDsKICAgICAgdGhpcy5zdXNwZW5zaW9uRm9yY2UgPSAwOwogICAgICB0aGlzLnNsaXBJbmZvID0gMDsKICAgICAgdGhpcy5za2lkSW5mbyA9IDA7CiAgICAgIHRoaXMuc3VzcGVuc2lvbkxlbmd0aCA9IDA7CiAgICAgIHRoaXMuc2lkZUltcHVsc2UgPSAwOwogICAgICB0aGlzLmZvcndhcmRJbXB1bHNlID0gMDsKICAgICAgdGhpcy5yYXljYXN0UmVzdWx0ID0gbmV3IFJheWNhc3RSZXN1bHQoKTsKICAgICAgdGhpcy53b3JsZFRyYW5zZm9ybSA9IG5ldyBUcmFuc2Zvcm0oKTsKICAgICAgdGhpcy5pc0luQ29udGFjdCA9IGZhbHNlOwogICAgfQoKICAgIHVwZGF0ZVdoZWVsKGNoYXNzaXMpIHsKICAgICAgY29uc3QgcmF5Y2FzdFJlc3VsdCA9IHRoaXMucmF5Y2FzdFJlc3VsdDsKCiAgICAgIGlmICh0aGlzLmlzSW5Db250YWN0KSB7CiAgICAgICAgY29uc3QgcHJvamVjdCA9IHJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuZG90KHJheWNhc3RSZXN1bHQuZGlyZWN0aW9uV29ybGQpOwogICAgICAgIHJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZC52c3ViKGNoYXNzaXMucG9zaXRpb24sIHJlbHBvcyk7CiAgICAgICAgY2hhc3Npcy5nZXRWZWxvY2l0eUF0V29ybGRQb2ludChyZWxwb3MsIGNoYXNzaXNfdmVsb2NpdHlfYXRfY29udGFjdFBvaW50KTsKICAgICAgICBjb25zdCBwcm9qVmVsID0gcmF5Y2FzdFJlc3VsdC5oaXROb3JtYWxXb3JsZC5kb3QoY2hhc3Npc192ZWxvY2l0eV9hdF9jb250YWN0UG9pbnQpOwoKICAgICAgICBpZiAocHJvamVjdCA+PSAtMC4xKSB7CiAgICAgICAgICB0aGlzLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMC4wOwogICAgICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxLjAgLyAwLjE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IGludiA9IC0xIC8gcHJvamVjdDsKICAgICAgICAgIHRoaXMuc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHkgPSBwcm9qVmVsICogaW52OwogICAgICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSBpbnY7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIE5vdCBpbiBjb250YWN0IDogcG9zaXRpb24gd2hlZWwgaW4gYSBuaWNlIChyZXN0IGxlbmd0aCkgcG9zaXRpb24KICAgICAgICByYXljYXN0UmVzdWx0LnN1c3BlbnNpb25MZW5ndGggPSB0aGlzLnN1c3BlbnNpb25SZXN0TGVuZ3RoOwogICAgICAgIHRoaXMuc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHkgPSAwLjA7CiAgICAgICAgcmF5Y2FzdFJlc3VsdC5kaXJlY3Rpb25Xb3JsZC5zY2FsZSgtMSwgcmF5Y2FzdFJlc3VsdC5oaXROb3JtYWxXb3JsZCk7CiAgICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxLjA7CiAgICAgIH0KICAgIH0KCiAgfQogIGNvbnN0IGNoYXNzaXNfdmVsb2NpdHlfYXRfY29udGFjdFBvaW50ID0gbmV3IFZlYzMoKTsKICBjb25zdCByZWxwb3MgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBWZWhpY2xlIGhlbHBlciBjbGFzcyB0aGF0IGNhc3RzIHJheXMgZnJvbSB0aGUgd2hlZWwgcG9zaXRpb25zIHRvd2FyZHMgdGhlIGdyb3VuZCBhbmQgYXBwbGllcyBmb3JjZXMuCiAgICovCiAgY2xhc3MgUmF5Y2FzdFZlaGljbGUgewogICAgLyoqIFRoZSBjYXIgY2hhc3NpcyBib2R5LiAqLwoKICAgIC8qKiBUaGUgd2hlZWxzLiAqLwoKICAgIC8qKiBXaWxsIGJlIHNldCB0byB0cnVlIGlmIHRoZSBjYXIgaXMgc2xpZGluZy4gKi8KCiAgICAvKiogSW5kZXggb2YgdGhlIHJpZ2h0IGF4aXMuIHg9MCwgeT0xLCB6PTIgKi8KCiAgICAvKiogSW5kZXggb2YgdGhlIGZvcndhcmQgYXhpcy4geD0wLCB5PTEsIHo9MiAqLwoKICAgIC8qKiBJbmRleCBvZiB0aGUgdXAgYXhpcy4geD0wLCB5PTEsIHo9MiAqLwoKICAgIC8qKiBUaGUgY29uc3RyYWludHMuICovCgogICAgLyoqIE9wdGlvbmFsIHByZS1zdGVwIGNhbGxiYWNrLiAqLwoKICAgIC8qKiBOdW1iZXIgb2Ygd2hlZWxzIG9uIHRoZSBncm91bmQuICovCiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgIHRoaXMuY2hhc3Npc0JvZHkgPSBvcHRpb25zLmNoYXNzaXNCb2R5OwogICAgICB0aGlzLndoZWVsSW5mb3MgPSBbXTsKICAgICAgdGhpcy5zbGlkaW5nID0gZmFsc2U7CiAgICAgIHRoaXMud29ybGQgPSBudWxsOwogICAgICB0aGlzLmluZGV4UmlnaHRBeGlzID0gdHlwZW9mIG9wdGlvbnMuaW5kZXhSaWdodEF4aXMgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5pbmRleFJpZ2h0QXhpcyA6IDI7CiAgICAgIHRoaXMuaW5kZXhGb3J3YXJkQXhpcyA9IHR5cGVvZiBvcHRpb25zLmluZGV4Rm9yd2FyZEF4aXMgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5pbmRleEZvcndhcmRBeGlzIDogMDsKICAgICAgdGhpcy5pbmRleFVwQXhpcyA9IHR5cGVvZiBvcHRpb25zLmluZGV4VXBBeGlzICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuaW5kZXhVcEF4aXMgOiAxOwogICAgICB0aGlzLmNvbnN0cmFpbnRzID0gW107CgogICAgICB0aGlzLnByZVN0ZXBDYWxsYmFjayA9ICgpID0+IHt9OwoKICAgICAgdGhpcy5jdXJyZW50VmVoaWNsZVNwZWVkS21Ib3VyID0gMDsKICAgICAgdGhpcy5udW1XaGVlbHNPbkdyb3VuZCA9IDA7CiAgICB9CiAgICAvKioKICAgICAqIEFkZCBhIHdoZWVsLiBGb3IgaW5mb3JtYXRpb24gYWJvdXQgdGhlIG9wdGlvbnMsIHNlZSBgV2hlZWxJbmZvYC4KICAgICAqLwoKCiAgICBhZGRXaGVlbChvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIGNvbnN0IGluZm8gPSBuZXcgV2hlZWxJbmZvKG9wdGlvbnMpOwogICAgICBjb25zdCBpbmRleCA9IHRoaXMud2hlZWxJbmZvcy5sZW5ndGg7CiAgICAgIHRoaXMud2hlZWxJbmZvcy5wdXNoKGluZm8pOwogICAgICByZXR1cm4gaW5kZXg7CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgc3RlZXJpbmcgdmFsdWUgb2YgYSB3aGVlbC4KICAgICAqLwoKCiAgICBzZXRTdGVlcmluZ1ZhbHVlKHZhbHVlLCB3aGVlbEluZGV4KSB7CiAgICAgIGNvbnN0IHdoZWVsID0gdGhpcy53aGVlbEluZm9zW3doZWVsSW5kZXhdOwogICAgICB3aGVlbC5zdGVlcmluZyA9IHZhbHVlOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIHdoZWVsIGZvcmNlIHRvIGFwcGx5IG9uIG9uZSBvZiB0aGUgd2hlZWxzIGVhY2ggdGltZSBzdGVwCiAgICAgKi8KCgogICAgYXBwbHlFbmdpbmVGb3JjZSh2YWx1ZSwgd2hlZWxJbmRleCkgewogICAgICB0aGlzLndoZWVsSW5mb3Nbd2hlZWxJbmRleF0uZW5naW5lRm9yY2UgPSB2YWx1ZTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBicmFraW5nIGZvcmNlIG9mIGEgd2hlZWwKICAgICAqLwoKCiAgICBzZXRCcmFrZShicmFrZSwgd2hlZWxJbmRleCkgewogICAgICB0aGlzLndoZWVsSW5mb3Nbd2hlZWxJbmRleF0uYnJha2UgPSBicmFrZTsKICAgIH0KICAgIC8qKgogICAgICogQWRkIHRoZSB2ZWhpY2xlIGluY2x1ZGluZyBpdHMgY29uc3RyYWludHMgdG8gdGhlIHdvcmxkLgogICAgICovCgoKICAgIGFkZFRvV29ybGQod29ybGQpIHsKICAgICAgd29ybGQuYWRkQm9keSh0aGlzLmNoYXNzaXNCb2R5KTsKICAgICAgY29uc3QgdGhhdCA9IHRoaXM7CgogICAgICB0aGlzLnByZVN0ZXBDYWxsYmFjayA9ICgpID0+IHsKICAgICAgICB0aGF0LnVwZGF0ZVZlaGljbGUod29ybGQuZHQpOwogICAgICB9OwoKICAgICAgd29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncHJlU3RlcCcsIHRoaXMucHJlU3RlcENhbGxiYWNrKTsKICAgICAgdGhpcy53b3JsZCA9IHdvcmxkOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgb25lIG9mIHRoZSB3aGVlbCBheGxlcywgd29ybGQtb3JpZW50ZWQuCiAgICAgKi8KCgogICAgZ2V0VmVoaWNsZUF4aXNXb3JsZChheGlzSW5kZXgsIHJlc3VsdCkgewogICAgICByZXN1bHQuc2V0KGF4aXNJbmRleCA9PT0gMCA/IDEgOiAwLCBheGlzSW5kZXggPT09IDEgPyAxIDogMCwgYXhpc0luZGV4ID09PSAyID8gMSA6IDApOwogICAgICB0aGlzLmNoYXNzaXNCb2R5LnZlY3RvclRvV29ybGRGcmFtZShyZXN1bHQsIHJlc3VsdCk7CiAgICB9CgogICAgdXBkYXRlVmVoaWNsZSh0aW1lU3RlcCkgewogICAgICBjb25zdCB3aGVlbEluZm9zID0gdGhpcy53aGVlbEluZm9zOwogICAgICBjb25zdCBudW1XaGVlbHMgPSB3aGVlbEluZm9zLmxlbmd0aDsKICAgICAgY29uc3QgY2hhc3Npc0JvZHkgPSB0aGlzLmNoYXNzaXNCb2R5OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIHRoaXMudXBkYXRlV2hlZWxUcmFuc2Zvcm0oaSk7CiAgICAgIH0KCiAgICAgIHRoaXMuY3VycmVudFZlaGljbGVTcGVlZEttSG91ciA9IDMuNiAqIGNoYXNzaXNCb2R5LnZlbG9jaXR5Lmxlbmd0aCgpOwogICAgICBjb25zdCBmb3J3YXJkV29ybGQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmdldFZlaGljbGVBeGlzV29ybGQodGhpcy5pbmRleEZvcndhcmRBeGlzLCBmb3J3YXJkV29ybGQpOwoKICAgICAgaWYgKGZvcndhcmRXb3JsZC5kb3QoY2hhc3Npc0JvZHkudmVsb2NpdHkpIDwgMCkgewogICAgICAgIHRoaXMuY3VycmVudFZlaGljbGVTcGVlZEttSG91ciAqPSAtMTsKICAgICAgfSAvLyBzaW11bGF0ZSBzdXNwZW5zaW9uCgoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIHRoaXMuY2FzdFJheSh3aGVlbEluZm9zW2ldKTsKICAgICAgfQoKICAgICAgdGhpcy51cGRhdGVTdXNwZW5zaW9uKHRpbWVTdGVwKTsKICAgICAgY29uc3QgaW1wdWxzZSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHJlbHBvcyA9IG5ldyBWZWMzKCk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVdoZWVsczsgaSsrKSB7CiAgICAgICAgLy9hcHBseSBzdXNwZW5zaW9uIGZvcmNlCiAgICAgICAgY29uc3Qgd2hlZWwgPSB3aGVlbEluZm9zW2ldOwogICAgICAgIGxldCBzdXNwZW5zaW9uRm9yY2UgPSB3aGVlbC5zdXNwZW5zaW9uRm9yY2U7CgogICAgICAgIGlmIChzdXNwZW5zaW9uRm9yY2UgPiB3aGVlbC5tYXhTdXNwZW5zaW9uRm9yY2UpIHsKICAgICAgICAgIHN1c3BlbnNpb25Gb3JjZSA9IHdoZWVsLm1heFN1c3BlbnNpb25Gb3JjZTsKICAgICAgICB9CgogICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuc2NhbGUoc3VzcGVuc2lvbkZvcmNlICogdGltZVN0ZXAsIGltcHVsc2UpOwogICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZC52c3ViKGNoYXNzaXNCb2R5LnBvc2l0aW9uLCByZWxwb3MpOwogICAgICAgIGNoYXNzaXNCb2R5LmFwcGx5SW1wdWxzZShpbXB1bHNlLCByZWxwb3MpOwogICAgICB9CgogICAgICB0aGlzLnVwZGF0ZUZyaWN0aW9uKHRpbWVTdGVwKTsKICAgICAgY29uc3QgaGl0Tm9ybWFsV29ybGRTY2FsZWRXaXRoUHJvaiA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGZ3ZCA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHZlbCA9IG5ldyBWZWMzKCk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVdoZWVsczsgaSsrKSB7CiAgICAgICAgY29uc3Qgd2hlZWwgPSB3aGVlbEluZm9zW2ldOyAvL2NvbnN0IHJlbHBvcyA9IG5ldyBWZWMzKCk7CiAgICAgICAgLy93aGVlbC5jaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQudnN1YihjaGFzc2lzQm9keS5wb3NpdGlvbiwgcmVscG9zKTsKCiAgICAgICAgY2hhc3Npc0JvZHkuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQod2hlZWwuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkLCB2ZWwpOyAvLyBIYWNrIHRvIGdldCB0aGUgcm90YXRpb24gaW4gdGhlIGNvcnJlY3QgZGlyZWN0aW9uCgogICAgICAgIGxldCBtID0gMTsKCiAgICAgICAgc3dpdGNoICh0aGlzLmluZGV4VXBBeGlzKSB7CiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIG0gPSAtMTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBpZiAod2hlZWwuaXNJbkNvbnRhY3QpIHsKICAgICAgICAgIHRoaXMuZ2V0VmVoaWNsZUF4aXNXb3JsZCh0aGlzLmluZGV4Rm9yd2FyZEF4aXMsIGZ3ZCk7CiAgICAgICAgICBjb25zdCBwcm9qID0gZndkLmRvdCh3aGVlbC5yYXljYXN0UmVzdWx0LmhpdE5vcm1hbFdvcmxkKTsKICAgICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuc2NhbGUocHJvaiwgaGl0Tm9ybWFsV29ybGRTY2FsZWRXaXRoUHJvaik7CiAgICAgICAgICBmd2QudnN1YihoaXROb3JtYWxXb3JsZFNjYWxlZFdpdGhQcm9qLCBmd2QpOwogICAgICAgICAgY29uc3QgcHJvajIgPSBmd2QuZG90KHZlbCk7CiAgICAgICAgICB3aGVlbC5kZWx0YVJvdGF0aW9uID0gbSAqIHByb2oyICogdGltZVN0ZXAgLyB3aGVlbC5yYWRpdXM7CiAgICAgICAgfQoKICAgICAgICBpZiAoKHdoZWVsLnNsaWRpbmcgfHwgIXdoZWVsLmlzSW5Db250YWN0KSAmJiB3aGVlbC5lbmdpbmVGb3JjZSAhPT0gMCAmJiB3aGVlbC51c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkKSB7CiAgICAgICAgICAvLyBBcHBseSBjdXN0b20gcm90YXRpb24gd2hlbiBhY2NlbGVyYXRpbmcgYW5kIHNsaWRpbmcKICAgICAgICAgIHdoZWVsLmRlbHRhUm90YXRpb24gPSAod2hlZWwuZW5naW5lRm9yY2UgPiAwID8gMSA6IC0xKSAqIHdoZWVsLmN1c3RvbVNsaWRpbmdSb3RhdGlvbmFsU3BlZWQgKiB0aW1lU3RlcDsKICAgICAgICB9IC8vIExvY2sgd2hlZWxzCgoKICAgICAgICBpZiAoTWF0aC5hYnMod2hlZWwuYnJha2UpID4gTWF0aC5hYnMod2hlZWwuZW5naW5lRm9yY2UpKSB7CiAgICAgICAgICB3aGVlbC5kZWx0YVJvdGF0aW9uID0gMDsKICAgICAgICB9CgogICAgICAgIHdoZWVsLnJvdGF0aW9uICs9IHdoZWVsLmRlbHRhUm90YXRpb247IC8vIFVzZSB0aGUgb2xkIHZhbHVlCgogICAgICAgIHdoZWVsLmRlbHRhUm90YXRpb24gKj0gMC45OTsgLy8gZGFtcGluZyBvZiByb3RhdGlvbiB3aGVuIG5vdCBpbiBjb250YWN0CiAgICAgIH0KICAgIH0KCiAgICB1cGRhdGVTdXNwZW5zaW9uKGRlbHRhVGltZSkgewogICAgICBjb25zdCBjaGFzc2lzQm9keSA9IHRoaXMuY2hhc3Npc0JvZHk7CiAgICAgIGNvbnN0IGNoYXNzaXNNYXNzID0gY2hhc3Npc0JvZHkubWFzczsKICAgICAgY29uc3Qgd2hlZWxJbmZvcyA9IHRoaXMud2hlZWxJbmZvczsKICAgICAgY29uc3QgbnVtV2hlZWxzID0gd2hlZWxJbmZvcy5sZW5ndGg7CgogICAgICBmb3IgKGxldCB3X2l0ID0gMDsgd19pdCA8IG51bVdoZWVsczsgd19pdCsrKSB7CiAgICAgICAgY29uc3Qgd2hlZWwgPSB3aGVlbEluZm9zW3dfaXRdOwoKICAgICAgICBpZiAod2hlZWwuaXNJbkNvbnRhY3QpIHsKICAgICAgICAgIGxldCBmb3JjZTsgLy8gU3ByaW5nCgogICAgICAgICAgY29uc3Qgc3VzcF9sZW5ndGggPSB3aGVlbC5zdXNwZW5zaW9uUmVzdExlbmd0aDsKICAgICAgICAgIGNvbnN0IGN1cnJlbnRfbGVuZ3RoID0gd2hlZWwuc3VzcGVuc2lvbkxlbmd0aDsKICAgICAgICAgIGNvbnN0IGxlbmd0aF9kaWZmID0gc3VzcF9sZW5ndGggLSBjdXJyZW50X2xlbmd0aDsKICAgICAgICAgIGZvcmNlID0gd2hlZWwuc3VzcGVuc2lvblN0aWZmbmVzcyAqIGxlbmd0aF9kaWZmICogd2hlZWwuY2xpcHBlZEludkNvbnRhY3REb3RTdXNwZW5zaW9uOyAvLyBEYW1wZXIKCiAgICAgICAgICBjb25zdCBwcm9qZWN0ZWRfcmVsX3ZlbCA9IHdoZWVsLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5OwogICAgICAgICAgbGV0IHN1c3BfZGFtcGluZzsKCiAgICAgICAgICBpZiAocHJvamVjdGVkX3JlbF92ZWwgPCAwKSB7CiAgICAgICAgICAgIHN1c3BfZGFtcGluZyA9IHdoZWVsLmRhbXBpbmdDb21wcmVzc2lvbjsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN1c3BfZGFtcGluZyA9IHdoZWVsLmRhbXBpbmdSZWxheGF0aW9uOwogICAgICAgICAgfQoKICAgICAgICAgIGZvcmNlIC09IHN1c3BfZGFtcGluZyAqIHByb2plY3RlZF9yZWxfdmVsOwogICAgICAgICAgd2hlZWwuc3VzcGVuc2lvbkZvcmNlID0gZm9yY2UgKiBjaGFzc2lzTWFzczsKCiAgICAgICAgICBpZiAod2hlZWwuc3VzcGVuc2lvbkZvcmNlIDwgMCkgewogICAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uRm9yY2UgPSAwOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uRm9yY2UgPSAwOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmUgdGhlIHZlaGljbGUgaW5jbHVkaW5nIGl0cyBjb25zdHJhaW50cyBmcm9tIHRoZSB3b3JsZC4KICAgICAqLwoKCiAgICByZW1vdmVGcm9tV29ybGQod29ybGQpIHsKICAgICAgdGhpcy5jb25zdHJhaW50czsKICAgICAgd29ybGQucmVtb3ZlQm9keSh0aGlzLmNoYXNzaXNCb2R5KTsKICAgICAgd29ybGQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncHJlU3RlcCcsIHRoaXMucHJlU3RlcENhbGxiYWNrKTsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICB9CgogICAgY2FzdFJheSh3aGVlbCkgewogICAgICBjb25zdCByYXl2ZWN0b3IgPSBjYXN0UmF5X3JheXZlY3RvcjsKICAgICAgY29uc3QgdGFyZ2V0ID0gY2FzdFJheV90YXJnZXQ7CiAgICAgIHRoaXMudXBkYXRlV2hlZWxUcmFuc2Zvcm1Xb3JsZCh3aGVlbCk7CiAgICAgIGNvbnN0IGNoYXNzaXNCb2R5ID0gdGhpcy5jaGFzc2lzQm9keTsKICAgICAgbGV0IGRlcHRoID0gLTE7CiAgICAgIGNvbnN0IHJheWxlbiA9IHdoZWVsLnN1c3BlbnNpb25SZXN0TGVuZ3RoICsgd2hlZWwucmFkaXVzOwogICAgICB3aGVlbC5kaXJlY3Rpb25Xb3JsZC5zY2FsZShyYXlsZW4sIHJheXZlY3Rvcik7CiAgICAgIGNvbnN0IHNvdXJjZSA9IHdoZWVsLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRXb3JsZDsKICAgICAgc291cmNlLnZhZGQocmF5dmVjdG9yLCB0YXJnZXQpOwogICAgICBjb25zdCByYXljYXN0UmVzdWx0ID0gd2hlZWwucmF5Y2FzdFJlc3VsdDsKICAgICAgcmF5Y2FzdFJlc3VsdC5yZXNldCgpOyAvLyBUdXJuIG9mZiByYXkgY29sbGlzaW9uIHdpdGggdGhlIGNoYXNzaXMgdGVtcG9yYXJpbHkKCiAgICAgIGNvbnN0IG9sZFN0YXRlID0gY2hhc3Npc0JvZHkuY29sbGlzaW9uUmVzcG9uc2U7CiAgICAgIGNoYXNzaXNCb2R5LmNvbGxpc2lvblJlc3BvbnNlID0gZmFsc2U7IC8vIENhc3QgcmF5IGFnYWluc3Qgd29ybGQKCiAgICAgIHRoaXMud29ybGQucmF5VGVzdChzb3VyY2UsIHRhcmdldCwgcmF5Y2FzdFJlc3VsdCk7CiAgICAgIGNoYXNzaXNCb2R5LmNvbGxpc2lvblJlc3BvbnNlID0gb2xkU3RhdGU7CiAgICAgIGNvbnN0IG9iamVjdCA9IHJheWNhc3RSZXN1bHQuYm9keTsKICAgICAgd2hlZWwucmF5Y2FzdFJlc3VsdC5ncm91bmRPYmplY3QgPSAwOwoKICAgICAgaWYgKG9iamVjdCkgewogICAgICAgIGRlcHRoID0gcmF5Y2FzdFJlc3VsdC5kaXN0YW5jZTsKICAgICAgICB3aGVlbC5yYXljYXN0UmVzdWx0LmhpdE5vcm1hbFdvcmxkID0gcmF5Y2FzdFJlc3VsdC5oaXROb3JtYWxXb3JsZDsKICAgICAgICB3aGVlbC5pc0luQ29udGFjdCA9IHRydWU7CiAgICAgICAgY29uc3QgaGl0RGlzdGFuY2UgPSByYXljYXN0UmVzdWx0LmRpc3RhbmNlOwogICAgICAgIHdoZWVsLnN1c3BlbnNpb25MZW5ndGggPSBoaXREaXN0YW5jZSAtIHdoZWVsLnJhZGl1czsgLy8gY2xhbXAgb24gbWF4IHN1c3BlbnNpb24gdHJhdmVsCgogICAgICAgIGNvbnN0IG1pblN1c3BlbnNpb25MZW5ndGggPSB3aGVlbC5zdXNwZW5zaW9uUmVzdExlbmd0aCAtIHdoZWVsLm1heFN1c3BlbnNpb25UcmF2ZWw7CiAgICAgICAgY29uc3QgbWF4U3VzcGVuc2lvbkxlbmd0aCA9IHdoZWVsLnN1c3BlbnNpb25SZXN0TGVuZ3RoICsgd2hlZWwubWF4U3VzcGVuc2lvblRyYXZlbDsKCiAgICAgICAgaWYgKHdoZWVsLnN1c3BlbnNpb25MZW5ndGggPCBtaW5TdXNwZW5zaW9uTGVuZ3RoKSB7CiAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uTGVuZ3RoID0gbWluU3VzcGVuc2lvbkxlbmd0aDsKICAgICAgICB9CgogICAgICAgIGlmICh3aGVlbC5zdXNwZW5zaW9uTGVuZ3RoID4gbWF4U3VzcGVuc2lvbkxlbmd0aCkgewogICAgICAgICAgd2hlZWwuc3VzcGVuc2lvbkxlbmd0aCA9IG1heFN1c3BlbnNpb25MZW5ndGg7CiAgICAgICAgICB3aGVlbC5yYXljYXN0UmVzdWx0LnJlc2V0KCk7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBkZW5vbWluYXRvciA9IHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuZG90KHdoZWVsLmRpcmVjdGlvbldvcmxkKTsKICAgICAgICBjb25zdCBjaGFzc2lzX3ZlbG9jaXR5X2F0X2NvbnRhY3RQb2ludCA9IG5ldyBWZWMzKCk7CiAgICAgICAgY2hhc3Npc0JvZHkuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQod2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkLCBjaGFzc2lzX3ZlbG9jaXR5X2F0X2NvbnRhY3RQb2ludCk7CiAgICAgICAgY29uc3QgcHJvalZlbCA9IHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuZG90KGNoYXNzaXNfdmVsb2NpdHlfYXRfY29udGFjdFBvaW50KTsKCiAgICAgICAgaWYgKGRlbm9taW5hdG9yID49IC0wLjEpIHsKICAgICAgICAgIHdoZWVsLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMDsKICAgICAgICAgIHdoZWVsLmNsaXBwZWRJbnZDb250YWN0RG90U3VzcGVuc2lvbiA9IDEgLyAwLjE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IGludiA9IC0xIC8gZGVub21pbmF0b3I7CiAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uUmVsYXRpdmVWZWxvY2l0eSA9IHByb2pWZWwgKiBpbnY7CiAgICAgICAgICB3aGVlbC5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSBpbnY7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vcHV0IHdoZWVsIGluZm8gYXMgaW4gcmVzdCBwb3NpdGlvbgogICAgICAgIHdoZWVsLnN1c3BlbnNpb25MZW5ndGggPSB3aGVlbC5zdXNwZW5zaW9uUmVzdExlbmd0aCArIDAgKiB3aGVlbC5tYXhTdXNwZW5zaW9uVHJhdmVsOwogICAgICAgIHdoZWVsLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMC4wOwogICAgICAgIHdoZWVsLmRpcmVjdGlvbldvcmxkLnNjYWxlKC0xLCB3aGVlbC5yYXljYXN0UmVzdWx0LmhpdE5vcm1hbFdvcmxkKTsKICAgICAgICB3aGVlbC5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxLjA7CiAgICAgIH0KCiAgICAgIHJldHVybiBkZXB0aDsKICAgIH0KCiAgICB1cGRhdGVXaGVlbFRyYW5zZm9ybVdvcmxkKHdoZWVsKSB7CiAgICAgIHdoZWVsLmlzSW5Db250YWN0ID0gZmFsc2U7CiAgICAgIGNvbnN0IGNoYXNzaXNCb2R5ID0gdGhpcy5jaGFzc2lzQm9keTsKICAgICAgY2hhc3Npc0JvZHkucG9pbnRUb1dvcmxkRnJhbWUod2hlZWwuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludExvY2FsLCB3aGVlbC5jaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQpOwogICAgICBjaGFzc2lzQm9keS52ZWN0b3JUb1dvcmxkRnJhbWUod2hlZWwuZGlyZWN0aW9uTG9jYWwsIHdoZWVsLmRpcmVjdGlvbldvcmxkKTsKICAgICAgY2hhc3Npc0JvZHkudmVjdG9yVG9Xb3JsZEZyYW1lKHdoZWVsLmF4bGVMb2NhbCwgd2hlZWwuYXhsZVdvcmxkKTsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlIG9uZSBvZiB0aGUgd2hlZWwgdHJhbnNmb3JtLgogICAgICogTm90ZSB3aGVuIHJlbmRlcmluZyB3aGVlbHM6IGR1cmluZyBlYWNoIHN0ZXAsIHdoZWVsIHRyYW5zZm9ybXMgYXJlIHVwZGF0ZWQgQkVGT1JFIHRoZSBjaGFzc2lzOyBpZS4gdGhlaXIgcG9zaXRpb24gYmVjb21lcyBpbnZhbGlkIGFmdGVyIHRoZSBzdGVwLiBUaHVzIHdoZW4geW91IHJlbmRlciB3aGVlbHMsIHlvdSBtdXN0IHVwZGF0ZSB3aGVlbCB0cmFuc2Zvcm1zIGJlZm9yZSByZW5kZXJpbmcgdGhlbS4gU2VlIHJheWNhc3RWZWhpY2xlIGRlbW8gZm9yIGFuIGV4YW1wbGUuCiAgICAgKiBAcGFyYW0gd2hlZWxJbmRleCBUaGUgd2hlZWwgaW5kZXggdG8gdXBkYXRlLgogICAgICovCgoKICAgIHVwZGF0ZVdoZWVsVHJhbnNmb3JtKHdoZWVsSW5kZXgpIHsKICAgICAgY29uc3QgdXAgPSB0bXBWZWM0OwogICAgICBjb25zdCByaWdodCA9IHRtcFZlYzU7CiAgICAgIGNvbnN0IGZ3ZCA9IHRtcFZlYzY7CiAgICAgIGNvbnN0IHdoZWVsID0gdGhpcy53aGVlbEluZm9zW3doZWVsSW5kZXhdOwogICAgICB0aGlzLnVwZGF0ZVdoZWVsVHJhbnNmb3JtV29ybGQod2hlZWwpOwogICAgICB3aGVlbC5kaXJlY3Rpb25Mb2NhbC5zY2FsZSgtMSwgdXApOwogICAgICByaWdodC5jb3B5KHdoZWVsLmF4bGVMb2NhbCk7CiAgICAgIHVwLmNyb3NzKHJpZ2h0LCBmd2QpOwogICAgICBmd2Qubm9ybWFsaXplKCk7CiAgICAgIHJpZ2h0Lm5vcm1hbGl6ZSgpOyAvLyBSb3RhdGUgYXJvdW5kIHN0ZWVyaW5nIG92ZXIgdGhlIHdoZWVsQXhsZQoKICAgICAgY29uc3Qgc3RlZXJpbmcgPSB3aGVlbC5zdGVlcmluZzsKICAgICAgY29uc3Qgc3RlZXJpbmdPcm4gPSBuZXcgUXVhdGVybmlvbigpOwogICAgICBzdGVlcmluZ09ybi5zZXRGcm9tQXhpc0FuZ2xlKHVwLCBzdGVlcmluZyk7CiAgICAgIGNvbnN0IHJvdGF0aW5nT3JuID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgcm90YXRpbmdPcm4uc2V0RnJvbUF4aXNBbmdsZShyaWdodCwgd2hlZWwucm90YXRpb24pOyAvLyBXb3JsZCByb3RhdGlvbiBvZiB0aGUgd2hlZWwKCiAgICAgIGNvbnN0IHEgPSB3aGVlbC53b3JsZFRyYW5zZm9ybS5xdWF0ZXJuaW9uOwogICAgICB0aGlzLmNoYXNzaXNCb2R5LnF1YXRlcm5pb24ubXVsdChzdGVlcmluZ09ybiwgcSk7CiAgICAgIHEubXVsdChyb3RhdGluZ09ybiwgcSk7CiAgICAgIHEubm9ybWFsaXplKCk7IC8vIHdvcmxkIHBvc2l0aW9uIG9mIHRoZSB3aGVlbAoKICAgICAgY29uc3QgcCA9IHdoZWVsLndvcmxkVHJhbnNmb3JtLnBvc2l0aW9uOwogICAgICBwLmNvcHkod2hlZWwuZGlyZWN0aW9uV29ybGQpOwogICAgICBwLnNjYWxlKHdoZWVsLnN1c3BlbnNpb25MZW5ndGgsIHApOwogICAgICBwLnZhZGQod2hlZWwuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkLCBwKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSB3b3JsZCB0cmFuc2Zvcm0gb2Ygb25lIG9mIHRoZSB3aGVlbHMKICAgICAqLwoKCiAgICBnZXRXaGVlbFRyYW5zZm9ybVdvcmxkKHdoZWVsSW5kZXgpIHsKICAgICAgcmV0dXJuIHRoaXMud2hlZWxJbmZvc1t3aGVlbEluZGV4XS53b3JsZFRyYW5zZm9ybTsKICAgIH0KCiAgICB1cGRhdGVGcmljdGlvbih0aW1lU3RlcCkgewogICAgICBjb25zdCBzdXJmTm9ybWFsV1Nfc2NhbGVkX3Byb2ogPSB1cGRhdGVGcmljdGlvbl9zdXJmTm9ybWFsV1Nfc2NhbGVkX3Byb2o7IC8vY2FsY3VsYXRlIHRoZSBpbXB1bHNlLCBzbyB0aGF0IHRoZSB3aGVlbHMgZG9uJ3QgbW92ZSBzaWRld2FyZHMKCiAgICAgIGNvbnN0IHdoZWVsSW5mb3MgPSB0aGlzLndoZWVsSW5mb3M7CiAgICAgIGNvbnN0IG51bVdoZWVscyA9IHdoZWVsSW5mb3MubGVuZ3RoOwogICAgICBjb25zdCBjaGFzc2lzQm9keSA9IHRoaXMuY2hhc3Npc0JvZHk7CiAgICAgIGNvbnN0IGZvcndhcmRXUyA9IHVwZGF0ZUZyaWN0aW9uX2ZvcndhcmRXUzsKICAgICAgY29uc3QgYXhsZSA9IHVwZGF0ZUZyaWN0aW9uX2F4bGU7CiAgICAgIHRoaXMubnVtV2hlZWxzT25Hcm91bmQgPSAwOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIGNvbnN0IHdoZWVsID0gd2hlZWxJbmZvc1tpXTsKICAgICAgICBjb25zdCBncm91bmRPYmplY3QgPSB3aGVlbC5yYXljYXN0UmVzdWx0LmJvZHk7CgogICAgICAgIGlmIChncm91bmRPYmplY3QpIHsKICAgICAgICAgIHRoaXMubnVtV2hlZWxzT25Hcm91bmQrKzsKICAgICAgICB9CgogICAgICAgIHdoZWVsLnNpZGVJbXB1bHNlID0gMDsKICAgICAgICB3aGVlbC5mb3J3YXJkSW1wdWxzZSA9IDA7CgogICAgICAgIGlmICghZm9yd2FyZFdTW2ldKSB7CiAgICAgICAgICBmb3J3YXJkV1NbaV0gPSBuZXcgVmVjMygpOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFheGxlW2ldKSB7CiAgICAgICAgICBheGxlW2ldID0gbmV3IFZlYzMoKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtV2hlZWxzOyBpKyspIHsKICAgICAgICBjb25zdCB3aGVlbCA9IHdoZWVsSW5mb3NbaV07CiAgICAgICAgY29uc3QgZ3JvdW5kT2JqZWN0ID0gd2hlZWwucmF5Y2FzdFJlc3VsdC5ib2R5OwoKICAgICAgICBpZiAoZ3JvdW5kT2JqZWN0KSB7CiAgICAgICAgICBjb25zdCBheGxlaSA9IGF4bGVbaV07CiAgICAgICAgICBjb25zdCB3aGVlbFRyYW5zID0gdGhpcy5nZXRXaGVlbFRyYW5zZm9ybVdvcmxkKGkpOyAvLyBHZXQgd29ybGQgYXhsZQoKICAgICAgICAgIHdoZWVsVHJhbnMudmVjdG9yVG9Xb3JsZEZyYW1lKGRpcmVjdGlvbnNbdGhpcy5pbmRleFJpZ2h0QXhpc10sIGF4bGVpKTsKICAgICAgICAgIGNvbnN0IHN1cmZOb3JtYWxXUyA9IHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQ7CiAgICAgICAgICBjb25zdCBwcm9qID0gYXhsZWkuZG90KHN1cmZOb3JtYWxXUyk7CiAgICAgICAgICBzdXJmTm9ybWFsV1Muc2NhbGUocHJvaiwgc3VyZk5vcm1hbFdTX3NjYWxlZF9wcm9qKTsKICAgICAgICAgIGF4bGVpLnZzdWIoc3VyZk5vcm1hbFdTX3NjYWxlZF9wcm9qLCBheGxlaSk7CiAgICAgICAgICBheGxlaS5ub3JtYWxpemUoKTsKICAgICAgICAgIHN1cmZOb3JtYWxXUy5jcm9zcyhheGxlaSwgZm9yd2FyZFdTW2ldKTsKICAgICAgICAgIGZvcndhcmRXU1tpXS5ub3JtYWxpemUoKTsKICAgICAgICAgIHdoZWVsLnNpZGVJbXB1bHNlID0gcmVzb2x2ZVNpbmdsZUJpbGF0ZXJhbChjaGFzc2lzQm9keSwgd2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkLCBncm91bmRPYmplY3QsIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZCwgYXhsZWkpOwogICAgICAgICAgd2hlZWwuc2lkZUltcHVsc2UgKj0gc2lkZUZyaWN0aW9uU3RpZmZuZXNzMjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IHNpZGVGYWN0b3IgPSAxOwogICAgICBjb25zdCBmd2RGYWN0b3IgPSAwLjU7CiAgICAgIHRoaXMuc2xpZGluZyA9IGZhbHNlOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIGNvbnN0IHdoZWVsID0gd2hlZWxJbmZvc1tpXTsKICAgICAgICBjb25zdCBncm91bmRPYmplY3QgPSB3aGVlbC5yYXljYXN0UmVzdWx0LmJvZHk7CiAgICAgICAgbGV0IHJvbGxpbmdGcmljdGlvbiA9IDA7CiAgICAgICAgd2hlZWwuc2xpcEluZm8gPSAxOwoKICAgICAgICBpZiAoZ3JvdW5kT2JqZWN0KSB7CiAgICAgICAgICBjb25zdCBkZWZhdWx0Um9sbGluZ0ZyaWN0aW9uSW1wdWxzZSA9IDA7CiAgICAgICAgICBjb25zdCBtYXhJbXB1bHNlID0gd2hlZWwuYnJha2UgPyB3aGVlbC5icmFrZSA6IGRlZmF1bHRSb2xsaW5nRnJpY3Rpb25JbXB1bHNlOyAvLyBidFdoZWVsQ29udGFjdFBvaW50IGNvbnRhY3RQdChjaGFzc2lzQm9keSxncm91bmRPYmplY3Qsd2hlZWxJbmZyYXljYXN0SW5mby5oaXRQb2ludFdvcmxkLGZvcndhcmRXU1t3aGVlbF0sbWF4SW1wdWxzZSk7CiAgICAgICAgICAvLyByb2xsaW5nRnJpY3Rpb24gPSBjYWxjUm9sbGluZ0ZyaWN0aW9uKGNvbnRhY3RQdCk7CgogICAgICAgICAgcm9sbGluZ0ZyaWN0aW9uID0gY2FsY1JvbGxpbmdGcmljdGlvbihjaGFzc2lzQm9keSwgZ3JvdW5kT2JqZWN0LCB3aGVlbC5yYXljYXN0UmVzdWx0LmhpdFBvaW50V29ybGQsIGZvcndhcmRXU1tpXSwgbWF4SW1wdWxzZSk7CiAgICAgICAgICByb2xsaW5nRnJpY3Rpb24gKz0gd2hlZWwuZW5naW5lRm9yY2UgKiB0aW1lU3RlcDsgLy8gcm9sbGluZ0ZyaWN0aW9uID0gMDsKCiAgICAgICAgICBjb25zdCBmYWN0b3IgPSBtYXhJbXB1bHNlIC8gcm9sbGluZ0ZyaWN0aW9uOwogICAgICAgICAgd2hlZWwuc2xpcEluZm8gKj0gZmFjdG9yOwogICAgICAgIH0gLy9zd2l0Y2ggYmV0d2VlbiBhY3RpdmUgcm9sbGluZyAodGhyb3R0bGUpLCBicmFraW5nIGFuZCBub24tYWN0aXZlIHJvbGxpbmcgZnJpY3Rpb24gKG50aHJvdHRsZS9icmVhaykKCgogICAgICAgIHdoZWVsLmZvcndhcmRJbXB1bHNlID0gMDsKICAgICAgICB3aGVlbC5za2lkSW5mbyA9IDE7CgogICAgICAgIGlmIChncm91bmRPYmplY3QpIHsKICAgICAgICAgIHdoZWVsLnNraWRJbmZvID0gMTsKICAgICAgICAgIGNvbnN0IG1heGltcCA9IHdoZWVsLnN1c3BlbnNpb25Gb3JjZSAqIHRpbWVTdGVwICogd2hlZWwuZnJpY3Rpb25TbGlwOwogICAgICAgICAgY29uc3QgbWF4aW1wU2lkZSA9IG1heGltcDsKICAgICAgICAgIGNvbnN0IG1heGltcFNxdWFyZWQgPSBtYXhpbXAgKiBtYXhpbXBTaWRlOwogICAgICAgICAgd2hlZWwuZm9yd2FyZEltcHVsc2UgPSByb2xsaW5nRnJpY3Rpb247IC8vd2hlZWxJbmZvLmVuZ2luZUZvcmNlKiB0aW1lU3RlcDsKCiAgICAgICAgICBjb25zdCB4ID0gd2hlZWwuZm9yd2FyZEltcHVsc2UgKiBmd2RGYWN0b3IgLyB3aGVlbC5mb3J3YXJkQWNjZWxlcmF0aW9uOwogICAgICAgICAgY29uc3QgeSA9IHdoZWVsLnNpZGVJbXB1bHNlICogc2lkZUZhY3RvciAvIHdoZWVsLnNpZGVBY2NlbGVyYXRpb247CiAgICAgICAgICBjb25zdCBpbXB1bHNlU3F1YXJlZCA9IHggKiB4ICsgeSAqIHk7CiAgICAgICAgICB3aGVlbC5zbGlkaW5nID0gZmFsc2U7CgogICAgICAgICAgaWYgKGltcHVsc2VTcXVhcmVkID4gbWF4aW1wU3F1YXJlZCkgewogICAgICAgICAgICB0aGlzLnNsaWRpbmcgPSB0cnVlOwogICAgICAgICAgICB3aGVlbC5zbGlkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgY29uc3QgZmFjdG9yID0gbWF4aW1wIC8gTWF0aC5zcXJ0KGltcHVsc2VTcXVhcmVkKTsKICAgICAgICAgICAgd2hlZWwuc2tpZEluZm8gKj0gZmFjdG9yOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHRoaXMuc2xpZGluZykgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtV2hlZWxzOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHdoZWVsID0gd2hlZWxJbmZvc1tpXTsKCiAgICAgICAgICBpZiAod2hlZWwuc2lkZUltcHVsc2UgIT09IDApIHsKICAgICAgICAgICAgaWYgKHdoZWVsLnNraWRJbmZvIDwgMSkgewogICAgICAgICAgICAgIHdoZWVsLmZvcndhcmRJbXB1bHNlICo9IHdoZWVsLnNraWRJbmZvOwogICAgICAgICAgICAgIHdoZWVsLnNpZGVJbXB1bHNlICo9IHdoZWVsLnNraWRJbmZvOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIGFwcGx5IHRoZSBpbXB1bHNlcwoKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtV2hlZWxzOyBpKyspIHsKICAgICAgICBjb25zdCB3aGVlbCA9IHdoZWVsSW5mb3NbaV07CiAgICAgICAgY29uc3QgcmVsX3BvcyA9IG5ldyBWZWMzKCk7CiAgICAgICAgd2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkLnZzdWIoY2hhc3Npc0JvZHkucG9zaXRpb24sIHJlbF9wb3MpOyAvLyBjYW5ub25zIGFwcGx5aW1wdWxzZSBpcyB1c2luZyB3b3JsZCBjb29yZCBmb3IgdGhlIHBvc2l0aW9uCiAgICAgICAgLy9yZWxfcG9zLmNvcHkod2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkKTsKCiAgICAgICAgaWYgKHdoZWVsLmZvcndhcmRJbXB1bHNlICE9PSAwKSB7CiAgICAgICAgICBjb25zdCBpbXB1bHNlID0gbmV3IFZlYzMoKTsKICAgICAgICAgIGZvcndhcmRXU1tpXS5zY2FsZSh3aGVlbC5mb3J3YXJkSW1wdWxzZSwgaW1wdWxzZSk7CiAgICAgICAgICBjaGFzc2lzQm9keS5hcHBseUltcHVsc2UoaW1wdWxzZSwgcmVsX3Bvcyk7CiAgICAgICAgfQoKICAgICAgICBpZiAod2hlZWwuc2lkZUltcHVsc2UgIT09IDApIHsKICAgICAgICAgIGNvbnN0IGdyb3VuZE9iamVjdCA9IHdoZWVsLnJheWNhc3RSZXN1bHQuYm9keTsKICAgICAgICAgIGNvbnN0IHJlbF9wb3MyID0gbmV3IFZlYzMoKTsKICAgICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZC52c3ViKGdyb3VuZE9iamVjdC5wb3NpdGlvbiwgcmVsX3BvczIpOyAvL3JlbF9wb3MyLmNvcHkod2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkKTsKCiAgICAgICAgICBjb25zdCBzaWRlSW1wID0gbmV3IFZlYzMoKTsKICAgICAgICAgIGF4bGVbaV0uc2NhbGUod2hlZWwuc2lkZUltcHVsc2UsIHNpZGVJbXApOyAvLyBTY2FsZSB0aGUgcmVsYXRpdmUgcG9zaXRpb24gaW4gdGhlIHVwIGRpcmVjdGlvbiB3aXRoIHJvbGxJbmZsdWVuY2UuCiAgICAgICAgICAvLyBJZiByb2xsSW5mbHVlbmNlIGlzIDEsIHRoZSBpbXB1bHNlIHdpbGwgYmUgYXBwbGllZCBvbiB0aGUgaGl0UG9pbnQgKGVhc3kgdG8gcm9sbCBvdmVyKSwgaWYgaXQgaXMgemVybyBpdCB3aWxsIGJlIGFwcGxpZWQgaW4gdGhlIHNhbWUgcGxhbmUgYXMgdGhlIGNlbnRlciBvZiBtYXNzIChub3QgZWFzeSB0byByb2xsIG92ZXIpLgoKICAgICAgICAgIGNoYXNzaXNCb2R5LnZlY3RvclRvTG9jYWxGcmFtZShyZWxfcG9zLCByZWxfcG9zKTsKICAgICAgICAgIHJlbF9wb3NbJ3h5eidbdGhpcy5pbmRleFVwQXhpc11dICo9IHdoZWVsLnJvbGxJbmZsdWVuY2U7CiAgICAgICAgICBjaGFzc2lzQm9keS52ZWN0b3JUb1dvcmxkRnJhbWUocmVsX3BvcywgcmVsX3Bvcyk7CiAgICAgICAgICBjaGFzc2lzQm9keS5hcHBseUltcHVsc2Uoc2lkZUltcCwgcmVsX3Bvcyk7IC8vYXBwbHkgZnJpY3Rpb24gaW1wdWxzZSBvbiB0aGUgZ3JvdW5kCgogICAgICAgICAgc2lkZUltcC5zY2FsZSgtMSwgc2lkZUltcCk7CiAgICAgICAgICBncm91bmRPYmplY3QuYXBwbHlJbXB1bHNlKHNpZGVJbXAsIHJlbF9wb3MyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgfQogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFZlYzQgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFZlYzUgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFZlYzYgPSBuZXcgVmVjMygpOwogIG5ldyBSYXkoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IGNhc3RSYXlfcmF5dmVjdG9yID0gbmV3IFZlYzMoKTsKICBjb25zdCBjYXN0UmF5X3RhcmdldCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZGlyZWN0aW9ucyA9IFtuZXcgVmVjMygxLCAwLCAwKSwgbmV3IFZlYzMoMCwgMSwgMCksIG5ldyBWZWMzKDAsIDAsIDEpXTsKICBjb25zdCB1cGRhdGVGcmljdGlvbl9zdXJmTm9ybWFsV1Nfc2NhbGVkX3Byb2ogPSBuZXcgVmVjMygpOwogIGNvbnN0IHVwZGF0ZUZyaWN0aW9uX2F4bGUgPSBbXTsKICBjb25zdCB1cGRhdGVGcmljdGlvbl9mb3J3YXJkV1MgPSBbXTsKICBjb25zdCBzaWRlRnJpY3Rpb25TdGlmZm5lc3MyID0gMTsKICBjb25zdCBjYWxjUm9sbGluZ0ZyaWN0aW9uX3ZlbDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNhbGNSb2xsaW5nRnJpY3Rpb25fdmVsMiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY2FsY1JvbGxpbmdGcmljdGlvbl92ZWwgPSBuZXcgVmVjMygpOwoKICBmdW5jdGlvbiBjYWxjUm9sbGluZ0ZyaWN0aW9uKGJvZHkwLCBib2R5MSwgZnJpY3Rpb25Qb3NXb3JsZCwgZnJpY3Rpb25EaXJlY3Rpb25Xb3JsZCwgbWF4SW1wdWxzZSkgewogICAgbGV0IGoxID0gMDsKICAgIGNvbnN0IGNvbnRhY3RQb3NXb3JsZCA9IGZyaWN0aW9uUG9zV29ybGQ7IC8vIGNvbnN0IHJlbF9wb3MxID0gbmV3IFZlYzMoKTsKICAgIC8vIGNvbnN0IHJlbF9wb3MyID0gbmV3IFZlYzMoKTsKCiAgICBjb25zdCB2ZWwxID0gY2FsY1JvbGxpbmdGcmljdGlvbl92ZWwxOwogICAgY29uc3QgdmVsMiA9IGNhbGNSb2xsaW5nRnJpY3Rpb25fdmVsMjsKICAgIGNvbnN0IHZlbCA9IGNhbGNSb2xsaW5nRnJpY3Rpb25fdmVsOyAvLyBjb250YWN0UG9zV29ybGQudnN1Yihib2R5MC5wb3NpdGlvbiwgcmVsX3BvczEpOwogICAgLy8gY29udGFjdFBvc1dvcmxkLnZzdWIoYm9keTEucG9zaXRpb24sIHJlbF9wb3MyKTsKCiAgICBib2R5MC5nZXRWZWxvY2l0eUF0V29ybGRQb2ludChjb250YWN0UG9zV29ybGQsIHZlbDEpOwogICAgYm9keTEuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQoY29udGFjdFBvc1dvcmxkLCB2ZWwyKTsKICAgIHZlbDEudnN1Yih2ZWwyLCB2ZWwpOwogICAgY29uc3QgdnJlbCA9IGZyaWN0aW9uRGlyZWN0aW9uV29ybGQuZG90KHZlbCk7CiAgICBjb25zdCBkZW5vbTAgPSBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yKGJvZHkwLCBmcmljdGlvblBvc1dvcmxkLCBmcmljdGlvbkRpcmVjdGlvbldvcmxkKTsKICAgIGNvbnN0IGRlbm9tMSA9IGNvbXB1dGVJbXB1bHNlRGVub21pbmF0b3IoYm9keTEsIGZyaWN0aW9uUG9zV29ybGQsIGZyaWN0aW9uRGlyZWN0aW9uV29ybGQpOwogICAgY29uc3QgcmVsYXhhdGlvbiA9IDE7CiAgICBjb25zdCBqYWNEaWFnQUJJbnYgPSByZWxheGF0aW9uIC8gKGRlbm9tMCArIGRlbm9tMSk7IC8vIGNhbGN1bGF0ZSBqIHRoYXQgbW92ZXMgdXMgdG8gemVybyByZWxhdGl2ZSB2ZWxvY2l0eQoKICAgIGoxID0gLXZyZWwgKiBqYWNEaWFnQUJJbnY7CgogICAgaWYgKG1heEltcHVsc2UgPCBqMSkgewogICAgICBqMSA9IG1heEltcHVsc2U7CiAgICB9CgogICAgaWYgKGoxIDwgLW1heEltcHVsc2UpIHsKICAgICAgajEgPSAtbWF4SW1wdWxzZTsKICAgIH0KCiAgICByZXR1cm4gajE7CiAgfQoKICBjb25zdCBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX3IwID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX2MwID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX3ZlYyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY29tcHV0ZUltcHVsc2VEZW5vbWluYXRvcl9tID0gbmV3IFZlYzMoKTsKCiAgZnVuY3Rpb24gY29tcHV0ZUltcHVsc2VEZW5vbWluYXRvcihib2R5LCBwb3MsIG5vcm1hbCkgewogICAgY29uc3QgcjAgPSBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX3IwOwogICAgY29uc3QgYzAgPSBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX2MwOwogICAgY29uc3QgdmVjID0gY29tcHV0ZUltcHVsc2VEZW5vbWluYXRvcl92ZWM7CiAgICBjb25zdCBtID0gY29tcHV0ZUltcHVsc2VEZW5vbWluYXRvcl9tOwogICAgcG9zLnZzdWIoYm9keS5wb3NpdGlvbiwgcjApOwogICAgcjAuY3Jvc3Mobm9ybWFsLCBjMCk7CiAgICBib2R5LmludkluZXJ0aWFXb3JsZC52bXVsdChjMCwgbSk7CiAgICBtLmNyb3NzKHIwLCB2ZWMpOwogICAgcmV0dXJuIGJvZHkuaW52TWFzcyArIG5vcm1hbC5kb3QodmVjKTsKICB9CgogIGNvbnN0IHJlc29sdmVTaW5nbGVCaWxhdGVyYWxfdmVsMSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcmVzb2x2ZVNpbmdsZUJpbGF0ZXJhbF92ZWwyID0gbmV3IFZlYzMoKTsKICBjb25zdCByZXNvbHZlU2luZ2xlQmlsYXRlcmFsX3ZlbCA9IG5ldyBWZWMzKCk7IC8vIGJpbGF0ZXJhbCBjb25zdHJhaW50IGJldHdlZW4gdHdvIGR5bmFtaWMgb2JqZWN0cwoKICBmdW5jdGlvbiByZXNvbHZlU2luZ2xlQmlsYXRlcmFsKGJvZHkxLCBwb3MxLCBib2R5MiwgcG9zMiwgbm9ybWFsKSB7CiAgICBjb25zdCBub3JtYWxMZW5TcXIgPSBub3JtYWwubGVuZ3RoU3F1YXJlZCgpOwoKICAgIGlmIChub3JtYWxMZW5TcXIgPiAxLjEpIHsKICAgICAgcmV0dXJuIDA7IC8vIG5vIGltcHVsc2UKICAgIH0gLy8gY29uc3QgcmVsX3BvczEgPSBuZXcgVmVjMygpOwogICAgLy8gY29uc3QgcmVsX3BvczIgPSBuZXcgVmVjMygpOwogICAgLy8gcG9zMS52c3ViKGJvZHkxLnBvc2l0aW9uLCByZWxfcG9zMSk7CiAgICAvLyBwb3MyLnZzdWIoYm9keTIucG9zaXRpb24sIHJlbF9wb3MyKTsKCgogICAgY29uc3QgdmVsMSA9IHJlc29sdmVTaW5nbGVCaWxhdGVyYWxfdmVsMTsKICAgIGNvbnN0IHZlbDIgPSByZXNvbHZlU2luZ2xlQmlsYXRlcmFsX3ZlbDI7CiAgICBjb25zdCB2ZWwgPSByZXNvbHZlU2luZ2xlQmlsYXRlcmFsX3ZlbDsKICAgIGJvZHkxLmdldFZlbG9jaXR5QXRXb3JsZFBvaW50KHBvczEsIHZlbDEpOwogICAgYm9keTIuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQocG9zMiwgdmVsMik7CiAgICB2ZWwxLnZzdWIodmVsMiwgdmVsKTsKICAgIGNvbnN0IHJlbF92ZWwgPSBub3JtYWwuZG90KHZlbCk7CiAgICBjb25zdCBjb250YWN0RGFtcGluZyA9IDAuMjsKICAgIGNvbnN0IG1hc3NUZXJtID0gMSAvIChib2R5MS5pbnZNYXNzICsgYm9keTIuaW52TWFzcyk7CiAgICBjb25zdCBpbXB1bHNlID0gLWNvbnRhY3REYW1waW5nICogcmVsX3ZlbCAqIG1hc3NUZXJtOwogICAgcmV0dXJuIGltcHVsc2U7CiAgfQoKICAvKioKICAgKiBTcGhlcmljYWwgc2hhcGUKICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCByYWRpdXMgPSAxCiAgICogICAgIGNvbnN0IHNwaGVyZVNoYXBlID0gbmV3IENBTk5PTi5TcGhlcmUocmFkaXVzKQogICAqICAgICBjb25zdCBzcGhlcmVCb2R5ID0gbmV3IENBTk5PTi5Cb2R5KHsgbWFzczogMSwgc2hhcGU6IHNwaGVyZVNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoc3BoZXJlQm9keSkKICAgKi8KICBjbGFzcyBTcGhlcmUgZXh0ZW5kcyBTaGFwZSB7CiAgICAvKioKICAgICAqIFRoZSByYWRpdXMgb2YgdGhlIHNwaGVyZS4KICAgICAqLwoKICAgIC8qKgogICAgICoKICAgICAqIEBwYXJhbSByYWRpdXMgVGhlIHJhZGl1cyBvZiB0aGUgc3BoZXJlLCBhIG5vbi1uZWdhdGl2ZSBudW1iZXIuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKHJhZGl1cykgewogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuU1BIRVJFCiAgICAgIH0pOwogICAgICB0aGlzLnJhZGl1cyA9IHJhZGl1cyAhPT0gdW5kZWZpbmVkID8gcmFkaXVzIDogMS4wOwoKICAgICAgaWYgKHRoaXMucmFkaXVzIDwgMCkgewogICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIHNwaGVyZSByYWRpdXMgY2Fubm90IGJlIG5lZ2F0aXZlLicpOwogICAgICB9CgogICAgICB0aGlzLnVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCk7CiAgICB9CiAgICAvKiogY2FsY3VsYXRlTG9jYWxJbmVydGlhICovCgoKICAgIGNhbGN1bGF0ZUxvY2FsSW5lcnRpYShtYXNzLCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgY29uc3QgSSA9IDIuMCAqIG1hc3MgKiB0aGlzLnJhZGl1cyAqIHRoaXMucmFkaXVzIC8gNS4wOwogICAgICB0YXJnZXQueCA9IEk7CiAgICAgIHRhcmdldC55ID0gSTsKICAgICAgdGFyZ2V0LnogPSBJOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqIHZvbHVtZSAqLwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIHJldHVybiA0LjAgKiBNYXRoLlBJICogTWF0aC5wb3codGhpcy5yYWRpdXMsIDMpIC8gMy4wOwogICAgfQoKICAgIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCkgewogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gdGhpcy5yYWRpdXM7CiAgICB9CgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgY29uc3QgciA9IHRoaXMucmFkaXVzOwogICAgICBjb25zdCBheGVzID0gWyd4JywgJ3knLCAneiddOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBheGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgYXggPSBheGVzW2ldOwogICAgICAgIG1pbltheF0gPSBwb3NbYXhdIC0gcjsKICAgICAgICBtYXhbYXhdID0gcG9zW2F4XSArIHI7CiAgICAgIH0KICAgIH0KCiAgfQogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOyAvLyBUZW1wIHZlY3RvcnMgZm9yIGNhbGN1bGF0aW9uCgogIG5ldyBWZWMzKCk7IC8vIFJlbGF0aXZlIHZlbG9jaXR5CgogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQ3lsaW5kZXIgY2xhc3MuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3QgcmFkaXVzVG9wID0gMC41CiAgICogICAgIGNvbnN0IHJhZGl1c0JvdHRvbSA9IDAuNQogICAqICAgICBjb25zdCBoZWlnaHQgPSAyCiAgICogICAgIGNvbnN0IG51bVNlZ21lbnRzID0gMTIKICAgKiAgICAgY29uc3QgY3lsaW5kZXJTaGFwZSA9IG5ldyBDQU5OT04uQ3lsaW5kZXIocmFkaXVzVG9wLCByYWRpdXNCb3R0b20sIGhlaWdodCwgbnVtU2VnbWVudHMpCiAgICogICAgIGNvbnN0IGN5bGluZGVyQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDEsIHNoYXBlOiBjeWxpbmRlclNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoY3lsaW5kZXJCb2R5KQogICAqLwoKICBjbGFzcyBDeWxpbmRlciBleHRlbmRzIENvbnZleFBvbHloZWRyb24gewogICAgLyoqIFRoZSByYWRpdXMgb2YgdGhlIHRvcCBvZiB0aGUgQ3lsaW5kZXIuICovCgogICAgLyoqIFRoZSByYWRpdXMgb2YgdGhlIGJvdHRvbSBvZiB0aGUgQ3lsaW5kZXIuICovCgogICAgLyoqIFRoZSBoZWlnaHQgb2YgdGhlIEN5bGluZGVyLiAqLwoKICAgIC8qKiBUaGUgbnVtYmVyIG9mIHNlZ21lbnRzIHRvIGJ1aWxkIHRoZSBjeWxpbmRlciBvdXQgb2YuICovCgogICAgLyoqCiAgICAgKiBAcGFyYW0gcmFkaXVzVG9wIFRoZSByYWRpdXMgb2YgdGhlIHRvcCBvZiB0aGUgQ3lsaW5kZXIuCiAgICAgKiBAcGFyYW0gcmFkaXVzQm90dG9tIFRoZSByYWRpdXMgb2YgdGhlIGJvdHRvbSBvZiB0aGUgQ3lsaW5kZXIuCiAgICAgKiBAcGFyYW0gaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIEN5bGluZGVyLgogICAgICogQHBhcmFtIG51bVNlZ21lbnRzIFRoZSBudW1iZXIgb2Ygc2VnbWVudHMgdG8gYnVpbGQgdGhlIGN5bGluZGVyIG91dCBvZi4KICAgICAqLwogICAgY29uc3RydWN0b3IocmFkaXVzVG9wLCByYWRpdXNCb3R0b20sIGhlaWdodCwgbnVtU2VnbWVudHMpIHsKICAgICAgaWYgKHJhZGl1c1RvcCA9PT0gdm9pZCAwKSB7CiAgICAgICAgcmFkaXVzVG9wID0gMTsKICAgICAgfQoKICAgICAgaWYgKHJhZGl1c0JvdHRvbSA9PT0gdm9pZCAwKSB7CiAgICAgICAgcmFkaXVzQm90dG9tID0gMTsKICAgICAgfQoKICAgICAgaWYgKGhlaWdodCA9PT0gdm9pZCAwKSB7CiAgICAgICAgaGVpZ2h0ID0gMTsKICAgICAgfQoKICAgICAgaWYgKG51bVNlZ21lbnRzID09PSB2b2lkIDApIHsKICAgICAgICBudW1TZWdtZW50cyA9IDg7CiAgICAgIH0KCiAgICAgIGlmIChyYWRpdXNUb3AgPCAwKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgY3lsaW5kZXIgcmFkaXVzVG9wIGNhbm5vdCBiZSBuZWdhdGl2ZS4nKTsKICAgICAgfQoKICAgICAgaWYgKHJhZGl1c0JvdHRvbSA8IDApIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjeWxpbmRlciByYWRpdXNCb3R0b20gY2Fubm90IGJlIG5lZ2F0aXZlLicpOwogICAgICB9CgogICAgICBjb25zdCBOID0gbnVtU2VnbWVudHM7CiAgICAgIGNvbnN0IHZlcnRpY2VzID0gW107CiAgICAgIGNvbnN0IGF4ZXMgPSBbXTsKICAgICAgY29uc3QgZmFjZXMgPSBbXTsKICAgICAgY29uc3QgYm90dG9tZmFjZSA9IFtdOwogICAgICBjb25zdCB0b3BmYWNlID0gW107CiAgICAgIGNvbnN0IGNvcyA9IE1hdGguY29zOwogICAgICBjb25zdCBzaW4gPSBNYXRoLnNpbjsgLy8gRmlyc3QgYm90dG9tIHBvaW50CgogICAgICB2ZXJ0aWNlcy5wdXNoKG5ldyBWZWMzKC1yYWRpdXNCb3R0b20gKiBzaW4oMCksIC1oZWlnaHQgKiAwLjUsIHJhZGl1c0JvdHRvbSAqIGNvcygwKSkpOwogICAgICBib3R0b21mYWNlLnB1c2goMCk7IC8vIEZpcnN0IHRvcCBwb2ludAoKICAgICAgdmVydGljZXMucHVzaChuZXcgVmVjMygtcmFkaXVzVG9wICogc2luKDApLCBoZWlnaHQgKiAwLjUsIHJhZGl1c1RvcCAqIGNvcygwKSkpOwogICAgICB0b3BmYWNlLnB1c2goMSk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE47IGkrKykgewogICAgICAgIGNvbnN0IHRoZXRhID0gMiAqIE1hdGguUEkgLyBOICogKGkgKyAxKTsKICAgICAgICBjb25zdCB0aGV0YU4gPSAyICogTWF0aC5QSSAvIE4gKiAoaSArIDAuNSk7CgogICAgICAgIGlmIChpIDwgTiAtIDEpIHsKICAgICAgICAgIC8vIEJvdHRvbQogICAgICAgICAgdmVydGljZXMucHVzaChuZXcgVmVjMygtcmFkaXVzQm90dG9tICogc2luKHRoZXRhKSwgLWhlaWdodCAqIDAuNSwgcmFkaXVzQm90dG9tICogY29zKHRoZXRhKSkpOwogICAgICAgICAgYm90dG9tZmFjZS5wdXNoKDIgKiBpICsgMik7IC8vIFRvcAoKICAgICAgICAgIHZlcnRpY2VzLnB1c2gobmV3IFZlYzMoLXJhZGl1c1RvcCAqIHNpbih0aGV0YSksIGhlaWdodCAqIDAuNSwgcmFkaXVzVG9wICogY29zKHRoZXRhKSkpOwogICAgICAgICAgdG9wZmFjZS5wdXNoKDIgKiBpICsgMyk7IC8vIEZhY2UKCiAgICAgICAgICBmYWNlcy5wdXNoKFsyICogaSwgMiAqIGkgKyAxLCAyICogaSArIDMsIDIgKiBpICsgMl0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmYWNlcy5wdXNoKFsyICogaSwgMiAqIGkgKyAxLCAxLCAwXSk7IC8vIENvbm5lY3QKICAgICAgICB9IC8vIEF4aXM6IHdlIGNhbiBjdXQgb2ZmIGhhbGYgb2YgdGhlbSBpZiB3ZSBoYXZlIGV2ZW4gbnVtYmVyIG9mIHNlZ21lbnRzCgoKICAgICAgICBpZiAoTiAlIDIgPT09IDEgfHwgaSA8IE4gLyAyKSB7CiAgICAgICAgICBheGVzLnB1c2gobmV3IFZlYzMoLXNpbih0aGV0YU4pLCAwLCBjb3ModGhldGFOKSkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZmFjZXMucHVzaChib3R0b21mYWNlKTsKICAgICAgYXhlcy5wdXNoKG5ldyBWZWMzKDAsIDEsIDApKTsgLy8gUmVvcmRlciB0b3AgZmFjZQoKICAgICAgY29uc3QgdGVtcCA9IFtdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b3BmYWNlLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGVtcC5wdXNoKHRvcGZhY2VbdG9wZmFjZS5sZW5ndGggLSBpIC0gMV0pOwogICAgICB9CgogICAgICBmYWNlcy5wdXNoKHRlbXApOwogICAgICBzdXBlcih7CiAgICAgICAgdmVydGljZXMsCiAgICAgICAgZmFjZXMsCiAgICAgICAgYXhlcwogICAgICB9KTsKICAgICAgdGhpcy50eXBlID0gU2hhcGUudHlwZXMuQ1lMSU5ERVI7CiAgICAgIHRoaXMucmFkaXVzVG9wID0gcmFkaXVzVG9wOwogICAgICB0aGlzLnJhZGl1c0JvdHRvbSA9IHJhZGl1c0JvdHRvbTsKICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CiAgICAgIHRoaXMubnVtU2VnbWVudHMgPSBudW1TZWdtZW50czsKICAgIH0KCiAgfQoKICAvKioKICAgKiBQYXJ0aWNsZSBzaGFwZS4KICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCBwYXJ0aWNsZVNoYXBlID0gbmV3IENBTk5PTi5QYXJ0aWNsZSgpCiAgICogICAgIGNvbnN0IHBhcnRpY2xlQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDEsIHNoYXBlOiBwYXJ0aWNsZVNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkocGFydGljbGVCb2R5KQogICAqLwogIGNsYXNzIFBhcnRpY2xlIGV4dGVuZHMgU2hhcGUgewogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHN1cGVyKHsKICAgICAgICB0eXBlOiBTaGFwZS50eXBlcy5QQVJUSUNMRQogICAgICB9KTsKICAgIH0KICAgIC8qKgogICAgICogY2FsY3VsYXRlTG9jYWxJbmVydGlhCiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0YXJnZXQuc2V0KDAsIDAsIDApOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQoKICAgIHZvbHVtZSgpIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSAwOwogICAgfQoKICAgIGNhbGN1bGF0ZVdvcmxkQUFCQihwb3MsIHF1YXQsIG1pbiwgbWF4KSB7CiAgICAgIC8vIEdldCBlYWNoIGF4aXMgbWF4CiAgICAgIG1pbi5jb3B5KHBvcyk7CiAgICAgIG1heC5jb3B5KHBvcyk7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQSBwbGFuZSwgZmFjaW5nIGluIHRoZSBaIGRpcmVjdGlvbi4gVGhlIHBsYW5lIGhhcyBpdHMgc3VyZmFjZSBhdCB6PTAgYW5kIGV2ZXJ5dGhpbmcgYmVsb3cgej0wIGlzIGFzc3VtZWQgdG8gYmUgc29saWQgcGxhbmUuIFRvIG1ha2UgdGhlIHBsYW5lIGZhY2UgaW4gc29tZSBvdGhlciBkaXJlY3Rpb24gdGhhbiB6LCB5b3UgbXVzdCBwdXQgaXQgaW5zaWRlIGEgQm9keSBhbmQgcm90YXRlIHRoYXQgYm9keS4gU2VlIHRoZSBkZW1vcy4KICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCBwbGFuZVNoYXBlID0gbmV3IENBTk5PTi5QbGFuZSgpCiAgICogICAgIGNvbnN0IHBsYW5lQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDAsIHNoYXBlOiAgcGxhbmVTaGFwZSB9KQogICAqICAgICBwbGFuZUJvZHkucXVhdGVybmlvbi5zZXRGcm9tRXVsZXIoLU1hdGguUEkgLyAyLCAwLCAwKSAvLyBtYWtlIGl0IGZhY2UgdXAKICAgKiAgICAgd29ybGQuYWRkQm9keShwbGFuZUJvZHkpCiAgICovCiAgY2xhc3MgUGxhbmUgZXh0ZW5kcyBTaGFwZSB7CiAgICAvKiogd29ybGROb3JtYWwgKi8KCiAgICAvKiogd29ybGROb3JtYWxOZWVkc1VwZGF0ZSAqLwogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHN1cGVyKHsKICAgICAgICB0eXBlOiBTaGFwZS50eXBlcy5QTEFORQogICAgICB9KTsgLy8gV29ybGQgb3JpZW50ZWQgbm9ybWFsCgogICAgICB0aGlzLndvcmxkTm9ybWFsID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy53b3JsZE5vcm1hbE5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyA9IE51bWJlci5NQVhfVkFMVUU7CiAgICB9CiAgICAvKiogY29tcHV0ZVdvcmxkTm9ybWFsICovCgoKICAgIGNvbXB1dGVXb3JsZE5vcm1hbChxdWF0KSB7CiAgICAgIGNvbnN0IG4gPSB0aGlzLndvcmxkTm9ybWFsOwogICAgICBuLnNldCgwLCAwLCAxKTsKICAgICAgcXVhdC52bXVsdChuLCBuKTsKICAgICAgdGhpcy53b3JsZE5vcm1hbE5lZWRzVXBkYXRlID0gZmFsc2U7CiAgICB9CgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQoKICAgIHZvbHVtZSgpIHsKICAgICAgcmV0dXJuICgvLyBUaGUgcGxhbmUgaXMgaW5maW5pdGUuLi4KICAgICAgICBOdW1iZXIuTUFYX1ZBTFVFCiAgICAgICk7CiAgICB9CgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgLy8gVGhlIHBsYW5lIEFBQkIgaXMgaW5maW5pdGUsIGV4Y2VwdCBpZiB0aGUgbm9ybWFsIGlzIHBvaW50aW5nIGFsb25nIGFueSBheGlzCiAgICAgIHRlbXBOb3JtYWwuc2V0KDAsIDAsIDEpOyAvLyBEZWZhdWx0IHBsYW5lIG5vcm1hbCBpcyB6CgogICAgICBxdWF0LnZtdWx0KHRlbXBOb3JtYWwsIHRlbXBOb3JtYWwpOwogICAgICBjb25zdCBtYXhWYWwgPSBOdW1iZXIuTUFYX1ZBTFVFOwogICAgICBtaW4uc2V0KC1tYXhWYWwsIC1tYXhWYWwsIC1tYXhWYWwpOwogICAgICBtYXguc2V0KG1heFZhbCwgbWF4VmFsLCBtYXhWYWwpOwoKICAgICAgaWYgKHRlbXBOb3JtYWwueCA9PT0gMSkgewogICAgICAgIG1heC54ID0gcG9zLng7CiAgICAgIH0gZWxzZSBpZiAodGVtcE5vcm1hbC54ID09PSAtMSkgewogICAgICAgIG1pbi54ID0gcG9zLng7CiAgICAgIH0KCiAgICAgIGlmICh0ZW1wTm9ybWFsLnkgPT09IDEpIHsKICAgICAgICBtYXgueSA9IHBvcy55OwogICAgICB9IGVsc2UgaWYgKHRlbXBOb3JtYWwueSA9PT0gLTEpIHsKICAgICAgICBtaW4ueSA9IHBvcy55OwogICAgICB9CgogICAgICBpZiAodGVtcE5vcm1hbC56ID09PSAxKSB7CiAgICAgICAgbWF4LnogPSBwb3MuejsKICAgICAgfSBlbHNlIGlmICh0ZW1wTm9ybWFsLnogPT09IC0xKSB7CiAgICAgICAgbWluLnogPSBwb3MuejsKICAgICAgfQogICAgfQoKICAgIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCkgewogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gTnVtYmVyLk1BWF9WQUxVRTsKICAgIH0KCiAgfQogIGNvbnN0IHRlbXBOb3JtYWwgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBIZWlnaHRmaWVsZCBzaGFwZSBjbGFzcy4gSGVpZ2h0IGRhdGEgaXMgZ2l2ZW4gYXMgYW4gYXJyYXkuIFRoZXNlIGRhdGEgcG9pbnRzIGFyZSBzcHJlYWQgb3V0IGV2ZW5seSB3aXRoIGEgZ2l2ZW4gZGlzdGFuY2UuCiAgICogQHRvZG8gU2hvdWxkIGJlIHBvc3NpYmxlIHRvIHVzZSBhbG9uZyBhbGwgYXhlcywgbm90IGp1c3QgeQogICAqIEB0b2RvIHNob3VsZCBiZSBwb3NzaWJsZSB0byBzY2FsZSBhbG9uZyBhbGwgYXhlcwogICAqIEB0b2RvIFJlZmFjdG9yIGVsZW1lbnRTaXplIHRvIGVsZW1lbnRTaXplWCBhbmQgZWxlbWVudFNpemVZCiAgICoKICAgKiBAZXhhbXBsZQogICAqICAgICAvLyBHZW5lcmF0ZSBzb21lIGhlaWdodCBkYXRhICh5LXZhbHVlcykuCiAgICogICAgIGNvbnN0IGRhdGEgPSBbXQogICAqICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwMDA7IGkrKykgewogICAqICAgICAgICAgY29uc3QgeSA9IDAuNSAqIE1hdGguY29zKDAuMiAqIGkpCiAgICogICAgICAgICBkYXRhLnB1c2goeSkKICAgKiAgICAgfQogICAqCiAgICogICAgIC8vIENyZWF0ZSB0aGUgaGVpZ2h0ZmllbGQgc2hhcGUKICAgKiAgICAgY29uc3QgaGVpZ2h0ZmllbGRTaGFwZSA9IG5ldyBDQU5OT04uSGVpZ2h0ZmllbGQoZGF0YSwgewogICAqICAgICAgICAgZWxlbWVudFNpemU6IDEgLy8gRGlzdGFuY2UgYmV0d2VlbiB0aGUgZGF0YSBwb2ludHMgaW4gWCBhbmQgWSBkaXJlY3Rpb25zCiAgICogICAgIH0pCiAgICogICAgIGNvbnN0IGhlaWdodGZpZWxkQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IHNoYXBlOiBoZWlnaHRmaWVsZFNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoaGVpZ2h0ZmllbGRCb2R5KQogICAqLwogIGNsYXNzIEhlaWdodGZpZWxkIGV4dGVuZHMgU2hhcGUgewogICAgLyoqCiAgICAgKiBBbiBhcnJheSBvZiBudW1iZXJzLCBvciBoZWlnaHQgdmFsdWVzLCB0aGF0IGFyZSBzcHJlYWQgb3V0IGFsb25nIHRoZSB4IGF4aXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIE1heCB2YWx1ZSBvZiB0aGUgZGF0YSBwb2ludHMgaW4gdGhlIGRhdGEgYXJyYXkuCiAgICAgKi8KCiAgICAvKioKICAgICAqIE1pbmltdW0gdmFsdWUgb2YgdGhlIGRhdGEgcG9pbnRzIGluIHRoZSBkYXRhIGFycmF5LgogICAgICovCgogICAgLyoqCiAgICAgKiBXb3JsZCBzcGFjaW5nIGJldHdlZW4gdGhlIGRhdGEgcG9pbnRzIGluIFggYW5kIFkgZGlyZWN0aW9uLgogICAgICogQHRvZG8gZWxlbWVudFNpemVYIGFuZCBZCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIEBkZWZhdWx0IHRydWUKICAgICAqLwoKICAgIC8qKgogICAgICogQHBhcmFtIGRhdGEgQW4gYXJyYXkgb2YgbnVtYmVycywgb3IgaGVpZ2h0IHZhbHVlcywgdGhhdCBhcmUgc3ByZWFkIG91dCBhbG9uZyB0aGUgeCBheGlzLgogICAgICovCiAgICBjb25zdHJ1Y3RvcihkYXRhLCBvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIG9wdGlvbnMgPSBVdGlscy5kZWZhdWx0cyhvcHRpb25zLCB7CiAgICAgICAgbWF4VmFsdWU6IG51bGwsCiAgICAgICAgbWluVmFsdWU6IG51bGwsCiAgICAgICAgZWxlbWVudFNpemU6IDEKICAgICAgfSk7CiAgICAgIHN1cGVyKHsKICAgICAgICB0eXBlOiBTaGFwZS50eXBlcy5IRUlHSFRGSUVMRAogICAgICB9KTsKICAgICAgdGhpcy5kYXRhID0gZGF0YTsKICAgICAgdGhpcy5tYXhWYWx1ZSA9IG9wdGlvbnMubWF4VmFsdWU7CiAgICAgIHRoaXMubWluVmFsdWUgPSBvcHRpb25zLm1pblZhbHVlOwogICAgICB0aGlzLmVsZW1lbnRTaXplID0gb3B0aW9ucy5lbGVtZW50U2l6ZTsKCiAgICAgIGlmIChvcHRpb25zLm1pblZhbHVlID09PSBudWxsKSB7CiAgICAgICAgdGhpcy51cGRhdGVNaW5WYWx1ZSgpOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy5tYXhWYWx1ZSA9PT0gbnVsbCkgewogICAgICAgIHRoaXMudXBkYXRlTWF4VmFsdWUoKTsKICAgICAgfQoKICAgICAgdGhpcy5jYWNoZUVuYWJsZWQgPSB0cnVlOwogICAgICB0aGlzLnBpbGxhckNvbnZleCA9IG5ldyBDb252ZXhQb2x5aGVkcm9uKCk7CiAgICAgIHRoaXMucGlsbGFyT2Zmc2V0ID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOyAvLyAiaV9qX2lzVXBwZXIiID0+IHsgY29udmV4OiAuLi4sIG9mZnNldDogLi4uIH0KICAgICAgLy8gZm9yIGV4YW1wbGU6CiAgICAgIC8vIF9jYWNoZWRQaWxsYXJzWyIwXzJfMSJdCgogICAgICB0aGlzLl9jYWNoZWRQaWxsYXJzID0ge307CiAgICB9CiAgICAvKioKICAgICAqIENhbGwgd2hlbmV2ZXIgeW91IGNoYW5nZSB0aGUgZGF0YSBhcnJheS4KICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIHRoaXMuX2NhY2hlZFBpbGxhcnMgPSB7fTsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlIHRoZSBgbWluVmFsdWVgIHByb3BlcnR5CiAgICAgKi8KCgogICAgdXBkYXRlTWluVmFsdWUoKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGxldCBtaW5WYWx1ZSA9IGRhdGFbMF1bMF07CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBkYXRhW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBjb25zdCB2ID0gZGF0YVtpXVtqXTsKCiAgICAgICAgICBpZiAodiA8IG1pblZhbHVlKSB7CiAgICAgICAgICAgIG1pblZhbHVlID0gdjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMubWluVmFsdWUgPSBtaW5WYWx1ZTsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlIHRoZSBgbWF4VmFsdWVgIHByb3BlcnR5CiAgICAgKi8KCgogICAgdXBkYXRlTWF4VmFsdWUoKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGxldCBtYXhWYWx1ZSA9IGRhdGFbMF1bMF07CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBkYXRhW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBjb25zdCB2ID0gZGF0YVtpXVtqXTsKCiAgICAgICAgICBpZiAodiA+IG1heFZhbHVlKSB7CiAgICAgICAgICAgIG1heFZhbHVlID0gdjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMubWF4VmFsdWUgPSBtYXhWYWx1ZTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBoZWlnaHQgdmFsdWUgYXQgYW4gaW5kZXguIERvbid0IGZvcmdldCB0byB1cGRhdGUgbWF4VmFsdWUgYW5kIG1pblZhbHVlIGFmdGVyIHlvdSdyZSBkb25lLgogICAgICovCgoKICAgIHNldEhlaWdodFZhbHVlQXRJbmRleCh4aSwgeWksIHZhbHVlKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGRhdGFbeGldW3lpXSA9IHZhbHVlOyAvLyBJbnZhbGlkYXRlIGNhY2hlCgogICAgICB0aGlzLmNsZWFyQ2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpLCBmYWxzZSk7CgogICAgICBpZiAoeGkgPiAwKSB7CiAgICAgICAgdGhpcy5jbGVhckNhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpIC0gMSwgeWksIHRydWUpOwogICAgICAgIHRoaXMuY2xlYXJDYWNoZWRDb252ZXhUcmlhbmdsZVBpbGxhcih4aSAtIDEsIHlpLCBmYWxzZSk7CiAgICAgIH0KCiAgICAgIGlmICh5aSA+IDApIHsKICAgICAgICB0aGlzLmNsZWFyQ2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpIC0gMSwgdHJ1ZSk7CiAgICAgICAgdGhpcy5jbGVhckNhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpLCB5aSAtIDEsIGZhbHNlKTsKICAgICAgfQoKICAgICAgaWYgKHlpID4gMCAmJiB4aSA+IDApIHsKICAgICAgICB0aGlzLmNsZWFyQ2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGkgLSAxLCB5aSAtIDEsIHRydWUpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCBtYXgvbWluIGluIGEgcmVjdGFuZ2xlIGluIHRoZSBtYXRyaXggZGF0YQogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSB0byBzdG9yZSB0aGUgcmVzdWx0cyBpbi4KICAgICAqIEByZXR1cm4gVGhlIHJlc3VsdCBhcnJheSwgaWYgaXQgd2FzIHBhc3NlZCBpbi4gTWluaW11bSB3aWxsIGJlIGF0IHBvc2l0aW9uIDAgYW5kIG1heCBhdCAxLgogICAgICovCgoKICAgIGdldFJlY3RNaW5NYXgoaU1pblgsIGlNaW5ZLCBpTWF4WCwgaU1heFksIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBbXTsKICAgICAgfQoKICAgICAgLy8gR2V0IG1heCBhbmQgbWluIG9mIHRoZSBkYXRhCiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7IC8vIFNldCBmaXJzdCB2YWx1ZQoKICAgICAgbGV0IG1heCA9IHRoaXMubWluVmFsdWU7CgogICAgICBmb3IgKGxldCBpID0gaU1pblg7IGkgPD0gaU1heFg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSBpTWluWTsgaiA8PSBpTWF4WTsgaisrKSB7CiAgICAgICAgICBjb25zdCBoZWlnaHQgPSBkYXRhW2ldW2pdOwoKICAgICAgICAgIGlmIChoZWlnaHQgPiBtYXgpIHsKICAgICAgICAgICAgbWF4ID0gaGVpZ2h0OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmVzdWx0WzBdID0gdGhpcy5taW5WYWx1ZTsKICAgICAgcmVzdWx0WzFdID0gbWF4OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGluZGV4IG9mIGEgbG9jYWwgcG9zaXRpb24gb24gdGhlIGhlaWdodGZpZWxkLiBUaGUgaW5kZXhlcyBpbmRpY2F0ZSB0aGUgcmVjdGFuZ2xlcywgc28gaWYgeW91ciB0ZXJyYWluIGlzIG1hZGUgb2YgTiB4IE4gaGVpZ2h0IGRhdGEgcG9pbnRzLCB5b3Ugd2lsbCBoYXZlIHJlY3RhbmdsZSBpbmRleGVzIHJhbmdpbmcgZnJvbSAwIHRvIE4tMS4KICAgICAqIEBwYXJhbSByZXN1bHQgVHdvLWVsZW1lbnQgYXJyYXkKICAgICAqIEBwYXJhbSBjbGFtcCBJZiB0aGUgcG9zaXRpb24gc2hvdWxkIGJlIGNsYW1wZWQgdG8gdGhlIGhlaWdodGZpZWxkIGVkZ2UuCiAgICAgKi8KCgogICAgZ2V0SW5kZXhPZlBvc2l0aW9uKHgsIHksIHJlc3VsdCwgY2xhbXApIHsKICAgICAgLy8gR2V0IHRoZSBpbmRleCBvZiB0aGUgZGF0YSBwb2ludHMgdG8gdGVzdCBhZ2FpbnN0CiAgICAgIGNvbnN0IHcgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgICBsZXQgeGkgPSBNYXRoLmZsb29yKHggLyB3KTsKICAgICAgbGV0IHlpID0gTWF0aC5mbG9vcih5IC8gdyk7CiAgICAgIHJlc3VsdFswXSA9IHhpOwogICAgICByZXN1bHRbMV0gPSB5aTsKCiAgICAgIGlmIChjbGFtcCkgewogICAgICAgIC8vIENsYW1wIGluZGV4IHRvIGVkZ2VzCiAgICAgICAgaWYgKHhpIDwgMCkgewogICAgICAgICAgeGkgPSAwOwogICAgICAgIH0KCiAgICAgICAgaWYgKHlpIDwgMCkgewogICAgICAgICAgeWkgPSAwOwogICAgICAgIH0KCiAgICAgICAgaWYgKHhpID49IGRhdGEubGVuZ3RoIC0gMSkgewogICAgICAgICAgeGkgPSBkYXRhLmxlbmd0aCAtIDE7CiAgICAgICAgfQoKICAgICAgICBpZiAoeWkgPj0gZGF0YVswXS5sZW5ndGggLSAxKSB7CiAgICAgICAgICB5aSA9IGRhdGFbMF0ubGVuZ3RoIC0gMTsKICAgICAgICB9CiAgICAgIH0gLy8gQmFpbCBvdXQgaWYgd2UgYXJlIG91dCBvZiB0aGUgdGVycmFpbgoKCiAgICAgIGlmICh4aSA8IDAgfHwgeWkgPCAwIHx8IHhpID49IGRhdGEubGVuZ3RoIC0gMSB8fCB5aSA+PSBkYXRhWzBdLmxlbmd0aCAtIDEpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGdldFRyaWFuZ2xlQXQoeCwgeSwgZWRnZUNsYW1wLCBhLCBiLCBjKSB7CiAgICAgIGNvbnN0IGlkeCA9IGdldEhlaWdodEF0X2lkeDsKICAgICAgdGhpcy5nZXRJbmRleE9mUG9zaXRpb24oeCwgeSwgaWR4LCBlZGdlQ2xhbXApOwogICAgICBsZXQgeGkgPSBpZHhbMF07CiAgICAgIGxldCB5aSA9IGlkeFsxXTsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKCiAgICAgIGlmIChlZGdlQ2xhbXApIHsKICAgICAgICB4aSA9IE1hdGgubWluKGRhdGEubGVuZ3RoIC0gMiwgTWF0aC5tYXgoMCwgeGkpKTsKICAgICAgICB5aSA9IE1hdGgubWluKGRhdGFbMF0ubGVuZ3RoIC0gMiwgTWF0aC5tYXgoMCwgeWkpKTsKICAgICAgfQoKICAgICAgY29uc3QgZWxlbWVudFNpemUgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICBjb25zdCBsb3dlckRpc3QyID0gKHggLyBlbGVtZW50U2l6ZSAtIHhpKSAqKiAyICsgKHkgLyBlbGVtZW50U2l6ZSAtIHlpKSAqKiAyOwogICAgICBjb25zdCB1cHBlckRpc3QyID0gKHggLyBlbGVtZW50U2l6ZSAtICh4aSArIDEpKSAqKiAyICsgKHkgLyBlbGVtZW50U2l6ZSAtICh5aSArIDEpKSAqKiAyOwogICAgICBjb25zdCB1cHBlciA9IGxvd2VyRGlzdDIgPiB1cHBlckRpc3QyOwogICAgICB0aGlzLmdldFRyaWFuZ2xlKHhpLCB5aSwgdXBwZXIsIGEsIGIsIGMpOwogICAgICByZXR1cm4gdXBwZXI7CiAgICB9CgogICAgZ2V0Tm9ybWFsQXQoeCwgeSwgZWRnZUNsYW1wLCByZXN1bHQpIHsKICAgICAgY29uc3QgYSA9IGdldE5vcm1hbEF0X2E7CiAgICAgIGNvbnN0IGIgPSBnZXROb3JtYWxBdF9iOwogICAgICBjb25zdCBjID0gZ2V0Tm9ybWFsQXRfYzsKICAgICAgY29uc3QgZTAgPSBnZXROb3JtYWxBdF9lMDsKICAgICAgY29uc3QgZTEgPSBnZXROb3JtYWxBdF9lMTsKICAgICAgdGhpcy5nZXRUcmlhbmdsZUF0KHgsIHksIGVkZ2VDbGFtcCwgYSwgYiwgYyk7CiAgICAgIGIudnN1YihhLCBlMCk7CiAgICAgIGMudnN1YihhLCBlMSk7CiAgICAgIGUwLmNyb3NzKGUxLCByZXN1bHQpOwogICAgICByZXN1bHQubm9ybWFsaXplKCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBBQUJCIG9mIGEgc3F1YXJlIGluIHRoZSBoZWlnaHRmaWVsZAogICAgICogQHBhcmFtIHhpCiAgICAgKiBAcGFyYW0geWkKICAgICAqIEBwYXJhbSByZXN1bHQKICAgICAqLwoKCiAgICBnZXRBYWJiQXRJbmRleCh4aSwgeWksIF9yZWYpIHsKICAgICAgbGV0IHsKICAgICAgICBsb3dlckJvdW5kLAogICAgICAgIHVwcGVyQm91bmQKICAgICAgfSA9IF9yZWY7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGNvbnN0IGVsZW1lbnRTaXplID0gdGhpcy5lbGVtZW50U2l6ZTsKICAgICAgbG93ZXJCb3VuZC5zZXQoeGkgKiBlbGVtZW50U2l6ZSwgeWkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aV1beWldKTsKICAgICAgdXBwZXJCb3VuZC5zZXQoKHhpICsgMSkgKiBlbGVtZW50U2l6ZSwgKHlpICsgMSkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aSArIDFdW3lpICsgMV0pOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGhlaWdodCBpbiB0aGUgaGVpZ2h0ZmllbGQgYXQgYSBnaXZlbiBwb3NpdGlvbgogICAgICovCgoKICAgIGdldEhlaWdodEF0KHgsIHksIGVkZ2VDbGFtcCkgewogICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgICBjb25zdCBhID0gZ2V0SGVpZ2h0QXRfYTsKICAgICAgY29uc3QgYiA9IGdldEhlaWdodEF0X2I7CiAgICAgIGNvbnN0IGMgPSBnZXRIZWlnaHRBdF9jOwogICAgICBjb25zdCBpZHggPSBnZXRIZWlnaHRBdF9pZHg7CiAgICAgIHRoaXMuZ2V0SW5kZXhPZlBvc2l0aW9uKHgsIHksIGlkeCwgZWRnZUNsYW1wKTsKICAgICAgbGV0IHhpID0gaWR4WzBdOwogICAgICBsZXQgeWkgPSBpZHhbMV07CgogICAgICBpZiAoZWRnZUNsYW1wKSB7CiAgICAgICAgeGkgPSBNYXRoLm1pbihkYXRhLmxlbmd0aCAtIDIsIE1hdGgubWF4KDAsIHhpKSk7CiAgICAgICAgeWkgPSBNYXRoLm1pbihkYXRhWzBdLmxlbmd0aCAtIDIsIE1hdGgubWF4KDAsIHlpKSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHVwcGVyID0gdGhpcy5nZXRUcmlhbmdsZUF0KHgsIHksIGVkZ2VDbGFtcCwgYSwgYiwgYyk7CiAgICAgIGJhcnljZW50cmljV2VpZ2h0cyh4LCB5LCBhLngsIGEueSwgYi54LCBiLnksIGMueCwgYy55LCBnZXRIZWlnaHRBdF93ZWlnaHRzKTsKICAgICAgY29uc3QgdyA9IGdldEhlaWdodEF0X3dlaWdodHM7CgogICAgICBpZiAodXBwZXIpIHsKICAgICAgICAvLyBUb3AgdHJpYW5nbGUgdmVydHMKICAgICAgICByZXR1cm4gZGF0YVt4aSArIDFdW3lpICsgMV0gKiB3LnggKyBkYXRhW3hpXVt5aSArIDFdICogdy55ICsgZGF0YVt4aSArIDFdW3lpXSAqIHcuejsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBUb3AgdHJpYW5nbGUgdmVydHMKICAgICAgICByZXR1cm4gZGF0YVt4aV1beWldICogdy54ICsgZGF0YVt4aSArIDFdW3lpXSAqIHcueSArIGRhdGFbeGldW3lpICsgMV0gKiB3Lno7CiAgICAgIH0KICAgIH0KCiAgICBnZXRDYWNoZUNvbnZleFRyaWFuZ2xlUGlsbGFyS2V5KHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSkgewogICAgICByZXR1cm4gYCR7eGl9XyR7eWl9XyR7Z2V0VXBwZXJUcmlhbmdsZSA/IDEgOiAwfWA7CiAgICB9CgogICAgZ2V0Q2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlKSB7CiAgICAgIHJldHVybiB0aGlzLl9jYWNoZWRQaWxsYXJzW3RoaXMuZ2V0Q2FjaGVDb252ZXhUcmlhbmdsZVBpbGxhcktleSh4aSwgeWksIGdldFVwcGVyVHJpYW5nbGUpXTsKICAgIH0KCiAgICBzZXRDYWNoZWRDb252ZXhUcmlhbmdsZVBpbGxhcih4aSwgeWksIGdldFVwcGVyVHJpYW5nbGUsIGNvbnZleCwgb2Zmc2V0KSB7CiAgICAgIHRoaXMuX2NhY2hlZFBpbGxhcnNbdGhpcy5nZXRDYWNoZUNvbnZleFRyaWFuZ2xlUGlsbGFyS2V5KHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSldID0gewogICAgICAgIGNvbnZleCwKICAgICAgICBvZmZzZXQKICAgICAgfTsKICAgIH0KCiAgICBjbGVhckNhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSkgewogICAgICBkZWxldGUgdGhpcy5fY2FjaGVkUGlsbGFyc1t0aGlzLmdldENhY2hlQ29udmV4VHJpYW5nbGVQaWxsYXJLZXkoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlKV07CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhIHRyaWFuZ2xlIGZyb20gdGhlIGhlaWdodGZpZWxkCiAgICAgKi8KCgogICAgZ2V0VHJpYW5nbGUoeGksIHlpLCB1cHBlciwgYSwgYiwgYykgewogICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgICBjb25zdCBlbGVtZW50U2l6ZSA9IHRoaXMuZWxlbWVudFNpemU7CgogICAgICBpZiAodXBwZXIpIHsKICAgICAgICAvLyBUb3AgdHJpYW5nbGUgdmVydHMKICAgICAgICBhLnNldCgoeGkgKyAxKSAqIGVsZW1lbnRTaXplLCAoeWkgKyAxKSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpICsgMV1beWkgKyAxXSk7CiAgICAgICAgYi5zZXQoeGkgKiBlbGVtZW50U2l6ZSwgKHlpICsgMSkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aV1beWkgKyAxXSk7CiAgICAgICAgYy5zZXQoKHhpICsgMSkgKiBlbGVtZW50U2l6ZSwgeWkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aSArIDFdW3lpXSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gVG9wIHRyaWFuZ2xlIHZlcnRzCiAgICAgICAgYS5zZXQoeGkgKiBlbGVtZW50U2l6ZSwgeWkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aV1beWldKTsKICAgICAgICBiLnNldCgoeGkgKyAxKSAqIGVsZW1lbnRTaXplLCB5aSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpICsgMV1beWldKTsKICAgICAgICBjLnNldCh4aSAqIGVsZW1lbnRTaXplLCAoeWkgKyAxKSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpXVt5aSArIDFdKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBHZXQgYSB0cmlhbmdsZSBpbiB0aGUgdGVycmFpbiBpbiB0aGUgZm9ybSBvZiBhIHRyaWFuZ3VsYXIgY29udmV4IHNoYXBlLgogICAgICovCgoKICAgIGdldENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSkgewogICAgICBsZXQgcmVzdWx0ID0gdGhpcy5waWxsYXJDb252ZXg7CiAgICAgIGxldCBvZmZzZXRSZXN1bHQgPSB0aGlzLnBpbGxhck9mZnNldDsKCiAgICAgIGlmICh0aGlzLmNhY2hlRW5hYmxlZCkgewogICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmdldENhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSk7CgogICAgICAgIGlmIChkYXRhKSB7CiAgICAgICAgICB0aGlzLnBpbGxhckNvbnZleCA9IGRhdGEuY29udmV4OwogICAgICAgICAgdGhpcy5waWxsYXJPZmZzZXQgPSBkYXRhLm9mZnNldDsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHJlc3VsdCA9IG5ldyBDb252ZXhQb2x5aGVkcm9uKCk7CiAgICAgICAgb2Zmc2V0UmVzdWx0ID0gbmV3IFZlYzMoKTsKICAgICAgICB0aGlzLnBpbGxhckNvbnZleCA9IHJlc3VsdDsKICAgICAgICB0aGlzLnBpbGxhck9mZnNldCA9IG9mZnNldFJlc3VsdDsKICAgICAgfQoKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKICAgICAgY29uc3QgZWxlbWVudFNpemUgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICBjb25zdCBmYWNlcyA9IHJlc3VsdC5mYWNlczsgLy8gUmV1c2UgdmVydHMgaWYgcG9zc2libGUKCiAgICAgIHJlc3VsdC52ZXJ0aWNlcy5sZW5ndGggPSA2OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA2OyBpKyspIHsKICAgICAgICBpZiAoIXJlc3VsdC52ZXJ0aWNlc1tpXSkgewogICAgICAgICAgcmVzdWx0LnZlcnRpY2VzW2ldID0gbmV3IFZlYzMoKTsKICAgICAgICB9CiAgICAgIH0gLy8gUmV1c2UgZmFjZXMgaWYgcG9zc2libGUKCgogICAgICBmYWNlcy5sZW5ndGggPSA1OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA1OyBpKyspIHsKICAgICAgICBpZiAoIWZhY2VzW2ldKSB7CiAgICAgICAgICBmYWNlc1tpXSA9IFtdOwogICAgICAgIH0KICAgICAgfQoKICAgICAgY29uc3QgdmVydHMgPSByZXN1bHQudmVydGljZXM7CiAgICAgIGNvbnN0IGggPSAoTWF0aC5taW4oZGF0YVt4aV1beWldLCBkYXRhW3hpICsgMV1beWldLCBkYXRhW3hpXVt5aSArIDFdLCBkYXRhW3hpICsgMV1beWkgKyAxXSkgLSB0aGlzLm1pblZhbHVlKSAvIDIgKyB0aGlzLm1pblZhbHVlOwoKICAgICAgaWYgKCFnZXRVcHBlclRyaWFuZ2xlKSB7CiAgICAgICAgLy8gQ2VudGVyIG9mIHRoZSB0cmlhbmdsZSBwaWxsYXIgLSBhbGwgcG9seWdvbnMgYXJlIGdpdmVuIHJlbGF0aXZlIHRvIHRoaXMgb25lCiAgICAgICAgb2Zmc2V0UmVzdWx0LnNldCgoeGkgKyAwLjI1KSAqIGVsZW1lbnRTaXplLCAvLyBzb3J0IG9mIGNlbnRlciBvZiBhIHRyaWFuZ2xlCiAgICAgICAgKHlpICsgMC4yNSkgKiBlbGVtZW50U2l6ZSwgaCAvLyB2ZXJ0aWNhbCBjZW50ZXIKICAgICAgICApOyAvLyBUb3AgdHJpYW5nbGUgdmVydHMKCiAgICAgICAgdmVydHNbMF0uc2V0KC0wLjI1ICogZWxlbWVudFNpemUsIC0wLjI1ICogZWxlbWVudFNpemUsIGRhdGFbeGldW3lpXSAtIGgpOwogICAgICAgIHZlcnRzWzFdLnNldCgwLjc1ICogZWxlbWVudFNpemUsIC0wLjI1ICogZWxlbWVudFNpemUsIGRhdGFbeGkgKyAxXVt5aV0gLSBoKTsKICAgICAgICB2ZXJ0c1syXS5zZXQoLTAuMjUgKiBlbGVtZW50U2l6ZSwgMC43NSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpXVt5aSArIDFdIC0gaCk7IC8vIGJvdHRvbSB0cmlhbmdsZSB2ZXJ0cwoKICAgICAgICB2ZXJ0c1szXS5zZXQoLTAuMjUgKiBlbGVtZW50U2l6ZSwgLTAuMjUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7CiAgICAgICAgdmVydHNbNF0uc2V0KDAuNzUgKiBlbGVtZW50U2l6ZSwgLTAuMjUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7CiAgICAgICAgdmVydHNbNV0uc2V0KC0wLjI1ICogZWxlbWVudFNpemUsIDAuNzUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7IC8vIHRvcCB0cmlhbmdsZQoKICAgICAgICBmYWNlc1swXVswXSA9IDA7CiAgICAgICAgZmFjZXNbMF1bMV0gPSAxOwogICAgICAgIGZhY2VzWzBdWzJdID0gMjsgLy8gYm90dG9tIHRyaWFuZ2xlCgogICAgICAgIGZhY2VzWzFdWzBdID0gNTsKICAgICAgICBmYWNlc1sxXVsxXSA9IDQ7CiAgICAgICAgZmFjZXNbMV1bMl0gPSAzOyAvLyAteCBmYWNpbmcgcXVhZAoKICAgICAgICBmYWNlc1syXVswXSA9IDA7CiAgICAgICAgZmFjZXNbMl1bMV0gPSAyOwogICAgICAgIGZhY2VzWzJdWzJdID0gNTsKICAgICAgICBmYWNlc1syXVszXSA9IDM7IC8vIC15IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzNdWzBdID0gMTsKICAgICAgICBmYWNlc1szXVsxXSA9IDA7CiAgICAgICAgZmFjZXNbM11bMl0gPSAzOwogICAgICAgIGZhY2VzWzNdWzNdID0gNDsgLy8gK3h5IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzRdWzBdID0gNDsKICAgICAgICBmYWNlc1s0XVsxXSA9IDU7CiAgICAgICAgZmFjZXNbNF1bMl0gPSAyOwogICAgICAgIGZhY2VzWzRdWzNdID0gMTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBDZW50ZXIgb2YgdGhlIHRyaWFuZ2xlIHBpbGxhciAtIGFsbCBwb2x5Z29ucyBhcmUgZ2l2ZW4gcmVsYXRpdmUgdG8gdGhpcyBvbmUKICAgICAgICBvZmZzZXRSZXN1bHQuc2V0KCh4aSArIDAuNzUpICogZWxlbWVudFNpemUsIC8vIHNvcnQgb2YgY2VudGVyIG9mIGEgdHJpYW5nbGUKICAgICAgICAoeWkgKyAwLjc1KSAqIGVsZW1lbnRTaXplLCBoIC8vIHZlcnRpY2FsIGNlbnRlcgogICAgICAgICk7IC8vIFRvcCB0cmlhbmdsZSB2ZXJ0cwoKICAgICAgICB2ZXJ0c1swXS5zZXQoMC4yNSAqIGVsZW1lbnRTaXplLCAwLjI1ICogZWxlbWVudFNpemUsIGRhdGFbeGkgKyAxXVt5aSArIDFdIC0gaCk7CiAgICAgICAgdmVydHNbMV0uc2V0KC0wLjc1ICogZWxlbWVudFNpemUsIDAuMjUgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aV1beWkgKyAxXSAtIGgpOwogICAgICAgIHZlcnRzWzJdLnNldCgwLjI1ICogZWxlbWVudFNpemUsIC0wLjc1ICogZWxlbWVudFNpemUsIGRhdGFbeGkgKyAxXVt5aV0gLSBoKTsgLy8gYm90dG9tIHRyaWFuZ2xlIHZlcnRzCgogICAgICAgIHZlcnRzWzNdLnNldCgwLjI1ICogZWxlbWVudFNpemUsIDAuMjUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7CiAgICAgICAgdmVydHNbNF0uc2V0KC0wLjc1ICogZWxlbWVudFNpemUsIDAuMjUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7CiAgICAgICAgdmVydHNbNV0uc2V0KDAuMjUgKiBlbGVtZW50U2l6ZSwgLTAuNzUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7IC8vIFRvcCB0cmlhbmdsZQoKICAgICAgICBmYWNlc1swXVswXSA9IDA7CiAgICAgICAgZmFjZXNbMF1bMV0gPSAxOwogICAgICAgIGZhY2VzWzBdWzJdID0gMjsgLy8gYm90dG9tIHRyaWFuZ2xlCgogICAgICAgIGZhY2VzWzFdWzBdID0gNTsKICAgICAgICBmYWNlc1sxXVsxXSA9IDQ7CiAgICAgICAgZmFjZXNbMV1bMl0gPSAzOyAvLyAreCBmYWNpbmcgcXVhZAoKICAgICAgICBmYWNlc1syXVswXSA9IDI7CiAgICAgICAgZmFjZXNbMl1bMV0gPSA1OwogICAgICAgIGZhY2VzWzJdWzJdID0gMzsKICAgICAgICBmYWNlc1syXVszXSA9IDA7IC8vICt5IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzNdWzBdID0gMzsKICAgICAgICBmYWNlc1szXVsxXSA9IDQ7CiAgICAgICAgZmFjZXNbM11bMl0gPSAxOwogICAgICAgIGZhY2VzWzNdWzNdID0gMDsgLy8gLXh5IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzRdWzBdID0gMTsKICAgICAgICBmYWNlc1s0XVsxXSA9IDQ7CiAgICAgICAgZmFjZXNbNF1bMl0gPSA1OwogICAgICAgIGZhY2VzWzRdWzNdID0gMjsKICAgICAgfQoKICAgICAgcmVzdWx0LmNvbXB1dGVOb3JtYWxzKCk7CiAgICAgIHJlc3VsdC5jb21wdXRlRWRnZXMoKTsKICAgICAgcmVzdWx0LnVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCk7CiAgICAgIHRoaXMuc2V0Q2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlLCByZXN1bHQsIG9mZnNldFJlc3VsdCk7CiAgICB9CgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0YXJnZXQuc2V0KDAsIDAsIDApOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQoKICAgIHZvbHVtZSgpIHsKICAgICAgcmV0dXJuICgvLyBUaGUgdGVycmFpbiBpcyBpbmZpbml0ZQogICAgICAgIE51bWJlci5NQVhfVkFMVUUKICAgICAgKTsKICAgIH0KCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICAvKiogQFRPRE8gZG8gaXQgcHJvcGVybHkgKi8KICAgICAgbWluLnNldCgtTnVtYmVyLk1BWF9WQUxVRSwgLU51bWJlci5NQVhfVkFMVUUsIC1OdW1iZXIuTUFYX1ZBTFVFKTsKICAgICAgbWF4LnNldChOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFKTsKICAgIH0KCiAgICB1cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpIHsKICAgICAgLy8gVXNlIHRoZSBib3VuZGluZyBib3ggb2YgdGhlIG1pbi9tYXggdmFsdWVzCiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGNvbnN0IHMgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gbmV3IFZlYzMoZGF0YS5sZW5ndGggKiBzLCBkYXRhWzBdLmxlbmd0aCAqIHMsIE1hdGgubWF4KE1hdGguYWJzKHRoaXMubWF4VmFsdWUpLCBNYXRoLmFicyh0aGlzLm1pblZhbHVlKSkpLmxlbmd0aCgpOwogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIHRoZSBoZWlnaHQgdmFsdWVzIGZyb20gYW4gaW1hZ2UuIEN1cnJlbnRseSBvbmx5IHN1cHBvcnRlZCBpbiBicm93c2VyLgogICAgICovCgoKICAgIHNldEhlaWdodHNGcm9tSW1hZ2UoaW1hZ2UsIHNjYWxlKSB7CiAgICAgIGNvbnN0IHsKICAgICAgICB4LAogICAgICAgIHosCiAgICAgICAgeQogICAgICB9ID0gc2NhbGU7CiAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpOwogICAgICBjYW52YXMud2lkdGggPSBpbWFnZS53aWR0aDsKICAgICAgY2FudmFzLmhlaWdodCA9IGltYWdlLmhlaWdodDsKICAgICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOwogICAgICBjb250ZXh0LmRyYXdJbWFnZShpbWFnZSwgMCwgMCk7CiAgICAgIGNvbnN0IGltYWdlRGF0YSA9IGNvbnRleHQuZ2V0SW1hZ2VEYXRhKDAsIDAsIGltYWdlLndpZHRoLCBpbWFnZS5oZWlnaHQpOwogICAgICBjb25zdCBtYXRyaXggPSB0aGlzLmRhdGE7CiAgICAgIG1hdHJpeC5sZW5ndGggPSAwOwogICAgICB0aGlzLmVsZW1lbnRTaXplID0gTWF0aC5hYnMoeCkgLyBpbWFnZURhdGEud2lkdGg7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGltYWdlRGF0YS5oZWlnaHQ7IGkrKykgewogICAgICAgIGNvbnN0IHJvdyA9IFtdOwoKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGltYWdlRGF0YS53aWR0aDsgaisrKSB7CiAgICAgICAgICBjb25zdCBhID0gaW1hZ2VEYXRhLmRhdGFbKGkgKiBpbWFnZURhdGEuaGVpZ2h0ICsgaikgKiA0XTsKICAgICAgICAgIGNvbnN0IGIgPSBpbWFnZURhdGEuZGF0YVsoaSAqIGltYWdlRGF0YS5oZWlnaHQgKyBqKSAqIDQgKyAxXTsKICAgICAgICAgIGNvbnN0IGMgPSBpbWFnZURhdGEuZGF0YVsoaSAqIGltYWdlRGF0YS5oZWlnaHQgKyBqKSAqIDQgKyAyXTsKICAgICAgICAgIGNvbnN0IGhlaWdodCA9IChhICsgYiArIGMpIC8gNCAvIDI1NSAqIHo7CgogICAgICAgICAgaWYgKHggPCAwKSB7CiAgICAgICAgICAgIHJvdy5wdXNoKGhlaWdodCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByb3cudW5zaGlmdChoZWlnaHQpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHkgPCAwKSB7CiAgICAgICAgICBtYXRyaXgudW5zaGlmdChyb3cpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBtYXRyaXgucHVzaChyb3cpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy51cGRhdGVNYXhWYWx1ZSgpOwogICAgICB0aGlzLnVwZGF0ZU1pblZhbHVlKCk7CiAgICAgIHRoaXMudXBkYXRlKCk7CiAgICB9CgogIH0KICBjb25zdCBnZXRIZWlnaHRBdF9pZHggPSBbXTsKICBjb25zdCBnZXRIZWlnaHRBdF93ZWlnaHRzID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXRIZWlnaHRBdF9hID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXRIZWlnaHRBdF9iID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXRIZWlnaHRBdF9jID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXROb3JtYWxBdF9hID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXROb3JtYWxBdF9iID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXROb3JtYWxBdF9jID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXROb3JtYWxBdF9lMCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0Tm9ybWFsQXRfZTEgPSBuZXcgVmVjMygpOyAvLyBmcm9tIGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0JhcnljZW50cmljX2Nvb3JkaW5hdGVfc3lzdGVtCgogIGZ1bmN0aW9uIGJhcnljZW50cmljV2VpZ2h0cyh4LCB5LCBheCwgYXksIGJ4LCBieSwgY3gsIGN5LCByZXN1bHQpIHsKICAgIHJlc3VsdC54ID0gKChieSAtIGN5KSAqICh4IC0gY3gpICsgKGN4IC0gYngpICogKHkgLSBjeSkpIC8gKChieSAtIGN5KSAqIChheCAtIGN4KSArIChjeCAtIGJ4KSAqIChheSAtIGN5KSk7CiAgICByZXN1bHQueSA9ICgoY3kgLSBheSkgKiAoeCAtIGN4KSArIChheCAtIGN4KSAqICh5IC0gY3kpKSAvICgoYnkgLSBjeSkgKiAoYXggLSBjeCkgKyAoY3ggLSBieCkgKiAoYXkgLSBjeSkpOwogICAgcmVzdWx0LnogPSAxIC0gcmVzdWx0LnggLSByZXN1bHQueTsKICB9CgogIC8qKgogICAqIE9jdHJlZU5vZGUKICAgKi8KICBjbGFzcyBPY3RyZWVOb2RlIHsKICAgIC8qKiBUaGUgcm9vdCBub2RlICovCgogICAgLyoqIEJvdW5kYXJ5IG9mIHRoaXMgbm9kZSAqLwoKICAgIC8qKiBDb250YWluZWQgZGF0YSBhdCB0aGUgY3VycmVudCBub2RlIGxldmVsICovCgogICAgLyoqIENoaWxkcmVuIHRvIHRoaXMgbm9kZSAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICB0aGlzLnJvb3QgPSBvcHRpb25zLnJvb3QgfHwgbnVsbDsKICAgICAgdGhpcy5hYWJiID0gb3B0aW9ucy5hYWJiID8gb3B0aW9ucy5hYWJiLmNsb25lKCkgOiBuZXcgQUFCQigpOwogICAgICB0aGlzLmRhdGEgPSBbXTsKICAgICAgdGhpcy5jaGlsZHJlbiA9IFtdOwogICAgfQogICAgLyoqCiAgICAgKiByZXNldAogICAgICovCgoKICAgIHJlc2V0KCkgewogICAgICB0aGlzLmNoaWxkcmVuLmxlbmd0aCA9IHRoaXMuZGF0YS5sZW5ndGggPSAwOwogICAgfQogICAgLyoqCiAgICAgKiBJbnNlcnQgZGF0YSBpbnRvIHRoaXMgbm9kZQogICAgICogQHJldHVybiBUcnVlIGlmIHN1Y2Nlc3NmdWwsIG90aGVyd2lzZSBmYWxzZQogICAgICovCgoKICAgIGluc2VydChhYWJiLCBlbGVtZW50RGF0YSwgbGV2ZWwpIHsKICAgICAgaWYgKGxldmVsID09PSB2b2lkIDApIHsKICAgICAgICBsZXZlbCA9IDA7CiAgICAgIH0KCiAgICAgIGNvbnN0IG5vZGVEYXRhID0gdGhpcy5kYXRhOyAvLyBJZ25vcmUgb2JqZWN0cyB0aGF0IGRvIG5vdCBiZWxvbmcgaW4gdGhpcyBub2RlCgogICAgICBpZiAoIXRoaXMuYWFiYi5jb250YWlucyhhYWJiKSkgewogICAgICAgIHJldHVybiBmYWxzZTsgLy8gb2JqZWN0IGNhbm5vdCBiZSBhZGRlZAogICAgICB9CgogICAgICBjb25zdCBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW47CiAgICAgIGNvbnN0IG1heERlcHRoID0gdGhpcy5tYXhEZXB0aCB8fCB0aGlzLnJvb3QubWF4RGVwdGg7CgogICAgICBpZiAobGV2ZWwgPCBtYXhEZXB0aCkgewogICAgICAgIC8vIFN1YmRpdmlkZSBpZiB0aGVyZSBhcmUgbm8gY2hpbGRyZW4geWV0CiAgICAgICAgbGV0IHN1YmRpdmlkZWQgPSBmYWxzZTsKCiAgICAgICAgaWYgKCFjaGlsZHJlbi5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMuc3ViZGl2aWRlKCk7CiAgICAgICAgICBzdWJkaXZpZGVkID0gdHJ1ZTsKICAgICAgICB9IC8vIGFkZCB0byB3aGljaGV2ZXIgbm9kZSB3aWxsIGFjY2VwdCBpdAoKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IDg7IGkrKykgewogICAgICAgICAgaWYgKGNoaWxkcmVuW2ldLmluc2VydChhYWJiLCBlbGVtZW50RGF0YSwgbGV2ZWwgKyAxKSkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChzdWJkaXZpZGVkKSB7CiAgICAgICAgICAvLyBObyBjaGlsZHJlbiBhY2NlcHRlZCEgTWlnaHQgYXMgd2VsbCBqdXN0IHJlbW92ZSBlbSBzaW5jZSB0aGV5IGNvbnRhaW4gbm9uZQogICAgICAgICAgY2hpbGRyZW4ubGVuZ3RoID0gMDsKICAgICAgICB9CiAgICAgIH0gLy8gVG9vIGRlZXAsIG9yIGNoaWxkcmVuIGRpZG50IHdhbnQgaXQuIGFkZCBpdCBpbiBjdXJyZW50IG5vZGUKCgogICAgICBub2RlRGF0YS5wdXNoKGVsZW1lbnREYXRhKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIENyZWF0ZSA4IGVxdWFsbHkgc2l6ZWQgY2hpbGRyZW4gbm9kZXMgYW5kIHB1dCB0aGVtIGluIHRoZSBgY2hpbGRyZW5gIGFycmF5LgogICAgICovCgoKICAgIHN1YmRpdmlkZSgpIHsKICAgICAgY29uc3QgYWFiYiA9IHRoaXMuYWFiYjsKICAgICAgY29uc3QgbCA9IGFhYmIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdSA9IGFhYmIudXBwZXJCb3VuZDsKICAgICAgY29uc3QgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuOwogICAgICBjaGlsZHJlbi5wdXNoKG5ldyBPY3RyZWVOb2RlKHsKICAgICAgICBhYWJiOiBuZXcgQUFCQih7CiAgICAgICAgICBsb3dlckJvdW5kOiBuZXcgVmVjMygwLCAwLCAwKQogICAgICAgIH0pCiAgICAgIH0pLCBuZXcgT2N0cmVlTm9kZSh7CiAgICAgICAgYWFiYjogbmV3IEFBQkIoewogICAgICAgICAgbG93ZXJCb3VuZDogbmV3IFZlYzMoMSwgMCwgMCkKICAgICAgICB9KQogICAgICB9KSwgbmV3IE9jdHJlZU5vZGUoewogICAgICAgIGFhYmI6IG5ldyBBQUJCKHsKICAgICAgICAgIGxvd2VyQm91bmQ6IG5ldyBWZWMzKDEsIDEsIDApCiAgICAgICAgfSkKICAgICAgfSksIG5ldyBPY3RyZWVOb2RlKHsKICAgICAgICBhYWJiOiBuZXcgQUFCQih7CiAgICAgICAgICBsb3dlckJvdW5kOiBuZXcgVmVjMygxLCAxLCAxKQogICAgICAgIH0pCiAgICAgIH0pLCBuZXcgT2N0cmVlTm9kZSh7CiAgICAgICAgYWFiYjogbmV3IEFBQkIoewogICAgICAgICAgbG93ZXJCb3VuZDogbmV3IFZlYzMoMCwgMSwgMSkKICAgICAgICB9KQogICAgICB9KSwgbmV3IE9jdHJlZU5vZGUoewogICAgICAgIGFhYmI6IG5ldyBBQUJCKHsKICAgICAgICAgIGxvd2VyQm91bmQ6IG5ldyBWZWMzKDAsIDAsIDEpCiAgICAgICAgfSkKICAgICAgfSksIG5ldyBPY3RyZWVOb2RlKHsKICAgICAgICBhYWJiOiBuZXcgQUFCQih7CiAgICAgICAgICBsb3dlckJvdW5kOiBuZXcgVmVjMygxLCAwLCAxKQogICAgICAgIH0pCiAgICAgIH0pLCBuZXcgT2N0cmVlTm9kZSh7CiAgICAgICAgYWFiYjogbmV3IEFBQkIoewogICAgICAgICAgbG93ZXJCb3VuZDogbmV3IFZlYzMoMCwgMSwgMCkKICAgICAgICB9KQogICAgICB9KSk7CiAgICAgIHUudnN1YihsLCBoYWxmRGlhZ29uYWwpOwogICAgICBoYWxmRGlhZ29uYWwuc2NhbGUoMC41LCBoYWxmRGlhZ29uYWwpOwogICAgICBjb25zdCByb290ID0gdGhpcy5yb290IHx8IHRoaXM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gODsgaSsrKSB7CiAgICAgICAgY29uc3QgY2hpbGQgPSBjaGlsZHJlbltpXTsgLy8gU2V0IGN1cnJlbnQgbm9kZSBhcyByb290CgogICAgICAgIGNoaWxkLnJvb3QgPSByb290OyAvLyBDb21wdXRlIGJvdW5kcwoKICAgICAgICBjb25zdCBsb3dlckJvdW5kID0gY2hpbGQuYWFiYi5sb3dlckJvdW5kOwogICAgICAgIGxvd2VyQm91bmQueCAqPSBoYWxmRGlhZ29uYWwueDsKICAgICAgICBsb3dlckJvdW5kLnkgKj0gaGFsZkRpYWdvbmFsLnk7CiAgICAgICAgbG93ZXJCb3VuZC56ICo9IGhhbGZEaWFnb25hbC56OwogICAgICAgIGxvd2VyQm91bmQudmFkZChsLCBsb3dlckJvdW5kKTsgLy8gVXBwZXIgYm91bmQgaXMgYWx3YXlzIGxvd2VyIGJvdW5kICsgaGFsZkRpYWdvbmFsCgogICAgICAgIGxvd2VyQm91bmQudmFkZChoYWxmRGlhZ29uYWwsIGNoaWxkLmFhYmIudXBwZXJCb3VuZCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogR2V0IGFsbCBkYXRhLCBwb3RlbnRpYWxseSB3aXRoaW4gYW4gQUFCQgogICAgICogQHJldHVybiBUaGUgInJlc3VsdCIgb2JqZWN0CiAgICAgKi8KCgogICAgYWFiYlF1ZXJ5KGFhYmIsIHJlc3VsdCkgewogICAgICB0aGlzLmRhdGE7IC8vIGFib3J0IGlmIHRoZSByYW5nZSBkb2VzIG5vdCBpbnRlcnNlY3QgdGhpcyBub2RlCiAgICAgIC8vIGlmICghdGhpcy5hYWJiLm92ZXJsYXBzKGFhYmIpKXsKICAgICAgLy8gICAgIHJldHVybiByZXN1bHQ7CiAgICAgIC8vIH0KICAgICAgLy8gQWRkIG9iamVjdHMgYXQgdGhpcyBsZXZlbAogICAgICAvLyBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShyZXN1bHQsIG5vZGVEYXRhKTsKICAgICAgLy8gQWRkIGNoaWxkIGRhdGEKICAgICAgLy8gQHRvZG8gdW53cmFwIHJlY3Vyc2lvbiBpbnRvIGEgcXVldWUgLyBsb29wLCB0aGF0J3MgZmFzdGVyIGluIEpTCgogICAgICB0aGlzLmNoaWxkcmVuOyAvLyBmb3IgKGxldCBpID0gMCwgTiA9IHRoaXMuY2hpbGRyZW4ubGVuZ3RoOyBpICE9PSBOOyBpKyspIHsKICAgICAgLy8gICAgIGNoaWxkcmVuW2ldLmFhYmJRdWVyeShhYWJiLCByZXN1bHQpOwogICAgICAvLyB9CgogICAgICBjb25zdCBxdWV1ZSA9IFt0aGlzXTsKCiAgICAgIHdoaWxlIChxdWV1ZS5sZW5ndGgpIHsKICAgICAgICBjb25zdCBub2RlID0gcXVldWUucG9wKCk7CgogICAgICAgIGlmIChub2RlLmFhYmIub3ZlcmxhcHMoYWFiYikpIHsKICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KHJlc3VsdCwgbm9kZS5kYXRhKTsKICAgICAgICB9CgogICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KHF1ZXVlLCBub2RlLmNoaWxkcmVuKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFsbCBkYXRhLCBwb3RlbnRpYWxseSBpbnRlcnNlY3RlZCBieSBhIHJheS4KICAgICAqIEByZXR1cm4gVGhlICJyZXN1bHQiIG9iamVjdAogICAgICovCgoKICAgIHJheVF1ZXJ5KHJheSwgdHJlZVRyYW5zZm9ybSwgcmVzdWx0KSB7CiAgICAgIC8vIFVzZSBhYWJiIHF1ZXJ5IGZvciBub3cuCgogICAgICAvKiogQHRvZG8gaW1wbGVtZW50IHJlYWwgcmF5IHF1ZXJ5IHdoaWNoIG5lZWRzIGxlc3MgbG9va3VwcyAqLwogICAgICByYXkuZ2V0QUFCQih0bXBBQUJCKTsKICAgICAgdG1wQUFCQi50b0xvY2FsRnJhbWUodHJlZVRyYW5zZm9ybSwgdG1wQUFCQik7CiAgICAgIHRoaXMuYWFiYlF1ZXJ5KHRtcEFBQkIsIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIHJlbW92ZUVtcHR5Tm9kZXMKICAgICAqLwoKCiAgICByZW1vdmVFbXB0eU5vZGVzKCkgewogICAgICBmb3IgKGxldCBpID0gdGhpcy5jaGlsZHJlbi5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgIHRoaXMuY2hpbGRyZW5baV0ucmVtb3ZlRW1wdHlOb2RlcygpOwoKICAgICAgICBpZiAoIXRoaXMuY2hpbGRyZW5baV0uY2hpbGRyZW4ubGVuZ3RoICYmICF0aGlzLmNoaWxkcmVuW2ldLmRhdGEubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLmNoaWxkcmVuLnNwbGljZShpLCAxKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgfQogIC8qKgogICAqIE9jdHJlZQogICAqLwoKCiAgY2xhc3MgT2N0cmVlIGV4dGVuZHMgT2N0cmVlTm9kZSB7CiAgICAvKioKICAgICAqIE1heGltdW0gc3ViZGl2aXNpb24gZGVwdGgKICAgICAqIEBkZWZhdWx0IDgKICAgICAqLwoKICAgIC8qKgogICAgICogQHBhcmFtIGFhYmIgVGhlIHRvdGFsIEFBQkIgb2YgdGhlIHRyZWUKICAgICAqLwogICAgY29uc3RydWN0b3IoYWFiYiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBzdXBlcih7CiAgICAgICAgcm9vdDogbnVsbCwKICAgICAgICBhYWJiCiAgICAgIH0pOwogICAgICB0aGlzLm1heERlcHRoID0gdHlwZW9mIG9wdGlvbnMubWF4RGVwdGggIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5tYXhEZXB0aCA6IDg7CiAgICB9CgogIH0KICBjb25zdCBoYWxmRGlhZ29uYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcEFBQkIgPSBuZXcgQUFCQigpOwoKICAvKioKICAgKiBUcmltZXNoLgogICAqIEBleGFtcGxlCiAgICogICAgIC8vIEhvdyB0byBtYWtlIGEgbWVzaCB3aXRoIGEgc2luZ2xlIHRyaWFuZ2xlCiAgICogICAgIGNvbnN0IHZlcnRpY2VzID0gWwogICAqICAgICAgICAgMCwgMCwgMCwgLy8gdmVydGV4IDAKICAgKiAgICAgICAgIDEsIDAsIDAsIC8vIHZlcnRleCAxCiAgICogICAgICAgICAwLCAxLCAwICAvLyB2ZXJ0ZXggMgogICAqICAgICBdCiAgICogICAgIGNvbnN0IGluZGljZXMgPSBbCiAgICogICAgICAgICAwLCAxLCAyICAvLyB0cmlhbmdsZSAwCiAgICogICAgIF0KICAgKiAgICAgY29uc3QgdHJpbWVzaFNoYXBlID0gbmV3IENBTk5PTi5UcmltZXNoKHZlcnRpY2VzLCBpbmRpY2VzKQogICAqLwogIGNsYXNzIFRyaW1lc2ggZXh0ZW5kcyBTaGFwZSB7CiAgICAvKioKICAgICAqIHZlcnRpY2VzCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFycmF5IG9mIGludGVnZXJzLCBpbmRpY2F0aW5nIHdoaWNoIHZlcnRpY2VzIGVhY2ggdHJpYW5nbGUgY29uc2lzdHMgb2YuIFRoZSBsZW5ndGggb2YgdGhpcyBhcnJheSBpcyB0aHVzIDMgdGltZXMgdGhlIG51bWJlciBvZiB0cmlhbmdsZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBub3JtYWxzIGRhdGEuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBsb2NhbCBBQUJCIG9mIHRoZSBtZXNoLgogICAgICovCgogICAgLyoqCiAgICAgKiBSZWZlcmVuY2VzIHRvIHZlcnRleCBwYWlycywgbWFraW5nIHVwIGFsbCB1bmlxdWUgZWRnZXMgaW4gdGhlIHRyaW1lc2guCiAgICAgKi8KCiAgICAvKioKICAgICAqIExvY2FsIHNjYWxpbmcgb2YgdGhlIG1lc2guIFVzZSAuc2V0U2NhbGUoKSB0byBzZXQgaXQuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBpbmRleGVkIHRyaWFuZ2xlcy4gVXNlIC51cGRhdGVUcmVlKCkgdG8gdXBkYXRlIGl0LgogICAgICovCiAgICBjb25zdHJ1Y3Rvcih2ZXJ0aWNlcywgaW5kaWNlcykgewogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuVFJJTUVTSAogICAgICB9KTsKICAgICAgdGhpcy52ZXJ0aWNlcyA9IG5ldyBGbG9hdDMyQXJyYXkodmVydGljZXMpOwogICAgICB0aGlzLmluZGljZXMgPSBuZXcgSW50MTZBcnJheShpbmRpY2VzKTsKICAgICAgdGhpcy5ub3JtYWxzID0gbmV3IEZsb2F0MzJBcnJheShpbmRpY2VzLmxlbmd0aCk7CiAgICAgIHRoaXMuYWFiYiA9IG5ldyBBQUJCKCk7CiAgICAgIHRoaXMuZWRnZXMgPSBudWxsOwogICAgICB0aGlzLnNjYWxlID0gbmV3IFZlYzMoMSwgMSwgMSk7CiAgICAgIHRoaXMudHJlZSA9IG5ldyBPY3RyZWUoKTsKICAgICAgdGhpcy51cGRhdGVFZGdlcygpOwogICAgICB0aGlzLnVwZGF0ZU5vcm1hbHMoKTsKICAgICAgdGhpcy51cGRhdGVBQUJCKCk7CiAgICAgIHRoaXMudXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKTsKICAgICAgdGhpcy51cGRhdGVUcmVlKCk7CiAgICB9CiAgICAvKioKICAgICAqIHVwZGF0ZVRyZWUKICAgICAqLwoKCiAgICB1cGRhdGVUcmVlKCkgewogICAgICBjb25zdCB0cmVlID0gdGhpcy50cmVlOwogICAgICB0cmVlLnJlc2V0KCk7CiAgICAgIHRyZWUuYWFiYi5jb3B5KHRoaXMuYWFiYik7CiAgICAgIGNvbnN0IHNjYWxlID0gdGhpcy5zY2FsZTsgLy8gVGhlIGxvY2FsIG1lc2ggQUFCQiBpcyBzY2FsZWQsIGJ1dCB0aGUgb2N0cmVlIEFBQkIgc2hvdWxkIGJlIHVuc2NhbGVkCgogICAgICB0cmVlLmFhYmIubG93ZXJCb3VuZC54ICo9IDEgLyBzY2FsZS54OwogICAgICB0cmVlLmFhYmIubG93ZXJCb3VuZC55ICo9IDEgLyBzY2FsZS55OwogICAgICB0cmVlLmFhYmIubG93ZXJCb3VuZC56ICo9IDEgLyBzY2FsZS56OwogICAgICB0cmVlLmFhYmIudXBwZXJCb3VuZC54ICo9IDEgLyBzY2FsZS54OwogICAgICB0cmVlLmFhYmIudXBwZXJCb3VuZC55ICo9IDEgLyBzY2FsZS55OwogICAgICB0cmVlLmFhYmIudXBwZXJCb3VuZC56ICo9IDEgLyBzY2FsZS56OyAvLyBJbnNlcnQgYWxsIHRyaWFuZ2xlcwoKICAgICAgY29uc3QgdHJpYW5nbGVBQUJCID0gbmV3IEFBQkIoKTsKICAgICAgY29uc3QgYSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGIgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBjID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcG9pbnRzID0gW2EsIGIsIGNdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgLy90aGlzLmdldFRyaWFuZ2xlVmVydGljZXMoaSwgYSwgYiwgYyk7CiAgICAgICAgLy8gR2V0IHVuc2NhbGVkIHRyaWFuZ2xlIHZlcnRzCiAgICAgICAgY29uc3QgaTMgPSBpICogMzsKCiAgICAgICAgdGhpcy5fZ2V0VW5zY2FsZWRWZXJ0ZXgodGhpcy5pbmRpY2VzW2kzXSwgYSk7CgogICAgICAgIHRoaXMuX2dldFVuc2NhbGVkVmVydGV4KHRoaXMuaW5kaWNlc1tpMyArIDFdLCBiKTsKCiAgICAgICAgdGhpcy5fZ2V0VW5zY2FsZWRWZXJ0ZXgodGhpcy5pbmRpY2VzW2kzICsgMl0sIGMpOwoKICAgICAgICB0cmlhbmdsZUFBQkIuc2V0RnJvbVBvaW50cyhwb2ludHMpOwogICAgICAgIHRyZWUuaW5zZXJ0KHRyaWFuZ2xlQUFCQiwgaSk7CiAgICAgIH0KCiAgICAgIHRyZWUucmVtb3ZlRW1wdHlOb2RlcygpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdHJpYW5nbGVzIGluIGEgbG9jYWwgQUFCQiBmcm9tIHRoZSB0cmltZXNoLgogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSBvZiBpbnRlZ2VycywgcmVmZXJlbmNpbmcgdGhlIHF1ZXJpZWQgdHJpYW5nbGVzLgogICAgICovCgoKICAgIGdldFRyaWFuZ2xlc0luQUFCQihhYWJiLCByZXN1bHQpIHsKICAgICAgdW5zY2FsZWRBQUJCLmNvcHkoYWFiYik7IC8vIFNjYWxlIGl0IHRvIGxvY2FsCgogICAgICBjb25zdCBzY2FsZSA9IHRoaXMuc2NhbGU7CiAgICAgIGNvbnN0IGlzeCA9IHNjYWxlLng7CiAgICAgIGNvbnN0IGlzeSA9IHNjYWxlLnk7CiAgICAgIGNvbnN0IGlzeiA9IHNjYWxlLno7CiAgICAgIGNvbnN0IGwgPSB1bnNjYWxlZEFBQkIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdSA9IHVuc2NhbGVkQUFCQi51cHBlckJvdW5kOwogICAgICBsLnggLz0gaXN4OwogICAgICBsLnkgLz0gaXN5OwogICAgICBsLnogLz0gaXN6OwogICAgICB1LnggLz0gaXN4OwogICAgICB1LnkgLz0gaXN5OwogICAgICB1LnogLz0gaXN6OwogICAgICByZXR1cm4gdGhpcy50cmVlLmFhYmJRdWVyeSh1bnNjYWxlZEFBQkIsIHJlc3VsdCk7CiAgICB9CiAgICAvKioKICAgICAqIHNldFNjYWxlCiAgICAgKi8KCgogICAgc2V0U2NhbGUoc2NhbGUpIHsKICAgICAgY29uc3Qgd2FzVW5pZm9ybSA9IHRoaXMuc2NhbGUueCA9PT0gdGhpcy5zY2FsZS55ICYmIHRoaXMuc2NhbGUueSA9PT0gdGhpcy5zY2FsZS56OwogICAgICBjb25zdCBpc1VuaWZvcm0gPSBzY2FsZS54ID09PSBzY2FsZS55ICYmIHNjYWxlLnkgPT09IHNjYWxlLno7CgogICAgICBpZiAoISh3YXNVbmlmb3JtICYmIGlzVW5pZm9ybSkpIHsKICAgICAgICAvLyBOb24tdW5pZm9ybSBzY2FsaW5nLiBOZWVkIHRvIHVwZGF0ZSBub3JtYWxzLgogICAgICAgIHRoaXMudXBkYXRlTm9ybWFscygpOwogICAgICB9CgogICAgICB0aGlzLnNjYWxlLmNvcHkoc2NhbGUpOwogICAgICB0aGlzLnVwZGF0ZUFBQkIoKTsKICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlIHRoZSBub3JtYWxzIG9mIHRoZSBmYWNlcy4gV2lsbCBzYXZlIGluIHRoZSBgLm5vcm1hbHNgIGFycmF5LgogICAgICovCgoKICAgIHVwZGF0ZU5vcm1hbHMoKSB7CiAgICAgIGNvbnN0IG4gPSBjb21wdXRlTm9ybWFsc19uOyAvLyBHZW5lcmF0ZSBub3JtYWxzCgogICAgICBjb25zdCBub3JtYWxzID0gdGhpcy5ub3JtYWxzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgY29uc3QgaTMgPSBpICogMzsKICAgICAgICBjb25zdCBhID0gdGhpcy5pbmRpY2VzW2kzXTsKICAgICAgICBjb25zdCBiID0gdGhpcy5pbmRpY2VzW2kzICsgMV07CiAgICAgICAgY29uc3QgYyA9IHRoaXMuaW5kaWNlc1tpMyArIDJdOwogICAgICAgIHRoaXMuZ2V0VmVydGV4KGEsIHZhKTsKICAgICAgICB0aGlzLmdldFZlcnRleChiLCB2Yik7CiAgICAgICAgdGhpcy5nZXRWZXJ0ZXgoYywgdmMpOwogICAgICAgIFRyaW1lc2guY29tcHV0ZU5vcm1hbCh2YiwgdmEsIHZjLCBuKTsKICAgICAgICBub3JtYWxzW2kzXSA9IG4ueDsKICAgICAgICBub3JtYWxzW2kzICsgMV0gPSBuLnk7CiAgICAgICAgbm9ybWFsc1tpMyArIDJdID0gbi56OwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFVwZGF0ZSB0aGUgYC5lZGdlc2AgcHJvcGVydHkKICAgICAqLwoKCiAgICB1cGRhdGVFZGdlcygpIHsKICAgICAgY29uc3QgZWRnZXMgPSB7fTsKCiAgICAgIGNvbnN0IGFkZCA9IChhLCBiKSA9PiB7CiAgICAgICAgY29uc3Qga2V5ID0gYSA8IGIgPyBgJHthfV8ke2J9YCA6IGAke2J9XyR7YX1gOwogICAgICAgIGVkZ2VzW2tleV0gPSB0cnVlOwogICAgICB9OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgY29uc3QgaTMgPSBpICogMzsKICAgICAgICBjb25zdCBhID0gdGhpcy5pbmRpY2VzW2kzXTsKICAgICAgICBjb25zdCBiID0gdGhpcy5pbmRpY2VzW2kzICsgMV07CiAgICAgICAgY29uc3QgYyA9IHRoaXMuaW5kaWNlc1tpMyArIDJdOwogICAgICAgIGFkZChhLCBiKTsKICAgICAgICBhZGQoYiwgYyk7CiAgICAgICAgYWRkKGMsIGEpOwogICAgICB9CgogICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoZWRnZXMpOwogICAgICB0aGlzLmVkZ2VzID0gbmV3IEludDE2QXJyYXkoa2V5cy5sZW5ndGggKiAyKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGluZGljZXMgPSBrZXlzW2ldLnNwbGl0KCdfJyk7CiAgICAgICAgdGhpcy5lZGdlc1syICogaV0gPSBwYXJzZUludChpbmRpY2VzWzBdLCAxMCk7CiAgICAgICAgdGhpcy5lZGdlc1syICogaSArIDFdID0gcGFyc2VJbnQoaW5kaWNlc1sxXSwgMTApOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBlZGdlIHZlcnRleAogICAgICogQHBhcmFtIGZpcnN0T3JTZWNvbmQgMCBvciAxLCBkZXBlbmRpbmcgb24gd2hpY2ggb25lIG9mIHRoZSB2ZXJ0aWNlcyB5b3UgbmVlZC4KICAgICAqIEBwYXJhbSB2ZXJ0ZXhTdG9yZSBXaGVyZSB0byBzdG9yZSB0aGUgcmVzdWx0CiAgICAgKi8KCgogICAgZ2V0RWRnZVZlcnRleChlZGdlSW5kZXgsIGZpcnN0T3JTZWNvbmQsIHZlcnRleFN0b3JlKSB7CiAgICAgIGNvbnN0IHZlcnRleEluZGV4ID0gdGhpcy5lZGdlc1tlZGdlSW5kZXggKiAyICsgKGZpcnN0T3JTZWNvbmQgPyAxIDogMCldOwogICAgICB0aGlzLmdldFZlcnRleCh2ZXJ0ZXhJbmRleCwgdmVydGV4U3RvcmUpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgYSB2ZWN0b3IgYWxvbmcgYW4gZWRnZS4KICAgICAqLwoKCiAgICBnZXRFZGdlVmVjdG9yKGVkZ2VJbmRleCwgdmVjdG9yU3RvcmUpIHsKICAgICAgY29uc3QgdmEgPSBnZXRFZGdlVmVjdG9yX3ZhOwogICAgICBjb25zdCB2YiA9IGdldEVkZ2VWZWN0b3JfdmI7CiAgICAgIHRoaXMuZ2V0RWRnZVZlcnRleChlZGdlSW5kZXgsIDAsIHZhKTsKICAgICAgdGhpcy5nZXRFZGdlVmVydGV4KGVkZ2VJbmRleCwgMSwgdmIpOwogICAgICB2Yi52c3ViKHZhLCB2ZWN0b3JTdG9yZSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBmYWNlIG5vcm1hbCBnaXZlbiAzIHZlcnRpY2VzCiAgICAgKi8KCgogICAgc3RhdGljIGNvbXB1dGVOb3JtYWwodmEsIHZiLCB2YywgdGFyZ2V0KSB7CiAgICAgIHZiLnZzdWIodmEsIGFiKTsKICAgICAgdmMudnN1Yih2YiwgY2IpOwogICAgICBjYi5jcm9zcyhhYiwgdGFyZ2V0KTsKCiAgICAgIGlmICghdGFyZ2V0LmlzWmVybygpKSB7CiAgICAgICAgdGFyZ2V0Lm5vcm1hbGl6ZSgpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCB2ZXJ0ZXggaS4KICAgICAqIEByZXR1cm4gVGhlICJvdXQiIHZlY3RvciBvYmplY3QKICAgICAqLwoKCiAgICBnZXRWZXJ0ZXgoaSwgb3V0KSB7CiAgICAgIGNvbnN0IHNjYWxlID0gdGhpcy5zY2FsZTsKCiAgICAgIHRoaXMuX2dldFVuc2NhbGVkVmVydGV4KGksIG91dCk7CgogICAgICBvdXQueCAqPSBzY2FsZS54OwogICAgICBvdXQueSAqPSBzY2FsZS55OwogICAgICBvdXQueiAqPSBzY2FsZS56OwogICAgICByZXR1cm4gb3V0OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgcmF3IHZlcnRleCBpCiAgICAgKiBAcmV0dXJuIFRoZSAib3V0IiB2ZWN0b3Igb2JqZWN0CiAgICAgKi8KCgogICAgX2dldFVuc2NhbGVkVmVydGV4KGksIG91dCkgewogICAgICBjb25zdCBpMyA9IGkgKiAzOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7CiAgICAgIHJldHVybiBvdXQuc2V0KHZlcnRpY2VzW2kzXSwgdmVydGljZXNbaTMgKyAxXSwgdmVydGljZXNbaTMgKyAyXSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhIHZlcnRleCBmcm9tIHRoZSB0cmltZXNoLHRyYW5zZm9ybWVkIGJ5IHRoZSBnaXZlbiBwb3NpdGlvbiBhbmQgcXVhdGVybmlvbi4KICAgICAqIEByZXR1cm4gVGhlICJvdXQiIHZlY3RvciBvYmplY3QKICAgICAqLwoKCiAgICBnZXRXb3JsZFZlcnRleChpLCBwb3MsIHF1YXQsIG91dCkgewogICAgICB0aGlzLmdldFZlcnRleChpLCBvdXQpOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUocG9zLCBxdWF0LCBvdXQsIG91dCk7CiAgICAgIHJldHVybiBvdXQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgdGhyZWUgdmVydGljZXMgZm9yIHRyaWFuZ2xlIGkuCiAgICAgKi8KCgogICAgZ2V0VHJpYW5nbGVWZXJ0aWNlcyhpLCBhLCBiLCBjKSB7CiAgICAgIGNvbnN0IGkzID0gaSAqIDM7CiAgICAgIHRoaXMuZ2V0VmVydGV4KHRoaXMuaW5kaWNlc1tpM10sIGEpOwogICAgICB0aGlzLmdldFZlcnRleCh0aGlzLmluZGljZXNbaTMgKyAxXSwgYik7CiAgICAgIHRoaXMuZ2V0VmVydGV4KHRoaXMuaW5kaWNlc1tpMyArIDJdLCBjKTsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0aGUgbm9ybWFsIG9mIHRyaWFuZ2xlIGkuCiAgICAgKiBAcmV0dXJuIFRoZSAidGFyZ2V0IiB2ZWN0b3Igb2JqZWN0CiAgICAgKi8KCgogICAgZ2V0Tm9ybWFsKGksIHRhcmdldCkgewogICAgICBjb25zdCBpMyA9IGkgKiAzOwogICAgICByZXR1cm4gdGFyZ2V0LnNldCh0aGlzLm5vcm1hbHNbaTNdLCB0aGlzLm5vcm1hbHNbaTMgKyAxXSwgdGhpcy5ub3JtYWxzW2kzICsgMl0pOwogICAgfQogICAgLyoqCiAgICAgKiBAcmV0dXJuIFRoZSAidGFyZ2V0IiB2ZWN0b3Igb2JqZWN0CiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICAvLyBBcHByb3hpbWF0ZSB3aXRoIGJveCBpbmVydGlhCiAgICAgIC8vIEV4YWN0IGluZXJ0aWEgY2FsY3VsYXRpb24gaXMgb3ZlcmtpbGwsIGJ1dCBzZWUgaHR0cDovL2dlb21ldHJpY3Rvb2xzLmNvbS9Eb2N1bWVudGF0aW9uL1BvbHloZWRyYWxNYXNzUHJvcGVydGllcy5wZGYgZm9yIHRoZSBjb3JyZWN0IHdheSB0byBkbyBpdAogICAgICB0aGlzLmNvbXB1dGVMb2NhbEFBQkIoY2xpX2FhYmIpOwogICAgICBjb25zdCB4ID0gY2xpX2FhYmIudXBwZXJCb3VuZC54IC0gY2xpX2FhYmIubG93ZXJCb3VuZC54OwogICAgICBjb25zdCB5ID0gY2xpX2FhYmIudXBwZXJCb3VuZC55IC0gY2xpX2FhYmIubG93ZXJCb3VuZC55OwogICAgICBjb25zdCB6ID0gY2xpX2FhYmIudXBwZXJCb3VuZC56IC0gY2xpX2FhYmIubG93ZXJCb3VuZC56OwogICAgICByZXR1cm4gdGFyZ2V0LnNldCgxLjAgLyAxMi4wICogbWFzcyAqICgyICogeSAqIDIgKiB5ICsgMiAqIHogKiAyICogeiksIDEuMCAvIDEyLjAgKiBtYXNzICogKDIgKiB4ICogMiAqIHggKyAyICogeiAqIDIgKiB6KSwgMS4wIC8gMTIuMCAqIG1hc3MgKiAoMiAqIHkgKiAyICogeSArIDIgKiB4ICogMiAqIHgpKTsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0aGUgbG9jYWwgQUFCQiBmb3IgdGhlIHRyaW1lc2gKICAgICAqLwoKCiAgICBjb21wdXRlTG9jYWxBQUJCKGFhYmIpIHsKICAgICAgY29uc3QgbCA9IGFhYmIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdSA9IGFhYmIudXBwZXJCb3VuZDsKICAgICAgY29uc3QgbiA9IHRoaXMudmVydGljZXMubGVuZ3RoOwogICAgICB0aGlzLnZlcnRpY2VzOwogICAgICBjb25zdCB2ID0gY29tcHV0ZUxvY2FsQUFCQl93b3JsZFZlcnQ7CiAgICAgIHRoaXMuZ2V0VmVydGV4KDAsIHYpOwogICAgICBsLmNvcHkodik7CiAgICAgIHUuY29weSh2KTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBuOyBpKyspIHsKICAgICAgICB0aGlzLmdldFZlcnRleChpLCB2KTsKCiAgICAgICAgaWYgKHYueCA8IGwueCkgewogICAgICAgICAgbC54ID0gdi54OwogICAgICAgIH0gZWxzZSBpZiAodi54ID4gdS54KSB7CiAgICAgICAgICB1LnggPSB2Lng7CiAgICAgICAgfQoKICAgICAgICBpZiAodi55IDwgbC55KSB7CiAgICAgICAgICBsLnkgPSB2Lnk7CiAgICAgICAgfSBlbHNlIGlmICh2LnkgPiB1LnkpIHsKICAgICAgICAgIHUueSA9IHYueTsKICAgICAgICB9CgogICAgICAgIGlmICh2LnogPCBsLnopIHsKICAgICAgICAgIGwueiA9IHYuejsKICAgICAgICB9IGVsc2UgaWYgKHYueiA+IHUueikgewogICAgICAgICAgdS56ID0gdi56OwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGUgdGhlIGAuYWFiYmAgcHJvcGVydHkKICAgICAqLwoKCiAgICB1cGRhdGVBQUJCKCkgewogICAgICB0aGlzLmNvbXB1dGVMb2NhbEFBQkIodGhpcy5hYWJiKTsKICAgIH0KICAgIC8qKgogICAgICogV2lsbCB1cGRhdGUgdGhlIGAuYm91bmRpbmdTcGhlcmVSYWRpdXNgIHByb3BlcnR5CiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIC8vIEFzc3VtZSBwb2ludHMgYXJlIGRpc3RyaWJ1dGVkIHdpdGggbG9jYWwgKDAsMCwwKSBhcyBjZW50ZXIKICAgICAgbGV0IG1heDIgPSAwOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7CiAgICAgIGNvbnN0IHYgPSBuZXcgVmVjMygpOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIE4gPSB2ZXJ0aWNlcy5sZW5ndGggLyAzOyBpICE9PSBOOyBpKyspIHsKICAgICAgICB0aGlzLmdldFZlcnRleChpLCB2KTsKICAgICAgICBjb25zdCBub3JtMiA9IHYubGVuZ3RoU3F1YXJlZCgpOwoKICAgICAgICBpZiAobm9ybTIgPiBtYXgyKSB7CiAgICAgICAgICBtYXgyID0gbm9ybTI7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gTWF0aC5zcXJ0KG1heDIpOwogICAgfQogICAgLyoqCiAgICAgKiBjYWxjdWxhdGVXb3JsZEFBQkIKICAgICAqLwoKCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICAvKgogICAgICAgICAgY29uc3QgbiA9IHRoaXMudmVydGljZXMubGVuZ3RoIC8gMywKICAgICAgICAgICAgICB2ZXJ0cyA9IHRoaXMudmVydGljZXM7CiAgICAgICAgICBjb25zdCBtaW54LG1pbnksbWlueixtYXh4LG1heHksbWF4ejsKICAgICAgICAgICBjb25zdCB2ID0gdGVtcFdvcmxkVmVydGV4OwogICAgICAgICAgZm9yKGxldCBpPTA7IGk8bjsgaSsrKXsKICAgICAgICAgICAgICB0aGlzLmdldFZlcnRleChpLCB2KTsKICAgICAgICAgICAgICBxdWF0LnZtdWx0KHYsIHYpOwogICAgICAgICAgICAgIHBvcy52YWRkKHYsIHYpOwogICAgICAgICAgICAgIGlmICh2LnggPCBtaW54IHx8IG1pbng9PT11bmRlZmluZWQpewogICAgICAgICAgICAgICAgICBtaW54ID0gdi54OwogICAgICAgICAgICAgIH0gZWxzZSBpZih2LnggPiBtYXh4IHx8IG1heHg9PT11bmRlZmluZWQpewogICAgICAgICAgICAgICAgICBtYXh4ID0gdi54OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgaWYgKHYueSA8IG1pbnkgfHwgbWlueT09PXVuZGVmaW5lZCl7CiAgICAgICAgICAgICAgICAgIG1pbnkgPSB2Lnk7CiAgICAgICAgICAgICAgfSBlbHNlIGlmKHYueSA+IG1heHkgfHwgbWF4eT09PXVuZGVmaW5lZCl7CiAgICAgICAgICAgICAgICAgIG1heHkgPSB2Lnk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICBpZiAodi56IDwgbWlueiB8fCBtaW56PT09dW5kZWZpbmVkKXsKICAgICAgICAgICAgICAgICAgbWlueiA9IHYuejsKICAgICAgICAgICAgICB9IGVsc2UgaWYodi56ID4gbWF4eiB8fCBtYXh6PT09dW5kZWZpbmVkKXsKICAgICAgICAgICAgICAgICAgbWF4eiA9IHYuejsKICAgICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBtaW4uc2V0KG1pbngsbWlueSxtaW56KTsKICAgICAgICAgIG1heC5zZXQobWF4eCxtYXh5LG1heHopOwogICAgICAgICAgKi8KICAgICAgLy8gRmFzdGVyIGFwcHJveGltYXRpb24gdXNpbmcgbG9jYWwgQUFCQgogICAgICBjb25zdCBmcmFtZSA9IGNhbGN1bGF0ZVdvcmxkQUFCQl9mcmFtZTsKICAgICAgY29uc3QgcmVzdWx0ID0gY2FsY3VsYXRlV29ybGRBQUJCX2FhYmI7CiAgICAgIGZyYW1lLnBvc2l0aW9uID0gcG9zOwogICAgICBmcmFtZS5xdWF0ZXJuaW9uID0gcXVhdDsKICAgICAgdGhpcy5hYWJiLnRvV29ybGRGcmFtZShmcmFtZSwgcmVzdWx0KTsKICAgICAgbWluLmNvcHkocmVzdWx0Lmxvd2VyQm91bmQpOwogICAgICBtYXguY29weShyZXN1bHQudXBwZXJCb3VuZCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhcHByb3hpbWF0ZSB2b2x1bWUKICAgICAqLwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIHJldHVybiA0LjAgKiBNYXRoLlBJICogdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyAvIDMuMDsKICAgIH0KICAgIC8qKgogICAgICogQ3JlYXRlIGEgVHJpbWVzaCBpbnN0YW5jZSwgc2hhcGVkIGFzIGEgdG9ydXMuCiAgICAgKi8KCgogICAgc3RhdGljIGNyZWF0ZVRvcnVzKHJhZGl1cywgdHViZSwgcmFkaWFsU2VnbWVudHMsIHR1YnVsYXJTZWdtZW50cywgYXJjKSB7CiAgICAgIGlmIChyYWRpdXMgPT09IHZvaWQgMCkgewogICAgICAgIHJhZGl1cyA9IDE7CiAgICAgIH0KCiAgICAgIGlmICh0dWJlID09PSB2b2lkIDApIHsKICAgICAgICB0dWJlID0gMC41OwogICAgICB9CgogICAgICBpZiAocmFkaWFsU2VnbWVudHMgPT09IHZvaWQgMCkgewogICAgICAgIHJhZGlhbFNlZ21lbnRzID0gODsKICAgICAgfQoKICAgICAgaWYgKHR1YnVsYXJTZWdtZW50cyA9PT0gdm9pZCAwKSB7CiAgICAgICAgdHVidWxhclNlZ21lbnRzID0gNjsKICAgICAgfQoKICAgICAgaWYgKGFyYyA9PT0gdm9pZCAwKSB7CiAgICAgICAgYXJjID0gTWF0aC5QSSAqIDI7CiAgICAgIH0KCiAgICAgIGNvbnN0IHZlcnRpY2VzID0gW107CiAgICAgIGNvbnN0IGluZGljZXMgPSBbXTsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqIDw9IHJhZGlhbFNlZ21lbnRzOyBqKyspIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8PSB0dWJ1bGFyU2VnbWVudHM7IGkrKykgewogICAgICAgICAgY29uc3QgdSA9IGkgLyB0dWJ1bGFyU2VnbWVudHMgKiBhcmM7CiAgICAgICAgICBjb25zdCB2ID0gaiAvIHJhZGlhbFNlZ21lbnRzICogTWF0aC5QSSAqIDI7CiAgICAgICAgICBjb25zdCB4ID0gKHJhZGl1cyArIHR1YmUgKiBNYXRoLmNvcyh2KSkgKiBNYXRoLmNvcyh1KTsKICAgICAgICAgIGNvbnN0IHkgPSAocmFkaXVzICsgdHViZSAqIE1hdGguY29zKHYpKSAqIE1hdGguc2luKHUpOwogICAgICAgICAgY29uc3QgeiA9IHR1YmUgKiBNYXRoLnNpbih2KTsKICAgICAgICAgIHZlcnRpY2VzLnB1c2goeCwgeSwgeik7CiAgICAgICAgfQogICAgICB9CgogICAgICBmb3IgKGxldCBqID0gMTsgaiA8PSByYWRpYWxTZWdtZW50czsgaisrKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gdHVidWxhclNlZ21lbnRzOyBpKyspIHsKICAgICAgICAgIGNvbnN0IGEgPSAodHVidWxhclNlZ21lbnRzICsgMSkgKiBqICsgaSAtIDE7CiAgICAgICAgICBjb25zdCBiID0gKHR1YnVsYXJTZWdtZW50cyArIDEpICogKGogLSAxKSArIGkgLSAxOwogICAgICAgICAgY29uc3QgYyA9ICh0dWJ1bGFyU2VnbWVudHMgKyAxKSAqIChqIC0gMSkgKyBpOwogICAgICAgICAgY29uc3QgZCA9ICh0dWJ1bGFyU2VnbWVudHMgKyAxKSAqIGogKyBpOwogICAgICAgICAgaW5kaWNlcy5wdXNoKGEsIGIsIGQpOwogICAgICAgICAgaW5kaWNlcy5wdXNoKGIsIGMsIGQpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBUcmltZXNoKHZlcnRpY2VzLCBpbmRpY2VzKTsKICAgIH0KCiAgfQogIGNvbnN0IGNvbXB1dGVOb3JtYWxzX24gPSBuZXcgVmVjMygpOwogIGNvbnN0IHVuc2NhbGVkQUFCQiA9IG5ldyBBQUJCKCk7CiAgY29uc3QgZ2V0RWRnZVZlY3Rvcl92YSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0RWRnZVZlY3Rvcl92YiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY2IgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFiID0gbmV3IFZlYzMoKTsKICBjb25zdCB2YSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdmIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHZjID0gbmV3IFZlYzMoKTsKICBjb25zdCBjbGlfYWFiYiA9IG5ldyBBQUJCKCk7CiAgY29uc3QgY29tcHV0ZUxvY2FsQUFCQl93b3JsZFZlcnQgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNhbGN1bGF0ZVdvcmxkQUFCQl9mcmFtZSA9IG5ldyBUcmFuc2Zvcm0oKTsKICBjb25zdCBjYWxjdWxhdGVXb3JsZEFBQkJfYWFiYiA9IG5ldyBBQUJCKCk7CgogIC8qKgogICAqIENvbnN0cmFpbnQgZXF1YXRpb24gc29sdmVyIGJhc2UgY2xhc3MuCiAgICovCiAgY2xhc3MgU29sdmVyIHsKICAgIC8qKgogICAgICogQWxsIGVxdWF0aW9ucyB0byBiZSBzb2x2ZWQKICAgICAqLwoKICAgIC8qKgogICAgICogQHRvZG8gcmVtb3ZlIHVzZWxlc3MgY29uc3RydWN0b3IKICAgICAqLwogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHRoaXMuZXF1YXRpb25zID0gW107CiAgICB9CiAgICAvKioKICAgICAqIFNob3VsZCBiZSBpbXBsZW1lbnRlZCBpbiBzdWJjbGFzc2VzIQogICAgICogQHRvZG8gdXNlIGFic3RyYWN0CiAgICAgKiBAcmV0dXJuIG51bWJlciBvZiBpdGVyYXRpb25zIHBlcmZvcm1lZAogICAgICovCgoKICAgIHNvbHZlKGR0LCB3b3JsZCkgewogICAgICByZXR1cm4gKC8vIFNob3VsZCByZXR1cm4gdGhlIG51bWJlciBvZiBpdGVyYXRpb25zIGRvbmUhCiAgICAgICAgMAogICAgICApOwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgYW4gZXF1YXRpb24KICAgICAqLwoKCiAgICBhZGRFcXVhdGlvbihlcSkgewogICAgICBpZiAoZXEuZW5hYmxlZCAmJiAhZXEuYmkuaXNUcmlnZ2VyICYmICFlcS5iai5pc1RyaWdnZXIpIHsKICAgICAgICB0aGlzLmVxdWF0aW9ucy5wdXNoKGVxKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmUgYW4gZXF1YXRpb24KICAgICAqLwoKCiAgICByZW1vdmVFcXVhdGlvbihlcSkgewogICAgICBjb25zdCBlcXMgPSB0aGlzLmVxdWF0aW9uczsKICAgICAgY29uc3QgaSA9IGVxcy5pbmRleE9mKGVxKTsKCiAgICAgIGlmIChpICE9PSAtMSkgewogICAgICAgIGVxcy5zcGxpY2UoaSwgMSk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQWRkIGFsbCBlcXVhdGlvbnMKICAgICAqLwoKCiAgICByZW1vdmVBbGxFcXVhdGlvbnMoKSB7CiAgICAgIHRoaXMuZXF1YXRpb25zLmxlbmd0aCA9IDA7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQ29uc3RyYWludCBlcXVhdGlvbiBHYXVzcy1TZWlkZWwgc29sdmVyLgogICAqIEB0b2RvIFRoZSBzcG9vayBwYXJhbWV0ZXJzIHNob3VsZCBiZSBzcGVjaWZpZWQgZm9yIGVhY2ggY29uc3RyYWludCwgbm90IGdsb2JhbGx5LgogICAqIEBzZWUgaHR0cHM6Ly93d3c4LmNzLnVtdS5zZS9rdXJzZXIvNURWMDU4L1ZUMDkvbGVjdHVyZXMvc3Bvb2tub3Rlcy5wZGYKICAgKi8KICBjbGFzcyBHU1NvbHZlciBleHRlbmRzIFNvbHZlciB7CiAgICAvKioKICAgICAqIFRoZSBudW1iZXIgb2Ygc29sdmVyIGl0ZXJhdGlvbnMgZGV0ZXJtaW5lcyBxdWFsaXR5IG9mIHRoZSBjb25zdHJhaW50cyBpbiB0aGUgd29ybGQuCiAgICAgKiBUaGUgbW9yZSBpdGVyYXRpb25zLCB0aGUgbW9yZSBjb3JyZWN0IHNpbXVsYXRpb24uIE1vcmUgaXRlcmF0aW9ucyBuZWVkIG1vcmUgY29tcHV0YXRpb25zIHRob3VnaC4gSWYgeW91IGhhdmUgYSBsYXJnZSBncmF2aXR5IGZvcmNlIGluIHlvdXIgd29ybGQsIHlvdSB3aWxsIG5lZWQgbW9yZSBpdGVyYXRpb25zLgogICAgICovCgogICAgLyoqCiAgICAgKiBXaGVuIHRvbGVyYW5jZSBpcyByZWFjaGVkLCB0aGUgc3lzdGVtIGlzIGFzc3VtZWQgdG8gYmUgY29udmVyZ2VkLgogICAgICovCgogICAgLyoqCiAgICAgKiBAdG9kbyByZW1vdmUgdXNlbGVzcyBjb25zdHJ1Y3RvcgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgc3VwZXIoKTsKICAgICAgdGhpcy5pdGVyYXRpb25zID0gMTA7CiAgICAgIHRoaXMudG9sZXJhbmNlID0gMWUtNzsKICAgIH0KICAgIC8qKgogICAgICogU29sdmUKICAgICAqIEByZXR1cm4gbnVtYmVyIG9mIGl0ZXJhdGlvbnMgcGVyZm9ybWVkCiAgICAgKi8KCgogICAgc29sdmUoZHQsIHdvcmxkKSB7CiAgICAgIGxldCBpdGVyID0gMDsKICAgICAgY29uc3QgbWF4SXRlciA9IHRoaXMuaXRlcmF0aW9uczsKICAgICAgY29uc3QgdG9sU3F1YXJlZCA9IHRoaXMudG9sZXJhbmNlICogdGhpcy50b2xlcmFuY2U7CiAgICAgIGNvbnN0IGVxdWF0aW9ucyA9IHRoaXMuZXF1YXRpb25zOwogICAgICBjb25zdCBOZXEgPSBlcXVhdGlvbnMubGVuZ3RoOwogICAgICBjb25zdCBib2RpZXMgPSB3b3JsZC5ib2RpZXM7CiAgICAgIGNvbnN0IE5ib2RpZXMgPSBib2RpZXMubGVuZ3RoOwogICAgICBjb25zdCBoID0gZHQ7CiAgICAgIGxldCBCOwogICAgICBsZXQgaW52QzsKICAgICAgbGV0IGRlbHRhbGFtYmRhOwogICAgICBsZXQgZGVsdGFsYW1iZGFUb3Q7CiAgICAgIGxldCBHV2xhbWJkYTsKICAgICAgbGV0IGxhbWJkYWo7IC8vIFVwZGF0ZSBzb2x2ZSBtYXNzCgogICAgICBpZiAoTmVxICE9PSAwKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE5ib2RpZXM7IGkrKykgewogICAgICAgICAgYm9kaWVzW2ldLnVwZGF0ZVNvbHZlTWFzc1Byb3BlcnRpZXMoKTsKICAgICAgICB9CiAgICAgIH0gLy8gVGhpbmdzIHRoYXQgZG8gbm90IGNoYW5nZSBkdXJpbmcgaXRlcmF0aW9uIGNhbiBiZSBjb21wdXRlZCBvbmNlCgoKICAgICAgY29uc3QgaW52Q3MgPSBHU1NvbHZlcl9zb2x2ZV9pbnZDczsKICAgICAgY29uc3QgQnMgPSBHU1NvbHZlcl9zb2x2ZV9CczsKICAgICAgY29uc3QgbGFtYmRhID0gR1NTb2x2ZXJfc29sdmVfbGFtYmRhOwogICAgICBpbnZDcy5sZW5ndGggPSBOZXE7CiAgICAgIEJzLmxlbmd0aCA9IE5lcTsKICAgICAgbGFtYmRhLmxlbmd0aCA9IE5lcTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOZXE7IGkrKykgewogICAgICAgIGNvbnN0IGMgPSBlcXVhdGlvbnNbaV07CiAgICAgICAgbGFtYmRhW2ldID0gMC4wOwogICAgICAgIEJzW2ldID0gYy5jb21wdXRlQihoKTsKICAgICAgICBpbnZDc1tpXSA9IDEuMCAvIGMuY29tcHV0ZUMoKTsKICAgICAgfQoKICAgICAgaWYgKE5lcSAhPT0gMCkgewogICAgICAgIC8vIFJlc2V0IHZsYW1iZGEKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTmJvZGllczsgaSsrKSB7CiAgICAgICAgICBjb25zdCBiID0gYm9kaWVzW2ldOwogICAgICAgICAgY29uc3QgdmxhbWJkYSA9IGIudmxhbWJkYTsKICAgICAgICAgIGNvbnN0IHdsYW1iZGEgPSBiLndsYW1iZGE7CiAgICAgICAgICB2bGFtYmRhLnNldCgwLCAwLCAwKTsKICAgICAgICAgIHdsYW1iZGEuc2V0KDAsIDAsIDApOwogICAgICAgIH0gLy8gSXRlcmF0ZSBvdmVyIGVxdWF0aW9ucwoKCiAgICAgICAgZm9yIChpdGVyID0gMDsgaXRlciAhPT0gbWF4SXRlcjsgaXRlcisrKSB7CiAgICAgICAgICAvLyBBY2N1bXVsYXRlIHRoZSB0b3RhbCBlcnJvciBmb3IgZWFjaCBpdGVyYXRpb24uCiAgICAgICAgICBkZWx0YWxhbWJkYVRvdCA9IDAuMDsKCiAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiAhPT0gTmVxOyBqKyspIHsKICAgICAgICAgICAgY29uc3QgYyA9IGVxdWF0aW9uc1tqXTsgLy8gQ29tcHV0ZSBpdGVyYXRpb24KCiAgICAgICAgICAgIEIgPSBCc1tqXTsKICAgICAgICAgICAgaW52QyA9IGludkNzW2pdOwogICAgICAgICAgICBsYW1iZGFqID0gbGFtYmRhW2pdOwogICAgICAgICAgICBHV2xhbWJkYSA9IGMuY29tcHV0ZUdXbGFtYmRhKCk7CiAgICAgICAgICAgIGRlbHRhbGFtYmRhID0gaW52QyAqIChCIC0gR1dsYW1iZGEgLSBjLmVwcyAqIGxhbWJkYWopOyAvLyBDbGFtcCBpZiB3ZSBhcmUgbm90IHdpdGhpbiB0aGUgbWluL21heCBpbnRlcnZhbAoKICAgICAgICAgICAgaWYgKGxhbWJkYWogKyBkZWx0YWxhbWJkYSA8IGMubWluRm9yY2UpIHsKICAgICAgICAgICAgICBkZWx0YWxhbWJkYSA9IGMubWluRm9yY2UgLSBsYW1iZGFqOwogICAgICAgICAgICB9IGVsc2UgaWYgKGxhbWJkYWogKyBkZWx0YWxhbWJkYSA+IGMubWF4Rm9yY2UpIHsKICAgICAgICAgICAgICBkZWx0YWxhbWJkYSA9IGMubWF4Rm9yY2UgLSBsYW1iZGFqOwogICAgICAgICAgICB9CgogICAgICAgICAgICBsYW1iZGFbal0gKz0gZGVsdGFsYW1iZGE7CiAgICAgICAgICAgIGRlbHRhbGFtYmRhVG90ICs9IGRlbHRhbGFtYmRhID4gMC4wID8gZGVsdGFsYW1iZGEgOiAtZGVsdGFsYW1iZGE7IC8vIGFicyhkZWx0YWxhbWJkYSkKCiAgICAgICAgICAgIGMuYWRkVG9XbGFtYmRhKGRlbHRhbGFtYmRhKTsKICAgICAgICAgIH0gLy8gSWYgdGhlIHRvdGFsIGVycm9yIGlzIHNtYWxsIGVub3VnaCAtIHN0b3AgaXRlcmF0ZQoKCiAgICAgICAgICBpZiAoZGVsdGFsYW1iZGFUb3QgKiBkZWx0YWxhbWJkYVRvdCA8IHRvbFNxdWFyZWQpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBBZGQgcmVzdWx0IHRvIHZlbG9jaXR5CgoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTmJvZGllczsgaSsrKSB7CiAgICAgICAgICBjb25zdCBiID0gYm9kaWVzW2ldOwogICAgICAgICAgY29uc3QgdiA9IGIudmVsb2NpdHk7CiAgICAgICAgICBjb25zdCB3ID0gYi5hbmd1bGFyVmVsb2NpdHk7CiAgICAgICAgICBiLnZsYW1iZGEudm11bChiLmxpbmVhckZhY3RvciwgYi52bGFtYmRhKTsKICAgICAgICAgIHYudmFkZChiLnZsYW1iZGEsIHYpOwogICAgICAgICAgYi53bGFtYmRhLnZtdWwoYi5hbmd1bGFyRmFjdG9yLCBiLndsYW1iZGEpOwogICAgICAgICAgdy52YWRkKGIud2xhbWJkYSwgdyk7CiAgICAgICAgfSAvLyBTZXQgdGhlIGAubXVsdGlwbGllcmAgcHJvcGVydHkgb2YgZWFjaCBlcXVhdGlvbgoKCiAgICAgICAgbGV0IGwgPSBlcXVhdGlvbnMubGVuZ3RoOwogICAgICAgIGNvbnN0IGludkR0ID0gMSAvIGg7CgogICAgICAgIHdoaWxlIChsLS0pIHsKICAgICAgICAgIGVxdWF0aW9uc1tsXS5tdWx0aXBsaWVyID0gbGFtYmRhW2xdICogaW52RHQ7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gaXRlcjsKICAgIH0KCiAgfSAvLyBKdXN0IHRlbXBvcmFyeSBudW1iZXIgaG9sZGVycyB0aGF0IHdlIHdhbnQgdG8gcmV1c2UgZWFjaCBpdGVyYXRpb24uCgogIGNvbnN0IEdTU29sdmVyX3NvbHZlX2xhbWJkYSA9IFtdOwogIGNvbnN0IEdTU29sdmVyX3NvbHZlX2ludkNzID0gW107CiAgY29uc3QgR1NTb2x2ZXJfc29sdmVfQnMgPSBbXTsKCiAgLyoqCiAgICogU3BsaXRzIHRoZSBlcXVhdGlvbnMgaW50byBpc2xhbmRzIGFuZCBzb2x2ZXMgdGhlbSBpbmRlcGVuZGVudGx5LiBDYW4gaW1wcm92ZSBwZXJmb3JtYW5jZS4KICAgKi8KICBjbGFzcyBTcGxpdFNvbHZlciBleHRlbmRzIFNvbHZlciB7CiAgICAvKioKICAgICAqIFRoZSBudW1iZXIgb2Ygc29sdmVyIGl0ZXJhdGlvbnMgZGV0ZXJtaW5lcyBxdWFsaXR5IG9mIHRoZSBjb25zdHJhaW50cyBpbiB0aGUgd29ybGQuIFRoZSBtb3JlIGl0ZXJhdGlvbnMsIHRoZSBtb3JlIGNvcnJlY3Qgc2ltdWxhdGlvbi4gTW9yZSBpdGVyYXRpb25zIG5lZWQgbW9yZSBjb21wdXRhdGlvbnMgdGhvdWdoLiBJZiB5b3UgaGF2ZSBhIGxhcmdlIGdyYXZpdHkgZm9yY2UgaW4geW91ciB3b3JsZCwgeW91IHdpbGwgbmVlZCBtb3JlIGl0ZXJhdGlvbnMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZW4gdG9sZXJhbmNlIGlzIHJlYWNoZWQsIHRoZSBzeXN0ZW0gaXMgYXNzdW1lZCB0byBiZSBjb252ZXJnZWQuCiAgICAgKi8KCiAgICAvKiogc3Vic29sdmVyICovCiAgICBjb25zdHJ1Y3RvcihzdWJzb2x2ZXIpIHsKICAgICAgc3VwZXIoKTsKICAgICAgdGhpcy5pdGVyYXRpb25zID0gMTA7CiAgICAgIHRoaXMudG9sZXJhbmNlID0gMWUtNzsKICAgICAgdGhpcy5zdWJzb2x2ZXIgPSBzdWJzb2x2ZXI7CiAgICAgIHRoaXMubm9kZXMgPSBbXTsKICAgICAgdGhpcy5ub2RlUG9vbCA9IFtdOyAvLyBDcmVhdGUgbmVlZGVkIG5vZGVzLCByZXVzZSBpZiBwb3NzaWJsZQoKICAgICAgd2hpbGUgKHRoaXMubm9kZVBvb2wubGVuZ3RoIDwgMTI4KSB7CiAgICAgICAgdGhpcy5ub2RlUG9vbC5wdXNoKHRoaXMuY3JlYXRlTm9kZSgpKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBjcmVhdGVOb2RlCiAgICAgKi8KCgogICAgY3JlYXRlTm9kZSgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBib2R5OiBudWxsLAogICAgICAgIGNoaWxkcmVuOiBbXSwKICAgICAgICBlcXM6IFtdLAogICAgICAgIHZpc2l0ZWQ6IGZhbHNlCiAgICAgIH07CiAgICB9CiAgICAvKioKICAgICAqIFNvbHZlIHRoZSBzdWJzeXN0ZW1zCiAgICAgKiBAcmV0dXJuIG51bWJlciBvZiBpdGVyYXRpb25zIHBlcmZvcm1lZAogICAgICovCgoKICAgIHNvbHZlKGR0LCB3b3JsZCkgewogICAgICBjb25zdCBub2RlcyA9IFNwbGl0U29sdmVyX3NvbHZlX25vZGVzOwogICAgICBjb25zdCBub2RlUG9vbCA9IHRoaXMubm9kZVBvb2w7CiAgICAgIGNvbnN0IGJvZGllcyA9IHdvcmxkLmJvZGllczsKICAgICAgY29uc3QgZXF1YXRpb25zID0gdGhpcy5lcXVhdGlvbnM7CiAgICAgIGNvbnN0IE5lcSA9IGVxdWF0aW9ucy5sZW5ndGg7CiAgICAgIGNvbnN0IE5ib2RpZXMgPSBib2RpZXMubGVuZ3RoOwogICAgICBjb25zdCBzdWJzb2x2ZXIgPSB0aGlzLnN1YnNvbHZlcjsgLy8gQ3JlYXRlIG5lZWRlZCBub2RlcywgcmV1c2UgaWYgcG9zc2libGUKCiAgICAgIHdoaWxlIChub2RlUG9vbC5sZW5ndGggPCBOYm9kaWVzKSB7CiAgICAgICAgbm9kZVBvb2wucHVzaCh0aGlzLmNyZWF0ZU5vZGUoKSk7CiAgICAgIH0KCiAgICAgIG5vZGVzLmxlbmd0aCA9IE5ib2RpZXM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE5ib2RpZXM7IGkrKykgewogICAgICAgIG5vZGVzW2ldID0gbm9kZVBvb2xbaV07CiAgICAgIH0gLy8gUmVzZXQgbm9kZSB2YWx1ZXMKCgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTmJvZGllczsgaSsrKSB7CiAgICAgICAgY29uc3Qgbm9kZSA9IG5vZGVzW2ldOwogICAgICAgIG5vZGUuYm9keSA9IGJvZGllc1tpXTsKICAgICAgICBub2RlLmNoaWxkcmVuLmxlbmd0aCA9IDA7CiAgICAgICAgbm9kZS5lcXMubGVuZ3RoID0gMDsKICAgICAgICBub2RlLnZpc2l0ZWQgPSBmYWxzZTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgayA9IDA7IGsgIT09IE5lcTsgaysrKSB7CiAgICAgICAgY29uc3QgZXEgPSBlcXVhdGlvbnNba107CiAgICAgICAgY29uc3QgaSA9IGJvZGllcy5pbmRleE9mKGVxLmJpKTsKICAgICAgICBjb25zdCBqID0gYm9kaWVzLmluZGV4T2YoZXEuYmopOwogICAgICAgIGNvbnN0IG5pID0gbm9kZXNbaV07CiAgICAgICAgY29uc3QgbmogPSBub2Rlc1tqXTsKICAgICAgICBuaS5jaGlsZHJlbi5wdXNoKG5qKTsKICAgICAgICBuaS5lcXMucHVzaChlcSk7CiAgICAgICAgbmouY2hpbGRyZW4ucHVzaChuaSk7CiAgICAgICAgbmouZXFzLnB1c2goZXEpOwogICAgICB9CgogICAgICBsZXQgY2hpbGQ7CiAgICAgIGxldCBuID0gMDsKICAgICAgbGV0IGVxcyA9IFNwbGl0U29sdmVyX3NvbHZlX2VxczsKICAgICAgc3Vic29sdmVyLnRvbGVyYW5jZSA9IHRoaXMudG9sZXJhbmNlOwogICAgICBzdWJzb2x2ZXIuaXRlcmF0aW9ucyA9IHRoaXMuaXRlcmF0aW9uczsKICAgICAgY29uc3QgZHVtbXlXb3JsZCA9IFNwbGl0U29sdmVyX3NvbHZlX2R1bW15V29ybGQ7CgogICAgICB3aGlsZSAoY2hpbGQgPSBnZXRVbnZpc2l0ZWROb2RlKG5vZGVzKSkgewogICAgICAgIGVxcy5sZW5ndGggPSAwOwogICAgICAgIGR1bW15V29ybGQuYm9kaWVzLmxlbmd0aCA9IDA7CiAgICAgICAgYmZzKGNoaWxkLCB2aXNpdEZ1bmMsIGR1bW15V29ybGQuYm9kaWVzLCBlcXMpOwogICAgICAgIGNvbnN0IE5lcXMgPSBlcXMubGVuZ3RoOwogICAgICAgIGVxcyA9IGVxcy5zb3J0KHNvcnRCeUlkKTsKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE5lcXM7IGkrKykgewogICAgICAgICAgc3Vic29sdmVyLmFkZEVxdWF0aW9uKGVxc1tpXSk7CiAgICAgICAgfQoKICAgICAgICBzdWJzb2x2ZXIuc29sdmUoZHQsIGR1bW15V29ybGQpOwogICAgICAgIHN1YnNvbHZlci5yZW1vdmVBbGxFcXVhdGlvbnMoKTsKICAgICAgICBuKys7CiAgICAgIH0KCiAgICAgIHJldHVybiBuOwogICAgfQoKICB9IC8vIFJldHVybnMgdGhlIG51bWJlciBvZiBzdWJzeXN0ZW1zCgogIGNvbnN0IFNwbGl0U29sdmVyX3NvbHZlX25vZGVzID0gW107IC8vIEFsbCBhbGxvY2F0ZWQgbm9kZSBvYmplY3RzCgogIGNvbnN0IFNwbGl0U29sdmVyX3NvbHZlX2VxcyA9IFtdOyAvLyBUZW1wIGFycmF5CgogIGNvbnN0IFNwbGl0U29sdmVyX3NvbHZlX2R1bW15V29ybGQgPSB7CiAgICBib2RpZXM6IFtdCiAgfTsgLy8gVGVtcCBvYmplY3QKCiAgY29uc3QgU1RBVElDID0gQm9keS5TVEFUSUM7CgogIGZ1bmN0aW9uIGdldFVudmlzaXRlZE5vZGUobm9kZXMpIHsKICAgIGNvbnN0IE5ub2RlcyA9IG5vZGVzLmxlbmd0aDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTm5vZGVzOyBpKyspIHsKICAgICAgY29uc3Qgbm9kZSA9IG5vZGVzW2ldOwoKICAgICAgaWYgKCFub2RlLnZpc2l0ZWQgJiYgIShub2RlLmJvZHkudHlwZSAmIFNUQVRJQykpIHsKICAgICAgICByZXR1cm4gbm9kZTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBmYWxzZTsKICB9CgogIGNvbnN0IHF1ZXVlID0gW107CgogIGZ1bmN0aW9uIGJmcyhyb290LCB2aXNpdEZ1bmMsIGJkcywgZXFzKSB7CiAgICBxdWV1ZS5wdXNoKHJvb3QpOwogICAgcm9vdC52aXNpdGVkID0gdHJ1ZTsKICAgIHZpc2l0RnVuYyhyb290LCBiZHMsIGVxcyk7CgogICAgd2hpbGUgKHF1ZXVlLmxlbmd0aCkgewogICAgICBjb25zdCBub2RlID0gcXVldWUucG9wKCk7IC8vIExvb3Agb3ZlciB1bnZpc2l0ZWQgY2hpbGQgbm9kZXMKCiAgICAgIGxldCBjaGlsZDsKCiAgICAgIHdoaWxlIChjaGlsZCA9IGdldFVudmlzaXRlZE5vZGUobm9kZS5jaGlsZHJlbikpIHsKICAgICAgICBjaGlsZC52aXNpdGVkID0gdHJ1ZTsKICAgICAgICB2aXNpdEZ1bmMoY2hpbGQsIGJkcywgZXFzKTsKICAgICAgICBxdWV1ZS5wdXNoKGNoaWxkKTsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gdmlzaXRGdW5jKG5vZGUsIGJkcywgZXFzKSB7CiAgICBiZHMucHVzaChub2RlLmJvZHkpOwogICAgY29uc3QgTmVxcyA9IG5vZGUuZXFzLmxlbmd0aDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTmVxczsgaSsrKSB7CiAgICAgIGNvbnN0IGVxID0gbm9kZS5lcXNbaV07CgogICAgICBpZiAoIWVxcy5pbmNsdWRlcyhlcSkpIHsKICAgICAgICBlcXMucHVzaChlcSk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIHNvcnRCeUlkKGEsIGIpIHsKICAgIHJldHVybiBiLmlkIC0gYS5pZDsKICB9CgogIC8qKgogICAqIEZvciBwb29saW5nIG9iamVjdHMgdGhhdCBjYW4gYmUgcmV1c2VkLgogICAqLwogIGNsYXNzIFBvb2wgewogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHRoaXMub2JqZWN0cyA9IFtdOwogICAgICB0aGlzLnR5cGUgPSBPYmplY3Q7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWxlYXNlIGFuIG9iamVjdCBhZnRlciB1c2UKICAgICAqLwogICAgcmVsZWFzZSgpIHsKICAgICAgY29uc3QgTmFyZ3MgPSBhcmd1bWVudHMubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE5hcmdzOyBpKyspIHsKICAgICAgICB0aGlzLm9iamVjdHMucHVzaChpIDwgMCB8fCBhcmd1bWVudHMubGVuZ3RoIDw9IGkgPyB1bmRlZmluZWQgOiBhcmd1bWVudHNbaV0pOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFuIG9iamVjdAogICAgICovCgoKICAgIGdldCgpIHsKICAgICAgaWYgKHRoaXMub2JqZWN0cy5sZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3RPYmplY3QoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdGhpcy5vYmplY3RzLnBvcCgpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbnN0cnVjdCBhbiBvYmplY3QuIFNob3VsZCBiZSBpbXBsZW1lbnRlZCBpbiBlYWNoIHN1YmNsYXNzLgogICAgICovCgoKICAgIGNvbnN0cnVjdE9iamVjdCgpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb25zdHJ1Y3RPYmplY3QoKSBub3QgaW1wbGVtZW50ZWQgaW4gdGhpcyBQb29sIHN1YmNsYXNzIHlldCEnKTsKICAgIH0KICAgIC8qKgogICAgICogQHJldHVybiBTZWxmLCBmb3IgY2hhaW5pbmcKICAgICAqLwoKCiAgICByZXNpemUoc2l6ZSkgewogICAgICBjb25zdCBvYmplY3RzID0gdGhpcy5vYmplY3RzOwoKICAgICAgd2hpbGUgKG9iamVjdHMubGVuZ3RoID4gc2l6ZSkgewogICAgICAgIG9iamVjdHMucG9wKCk7CiAgICAgIH0KCiAgICAgIHdoaWxlIChvYmplY3RzLmxlbmd0aCA8IHNpemUpIHsKICAgICAgICBvYmplY3RzLnB1c2godGhpcy5jb25zdHJ1Y3RPYmplY3QoKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICB9CgogIC8qKgogICAqIFZlYzNQb29sCiAgICovCgogIGNsYXNzIFZlYzNQb29sIGV4dGVuZHMgUG9vbCB7CiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgc3VwZXIoLi4uYXJndW1lbnRzKTsKICAgICAgdGhpcy50eXBlID0gVmVjMzsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnN0cnVjdCBhIHZlY3RvcgogICAgICovCiAgICBjb25zdHJ1Y3RPYmplY3QoKSB7CiAgICAgIHJldHVybiBuZXcgVmVjMygpOwogICAgfQoKICB9CgogIC8vIE5hbWluZyBydWxlOiBiYXNlZCBvZiB0aGUgb3JkZXIgaW4gU0hBUEVfVFlQRVMsCiAgLy8gdGhlIGZpcnN0IHBhcnQgb2YgdGhlIG1ldGhvZCBpcyBmb3JtZWQgYnkgdGhlCiAgLy8gc2hhcGUgdHlwZSB0aGF0IGNvbWVzIGJlZm9yZSwgaW4gdGhlIHNlY29uZCBwYXJ0CiAgLy8gdGhlcmUgaXMgdGhlIHNoYXBlIHR5cGUgdGhhdCBjb21lcyBhZnRlciBpbiB0aGUgU0hBUEVfVFlQRVMgbGlzdAogIGNvbnN0IENPTExJU0lPTl9UWVBFUyA9IHsKICAgIHNwaGVyZVNwaGVyZTogU2hhcGUudHlwZXMuU1BIRVJFLAogICAgc3BoZXJlUGxhbmU6IFNoYXBlLnR5cGVzLlNQSEVSRSB8IFNoYXBlLnR5cGVzLlBMQU5FLAogICAgYm94Qm94OiBTaGFwZS50eXBlcy5CT1ggfCBTaGFwZS50eXBlcy5CT1gsCiAgICBzcGhlcmVCb3g6IFNoYXBlLnR5cGVzLlNQSEVSRSB8IFNoYXBlLnR5cGVzLkJPWCwKICAgIHBsYW5lQm94OiBTaGFwZS50eXBlcy5QTEFORSB8IFNoYXBlLnR5cGVzLkJPWCwKICAgIGNvbnZleENvbnZleDogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiwKICAgIHNwaGVyZUNvbnZleDogU2hhcGUudHlwZXMuU1BIRVJFIHwgU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiwKICAgIHBsYW5lQ29udmV4OiBTaGFwZS50eXBlcy5QTEFORSB8IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04sCiAgICBib3hDb252ZXg6IFNoYXBlLnR5cGVzLkJPWCB8IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04sCiAgICBzcGhlcmVIZWlnaHRmaWVsZDogU2hhcGUudHlwZXMuU1BIRVJFIHwgU2hhcGUudHlwZXMuSEVJR0hURklFTEQsCiAgICBib3hIZWlnaHRmaWVsZDogU2hhcGUudHlwZXMuQk9YIHwgU2hhcGUudHlwZXMuSEVJR0hURklFTEQsCiAgICBjb252ZXhIZWlnaHRmaWVsZDogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiB8IFNoYXBlLnR5cGVzLkhFSUdIVEZJRUxELAogICAgc3BoZXJlUGFydGljbGU6IFNoYXBlLnR5cGVzLlBBUlRJQ0xFIHwgU2hhcGUudHlwZXMuU1BIRVJFLAogICAgcGxhbmVQYXJ0aWNsZTogU2hhcGUudHlwZXMuUExBTkUgfCBTaGFwZS50eXBlcy5QQVJUSUNMRSwKICAgIGJveFBhcnRpY2xlOiBTaGFwZS50eXBlcy5CT1ggfCBTaGFwZS50eXBlcy5QQVJUSUNMRSwKICAgIGNvbnZleFBhcnRpY2xlOiBTaGFwZS50eXBlcy5QQVJUSUNMRSB8IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04sCiAgICBjeWxpbmRlckN5bGluZGVyOiBTaGFwZS50eXBlcy5DWUxJTkRFUiwKICAgIHNwaGVyZUN5bGluZGVyOiBTaGFwZS50eXBlcy5TUEhFUkUgfCBTaGFwZS50eXBlcy5DWUxJTkRFUiwKICAgIHBsYW5lQ3lsaW5kZXI6IFNoYXBlLnR5cGVzLlBMQU5FIHwgU2hhcGUudHlwZXMuQ1lMSU5ERVIsCiAgICBib3hDeWxpbmRlcjogU2hhcGUudHlwZXMuQk9YIHwgU2hhcGUudHlwZXMuQ1lMSU5ERVIsCiAgICBjb252ZXhDeWxpbmRlcjogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiB8IFNoYXBlLnR5cGVzLkNZTElOREVSLAogICAgaGVpZ2h0ZmllbGRDeWxpbmRlcjogU2hhcGUudHlwZXMuSEVJR0hURklFTEQgfCBTaGFwZS50eXBlcy5DWUxJTkRFUiwKICAgIHBhcnRpY2xlQ3lsaW5kZXI6IFNoYXBlLnR5cGVzLlBBUlRJQ0xFIHwgU2hhcGUudHlwZXMuQ1lMSU5ERVIsCiAgICBzcGhlcmVUcmltZXNoOiBTaGFwZS50eXBlcy5TUEhFUkUgfCBTaGFwZS50eXBlcy5UUklNRVNILAogICAgcGxhbmVUcmltZXNoOiBTaGFwZS50eXBlcy5QTEFORSB8IFNoYXBlLnR5cGVzLlRSSU1FU0gKICB9OwoKICAvKioKICAgKiBIZWxwZXIgY2xhc3MgZm9yIHRoZSBXb3JsZC4gR2VuZXJhdGVzIENvbnRhY3RFcXVhdGlvbnMuCiAgICogQHRvZG8gU3BoZXJlLUNvbnZleFBvbHloZWRyb24gY29udGFjdHMKICAgKiBAdG9kbyBDb250YWN0IHJlZHVjdGlvbgogICAqIEB0b2RvIHNob3VsZCBtb3ZlIG1ldGhvZHMgdG8gcHJvdG90eXBlCiAgICovCiAgY2xhc3MgTmFycm93cGhhc2UgewogICAgLyoqCiAgICAgKiBJbnRlcm5hbCBzdG9yYWdlIG9mIHBvb2xlZCBjb250YWN0IHBvaW50cy4KICAgICAqLwoKICAgIC8qKgogICAgICogUG9vbGVkIHZlY3RvcnMuCiAgICAgKi8KICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnNwaGVyZVNwaGVyZV0oKSB7CiAgICAgIHJldHVybiB0aGlzLnNwaGVyZVNwaGVyZTsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5zcGhlcmVQbGFuZV0oKSB7CiAgICAgIHJldHVybiB0aGlzLnNwaGVyZVBsYW5lOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmJveEJveF0oKSB7CiAgICAgIHJldHVybiB0aGlzLmJveEJveDsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5zcGhlcmVCb3hdKCkgewogICAgICByZXR1cm4gdGhpcy5zcGhlcmVCb3g7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMucGxhbmVCb3hdKCkgewogICAgICByZXR1cm4gdGhpcy5wbGFuZUJveDsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5jb252ZXhDb252ZXhdKCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhDb252ZXg7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuc3BoZXJlQ29udmV4XSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlQ29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnBsYW5lQ29udmV4XSgpIHsKICAgICAgcmV0dXJuIHRoaXMucGxhbmVDb252ZXg7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuYm94Q29udmV4XSgpIHsKICAgICAgcmV0dXJuIHRoaXMuYm94Q29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnNwaGVyZUhlaWdodGZpZWxkXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlSGVpZ2h0ZmllbGQ7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuYm94SGVpZ2h0ZmllbGRdKCkgewogICAgICByZXR1cm4gdGhpcy5ib3hIZWlnaHRmaWVsZDsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5jb252ZXhIZWlnaHRmaWVsZF0oKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbnZleEhlaWdodGZpZWxkOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnNwaGVyZVBhcnRpY2xlXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlUGFydGljbGU7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMucGxhbmVQYXJ0aWNsZV0oKSB7CiAgICAgIHJldHVybiB0aGlzLnBsYW5lUGFydGljbGU7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuYm94UGFydGljbGVdKCkgewogICAgICByZXR1cm4gdGhpcy5ib3hQYXJ0aWNsZTsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5jb252ZXhQYXJ0aWNsZV0oKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbnZleFBhcnRpY2xlOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmN5bGluZGVyQ3lsaW5kZXJdKCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhDb252ZXg7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuc3BoZXJlQ3lsaW5kZXJdKCkgewogICAgICByZXR1cm4gdGhpcy5zcGhlcmVDb252ZXg7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMucGxhbmVDeWxpbmRlcl0oKSB7CiAgICAgIHJldHVybiB0aGlzLnBsYW5lQ29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmJveEN5bGluZGVyXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuYm94Q29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmNvbnZleEN5bGluZGVyXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuY29udmV4Q29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmhlaWdodGZpZWxkQ3lsaW5kZXJdKCkgewogICAgICByZXR1cm4gdGhpcy5oZWlnaHRmaWVsZEN5bGluZGVyOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnBhcnRpY2xlQ3lsaW5kZXJdKCkgewogICAgICByZXR1cm4gdGhpcy5wYXJ0aWNsZUN5bGluZGVyOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnNwaGVyZVRyaW1lc2hdKCkgewogICAgICByZXR1cm4gdGhpcy5zcGhlcmVUcmltZXNoOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnBsYW5lVHJpbWVzaF0oKSB7CiAgICAgIHJldHVybiB0aGlzLnBsYW5lVHJpbWVzaDsKICAgIH0gLy8gZ2V0IFtDT0xMSVNJT05fVFlQRVMuY29udmV4VHJpbWVzaF0oKSB7CiAgICAvLyAgIHJldHVybiB0aGlzLmNvbnZleFRyaW1lc2gKICAgIC8vIH0KCgogICAgY29uc3RydWN0b3Iod29ybGQpIHsKICAgICAgdGhpcy5jb250YWN0UG9pbnRQb29sID0gW107CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvblBvb2wgPSBbXTsKICAgICAgdGhpcy5yZXN1bHQgPSBbXTsKICAgICAgdGhpcy5mcmljdGlvblJlc3VsdCA9IFtdOwogICAgICB0aGlzLnYzcG9vbCA9IG5ldyBWZWMzUG9vbCgpOwogICAgICB0aGlzLndvcmxkID0gd29ybGQ7CiAgICAgIHRoaXMuY3VycmVudENvbnRhY3RNYXRlcmlhbCA9IHdvcmxkLmRlZmF1bHRDb250YWN0TWF0ZXJpYWw7CiAgICAgIHRoaXMuZW5hYmxlRnJpY3Rpb25SZWR1Y3Rpb24gPSBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogTWFrZSBhIGNvbnRhY3Qgb2JqZWN0LCBieSB1c2luZyB0aGUgaW50ZXJuYWwgcG9vbCBvciBjcmVhdGluZyBhIG5ldyBvbmUuCiAgICAgKi8KCgogICAgY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCBvdmVycmlkZVNoYXBlQSwgb3ZlcnJpZGVTaGFwZUIpIHsKICAgICAgbGV0IGM7CgogICAgICBpZiAodGhpcy5jb250YWN0UG9pbnRQb29sLmxlbmd0aCkgewogICAgICAgIGMgPSB0aGlzLmNvbnRhY3RQb2ludFBvb2wucG9wKCk7CiAgICAgICAgYy5iaSA9IGJpOwogICAgICAgIGMuYmogPSBiajsKICAgICAgfSBlbHNlIHsKICAgICAgICBjID0gbmV3IENvbnRhY3RFcXVhdGlvbihiaSwgYmopOwogICAgICB9CgogICAgICBjLmVuYWJsZWQgPSBiaS5jb2xsaXNpb25SZXNwb25zZSAmJiBiai5jb2xsaXNpb25SZXNwb25zZSAmJiBzaS5jb2xsaXNpb25SZXNwb25zZSAmJiBzai5jb2xsaXNpb25SZXNwb25zZTsKICAgICAgY29uc3QgY20gPSB0aGlzLmN1cnJlbnRDb250YWN0TWF0ZXJpYWw7CiAgICAgIGMucmVzdGl0dXRpb24gPSBjbS5yZXN0aXR1dGlvbjsKICAgICAgYy5zZXRTcG9va1BhcmFtcyhjbS5jb250YWN0RXF1YXRpb25TdGlmZm5lc3MsIGNtLmNvbnRhY3RFcXVhdGlvblJlbGF4YXRpb24sIHRoaXMud29ybGQuZHQpOwogICAgICBjb25zdCBtYXRBID0gc2kubWF0ZXJpYWwgfHwgYmkubWF0ZXJpYWw7CiAgICAgIGNvbnN0IG1hdEIgPSBzai5tYXRlcmlhbCB8fCBiai5tYXRlcmlhbDsKCiAgICAgIGlmIChtYXRBICYmIG1hdEIgJiYgbWF0QS5yZXN0aXR1dGlvbiA+PSAwICYmIG1hdEIucmVzdGl0dXRpb24gPj0gMCkgewogICAgICAgIGMucmVzdGl0dXRpb24gPSBtYXRBLnJlc3RpdHV0aW9uICogbWF0Qi5yZXN0aXR1dGlvbjsKICAgICAgfQoKICAgICAgYy5zaSA9IG92ZXJyaWRlU2hhcGVBIHx8IHNpOwogICAgICBjLnNqID0gb3ZlcnJpZGVTaGFwZUIgfHwgc2o7CiAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QoY29udGFjdEVxdWF0aW9uLCBvdXRBcnJheSkgewogICAgICBjb25zdCBib2R5QSA9IGNvbnRhY3RFcXVhdGlvbi5iaTsKICAgICAgY29uc3QgYm9keUIgPSBjb250YWN0RXF1YXRpb24uYmo7CiAgICAgIGNvbnN0IHNoYXBlQSA9IGNvbnRhY3RFcXVhdGlvbi5zaTsKICAgICAgY29uc3Qgc2hhcGVCID0gY29udGFjdEVxdWF0aW9uLnNqOwogICAgICBjb25zdCB3b3JsZCA9IHRoaXMud29ybGQ7CiAgICAgIGNvbnN0IGNtID0gdGhpcy5jdXJyZW50Q29udGFjdE1hdGVyaWFsOyAvLyBJZiBmcmljdGlvbiBvciByZXN0aXR1dGlvbiB3ZXJlIHNwZWNpZmllZCBpbiB0aGUgbWF0ZXJpYWwsIHVzZSB0aGVtCgogICAgICBsZXQgZnJpY3Rpb24gPSBjbS5mcmljdGlvbjsKICAgICAgY29uc3QgbWF0QSA9IHNoYXBlQS5tYXRlcmlhbCB8fCBib2R5QS5tYXRlcmlhbDsKICAgICAgY29uc3QgbWF0QiA9IHNoYXBlQi5tYXRlcmlhbCB8fCBib2R5Qi5tYXRlcmlhbDsKCiAgICAgIGlmIChtYXRBICYmIG1hdEIgJiYgbWF0QS5mcmljdGlvbiA+PSAwICYmIG1hdEIuZnJpY3Rpb24gPj0gMCkgewogICAgICAgIGZyaWN0aW9uID0gbWF0QS5mcmljdGlvbiAqIG1hdEIuZnJpY3Rpb247CiAgICAgIH0KCiAgICAgIGlmIChmcmljdGlvbiA+IDApIHsKICAgICAgICAvLyBDcmVhdGUgMiB0YW5nZW50IGVxdWF0aW9ucwogICAgICAgIC8vIFVzZXJzIG1heSBwcm92aWRlIGEgZm9yY2UgZGlmZmVyZW50IGZyb20gZ2xvYmFsIGdyYXZpdHkgdG8gdXNlIHdoZW4gY29tcHV0aW5nIGNvbnRhY3QgZnJpY3Rpb24uCiAgICAgICAgY29uc3QgbXVnID0gZnJpY3Rpb24gKiAod29ybGQuZnJpY3Rpb25HcmF2aXR5IHx8IHdvcmxkLmdyYXZpdHkpLmxlbmd0aCgpOwogICAgICAgIGxldCByZWR1Y2VkTWFzcyA9IGJvZHlBLmludk1hc3MgKyBib2R5Qi5pbnZNYXNzOwoKICAgICAgICBpZiAocmVkdWNlZE1hc3MgPiAwKSB7CiAgICAgICAgICByZWR1Y2VkTWFzcyA9IDEgLyByZWR1Y2VkTWFzczsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHBvb2wgPSB0aGlzLmZyaWN0aW9uRXF1YXRpb25Qb29sOwogICAgICAgIGNvbnN0IGMxID0gcG9vbC5sZW5ndGggPyBwb29sLnBvcCgpIDogbmV3IEZyaWN0aW9uRXF1YXRpb24oYm9keUEsIGJvZHlCLCBtdWcgKiByZWR1Y2VkTWFzcyk7CiAgICAgICAgY29uc3QgYzIgPSBwb29sLmxlbmd0aCA/IHBvb2wucG9wKCkgOiBuZXcgRnJpY3Rpb25FcXVhdGlvbihib2R5QSwgYm9keUIsIG11ZyAqIHJlZHVjZWRNYXNzKTsKICAgICAgICBjMS5iaSA9IGMyLmJpID0gYm9keUE7CiAgICAgICAgYzEuYmogPSBjMi5iaiA9IGJvZHlCOwogICAgICAgIGMxLm1pbkZvcmNlID0gYzIubWluRm9yY2UgPSAtbXVnICogcmVkdWNlZE1hc3M7CiAgICAgICAgYzEubWF4Rm9yY2UgPSBjMi5tYXhGb3JjZSA9IG11ZyAqIHJlZHVjZWRNYXNzOyAvLyBDb3B5IG92ZXIgdGhlIHJlbGF0aXZlIHZlY3RvcnMKCiAgICAgICAgYzEucmkuY29weShjb250YWN0RXF1YXRpb24ucmkpOwogICAgICAgIGMxLnJqLmNvcHkoY29udGFjdEVxdWF0aW9uLnJqKTsKICAgICAgICBjMi5yaS5jb3B5KGNvbnRhY3RFcXVhdGlvbi5yaSk7CiAgICAgICAgYzIucmouY29weShjb250YWN0RXF1YXRpb24ucmopOyAvLyBDb25zdHJ1Y3QgdGFuZ2VudHMKCiAgICAgICAgY29udGFjdEVxdWF0aW9uLm5pLnRhbmdlbnRzKGMxLnQsIGMyLnQpOyAvLyBTZXQgc3Bvb2sgcGFyYW1zCgogICAgICAgIGMxLnNldFNwb29rUGFyYW1zKGNtLmZyaWN0aW9uRXF1YXRpb25TdGlmZm5lc3MsIGNtLmZyaWN0aW9uRXF1YXRpb25SZWxheGF0aW9uLCB3b3JsZC5kdCk7CiAgICAgICAgYzIuc2V0U3Bvb2tQYXJhbXMoY20uZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcywgY20uZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24sIHdvcmxkLmR0KTsKICAgICAgICBjMS5lbmFibGVkID0gYzIuZW5hYmxlZCA9IGNvbnRhY3RFcXVhdGlvbi5lbmFibGVkOwogICAgICAgIG91dEFycmF5LnB1c2goYzEsIGMyKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgLyoqCiAgICAgKiBUYWtlIHRoZSBhdmVyYWdlIE4gbGF0ZXN0IGNvbnRhY3QgcG9pbnQgb24gdGhlIHBsYW5lLgogICAgICovCgoKICAgIGNyZWF0ZUZyaWN0aW9uRnJvbUF2ZXJhZ2UobnVtQ29udGFjdHMpIHsKICAgICAgLy8gVGhlIGxhc3QgY29udGFjdEVxdWF0aW9uCiAgICAgIGxldCBjID0gdGhpcy5yZXN1bHRbdGhpcy5yZXN1bHQubGVuZ3RoIC0gMV07IC8vIENyZWF0ZSB0aGUgcmVzdWx0OiB0d28gImF2ZXJhZ2UiIGZyaWN0aW9uIGVxdWF0aW9ucwoKICAgICAgaWYgKCF0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QoYywgdGhpcy5mcmljdGlvblJlc3VsdCkgfHwgbnVtQ29udGFjdHMgPT09IDEpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IGYxID0gdGhpcy5mcmljdGlvblJlc3VsdFt0aGlzLmZyaWN0aW9uUmVzdWx0Lmxlbmd0aCAtIDJdOwogICAgICBjb25zdCBmMiA9IHRoaXMuZnJpY3Rpb25SZXN1bHRbdGhpcy5mcmljdGlvblJlc3VsdC5sZW5ndGggLSAxXTsKICAgICAgYXZlcmFnZU5vcm1hbC5zZXRaZXJvKCk7CiAgICAgIGF2ZXJhZ2VDb250YWN0UG9pbnRBLnNldFplcm8oKTsKICAgICAgYXZlcmFnZUNvbnRhY3RQb2ludEIuc2V0WmVybygpOwogICAgICBjb25zdCBib2R5QSA9IGMuYmk7CiAgICAgIGMuYmo7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gbnVtQ29udGFjdHM7IGkrKykgewogICAgICAgIGMgPSB0aGlzLnJlc3VsdFt0aGlzLnJlc3VsdC5sZW5ndGggLSAxIC0gaV07CgogICAgICAgIGlmIChjLmJpICE9PSBib2R5QSkgewogICAgICAgICAgYXZlcmFnZU5vcm1hbC52YWRkKGMubmksIGF2ZXJhZ2VOb3JtYWwpOwogICAgICAgICAgYXZlcmFnZUNvbnRhY3RQb2ludEEudmFkZChjLnJpLCBhdmVyYWdlQ29udGFjdFBvaW50QSk7CiAgICAgICAgICBhdmVyYWdlQ29udGFjdFBvaW50Qi52YWRkKGMucmosIGF2ZXJhZ2VDb250YWN0UG9pbnRCKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYXZlcmFnZU5vcm1hbC52c3ViKGMubmksIGF2ZXJhZ2VOb3JtYWwpOwogICAgICAgICAgYXZlcmFnZUNvbnRhY3RQb2ludEEudmFkZChjLnJqLCBhdmVyYWdlQ29udGFjdFBvaW50QSk7CiAgICAgICAgICBhdmVyYWdlQ29udGFjdFBvaW50Qi52YWRkKGMucmksIGF2ZXJhZ2VDb250YWN0UG9pbnRCKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IGludk51bUNvbnRhY3RzID0gMSAvIG51bUNvbnRhY3RzOwogICAgICBhdmVyYWdlQ29udGFjdFBvaW50QS5zY2FsZShpbnZOdW1Db250YWN0cywgZjEucmkpOwogICAgICBhdmVyYWdlQ29udGFjdFBvaW50Qi5zY2FsZShpbnZOdW1Db250YWN0cywgZjEucmopOwogICAgICBmMi5yaS5jb3B5KGYxLnJpKTsgLy8gU2hvdWxkIGJlIHRoZSBzYW1lCgogICAgICBmMi5yai5jb3B5KGYxLnJqKTsKICAgICAgYXZlcmFnZU5vcm1hbC5ub3JtYWxpemUoKTsKICAgICAgYXZlcmFnZU5vcm1hbC50YW5nZW50cyhmMS50LCBmMi50KTsgLy8gcmV0dXJuIGVxOwogICAgfQogICAgLyoqCiAgICAgKiBHZW5lcmF0ZSBhbGwgY29udGFjdHMgYmV0d2VlbiBhIGxpc3Qgb2YgYm9keSBwYWlycwogICAgICogQHBhcmFtIHAxIEFycmF5IG9mIGJvZHkgaW5kaWNlcwogICAgICogQHBhcmFtIHAyIEFycmF5IG9mIGJvZHkgaW5kaWNlcwogICAgICogQHBhcmFtIHJlc3VsdCBBcnJheSB0byBzdG9yZSBnZW5lcmF0ZWQgY29udGFjdHMKICAgICAqIEBwYXJhbSBvbGRjb250YWN0cyBPcHRpb25hbC4gQXJyYXkgb2YgcmV1c2FibGUgY29udGFjdCBvYmplY3RzCiAgICAgKi8KCgogICAgZ2V0Q29udGFjdHMocDEsIHAyLCB3b3JsZCwgcmVzdWx0LCBvbGRjb250YWN0cywgZnJpY3Rpb25SZXN1bHQsIGZyaWN0aW9uUG9vbCkgewogICAgICAvLyBTYXZlIG9sZCBjb250YWN0IG9iamVjdHMKICAgICAgdGhpcy5jb250YWN0UG9pbnRQb29sID0gb2xkY29udGFjdHM7CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvblBvb2wgPSBmcmljdGlvblBvb2w7CiAgICAgIHRoaXMucmVzdWx0ID0gcmVzdWx0OwogICAgICB0aGlzLmZyaWN0aW9uUmVzdWx0ID0gZnJpY3Rpb25SZXN1bHQ7CiAgICAgIGNvbnN0IHFpID0gdG1wUXVhdDE7CiAgICAgIGNvbnN0IHFqID0gdG1wUXVhdDI7CiAgICAgIGNvbnN0IHhpID0gdG1wVmVjMTsKICAgICAgY29uc3QgeGogPSB0bXBWZWMyOwoKICAgICAgZm9yIChsZXQgayA9IDAsIE4gPSBwMS5sZW5ndGg7IGsgIT09IE47IGsrKykgewogICAgICAgIC8vIEdldCBjdXJyZW50IGNvbGxpc2lvbiBib2RpZXMKICAgICAgICBjb25zdCBiaSA9IHAxW2tdOwogICAgICAgIGNvbnN0IGJqID0gcDJba107IC8vIEdldCBjb250YWN0IG1hdGVyaWFsCgogICAgICAgIGxldCBib2R5Q29udGFjdE1hdGVyaWFsID0gbnVsbDsKCiAgICAgICAgaWYgKGJpLm1hdGVyaWFsICYmIGJqLm1hdGVyaWFsKSB7CiAgICAgICAgICBib2R5Q29udGFjdE1hdGVyaWFsID0gd29ybGQuZ2V0Q29udGFjdE1hdGVyaWFsKGJpLm1hdGVyaWFsLCBiai5tYXRlcmlhbCkgfHwgbnVsbDsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGp1c3RUZXN0ID0gYmkudHlwZSAmIEJvZHkuS0lORU1BVElDICYmIGJqLnR5cGUgJiBCb2R5LlNUQVRJQyB8fCBiaS50eXBlICYgQm9keS5TVEFUSUMgJiYgYmoudHlwZSAmIEJvZHkuS0lORU1BVElDIHx8IGJpLnR5cGUgJiBCb2R5LktJTkVNQVRJQyAmJiBiai50eXBlICYgQm9keS5LSU5FTUFUSUM7CgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmkuc2hhcGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBiaS5xdWF0ZXJuaW9uLm11bHQoYmkuc2hhcGVPcmllbnRhdGlvbnNbaV0sIHFpKTsKICAgICAgICAgIGJpLnF1YXRlcm5pb24udm11bHQoYmkuc2hhcGVPZmZzZXRzW2ldLCB4aSk7CiAgICAgICAgICB4aS52YWRkKGJpLnBvc2l0aW9uLCB4aSk7CiAgICAgICAgICBjb25zdCBzaSA9IGJpLnNoYXBlc1tpXTsKCiAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGJqLnNoYXBlcy5sZW5ndGg7IGorKykgewogICAgICAgICAgICAvLyBDb21wdXRlIHdvcmxkIHRyYW5zZm9ybSBvZiBzaGFwZXMKICAgICAgICAgICAgYmoucXVhdGVybmlvbi5tdWx0KGJqLnNoYXBlT3JpZW50YXRpb25zW2pdLCBxaik7CiAgICAgICAgICAgIGJqLnF1YXRlcm5pb24udm11bHQoYmouc2hhcGVPZmZzZXRzW2pdLCB4aik7CiAgICAgICAgICAgIHhqLnZhZGQoYmoucG9zaXRpb24sIHhqKTsKICAgICAgICAgICAgY29uc3Qgc2ogPSBiai5zaGFwZXNbal07CgogICAgICAgICAgICBpZiAoIShzaS5jb2xsaXNpb25GaWx0ZXJNYXNrICYgc2ouY29sbGlzaW9uRmlsdGVyR3JvdXAgJiYgc2ouY29sbGlzaW9uRmlsdGVyTWFzayAmIHNpLmNvbGxpc2lvbkZpbHRlckdyb3VwKSkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoeGkuZGlzdGFuY2VUbyh4aikgPiBzaS5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIHNqLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0gLy8gR2V0IGNvbGxpc2lvbiBtYXRlcmlhbAoKCiAgICAgICAgICAgIGxldCBzaGFwZUNvbnRhY3RNYXRlcmlhbCA9IG51bGw7CgogICAgICAgICAgICBpZiAoc2kubWF0ZXJpYWwgJiYgc2oubWF0ZXJpYWwpIHsKICAgICAgICAgICAgICBzaGFwZUNvbnRhY3RNYXRlcmlhbCA9IHdvcmxkLmdldENvbnRhY3RNYXRlcmlhbChzaS5tYXRlcmlhbCwgc2oubWF0ZXJpYWwpIHx8IG51bGw7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMuY3VycmVudENvbnRhY3RNYXRlcmlhbCA9IHNoYXBlQ29udGFjdE1hdGVyaWFsIHx8IGJvZHlDb250YWN0TWF0ZXJpYWwgfHwgd29ybGQuZGVmYXVsdENvbnRhY3RNYXRlcmlhbDsgLy8gR2V0IGNvbnRhY3RzCgogICAgICAgICAgICBjb25zdCByZXNvbHZlckluZGV4ID0gc2kudHlwZSB8IHNqLnR5cGU7CiAgICAgICAgICAgIGNvbnN0IHJlc29sdmVyID0gdGhpc1tyZXNvbHZlckluZGV4XTsKCiAgICAgICAgICAgIGlmIChyZXNvbHZlcikgewogICAgICAgICAgICAgIGxldCByZXR2YWwgPSBmYWxzZTsgLy8gVE8gRE86IGludmVzdGlnYXRlIHdoeSBzcGhlcmVQYXJ0aWNsZSBhbmQgY29udmV4UGFydGljbGUKICAgICAgICAgICAgICAvLyByZXNvbHZlcnMgZXhwZWN0IHNpIGFuZCBzaiBzaGFwZXMgdG8gYmUgaW4gcmV2ZXJzZSBvcmRlcgogICAgICAgICAgICAgIC8vIChpLmUuIGxhcmdlciBpbnRlZ2VyIHZhbHVlIHR5cGUgZmlyc3QgaW5zdGVhZCBvZiBzbWFsbGVyIGZpcnN0KQoKICAgICAgICAgICAgICBpZiAoc2kudHlwZSA8IHNqLnR5cGUpIHsKICAgICAgICAgICAgICAgIHJldHZhbCA9IHJlc29sdmVyLmNhbGwodGhpcywgc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCBzaSwgc2osIGp1c3RUZXN0KTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dmFsID0gcmVzb2x2ZXIuY2FsbCh0aGlzLCBzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHNpLCBzaiwganVzdFRlc3QpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKHJldHZhbCAmJiBqdXN0VGVzdCkgewogICAgICAgICAgICAgICAgLy8gUmVnaXN0ZXIgb3ZlcmxhcAogICAgICAgICAgICAgICAgd29ybGQuc2hhcGVPdmVybGFwS2VlcGVyLnNldChzaS5pZCwgc2ouaWQpOwogICAgICAgICAgICAgICAgd29ybGQuYm9keU92ZXJsYXBLZWVwZXIuc2V0KGJpLmlkLCBiai5pZCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgc3BoZXJlU3BoZXJlKHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgIHJldHVybiB4aS5kaXN0YW5jZVNxdWFyZWQoeGopIDwgKHNpLnJhZGl1cyArIHNqLnJhZGl1cykgKiogMjsKICAgICAgfSAvLyBXZSB3aWxsIGhhdmUgb25seSBvbmUgY29udGFjdCBpbiB0aGlzIGNhc2UKCgogICAgICBjb25zdCBjb250YWN0RXEgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOyAvLyBDb250YWN0IG5vcm1hbAoKICAgICAgeGoudnN1Yih4aSwgY29udGFjdEVxLm5pKTsKICAgICAgY29udGFjdEVxLm5pLm5vcm1hbGl6ZSgpOyAvLyBDb250YWN0IHBvaW50IGxvY2F0aW9ucwoKICAgICAgY29udGFjdEVxLnJpLmNvcHkoY29udGFjdEVxLm5pKTsKICAgICAgY29udGFjdEVxLnJqLmNvcHkoY29udGFjdEVxLm5pKTsKICAgICAgY29udGFjdEVxLnJpLnNjYWxlKHNpLnJhZGl1cywgY29udGFjdEVxLnJpKTsKICAgICAgY29udGFjdEVxLnJqLnNjYWxlKC1zai5yYWRpdXMsIGNvbnRhY3RFcS5yaik7CiAgICAgIGNvbnRhY3RFcS5yaS52YWRkKHhpLCBjb250YWN0RXEucmkpOwogICAgICBjb250YWN0RXEucmkudnN1YihiaS5wb3NpdGlvbiwgY29udGFjdEVxLnJpKTsKICAgICAgY29udGFjdEVxLnJqLnZhZGQoeGosIGNvbnRhY3RFcS5yaik7CiAgICAgIGNvbnRhY3RFcS5yai52c3ViKGJqLnBvc2l0aW9uLCBjb250YWN0RXEucmopOwogICAgICB0aGlzLnJlc3VsdC5wdXNoKGNvbnRhY3RFcSk7CiAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChjb250YWN0RXEsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgfQoKICAgIHNwaGVyZVBsYW5lKHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIC8vIFdlIHdpbGwgaGF2ZSBvbmUgY29udGFjdCBpbiB0aGlzIGNhc2UKICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7IC8vIENvbnRhY3Qgbm9ybWFsCgogICAgICByLm5pLnNldCgwLCAwLCAxKTsKICAgICAgcWoudm11bHQoci5uaSwgci5uaSk7CiAgICAgIHIubmkubmVnYXRlKHIubmkpOyAvLyBib2R5IGkgaXMgdGhlIHNwaGVyZSwgZmxpcCBub3JtYWwKCiAgICAgIHIubmkubm9ybWFsaXplKCk7IC8vIE5lZWRlZD8KICAgICAgLy8gVmVjdG9yIGZyb20gc3BoZXJlIGNlbnRlciB0byBjb250YWN0IHBvaW50CgogICAgICByLm5pLnNjYWxlKHNpLnJhZGl1cywgci5yaSk7IC8vIFByb2plY3QgZG93biBzcGhlcmUgb24gcGxhbmUKCiAgICAgIHhpLnZzdWIoeGosIHBvaW50X29uX3BsYW5lX3RvX3NwaGVyZSk7CiAgICAgIHIubmkuc2NhbGUoci5uaS5kb3QocG9pbnRfb25fcGxhbmVfdG9fc3BoZXJlKSwgcGxhbmVfdG9fc3BoZXJlX29ydGhvKTsKICAgICAgcG9pbnRfb25fcGxhbmVfdG9fc3BoZXJlLnZzdWIocGxhbmVfdG9fc3BoZXJlX29ydGhvLCByLnJqKTsgLy8gVGhlIHNwaGVyZSBwb3NpdGlvbiBwcm9qZWN0ZWQgdG8gcGxhbmUKCiAgICAgIGlmICgtcG9pbnRfb25fcGxhbmVfdG9fc3BoZXJlLmRvdChyLm5pKSA8PSBzaS5yYWRpdXMpIHsKICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gLy8gTWFrZSBpdCByZWxhdGl2ZSB0byB0aGUgYm9keQoKCiAgICAgICAgY29uc3QgcmkgPSByLnJpOwogICAgICAgIGNvbnN0IHJqID0gci5yajsKICAgICAgICByaS52YWRkKHhpLCByaSk7CiAgICAgICAgcmkudnN1YihiaS5wb3NpdGlvbiwgcmkpOwogICAgICAgIHJqLnZhZGQoeGosIHJqKTsKICAgICAgICByai52c3ViKGJqLnBvc2l0aW9uLCByaik7CiAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgIH0KICAgIH0KCiAgICBib3hCb3goc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2kubWF0ZXJpYWw7CiAgICAgIHNqLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5tYXRlcmlhbCA9IHNqLm1hdGVyaWFsOwogICAgICBzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24uY29sbGlzaW9uUmVzcG9uc2UgPSBzaS5jb2xsaXNpb25SZXNwb25zZTsKICAgICAgc2ouY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLmNvbGxpc2lvblJlc3BvbnNlID0gc2ouY29sbGlzaW9uUmVzcG9uc2U7CiAgICAgIHJldHVybiB0aGlzLmNvbnZleENvbnZleChzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24sIHNqLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgc2ksIHNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgc3BoZXJlQm94KHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIGNvbnN0IHYzcG9vbCA9IHRoaXMudjNwb29sOyAvLyB3ZSByZWZlciB0byB0aGUgYm94IGFzIGJvZHkgagoKICAgICAgY29uc3Qgc2lkZXMgPSBzcGhlcmVCb3hfc2lkZXM7CiAgICAgIHhpLnZzdWIoeGosIGJveF90b19zcGhlcmUpOwogICAgICBzai5nZXRTaWRlTm9ybWFscyhzaWRlcywgcWopOwogICAgICBjb25zdCBSID0gc2kucmFkaXVzOwoKICAgICAgbGV0IGZvdW5kID0gZmFsc2U7IC8vIFN0b3JlIHRoZSByZXN1bHRpbmcgc2lkZSBwZW5ldHJhdGlvbiBpbmZvCgogICAgICBjb25zdCBzaWRlX25zID0gc3BoZXJlQm94X3NpZGVfbnM7CiAgICAgIGNvbnN0IHNpZGVfbnMxID0gc3BoZXJlQm94X3NpZGVfbnMxOwogICAgICBjb25zdCBzaWRlX25zMiA9IHNwaGVyZUJveF9zaWRlX25zMjsKICAgICAgbGV0IHNpZGVfaCA9IG51bGw7CiAgICAgIGxldCBzaWRlX3BlbmV0cmF0aW9ucyA9IDA7CiAgICAgIGxldCBzaWRlX2RvdDEgPSAwOwogICAgICBsZXQgc2lkZV9kb3QyID0gMDsKICAgICAgbGV0IHNpZGVfZGlzdGFuY2UgPSBudWxsOwoKICAgICAgZm9yIChsZXQgaWR4ID0gMCwgbnNpZGVzID0gc2lkZXMubGVuZ3RoOyBpZHggIT09IG5zaWRlcyAmJiBmb3VuZCA9PT0gZmFsc2U7IGlkeCsrKSB7CiAgICAgICAgLy8gR2V0IHRoZSBwbGFuZSBzaWRlIG5vcm1hbCAobnMpCiAgICAgICAgY29uc3QgbnMgPSBzcGhlcmVCb3hfbnM7CiAgICAgICAgbnMuY29weShzaWRlc1tpZHhdKTsKICAgICAgICBjb25zdCBoID0gbnMubGVuZ3RoKCk7CiAgICAgICAgbnMubm9ybWFsaXplKCk7IC8vIFRoZSBub3JtYWwvZGlzdGFuY2UgZG90IHByb2R1Y3QgdGVsbHMgd2hpY2ggc2lkZSBvZiB0aGUgcGxhbmUgd2UgYXJlCgogICAgICAgIGNvbnN0IGRvdCA9IGJveF90b19zcGhlcmUuZG90KG5zKTsKCiAgICAgICAgaWYgKGRvdCA8IGggKyBSICYmIGRvdCA+IDApIHsKICAgICAgICAgIC8vIEludGVyc2VjdHMgcGxhbmUuIE5vdyBjaGVjayB0aGUgb3RoZXIgdHdvIGRpbWVuc2lvbnMKICAgICAgICAgIGNvbnN0IG5zMSA9IHNwaGVyZUJveF9uczE7CiAgICAgICAgICBjb25zdCBuczIgPSBzcGhlcmVCb3hfbnMyOwogICAgICAgICAgbnMxLmNvcHkoc2lkZXNbKGlkeCArIDEpICUgM10pOwogICAgICAgICAgbnMyLmNvcHkoc2lkZXNbKGlkeCArIDIpICUgM10pOwogICAgICAgICAgY29uc3QgaDEgPSBuczEubGVuZ3RoKCk7CiAgICAgICAgICBjb25zdCBoMiA9IG5zMi5sZW5ndGgoKTsKICAgICAgICAgIG5zMS5ub3JtYWxpemUoKTsKICAgICAgICAgIG5zMi5ub3JtYWxpemUoKTsKICAgICAgICAgIGNvbnN0IGRvdDEgPSBib3hfdG9fc3BoZXJlLmRvdChuczEpOwogICAgICAgICAgY29uc3QgZG90MiA9IGJveF90b19zcGhlcmUuZG90KG5zMik7CgogICAgICAgICAgaWYgKGRvdDEgPCBoMSAmJiBkb3QxID4gLWgxICYmIGRvdDIgPCBoMiAmJiBkb3QyID4gLWgyKSB7CiAgICAgICAgICAgIGNvbnN0IGRpc3QgPSBNYXRoLmFicyhkb3QgLSBoIC0gUik7CgogICAgICAgICAgICBpZiAoc2lkZV9kaXN0YW5jZSA9PT0gbnVsbCB8fCBkaXN0IDwgc2lkZV9kaXN0YW5jZSkgewogICAgICAgICAgICAgIHNpZGVfZGlzdGFuY2UgPSBkaXN0OwogICAgICAgICAgICAgIHNpZGVfZG90MSA9IGRvdDE7CiAgICAgICAgICAgICAgc2lkZV9kb3QyID0gZG90MjsKICAgICAgICAgICAgICBzaWRlX2ggPSBoOwogICAgICAgICAgICAgIHNpZGVfbnMuY29weShucyk7CiAgICAgICAgICAgICAgc2lkZV9uczEuY29weShuczEpOwogICAgICAgICAgICAgIHNpZGVfbnMyLmNvcHkobnMyKTsKICAgICAgICAgICAgICBzaWRlX3BlbmV0cmF0aW9ucysrOwoKICAgICAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHNpZGVfcGVuZXRyYXRpb25zKSB7CiAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgIHNpZGVfbnMuc2NhbGUoLVIsIHIucmkpOyAvLyBTcGhlcmUgcgoKICAgICAgICByLm5pLmNvcHkoc2lkZV9ucyk7CiAgICAgICAgci5uaS5uZWdhdGUoci5uaSk7IC8vIE5vcm1hbCBzaG91bGQgYmUgb3V0IG9mIHNwaGVyZQoKICAgICAgICBzaWRlX25zLnNjYWxlKHNpZGVfaCwgc2lkZV9ucyk7CiAgICAgICAgc2lkZV9uczEuc2NhbGUoc2lkZV9kb3QxLCBzaWRlX25zMSk7CiAgICAgICAgc2lkZV9ucy52YWRkKHNpZGVfbnMxLCBzaWRlX25zKTsKICAgICAgICBzaWRlX25zMi5zY2FsZShzaWRlX2RvdDIsIHNpZGVfbnMyKTsKICAgICAgICBzaWRlX25zLnZhZGQoc2lkZV9uczIsIHIucmopOyAvLyBNYWtlIHJlbGF0aXZlIHRvIGJvZGllcwoKICAgICAgICByLnJpLnZhZGQoeGksIHIucmkpOwogICAgICAgIHIucmkudnN1YihiaS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgci5yai52YWRkKHhqLCByLnJqKTsKICAgICAgICByLnJqLnZzdWIoYmoucG9zaXRpb24sIHIucmopOwogICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICB9IC8vIENoZWNrIGNvcm5lcnMKCgogICAgICBsZXQgcmogPSB2M3Bvb2wuZ2V0KCk7CiAgICAgIGNvbnN0IHNwaGVyZV90b19jb3JuZXIgPSBzcGhlcmVCb3hfc3BoZXJlX3RvX2Nvcm5lcjsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSAyICYmICFmb3VuZDsgaisrKSB7CiAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgIT09IDIgJiYgIWZvdW5kOyBrKyspIHsKICAgICAgICAgIGZvciAobGV0IGwgPSAwOyBsICE9PSAyICYmICFmb3VuZDsgbCsrKSB7CiAgICAgICAgICAgIHJqLnNldCgwLCAwLCAwKTsKCiAgICAgICAgICAgIGlmIChqKSB7CiAgICAgICAgICAgICAgcmoudmFkZChzaWRlc1swXSwgcmopOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHJqLnZzdWIoc2lkZXNbMF0sIHJqKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGspIHsKICAgICAgICAgICAgICByai52YWRkKHNpZGVzWzFdLCByaik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgcmoudnN1YihzaWRlc1sxXSwgcmopOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAobCkgewogICAgICAgICAgICAgIHJqLnZhZGQoc2lkZXNbMl0sIHJqKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByai52c3ViKHNpZGVzWzJdLCByaik7CiAgICAgICAgICAgIH0gLy8gV29ybGQgcG9zaXRpb24gb2YgY29ybmVyCgoKICAgICAgICAgICAgeGoudmFkZChyaiwgc3BoZXJlX3RvX2Nvcm5lcik7CiAgICAgICAgICAgIHNwaGVyZV90b19jb3JuZXIudnN1Yih4aSwgc3BoZXJlX3RvX2Nvcm5lcik7CgogICAgICAgICAgICBpZiAoc3BoZXJlX3RvX2Nvcm5lci5sZW5ndGhTcXVhcmVkKCkgPCBSICogUikgewogICAgICAgICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7CiAgICAgICAgICAgICAgci5yaS5jb3B5KHNwaGVyZV90b19jb3JuZXIpOwogICAgICAgICAgICAgIHIucmkubm9ybWFsaXplKCk7CiAgICAgICAgICAgICAgci5uaS5jb3B5KHIucmkpOwogICAgICAgICAgICAgIHIucmkuc2NhbGUoUiwgci5yaSk7CiAgICAgICAgICAgICAgci5yai5jb3B5KHJqKTsgLy8gTWFrZSByZWxhdGl2ZSB0byBib2RpZXMKCiAgICAgICAgICAgICAgci5yaS52YWRkKHhpLCByLnJpKTsKICAgICAgICAgICAgICByLnJpLnZzdWIoYmkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgICAgIHIucmoudmFkZCh4aiwgci5yaik7CiAgICAgICAgICAgICAgci5yai52c3ViKGJqLnBvc2l0aW9uLCByLnJqKTsKICAgICAgICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdjNwb29sLnJlbGVhc2UocmopOwogICAgICByaiA9IG51bGw7IC8vIENoZWNrIGVkZ2VzCgogICAgICBjb25zdCBlZGdlVGFuZ2VudCA9IHYzcG9vbC5nZXQoKTsKICAgICAgY29uc3QgZWRnZUNlbnRlciA9IHYzcG9vbC5nZXQoKTsKICAgICAgY29uc3QgciA9IHYzcG9vbC5nZXQoKTsgLy8gciA9IGVkZ2UgY2VudGVyIHRvIHNwaGVyZSBjZW50ZXIKCiAgICAgIGNvbnN0IG9ydGhvZ29uYWwgPSB2M3Bvb2wuZ2V0KCk7CiAgICAgIGNvbnN0IGRpc3QgPSB2M3Bvb2wuZ2V0KCk7CiAgICAgIGNvbnN0IE5zaWRlcyA9IHNpZGVzLmxlbmd0aDsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBOc2lkZXMgJiYgIWZvdW5kOyBqKyspIHsKICAgICAgICBmb3IgKGxldCBrID0gMDsgayAhPT0gTnNpZGVzICYmICFmb3VuZDsgaysrKSB7CiAgICAgICAgICBpZiAoaiAlIDMgIT09IGsgJSAzKSB7CiAgICAgICAgICAgIC8vIEdldCBlZGdlIHRhbmdlbnQKICAgICAgICAgICAgc2lkZXNba10uY3Jvc3Moc2lkZXNbal0sIGVkZ2VUYW5nZW50KTsKICAgICAgICAgICAgZWRnZVRhbmdlbnQubm9ybWFsaXplKCk7CiAgICAgICAgICAgIHNpZGVzW2pdLnZhZGQoc2lkZXNba10sIGVkZ2VDZW50ZXIpOwogICAgICAgICAgICByLmNvcHkoeGkpOwogICAgICAgICAgICByLnZzdWIoZWRnZUNlbnRlciwgcik7CiAgICAgICAgICAgIHIudnN1Yih4aiwgcik7CiAgICAgICAgICAgIGNvbnN0IG9ydGhvbm9ybSA9IHIuZG90KGVkZ2VUYW5nZW50KTsgLy8gZGlzdGFuY2UgZnJvbSBlZGdlIGNlbnRlciB0byBzcGhlcmUgY2VudGVyIGluIHRoZSB0YW5nZW50IGRpcmVjdGlvbgoKICAgICAgICAgICAgZWRnZVRhbmdlbnQuc2NhbGUob3J0aG9ub3JtLCBvcnRob2dvbmFsKTsgLy8gVmVjdG9yIGZyb20gZWRnZSBjZW50ZXIgdG8gc3BoZXJlIGNlbnRlciBpbiB0aGUgdGFuZ2VudCBkaXJlY3Rpb24KICAgICAgICAgICAgLy8gRmluZCB0aGUgdGhpcmQgc2lkZSBvcnRob2dvbmFsIHRvIHRoaXMgb25lCgogICAgICAgICAgICBsZXQgbCA9IDA7CgogICAgICAgICAgICB3aGlsZSAobCA9PT0gaiAlIDMgfHwgbCA9PT0gayAlIDMpIHsKICAgICAgICAgICAgICBsKys7CiAgICAgICAgICAgIH0gLy8gdmVjIGZyb20gZWRnZSBjZW50ZXIgdG8gc3BoZXJlIHByb2plY3RlZCB0byB0aGUgcGxhbmUgb3J0aG9nb25hbCB0byB0aGUgZWRnZSB0YW5nZW50CgoKICAgICAgICAgICAgZGlzdC5jb3B5KHhpKTsKICAgICAgICAgICAgZGlzdC52c3ViKG9ydGhvZ29uYWwsIGRpc3QpOwogICAgICAgICAgICBkaXN0LnZzdWIoZWRnZUNlbnRlciwgZGlzdCk7CiAgICAgICAgICAgIGRpc3QudnN1Yih4aiwgZGlzdCk7IC8vIERpc3RhbmNlcyBpbiB0YW5nZW50IGRpcmVjdGlvbiBhbmQgZGlzdGFuY2UgaW4gdGhlIHBsYW5lIG9ydGhvZ29uYWwgdG8gaXQKCiAgICAgICAgICAgIGNvbnN0IHRkaXN0ID0gTWF0aC5hYnMob3J0aG9ub3JtKTsKICAgICAgICAgICAgY29uc3QgbmRpc3QgPSBkaXN0Lmxlbmd0aCgpOwoKICAgICAgICAgICAgaWYgKHRkaXN0IDwgc2lkZXNbbF0ubGVuZ3RoKCkgJiYgbmRpc3QgPCBSKSB7CiAgICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgICBjb25zdCByZXMgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgICAgICAgIGVkZ2VDZW50ZXIudmFkZChvcnRob2dvbmFsLCByZXMucmopOyAvLyBib3ggcmoKCiAgICAgICAgICAgICAgcmVzLnJqLmNvcHkocmVzLnJqKTsKICAgICAgICAgICAgICBkaXN0Lm5lZ2F0ZShyZXMubmkpOwogICAgICAgICAgICAgIHJlcy5uaS5ub3JtYWxpemUoKTsKICAgICAgICAgICAgICByZXMucmkuY29weShyZXMucmopOwogICAgICAgICAgICAgIHJlcy5yaS52YWRkKHhqLCByZXMucmkpOwogICAgICAgICAgICAgIHJlcy5yaS52c3ViKHhpLCByZXMucmkpOwogICAgICAgICAgICAgIHJlcy5yaS5ub3JtYWxpemUoKTsKICAgICAgICAgICAgICByZXMucmkuc2NhbGUoUiwgcmVzLnJpKTsgLy8gTWFrZSByZWxhdGl2ZSB0byBib2RpZXMKCiAgICAgICAgICAgICAgcmVzLnJpLnZhZGQoeGksIHJlcy5yaSk7CiAgICAgICAgICAgICAgcmVzLnJpLnZzdWIoYmkucG9zaXRpb24sIHJlcy5yaSk7CiAgICAgICAgICAgICAgcmVzLnJqLnZhZGQoeGosIHJlcy5yaik7CiAgICAgICAgICAgICAgcmVzLnJqLnZzdWIoYmoucG9zaXRpb24sIHJlcy5yaik7CiAgICAgICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyZXMpOwogICAgICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyZXMsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB2M3Bvb2wucmVsZWFzZShlZGdlVGFuZ2VudCwgZWRnZUNlbnRlciwgciwgb3J0aG9nb25hbCwgZGlzdCk7CiAgICB9CgogICAgcGxhbmVCb3goc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgc2ouY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2oubWF0ZXJpYWw7CiAgICAgIHNqLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5jb2xsaXNpb25SZXNwb25zZSA9IHNqLmNvbGxpc2lvblJlc3BvbnNlOwogICAgICBzai5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24uaWQgPSBzai5pZDsKICAgICAgcmV0dXJuIHRoaXMucGxhbmVDb252ZXgoc2ksIHNqLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgc2ksIHNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgY29udmV4Q29udmV4KHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0LCBmYWNlTGlzdEEsIGZhY2VMaXN0QikgewogICAgICBjb25zdCBzZXBBeGlzID0gY29udmV4Q29udmV4X3NlcEF4aXM7CgogICAgICBpZiAoeGkuZGlzdGFuY2VUbyh4aikgPiBzaS5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIHNqLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoc2kuZmluZFNlcGFyYXRpbmdBeGlzKHNqLCB4aSwgcWksIHhqLCBxaiwgc2VwQXhpcywgZmFjZUxpc3RBLCBmYWNlTGlzdEIpKSB7CiAgICAgICAgY29uc3QgcmVzID0gW107CiAgICAgICAgY29uc3QgcSA9IGNvbnZleENvbnZleF9xOwogICAgICAgIHNpLmNsaXBBZ2FpbnN0SHVsbCh4aSwgcWksIHNqLCB4aiwgcWosIHNlcEF4aXMsIC0xMDAsIDEwMCwgcmVzKTsKICAgICAgICBsZXQgbnVtQ29udGFjdHMgPSAwOwoKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiAhPT0gcmVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7CiAgICAgICAgICBjb25zdCByaSA9IHIucmk7CiAgICAgICAgICBjb25zdCByaiA9IHIucmo7CiAgICAgICAgICBzZXBBeGlzLm5lZ2F0ZShyLm5pKTsKICAgICAgICAgIHJlc1tqXS5ub3JtYWwubmVnYXRlKHEpOwogICAgICAgICAgcS5zY2FsZShyZXNbal0uZGVwdGgsIHEpOwogICAgICAgICAgcmVzW2pdLnBvaW50LnZhZGQocSwgcmkpOwogICAgICAgICAgcmouY29weShyZXNbal0ucG9pbnQpOyAvLyBDb250YWN0IHBvaW50cyBhcmUgaW4gd29ybGQgY29vcmRpbmF0ZXMuIFRyYW5zZm9ybSBiYWNrIHRvIHJlbGF0aXZlCgogICAgICAgICAgcmkudnN1Yih4aSwgcmkpOwogICAgICAgICAgcmoudnN1Yih4aiwgcmopOyAvLyBNYWtlIHJlbGF0aXZlIHRvIGJvZGllcwoKICAgICAgICAgIHJpLnZhZGQoeGksIHJpKTsKICAgICAgICAgIHJpLnZzdWIoYmkucG9zaXRpb24sIHJpKTsKICAgICAgICAgIHJqLnZhZGQoeGosIHJqKTsKICAgICAgICAgIHJqLnZzdWIoYmoucG9zaXRpb24sIHJqKTsKICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgICBudW1Db250YWN0cysrOwoKICAgICAgICAgIGlmICghdGhpcy5lbmFibGVGcmljdGlvblJlZHVjdGlvbikgewogICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5lbmFibGVGcmljdGlvblJlZHVjdGlvbiAmJiBudW1Db250YWN0cykgewogICAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkZyb21BdmVyYWdlKG51bUNvbnRhY3RzKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBzcGhlcmVDb252ZXgoc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgY29uc3QgdjNwb29sID0gdGhpcy52M3Bvb2w7CiAgICAgIHhpLnZzdWIoeGosIGNvbnZleF90b19zcGhlcmUpOwogICAgICBjb25zdCBub3JtYWxzID0gc2ouZmFjZU5vcm1hbHM7CiAgICAgIGNvbnN0IGZhY2VzID0gc2ouZmFjZXM7CiAgICAgIGNvbnN0IHZlcnRzID0gc2oudmVydGljZXM7CiAgICAgIGNvbnN0IFIgPSBzaS5yYWRpdXM7CiAgICAgIC8vICAgICByZXR1cm47CiAgICAgIC8vIH0KCiAgICAgIGxldCBmb3VuZCA9IGZhbHNlOyAvLyBDaGVjayBjb3JuZXJzCgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCB2ID0gdmVydHNbaV07IC8vIFdvcmxkIHBvc2l0aW9uIG9mIGNvcm5lcgoKICAgICAgICBjb25zdCB3b3JsZENvcm5lciA9IHNwaGVyZUNvbnZleF93b3JsZENvcm5lcjsKICAgICAgICBxai52bXVsdCh2LCB3b3JsZENvcm5lcik7CiAgICAgICAgeGoudmFkZCh3b3JsZENvcm5lciwgd29ybGRDb3JuZXIpOwogICAgICAgIGNvbnN0IHNwaGVyZV90b19jb3JuZXIgPSBzcGhlcmVDb252ZXhfc3BoZXJlVG9Db3JuZXI7CiAgICAgICAgd29ybGRDb3JuZXIudnN1Yih4aSwgc3BoZXJlX3RvX2Nvcm5lcik7CgogICAgICAgIGlmIChzcGhlcmVfdG9fY29ybmVyLmxlbmd0aFNxdWFyZWQoKSA8IFIgKiBSKSB7CiAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7CiAgICAgICAgICByLnJpLmNvcHkoc3BoZXJlX3RvX2Nvcm5lcik7CiAgICAgICAgICByLnJpLm5vcm1hbGl6ZSgpOwogICAgICAgICAgci5uaS5jb3B5KHIucmkpOwogICAgICAgICAgci5yaS5zY2FsZShSLCByLnJpKTsKICAgICAgICAgIHdvcmxkQ29ybmVyLnZzdWIoeGosIHIucmopOyAvLyBTaG91bGQgYmUgcmVsYXRpdmUgdG8gdGhlIGJvZHkuCgogICAgICAgICAgci5yaS52YWRkKHhpLCByLnJpKTsKICAgICAgICAgIHIucmkudnN1YihiaS5wb3NpdGlvbiwgci5yaSk7IC8vIFNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYm9keS4KCiAgICAgICAgICByLnJqLnZhZGQoeGosIHIucmopOwogICAgICAgICAgci5yai52c3ViKGJqLnBvc2l0aW9uLCByLnJqKTsKICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9IC8vIENoZWNrIHNpZGUgKHBsYW5lKSBpbnRlcnNlY3Rpb25zCgoKICAgICAgZm9yIChsZXQgaSA9IDAsIG5mYWNlcyA9IGZhY2VzLmxlbmd0aDsgaSAhPT0gbmZhY2VzICYmIGZvdW5kID09PSBmYWxzZTsgaSsrKSB7CiAgICAgICAgY29uc3Qgbm9ybWFsID0gbm9ybWFsc1tpXTsKICAgICAgICBjb25zdCBmYWNlID0gZmFjZXNbaV07IC8vIEdldCB3b3JsZC10cmFuc2Zvcm1lZCBub3JtYWwgb2YgdGhlIGZhY2UKCiAgICAgICAgY29uc3Qgd29ybGROb3JtYWwgPSBzcGhlcmVDb252ZXhfd29ybGROb3JtYWw7CiAgICAgICAgcWoudm11bHQobm9ybWFsLCB3b3JsZE5vcm1hbCk7IC8vIEdldCBhIHdvcmxkIHZlcnRleCBmcm9tIHRoZSBmYWNlCgogICAgICAgIGNvbnN0IHdvcmxkUG9pbnQgPSBzcGhlcmVDb252ZXhfd29ybGRQb2ludDsKICAgICAgICBxai52bXVsdCh2ZXJ0c1tmYWNlWzBdXSwgd29ybGRQb2ludCk7CiAgICAgICAgd29ybGRQb2ludC52YWRkKHhqLCB3b3JsZFBvaW50KTsgLy8gR2V0IGEgcG9pbnQgb24gdGhlIHNwaGVyZSwgY2xvc2VzdCB0byB0aGUgZmFjZSBub3JtYWwKCiAgICAgICAgY29uc3Qgd29ybGRTcGhlcmVQb2ludENsb3Nlc3RUb1BsYW5lID0gc3BoZXJlQ29udmV4X3dvcmxkU3BoZXJlUG9pbnRDbG9zZXN0VG9QbGFuZTsKICAgICAgICB3b3JsZE5vcm1hbC5zY2FsZSgtUiwgd29ybGRTcGhlcmVQb2ludENsb3Nlc3RUb1BsYW5lKTsKICAgICAgICB4aS52YWRkKHdvcmxkU3BoZXJlUG9pbnRDbG9zZXN0VG9QbGFuZSwgd29ybGRTcGhlcmVQb2ludENsb3Nlc3RUb1BsYW5lKTsgLy8gVmVjdG9yIGZyb20gYSBmYWNlIHBvaW50IHRvIHRoZSBjbG9zZXN0IHBvaW50IG9uIHRoZSBzcGhlcmUKCiAgICAgICAgY29uc3QgcGVuZXRyYXRpb25WZWMgPSBzcGhlcmVDb252ZXhfcGVuZXRyYXRpb25WZWM7CiAgICAgICAgd29ybGRTcGhlcmVQb2ludENsb3Nlc3RUb1BsYW5lLnZzdWIod29ybGRQb2ludCwgcGVuZXRyYXRpb25WZWMpOyAvLyBUaGUgcGVuZXRyYXRpb24uIE5lZ2F0aXZlIHZhbHVlIG1lYW5zIG92ZXJsYXAuCgogICAgICAgIGNvbnN0IHBlbmV0cmF0aW9uID0gcGVuZXRyYXRpb25WZWMuZG90KHdvcmxkTm9ybWFsKTsKICAgICAgICBjb25zdCB3b3JsZFBvaW50VG9TcGhlcmUgPSBzcGhlcmVDb252ZXhfc3BoZXJlVG9Xb3JsZFBvaW50OwogICAgICAgIHhpLnZzdWIod29ybGRQb2ludCwgd29ybGRQb2ludFRvU3BoZXJlKTsKCiAgICAgICAgaWYgKHBlbmV0cmF0aW9uIDwgMCAmJiB3b3JsZFBvaW50VG9TcGhlcmUuZG90KHdvcmxkTm9ybWFsKSA+IDApIHsKICAgICAgICAgIC8vIEludGVyc2VjdHMgcGxhbmUuIE5vdyBjaGVjayBpZiB0aGUgc3BoZXJlIGlzIGluc2lkZSB0aGUgZmFjZSBwb2x5Z29uCiAgICAgICAgICBjb25zdCBmYWNlVmVydHMgPSBbXTsgLy8gRmFjZSB2ZXJ0aWNlcywgaW4gd29ybGQgY29vcmRzCgogICAgICAgICAgZm9yIChsZXQgaiA9IDAsIE52ZXJ0cyA9IGZhY2UubGVuZ3RoOyBqICE9PSBOdmVydHM7IGorKykgewogICAgICAgICAgICBjb25zdCB3b3JsZFZlcnRleCA9IHYzcG9vbC5nZXQoKTsKICAgICAgICAgICAgcWoudm11bHQodmVydHNbZmFjZVtqXV0sIHdvcmxkVmVydGV4KTsKICAgICAgICAgICAgeGoudmFkZCh3b3JsZFZlcnRleCwgd29ybGRWZXJ0ZXgpOwogICAgICAgICAgICBmYWNlVmVydHMucHVzaCh3b3JsZFZlcnRleCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHBvaW50SW5Qb2x5Z29uKGZhY2VWZXJ0cywgd29ybGROb3JtYWwsIHhpKSkgewogICAgICAgICAgICAvLyBJcyB0aGUgc3BoZXJlIGNlbnRlciBpbiB0aGUgZmFjZSBwb2x5Z29uPwogICAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsKICAgICAgICAgICAgd29ybGROb3JtYWwuc2NhbGUoLVIsIHIucmkpOyAvLyBDb250YWN0IG9mZnNldCwgZnJvbSBzcGhlcmUgY2VudGVyIHRvIGNvbnRhY3QKCiAgICAgICAgICAgIHdvcmxkTm9ybWFsLm5lZ2F0ZShyLm5pKTsgLy8gTm9ybWFsIHBvaW50aW5nIG91dCBvZiBzcGhlcmUKCiAgICAgICAgICAgIGNvbnN0IHBlbmV0cmF0aW9uVmVjMiA9IHYzcG9vbC5nZXQoKTsKICAgICAgICAgICAgd29ybGROb3JtYWwuc2NhbGUoLXBlbmV0cmF0aW9uLCBwZW5ldHJhdGlvblZlYzIpOwogICAgICAgICAgICBjb25zdCBwZW5ldHJhdGlvblNwaGVyZVBvaW50ID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICB3b3JsZE5vcm1hbC5zY2FsZSgtUiwgcGVuZXRyYXRpb25TcGhlcmVQb2ludCk7IC8veGkudnN1Yih4aikudmFkZChwZW5ldHJhdGlvblNwaGVyZVBvaW50KS52YWRkKHBlbmV0cmF0aW9uVmVjMiAsIHIucmopOwoKICAgICAgICAgICAgeGkudnN1Yih4aiwgci5yaik7CiAgICAgICAgICAgIHIucmoudmFkZChwZW5ldHJhdGlvblNwaGVyZVBvaW50LCByLnJqKTsKICAgICAgICAgICAgci5yai52YWRkKHBlbmV0cmF0aW9uVmVjMiwgci5yaik7IC8vIFNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYm9keS4KCiAgICAgICAgICAgIHIucmoudmFkZCh4aiwgci5yaik7CiAgICAgICAgICAgIHIucmoudnN1Yihiai5wb3NpdGlvbiwgci5yaik7IC8vIFNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYm9keS4KCiAgICAgICAgICAgIHIucmkudmFkZCh4aSwgci5yaSk7CiAgICAgICAgICAgIHIucmkudnN1YihiaS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHBlbmV0cmF0aW9uVmVjMik7CiAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHBlbmV0cmF0aW9uU3BoZXJlUG9pbnQpOwogICAgICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7IC8vIFJlbGVhc2Ugd29ybGQgdmVydGljZXMKCiAgICAgICAgICAgIGZvciAobGV0IGogPSAwLCBOZmFjZXZlcnRzID0gZmFjZVZlcnRzLmxlbmd0aDsgaiAhPT0gTmZhY2V2ZXJ0czsgaisrKSB7CiAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UoZmFjZVZlcnRzW2pdKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuOyAvLyBXZSBvbmx5IGV4cGVjdCAqb25lKiBmYWNlIGNvbnRhY3QKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIEVkZ2U/CiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBmYWNlLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgLy8gR2V0IHR3byB3b3JsZCB0cmFuc2Zvcm1lZCB2ZXJ0aWNlcwogICAgICAgICAgICAgIGNvbnN0IHYxID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICAgIGNvbnN0IHYyID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICAgIHFqLnZtdWx0KHZlcnRzW2ZhY2VbKGogKyAxKSAlIGZhY2UubGVuZ3RoXV0sIHYxKTsKICAgICAgICAgICAgICBxai52bXVsdCh2ZXJ0c1tmYWNlWyhqICsgMikgJSBmYWNlLmxlbmd0aF1dLCB2Mik7CiAgICAgICAgICAgICAgeGoudmFkZCh2MSwgdjEpOwogICAgICAgICAgICAgIHhqLnZhZGQodjIsIHYyKTsgLy8gQ29uc3RydWN0IGVkZ2UgdmVjdG9yCgogICAgICAgICAgICAgIGNvbnN0IGVkZ2UgPSBzcGhlcmVDb252ZXhfZWRnZTsKICAgICAgICAgICAgICB2Mi52c3ViKHYxLCBlZGdlKTsgLy8gQ29uc3RydWN0IHRoZSBzYW1lIHZlY3RvciwgYnV0IG5vcm1hbGl6ZWQKCiAgICAgICAgICAgICAgY29uc3QgZWRnZVVuaXQgPSBzcGhlcmVDb252ZXhfZWRnZVVuaXQ7CiAgICAgICAgICAgICAgZWRnZS51bml0KGVkZ2VVbml0KTsgLy8gcCBpcyB4aSBwcm9qZWN0ZWQgb250byB0aGUgZWRnZQoKICAgICAgICAgICAgICBjb25zdCBwID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICAgIGNvbnN0IHYxX3RvX3hpID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICAgIHhpLnZzdWIodjEsIHYxX3RvX3hpKTsKICAgICAgICAgICAgICBjb25zdCBkb3QgPSB2MV90b194aS5kb3QoZWRnZVVuaXQpOwogICAgICAgICAgICAgIGVkZ2VVbml0LnNjYWxlKGRvdCwgcCk7CiAgICAgICAgICAgICAgcC52YWRkKHYxLCBwKTsgLy8gQ29tcHV0ZSBhIHZlY3RvciBmcm9tIHAgdG8gdGhlIGNlbnRlciBvZiB0aGUgc3BoZXJlCgogICAgICAgICAgICAgIGNvbnN0IHhpX3RvX3AgPSB2M3Bvb2wuZ2V0KCk7CiAgICAgICAgICAgICAgcC52c3ViKHhpLCB4aV90b19wKTsgLy8gQ29sbGlzaW9uIGlmIHRoZSBlZGdlLXNwaGVyZSBkaXN0YW5jZSBpcyBsZXNzIHRoYW4gdGhlIHJhZGl1cwogICAgICAgICAgICAgIC8vIEFORCBpZiBwIGlzIGluIGJldHdlZW4gdjEgYW5kIHYyCgogICAgICAgICAgICAgIGlmIChkb3QgPiAwICYmIGRvdCAqIGRvdCA8IGVkZ2UubGVuZ3RoU3F1YXJlZCgpICYmIHhpX3RvX3AubGVuZ3RoU3F1YXJlZCgpIDwgUiAqIFIpIHsKICAgICAgICAgICAgICAgIC8vIENvbGxpc2lvbiBpZiB0aGUgZWRnZS1zcGhlcmUgZGlzdGFuY2UgaXMgbGVzcyB0aGFuIHRoZSByYWRpdXMKICAgICAgICAgICAgICAgIC8vIEVkZ2UgY29udGFjdCEKICAgICAgICAgICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsKICAgICAgICAgICAgICAgIHAudnN1Yih4aiwgci5yaik7CiAgICAgICAgICAgICAgICBwLnZzdWIoeGksIHIubmkpOwogICAgICAgICAgICAgICAgci5uaS5ub3JtYWxpemUoKTsKICAgICAgICAgICAgICAgIHIubmkuc2NhbGUoUiwgci5yaSk7IC8vIFNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYm9keS4KCiAgICAgICAgICAgICAgICByLnJqLnZhZGQoeGosIHIucmopOwogICAgICAgICAgICAgICAgci5yai52c3ViKGJqLnBvc2l0aW9uLCByLnJqKTsgLy8gU2hvdWxkIGJlIHJlbGF0aXZlIHRvIHRoZSBib2R5LgoKICAgICAgICAgICAgICAgIHIucmkudmFkZCh4aSwgci5yaSk7CiAgICAgICAgICAgICAgICByLnJpLnZzdWIoYmkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsgLy8gUmVsZWFzZSB3b3JsZCB2ZXJ0aWNlcwoKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwLCBOZmFjZXZlcnRzID0gZmFjZVZlcnRzLmxlbmd0aDsgaiAhPT0gTmZhY2V2ZXJ0czsgaisrKSB7CiAgICAgICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKGZhY2VWZXJ0c1tqXSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UodjEpOwogICAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UodjIpOwogICAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UocCk7CiAgICAgICAgICAgICAgICB2M3Bvb2wucmVsZWFzZSh4aV90b19wKTsKICAgICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHYxX3RvX3hpKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHYxKTsKICAgICAgICAgICAgICB2M3Bvb2wucmVsZWFzZSh2Mik7CiAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UocCk7CiAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UoeGlfdG9fcCk7CiAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UodjFfdG9feGkpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IC8vIFJlbGVhc2Ugd29ybGQgdmVydGljZXMKCgogICAgICAgICAgZm9yIChsZXQgaiA9IDAsIE5mYWNldmVydHMgPSBmYWNlVmVydHMubGVuZ3RoOyBqICE9PSBOZmFjZXZlcnRzOyBqKyspIHsKICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UoZmFjZVZlcnRzW2pdKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBwbGFuZUNvbnZleChwbGFuZVNoYXBlLCBjb252ZXhTaGFwZSwgcGxhbmVQb3NpdGlvbiwgY29udmV4UG9zaXRpb24sIHBsYW5lUXVhdCwgY29udmV4UXVhdCwgcGxhbmVCb2R5LCBjb252ZXhCb2R5LCBzaSwgc2osIGp1c3RUZXN0KSB7CiAgICAgIC8vIFNpbXBseSByZXR1cm4gdGhlIHBvaW50cyBiZWhpbmQgdGhlIHBsYW5lLgogICAgICBjb25zdCB3b3JsZFZlcnRleCA9IHBsYW5lQ29udmV4X3Y7CiAgICAgIGNvbnN0IHdvcmxkTm9ybWFsID0gcGxhbmVDb252ZXhfbm9ybWFsOwogICAgICB3b3JsZE5vcm1hbC5zZXQoMCwgMCwgMSk7CiAgICAgIHBsYW5lUXVhdC52bXVsdCh3b3JsZE5vcm1hbCwgd29ybGROb3JtYWwpOyAvLyBUdXJuIG5vcm1hbCBhY2NvcmRpbmcgdG8gcGxhbmUgb3JpZW50YXRpb24KCiAgICAgIGxldCBudW1Db250YWN0cyA9IDA7CiAgICAgIGNvbnN0IHJlbHBvcyA9IHBsYW5lQ29udmV4X3JlbHBvczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBjb252ZXhTaGFwZS52ZXJ0aWNlcy5sZW5ndGg7IGkrKykgewogICAgICAgIC8vIEdldCB3b3JsZCBjb252ZXggdmVydGV4CiAgICAgICAgd29ybGRWZXJ0ZXguY29weShjb252ZXhTaGFwZS52ZXJ0aWNlc1tpXSk7CiAgICAgICAgY29udmV4UXVhdC52bXVsdCh3b3JsZFZlcnRleCwgd29ybGRWZXJ0ZXgpOwogICAgICAgIGNvbnZleFBvc2l0aW9uLnZhZGQod29ybGRWZXJ0ZXgsIHdvcmxkVmVydGV4KTsKICAgICAgICB3b3JsZFZlcnRleC52c3ViKHBsYW5lUG9zaXRpb24sIHJlbHBvcyk7CiAgICAgICAgY29uc3QgZG90ID0gd29ybGROb3JtYWwuZG90KHJlbHBvcyk7CgogICAgICAgIGlmIChkb3QgPD0gMC4wKSB7CiAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKHBsYW5lQm9keSwgY29udmV4Qm9keSwgcGxhbmVTaGFwZSwgY29udmV4U2hhcGUsIHNpLCBzaik7IC8vIEdldCB2ZXJ0ZXggcG9zaXRpb24gcHJvamVjdGVkIG9uIHBsYW5lCgogICAgICAgICAgY29uc3QgcHJvamVjdGVkID0gcGxhbmVDb252ZXhfcHJvamVjdGVkOwogICAgICAgICAgd29ybGROb3JtYWwuc2NhbGUod29ybGROb3JtYWwuZG90KHJlbHBvcyksIHByb2plY3RlZCk7CiAgICAgICAgICB3b3JsZFZlcnRleC52c3ViKHByb2plY3RlZCwgcHJvamVjdGVkKTsKICAgICAgICAgIHByb2plY3RlZC52c3ViKHBsYW5lUG9zaXRpb24sIHIucmkpOyAvLyBGcm9tIHBsYW5lIHRvIHZlcnRleCBwcm9qZWN0ZWQgb24gcGxhbmUKCiAgICAgICAgICByLm5pLmNvcHkod29ybGROb3JtYWwpOyAvLyBDb250YWN0IG5vcm1hbCBpcyB0aGUgcGxhbmUgbm9ybWFsIG91dCBmcm9tIHBsYW5lCiAgICAgICAgICAvLyByaiBpcyBub3cganVzdCB0aGUgdmVjdG9yIGZyb20gdGhlIGNvbnZleCBjZW50ZXIgdG8gdGhlIHZlcnRleAoKICAgICAgICAgIHdvcmxkVmVydGV4LnZzdWIoY29udmV4UG9zaXRpb24sIHIucmopOyAvLyBNYWtlIGl0IHJlbGF0aXZlIHRvIHRoZSBib2R5CgogICAgICAgICAgci5yaS52YWRkKHBsYW5lUG9zaXRpb24sIHIucmkpOwogICAgICAgICAgci5yaS52c3ViKHBsYW5lQm9keS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICByLnJqLnZhZGQoY29udmV4UG9zaXRpb24sIHIucmopOwogICAgICAgICAgci5yai52c3ViKGNvbnZleEJvZHkucG9zaXRpb24sIHIucmopOwogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIG51bUNvbnRhY3RzKys7CgogICAgICAgICAgaWYgKCF0aGlzLmVuYWJsZUZyaWN0aW9uUmVkdWN0aW9uKSB7CiAgICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmVuYWJsZUZyaWN0aW9uUmVkdWN0aW9uICYmIG51bUNvbnRhY3RzKSB7CiAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkZyb21BdmVyYWdlKG51bUNvbnRhY3RzKTsKICAgICAgfQogICAgfQoKICAgIGJveENvbnZleChzaSwgc2osIHhpLCB4aiwgcWksIHFqLCBiaSwgYmosIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24ubWF0ZXJpYWwgPSBzaS5tYXRlcmlhbDsKICAgICAgc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLmNvbGxpc2lvblJlc3BvbnNlID0gc2kuY29sbGlzaW9uUmVzcG9uc2U7CiAgICAgIHJldHVybiB0aGlzLmNvbnZleENvbnZleChzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24sIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCBzaSwgc2osIGp1c3RUZXN0KTsKICAgIH0KCiAgICBzcGhlcmVIZWlnaHRmaWVsZChzcGhlcmVTaGFwZSwgaGZTaGFwZSwgc3BoZXJlUG9zLCBoZlBvcywgc3BoZXJlUXVhdCwgaGZRdWF0LCBzcGhlcmVCb2R5LCBoZkJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBjb25zdCBkYXRhID0gaGZTaGFwZS5kYXRhOwogICAgICBjb25zdCByYWRpdXMgPSBzcGhlcmVTaGFwZS5yYWRpdXM7CiAgICAgIGNvbnN0IHcgPSBoZlNoYXBlLmVsZW1lbnRTaXplOwogICAgICBjb25zdCB3b3JsZFBpbGxhck9mZnNldCA9IHNwaGVyZUhlaWdodGZpZWxkX3RtcDI7IC8vIEdldCBzcGhlcmUgcG9zaXRpb24gdG8gaGVpZ2h0ZmllbGQgbG9jYWwhCgogICAgICBjb25zdCBsb2NhbFNwaGVyZVBvcyA9IHNwaGVyZUhlaWdodGZpZWxkX3RtcDE7CiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZShoZlBvcywgaGZRdWF0LCBzcGhlcmVQb3MsIGxvY2FsU3BoZXJlUG9zKTsgLy8gR2V0IHRoZSBpbmRleCBvZiB0aGUgZGF0YSBwb2ludHMgdG8gdGVzdCBhZ2FpbnN0CgogICAgICBsZXQgaU1pblggPSBNYXRoLmZsb29yKChsb2NhbFNwaGVyZVBvcy54IC0gcmFkaXVzKSAvIHcpIC0gMTsKICAgICAgbGV0IGlNYXhYID0gTWF0aC5jZWlsKChsb2NhbFNwaGVyZVBvcy54ICsgcmFkaXVzKSAvIHcpICsgMTsKICAgICAgbGV0IGlNaW5ZID0gTWF0aC5mbG9vcigobG9jYWxTcGhlcmVQb3MueSAtIHJhZGl1cykgLyB3KSAtIDE7CiAgICAgIGxldCBpTWF4WSA9IE1hdGguY2VpbCgobG9jYWxTcGhlcmVQb3MueSArIHJhZGl1cykgLyB3KSArIDE7IC8vIEJhaWwgb3V0IGlmIHdlIGFyZSBvdXQgb2YgdGhlIHRlcnJhaW4KCiAgICAgIGlmIChpTWF4WCA8IDAgfHwgaU1heFkgPCAwIHx8IGlNaW5YID4gZGF0YS5sZW5ndGggfHwgaU1pblkgPiBkYXRhWzBdLmxlbmd0aCkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBDbGFtcCBpbmRleCB0byBlZGdlcwoKCiAgICAgIGlmIChpTWluWCA8IDApIHsKICAgICAgICBpTWluWCA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWF4WCA8IDApIHsKICAgICAgICBpTWF4WCA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWluWSA8IDApIHsKICAgICAgICBpTWluWSA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWF4WSA8IDApIHsKICAgICAgICBpTWF4WSA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWluWCA+PSBkYXRhLmxlbmd0aCkgewogICAgICAgIGlNaW5YID0gZGF0YS5sZW5ndGggLSAxOwogICAgICB9CgogICAgICBpZiAoaU1heFggPj0gZGF0YS5sZW5ndGgpIHsKICAgICAgICBpTWF4WCA9IGRhdGEubGVuZ3RoIC0gMTsKICAgICAgfQoKICAgICAgaWYgKGlNYXhZID49IGRhdGFbMF0ubGVuZ3RoKSB7CiAgICAgICAgaU1heFkgPSBkYXRhWzBdLmxlbmd0aCAtIDE7CiAgICAgIH0KCiAgICAgIGlmIChpTWluWSA+PSBkYXRhWzBdLmxlbmd0aCkgewogICAgICAgIGlNaW5ZID0gZGF0YVswXS5sZW5ndGggLSAxOwogICAgICB9CgogICAgICBjb25zdCBtaW5NYXggPSBbXTsKICAgICAgaGZTaGFwZS5nZXRSZWN0TWluTWF4KGlNaW5YLCBpTWluWSwgaU1heFgsIGlNYXhZLCBtaW5NYXgpOwogICAgICBjb25zdCBtaW4gPSBtaW5NYXhbMF07CiAgICAgIGNvbnN0IG1heCA9IG1pbk1heFsxXTsgLy8gQmFpbCBvdXQgaWYgd2UgY2FuJ3QgdG91Y2ggdGhlIGJvdW5kaW5nIGhlaWdodCBib3gKCiAgICAgIGlmIChsb2NhbFNwaGVyZVBvcy56IC0gcmFkaXVzID4gbWF4IHx8IGxvY2FsU3BoZXJlUG9zLnogKyByYWRpdXMgPCBtaW4pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMucmVzdWx0OwoKICAgICAgZm9yIChsZXQgaSA9IGlNaW5YOyBpIDwgaU1heFg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSBpTWluWTsgaiA8IGlNYXhZOyBqKyspIHsKICAgICAgICAgIGNvbnN0IG51bUNvbnRhY3RzQmVmb3JlID0gcmVzdWx0Lmxlbmd0aDsKICAgICAgICAgIGxldCBpbnRlcnNlY3RpbmcgPSBmYWxzZTsgLy8gTG93ZXIgdHJpYW5nbGUKCiAgICAgICAgICBoZlNoYXBlLmdldENvbnZleFRyaWFuZ2xlUGlsbGFyKGksIGosIGZhbHNlKTsKICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZShoZlBvcywgaGZRdWF0LCBoZlNoYXBlLnBpbGxhck9mZnNldCwgd29ybGRQaWxsYXJPZmZzZXQpOwoKICAgICAgICAgIGlmIChzcGhlcmVQb3MuZGlzdGFuY2VUbyh3b3JsZFBpbGxhck9mZnNldCkgPCBoZlNoYXBlLnBpbGxhckNvbnZleC5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIHNwaGVyZVNoYXBlLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgICAgIGludGVyc2VjdGluZyA9IHRoaXMuc3BoZXJlQ29udmV4KHNwaGVyZVNoYXBlLCBoZlNoYXBlLnBpbGxhckNvbnZleCwgc3BoZXJlUG9zLCB3b3JsZFBpbGxhck9mZnNldCwgc3BoZXJlUXVhdCwgaGZRdWF0LCBzcGhlcmVCb2R5LCBoZkJvZHksIHNwaGVyZVNoYXBlLCBoZlNoYXBlLCBqdXN0VGVzdCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGp1c3RUZXN0ICYmIGludGVyc2VjdGluZykgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0gLy8gVXBwZXIgdHJpYW5nbGUKCgogICAgICAgICAgaGZTaGFwZS5nZXRDb252ZXhUcmlhbmdsZVBpbGxhcihpLCBqLCB0cnVlKTsKICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZShoZlBvcywgaGZRdWF0LCBoZlNoYXBlLnBpbGxhck9mZnNldCwgd29ybGRQaWxsYXJPZmZzZXQpOwoKICAgICAgICAgIGlmIChzcGhlcmVQb3MuZGlzdGFuY2VUbyh3b3JsZFBpbGxhck9mZnNldCkgPCBoZlNoYXBlLnBpbGxhckNvbnZleC5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIHNwaGVyZVNoYXBlLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgICAgIGludGVyc2VjdGluZyA9IHRoaXMuc3BoZXJlQ29udmV4KHNwaGVyZVNoYXBlLCBoZlNoYXBlLnBpbGxhckNvbnZleCwgc3BoZXJlUG9zLCB3b3JsZFBpbGxhck9mZnNldCwgc3BoZXJlUXVhdCwgaGZRdWF0LCBzcGhlcmVCb2R5LCBoZkJvZHksIHNwaGVyZVNoYXBlLCBoZlNoYXBlLCBqdXN0VGVzdCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGp1c3RUZXN0ICYmIGludGVyc2VjdGluZykgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCBudW1Db250YWN0cyA9IHJlc3VsdC5sZW5ndGggLSBudW1Db250YWN0c0JlZm9yZTsKCiAgICAgICAgICBpZiAobnVtQ29udGFjdHMgPiAyKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIC8qCiAgICAgICAgICAgIC8vIFNraXAgYWxsIGJ1dCAxCiAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgbnVtQ29udGFjdHMgLSAxOyBrKyspIHsKICAgICAgICAgICAgICAgIHJlc3VsdC5wb3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgKi8KCiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgYm94SGVpZ2h0ZmllbGQoc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2kubWF0ZXJpYWw7CiAgICAgIHNpLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5jb2xsaXNpb25SZXNwb25zZSA9IHNpLmNvbGxpc2lvblJlc3BvbnNlOwogICAgICByZXR1cm4gdGhpcy5jb252ZXhIZWlnaHRmaWVsZChzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24sIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCBzaSwgc2osIGp1c3RUZXN0KTsKICAgIH0KCiAgICBjb252ZXhIZWlnaHRmaWVsZChjb252ZXhTaGFwZSwgaGZTaGFwZSwgY29udmV4UG9zLCBoZlBvcywgY29udmV4UXVhdCwgaGZRdWF0LCBjb252ZXhCb2R5LCBoZkJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBjb25zdCBkYXRhID0gaGZTaGFwZS5kYXRhOwogICAgICBjb25zdCB3ID0gaGZTaGFwZS5lbGVtZW50U2l6ZTsKICAgICAgY29uc3QgcmFkaXVzID0gY29udmV4U2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXM7CiAgICAgIGNvbnN0IHdvcmxkUGlsbGFyT2Zmc2V0ID0gY29udmV4SGVpZ2h0ZmllbGRfdG1wMjsKICAgICAgY29uc3QgZmFjZUxpc3QgPSBjb252ZXhIZWlnaHRmaWVsZF9mYWNlTGlzdDsgLy8gR2V0IHNwaGVyZSBwb3NpdGlvbiB0byBoZWlnaHRmaWVsZCBsb2NhbCEKCiAgICAgIGNvbnN0IGxvY2FsQ29udmV4UG9zID0gY29udmV4SGVpZ2h0ZmllbGRfdG1wMTsKICAgICAgVHJhbnNmb3JtLnBvaW50VG9Mb2NhbEZyYW1lKGhmUG9zLCBoZlF1YXQsIGNvbnZleFBvcywgbG9jYWxDb252ZXhQb3MpOyAvLyBHZXQgdGhlIGluZGV4IG9mIHRoZSBkYXRhIHBvaW50cyB0byB0ZXN0IGFnYWluc3QKCiAgICAgIGxldCBpTWluWCA9IE1hdGguZmxvb3IoKGxvY2FsQ29udmV4UG9zLnggLSByYWRpdXMpIC8gdykgLSAxOwogICAgICBsZXQgaU1heFggPSBNYXRoLmNlaWwoKGxvY2FsQ29udmV4UG9zLnggKyByYWRpdXMpIC8gdykgKyAxOwogICAgICBsZXQgaU1pblkgPSBNYXRoLmZsb29yKChsb2NhbENvbnZleFBvcy55IC0gcmFkaXVzKSAvIHcpIC0gMTsKICAgICAgbGV0IGlNYXhZID0gTWF0aC5jZWlsKChsb2NhbENvbnZleFBvcy55ICsgcmFkaXVzKSAvIHcpICsgMTsgLy8gQmFpbCBvdXQgaWYgd2UgYXJlIG91dCBvZiB0aGUgdGVycmFpbgoKICAgICAgaWYgKGlNYXhYIDwgMCB8fCBpTWF4WSA8IDAgfHwgaU1pblggPiBkYXRhLmxlbmd0aCB8fCBpTWluWSA+IGRhdGFbMF0ubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIENsYW1wIGluZGV4IHRvIGVkZ2VzCgoKICAgICAgaWYgKGlNaW5YIDwgMCkgewogICAgICAgIGlNaW5YID0gMDsKICAgICAgfQoKICAgICAgaWYgKGlNYXhYIDwgMCkgewogICAgICAgIGlNYXhYID0gMDsKICAgICAgfQoKICAgICAgaWYgKGlNaW5ZIDwgMCkgewogICAgICAgIGlNaW5ZID0gMDsKICAgICAgfQoKICAgICAgaWYgKGlNYXhZIDwgMCkgewogICAgICAgIGlNYXhZID0gMDsKICAgICAgfQoKICAgICAgaWYgKGlNaW5YID49IGRhdGEubGVuZ3RoKSB7CiAgICAgICAgaU1pblggPSBkYXRhLmxlbmd0aCAtIDE7CiAgICAgIH0KCiAgICAgIGlmIChpTWF4WCA+PSBkYXRhLmxlbmd0aCkgewogICAgICAgIGlNYXhYID0gZGF0YS5sZW5ndGggLSAxOwogICAgICB9CgogICAgICBpZiAoaU1heFkgPj0gZGF0YVswXS5sZW5ndGgpIHsKICAgICAgICBpTWF4WSA9IGRhdGFbMF0ubGVuZ3RoIC0gMTsKICAgICAgfQoKICAgICAgaWYgKGlNaW5ZID49IGRhdGFbMF0ubGVuZ3RoKSB7CiAgICAgICAgaU1pblkgPSBkYXRhWzBdLmxlbmd0aCAtIDE7CiAgICAgIH0KCiAgICAgIGNvbnN0IG1pbk1heCA9IFtdOwogICAgICBoZlNoYXBlLmdldFJlY3RNaW5NYXgoaU1pblgsIGlNaW5ZLCBpTWF4WCwgaU1heFksIG1pbk1heCk7CiAgICAgIGNvbnN0IG1pbiA9IG1pbk1heFswXTsKICAgICAgY29uc3QgbWF4ID0gbWluTWF4WzFdOyAvLyBCYWlsIG91dCBpZiB3ZSdyZSBjYW50IHRvdWNoIHRoZSBib3VuZGluZyBoZWlnaHQgYm94CgogICAgICBpZiAobG9jYWxDb252ZXhQb3MueiAtIHJhZGl1cyA+IG1heCB8fCBsb2NhbENvbnZleFBvcy56ICsgcmFkaXVzIDwgbWluKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBmb3IgKGxldCBpID0gaU1pblg7IGkgPCBpTWF4WDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IGlNaW5ZOyBqIDwgaU1heFk7IGorKykgewogICAgICAgICAgbGV0IGludGVyc2VjdGluZyA9IGZhbHNlOyAvLyBMb3dlciB0cmlhbmdsZQoKICAgICAgICAgIGhmU2hhcGUuZ2V0Q29udmV4VHJpYW5nbGVQaWxsYXIoaSwgaiwgZmFsc2UpOwogICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKGhmUG9zLCBoZlF1YXQsIGhmU2hhcGUucGlsbGFyT2Zmc2V0LCB3b3JsZFBpbGxhck9mZnNldCk7CgogICAgICAgICAgaWYgKGNvbnZleFBvcy5kaXN0YW5jZVRvKHdvcmxkUGlsbGFyT2Zmc2V0KSA8IGhmU2hhcGUucGlsbGFyQ29udmV4LmJvdW5kaW5nU3BoZXJlUmFkaXVzICsgY29udmV4U2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXMpIHsKICAgICAgICAgICAgaW50ZXJzZWN0aW5nID0gdGhpcy5jb252ZXhDb252ZXgoY29udmV4U2hhcGUsIGhmU2hhcGUucGlsbGFyQ29udmV4LCBjb252ZXhQb3MsIHdvcmxkUGlsbGFyT2Zmc2V0LCBjb252ZXhRdWF0LCBoZlF1YXQsIGNvbnZleEJvZHksIGhmQm9keSwgbnVsbCwgbnVsbCwganVzdFRlc3QsIGZhY2VMaXN0LCBudWxsKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoanVzdFRlc3QgJiYgaW50ZXJzZWN0aW5nKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfSAvLyBVcHBlciB0cmlhbmdsZQoKCiAgICAgICAgICBoZlNoYXBlLmdldENvbnZleFRyaWFuZ2xlUGlsbGFyKGksIGosIHRydWUpOwogICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKGhmUG9zLCBoZlF1YXQsIGhmU2hhcGUucGlsbGFyT2Zmc2V0LCB3b3JsZFBpbGxhck9mZnNldCk7CgogICAgICAgICAgaWYgKGNvbnZleFBvcy5kaXN0YW5jZVRvKHdvcmxkUGlsbGFyT2Zmc2V0KSA8IGhmU2hhcGUucGlsbGFyQ29udmV4LmJvdW5kaW5nU3BoZXJlUmFkaXVzICsgY29udmV4U2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXMpIHsKICAgICAgICAgICAgaW50ZXJzZWN0aW5nID0gdGhpcy5jb252ZXhDb252ZXgoY29udmV4U2hhcGUsIGhmU2hhcGUucGlsbGFyQ29udmV4LCBjb252ZXhQb3MsIHdvcmxkUGlsbGFyT2Zmc2V0LCBjb252ZXhRdWF0LCBoZlF1YXQsIGNvbnZleEJvZHksIGhmQm9keSwgbnVsbCwgbnVsbCwganVzdFRlc3QsIGZhY2VMaXN0LCBudWxsKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoanVzdFRlc3QgJiYgaW50ZXJzZWN0aW5nKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHNwaGVyZVBhcnRpY2xlKHNqLCBzaSwgeGosIHhpLCBxaiwgcWksIGJqLCBiaSwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIC8vIFRoZSBub3JtYWwgaXMgdGhlIHVuaXQgdmVjdG9yIGZyb20gc3BoZXJlIGNlbnRlciB0byBwYXJ0aWNsZSBjZW50ZXIKICAgICAgY29uc3Qgbm9ybWFsID0gcGFydGljbGVTcGhlcmVfbm9ybWFsOwogICAgICBub3JtYWwuc2V0KDAsIDAsIDEpOwogICAgICB4aS52c3ViKHhqLCBub3JtYWwpOwogICAgICBjb25zdCBsZW5ndGhTcXVhcmVkID0gbm9ybWFsLmxlbmd0aFNxdWFyZWQoKTsKCiAgICAgIGlmIChsZW5ndGhTcXVhcmVkIDw9IHNqLnJhZGl1cyAqIHNqLnJhZGl1cykgewogICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsKICAgICAgICBub3JtYWwubm9ybWFsaXplKCk7CiAgICAgICAgci5yai5jb3B5KG5vcm1hbCk7CiAgICAgICAgci5yai5zY2FsZShzai5yYWRpdXMsIHIucmopOwogICAgICAgIHIubmkuY29weShub3JtYWwpOyAvLyBDb250YWN0IG5vcm1hbAoKICAgICAgICByLm5pLm5lZ2F0ZShyLm5pKTsKICAgICAgICByLnJpLnNldCgwLCAwLCAwKTsgLy8gQ2VudGVyIG9mIHBhcnRpY2xlCgogICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICB9CiAgICB9CgogICAgcGxhbmVQYXJ0aWNsZShzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBjb25zdCBub3JtYWwgPSBwYXJ0aWNsZVBsYW5lX25vcm1hbDsKICAgICAgbm9ybWFsLnNldCgwLCAwLCAxKTsKICAgICAgYmoucXVhdGVybmlvbi52bXVsdChub3JtYWwsIG5vcm1hbCk7IC8vIFR1cm4gbm9ybWFsIGFjY29yZGluZyB0byBwbGFuZSBvcmllbnRhdGlvbgoKICAgICAgY29uc3QgcmVscG9zID0gcGFydGljbGVQbGFuZV9yZWxwb3M7CiAgICAgIHhpLnZzdWIoYmoucG9zaXRpb24sIHJlbHBvcyk7CiAgICAgIGNvbnN0IGRvdCA9IG5vcm1hbC5kb3QocmVscG9zKTsKCiAgICAgIGlmIChkb3QgPD0gMC4wKSB7CiAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgIHIubmkuY29weShub3JtYWwpOyAvLyBDb250YWN0IG5vcm1hbCBpcyB0aGUgcGxhbmUgbm9ybWFsCgogICAgICAgIHIubmkubmVnYXRlKHIubmkpOwogICAgICAgIHIucmkuc2V0KDAsIDAsIDApOyAvLyBDZW50ZXIgb2YgcGFydGljbGUKICAgICAgICAvLyBHZXQgcGFydGljbGUgcG9zaXRpb24gcHJvamVjdGVkIG9uIHBsYW5lCgogICAgICAgIGNvbnN0IHByb2plY3RlZCA9IHBhcnRpY2xlUGxhbmVfcHJvamVjdGVkOwogICAgICAgIG5vcm1hbC5zY2FsZShub3JtYWwuZG90KHhpKSwgcHJvamVjdGVkKTsKICAgICAgICB4aS52c3ViKHByb2plY3RlZCwgcHJvamVjdGVkKTsgLy9wcm9qZWN0ZWQudmFkZChiai5wb3NpdGlvbixwcm9qZWN0ZWQpOwogICAgICAgIC8vIHJqIGlzIG5vdyB0aGUgcHJvamVjdGVkIHdvcmxkIHBvc2l0aW9uIG1pbnVzIHBsYW5lIHBvc2l0aW9uCgogICAgICAgIHIucmouY29weShwcm9qZWN0ZWQpOwogICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICB9CiAgICB9CgogICAgYm94UGFydGljbGUoc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2kubWF0ZXJpYWw7CiAgICAgIHNpLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5jb2xsaXNpb25SZXNwb25zZSA9IHNpLmNvbGxpc2lvblJlc3BvbnNlOwogICAgICByZXR1cm4gdGhpcy5jb252ZXhQYXJ0aWNsZShzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24sIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCBzaSwgc2osIGp1c3RUZXN0KTsKICAgIH0KCiAgICBjb252ZXhQYXJ0aWNsZShzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBsZXQgcGVuZXRyYXRlZEZhY2VJbmRleCA9IC0xOwogICAgICBjb25zdCBwZW5ldHJhdGVkRmFjZU5vcm1hbCA9IGNvbnZleFBhcnRpY2xlX3BlbmV0cmF0ZWRGYWNlTm9ybWFsOwogICAgICBjb25zdCB3b3JsZFBlbmV0cmF0aW9uVmVjID0gY29udmV4UGFydGljbGVfd29ybGRQZW5ldHJhdGlvblZlYzsKICAgICAgbGV0IG1pblBlbmV0cmF0aW9uID0gbnVsbDsKCiAgICAgIGNvbnN0IGxvY2FsID0gY29udmV4UGFydGljbGVfbG9jYWw7CiAgICAgIGxvY2FsLmNvcHkoeGkpOwogICAgICBsb2NhbC52c3ViKHhqLCBsb2NhbCk7IC8vIENvbnZlcnQgcG9zaXRpb24gdG8gcmVsYXRpdmUgdGhlIGNvbnZleCBvcmlnaW4KCiAgICAgIHFqLmNvbmp1Z2F0ZShjcWopOwogICAgICBjcWoudm11bHQobG9jYWwsIGxvY2FsKTsKCiAgICAgIGlmIChzai5wb2ludElzSW5zaWRlKGxvY2FsKSkgewogICAgICAgIGlmIChzai53b3JsZFZlcnRpY2VzTmVlZHNVcGRhdGUpIHsKICAgICAgICAgIHNqLmNvbXB1dGVXb3JsZFZlcnRpY2VzKHhqLCBxaik7CiAgICAgICAgfQoKICAgICAgICBpZiAoc2oud29ybGRGYWNlTm9ybWFsc05lZWRzVXBkYXRlKSB7CiAgICAgICAgICBzai5jb21wdXRlV29ybGRGYWNlTm9ybWFscyhxaik7CiAgICAgICAgfSAvLyBGb3IgZWFjaCB3b3JsZCBwb2x5Z29uIGluIHRoZSBwb2x5aGVkcmEKCgogICAgICAgIGZvciAobGV0IGkgPSAwLCBuZmFjZXMgPSBzai5mYWNlcy5sZW5ndGg7IGkgIT09IG5mYWNlczsgaSsrKSB7CiAgICAgICAgICAvLyBDb25zdHJ1Y3Qgd29ybGQgZmFjZSB2ZXJ0aWNlcwogICAgICAgICAgY29uc3QgdmVydHMgPSBbc2oud29ybGRWZXJ0aWNlc1tzai5mYWNlc1tpXVswXV1dOwogICAgICAgICAgY29uc3Qgbm9ybWFsID0gc2oud29ybGRGYWNlTm9ybWFsc1tpXTsgLy8gQ2hlY2sgaG93IG11Y2ggdGhlIHBhcnRpY2xlIHBlbmV0cmF0ZXMgdGhlIHBvbHlnb24gcGxhbmUuCgogICAgICAgICAgeGkudnN1Yih2ZXJ0c1swXSwgY29udmV4UGFydGljbGVfdmVydGV4VG9QYXJ0aWNsZSk7CiAgICAgICAgICBjb25zdCBwZW5ldHJhdGlvbiA9IC1ub3JtYWwuZG90KGNvbnZleFBhcnRpY2xlX3ZlcnRleFRvUGFydGljbGUpOwoKICAgICAgICAgIGlmIChtaW5QZW5ldHJhdGlvbiA9PT0gbnVsbCB8fCBNYXRoLmFicyhwZW5ldHJhdGlvbikgPCBNYXRoLmFicyhtaW5QZW5ldHJhdGlvbikpIHsKICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG1pblBlbmV0cmF0aW9uID0gcGVuZXRyYXRpb247CiAgICAgICAgICAgIHBlbmV0cmF0ZWRGYWNlSW5kZXggPSBpOwogICAgICAgICAgICBwZW5ldHJhdGVkRmFjZU5vcm1hbC5jb3B5KG5vcm1hbCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAocGVuZXRyYXRlZEZhY2VJbmRleCAhPT0gLTEpIHsKICAgICAgICAgIC8vIFNldHVwIGNvbnRhY3QKICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgICAgcGVuZXRyYXRlZEZhY2VOb3JtYWwuc2NhbGUobWluUGVuZXRyYXRpb24sIHdvcmxkUGVuZXRyYXRpb25WZWMpOyAvLyByaiBpcyB0aGUgcGFydGljbGUgcG9zaXRpb24gcHJvamVjdGVkIHRvIHRoZSBmYWNlCgogICAgICAgICAgd29ybGRQZW5ldHJhdGlvblZlYy52YWRkKHhpLCB3b3JsZFBlbmV0cmF0aW9uVmVjKTsKICAgICAgICAgIHdvcmxkUGVuZXRyYXRpb25WZWMudnN1Yih4aiwgd29ybGRQZW5ldHJhdGlvblZlYyk7CiAgICAgICAgICByLnJqLmNvcHkod29ybGRQZW5ldHJhdGlvblZlYyk7IC8vY29uc3QgcHJvamVjdGVkVG9GYWNlID0geGkudnN1Yih4aikudmFkZCh3b3JsZFBlbmV0cmF0aW9uVmVjKTsKICAgICAgICAgIC8vcHJvamVjdGVkVG9GYWNlLmNvcHkoci5yaik7CiAgICAgICAgICAvL3FqLnZtdWx0KHIucmosci5yaik7CgogICAgICAgICAgcGVuZXRyYXRlZEZhY2VOb3JtYWwubmVnYXRlKHIubmkpOyAvLyBDb250YWN0IG5vcm1hbAoKICAgICAgICAgIHIucmkuc2V0KDAsIDAsIDApOyAvLyBDZW50ZXIgb2YgcGFydGljbGUKCiAgICAgICAgICBjb25zdCByaSA9IHIucmk7CiAgICAgICAgICBjb25zdCByaiA9IHIucmo7IC8vIE1ha2UgcmVsYXRpdmUgdG8gYm9kaWVzCgogICAgICAgICAgcmkudmFkZCh4aSwgcmkpOwogICAgICAgICAgcmkudnN1YihiaS5wb3NpdGlvbiwgcmkpOwogICAgICAgICAgcmoudmFkZCh4aiwgcmopOwogICAgICAgICAgcmoudnN1Yihiai5wb3NpdGlvbiwgcmopOwogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS53YXJuKCdQb2ludCBmb3VuZCBpbnNpZGUgY29udmV4LCBidXQgZGlkIG5vdCBmaW5kIHBlbmV0cmF0aW5nIGZhY2UhJyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaGVpZ2h0ZmllbGRDeWxpbmRlcihoZlNoYXBlLCBjb252ZXhTaGFwZSwgaGZQb3MsIGNvbnZleFBvcywgaGZRdWF0LCBjb252ZXhRdWF0LCBoZkJvZHksIGNvbnZleEJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhIZWlnaHRmaWVsZChjb252ZXhTaGFwZSwgaGZTaGFwZSwgY29udmV4UG9zLCBoZlBvcywgY29udmV4UXVhdCwgaGZRdWF0LCBjb252ZXhCb2R5LCBoZkJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgcGFydGljbGVDeWxpbmRlcihzaSwgc2osIHhpLCB4aiwgcWksIHFqLCBiaSwgYmosIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhQYXJ0aWNsZShzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHJzaSwgcnNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgc3BoZXJlVHJpbWVzaChzcGhlcmVTaGFwZSwgdHJpbWVzaFNoYXBlLCBzcGhlcmVQb3MsIHRyaW1lc2hQb3MsIHNwaGVyZVF1YXQsIHRyaW1lc2hRdWF0LCBzcGhlcmVCb2R5LCB0cmltZXNoQm9keSwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIGNvbnN0IGVkZ2VWZXJ0ZXhBID0gc3BoZXJlVHJpbWVzaF9lZGdlVmVydGV4QTsKICAgICAgY29uc3QgZWRnZVZlcnRleEIgPSBzcGhlcmVUcmltZXNoX2VkZ2VWZXJ0ZXhCOwogICAgICBjb25zdCBlZGdlVmVjdG9yID0gc3BoZXJlVHJpbWVzaF9lZGdlVmVjdG9yOwogICAgICBjb25zdCBlZGdlVmVjdG9yVW5pdCA9IHNwaGVyZVRyaW1lc2hfZWRnZVZlY3RvclVuaXQ7CiAgICAgIGNvbnN0IGxvY2FsU3BoZXJlUG9zID0gc3BoZXJlVHJpbWVzaF9sb2NhbFNwaGVyZVBvczsKICAgICAgY29uc3QgdG1wID0gc3BoZXJlVHJpbWVzaF90bXA7CiAgICAgIGNvbnN0IGxvY2FsU3BoZXJlQUFCQiA9IHNwaGVyZVRyaW1lc2hfbG9jYWxTcGhlcmVBQUJCOwogICAgICBjb25zdCB2MiA9IHNwaGVyZVRyaW1lc2hfdjI7CiAgICAgIGNvbnN0IHJlbHBvcyA9IHNwaGVyZVRyaW1lc2hfcmVscG9zOwogICAgICBjb25zdCB0cmlhbmdsZXMgPSBzcGhlcmVUcmltZXNoX3RyaWFuZ2xlczsgLy8gQ29udmVydCBzcGhlcmUgcG9zaXRpb24gdG8gbG9jYWwgaW4gdGhlIHRyaW1lc2gKCiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZSh0cmltZXNoUG9zLCB0cmltZXNoUXVhdCwgc3BoZXJlUG9zLCBsb2NhbFNwaGVyZVBvcyk7IC8vIEdldCB0aGUgYWFiYiBvZiB0aGUgc3BoZXJlIGxvY2FsbHkgaW4gdGhlIHRyaW1lc2gKCiAgICAgIGNvbnN0IHNwaGVyZVJhZGl1cyA9IHNwaGVyZVNoYXBlLnJhZGl1czsKICAgICAgbG9jYWxTcGhlcmVBQUJCLmxvd2VyQm91bmQuc2V0KGxvY2FsU3BoZXJlUG9zLnggLSBzcGhlcmVSYWRpdXMsIGxvY2FsU3BoZXJlUG9zLnkgLSBzcGhlcmVSYWRpdXMsIGxvY2FsU3BoZXJlUG9zLnogLSBzcGhlcmVSYWRpdXMpOwogICAgICBsb2NhbFNwaGVyZUFBQkIudXBwZXJCb3VuZC5zZXQobG9jYWxTcGhlcmVQb3MueCArIHNwaGVyZVJhZGl1cywgbG9jYWxTcGhlcmVQb3MueSArIHNwaGVyZVJhZGl1cywgbG9jYWxTcGhlcmVQb3MueiArIHNwaGVyZVJhZGl1cyk7CiAgICAgIHRyaW1lc2hTaGFwZS5nZXRUcmlhbmdsZXNJbkFBQkIobG9jYWxTcGhlcmVBQUJCLCB0cmlhbmdsZXMpOyAvL2ZvciAobGV0IGkgPSAwOyBpIDwgdHJpbWVzaFNoYXBlLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB0cmlhbmdsZXMucHVzaChpKTsgLy8gQWxsCiAgICAgIC8vIFZlcnRpY2VzCgogICAgICBjb25zdCB2ID0gc3BoZXJlVHJpbWVzaF92OwogICAgICBjb25zdCByYWRpdXNTcXVhcmVkID0gc3BoZXJlU2hhcGUucmFkaXVzICogc3BoZXJlU2hhcGUucmFkaXVzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmlhbmdsZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDM7IGorKykgewogICAgICAgICAgdHJpbWVzaFNoYXBlLmdldFZlcnRleCh0cmltZXNoU2hhcGUuaW5kaWNlc1t0cmlhbmdsZXNbaV0gKiAzICsgal0sIHYpOyAvLyBDaGVjayB2ZXJ0ZXggb3ZlcmxhcCBpbiBzcGhlcmUKCiAgICAgICAgICB2LnZzdWIobG9jYWxTcGhlcmVQb3MsIHJlbHBvcyk7CgogICAgICAgICAgaWYgKHJlbHBvcy5sZW5ndGhTcXVhcmVkKCkgPD0gcmFkaXVzU3F1YXJlZCkgewogICAgICAgICAgICAvLyBTYWZlIHVwCiAgICAgICAgICAgIHYyLmNvcHkodik7CiAgICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZSh0cmltZXNoUG9zLCB0cmltZXNoUXVhdCwgdjIsIHYpOwogICAgICAgICAgICB2LnZzdWIoc3BoZXJlUG9zLCByZWxwb3MpOwoKICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxldCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oc3BoZXJlQm9keSwgdHJpbWVzaEJvZHksIHNwaGVyZVNoYXBlLCB0cmltZXNoU2hhcGUsIHJzaSwgcnNqKTsKICAgICAgICAgICAgci5uaS5jb3B5KHJlbHBvcyk7CiAgICAgICAgICAgIHIubmkubm9ybWFsaXplKCk7IC8vIHJpIGlzIHRoZSB2ZWN0b3IgZnJvbSBzcGhlcmUgY2VudGVyIHRvIHRoZSBzcGhlcmUgc3VyZmFjZQoKICAgICAgICAgICAgci5yaS5jb3B5KHIubmkpOwogICAgICAgICAgICByLnJpLnNjYWxlKHNwaGVyZVNoYXBlLnJhZGl1cywgci5yaSk7CiAgICAgICAgICAgIHIucmkudmFkZChzcGhlcmVQb3MsIHIucmkpOwogICAgICAgICAgICByLnJpLnZzdWIoc3BoZXJlQm9keS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICAgIHIucmouY29weSh2KTsKICAgICAgICAgICAgci5yai52c3ViKHRyaW1lc2hCb2R5LnBvc2l0aW9uLCByLnJqKTsgLy8gU3RvcmUgcmVzdWx0CgogICAgICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIENoZWNrIGFsbCBlZGdlcwoKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdHJpYW5nbGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAzOyBqKyspIHsKICAgICAgICAgIHRyaW1lc2hTaGFwZS5nZXRWZXJ0ZXgodHJpbWVzaFNoYXBlLmluZGljZXNbdHJpYW5nbGVzW2ldICogMyArIGpdLCBlZGdlVmVydGV4QSk7CiAgICAgICAgICB0cmltZXNoU2hhcGUuZ2V0VmVydGV4KHRyaW1lc2hTaGFwZS5pbmRpY2VzW3RyaWFuZ2xlc1tpXSAqIDMgKyAoaiArIDEpICUgM10sIGVkZ2VWZXJ0ZXhCKTsKICAgICAgICAgIGVkZ2VWZXJ0ZXhCLnZzdWIoZWRnZVZlcnRleEEsIGVkZ2VWZWN0b3IpOyAvLyBQcm9qZWN0IHNwaGVyZSBwb3NpdGlvbiB0byB0aGUgZWRnZQoKICAgICAgICAgIGxvY2FsU3BoZXJlUG9zLnZzdWIoZWRnZVZlcnRleEIsIHRtcCk7CiAgICAgICAgICBjb25zdCBwb3NpdGlvbkFsb25nRWRnZUIgPSB0bXAuZG90KGVkZ2VWZWN0b3IpOwogICAgICAgICAgbG9jYWxTcGhlcmVQb3MudnN1YihlZGdlVmVydGV4QSwgdG1wKTsKICAgICAgICAgIGxldCBwb3NpdGlvbkFsb25nRWRnZUEgPSB0bXAuZG90KGVkZ2VWZWN0b3IpOwoKICAgICAgICAgIGlmIChwb3NpdGlvbkFsb25nRWRnZUEgPiAwICYmIHBvc2l0aW9uQWxvbmdFZGdlQiA8IDApIHsKICAgICAgICAgICAgLy8gTm93IGNoZWNrIHRoZSBvcnRob2dvbmFsIGRpc3RhbmNlIGZyb20gZWRnZSB0byBzcGhlcmUgY2VudGVyCiAgICAgICAgICAgIGxvY2FsU3BoZXJlUG9zLnZzdWIoZWRnZVZlcnRleEEsIHRtcCk7CiAgICAgICAgICAgIGVkZ2VWZWN0b3JVbml0LmNvcHkoZWRnZVZlY3Rvcik7CiAgICAgICAgICAgIGVkZ2VWZWN0b3JVbml0Lm5vcm1hbGl6ZSgpOwogICAgICAgICAgICBwb3NpdGlvbkFsb25nRWRnZUEgPSB0bXAuZG90KGVkZ2VWZWN0b3JVbml0KTsKICAgICAgICAgICAgZWRnZVZlY3RvclVuaXQuc2NhbGUocG9zaXRpb25BbG9uZ0VkZ2VBLCB0bXApOwogICAgICAgICAgICB0bXAudmFkZChlZGdlVmVydGV4QSwgdG1wKTsgLy8gdG1wIGlzIG5vdyB0aGUgc3BoZXJlIGNlbnRlciBwb3NpdGlvbiBwcm9qZWN0ZWQgdG8gdGhlIGVkZ2UsIGRlZmluZWQgbG9jYWxseSBpbiB0aGUgdHJpbWVzaCBmcmFtZQoKICAgICAgICAgICAgY29uc3QgZGlzdCA9IHRtcC5kaXN0YW5jZVRvKGxvY2FsU3BoZXJlUG9zKTsKCiAgICAgICAgICAgIGlmIChkaXN0IDwgc3BoZXJlU2hhcGUucmFkaXVzKSB7CiAgICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihzcGhlcmVCb2R5LCB0cmltZXNoQm9keSwgc3BoZXJlU2hhcGUsIHRyaW1lc2hTaGFwZSwgcnNpLCByc2opOwogICAgICAgICAgICAgIHRtcC52c3ViKGxvY2FsU3BoZXJlUG9zLCByLm5pKTsKICAgICAgICAgICAgICByLm5pLm5vcm1hbGl6ZSgpOwogICAgICAgICAgICAgIHIubmkuc2NhbGUoc3BoZXJlU2hhcGUucmFkaXVzLCByLnJpKTsKICAgICAgICAgICAgICByLnJpLnZhZGQoc3BoZXJlUG9zLCByLnJpKTsKICAgICAgICAgICAgICByLnJpLnZzdWIoc3BoZXJlQm9keS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKHRyaW1lc2hQb3MsIHRyaW1lc2hRdWF0LCB0bXAsIHRtcCk7CiAgICAgICAgICAgICAgdG1wLnZzdWIodHJpbWVzaEJvZHkucG9zaXRpb24sIHIucmopOwogICAgICAgICAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb1dvcmxkRnJhbWUodHJpbWVzaFF1YXQsIHIubmksIHIubmkpOwogICAgICAgICAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb1dvcmxkRnJhbWUodHJpbWVzaFF1YXQsIHIucmksIHIucmkpOwogICAgICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIFRyaWFuZ2xlIGZhY2VzCgoKICAgICAgY29uc3QgdmEgPSBzcGhlcmVUcmltZXNoX3ZhOwogICAgICBjb25zdCB2YiA9IHNwaGVyZVRyaW1lc2hfdmI7CiAgICAgIGNvbnN0IHZjID0gc3BoZXJlVHJpbWVzaF92YzsKICAgICAgY29uc3Qgbm9ybWFsID0gc3BoZXJlVHJpbWVzaF9ub3JtYWw7CgogICAgICBmb3IgKGxldCBpID0gMCwgTiA9IHRyaWFuZ2xlcy5sZW5ndGg7IGkgIT09IE47IGkrKykgewogICAgICAgIHRyaW1lc2hTaGFwZS5nZXRUcmlhbmdsZVZlcnRpY2VzKHRyaWFuZ2xlc1tpXSwgdmEsIHZiLCB2Yyk7CiAgICAgICAgdHJpbWVzaFNoYXBlLmdldE5vcm1hbCh0cmlhbmdsZXNbaV0sIG5vcm1hbCk7CiAgICAgICAgbG9jYWxTcGhlcmVQb3MudnN1Yih2YSwgdG1wKTsKICAgICAgICBsZXQgZGlzdCA9IHRtcC5kb3Qobm9ybWFsKTsKICAgICAgICBub3JtYWwuc2NhbGUoZGlzdCwgdG1wKTsKICAgICAgICBsb2NhbFNwaGVyZVBvcy52c3ViKHRtcCwgdG1wKTsgLy8gdG1wIGlzIG5vdyB0aGUgc3BoZXJlIHBvc2l0aW9uIHByb2plY3RlZCB0byB0aGUgdHJpYW5nbGUgcGxhbmUKCiAgICAgICAgZGlzdCA9IHRtcC5kaXN0YW5jZVRvKGxvY2FsU3BoZXJlUG9zKTsKCiAgICAgICAgaWYgKFJheS5wb2ludEluVHJpYW5nbGUodG1wLCB2YSwgdmIsIHZjKSAmJiBkaXN0IDwgc3BoZXJlU2hhcGUucmFkaXVzKSB7CiAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgbGV0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihzcGhlcmVCb2R5LCB0cmltZXNoQm9keSwgc3BoZXJlU2hhcGUsIHRyaW1lc2hTaGFwZSwgcnNpLCByc2opOwogICAgICAgICAgdG1wLnZzdWIobG9jYWxTcGhlcmVQb3MsIHIubmkpOwogICAgICAgICAgci5uaS5ub3JtYWxpemUoKTsKICAgICAgICAgIHIubmkuc2NhbGUoc3BoZXJlU2hhcGUucmFkaXVzLCByLnJpKTsKICAgICAgICAgIHIucmkudmFkZChzcGhlcmVQb3MsIHIucmkpOwogICAgICAgICAgci5yaS52c3ViKHNwaGVyZUJvZHkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKHRyaW1lc2hQb3MsIHRyaW1lc2hRdWF0LCB0bXAsIHRtcCk7CiAgICAgICAgICB0bXAudnN1Yih0cmltZXNoQm9keS5wb3NpdGlvbiwgci5yaik7CiAgICAgICAgICBUcmFuc2Zvcm0udmVjdG9yVG9Xb3JsZEZyYW1lKHRyaW1lc2hRdWF0LCByLm5pLCByLm5pKTsKICAgICAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb1dvcmxkRnJhbWUodHJpbWVzaFF1YXQsIHIucmksIHIucmkpOwogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRyaWFuZ2xlcy5sZW5ndGggPSAwOwogICAgfQoKICAgIHBsYW5lVHJpbWVzaChwbGFuZVNoYXBlLCB0cmltZXNoU2hhcGUsIHBsYW5lUG9zLCB0cmltZXNoUG9zLCBwbGFuZVF1YXQsIHRyaW1lc2hRdWF0LCBwbGFuZUJvZHksIHRyaW1lc2hCb2R5LCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgLy8gTWFrZSBjb250YWN0cyEKICAgICAgY29uc3QgdiA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IG5vcm1hbCA9IHBsYW5lVHJpbWVzaF9ub3JtYWw7CiAgICAgIG5vcm1hbC5zZXQoMCwgMCwgMSk7CiAgICAgIHBsYW5lUXVhdC52bXVsdChub3JtYWwsIG5vcm1hbCk7IC8vIFR1cm4gbm9ybWFsIGFjY29yZGluZyB0byBwbGFuZQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmltZXNoU2hhcGUudmVydGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgLy8gR2V0IHdvcmxkIHZlcnRleCBmcm9tIHRyaW1lc2gKICAgICAgICB0cmltZXNoU2hhcGUuZ2V0VmVydGV4KGksIHYpOyAvLyBTYWZlIHVwCgogICAgICAgIGNvbnN0IHYyID0gbmV3IFZlYzMoKTsKICAgICAgICB2Mi5jb3B5KHYpOwogICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZSh0cmltZXNoUG9zLCB0cmltZXNoUXVhdCwgdjIsIHYpOyAvLyBDaGVjayBwbGFuZSBzaWRlCgogICAgICAgIGNvbnN0IHJlbHBvcyA9IHBsYW5lVHJpbWVzaF9yZWxwb3M7CiAgICAgICAgdi52c3ViKHBsYW5lUG9zLCByZWxwb3MpOwogICAgICAgIGNvbnN0IGRvdCA9IG5vcm1hbC5kb3QocmVscG9zKTsKCiAgICAgICAgaWYgKGRvdCA8PSAwLjApIHsKICAgICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24ocGxhbmVCb2R5LCB0cmltZXNoQm9keSwgcGxhbmVTaGFwZSwgdHJpbWVzaFNoYXBlLCByc2ksIHJzaik7CiAgICAgICAgICByLm5pLmNvcHkobm9ybWFsKTsgLy8gQ29udGFjdCBub3JtYWwgaXMgdGhlIHBsYW5lIG5vcm1hbAogICAgICAgICAgLy8gR2V0IHZlcnRleCBwb3NpdGlvbiBwcm9qZWN0ZWQgb24gcGxhbmUKCiAgICAgICAgICBjb25zdCBwcm9qZWN0ZWQgPSBwbGFuZVRyaW1lc2hfcHJvamVjdGVkOwogICAgICAgICAgbm9ybWFsLnNjYWxlKHJlbHBvcy5kb3Qobm9ybWFsKSwgcHJvamVjdGVkKTsKICAgICAgICAgIHYudnN1Yihwcm9qZWN0ZWQsIHByb2plY3RlZCk7IC8vIHJpIGlzIHRoZSBwcm9qZWN0ZWQgd29ybGQgcG9zaXRpb24gbWludXMgcGxhbmUgcG9zaXRpb24KCiAgICAgICAgICByLnJpLmNvcHkocHJvamVjdGVkKTsKICAgICAgICAgIHIucmkudnN1YihwbGFuZUJvZHkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgci5yai5jb3B5KHYpOwogICAgICAgICAgci5yai52c3ViKHRyaW1lc2hCb2R5LnBvc2l0aW9uLCByLnJqKTsgLy8gU3RvcmUgcmVzdWx0CgogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gLy8gY29udmV4VHJpbWVzaCgKICAgIC8vICAgc2k6IENvbnZleFBvbHloZWRyb24sIHNqOiBUcmltZXNoLCB4aTogVmVjMywgeGo6IFZlYzMsIHFpOiBRdWF0ZXJuaW9uLCBxajogUXVhdGVybmlvbiwKICAgIC8vICAgYmk6IEJvZHksIGJqOiBCb2R5LCByc2k/OiBTaGFwZSB8IG51bGwsIHJzaj86IFNoYXBlIHwgbnVsbCwKICAgIC8vICAgZmFjZUxpc3RBPzogbnVtYmVyW10gfCBudWxsLCBmYWNlTGlzdEI/OiBudW1iZXJbXSB8IG51bGwsCiAgICAvLyApIHsKICAgIC8vICAgY29uc3Qgc2VwQXhpcyA9IGNvbnZleENvbnZleF9zZXBBeGlzOwogICAgLy8gICBpZih4aS5kaXN0YW5jZVRvKHhqKSA+IHNpLmJvdW5kaW5nU3BoZXJlUmFkaXVzICsgc2ouYm91bmRpbmdTcGhlcmVSYWRpdXMpewogICAgLy8gICAgICAgcmV0dXJuOwogICAgLy8gICB9CiAgICAvLyAgIC8vIENvbnN0cnVjdCBhIHRlbXAgaHVsbCBmb3IgZWFjaCB0cmlhbmdsZQogICAgLy8gICBjb25zdCBodWxsQiA9IG5ldyBDb252ZXhQb2x5aGVkcm9uKCk7CiAgICAvLyAgIGh1bGxCLmZhY2VzID0gW1swLDEsMl1dOwogICAgLy8gICBjb25zdCB2YSA9IG5ldyBWZWMzKCk7CiAgICAvLyAgIGNvbnN0IHZiID0gbmV3IFZlYzMoKTsKICAgIC8vICAgY29uc3QgdmMgPSBuZXcgVmVjMygpOwogICAgLy8gICBodWxsQi52ZXJ0aWNlcyA9IFsKICAgIC8vICAgICAgIHZhLAogICAgLy8gICAgICAgdmIsCiAgICAvLyAgICAgICB2YwogICAgLy8gICBdOwogICAgLy8gICBmb3IgKGxldCBpID0gMDsgaSA8IHNqLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAvLyAgICAgICBjb25zdCB0cmlhbmdsZU5vcm1hbCA9IG5ldyBWZWMzKCk7CiAgICAvLyAgICAgICBzai5nZXROb3JtYWwoaSwgdHJpYW5nbGVOb3JtYWwpOwogICAgLy8gICAgICAgaHVsbEIuZmFjZU5vcm1hbHMgPSBbdHJpYW5nbGVOb3JtYWxdOwogICAgLy8gICAgICAgc2ouZ2V0VHJpYW5nbGVWZXJ0aWNlcyhpLCB2YSwgdmIsIHZjKTsKICAgIC8vICAgICAgIGxldCBkID0gc2kudGVzdFNlcEF4aXModHJpYW5nbGVOb3JtYWwsIGh1bGxCLCB4aSwgcWksIHhqLCBxaik7CiAgICAvLyAgICAgICBpZighZCl7CiAgICAvLyAgICAgICAgICAgdHJpYW5nbGVOb3JtYWwuc2NhbGUoLTEsIHRyaWFuZ2xlTm9ybWFsKTsKICAgIC8vICAgICAgICAgICBkID0gc2kudGVzdFNlcEF4aXModHJpYW5nbGVOb3JtYWwsIGh1bGxCLCB4aSwgcWksIHhqLCBxaik7CiAgICAvLyAgICAgICAgICAgaWYoIWQpewogICAgLy8gICAgICAgICAgICAgICBjb250aW51ZTsKICAgIC8vICAgICAgICAgICB9CiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgICBjb25zdCByZXM6IENvbnZleFBvbHloZWRyb25Db250YWN0UG9pbnRbXSA9IFtdOwogICAgLy8gICAgICAgY29uc3QgcSA9IGNvbnZleENvbnZleF9xOwogICAgLy8gICAgICAgc2kuY2xpcEFnYWluc3RIdWxsKHhpLHFpLGh1bGxCLHhqLHFqLHRyaWFuZ2xlTm9ybWFsLC0xMDAsMTAwLHJlcyk7CiAgICAvLyAgICAgICBmb3IobGV0IGogPSAwOyBqICE9PSByZXMubGVuZ3RoOyBqKyspewogICAgLy8gICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSxiaixzaSxzaixyc2kscnNqKSwKICAgIC8vICAgICAgICAgICAgICAgcmkgPSByLnJpLAogICAgLy8gICAgICAgICAgICAgICByaiA9IHIucmo7CiAgICAvLyAgICAgICAgICAgci5uaS5jb3B5KHRyaWFuZ2xlTm9ybWFsKTsKICAgIC8vICAgICAgICAgICByLm5pLm5lZ2F0ZShyLm5pKTsKICAgIC8vICAgICAgICAgICByZXNbal0ubm9ybWFsLm5lZ2F0ZShxKTsKICAgIC8vICAgICAgICAgICBxLm11bHQocmVzW2pdLmRlcHRoLCBxKTsKICAgIC8vICAgICAgICAgICByZXNbal0ucG9pbnQudmFkZChxLCByaSk7CiAgICAvLyAgICAgICAgICAgcmouY29weShyZXNbal0ucG9pbnQpOwogICAgLy8gICAgICAgICAgIC8vIENvbnRhY3QgcG9pbnRzIGFyZSBpbiB3b3JsZCBjb29yZGluYXRlcy4gVHJhbnNmb3JtIGJhY2sgdG8gcmVsYXRpdmUKICAgIC8vICAgICAgICAgICByaS52c3ViKHhpLHJpKTsKICAgIC8vICAgICAgICAgICByai52c3ViKHhqLHJqKTsKICAgIC8vICAgICAgICAgICAvLyBNYWtlIHJlbGF0aXZlIHRvIGJvZGllcwogICAgLy8gICAgICAgICAgIHJpLnZhZGQoeGksIHJpKTsKICAgIC8vICAgICAgICAgICByaS52c3ViKGJpLnBvc2l0aW9uLCByaSk7CiAgICAvLyAgICAgICAgICAgcmoudmFkZCh4aiwgcmopOwogICAgLy8gICAgICAgICAgIHJqLnZzdWIoYmoucG9zaXRpb24sIHJqKTsKICAgIC8vICAgICAgICAgICByZXN1bHQucHVzaChyKTsKICAgIC8vICAgICAgIH0KICAgIC8vICAgfQogICAgLy8gfQoKCiAgfQogIGNvbnN0IGF2ZXJhZ2VOb3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IGF2ZXJhZ2VDb250YWN0UG9pbnRBID0gbmV3IFZlYzMoKTsKICBjb25zdCBhdmVyYWdlQ29udGFjdFBvaW50QiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wVmVjMSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wVmVjMiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wUXVhdDEgPSBuZXcgUXVhdGVybmlvbigpOwogIGNvbnN0IHRtcFF1YXQyID0gbmV3IFF1YXRlcm5pb24oKTsKCiAgY29uc3QgcGxhbmVUcmltZXNoX25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVUcmltZXNoX3JlbHBvcyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVUcmltZXNoX3Byb2plY3RlZCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9ub3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfcmVscG9zID0gbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfdiA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF92MiA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9lZGdlVmVydGV4QSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9lZGdlVmVydGV4QiA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9lZGdlVmVjdG9yID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVUcmltZXNoX2VkZ2VWZWN0b3JVbml0ID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVUcmltZXNoX2xvY2FsU3BoZXJlUG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVUcmltZXNoX3RtcCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF92YSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF92YiA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF92YyA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9sb2NhbFNwaGVyZUFBQkIgPSBuZXcgQUFCQigpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfdHJpYW5nbGVzID0gW107CiAgY29uc3QgcG9pbnRfb25fcGxhbmVfdG9fc3BoZXJlID0gbmV3IFZlYzMoKTsKICBjb25zdCBwbGFuZV90b19zcGhlcmVfb3J0aG8gPSBuZXcgVmVjMygpOyAvLyBTZWUgaHR0cDovL2J1bGxldHBoeXNpY3MuY29tL0J1bGxldC9CdWxsZXRGdWxsL1NwaGVyZVRyaWFuZ2xlRGV0ZWN0b3JfOGNwcF9zb3VyY2UuaHRtbAoKICBjb25zdCBwb2ludEluUG9seWdvbl9lZGdlID0gbmV3IFZlYzMoKTsKICBjb25zdCBwb2ludEluUG9seWdvbl9lZGdlX3hfbm9ybWFsID0gbmV3IFZlYzMoKTsKICBjb25zdCBwb2ludEluUG9seWdvbl92dHAgPSBuZXcgVmVjMygpOwoKICBmdW5jdGlvbiBwb2ludEluUG9seWdvbih2ZXJ0cywgbm9ybWFsLCBwKSB7CiAgICBsZXQgcG9zaXRpdmVSZXN1bHQgPSBudWxsOwogICAgY29uc3QgTiA9IHZlcnRzLmxlbmd0aDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgIGNvbnN0IHYgPSB2ZXJ0c1tpXTsgLy8gR2V0IGVkZ2UgdG8gdGhlIG5leHQgdmVydGV4CgogICAgICBjb25zdCBlZGdlID0gcG9pbnRJblBvbHlnb25fZWRnZTsKICAgICAgdmVydHNbKGkgKyAxKSAlIE5dLnZzdWIodiwgZWRnZSk7IC8vIEdldCBjcm9zcyBwcm9kdWN0IGJldHdlZW4gcG9seWdvbiBub3JtYWwgYW5kIHRoZSBlZGdlCgogICAgICBjb25zdCBlZGdlX3hfbm9ybWFsID0gcG9pbnRJblBvbHlnb25fZWRnZV94X25vcm1hbDsgLy9jb25zdCBlZGdlX3hfbm9ybWFsID0gbmV3IFZlYzMoKTsKCiAgICAgIGVkZ2UuY3Jvc3Mobm9ybWFsLCBlZGdlX3hfbm9ybWFsKTsgLy8gR2V0IHZlY3RvciBiZXR3ZWVuIHBvaW50IGFuZCBjdXJyZW50IHZlcnRleAoKICAgICAgY29uc3QgdmVydGV4X3RvX3AgPSBwb2ludEluUG9seWdvbl92dHA7CiAgICAgIHAudnN1Yih2LCB2ZXJ0ZXhfdG9fcCk7IC8vIFRoaXMgZG90IHByb2R1Y3QgZGV0ZXJtaW5lcyB3aGljaCBzaWRlIG9mIHRoZSBlZGdlIHRoZSBwb2ludCBpcwoKICAgICAgY29uc3QgciA9IGVkZ2VfeF9ub3JtYWwuZG90KHZlcnRleF90b19wKTsgLy8gSWYgYWxsIHN1Y2ggZG90IHByb2R1Y3RzIGhhdmUgc2FtZSBzaWduLCB3ZSBhcmUgaW5zaWRlIHRoZSBwb2x5Z29uLgoKICAgICAgaWYgKHBvc2l0aXZlUmVzdWx0ID09PSBudWxsIHx8IHIgPiAwICYmIHBvc2l0aXZlUmVzdWx0ID09PSB0cnVlIHx8IHIgPD0gMCAmJiBwb3NpdGl2ZVJlc3VsdCA9PT0gZmFsc2UpIHsKICAgICAgICBpZiAocG9zaXRpdmVSZXN1bHQgPT09IG51bGwpIHsKICAgICAgICAgIHBvc2l0aXZlUmVzdWx0ID0gciA+IDA7CiAgICAgICAgfQoKICAgICAgICBjb250aW51ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZmFsc2U7IC8vIEVuY291bnRlcmVkIHNvbWUgb3RoZXIgc2lnbi4gRXhpdC4KICAgICAgfQogICAgfSAvLyBJZiB3ZSBnb3QgaGVyZSwgYWxsIGRvdCBwcm9kdWN0cyB3ZXJlIG9mIHRoZSBzYW1lIHNpZ24uCgoKICAgIHJldHVybiB0cnVlOwogIH0KCiAgY29uc3QgYm94X3RvX3NwaGVyZSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQm94X25zID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfbnMxID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfbnMyID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfc2lkZXMgPSBbbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKV07CiAgY29uc3Qgc3BoZXJlQm94X3NwaGVyZV90b19jb3JuZXIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUJveF9zaWRlX25zID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfc2lkZV9uczEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUJveF9zaWRlX25zMiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY29udmV4X3RvX3NwaGVyZSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQ29udmV4X2VkZ2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF9lZGdlVW5pdCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQ29udmV4X3NwaGVyZVRvQ29ybmVyID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVDb252ZXhfd29ybGRDb3JuZXIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF93b3JsZE5vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQ29udmV4X3dvcmxkUG9pbnQgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF93b3JsZFNwaGVyZVBvaW50Q2xvc2VzdFRvUGxhbmUgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF9wZW5ldHJhdGlvblZlYyA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQ29udmV4X3NwaGVyZVRvV29ybGRQb2ludCA9IG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IHBsYW5lQ29udmV4X3YgPSBuZXcgVmVjMygpOwogIGNvbnN0IHBsYW5lQ29udmV4X25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVDb252ZXhfcmVscG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCBwbGFuZUNvbnZleF9wcm9qZWN0ZWQgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleENvbnZleF9zZXBBeGlzID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb252ZXhDb252ZXhfcSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGFydGljbGVQbGFuZV9ub3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IHBhcnRpY2xlUGxhbmVfcmVscG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCBwYXJ0aWNsZVBsYW5lX3Byb2plY3RlZCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGFydGljbGVTcGhlcmVfbm9ybWFsID0gbmV3IFZlYzMoKTsgLy8gV0lQCgogIGNvbnN0IGNxaiA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgY29uc3QgY29udmV4UGFydGljbGVfbG9jYWwgPSBuZXcgVmVjMygpOwogIG5ldyBWZWMzKCk7CiAgY29uc3QgY29udmV4UGFydGljbGVfcGVuZXRyYXRlZEZhY2VOb3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleFBhcnRpY2xlX3ZlcnRleFRvUGFydGljbGUgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleFBhcnRpY2xlX3dvcmxkUGVuZXRyYXRpb25WZWMgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleEhlaWdodGZpZWxkX3RtcDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleEhlaWdodGZpZWxkX3RtcDIgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleEhlaWdodGZpZWxkX2ZhY2VMaXN0ID0gWzBdOwogIGNvbnN0IHNwaGVyZUhlaWdodGZpZWxkX3RtcDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUhlaWdodGZpZWxkX3RtcDIgPSBuZXcgVmVjMygpOwoKICBjbGFzcyBPdmVybGFwS2VlcGVyIHsKICAgIC8qKgogICAgICogQHRvZG8gUmVtb3ZlIHVzZWxlc3MgY29uc3RydWN0b3IKICAgICAqLwogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHRoaXMuY3VycmVudCA9IFtdOwogICAgICB0aGlzLnByZXZpb3VzID0gW107CiAgICB9CiAgICAvKioKICAgICAqIGdldEtleQogICAgICovCgoKICAgIGdldEtleShpLCBqKSB7CiAgICAgIGlmIChqIDwgaSkgewogICAgICAgIGNvbnN0IHRlbXAgPSBqOwogICAgICAgIGogPSBpOwogICAgICAgIGkgPSB0ZW1wOwogICAgICB9CgogICAgICByZXR1cm4gaSA8PCAxNiB8IGo7CiAgICB9CiAgICAvKioKICAgICAqIHNldAogICAgICovCgoKICAgIHNldChpLCBqKSB7CiAgICAgIC8vIEluc2VydGlvbiBzb3J0LiBUaGlzIHdheSB0aGUgZGlmZiB3aWxsIGhhdmUgbGluZWFyIGNvbXBsZXhpdHkuCiAgICAgIGNvbnN0IGtleSA9IHRoaXMuZ2V0S2V5KGksIGopOwogICAgICBjb25zdCBjdXJyZW50ID0gdGhpcy5jdXJyZW50OwogICAgICBsZXQgaW5kZXggPSAwOwoKICAgICAgd2hpbGUgKGtleSA+IGN1cnJlbnRbaW5kZXhdKSB7CiAgICAgICAgaW5kZXgrKzsKICAgICAgfQoKICAgICAgaWYgKGtleSA9PT0gY3VycmVudFtpbmRleF0pIHsKICAgICAgICByZXR1cm47IC8vIFBhaXIgd2FzIGFscmVhZHkgYWRkZWQKICAgICAgfQoKICAgICAgZm9yIChsZXQgaiA9IGN1cnJlbnQubGVuZ3RoIC0gMTsgaiA+PSBpbmRleDsgai0tKSB7CiAgICAgICAgY3VycmVudFtqICsgMV0gPSBjdXJyZW50W2pdOwogICAgICB9CgogICAgICBjdXJyZW50W2luZGV4XSA9IGtleTsKICAgIH0KICAgIC8qKgogICAgICogdGljawogICAgICovCgoKICAgIHRpY2soKSB7CiAgICAgIGNvbnN0IHRtcCA9IHRoaXMuY3VycmVudDsKICAgICAgdGhpcy5jdXJyZW50ID0gdGhpcy5wcmV2aW91czsKICAgICAgdGhpcy5wcmV2aW91cyA9IHRtcDsKICAgICAgdGhpcy5jdXJyZW50Lmxlbmd0aCA9IDA7CiAgICB9CiAgICAvKioKICAgICAqIGdldERpZmYKICAgICAqLwoKCiAgICBnZXREaWZmKGFkZGl0aW9ucywgcmVtb3ZhbHMpIHsKICAgICAgY29uc3QgYSA9IHRoaXMuY3VycmVudDsKICAgICAgY29uc3QgYiA9IHRoaXMucHJldmlvdXM7CiAgICAgIGNvbnN0IGFsID0gYS5sZW5ndGg7CiAgICAgIGNvbnN0IGJsID0gYi5sZW5ndGg7CiAgICAgIGxldCBqID0gMDsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWw7IGkrKykgewogICAgICAgIGxldCBmb3VuZCA9IGZhbHNlOwogICAgICAgIGNvbnN0IGtleUEgPSBhW2ldOwoKICAgICAgICB3aGlsZSAoa2V5QSA+IGJbal0pIHsKICAgICAgICAgIGorKzsKICAgICAgICB9CgogICAgICAgIGZvdW5kID0ga2V5QSA9PT0gYltqXTsKCiAgICAgICAgaWYgKCFmb3VuZCkgewogICAgICAgICAgdW5wYWNrQW5kUHVzaChhZGRpdGlvbnMsIGtleUEpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaiA9IDA7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJsOyBpKyspIHsKICAgICAgICBsZXQgZm91bmQgPSBmYWxzZTsKICAgICAgICBjb25zdCBrZXlCID0gYltpXTsKCiAgICAgICAgd2hpbGUgKGtleUIgPiBhW2pdKSB7CiAgICAgICAgICBqKys7CiAgICAgICAgfQoKICAgICAgICBmb3VuZCA9IGFbal0gPT09IGtleUI7CgogICAgICAgIGlmICghZm91bmQpIHsKICAgICAgICAgIHVucGFja0FuZFB1c2gocmVtb3ZhbHMsIGtleUIpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICB9CgogIGZ1bmN0aW9uIHVucGFja0FuZFB1c2goYXJyYXksIGtleSkgewogICAgYXJyYXkucHVzaCgoa2V5ICYgMHhmZmZmMDAwMCkgPj4gMTYsIGtleSAmIDB4MDAwMGZmZmYpOwogIH0KCiAgY29uc3QgZ2V0S2V5ID0gKGksIGopID0+IGkgPCBqID8gYCR7aX0tJHtqfWAgOiBgJHtqfS0ke2l9YDsKICAvKioKICAgKiBUdXBsZURpY3Rpb25hcnkKICAgKi8KCgogIGNsYXNzIFR1cGxlRGljdGlvbmFyeSB7CiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgdGhpcy5kYXRhID0gewogICAgICAgIGtleXM6IFtdCiAgICAgIH07CiAgICB9CgogICAgLyoqIGdldCAqLwogICAgZ2V0KGksIGopIHsKICAgICAgY29uc3Qga2V5ID0gZ2V0S2V5KGksIGopOwogICAgICByZXR1cm4gdGhpcy5kYXRhW2tleV07CiAgICB9CiAgICAvKiogc2V0ICovCgoKICAgIHNldChpLCBqLCB2YWx1ZSkgewogICAgICBjb25zdCBrZXkgPSBnZXRLZXkoaSwgaik7IC8vIENoZWNrIGlmIGtleSBhbHJlYWR5IGV4aXN0cwoKICAgICAgaWYgKCF0aGlzLmdldChpLCBqKSkgewogICAgICAgIHRoaXMuZGF0YS5rZXlzLnB1c2goa2V5KTsKICAgICAgfQoKICAgICAgdGhpcy5kYXRhW2tleV0gPSB2YWx1ZTsKICAgIH0KICAgIC8qKiBkZWxldGUgKi8KCgogICAgZGVsZXRlKGksIGopIHsKICAgICAgY29uc3Qga2V5ID0gZ2V0S2V5KGksIGopOwogICAgICBjb25zdCBpbmRleCA9IHRoaXMuZGF0YS5rZXlzLmluZGV4T2Yoa2V5KTsKCiAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsKICAgICAgICB0aGlzLmRhdGEua2V5cy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB9CgogICAgICBkZWxldGUgdGhpcy5kYXRhW2tleV07CiAgICB9CiAgICAvKiogcmVzZXQgKi8KCgogICAgcmVzZXQoKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGNvbnN0IGtleXMgPSBkYXRhLmtleXM7CgogICAgICB3aGlsZSAoa2V5cy5sZW5ndGggPiAwKSB7CiAgICAgICAgY29uc3Qga2V5ID0ga2V5cy5wb3AoKTsKICAgICAgICBkZWxldGUgZGF0YVtrZXldOwogICAgICB9CiAgICB9CgogIH0KCiAgLyoqCiAgICogVGhlIHBoeXNpY3Mgd29ybGQKICAgKi8KICBjbGFzcyBXb3JsZCBleHRlbmRzIEV2ZW50VGFyZ2V0IHsKICAgIC8qKgogICAgICogQ3VycmVudGx5IC8gbGFzdCB1c2VkIHRpbWVzdGVwLiBJcyBzZXQgdG8gLTEgaWYgbm90IGF2YWlsYWJsZS4gVGhpcyB2YWx1ZSBpcyB1cGRhdGVkIGJlZm9yZSBlYWNoIGludGVybmFsIHN0ZXAsIHdoaWNoIG1lYW5zIHRoYXQgaXQgaXMgImZyZXNoIiBpbnNpZGUgZXZlbnQgY2FsbGJhY2tzLgogICAgICovCgogICAgLyoqCiAgICAgKiBNYWtlcyBib2RpZXMgZ28gdG8gc2xlZXAgd2hlbiB0aGV5J3ZlIGJlZW4gaW5hY3RpdmUuCiAgICAgKiBAZGVmYXVsdCBmYWxzZQogICAgICovCgogICAgLyoqCiAgICAgKiBBbGwgdGhlIGN1cnJlbnQgY29udGFjdHMgKGluc3RhbmNlcyBvZiBDb250YWN0RXF1YXRpb24pIGluIHRoZSB3b3JsZC4KICAgICAqLwoKICAgIC8qKgogICAgICogSG93IG9mdGVuIHRvIG5vcm1hbGl6ZSBxdWF0ZXJuaW9ucy4gU2V0IHRvIDAgZm9yIGV2ZXJ5IHN0ZXAsIDEgZm9yIGV2ZXJ5IHNlY29uZCBldGMuLiBBIGxhcmdlciB2YWx1ZSBpbmNyZWFzZXMgcGVyZm9ybWFuY2UuIElmIGJvZGllcyB0ZW5kIHRvIGV4cGxvZGUsIHNldCB0byBhIHNtYWxsZXIgdmFsdWUgKHplcm8gdG8gYmUgc3VyZSBub3RoaW5nIGNhbiBnbyB3cm9uZykuCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNldCB0byB0cnVlIHRvIHVzZSBmYXN0IHF1YXRlcm5pb24gbm9ybWFsaXphdGlvbi4gSXQgaXMgb2Z0ZW4gZW5vdWdoIGFjY3VyYXRlIHRvIHVzZS4KICAgICAqIElmIGJvZGllcyB0ZW5kIHRvIGV4cGxvZGUsIHNldCB0byBmYWxzZS4KICAgICAqIEBkZWZhdWx0IGZhbHNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSB3YWxsLWNsb2NrIHRpbWUgc2luY2Ugc2ltdWxhdGlvbiBzdGFydC4KICAgICAqLwoKICAgIC8qKgogICAgICogTnVtYmVyIG9mIHRpbWVzdGVwcyB0YWtlbiBzaW5jZSBzdGFydC4KICAgICAqLwoKICAgIC8qKgogICAgICogRGVmYXVsdCBhbmQgbGFzdCB0aW1lc3RlcCBzaXplcy4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGdyYXZpdHkgb2YgdGhlIHdvcmxkLgogICAgICovCgogICAgLyoqCiAgICAgKiBHcmF2aXR5IHRvIHVzZSB3aGVuIGFwcHJveGltYXRpbmcgdGhlIGZyaWN0aW9uIG1heCBmb3JjZSAobXUqbWFzcypncmF2aXR5KS4KICAgICAqIElmIHVuZGVmaW5lZCwgZ2xvYmFsIGdyYXZpdHkgd2lsbCBiZSB1c2VkLgogICAgICogVXNlIHRvIGVuYWJsZSBmcmljdGlvbiBpbiBhIFdvcmxkIHdpdGggYSBudWxsIGdyYXZpdHkgdmVjdG9yIChubyBncmF2aXR5KS4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGJyb2FkcGhhc2UgYWxnb3JpdGhtIHRvIHVzZS4KICAgICAqIEBkZWZhdWx0IE5haXZlQnJvYWRwaGFzZQogICAgICovCgogICAgLyoqCiAgICAgKiBBbGwgYm9kaWVzIGluIHRoaXMgd29ybGQKICAgICAqLwoKICAgIC8qKgogICAgICogVHJ1ZSBpZiBhbnkgYm9kaWVzIGFyZSBub3Qgc2xlZXBpbmcsIGZhbHNlIGlmIGV2ZXJ5IGJvZHkgaXMgc2xlZXBpbmcuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBzb2x2ZXIgYWxnb3JpdGhtIHRvIHVzZS4KICAgICAqIEBkZWZhdWx0IEdTU29sdmVyCiAgICAgKi8KCiAgICAvKioKICAgICAqIGNvbGxpc2lvbk1hdHJpeAogICAgICovCgogICAgLyoqCiAgICAgKiBDb2xsaXNpb25NYXRyaXggZnJvbSB0aGUgcHJldmlvdXMgc3RlcC4KICAgICAqLwoKICAgIC8qKgogICAgICogQWxsIGFkZGVkIGNvbnRhY3RtYXRlcmlhbHMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFVzZWQgdG8gbG9vayB1cCBhIENvbnRhY3RNYXRlcmlhbCBnaXZlbiB0d28gaW5zdGFuY2VzIG9mIE1hdGVyaWFsLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgZGVmYXVsdCBtYXRlcmlhbCBvZiB0aGUgYm9kaWVzLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGlzIGNvbnRhY3QgbWF0ZXJpYWwgaXMgdXNlZCBpZiBubyBzdWl0YWJsZSBjb250YWN0bWF0ZXJpYWwgaXMgZm91bmQgZm9yIGEgY29udGFjdC4KICAgICAqLwoKICAgIC8qKgogICAgICogVGltZSBhY2N1bXVsYXRvciBmb3IgaW50ZXJwb2xhdGlvbi4KICAgICAqIEBzZWUgaHR0cHM6Ly9nYWZmZXJvbmdhbWVzLmNvbS9nYW1lLXBoeXNpY3MvZml4LXlvdXItdGltZXN0ZXAvCiAgICAgKi8KCiAgICAvKioKICAgICAqIERpc3BhdGNoZWQgYWZ0ZXIgYSBib2R5IGhhcyBiZWVuIGFkZGVkIHRvIHRoZSB3b3JsZC4KICAgICAqLwoKICAgIC8qKgogICAgICogRGlzcGF0Y2hlZCBhZnRlciBhIGJvZHkgaGFzIGJlZW4gcmVtb3ZlZCBmcm9tIHRoZSB3b3JsZC4KICAgICAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBzdXBlcigpOwogICAgICB0aGlzLmR0ID0gLTE7CiAgICAgIHRoaXMuYWxsb3dTbGVlcCA9ICEhb3B0aW9ucy5hbGxvd1NsZWVwOwogICAgICB0aGlzLmNvbnRhY3RzID0gW107CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvbnMgPSBbXTsKICAgICAgdGhpcy5xdWF0Tm9ybWFsaXplU2tpcCA9IG9wdGlvbnMucXVhdE5vcm1hbGl6ZVNraXAgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMucXVhdE5vcm1hbGl6ZVNraXAgOiAwOwogICAgICB0aGlzLnF1YXROb3JtYWxpemVGYXN0ID0gb3B0aW9ucy5xdWF0Tm9ybWFsaXplRmFzdCAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5xdWF0Tm9ybWFsaXplRmFzdCA6IGZhbHNlOwogICAgICB0aGlzLnRpbWUgPSAwLjA7CiAgICAgIHRoaXMuc3RlcG51bWJlciA9IDA7CiAgICAgIHRoaXMuZGVmYXVsdF9kdCA9IDEgLyA2MDsKICAgICAgdGhpcy5uZXh0SWQgPSAwOwogICAgICB0aGlzLmdyYXZpdHkgPSBuZXcgVmVjMygpOwoKICAgICAgaWYgKG9wdGlvbnMuZ3Jhdml0eSkgewogICAgICAgIHRoaXMuZ3Jhdml0eS5jb3B5KG9wdGlvbnMuZ3Jhdml0eSk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLmZyaWN0aW9uR3Jhdml0eSkgewogICAgICAgIHRoaXMuZnJpY3Rpb25HcmF2aXR5ID0gbmV3IFZlYzMoKTsKICAgICAgICB0aGlzLmZyaWN0aW9uR3Jhdml0eS5jb3B5KG9wdGlvbnMuZnJpY3Rpb25HcmF2aXR5KTsKICAgICAgfQoKICAgICAgdGhpcy5icm9hZHBoYXNlID0gb3B0aW9ucy5icm9hZHBoYXNlICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmJyb2FkcGhhc2UgOiBuZXcgTmFpdmVCcm9hZHBoYXNlKCk7CiAgICAgIHRoaXMuYm9kaWVzID0gW107CiAgICAgIHRoaXMuaGFzQWN0aXZlQm9kaWVzID0gZmFsc2U7CiAgICAgIHRoaXMuc29sdmVyID0gb3B0aW9ucy5zb2x2ZXIgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMuc29sdmVyIDogbmV3IEdTU29sdmVyKCk7CiAgICAgIHRoaXMuY29uc3RyYWludHMgPSBbXTsKICAgICAgdGhpcy5uYXJyb3dwaGFzZSA9IG5ldyBOYXJyb3dwaGFzZSh0aGlzKTsKICAgICAgdGhpcy5jb2xsaXNpb25NYXRyaXggPSBuZXcgQXJyYXlDb2xsaXNpb25NYXRyaXgoKTsKICAgICAgdGhpcy5jb2xsaXNpb25NYXRyaXhQcmV2aW91cyA9IG5ldyBBcnJheUNvbGxpc2lvbk1hdHJpeCgpOwogICAgICB0aGlzLmJvZHlPdmVybGFwS2VlcGVyID0gbmV3IE92ZXJsYXBLZWVwZXIoKTsKICAgICAgdGhpcy5zaGFwZU92ZXJsYXBLZWVwZXIgPSBuZXcgT3ZlcmxhcEtlZXBlcigpOwogICAgICB0aGlzLmNvbnRhY3RtYXRlcmlhbHMgPSBbXTsKICAgICAgdGhpcy5jb250YWN0TWF0ZXJpYWxUYWJsZSA9IG5ldyBUdXBsZURpY3Rpb25hcnkoKTsKICAgICAgdGhpcy5kZWZhdWx0TWF0ZXJpYWwgPSBuZXcgTWF0ZXJpYWwoJ2RlZmF1bHQnKTsKICAgICAgdGhpcy5kZWZhdWx0Q29udGFjdE1hdGVyaWFsID0gbmV3IENvbnRhY3RNYXRlcmlhbCh0aGlzLmRlZmF1bHRNYXRlcmlhbCwgdGhpcy5kZWZhdWx0TWF0ZXJpYWwsIHsKICAgICAgICBmcmljdGlvbjogMC4zLAogICAgICAgIHJlc3RpdHV0aW9uOiAwLjAKICAgICAgfSk7CiAgICAgIHRoaXMuZG9Qcm9maWxpbmcgPSBmYWxzZTsKICAgICAgdGhpcy5wcm9maWxlID0gewogICAgICAgIHNvbHZlOiAwLAogICAgICAgIG1ha2VDb250YWN0Q29uc3RyYWludHM6IDAsCiAgICAgICAgYnJvYWRwaGFzZTogMCwKICAgICAgICBpbnRlZ3JhdGU6IDAsCiAgICAgICAgbmFycm93cGhhc2U6IDAKICAgICAgfTsKICAgICAgdGhpcy5hY2N1bXVsYXRvciA9IDA7CiAgICAgIHRoaXMuc3Vic3lzdGVtcyA9IFtdOwogICAgICB0aGlzLmFkZEJvZHlFdmVudCA9IHsKICAgICAgICB0eXBlOiAnYWRkQm9keScsCiAgICAgICAgYm9keTogbnVsbAogICAgICB9OwogICAgICB0aGlzLnJlbW92ZUJvZHlFdmVudCA9IHsKICAgICAgICB0eXBlOiAncmVtb3ZlQm9keScsCiAgICAgICAgYm9keTogbnVsbAogICAgICB9OwogICAgICB0aGlzLmlkVG9Cb2R5TWFwID0ge307CiAgICAgIHRoaXMuYnJvYWRwaGFzZS5zZXRXb3JsZCh0aGlzKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBjb250YWN0IG1hdGVyaWFsIGJldHdlZW4gbWF0ZXJpYWxzIG0xIGFuZCBtMgogICAgICogQHJldHVybiBUaGUgY29udGFjdCBtYXRlcmlhbCBpZiBpdCB3YXMgZm91bmQuCiAgICAgKi8KCgogICAgZ2V0Q29udGFjdE1hdGVyaWFsKG0xLCBtMikgewogICAgICByZXR1cm4gdGhpcy5jb250YWN0TWF0ZXJpYWxUYWJsZS5nZXQobTEuaWQsIG0yLmlkKTsKICAgIH0KICAgIC8qKgogICAgICogU3RvcmUgb2xkIGNvbGxpc2lvbiBzdGF0ZSBpbmZvCiAgICAgKi8KCgogICAgY29sbGlzaW9uTWF0cml4VGljaygpIHsKICAgICAgY29uc3QgdGVtcCA9IHRoaXMuY29sbGlzaW9uTWF0cml4UHJldmlvdXM7CiAgICAgIHRoaXMuY29sbGlzaW9uTWF0cml4UHJldmlvdXMgPSB0aGlzLmNvbGxpc2lvbk1hdHJpeDsKICAgICAgdGhpcy5jb2xsaXNpb25NYXRyaXggPSB0ZW1wOwogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeC5yZXNldCgpOwogICAgICB0aGlzLmJvZHlPdmVybGFwS2VlcGVyLnRpY2soKTsKICAgICAgdGhpcy5zaGFwZU92ZXJsYXBLZWVwZXIudGljaygpOwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgYSBjb25zdHJhaW50IHRvIHRoZSBzaW11bGF0aW9uLgogICAgICovCgoKICAgIGFkZENvbnN0cmFpbnQoYykgewogICAgICB0aGlzLmNvbnN0cmFpbnRzLnB1c2goYyk7CiAgICB9CiAgICAvKioKICAgICAqIFJlbW92ZXMgYSBjb25zdHJhaW50CiAgICAgKi8KCgogICAgcmVtb3ZlQ29uc3RyYWludChjKSB7CiAgICAgIGNvbnN0IGlkeCA9IHRoaXMuY29uc3RyYWludHMuaW5kZXhPZihjKTsKCiAgICAgIGlmIChpZHggIT09IC0xKSB7CiAgICAgICAgdGhpcy5jb25zdHJhaW50cy5zcGxpY2UoaWR4LCAxKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSYXljYXN0IHRlc3QKICAgICAqIEBkZXByZWNhdGVkIFVzZSAucmF5Y2FzdEFsbCwgLnJheWNhc3RDbG9zZXN0IG9yIC5yYXljYXN0QW55IGluc3RlYWQuCiAgICAgKi8KCgogICAgcmF5VGVzdChmcm9tLCB0bywgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgaW5zdGFuY2VvZiBSYXljYXN0UmVzdWx0KSB7CiAgICAgICAgLy8gRG8gcmF5Y2FzdENsb3Nlc3QKICAgICAgICB0aGlzLnJheWNhc3RDbG9zZXN0KGZyb20sIHRvLCB7CiAgICAgICAgICBza2lwQmFja2ZhY2VzOiB0cnVlCiAgICAgICAgfSwgcmVzdWx0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBEbyByYXljYXN0QWxsCiAgICAgICAgdGhpcy5yYXljYXN0QWxsKGZyb20sIHRvLCB7CiAgICAgICAgICBza2lwQmFja2ZhY2VzOiB0cnVlCiAgICAgICAgfSwgcmVzdWx0KTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSYXkgY2FzdCBhZ2FpbnN0IGFsbCBib2RpZXMuIFRoZSBwcm92aWRlZCBjYWxsYmFjayB3aWxsIGJlIGV4ZWN1dGVkIGZvciBlYWNoIGhpdCB3aXRoIGEgUmF5Y2FzdFJlc3VsdCBhcyBzaW5nbGUgYXJndW1lbnQuCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgYW55IGJvZHkgd2FzIGhpdC4KICAgICAqLwoKCiAgICByYXljYXN0QWxsKGZyb20sIHRvLCBvcHRpb25zLCBjYWxsYmFjaykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBvcHRpb25zLm1vZGUgPSBSYXkuQUxMOwogICAgICBvcHRpb25zLmZyb20gPSBmcm9tOwogICAgICBvcHRpb25zLnRvID0gdG87CiAgICAgIG9wdGlvbnMuY2FsbGJhY2sgPSBjYWxsYmFjazsKICAgICAgcmV0dXJuIHRtcFJheS5pbnRlcnNlY3RXb3JsZCh0aGlzLCBvcHRpb25zKTsKICAgIH0KICAgIC8qKgogICAgICogUmF5IGNhc3QsIGFuZCBzdG9wIGF0IHRoZSBmaXJzdCByZXN1bHQuIE5vdGUgdGhhdCB0aGUgb3JkZXIgaXMgcmFuZG9tIC0gYnV0IHRoZSBtZXRob2QgaXMgZmFzdC4KICAgICAqIEByZXR1cm4gVHJ1ZSBpZiBhbnkgYm9keSB3YXMgaGl0LgogICAgICovCgoKICAgIHJheWNhc3RBbnkoZnJvbSwgdG8sIG9wdGlvbnMsIHJlc3VsdCkgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBvcHRpb25zLm1vZGUgPSBSYXkuQU5ZOwogICAgICBvcHRpb25zLmZyb20gPSBmcm9tOwogICAgICBvcHRpb25zLnRvID0gdG87CiAgICAgIG9wdGlvbnMucmVzdWx0ID0gcmVzdWx0OwogICAgICByZXR1cm4gdG1wUmF5LmludGVyc2VjdFdvcmxkKHRoaXMsIG9wdGlvbnMpOwogICAgfQogICAgLyoqCiAgICAgKiBSYXkgY2FzdCwgYW5kIHJldHVybiBpbmZvcm1hdGlvbiBvZiB0aGUgY2xvc2VzdCBoaXQuCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgYW55IGJvZHkgd2FzIGhpdC4KICAgICAqLwoKCiAgICByYXljYXN0Q2xvc2VzdChmcm9tLCB0bywgb3B0aW9ucywgcmVzdWx0KSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIG9wdGlvbnMubW9kZSA9IFJheS5DTE9TRVNUOwogICAgICBvcHRpb25zLmZyb20gPSBmcm9tOwogICAgICBvcHRpb25zLnRvID0gdG87CiAgICAgIG9wdGlvbnMucmVzdWx0ID0gcmVzdWx0OwogICAgICByZXR1cm4gdG1wUmF5LmludGVyc2VjdFdvcmxkKHRoaXMsIG9wdGlvbnMpOwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgYSByaWdpZCBib2R5IHRvIHRoZSBzaW11bGF0aW9uLgogICAgICogQHRvZG8gSWYgdGhlIHNpbXVsYXRpb24gaGFzIG5vdCB5ZXQgc3RhcnRlZCwgd2h5IHJlY3JldGUgYW5kIGNvcHkgYXJyYXlzIGZvciBlYWNoIGJvZHk/IEFjY3VtdWxhdGUgaW4gZHluYW1pYyBhcnJheXMgaW4gdGhpcyBjYXNlLgogICAgICogQHRvZG8gQWRkaW5nIGFuIGFycmF5IG9mIGJvZGllcyBzaG91bGQgYmUgcG9zc2libGUuIFRoaXMgd291bGQgc2F2ZSBzb21lIGxvb3BzIHRvbwogICAgICovCgoKICAgIGFkZEJvZHkoYm9keSkgewogICAgICBpZiAodGhpcy5ib2RpZXMuaW5jbHVkZXMoYm9keSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGJvZHkuaW5kZXggPSB0aGlzLmJvZGllcy5sZW5ndGg7CiAgICAgIHRoaXMuYm9kaWVzLnB1c2goYm9keSk7CiAgICAgIGJvZHkud29ybGQgPSB0aGlzOwogICAgICBib2R5LmluaXRQb3NpdGlvbi5jb3B5KGJvZHkucG9zaXRpb24pOwogICAgICBib2R5LmluaXRWZWxvY2l0eS5jb3B5KGJvZHkudmVsb2NpdHkpOwogICAgICBib2R5LnRpbWVMYXN0U2xlZXB5ID0gdGhpcy50aW1lOwoKICAgICAgaWYgKGJvZHkgaW5zdGFuY2VvZiBCb2R5KSB7CiAgICAgICAgYm9keS5pbml0QW5ndWxhclZlbG9jaXR5LmNvcHkoYm9keS5hbmd1bGFyVmVsb2NpdHkpOwogICAgICAgIGJvZHkuaW5pdFF1YXRlcm5pb24uY29weShib2R5LnF1YXRlcm5pb24pOwogICAgICB9CgogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeC5zZXROdW1PYmplY3RzKHRoaXMuYm9kaWVzLmxlbmd0aCk7CiAgICAgIHRoaXMuYWRkQm9keUV2ZW50LmJvZHkgPSBib2R5OwogICAgICB0aGlzLmlkVG9Cb2R5TWFwW2JvZHkuaWRdID0gYm9keTsKICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KHRoaXMuYWRkQm9keUV2ZW50KTsKICAgIH0KICAgIC8qKgogICAgICogUmVtb3ZlIGEgcmlnaWQgYm9keSBmcm9tIHRoZSBzaW11bGF0aW9uLgogICAgICovCgoKICAgIHJlbW92ZUJvZHkoYm9keSkgewogICAgICBib2R5LndvcmxkID0gbnVsbDsKICAgICAgY29uc3QgbiA9IHRoaXMuYm9kaWVzLmxlbmd0aCAtIDE7CiAgICAgIGNvbnN0IGJvZGllcyA9IHRoaXMuYm9kaWVzOwogICAgICBjb25zdCBpZHggPSBib2RpZXMuaW5kZXhPZihib2R5KTsKCiAgICAgIGlmIChpZHggIT09IC0xKSB7CiAgICAgICAgYm9kaWVzLnNwbGljZShpZHgsIDEpOyAvLyBUb2RvOiBzaG91bGQgdXNlIGEgZ2FyYmFnZSBmcmVlIG1ldGhvZAogICAgICAgIC8vIFJlY29tcHV0ZSBpbmRleAoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gYm9kaWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBib2RpZXNbaV0uaW5kZXggPSBpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5jb2xsaXNpb25NYXRyaXguc2V0TnVtT2JqZWN0cyhuKTsKICAgICAgICB0aGlzLnJlbW92ZUJvZHlFdmVudC5ib2R5ID0gYm9keTsKICAgICAgICBkZWxldGUgdGhpcy5pZFRvQm9keU1hcFtib2R5LmlkXTsKICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQodGhpcy5yZW1vdmVCb2R5RXZlbnQpOwogICAgICB9CiAgICB9CgogICAgZ2V0Qm9keUJ5SWQoaWQpIHsKICAgICAgcmV0dXJuIHRoaXMuaWRUb0JvZHlNYXBbaWRdOwogICAgfQogICAgLyoqCiAgICAgKiBAdG9kbyBNYWtlIGEgZmFzdGVyIG1hcAogICAgICovCgoKICAgIGdldFNoYXBlQnlJZChpZCkgewogICAgICBjb25zdCBib2RpZXMgPSB0aGlzLmJvZGllczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYm9kaWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3Qgc2hhcGVzID0gYm9kaWVzW2ldLnNoYXBlczsKCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBzaGFwZXMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIGNvbnN0IHNoYXBlID0gc2hhcGVzW2pdOwoKICAgICAgICAgIGlmIChzaGFwZS5pZCA9PT0gaWQpIHsKICAgICAgICAgICAgcmV0dXJuIHNoYXBlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICAvKioKICAgICAqIEFkZHMgYSBjb250YWN0IG1hdGVyaWFsIHRvIHRoZSBXb3JsZAogICAgICovCgoKICAgIGFkZENvbnRhY3RNYXRlcmlhbChjbWF0KSB7CiAgICAgIC8vIEFkZCBjb250YWN0IG1hdGVyaWFsCiAgICAgIHRoaXMuY29udGFjdG1hdGVyaWFscy5wdXNoKGNtYXQpOyAvLyBBZGQgY3VycmVudCBjb250YWN0IG1hdGVyaWFsIHRvIHRoZSBtYXRlcmlhbCB0YWJsZQoKICAgICAgdGhpcy5jb250YWN0TWF0ZXJpYWxUYWJsZS5zZXQoY21hdC5tYXRlcmlhbHNbMF0uaWQsIGNtYXQubWF0ZXJpYWxzWzFdLmlkLCBjbWF0KTsKICAgIH0KICAgIC8qKgogICAgICogUmVtb3ZlcyBhIGNvbnRhY3QgbWF0ZXJpYWwgZnJvbSB0aGUgV29ybGQuCiAgICAgKi8KCgogICAgcmVtb3ZlQ29udGFjdE1hdGVyaWFsKGNtYXQpIHsKICAgICAgY29uc3QgaWR4ID0gdGhpcy5jb250YWN0bWF0ZXJpYWxzLmluZGV4T2YoY21hdCk7CgogICAgICBpZiAoaWR4ID09PSAtMSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5jb250YWN0bWF0ZXJpYWxzLnNwbGljZShpZHgsIDEpOwogICAgICB0aGlzLmNvbnRhY3RNYXRlcmlhbFRhYmxlLmRlbGV0ZShjbWF0Lm1hdGVyaWFsc1swXS5pZCwgY21hdC5tYXRlcmlhbHNbMV0uaWQpOwogICAgfQogICAgLyoqCiAgICAgKiBTdGVwIHRoZSBzaW11bGF0aW9uIGZvcndhcmQga2VlcGluZyB0cmFjayBvZiBsYXN0IGNhbGxlZCB0aW1lCiAgICAgKiB0byBiZSBhYmxlIHRvIHN0ZXAgdGhlIHdvcmxkIGF0IGEgZml4ZWQgcmF0ZSwgaW5kZXBlbmRlbnRseSBvZiBmcmFtZXJhdGUuCiAgICAgKgogICAgICogQHBhcmFtIGR0IFRoZSBmaXhlZCB0aW1lIHN0ZXAgc2l6ZSB0byB1c2UgKGRlZmF1bHQ6IDEgLyA2MCkuCiAgICAgKiBAcGFyYW0gbWF4U3ViU3RlcHMgTWF4aW11bSBudW1iZXIgb2YgZml4ZWQgc3RlcHMgdG8gdGFrZSBwZXIgZnVuY3Rpb24gY2FsbCAoZGVmYXVsdDogMTApLgogICAgICogQHNlZSBodHRwczovL2dhZmZlcm9uZ2FtZXMuY29tL3Bvc3QvZml4X3lvdXJfdGltZXN0ZXAvCiAgICAgKiBAZXhhbXBsZQogICAgICogICAgIC8vIFJ1biB0aGUgc2ltdWxhdGlvbiBpbmRlcGVuZGVudGx5IG9mIGZyYW1lcmF0ZSBldmVyeSAxIC8gNjAgbXMKICAgICAqICAgICB3b3JsZC5maXhlZFN0ZXAoKQogICAgICovCgoKICAgIGZpeGVkU3RlcChkdCwgbWF4U3ViU3RlcHMpIHsKICAgICAgaWYgKGR0ID09PSB2b2lkIDApIHsKICAgICAgICBkdCA9IDEgLyA2MDsKICAgICAgfQoKICAgICAgaWYgKG1heFN1YlN0ZXBzID09PSB2b2lkIDApIHsKICAgICAgICBtYXhTdWJTdGVwcyA9IDEwOwogICAgICB9CgogICAgICBjb25zdCB0aW1lID0gcGVyZm9ybWFuY2Uubm93KCkgLyAxMDAwOyAvLyBzZWNvbmRzCgogICAgICBpZiAoIXRoaXMubGFzdENhbGxUaW1lKSB7CiAgICAgICAgdGhpcy5zdGVwKGR0LCB1bmRlZmluZWQsIG1heFN1YlN0ZXBzKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCB0aW1lU2luY2VMYXN0Q2FsbGVkID0gdGltZSAtIHRoaXMubGFzdENhbGxUaW1lOwogICAgICAgIHRoaXMuc3RlcChkdCwgdGltZVNpbmNlTGFzdENhbGxlZCwgbWF4U3ViU3RlcHMpOwogICAgICB9CgogICAgICB0aGlzLmxhc3RDYWxsVGltZSA9IHRpbWU7CiAgICB9CiAgICAvKioKICAgICAqIFN0ZXAgdGhlIHBoeXNpY3Mgd29ybGQgZm9yd2FyZCBpbiB0aW1lLgogICAgICoKICAgICAqIFRoZXJlIGFyZSB0d28gbW9kZXMuIFRoZSBzaW1wbGUgbW9kZSBpcyBmaXhlZCB0aW1lc3RlcHBpbmcgd2l0aG91dCBpbnRlcnBvbGF0aW9uLiBJbiB0aGlzIGNhc2UgeW91IG9ubHkgdXNlIHRoZSBmaXJzdCBhcmd1bWVudC4gVGhlIHNlY29uZCBjYXNlIHVzZXMgaW50ZXJwb2xhdGlvbi4gSW4gdGhhdCB5b3UgYWxzbyBwcm92aWRlIHRoZSB0aW1lIHNpbmNlIHRoZSBmdW5jdGlvbiB3YXMgbGFzdCB1c2VkLCBhcyB3ZWxsIGFzIHRoZSBtYXhpbXVtIGZpeGVkIHRpbWVzdGVwcyB0byB0YWtlLgogICAgICoKICAgICAqIEBwYXJhbSBkdCBUaGUgZml4ZWQgdGltZSBzdGVwIHNpemUgdG8gdXNlLgogICAgICogQHBhcmFtIHRpbWVTaW5jZUxhc3RDYWxsZWQgVGhlIHRpbWUgZWxhcHNlZCBzaW5jZSB0aGUgZnVuY3Rpb24gd2FzIGxhc3QgY2FsbGVkLgogICAgICogQHBhcmFtIG1heFN1YlN0ZXBzIE1heGltdW0gbnVtYmVyIG9mIGZpeGVkIHN0ZXBzIHRvIHRha2UgcGVyIGZ1bmN0aW9uIGNhbGwgKGRlZmF1bHQ6IDEwKS4KICAgICAqIEBzZWUgaHR0cHM6Ly93ZWIuYXJjaGl2ZS5vcmcvd2ViLzIwMTgwNDI2MTU0NTMxL2h0dHA6Ly9idWxsZXRwaHlzaWNzLm9yZy9tZWRpYXdpa2ktMS41LjgvaW5kZXgucGhwL1N0ZXBwaW5nX1RoZV9Xb3JsZCNXaGF0X2RvX3RoZV9wYXJhbWV0ZXJzX3RvX2J0RHluYW1pY3NXb3JsZDo6c3RlcFNpbXVsYXRpb25fbWVhbi4zRgogICAgICogQGV4YW1wbGUKICAgICAqICAgICAvLyBmaXhlZCB0aW1lc3RlcHBpbmcgd2l0aG91dCBpbnRlcnBvbGF0aW9uCiAgICAgKiAgICAgd29ybGQuc3RlcCgxIC8gNjApCiAgICAgKi8KCgogICAgc3RlcChkdCwgdGltZVNpbmNlTGFzdENhbGxlZCwgbWF4U3ViU3RlcHMpIHsKICAgICAgaWYgKG1heFN1YlN0ZXBzID09PSB2b2lkIDApIHsKICAgICAgICBtYXhTdWJTdGVwcyA9IDEwOwogICAgICB9CgogICAgICBpZiAodGltZVNpbmNlTGFzdENhbGxlZCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgLy8gRml4ZWQsIHNpbXBsZSBzdGVwcGluZwogICAgICAgIHRoaXMuaW50ZXJuYWxTdGVwKGR0KTsgLy8gSW5jcmVtZW50IHRpbWUKCiAgICAgICAgdGhpcy50aW1lICs9IGR0OwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYWNjdW11bGF0b3IgKz0gdGltZVNpbmNlTGFzdENhbGxlZDsKICAgICAgICBjb25zdCB0MCA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICAgIGxldCBzdWJzdGVwcyA9IDA7CgogICAgICAgIHdoaWxlICh0aGlzLmFjY3VtdWxhdG9yID49IGR0ICYmIHN1YnN0ZXBzIDwgbWF4U3ViU3RlcHMpIHsKICAgICAgICAgIC8vIERvIGZpeGVkIHN0ZXBzIHRvIGNhdGNoIHVwCiAgICAgICAgICB0aGlzLmludGVybmFsU3RlcChkdCk7CiAgICAgICAgICB0aGlzLmFjY3VtdWxhdG9yIC09IGR0OwogICAgICAgICAgc3Vic3RlcHMrKzsKCiAgICAgICAgICBpZiAocGVyZm9ybWFuY2Uubm93KCkgLSB0MCA+IGR0ICogMTAwMCkgewogICAgICAgICAgICAvLyBUaGUgZnJhbWVyYXRlIGlzIG5vdCBpbnRlcmFjdGl2ZSBhbnltb3JlLgogICAgICAgICAgICAvLyBXZSBhcmUgYmVsb3cgdGhlIHRhcmdldCBmcmFtZXJhdGUuCiAgICAgICAgICAgIC8vIEJldHRlciBiYWlsIG91dC4KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBSZW1vdmUgdGhlIGV4Y2VzcyBhY2N1bXVsYXRvciwgc2luY2Ugd2UgbWF5IG5vdAogICAgICAgIC8vIGhhdmUgaGFkIGVub3VnaCBzdWJzdGVwcyBhdmFpbGFibGUgdG8gY2F0Y2ggdXAKCgogICAgICAgIHRoaXMuYWNjdW11bGF0b3IgPSB0aGlzLmFjY3VtdWxhdG9yICUgZHQ7CiAgICAgICAgY29uc3QgdCA9IHRoaXMuYWNjdW11bGF0b3IgLyBkdDsKCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogIT09IHRoaXMuYm9kaWVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBjb25zdCBiID0gdGhpcy5ib2RpZXNbal07CiAgICAgICAgICBiLnByZXZpb3VzUG9zaXRpb24ubGVycChiLnBvc2l0aW9uLCB0LCBiLmludGVycG9sYXRlZFBvc2l0aW9uKTsKICAgICAgICAgIGIucHJldmlvdXNRdWF0ZXJuaW9uLnNsZXJwKGIucXVhdGVybmlvbiwgdCwgYi5pbnRlcnBvbGF0ZWRRdWF0ZXJuaW9uKTsKICAgICAgICAgIGIucHJldmlvdXNRdWF0ZXJuaW9uLm5vcm1hbGl6ZSgpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy50aW1lICs9IHRpbWVTaW5jZUxhc3RDYWxsZWQ7CiAgICAgIH0KICAgIH0KCiAgICBpbnRlcm5hbFN0ZXAoZHQpIHsKICAgICAgdGhpcy5kdCA9IGR0OwogICAgICBjb25zdCBjb250YWN0cyA9IHRoaXMuY29udGFjdHM7CiAgICAgIGNvbnN0IHAxID0gV29ybGRfc3RlcF9wMTsKICAgICAgY29uc3QgcDIgPSBXb3JsZF9zdGVwX3AyOwogICAgICBjb25zdCBOID0gdGhpcy5ib2RpZXMubGVuZ3RoOwogICAgICBjb25zdCBib2RpZXMgPSB0aGlzLmJvZGllczsKICAgICAgY29uc3Qgc29sdmVyID0gdGhpcy5zb2x2ZXI7CiAgICAgIGNvbnN0IGdyYXZpdHkgPSB0aGlzLmdyYXZpdHk7CiAgICAgIGNvbnN0IGRvUHJvZmlsaW5nID0gdGhpcy5kb1Byb2ZpbGluZzsKICAgICAgY29uc3QgcHJvZmlsZSA9IHRoaXMucHJvZmlsZTsKICAgICAgY29uc3QgRFlOQU1JQyA9IEJvZHkuRFlOQU1JQzsKICAgICAgbGV0IHByb2ZpbGluZ1N0YXJ0ID0gLUluZmluaXR5OwogICAgICBjb25zdCBjb25zdHJhaW50cyA9IHRoaXMuY29uc3RyYWludHM7CiAgICAgIGNvbnN0IGZyaWN0aW9uRXF1YXRpb25Qb29sID0gV29ybGRfc3RlcF9mcmljdGlvbkVxdWF0aW9uUG9vbDsKICAgICAgZ3Jhdml0eS5sZW5ndGgoKTsKICAgICAgY29uc3QgZ3ggPSBncmF2aXR5Lng7CiAgICAgIGNvbnN0IGd5ID0gZ3Jhdml0eS55OwogICAgICBjb25zdCBneiA9IGdyYXZpdHkuejsKICAgICAgbGV0IGkgPSAwOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsaW5nU3RhcnQgPSBwZXJmb3JtYW5jZS5ub3coKTsKICAgICAgfSAvLyBBZGQgZ3Jhdml0eSB0byBhbGwgb2JqZWN0cwoKCiAgICAgIGZvciAoaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGNvbnN0IGJpID0gYm9kaWVzW2ldOwoKICAgICAgICBpZiAoYmkudHlwZSA9PT0gRFlOQU1JQykgewogICAgICAgICAgLy8gT25seSBmb3IgZHluYW1pYyBib2RpZXMKICAgICAgICAgIGNvbnN0IGYgPSBiaS5mb3JjZTsKICAgICAgICAgIGNvbnN0IG0gPSBiaS5tYXNzOwogICAgICAgICAgZi54ICs9IG0gKiBneDsKICAgICAgICAgIGYueSArPSBtICogZ3k7CiAgICAgICAgICBmLnogKz0gbSAqIGd6OwogICAgICAgIH0KICAgICAgfSAvLyBVcGRhdGUgc3Vic3lzdGVtcwoKCiAgICAgIGZvciAobGV0IGkgPSAwLCBOc3Vic3lzdGVtcyA9IHRoaXMuc3Vic3lzdGVtcy5sZW5ndGg7IGkgIT09IE5zdWJzeXN0ZW1zOyBpKyspIHsKICAgICAgICB0aGlzLnN1YnN5c3RlbXNbaV0udXBkYXRlKCk7CiAgICAgIH0gLy8gQ29sbGlzaW9uIGRldGVjdGlvbgoKCiAgICAgIGlmIChkb1Byb2ZpbGluZykgewogICAgICAgIHByb2ZpbGluZ1N0YXJ0ID0gcGVyZm9ybWFuY2Uubm93KCk7CiAgICAgIH0KCiAgICAgIHAxLmxlbmd0aCA9IDA7IC8vIENsZWFuIHVwIHBhaXIgYXJyYXlzIGZyb20gbGFzdCBzdGVwCgogICAgICBwMi5sZW5ndGggPSAwOwogICAgICB0aGlzLmJyb2FkcGhhc2UuY29sbGlzaW9uUGFpcnModGhpcywgcDEsIHAyKTsKCiAgICAgIGlmIChkb1Byb2ZpbGluZykgewogICAgICAgIHByb2ZpbGUuYnJvYWRwaGFzZSA9IHBlcmZvcm1hbmNlLm5vdygpIC0gcHJvZmlsaW5nU3RhcnQ7CiAgICAgIH0gLy8gUmVtb3ZlIGNvbnN0cmFpbmVkIHBhaXJzIHdpdGggY29sbGlkZUNvbm5lY3RlZCA9PSBmYWxzZQoKCiAgICAgIGxldCBOY29uc3RyYWludHMgPSBjb25zdHJhaW50cy5sZW5ndGg7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOY29uc3RyYWludHM7IGkrKykgewogICAgICAgIGNvbnN0IGMgPSBjb25zdHJhaW50c1tpXTsKCiAgICAgICAgaWYgKCFjLmNvbGxpZGVDb25uZWN0ZWQpIHsKICAgICAgICAgIGZvciAobGV0IGogPSBwMS5sZW5ndGggLSAxOyBqID49IDA7IGogLT0gMSkgewogICAgICAgICAgICBpZiAoYy5ib2R5QSA9PT0gcDFbal0gJiYgYy5ib2R5QiA9PT0gcDJbal0gfHwgYy5ib2R5QiA9PT0gcDFbal0gJiYgYy5ib2R5QSA9PT0gcDJbal0pIHsKICAgICAgICAgICAgICBwMS5zcGxpY2UoaiwgMSk7CiAgICAgICAgICAgICAgcDIuc3BsaWNlKGosIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeFRpY2soKTsgLy8gR2VuZXJhdGUgY29udGFjdHMKCiAgICAgIGlmIChkb1Byb2ZpbGluZykgewogICAgICAgIHByb2ZpbGluZ1N0YXJ0ID0gcGVyZm9ybWFuY2Uubm93KCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IG9sZGNvbnRhY3RzID0gV29ybGRfc3RlcF9vbGRDb250YWN0czsKICAgICAgY29uc3QgTm9sZENvbnRhY3RzID0gY29udGFjdHMubGVuZ3RoOwoKICAgICAgZm9yIChpID0gMDsgaSAhPT0gTm9sZENvbnRhY3RzOyBpKyspIHsKICAgICAgICBvbGRjb250YWN0cy5wdXNoKGNvbnRhY3RzW2ldKTsKICAgICAgfQoKICAgICAgY29udGFjdHMubGVuZ3RoID0gMDsgLy8gVHJhbnNmZXIgRnJpY3Rpb25FcXVhdGlvbiBmcm9tIGN1cnJlbnQgbGlzdCB0byB0aGUgcG9vbCBmb3IgcmV1c2UKCiAgICAgIGNvbnN0IE5vbGRGcmljdGlvbkVxdWF0aW9ucyA9IHRoaXMuZnJpY3Rpb25FcXVhdGlvbnMubGVuZ3RoOwoKICAgICAgZm9yIChpID0gMDsgaSAhPT0gTm9sZEZyaWN0aW9uRXF1YXRpb25zOyBpKyspIHsKICAgICAgICBmcmljdGlvbkVxdWF0aW9uUG9vbC5wdXNoKHRoaXMuZnJpY3Rpb25FcXVhdGlvbnNbaV0pOwogICAgICB9CgogICAgICB0aGlzLmZyaWN0aW9uRXF1YXRpb25zLmxlbmd0aCA9IDA7CiAgICAgIHRoaXMubmFycm93cGhhc2UuZ2V0Q29udGFjdHMocDEsIHAyLCB0aGlzLCBjb250YWN0cywgb2xkY29udGFjdHMsIC8vIFRvIGJlIHJldXNlZAogICAgICB0aGlzLmZyaWN0aW9uRXF1YXRpb25zLCBmcmljdGlvbkVxdWF0aW9uUG9vbCk7CgogICAgICBpZiAoZG9Qcm9maWxpbmcpIHsKICAgICAgICBwcm9maWxlLm5hcnJvd3BoYXNlID0gcGVyZm9ybWFuY2Uubm93KCkgLSBwcm9maWxpbmdTdGFydDsKICAgICAgfSAvLyBMb29wIG92ZXIgYWxsIGNvbGxpc2lvbnMKCgogICAgICBpZiAoZG9Qcm9maWxpbmcpIHsKICAgICAgICBwcm9maWxpbmdTdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICB9IC8vIEFkZCBhbGwgZnJpY3Rpb24gZXFzCgoKICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuZnJpY3Rpb25FcXVhdGlvbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICBzb2x2ZXIuYWRkRXF1YXRpb24odGhpcy5mcmljdGlvbkVxdWF0aW9uc1tpXSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IG5jb250YWN0cyA9IGNvbnRhY3RzLmxlbmd0aDsKCiAgICAgIGZvciAobGV0IGsgPSAwOyBrICE9PSBuY29udGFjdHM7IGsrKykgewogICAgICAgIC8vIEN1cnJlbnQgY29udGFjdAogICAgICAgIGNvbnN0IGMgPSBjb250YWN0c1trXTsgLy8gR2V0IGN1cnJlbnQgY29sbGlzaW9uIGluZGVjZXMKCiAgICAgICAgY29uc3QgYmkgPSBjLmJpOwogICAgICAgIGNvbnN0IGJqID0gYy5iajsKICAgICAgICBjb25zdCBzaSA9IGMuc2k7CiAgICAgICAgY29uc3Qgc2ogPSBjLnNqOyAvLyBHZXQgY29sbGlzaW9uIHByb3BlcnRpZXMKCiAgICAgICAgbGV0IGNtOwoKICAgICAgICBpZiAoYmkubWF0ZXJpYWwgJiYgYmoubWF0ZXJpYWwpIHsKICAgICAgICAgIGNtID0gdGhpcy5nZXRDb250YWN0TWF0ZXJpYWwoYmkubWF0ZXJpYWwsIGJqLm1hdGVyaWFsKSB8fCB0aGlzLmRlZmF1bHRDb250YWN0TWF0ZXJpYWw7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNtID0gdGhpcy5kZWZhdWx0Q29udGFjdE1hdGVyaWFsOwogICAgICAgIH0gLy8gYy5lbmFibGVkID0gYmkuY29sbGlzaW9uUmVzcG9uc2UgJiYgYmouY29sbGlzaW9uUmVzcG9uc2UgJiYgc2kuY29sbGlzaW9uUmVzcG9uc2UgJiYgc2ouY29sbGlzaW9uUmVzcG9uc2U7CgoKICAgICAgICBjbS5mcmljdGlvbjsgLy8gYy5yZXN0aXR1dGlvbiA9IGNtLnJlc3RpdHV0aW9uOwogICAgICAgIC8vIElmIGZyaWN0aW9uIG9yIHJlc3RpdHV0aW9uIHdlcmUgc3BlY2lmaWVkIGluIHRoZSBtYXRlcmlhbCwgdXNlIHRoZW0KCiAgICAgICAgaWYgKGJpLm1hdGVyaWFsICYmIGJqLm1hdGVyaWFsKSB7CiAgICAgICAgICBpZiAoYmkubWF0ZXJpYWwuZnJpY3Rpb24gPj0gMCAmJiBiai5tYXRlcmlhbC5mcmljdGlvbiA+PSAwKSB7CiAgICAgICAgICAgIGJpLm1hdGVyaWFsLmZyaWN0aW9uICogYmoubWF0ZXJpYWwuZnJpY3Rpb247CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGJpLm1hdGVyaWFsLnJlc3RpdHV0aW9uID49IDAgJiYgYmoubWF0ZXJpYWwucmVzdGl0dXRpb24gPj0gMCkgewogICAgICAgICAgICBjLnJlc3RpdHV0aW9uID0gYmkubWF0ZXJpYWwucmVzdGl0dXRpb24gKiBiai5tYXRlcmlhbC5yZXN0aXR1dGlvbjsKICAgICAgICAgIH0KICAgICAgICB9IC8vIGMuc2V0U3Bvb2tQYXJhbXMoCiAgICAgICAgLy8gICAgICAgICAgIGNtLmNvbnRhY3RFcXVhdGlvblN0aWZmbmVzcywKICAgICAgICAvLyAgICAgICAgICAgY20uY29udGFjdEVxdWF0aW9uUmVsYXhhdGlvbiwKICAgICAgICAvLyAgICAgICAgICAgZHQKICAgICAgICAvLyAgICAgICApOwoKCiAgICAgICAgc29sdmVyLmFkZEVxdWF0aW9uKGMpOyAvLyAvLyBBZGQgZnJpY3Rpb24gY29uc3RyYWludCBlcXVhdGlvbgogICAgICAgIC8vIGlmKG11ID4gMCl7CiAgICAgICAgLy8gCS8vIENyZWF0ZSAyIHRhbmdlbnQgZXF1YXRpb25zCiAgICAgICAgLy8gCWNvbnN0IG11ZyA9IG11ICogZ25vcm07CiAgICAgICAgLy8gCWNvbnN0IHJlZHVjZWRNYXNzID0gKGJpLmludk1hc3MgKyBiai5pbnZNYXNzKTsKICAgICAgICAvLyAJaWYocmVkdWNlZE1hc3MgPiAwKXsKICAgICAgICAvLyAJCXJlZHVjZWRNYXNzID0gMS9yZWR1Y2VkTWFzczsKICAgICAgICAvLyAJfQogICAgICAgIC8vIAljb25zdCBwb29sID0gZnJpY3Rpb25FcXVhdGlvblBvb2w7CiAgICAgICAgLy8gCWNvbnN0IGMxID0gcG9vbC5sZW5ndGggPyBwb29sLnBvcCgpIDogbmV3IEZyaWN0aW9uRXF1YXRpb24oYmksYmosbXVnKnJlZHVjZWRNYXNzKTsKICAgICAgICAvLyAJY29uc3QgYzIgPSBwb29sLmxlbmd0aCA/IHBvb2wucG9wKCkgOiBuZXcgRnJpY3Rpb25FcXVhdGlvbihiaSxiaixtdWcqcmVkdWNlZE1hc3MpOwogICAgICAgIC8vIAl0aGlzLmZyaWN0aW9uRXF1YXRpb25zLnB1c2goYzEsIGMyKTsKICAgICAgICAvLyAJYzEuYmkgPSBjMi5iaSA9IGJpOwogICAgICAgIC8vIAljMS5iaiA9IGMyLmJqID0gYmo7CiAgICAgICAgLy8gCWMxLm1pbkZvcmNlID0gYzIubWluRm9yY2UgPSAtbXVnKnJlZHVjZWRNYXNzOwogICAgICAgIC8vIAljMS5tYXhGb3JjZSA9IGMyLm1heEZvcmNlID0gbXVnKnJlZHVjZWRNYXNzOwogICAgICAgIC8vIAkvLyBDb3B5IG92ZXIgdGhlIHJlbGF0aXZlIHZlY3RvcnMKICAgICAgICAvLyAJYzEucmkuY29weShjLnJpKTsKICAgICAgICAvLyAJYzEucmouY29weShjLnJqKTsKICAgICAgICAvLyAJYzIucmkuY29weShjLnJpKTsKICAgICAgICAvLyAJYzIucmouY29weShjLnJqKTsKICAgICAgICAvLyAJLy8gQ29uc3RydWN0IHRhbmdlbnRzCiAgICAgICAgLy8gCWMubmkudGFuZ2VudHMoYzEudCwgYzIudCk7CiAgICAgICAgLy8gICAgICAgICAgIC8vIFNldCBzcG9vayBwYXJhbXMKICAgICAgICAvLyAgICAgICAgICAgYzEuc2V0U3Bvb2tQYXJhbXMoY20uZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcywgY20uZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24sIGR0KTsKICAgICAgICAvLyAgICAgICAgICAgYzIuc2V0U3Bvb2tQYXJhbXMoY20uZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcywgY20uZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24sIGR0KTsKICAgICAgICAvLyAgICAgICAgICAgYzEuZW5hYmxlZCA9IGMyLmVuYWJsZWQgPSBjLmVuYWJsZWQ7CiAgICAgICAgLy8gCS8vIEFkZCBlcXVhdGlvbnMgdG8gc29sdmVyCiAgICAgICAgLy8gCXNvbHZlci5hZGRFcXVhdGlvbihjMSk7CiAgICAgICAgLy8gCXNvbHZlci5hZGRFcXVhdGlvbihjMik7CiAgICAgICAgLy8gfQoKICAgICAgICBpZiAoYmkuYWxsb3dTbGVlcCAmJiBiaS50eXBlID09PSBCb2R5LkRZTkFNSUMgJiYgYmkuc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORyAmJiBiai5zbGVlcFN0YXRlID09PSBCb2R5LkFXQUtFICYmIGJqLnR5cGUgIT09IEJvZHkuU1RBVElDKSB7CiAgICAgICAgICBjb25zdCBzcGVlZFNxdWFyZWRCID0gYmoudmVsb2NpdHkubGVuZ3RoU3F1YXJlZCgpICsgYmouYW5ndWxhclZlbG9jaXR5Lmxlbmd0aFNxdWFyZWQoKTsKICAgICAgICAgIGNvbnN0IHNwZWVkTGltaXRTcXVhcmVkQiA9IGJqLnNsZWVwU3BlZWRMaW1pdCAqKiAyOwoKICAgICAgICAgIGlmIChzcGVlZFNxdWFyZWRCID49IHNwZWVkTGltaXRTcXVhcmVkQiAqIDIpIHsKICAgICAgICAgICAgYmkud2FrZVVwQWZ0ZXJOYXJyb3dwaGFzZSA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoYmouYWxsb3dTbGVlcCAmJiBiai50eXBlID09PSBCb2R5LkRZTkFNSUMgJiYgYmouc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORyAmJiBiaS5zbGVlcFN0YXRlID09PSBCb2R5LkFXQUtFICYmIGJpLnR5cGUgIT09IEJvZHkuU1RBVElDKSB7CiAgICAgICAgICBjb25zdCBzcGVlZFNxdWFyZWRBID0gYmkudmVsb2NpdHkubGVuZ3RoU3F1YXJlZCgpICsgYmkuYW5ndWxhclZlbG9jaXR5Lmxlbmd0aFNxdWFyZWQoKTsKICAgICAgICAgIGNvbnN0IHNwZWVkTGltaXRTcXVhcmVkQSA9IGJpLnNsZWVwU3BlZWRMaW1pdCAqKiAyOwoKICAgICAgICAgIGlmIChzcGVlZFNxdWFyZWRBID49IHNwZWVkTGltaXRTcXVhcmVkQSAqIDIpIHsKICAgICAgICAgICAgYmoud2FrZVVwQWZ0ZXJOYXJyb3dwaGFzZSA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBOb3cgd2Uga25vdyB0aGF0IGkgYW5kIGogYXJlIGluIGNvbnRhY3QuIFNldCBjb2xsaXNpb24gbWF0cml4IHN0YXRlCgoKICAgICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeC5zZXQoYmksIGJqLCB0cnVlKTsKCiAgICAgICAgaWYgKCF0aGlzLmNvbGxpc2lvbk1hdHJpeFByZXZpb3VzLmdldChiaSwgYmopKSB7CiAgICAgICAgICAvLyBGaXJzdCBjb250YWN0IQogICAgICAgICAgLy8gV2UgcmV1c2UgdGhlIGNvbGxpZGVFdmVudCBvYmplY3QsIG90aGVyd2lzZSB3ZSB3aWxsIGVuZCB1cCBjcmVhdGluZyBuZXcgb2JqZWN0cyBmb3IgZWFjaCBuZXcgY29udGFjdCwgZXZlbiBpZiB0aGVyZSdzIG5vIGV2ZW50IGxpc3RlbmVyIGF0dGFjaGVkLgogICAgICAgICAgV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQuYm9keSA9IGJqOwogICAgICAgICAgV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQuY29udGFjdCA9IGM7CiAgICAgICAgICBiaS5kaXNwYXRjaEV2ZW50KFdvcmxkX3N0ZXBfY29sbGlkZUV2ZW50KTsKICAgICAgICAgIFdvcmxkX3N0ZXBfY29sbGlkZUV2ZW50LmJvZHkgPSBiaTsKICAgICAgICAgIGJqLmRpc3BhdGNoRXZlbnQoV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5ib2R5T3ZlcmxhcEtlZXBlci5zZXQoYmkuaWQsIGJqLmlkKTsKICAgICAgICB0aGlzLnNoYXBlT3ZlcmxhcEtlZXBlci5zZXQoc2kuaWQsIHNqLmlkKTsKICAgICAgfQoKICAgICAgdGhpcy5lbWl0Q29udGFjdEV2ZW50cygpOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsZS5tYWtlQ29udGFjdENvbnN0cmFpbnRzID0gcGVyZm9ybWFuY2Uubm93KCkgLSBwcm9maWxpbmdTdGFydDsKICAgICAgICBwcm9maWxpbmdTdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICB9IC8vIFdha2UgdXAgYm9kaWVzCgoKICAgICAgZm9yIChpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgYmkgPSBib2RpZXNbaV07CgogICAgICAgIGlmIChiaS53YWtlVXBBZnRlck5hcnJvd3BoYXNlKSB7CiAgICAgICAgICBiaS53YWtlVXAoKTsKICAgICAgICAgIGJpLndha2VVcEFmdGVyTmFycm93cGhhc2UgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0gLy8gQWRkIHVzZXItYWRkZWQgY29uc3RyYWludHMKCgogICAgICBOY29uc3RyYWludHMgPSBjb25zdHJhaW50cy5sZW5ndGg7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOY29uc3RyYWludHM7IGkrKykgewogICAgICAgIGNvbnN0IGMgPSBjb25zdHJhaW50c1tpXTsKICAgICAgICBjLnVwZGF0ZSgpOwoKICAgICAgICBmb3IgKGxldCBqID0gMCwgTmVxID0gYy5lcXVhdGlvbnMubGVuZ3RoOyBqICE9PSBOZXE7IGorKykgewogICAgICAgICAgY29uc3QgZXEgPSBjLmVxdWF0aW9uc1tqXTsKICAgICAgICAgIHNvbHZlci5hZGRFcXVhdGlvbihlcSk7CiAgICAgICAgfQogICAgICB9IC8vIFNvbHZlIHRoZSBjb25zdHJhaW5lZCBzeXN0ZW0KCgogICAgICBzb2x2ZXIuc29sdmUoZHQsIHRoaXMpOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsZS5zb2x2ZSA9IHBlcmZvcm1hbmNlLm5vdygpIC0gcHJvZmlsaW5nU3RhcnQ7CiAgICAgIH0gLy8gUmVtb3ZlIGFsbCBjb250YWN0cyBmcm9tIHNvbHZlcgoKCiAgICAgIHNvbHZlci5yZW1vdmVBbGxFcXVhdGlvbnMoKTsgLy8gQXBwbHkgZGFtcGluZywgc2VlIGh0dHA6Ly9jb2RlLmdvb2dsZS5jb20vcC9idWxsZXQvaXNzdWVzL2RldGFpbD9pZD03NCBmb3IgZGV0YWlscwoKICAgICAgY29uc3QgcG93ID0gTWF0aC5wb3c7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKCiAgICAgICAgaWYgKGJpLnR5cGUgJiBEWU5BTUlDKSB7CiAgICAgICAgICAvLyBPbmx5IGZvciBkeW5hbWljIGJvZGllcwogICAgICAgICAgY29uc3QgbGQgPSBwb3coMS4wIC0gYmkubGluZWFyRGFtcGluZywgZHQpOwogICAgICAgICAgY29uc3QgdiA9IGJpLnZlbG9jaXR5OwogICAgICAgICAgdi5zY2FsZShsZCwgdik7CiAgICAgICAgICBjb25zdCBhdiA9IGJpLmFuZ3VsYXJWZWxvY2l0eTsKCiAgICAgICAgICBpZiAoYXYpIHsKICAgICAgICAgICAgY29uc3QgYWQgPSBwb3coMS4wIC0gYmkuYW5ndWxhckRhbXBpbmcsIGR0KTsKICAgICAgICAgICAgYXYuc2NhbGUoYWQsIGF2KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChXb3JsZF9zdGVwX3ByZVN0ZXBFdmVudCk7IC8vIExlYXAgZnJvZwogICAgICAvLyB2bmV3ID0gdiArIGgqZi9tCiAgICAgIC8vIHhuZXcgPSB4ICsgaCp2bmV3CgogICAgICBpZiAoZG9Qcm9maWxpbmcpIHsKICAgICAgICBwcm9maWxpbmdTdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICB9CgogICAgICBjb25zdCBzdGVwbnVtYmVyID0gdGhpcy5zdGVwbnVtYmVyOwogICAgICBjb25zdCBxdWF0Tm9ybWFsaXplID0gc3RlcG51bWJlciAlICh0aGlzLnF1YXROb3JtYWxpemVTa2lwICsgMSkgPT09IDA7CiAgICAgIGNvbnN0IHF1YXROb3JtYWxpemVGYXN0ID0gdGhpcy5xdWF0Tm9ybWFsaXplRmFzdDsKCiAgICAgIGZvciAoaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGJvZGllc1tpXS5pbnRlZ3JhdGUoZHQsIHF1YXROb3JtYWxpemUsIHF1YXROb3JtYWxpemVGYXN0KTsKICAgICAgfQoKICAgICAgdGhpcy5jbGVhckZvcmNlcygpOwogICAgICB0aGlzLmJyb2FkcGhhc2UuZGlydHkgPSB0cnVlOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsZS5pbnRlZ3JhdGUgPSBwZXJmb3JtYW5jZS5ub3coKSAtIHByb2ZpbGluZ1N0YXJ0OwogICAgICB9IC8vIFVwZGF0ZSBzdGVwIG51bWJlcgoKCiAgICAgIHRoaXMuc3RlcG51bWJlciArPSAxOwogICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoV29ybGRfc3RlcF9wb3N0U3RlcEV2ZW50KTsgLy8gU2xlZXBpbmcgdXBkYXRlCgogICAgICBsZXQgaGFzQWN0aXZlQm9kaWVzID0gdHJ1ZTsKCiAgICAgIGlmICh0aGlzLmFsbG93U2xlZXApIHsKICAgICAgICBoYXNBY3RpdmVCb2RpZXMgPSBmYWxzZTsKCiAgICAgICAgZm9yIChpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKICAgICAgICAgIGJpLnNsZWVwVGljayh0aGlzLnRpbWUpOwoKICAgICAgICAgIGlmIChiaS5zbGVlcFN0YXRlICE9PSBCb2R5LlNMRUVQSU5HKSB7CiAgICAgICAgICAgIGhhc0FjdGl2ZUJvZGllcyA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmhhc0FjdGl2ZUJvZGllcyA9IGhhc0FjdGl2ZUJvZGllczsKICAgIH0KCiAgICBlbWl0Q29udGFjdEV2ZW50cygpIHsKICAgICAgY29uc3QgaGFzQmVnaW5Db250YWN0ID0gdGhpcy5oYXNBbnlFdmVudExpc3RlbmVyKCdiZWdpbkNvbnRhY3QnKTsKICAgICAgY29uc3QgaGFzRW5kQ29udGFjdCA9IHRoaXMuaGFzQW55RXZlbnRMaXN0ZW5lcignZW5kQ29udGFjdCcpOwoKICAgICAgaWYgKGhhc0JlZ2luQ29udGFjdCB8fCBoYXNFbmRDb250YWN0KSB7CiAgICAgICAgdGhpcy5ib2R5T3ZlcmxhcEtlZXBlci5nZXREaWZmKGFkZGl0aW9ucywgcmVtb3ZhbHMpOwogICAgICB9CgogICAgICBpZiAoaGFzQmVnaW5Db250YWN0KSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBhZGRpdGlvbnMubGVuZ3RoOyBpIDwgbDsgaSArPSAyKSB7CiAgICAgICAgICBiZWdpbkNvbnRhY3RFdmVudC5ib2R5QSA9IHRoaXMuZ2V0Qm9keUJ5SWQoYWRkaXRpb25zW2ldKTsKICAgICAgICAgIGJlZ2luQ29udGFjdEV2ZW50LmJvZHlCID0gdGhpcy5nZXRCb2R5QnlJZChhZGRpdGlvbnNbaSArIDFdKTsKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChiZWdpbkNvbnRhY3RFdmVudCk7CiAgICAgICAgfQoKICAgICAgICBiZWdpbkNvbnRhY3RFdmVudC5ib2R5QSA9IGJlZ2luQ29udGFjdEV2ZW50LmJvZHlCID0gbnVsbDsKICAgICAgfQoKICAgICAgaWYgKGhhc0VuZENvbnRhY3QpIHsKICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IHJlbW92YWxzLmxlbmd0aDsgaSA8IGw7IGkgKz0gMikgewogICAgICAgICAgZW5kQ29udGFjdEV2ZW50LmJvZHlBID0gdGhpcy5nZXRCb2R5QnlJZChyZW1vdmFsc1tpXSk7CiAgICAgICAgICBlbmRDb250YWN0RXZlbnQuYm9keUIgPSB0aGlzLmdldEJvZHlCeUlkKHJlbW92YWxzW2kgKyAxXSk7CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZW5kQ29udGFjdEV2ZW50KTsKICAgICAgICB9CgogICAgICAgIGVuZENvbnRhY3RFdmVudC5ib2R5QSA9IGVuZENvbnRhY3RFdmVudC5ib2R5QiA9IG51bGw7CiAgICAgIH0KCiAgICAgIGFkZGl0aW9ucy5sZW5ndGggPSByZW1vdmFscy5sZW5ndGggPSAwOwogICAgICBjb25zdCBoYXNCZWdpblNoYXBlQ29udGFjdCA9IHRoaXMuaGFzQW55RXZlbnRMaXN0ZW5lcignYmVnaW5TaGFwZUNvbnRhY3QnKTsKICAgICAgY29uc3QgaGFzRW5kU2hhcGVDb250YWN0ID0gdGhpcy5oYXNBbnlFdmVudExpc3RlbmVyKCdlbmRTaGFwZUNvbnRhY3QnKTsKCiAgICAgIGlmIChoYXNCZWdpblNoYXBlQ29udGFjdCB8fCBoYXNFbmRTaGFwZUNvbnRhY3QpIHsKICAgICAgICB0aGlzLnNoYXBlT3ZlcmxhcEtlZXBlci5nZXREaWZmKGFkZGl0aW9ucywgcmVtb3ZhbHMpOwogICAgICB9CgogICAgICBpZiAoaGFzQmVnaW5TaGFwZUNvbnRhY3QpIHsKICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGFkZGl0aW9ucy5sZW5ndGg7IGkgPCBsOyBpICs9IDIpIHsKICAgICAgICAgIGNvbnN0IHNoYXBlQSA9IHRoaXMuZ2V0U2hhcGVCeUlkKGFkZGl0aW9uc1tpXSk7CiAgICAgICAgICBjb25zdCBzaGFwZUIgPSB0aGlzLmdldFNoYXBlQnlJZChhZGRpdGlvbnNbaSArIDFdKTsKICAgICAgICAgIGJlZ2luU2hhcGVDb250YWN0RXZlbnQuc2hhcGVBID0gc2hhcGVBOwogICAgICAgICAgYmVnaW5TaGFwZUNvbnRhY3RFdmVudC5zaGFwZUIgPSBzaGFwZUI7CiAgICAgICAgICBpZiAoc2hhcGVBKSBiZWdpblNoYXBlQ29udGFjdEV2ZW50LmJvZHlBID0gc2hhcGVBLmJvZHk7CiAgICAgICAgICBpZiAoc2hhcGVCKSBiZWdpblNoYXBlQ29udGFjdEV2ZW50LmJvZHlCID0gc2hhcGVCLmJvZHk7CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoYmVnaW5TaGFwZUNvbnRhY3RFdmVudCk7CiAgICAgICAgfQoKICAgICAgICBiZWdpblNoYXBlQ29udGFjdEV2ZW50LmJvZHlBID0gYmVnaW5TaGFwZUNvbnRhY3RFdmVudC5ib2R5QiA9IGJlZ2luU2hhcGVDb250YWN0RXZlbnQuc2hhcGVBID0gYmVnaW5TaGFwZUNvbnRhY3RFdmVudC5zaGFwZUIgPSBudWxsOwogICAgICB9CgogICAgICBpZiAoaGFzRW5kU2hhcGVDb250YWN0KSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSByZW1vdmFscy5sZW5ndGg7IGkgPCBsOyBpICs9IDIpIHsKICAgICAgICAgIGNvbnN0IHNoYXBlQSA9IHRoaXMuZ2V0U2hhcGVCeUlkKHJlbW92YWxzW2ldKTsKICAgICAgICAgIGNvbnN0IHNoYXBlQiA9IHRoaXMuZ2V0U2hhcGVCeUlkKHJlbW92YWxzW2kgKyAxXSk7CiAgICAgICAgICBlbmRTaGFwZUNvbnRhY3RFdmVudC5zaGFwZUEgPSBzaGFwZUE7CiAgICAgICAgICBlbmRTaGFwZUNvbnRhY3RFdmVudC5zaGFwZUIgPSBzaGFwZUI7CiAgICAgICAgICBpZiAoc2hhcGVBKSBlbmRTaGFwZUNvbnRhY3RFdmVudC5ib2R5QSA9IHNoYXBlQS5ib2R5OwogICAgICAgICAgaWYgKHNoYXBlQikgZW5kU2hhcGVDb250YWN0RXZlbnQuYm9keUIgPSBzaGFwZUIuYm9keTsKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChlbmRTaGFwZUNvbnRhY3RFdmVudCk7CiAgICAgICAgfQoKICAgICAgICBlbmRTaGFwZUNvbnRhY3RFdmVudC5ib2R5QSA9IGVuZFNoYXBlQ29udGFjdEV2ZW50LmJvZHlCID0gZW5kU2hhcGVDb250YWN0RXZlbnQuc2hhcGVBID0gZW5kU2hhcGVDb250YWN0RXZlbnQuc2hhcGVCID0gbnVsbDsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIGFsbCBib2R5IGZvcmNlcyBpbiB0aGUgd29ybGQgdG8gemVyby4KICAgICAqLwoKCiAgICBjbGVhckZvcmNlcygpIHsKICAgICAgY29uc3QgYm9kaWVzID0gdGhpcy5ib2RpZXM7CiAgICAgIGNvbnN0IE4gPSBib2RpZXMubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGNvbnN0IGIgPSBib2RpZXNbaV07CiAgICAgICAgYi5mb3JjZTsKICAgICAgICBiLnRvcnF1ZTsKICAgICAgICBiLmZvcmNlLnNldCgwLCAwLCAwKTsKICAgICAgICBiLnRvcnF1ZS5zZXQoMCwgMCwgMCk7CiAgICAgIH0KICAgIH0KCiAgfSAvLyBUZW1wIHN0dWZmCgogIG5ldyBBQUJCKCk7CiAgY29uc3QgdG1wUmF5ID0gbmV3IFJheSgpOyAvLyBwZXJmb3JtYW5jZS5ub3coKSBmYWxsYmFjayBvbiBEYXRlLm5vdygpCgogIGNvbnN0IHBlcmZvcm1hbmNlID0gZ2xvYmFsVGhpcy5wZXJmb3JtYW5jZSB8fCB7fTsKCiAgaWYgKCFwZXJmb3JtYW5jZS5ub3cpIHsKICAgIGxldCBub3dPZmZzZXQgPSBEYXRlLm5vdygpOwoKICAgIGlmIChwZXJmb3JtYW5jZS50aW1pbmcgJiYgcGVyZm9ybWFuY2UudGltaW5nLm5hdmlnYXRpb25TdGFydCkgewogICAgICBub3dPZmZzZXQgPSBwZXJmb3JtYW5jZS50aW1pbmcubmF2aWdhdGlvblN0YXJ0OwogICAgfQoKICAgIHBlcmZvcm1hbmNlLm5vdyA9ICgpID0+IERhdGUubm93KCkgLSBub3dPZmZzZXQ7CiAgfQoKICBuZXcgVmVjMygpOyAvLyBEaXNwYXRjaGVkIGFmdGVyIHRoZSB3b3JsZCBoYXMgc3RlcHBlZCBmb3J3YXJkIGluIHRpbWUuCiAgLy8gUmV1c2FibGUgZXZlbnQgb2JqZWN0cyB0byBzYXZlIG1lbW9yeS4KCiAgY29uc3QgV29ybGRfc3RlcF9wb3N0U3RlcEV2ZW50ID0gewogICAgdHlwZTogJ3Bvc3RTdGVwJwogIH07IC8vIERpc3BhdGNoZWQgYmVmb3JlIHRoZSB3b3JsZCBzdGVwcyBmb3J3YXJkIGluIHRpbWUuCgogIGNvbnN0IFdvcmxkX3N0ZXBfcHJlU3RlcEV2ZW50ID0gewogICAgdHlwZTogJ3ByZVN0ZXAnCiAgfTsKICBjb25zdCBXb3JsZF9zdGVwX2NvbGxpZGVFdmVudCA9IHsKICAgIHR5cGU6IEJvZHkuQ09MTElERV9FVkVOVF9OQU1FLAogICAgYm9keTogbnVsbCwKICAgIGNvbnRhY3Q6IG51bGwKICB9OyAvLyBQb29scyBmb3IgdW51c2VkIG9iamVjdHMKCiAgY29uc3QgV29ybGRfc3RlcF9vbGRDb250YWN0cyA9IFtdOwogIGNvbnN0IFdvcmxkX3N0ZXBfZnJpY3Rpb25FcXVhdGlvblBvb2wgPSBbXTsgLy8gUmV1c2FibGUgYXJyYXlzIGZvciBjb2xsaXNpb24gcGFpcnMKCiAgY29uc3QgV29ybGRfc3RlcF9wMSA9IFtdOwogIGNvbnN0IFdvcmxkX3N0ZXBfcDIgPSBbXTsgLy8gU3R1ZmYgZm9yIGVtaXRDb250YWN0RXZlbnRzCgogIGNvbnN0IGFkZGl0aW9ucyA9IFtdOwogIGNvbnN0IHJlbW92YWxzID0gW107CiAgY29uc3QgYmVnaW5Db250YWN0RXZlbnQgPSB7CiAgICB0eXBlOiAnYmVnaW5Db250YWN0JywKICAgIGJvZHlBOiBudWxsLAogICAgYm9keUI6IG51bGwKICB9OwogIGNvbnN0IGVuZENvbnRhY3RFdmVudCA9IHsKICAgIHR5cGU6ICdlbmRDb250YWN0JywKICAgIGJvZHlBOiBudWxsLAogICAgYm9keUI6IG51bGwKICB9OwogIGNvbnN0IGJlZ2luU2hhcGVDb250YWN0RXZlbnQgPSB7CiAgICB0eXBlOiAnYmVnaW5TaGFwZUNvbnRhY3QnLAogICAgYm9keUE6IG51bGwsCiAgICBib2R5QjogbnVsbCwKICAgIHNoYXBlQTogbnVsbCwKICAgIHNoYXBlQjogbnVsbAogIH07CiAgY29uc3QgZW5kU2hhcGVDb250YWN0RXZlbnQgPSB7CiAgICB0eXBlOiAnZW5kU2hhcGVDb250YWN0JywKICAgIGJvZHlBOiBudWxsLAogICAgYm9keUI6IG51bGwsCiAgICBzaGFwZUE6IG51bGwsCiAgICBzaGFwZUI6IG51bGwKICB9OwoKICBjb25zdCBhZGRDb250YWN0TWF0ZXJpYWwgPSAod29ybGQsIGNyZWF0ZU1hdGVyaWFsLCBfcmVmLCB1dWlkKSA9PiB7CiAgICBsZXQgW21hdGVyaWFsQSwgbWF0ZXJpYWxCLCBvcHRpb25zXSA9IF9yZWY7CiAgICBjb25zdCBtYXRBID0gY3JlYXRlTWF0ZXJpYWwobWF0ZXJpYWxBKTsKICAgIGNvbnN0IG1hdEIgPSBjcmVhdGVNYXRlcmlhbChtYXRlcmlhbEIpOwogICAgY29uc3QgY29udGFjdE1hdGVyaWFsID0gbmV3IENvbnRhY3RNYXRlcmlhbChtYXRBLCBtYXRCLCBvcHRpb25zKTsKICAgIGNvbnRhY3RNYXRlcmlhbC51dWlkID0gdXVpZDsKICAgIHdvcmxkLmFkZENvbnRhY3RNYXRlcmlhbChjb250YWN0TWF0ZXJpYWwpOwogIH07CiAgY29uc3QgcmVtb3ZlQ29udGFjdE1hdGVyaWFsID0gKHdvcmxkLCBjbVVVSUQpID0+IHsKICAgIGNvbnN0IGluZGV4ID0gd29ybGQuY29udGFjdG1hdGVyaWFscy5maW5kSW5kZXgoX3JlZjIgPT4gewogICAgICBsZXQgewogICAgICAgIHV1aWQKICAgICAgfSA9IF9yZWYyOwogICAgICByZXR1cm4gdXVpZCA9PT0gY21VVUlEOwogICAgfSk7CiAgICBjb25zdCBbewogICAgICBpZDogaQogICAgfSwgewogICAgICBpZDogagogICAgfV0gPSB3b3JsZC5jb250YWN0bWF0ZXJpYWxzW2luZGV4XS5tYXRlcmlhbHM7CiAgICB3b3JsZC5jb250YWN0bWF0ZXJpYWxzLnNwbGljZShpbmRleCwgMSk7CiAgICBkZWxldGUgd29ybGQuY29udGFjdE1hdGVyaWFsVGFibGUuZGF0YVtpIDwgaiA/IGAke2l9LSR7an1gIDogYCR7an0tJHtpfWBdOwogIH07CgogIGxldCBtYXRlcmlhbElkID0gMDsKICBjb25zdCBjcmVhdGVNYXRlcmlhbEZhY3RvcnkgPSBtYXRlcmlhbHMgPT4gZnVuY3Rpb24gKG5hbWVPck9wdGlvbnMpIHsKICAgIGlmIChuYW1lT3JPcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgbmFtZU9yT3B0aW9ucyA9IHt9OwogICAgfQogICAgY29uc3QgbWF0ZXJpYWxPcHRpb25zID0gdHlwZW9mIG5hbWVPck9wdGlvbnMgPT09ICdzdHJpbmcnID8gewogICAgICBuYW1lOiBuYW1lT3JPcHRpb25zCiAgICB9IDogewogICAgICBuYW1lOiBTeW1ib2wuZm9yKGBNYXRlcmlhbCR7bWF0ZXJpYWxJZCsrfWApLAogICAgICAuLi5uYW1lT3JPcHRpb25zCiAgICB9OwogICAgY29uc3QgewogICAgICBuYW1lCiAgICB9ID0gbWF0ZXJpYWxPcHRpb25zOwogICAgbWF0ZXJpYWxzW25hbWVdID0gbWF0ZXJpYWxzW25hbWVdIHx8IG5ldyBNYXRlcmlhbChtYXRlcmlhbE9wdGlvbnMpOwogICAgcmV0dXJuIG1hdGVyaWFsc1tuYW1lXTsKICB9OwoKICAvKioKICAgKiBAdHlwZWRlZiB7IGltcG9ydCgnY2Fubm9uLWVzJykuTWF0ZXJpYWxPcHRpb25zIH0gTWF0ZXJpYWxPcHRpb25zCiAgICovCgogIGNvbnN0IG1ha2VWZWMzID0gX3JlZiA9PiB7CiAgICBsZXQgW3gsIHksIHpdID0gX3JlZjsKICAgIHJldHVybiBuZXcgVmVjMyh4LCB5LCB6KTsKICB9OwogIGNvbnN0IHByZXBhcmVTcGhlcmUgPSBhcmdzID0+IEFycmF5LmlzQXJyYXkoYXJncykgPyBhcmdzIDogW2FyZ3NdOwogIGNvbnN0IHByZXBhcmVDb252ZXhQb2x5aGVkcm9uID0gX3JlZjIgPT4gewogICAgbGV0IFt2LCBmYWNlcywgbiwgYSwgYm91bmRpbmdTcGhlcmVSYWRpdXNdID0gX3JlZjI7CiAgICByZXR1cm4gW3sKICAgICAgYXhlczogYSA/IGEubWFwKG1ha2VWZWMzKSA6IHVuZGVmaW5lZCwKICAgICAgYm91bmRpbmdTcGhlcmVSYWRpdXMsCiAgICAgIGZhY2VzLAogICAgICBub3JtYWxzOiBuID8gbi5tYXAobWFrZVZlYzMpIDogdW5kZWZpbmVkLAogICAgICB2ZXJ0aWNlczogdiA/IHYubWFwKG1ha2VWZWMzKSA6IHVuZGVmaW5lZAogICAgfV07CiAgfTsKICBmdW5jdGlvbiBjcmVhdGVTaGFwZSh0eXBlLCBhcmdzKSB7CiAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgY2FzZSAnQm94JzoKICAgICAgICByZXR1cm4gbmV3IEJveChuZXcgVmVjMyguLi5hcmdzLm1hcCh2ID0+IHYgLyAyKSkpOwogICAgICAvLyBleHRlbnRzID0+IGhhbGZFeHRlbnRzCiAgICAgIGNhc2UgJ0NvbnZleFBvbHloZWRyb24nOgogICAgICAgIHJldHVybiBuZXcgQ29udmV4UG9seWhlZHJvbiguLi5wcmVwYXJlQ29udmV4UG9seWhlZHJvbihhcmdzKSk7CiAgICAgIGNhc2UgJ0N5bGluZGVyJzoKICAgICAgICByZXR1cm4gbmV3IEN5bGluZGVyKC4uLmFyZ3MpOwogICAgICAvLyBbIHJhZGl1c1RvcCwgcmFkaXVzQm90dG9tLCBoZWlnaHQsIG51bVNlZ21lbnRzIF0gPSBhcmdzCiAgICAgIGNhc2UgJ0hlaWdodGZpZWxkJzoKICAgICAgICByZXR1cm4gbmV3IEhlaWdodGZpZWxkKC4uLmFyZ3MpOwogICAgICAvLyBbIEFycmF5IGRhdGEsIG9wdGlvbnM6IHttaW5WYWx1ZSwgbWF4VmFsdWUsIGVsZW1lbnRTaXplfSAgXSA9IGFyZ3MKICAgICAgY2FzZSAnUGFydGljbGUnOgogICAgICAgIHJldHVybiBuZXcgUGFydGljbGUoKTsKICAgICAgLy8gbm8gYXJncwogICAgICBjYXNlICdQbGFuZSc6CiAgICAgICAgcmV0dXJuIG5ldyBQbGFuZSgpOwogICAgICAvLyBubyBhcmdzLCBpbmZpbml0ZSB4IGFuZCB5CiAgICAgIGNhc2UgJ1NwaGVyZSc6CiAgICAgICAgcmV0dXJuIG5ldyBTcGhlcmUoLi4ucHJlcGFyZVNwaGVyZShhcmdzKSk7CiAgICAgIC8vIHJhZGl1cyA9IGFyZ3MKICAgICAgY2FzZSAnVHJpbWVzaCc6CiAgICAgICAgcmV0dXJuIG5ldyBUcmltZXNoKC4uLmFyZ3MpOwogICAgICAvLyBbdmVydGljZXMsIGluZGljZXNdID0gYXJncwogICAgfQogIH0KCiAgLyoqCiAgICogQHBhcmFtIHtUSFJFRS5RdWF0ZXJuaW9ufSB0YXJnZXQKICAgKiBAcGFyYW0ge3sgcm90YXRpb24/OiBUSFJFRS5WZWN0b3IzVHVwbGUgcXVhdGVybmlvbj86IFRIUkVFLlZlY3RvcjRUdXBsZSB9fSBwcm9wcwogICAqIEByZXR1cm5zIHtUSFJFRS5RdWF0ZXJuaW9ufQogICAqLwogIGNvbnN0IHNldFF1YXRlcm5pb24gPSAodGFyZ2V0LCBfcmVmMykgPT4gewogICAgbGV0IHsKICAgICAgcXVhdGVybmlvbiwKICAgICAgcm90YXRpb24KICAgIH0gPSBfcmVmMzsKICAgIGlmIChxdWF0ZXJuaW9uKSB7CiAgICAgIHRhcmdldC5zZXQoLi4ucXVhdGVybmlvbik7CiAgICB9IGVsc2UgaWYgKHJvdGF0aW9uKSB7CiAgICAgIHRhcmdldC5zZXRGcm9tRXVsZXIoLi4ucm90YXRpb24pOwogICAgfQogICAgcmV0dXJuIHRhcmdldDsKICB9OwoKICAvKioKICAgKiBAZnVuY3Rpb24KICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucwogICAqIEBwYXJhbSB7c3RyaW5nfSBvcHRpb25zLnV1aWQKICAgKiBAcGFyYW0ge0JvZHlQcm9wc30gb3B0aW9ucy5wcm9wcwogICAqIEBwYXJhbSB7Qm9keVNoYXBlVHlwZX0gb3B0aW9ucy50eXBlCiAgICogQHBhcmFtIHsobWF0ZXJpYWxPcHRpb25zOiBNYXRlcmlhbE9wdGlvbnMpID0+IE1hdGVyaWFsID19IG9wdGlvbnMuY3JlYXRlTWF0ZXJpYWwKICAgKiBAcmV0dXJucyB7Qm9keX0KICAgKi8KICBjb25zdCBwcm9wc1RvQm9keSA9IG9wdGlvbnMgPT4gewogICAgY29uc3QgewogICAgICB1dWlkLAogICAgICBwcm9wcywKICAgICAgdHlwZSwKICAgICAgY3JlYXRlTWF0ZXJpYWwgPSBtYXRlcmlhbE9wdGlvbnMgPT4gbmV3IE1hdGVyaWFsKG1hdGVyaWFsT3B0aW9ucykKICAgIH0gPSBvcHRpb25zOwogICAgY29uc3QgewogICAgICBhbmd1bGFyRmFjdG9yID0gWzEsIDEsIDFdLAogICAgICBhbmd1bGFyVmVsb2NpdHkgPSBbMCwgMCwgMF0sCiAgICAgIGFyZ3MgPSBbXSwKICAgICAgY29sbGlzaW9uUmVzcG9uc2UsCiAgICAgIGxpbmVhckZhY3RvciA9IFsxLCAxLCAxXSwKICAgICAgbWFzcywKICAgICAgbWF0ZXJpYWwsCiAgICAgIG9uQ29sbGlkZSwKICAgICAgcG9zaXRpb24gPSBbMCwgMCwgMF0sCiAgICAgIHJvdGF0aW9uLAogICAgICBxdWF0ZXJuaW9uLAogICAgICBzaGFwZXMsCiAgICAgIHR5cGU6IGJvZHlUeXBlLAogICAgICB2ZWxvY2l0eSA9IFswLCAwLCAwXSwKICAgICAgLi4uZXh0cmEKICAgIH0gPSBwcm9wczsKICAgIGNvbnN0IGJvZHkgPSBuZXcgQm9keSh7CiAgICAgIC4uLmV4dHJhLAogICAgICBtYXNzOiBib2R5VHlwZSA9PT0gJ1N0YXRpYycgPyAwIDogbWFzcywKICAgICAgbWF0ZXJpYWw6IG1hdGVyaWFsID8gY3JlYXRlTWF0ZXJpYWwobWF0ZXJpYWwpIDogdW5kZWZpbmVkLAogICAgICB0eXBlOiBib2R5VHlwZSA/IEJvZHlbYm9keVR5cGUudG9VcHBlckNhc2UoKV0gOiB1bmRlZmluZWQKICAgIH0pOwogICAgYm9keS51dWlkID0gdXVpZDsKICAgIGlmIChjb2xsaXNpb25SZXNwb25zZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIGJvZHkuY29sbGlzaW9uUmVzcG9uc2UgPSBjb2xsaXNpb25SZXNwb25zZTsKICAgIH0KICAgIGlmICh0eXBlID09PSAnQ29tcG91bmQnKSB7CiAgICAgIHNoYXBlcy5mb3JFYWNoKF9yZWY0ID0+IHsKICAgICAgICBsZXQgewogICAgICAgICAgdHlwZSwKICAgICAgICAgIGFyZ3MsCiAgICAgICAgICBwb3NpdGlvbiwKICAgICAgICAgIHJvdGF0aW9uLAogICAgICAgICAgcXVhdGVybmlvbiwKICAgICAgICAgIG1hdGVyaWFsLAogICAgICAgICAgLi4uZXh0cmEKICAgICAgICB9ID0gX3JlZjQ7CiAgICAgICAgY29uc3Qgc2hhcGVCb2R5ID0gYm9keS5hZGRTaGFwZShjcmVhdGVTaGFwZSh0eXBlLCBhcmdzKSwgcG9zaXRpb24gPyBuZXcgVmVjMyguLi5wb3NpdGlvbikgOiB1bmRlZmluZWQsIHNldFF1YXRlcm5pb24obmV3IFF1YXRlcm5pb24oMCwgMCwgMCwgMSksIHsKICAgICAgICAgIHF1YXRlcm5pb24sCiAgICAgICAgICByb3RhdGlvbgogICAgICAgIH0pKTsKICAgICAgICBpZiAobWF0ZXJpYWwpIHNoYXBlQm9keS5tYXRlcmlhbCA9IGNyZWF0ZU1hdGVyaWFsKG1hdGVyaWFsKTsKICAgICAgICBPYmplY3QuYXNzaWduKHNoYXBlQm9keSwgZXh0cmEpOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGJvZHkuYWRkU2hhcGUoY3JlYXRlU2hhcGUodHlwZSwgYXJncykpOwogICAgfQogICAgYm9keS5wb3NpdGlvbi5zZXQocG9zaXRpb25bMF0sIHBvc2l0aW9uWzFdLCBwb3NpdGlvblsyXSk7CiAgICBib2R5LnZlbG9jaXR5LnNldCh2ZWxvY2l0eVswXSwgdmVsb2NpdHlbMV0sIHZlbG9jaXR5WzJdKTsKICAgIGJvZHkuYW5ndWxhclZlbG9jaXR5LnNldChhbmd1bGFyVmVsb2NpdHlbMF0sIGFuZ3VsYXJWZWxvY2l0eVsxXSwgYW5ndWxhclZlbG9jaXR5WzJdKTsKICAgIGJvZHkubGluZWFyRmFjdG9yLnNldChsaW5lYXJGYWN0b3JbMF0sIGxpbmVhckZhY3RvclsxXSwgbGluZWFyRmFjdG9yWzJdKTsKICAgIGJvZHkuYW5ndWxhckZhY3Rvci5zZXQoYW5ndWxhckZhY3RvclswXSwgYW5ndWxhckZhY3RvclsxXSwgYW5ndWxhckZhY3RvclsyXSk7CiAgICBzZXRRdWF0ZXJuaW9uKGJvZHkucXVhdGVybmlvbiwgewogICAgICBxdWF0ZXJuaW9uLAogICAgICByb3RhdGlvbgogICAgfSk7CiAgICByZXR1cm4gYm9keTsKICB9OwoKICBjb25zdCBhZGRCb2RpZXMgPSAoc3RhdGUsIGNyZWF0ZU1hdGVyaWFsLCBfcmVmKSA9PiB7CiAgICBsZXQgewogICAgICBwcm9wcywKICAgICAgdHlwZSwKICAgICAgdXVpZAogICAgfSA9IF9yZWY7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHV1aWQubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgYm9keSA9IHByb3BzVG9Cb2R5KHsKICAgICAgICBjcmVhdGVNYXRlcmlhbCwKICAgICAgICBwcm9wczogcHJvcHNbaV0sCiAgICAgICAgdHlwZSwKICAgICAgICB1dWlkOiB1dWlkW2ldCiAgICAgIH0pOwogICAgICBzdGF0ZS53b3JsZC5hZGRCb2R5KGJvZHkpOwogICAgICBpZiAocHJvcHNbaV0ub25Db2xsaWRlKSBib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2NvbGxpZGUnLCBfcmVmMiA9PiB7CiAgICAgICAgbGV0IHsKICAgICAgICAgIHR5cGUsCiAgICAgICAgICBib2R5LAogICAgICAgICAgdGFyZ2V0LAogICAgICAgICAgY29udGFjdAogICAgICAgIH0gPSBfcmVmMjsKICAgICAgICBpZiAoIWJvZHkudXVpZCB8fCAhdGFyZ2V0LnV1aWQpIHJldHVybjsKICAgICAgICBjb25zdCB7CiAgICAgICAgICBuaSwKICAgICAgICAgIHJpLAogICAgICAgICAgcmosCiAgICAgICAgICBiaSwKICAgICAgICAgIGJqLAogICAgICAgICAgaWQKICAgICAgICB9ID0gY29udGFjdDsKICAgICAgICBjb25zdCBjb250YWN0UG9pbnQgPSBiaS5wb3NpdGlvbi52YWRkKHJpKTsKICAgICAgICBjb25zdCBjb250YWN0Tm9ybWFsID0gYmkgPT09IGJvZHkgPyBuaSA6IG5pLnNjYWxlKC0xKTsKICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICAgIGJvZHk6IGJvZHkudXVpZCwKICAgICAgICAgIGNvbGxpc2lvbkZpbHRlcnM6IHsKICAgICAgICAgICAgYm9keUZpbHRlckdyb3VwOiBib2R5LmNvbGxpc2lvbkZpbHRlckdyb3VwLAogICAgICAgICAgICBib2R5RmlsdGVyTWFzazogYm9keS5jb2xsaXNpb25GaWx0ZXJNYXNrLAogICAgICAgICAgICB0YXJnZXRGaWx0ZXJHcm91cDogdGFyZ2V0LmNvbGxpc2lvbkZpbHRlckdyb3VwLAogICAgICAgICAgICB0YXJnZXRGaWx0ZXJNYXNrOiB0YXJnZXQuY29sbGlzaW9uRmlsdGVyTWFzawogICAgICAgICAgfSwKICAgICAgICAgIGNvbnRhY3Q6IHsKICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBUT0RPOiB1c2UgaWQgaW5zdGVhZCBvZiB1dWlkCiAgICAgICAgICAgIGJpOiBiaS51dWlkLAogICAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIFRPRE86IHVzZSBpZCBpbnN0ZWFkIG9mIHV1aWQKICAgICAgICAgICAgYmo6IGJqLnV1aWQsCiAgICAgICAgICAgIC8vIE5vcm1hbCBvZiB0aGUgY29udGFjdCwgcmVsYXRpdmUgdG8gdGhlIGNvbGxpZGluZyBib2R5CiAgICAgICAgICAgIGNvbnRhY3ROb3JtYWw6IGNvbnRhY3ROb3JtYWwudG9BcnJheSgpLAogICAgICAgICAgICAvLyBXb3JsZCBwb3NpdGlvbiBvZiB0aGUgY29udGFjdAogICAgICAgICAgICBjb250YWN0UG9pbnQ6IGNvbnRhY3RQb2ludC50b0FycmF5KCksCiAgICAgICAgICAgIGlkLAogICAgICAgICAgICBpbXBhY3RWZWxvY2l0eTogY29udGFjdC5nZXRJbXBhY3RWZWxvY2l0eUFsb25nTm9ybWFsKCksCiAgICAgICAgICAgIG5pOiBuaS50b0FycmF5KCksCiAgICAgICAgICAgIHJpOiByaS50b0FycmF5KCksCiAgICAgICAgICAgIHJqOiByai50b0FycmF5KCkKICAgICAgICAgIH0sCiAgICAgICAgICBvcDogJ2V2ZW50JywKICAgICAgICAgIHRhcmdldDogdGFyZ2V0LnV1aWQsCiAgICAgICAgICB0eXBlCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH07CgogIGNvbnN0IHRyaXBsZXRUb1ZlYzMgPSB0ID0+IHQgPyBuZXcgVmVjMyguLi50KSA6IHVuZGVmaW5lZDsKCiAgY29uc3QgYWRkQ29uc3RyYWludCA9IChzdGF0ZSwgX3JlZikgPT4gewogICAgbGV0IHsKICAgICAgcHJvcHM6IFtib2R5QSwgYm9keUIsIHsKICAgICAgICBhbmdsZSwKICAgICAgICBheGlzQSwKICAgICAgICBheGlzQiwKICAgICAgICBjb2xsaWRlQ29ubmVjdGVkLAogICAgICAgIGRpc3RhbmNlLAogICAgICAgIG1heEZvcmNlLAogICAgICAgIG1heE11bHRpcGxpZXIsCiAgICAgICAgcGl2b3RBLAogICAgICAgIHBpdm90QiwKICAgICAgICB0d2lzdEFuZ2xlLAogICAgICAgIHdha2VVcEJvZGllcwogICAgICB9XSwKICAgICAgdHlwZSwKICAgICAgdXVpZAogICAgfSA9IF9yZWY7CiAgICBsZXQgY29uc3RyYWludDsKICAgIHN3aXRjaCAodHlwZSkgewogICAgICBjYXNlICdQb2ludFRvUG9pbnQnOgogICAgICAgIGNvbnN0cmFpbnQgPSBuZXcgUG9pbnRUb1BvaW50Q29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCB0cmlwbGV0VG9WZWMzKHBpdm90QSksIHN0YXRlLmJvZGllc1tib2R5Ql0sIHRyaXBsZXRUb1ZlYzMocGl2b3RCKSwgbWF4Rm9yY2UpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdDb25lVHdpc3QnOgogICAgICAgIGNvbnN0cmFpbnQgPSBuZXcgQ29uZVR3aXN0Q29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCBzdGF0ZS5ib2RpZXNbYm9keUJdLCB7CiAgICAgICAgICBhbmdsZSwKICAgICAgICAgIGF4aXNBOiB0cmlwbGV0VG9WZWMzKGF4aXNBKSwKICAgICAgICAgIGF4aXNCOiB0cmlwbGV0VG9WZWMzKGF4aXNCKSwKICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQsCiAgICAgICAgICBtYXhGb3JjZSwKICAgICAgICAgIHBpdm90QTogdHJpcGxldFRvVmVjMyhwaXZvdEEpLAogICAgICAgICAgcGl2b3RCOiB0cmlwbGV0VG9WZWMzKHBpdm90QiksCiAgICAgICAgICB0d2lzdEFuZ2xlCiAgICAgICAgfSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ0hpbmdlJzoKICAgICAgICBjb25zdHJhaW50ID0gbmV3IEhpbmdlQ29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCBzdGF0ZS5ib2RpZXNbYm9keUJdLCB7CiAgICAgICAgICBheGlzQTogdHJpcGxldFRvVmVjMyhheGlzQSksCiAgICAgICAgICBheGlzQjogdHJpcGxldFRvVmVjMyhheGlzQiksCiAgICAgICAgICBjb2xsaWRlQ29ubmVjdGVkLAogICAgICAgICAgbWF4Rm9yY2UsCiAgICAgICAgICBwaXZvdEE6IHRyaXBsZXRUb1ZlYzMocGl2b3RBKSwKICAgICAgICAgIHBpdm90QjogdHJpcGxldFRvVmVjMyhwaXZvdEIpCiAgICAgICAgfSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ0Rpc3RhbmNlJzoKICAgICAgICBjb25zdHJhaW50ID0gbmV3IERpc3RhbmNlQ29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCBzdGF0ZS5ib2RpZXNbYm9keUJdLCBkaXN0YW5jZSwgbWF4Rm9yY2UpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdMb2NrJzoKICAgICAgICBjb25zdHJhaW50ID0gbmV3IExvY2tDb25zdHJhaW50KHN0YXRlLmJvZGllc1tib2R5QV0sIHN0YXRlLmJvZGllc1tib2R5Ql0sIHsKICAgICAgICAgIG1heEZvcmNlCiAgICAgICAgfSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgY29uc3RyYWludCA9IG5ldyBDb25zdHJhaW50KHN0YXRlLmJvZGllc1tib2R5QV0sIHN0YXRlLmJvZGllc1tib2R5Ql0sIHsKICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQsCiAgICAgICAgICB3YWtlVXBCb2RpZXMKICAgICAgICB9KTsKICAgICAgICBicmVhazsKICAgIH0KICAgIGNvbnN0cmFpbnQudXVpZCA9IHV1aWQ7CiAgICBzdGF0ZS53b3JsZC5hZGRDb25zdHJhaW50KGNvbnN0cmFpbnQpOwogICAgaWYgKG1heE11bHRpcGxpZXIgIT09IHVuZGVmaW5lZCkgewogICAgICBjb25zdCBwb3N0U3RlcENvbnN0cmFpbnQgPSAoKSA9PiB7CiAgICAgICAgLy8gVGhlIG11bHRpcGxpZXIgaXMgcHJvcG9ydGlvbmFsIHRvIGhvdyBtdWNoIGZvcmNlIGlzIGFkZGVkIHRvIHRoZSBib2RpZXMgYnkgdGhlIGNvbnN0cmFpbnQuCiAgICAgICAgLy8gSWYgdGhpcyBleGNlZWRzIGEgbGltaXQgdGhlIGNvbnN0cmFpbnQgaXMgZGlzYWJsZWQuCiAgICAgICAgY29uc3QgbXVsdGlwbGllciA9IE1hdGguYWJzKGNvbnN0cmFpbnQuZXF1YXRpb25zWzBdLm11bHRpcGxpZXIpOwogICAgICAgIGlmIChtdWx0aXBsaWVyID4gbWF4TXVsdGlwbGllcikgewogICAgICAgICAgY29uc3RyYWludC5kaXNhYmxlKCk7CiAgICAgICAgfQogICAgICB9OwogICAgICBzdGF0ZS5jb25zdHJhaW50c1t1dWlkXSA9IHBvc3RTdGVwQ29uc3RyYWludDsKICAgICAgc3RhdGUud29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBzdGF0ZS5jb25zdHJhaW50c1t1dWlkXSk7CiAgICB9CiAgfTsKCiAgZnVuY3Rpb24gdG9VcHBlcmNhc2Uoc3RyKSB7CiAgICByZXR1cm4gc3RyLnRvVXBwZXJDYXNlKCk7CiAgfQogIGNvbnN0IGFkZFJheSA9IChzdGF0ZSwgX3JlZikgPT4gewogICAgbGV0IHsKICAgICAgcHJvcHM6IHsKICAgICAgICBmcm9tLAogICAgICAgIG1vZGUsCiAgICAgICAgdG8sCiAgICAgICAgLi4ucmF5T3B0aW9ucwogICAgICB9LAogICAgICB1dWlkCiAgICB9ID0gX3JlZjsKICAgIGNvbnN0IHJheSA9IG5ldyBSYXkodHJpcGxldFRvVmVjMyhmcm9tKSwgdHJpcGxldFRvVmVjMyh0bykpOwogICAgY29uc3Qgb3B0aW9ucyA9IHsKICAgICAgbW9kZTogUkFZX01PREVTW3RvVXBwZXJjYXNlKG1vZGUpXSwKICAgICAgcmVzdWx0OiBuZXcgUmF5Y2FzdFJlc3VsdCgpLAogICAgICAuLi5yYXlPcHRpb25zCiAgICB9OwogICAgc3RhdGUucmF5c1t1dWlkXSA9ICgpID0+IHsKICAgICAgcmF5LmludGVyc2VjdFdvcmxkKHN0YXRlLndvcmxkLCBvcHRpb25zKTsKICAgICAgaWYgKCFvcHRpb25zLnJlc3VsdCB8fCAhb3B0aW9ucy5yZXN1bHQuYm9keSkgcmV0dXJuOwogICAgICBjb25zdCB7CiAgICAgICAgYm9keSwKICAgICAgICBzaGFwZSwKICAgICAgICByYXlGcm9tV29ybGQsCiAgICAgICAgcmF5VG9Xb3JsZCwKICAgICAgICBoaXROb3JtYWxXb3JsZCwKICAgICAgICBoaXRQb2ludFdvcmxkLAogICAgICAgIC4uLnJlc3QKICAgICAgfSA9IG9wdGlvbnMucmVzdWx0OwogICAgICBjb25zdCBib2R5VVVJRCA9IGJvZHkudXVpZDsKICAgICAgaWYgKCFib2R5VVVJRCkgcmV0dXJuOwogICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICBib2R5OiBib2R5VVVJRCwKICAgICAgICBoaXROb3JtYWxXb3JsZDogaGl0Tm9ybWFsV29ybGQudG9BcnJheSgpLAogICAgICAgIGhpdFBvaW50V29ybGQ6IGhpdFBvaW50V29ybGQudG9BcnJheSgpLAogICAgICAgIG9wOiAnZXZlbnQnLAogICAgICAgIHJheTogewogICAgICAgICAgY29sbGlzaW9uRmlsdGVyR3JvdXA6IHJheS5jb2xsaXNpb25GaWx0ZXJHcm91cCwKICAgICAgICAgIGNvbGxpc2lvbkZpbHRlck1hc2s6IHJheS5jb2xsaXNpb25GaWx0ZXJNYXNrLAogICAgICAgICAgZGlyZWN0aW9uOiByYXkuZGlyZWN0aW9uLnRvQXJyYXkoKSwKICAgICAgICAgIGZyb20sCiAgICAgICAgICB0bywKICAgICAgICAgIHV1aWQKICAgICAgICB9LAogICAgICAgIHJheUZyb21Xb3JsZDogcmF5RnJvbVdvcmxkLnRvQXJyYXkoKSwKICAgICAgICByYXlUb1dvcmxkOiByYXlUb1dvcmxkLnRvQXJyYXkoKSwKICAgICAgICBzaGFwZTogc2hhcGUgPyB7CiAgICAgICAgICAuLi5zaGFwZSwKICAgICAgICAgIGJvZHk6IGJvZHlVVUlECiAgICAgICAgfSA6IG51bGwsCiAgICAgICAgdHlwZTogJ3JheWhpdCcsCiAgICAgICAgLi4ucmVzdAogICAgICB9KTsKICAgIH07CiAgICBzdGF0ZS53b3JsZC5hZGRFdmVudExpc3RlbmVyKCdwcmVTdGVwJywgc3RhdGUucmF5c1t1dWlkXSk7CiAgfTsKCiAgY29uc3QgYWRkUmF5Y2FzdFZlaGljbGUgPSAoc3RhdGUsIGRhdGEpID0+IHsKICAgIGNvbnN0IFtjaGFzc2lzQm9keSwgd2hlZWxzLCB3aGVlbEluZm9zLCBpbmRleEZvcndhcmRBeGlzLCBpbmRleFJpZ2h0QXhpcywgaW5kZXhVcEF4aXNdID0gZGF0YS5wcm9wczsKICAgIGNvbnN0IHZlaGljbGUgPSBuZXcgUmF5Y2FzdFZlaGljbGUoewogICAgICBjaGFzc2lzQm9keTogc3RhdGUuYm9kaWVzW2NoYXNzaXNCb2R5XSwKICAgICAgaW5kZXhGb3J3YXJkQXhpcywKICAgICAgaW5kZXhSaWdodEF4aXMsCiAgICAgIGluZGV4VXBBeGlzCiAgICB9KTsKICAgIHZlaGljbGUud29ybGQgPSBzdGF0ZS53b3JsZDsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgd2hlZWxJbmZvcy5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCB7CiAgICAgICAgYXhsZUxvY2FsLAogICAgICAgIGNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbCwKICAgICAgICBkaXJlY3Rpb25Mb2NhbCwKICAgICAgICAuLi5yZXN0CiAgICAgIH0gPSB3aGVlbEluZm9zW2ldOwogICAgICB2ZWhpY2xlLmFkZFdoZWVsKHsKICAgICAgICBheGxlTG9jYWw6IHRyaXBsZXRUb1ZlYzMoYXhsZUxvY2FsKSwKICAgICAgICBjaGFzc2lzQ29ubmVjdGlvblBvaW50TG9jYWw6IHRyaXBsZXRUb1ZlYzMoY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludExvY2FsKSwKICAgICAgICBkaXJlY3Rpb25Mb2NhbDogdHJpcGxldFRvVmVjMyhkaXJlY3Rpb25Mb2NhbCksCiAgICAgICAgLi4ucmVzdAogICAgICB9KTsKICAgIH0KICAgIGNvbnN0IHByZVN0ZXAgPSAoKSA9PiB7CiAgICAgIHZlaGljbGUudXBkYXRlVmVoaWNsZShzdGF0ZS53b3JsZC5kdCk7CiAgICB9OwogICAgY29uc3QgcG9zdFN0ZXAgPSAoKSA9PiB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmVoaWNsZS53aGVlbEluZm9zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmVoaWNsZS51cGRhdGVXaGVlbFRyYW5zZm9ybShpKTsKICAgICAgICBjb25zdCB0ID0gdmVoaWNsZS53aGVlbEluZm9zW2ldLndvcmxkVHJhbnNmb3JtOwogICAgICAgIGNvbnN0IHdoZWVsQm9keSA9IHN0YXRlLmJvZGllc1t3aGVlbHNbaV1dOwogICAgICAgIHdoZWVsQm9keS5wb3NpdGlvbi5jb3B5KHQucG9zaXRpb24pOwogICAgICAgIHdoZWVsQm9keS5xdWF0ZXJuaW9uLmNvcHkodC5xdWF0ZXJuaW9uKTsKICAgICAgfQogICAgfTsKICAgIHN0YXRlLnZlaGljbGVzW2RhdGEudXVpZF0gPSB7CiAgICAgIHBvc3RTdGVwLAogICAgICBwcmVTdGVwLAogICAgICB2ZWhpY2xlCiAgICB9OwogICAgc3RhdGUud29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncHJlU3RlcCcsIHByZVN0ZXApOwogICAgc3RhdGUud29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBwb3N0U3RlcCk7CiAgfTsKCiAgY29uc3QgYWRkU3ByaW5nID0gKHN0YXRlLCBfcmVmKSA9PiB7CiAgICBsZXQgewogICAgICBwcm9wczogW2JvZHlBLCBib2R5QiwgewogICAgICAgIGRhbXBpbmcsCiAgICAgICAgbG9jYWxBbmNob3JBLAogICAgICAgIGxvY2FsQW5jaG9yQiwKICAgICAgICByZXN0TGVuZ3RoLAogICAgICAgIHN0aWZmbmVzcywKICAgICAgICB3b3JsZEFuY2hvckEsCiAgICAgICAgd29ybGRBbmNob3JCCiAgICAgIH1dLAogICAgICB1dWlkCiAgICB9ID0gX3JlZjsKICAgIGNvbnN0IHNwcmluZyA9IG5ldyBTcHJpbmcoc3RhdGUuYm9kaWVzW2JvZHlBXSwgc3RhdGUuYm9kaWVzW2JvZHlCXSwgewogICAgICBkYW1waW5nLAogICAgICBsb2NhbEFuY2hvckE6IHRyaXBsZXRUb1ZlYzMobG9jYWxBbmNob3JBKSwKICAgICAgbG9jYWxBbmNob3JCOiB0cmlwbGV0VG9WZWMzKGxvY2FsQW5jaG9yQiksCiAgICAgIHJlc3RMZW5ndGgsCiAgICAgIHN0aWZmbmVzcywKICAgICAgd29ybGRBbmNob3JBOiB0cmlwbGV0VG9WZWMzKHdvcmxkQW5jaG9yQSksCiAgICAgIHdvcmxkQW5jaG9yQjogdHJpcGxldFRvVmVjMyh3b3JsZEFuY2hvckIpCiAgICB9KTsKICAgIHNwcmluZy51dWlkID0gdXVpZDsKICAgIGNvbnN0IHBvc3RTdGVwU3ByaW5nID0gKCkgPT4gc3ByaW5nLmFwcGx5Rm9yY2UoKTsKICAgIHN0YXRlLnNwcmluZ3NbdXVpZF0gPSBwb3N0U3RlcFNwcmluZzsKICAgIHN0YXRlLnNwcmluZ0luc3RhbmNlc1t1dWlkXSA9IHNwcmluZzsKCiAgICAvLyBDb21wdXRlIHRoZSBmb3JjZSBhZnRlciBlYWNoIHN0ZXAKICAgIHN0YXRlLndvcmxkLmFkZEV2ZW50TGlzdGVuZXIoJ3Bvc3RTdGVwJywgc3RhdGUuc3ByaW5nc1t1dWlkXSk7CiAgfTsKCiAgZnVuY3Rpb24gZW1pdEJlZ2luQ29udGFjdChfcmVmKSB7CiAgICBsZXQgewogICAgICBib2R5QSwKICAgICAgYm9keUIKICAgIH0gPSBfcmVmOwogICAgaWYgKCEoYm9keUEgIT0gbnVsbCAmJiBib2R5QS51dWlkKSB8fCAhKGJvZHlCICE9IG51bGwgJiYgYm9keUIudXVpZCkpIHJldHVybjsKICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICBib2R5QTogYm9keUEudXVpZCwKICAgICAgYm9keUI6IGJvZHlCLnV1aWQsCiAgICAgIG9wOiAnZXZlbnQnLAogICAgICB0eXBlOiAnY29sbGlkZUJlZ2luJwogICAgfSk7CiAgfQogIGZ1bmN0aW9uIGVtaXRFbmRDb250YWN0KF9yZWYyKSB7CiAgICBsZXQgewogICAgICBib2R5QSwKICAgICAgYm9keUIKICAgIH0gPSBfcmVmMjsKICAgIGlmICghKGJvZHlBICE9IG51bGwgJiYgYm9keUEudXVpZCkgfHwgIShib2R5QiAhPSBudWxsICYmIGJvZHlCLnV1aWQpKSByZXR1cm47CiAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgYm9keUE6IGJvZHlBLnV1aWQsCiAgICAgIGJvZHlCOiBib2R5Qi51dWlkLAogICAgICBvcDogJ2V2ZW50JywKICAgICAgdHlwZTogJ2NvbGxpZGVFbmQnCiAgICB9KTsKICB9CiAgY29uc3QgaW5pdCA9ICh3b3JsZCwgX3JlZjMpID0+IHsKICAgIGxldCB7CiAgICAgIGFsbG93U2xlZXAsCiAgICAgIGF4aXNJbmRleCA9IDAsCiAgICAgIGJyb2FkcGhhc2UsCiAgICAgIGRlZmF1bHRDb250YWN0TWF0ZXJpYWwsCiAgICAgIGZyaWN0aW9uR3Jhdml0eSwKICAgICAgZ3Jhdml0eSwKICAgICAgaXRlcmF0aW9ucywKICAgICAgcXVhdE5vcm1hbGl6ZUZhc3QsCiAgICAgIHF1YXROb3JtYWxpemVTa2lwLAogICAgICBzb2x2ZXIsCiAgICAgIHRvbGVyYW5jZQogICAgfSA9IF9yZWYzOwogICAgd29ybGQuYWxsb3dTbGVlcCA9IGFsbG93U2xlZXA7CiAgICB3b3JsZC5ncmF2aXR5LnNldCguLi5ncmF2aXR5KTsKICAgIHdvcmxkLmZyaWN0aW9uR3Jhdml0eSA9IGZyaWN0aW9uR3Jhdml0eSA/IG5ldyBWZWMzKC4uLmZyaWN0aW9uR3Jhdml0eSkgOiB1bmRlZmluZWQ7CiAgICB3b3JsZC5xdWF0Tm9ybWFsaXplRmFzdCA9IHF1YXROb3JtYWxpemVGYXN0OwogICAgd29ybGQucXVhdE5vcm1hbGl6ZVNraXAgPSBxdWF0Tm9ybWFsaXplU2tpcDsKICAgIGlmIChzb2x2ZXIgPT09ICdTcGxpdCcpIHsKICAgICAgd29ybGQuc29sdmVyID0gbmV3IFNwbGl0U29sdmVyKG5ldyBHU1NvbHZlcigpKTsKICAgIH0KICAgIGlmICh3b3JsZC5zb2x2ZXIgaW5zdGFuY2VvZiBHU1NvbHZlcikgewogICAgICB3b3JsZC5zb2x2ZXIudG9sZXJhbmNlID0gdG9sZXJhbmNlOwogICAgICB3b3JsZC5zb2x2ZXIuaXRlcmF0aW9ucyA9IGl0ZXJhdGlvbnM7CiAgICB9CiAgICB3b3JsZC5icm9hZHBoYXNlID0gYnJvYWRwaGFzZSA9PT0gJ1NBUCcgPyBuZXcgU0FQQnJvYWRwaGFzZSh3b3JsZCkgOiBuZXcgTmFpdmVCcm9hZHBoYXNlKCk7CiAgICBpZiAod29ybGQuYnJvYWRwaGFzZSBpbnN0YW5jZW9mIFNBUEJyb2FkcGhhc2UpIHsKICAgICAgd29ybGQuYnJvYWRwaGFzZS5heGlzSW5kZXggPSBheGlzSW5kZXg7CiAgICB9CiAgICB3b3JsZC5hZGRFdmVudExpc3RlbmVyKCdiZWdpbkNvbnRhY3QnLCBlbWl0QmVnaW5Db250YWN0KTsKICAgIHdvcmxkLmFkZEV2ZW50TGlzdGVuZXIoJ2VuZENvbnRhY3QnLCBlbWl0RW5kQ29udGFjdCk7CiAgICBPYmplY3QuYXNzaWduKHdvcmxkLmRlZmF1bHRDb250YWN0TWF0ZXJpYWwsIGRlZmF1bHRDb250YWN0TWF0ZXJpYWwpOwogIH07CgogIGNvbnN0IGlzUW9yViA9IHYgPT4gdiBpbnN0YW5jZW9mIFF1YXRlcm5pb24gfHwgdiBpbnN0YW5jZW9mIFZlYzM7CiAgY29uc3Qgc3RlcCA9IChzdGF0ZSwgX3JlZikgPT4gewogICAgbGV0IHsKICAgICAgcG9zaXRpb25zLAogICAgICBwcm9wczogewogICAgICAgIG1heFN1YlN0ZXBzLAogICAgICAgIHN0ZXBTaXplLAogICAgICAgIHRpbWVTaW5jZUxhc3RDYWxsZWQKICAgICAgfSwKICAgICAgcXVhdGVybmlvbnMKICAgIH0gPSBfcmVmOwogICAgc3RhdGUud29ybGQuc3RlcChzdGVwU2l6ZSwgdGltZVNpbmNlTGFzdENhbGxlZCwgbWF4U3ViU3RlcHMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdGF0ZS53b3JsZC5ib2RpZXMubGVuZ3RoOyBpICs9IDEpIHsKICAgICAgY29uc3QgcCA9IHN0YXRlLndvcmxkLmJvZGllc1tpXS5wb3NpdGlvbjsKICAgICAgY29uc3QgcSA9IHN0YXRlLndvcmxkLmJvZGllc1tpXS5xdWF0ZXJuaW9uOwogICAgICBwb3NpdGlvbnNbMyAqIGkgKyAwXSA9IHAueDsKICAgICAgcG9zaXRpb25zWzMgKiBpICsgMV0gPSBwLnk7CiAgICAgIHBvc2l0aW9uc1szICogaSArIDJdID0gcC56OwogICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDBdID0gcS54OwogICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDFdID0gcS55OwogICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDJdID0gcS56OwogICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDNdID0gcS53OwogICAgfQogICAgY29uc3Qgb2JzZXJ2YXRpb25zID0gW107CiAgICBmb3IgKGNvbnN0IGlkIG9mIE9iamVjdC5rZXlzKHN0YXRlLnN1YnNjcmlwdGlvbnMpKSB7CiAgICAgIGNvbnN0IFt1dWlkLCB0eXBlLCB0YXJnZXQgPSAnYm9kaWVzJ10gPSBzdGF0ZS5zdWJzY3JpcHRpb25zW2lkXTsKICAgICAgY29uc3QgewogICAgICAgIGJvZGllcywKICAgICAgICB2ZWhpY2xlcwogICAgICB9ID0gc3RhdGU7CiAgICAgIGNvbnN0IHZhbHVlID0gdGFyZ2V0ID09PSAndmVoaWNsZXMnID8KICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBUT0RPOiBEaWZmZXJlbnRpYXRlIHRoZXNlICJ0eXBlcyIKICAgICAgdmVoaWNsZXNbdXVpZF0udmVoaWNsZVt0eXBlXSA6CiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgVE9ETzogRGlmZmVyZW50aWF0ZSB0aGVzZSAidHlwZXMiCiAgICAgIGJvZGllc1t1dWlkXVt0eXBlXTsKICAgICAgY29uc3Qgc2VyaWFsaXphYmxlVmFsdWUgPSBpc1FvclYodmFsdWUpID8gdmFsdWUudG9BcnJheSgpIDogdmFsdWU7CiAgICAgIG9ic2VydmF0aW9ucy5wdXNoKFtOdW1iZXIoaWQpLCBzZXJpYWxpemFibGVWYWx1ZSwKICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBUT0RPOiBEaWZmZXJlbnRpYXRlIHRoZXNlICJ0eXBlcyIKICAgICAgdHlwZV0pOwogICAgfQogICAgY29uc3QgbWVzc2FnZSA9IHsKICAgICAgYWN0aXZlOiBzdGF0ZS53b3JsZC5oYXNBY3RpdmVCb2RpZXMsCiAgICAgIG9ic2VydmF0aW9ucywKICAgICAgb3A6ICdmcmFtZScsCiAgICAgIHBvc2l0aW9ucywKICAgICAgcXVhdGVybmlvbnMKICAgIH07CiAgICBpZiAoc3RhdGUuYm9kaWVzTmVlZFN5bmNpbmcpIHsKICAgICAgbWVzc2FnZS5ib2RpZXMgPSBzdGF0ZS53b3JsZC5ib2RpZXMucmVkdWNlKChib2RpZXMsIGJvZHkpID0+IHsKICAgICAgICBpZiAoYm9keS51dWlkKSBib2RpZXMucHVzaChib2R5LnV1aWQpOwogICAgICAgIHJldHVybiBib2RpZXM7CiAgICAgIH0sIFtdKTsKICAgICAgc3RhdGUuYm9kaWVzTmVlZFN5bmNpbmcgPSBmYWxzZTsKICAgIH0KICAgIHNlbGYucG9zdE1lc3NhZ2UobWVzc2FnZSwgW3Bvc2l0aW9ucy5idWZmZXIsIHF1YXRlcm5pb25zLmJ1ZmZlcl0pOwogIH07CgogIGNvbnN0IHN0YXRlID0gewogICAgYm9kaWVzOiB7fSwKICAgIGJvZGllc05lZWRTeW5jaW5nOiBmYWxzZSwKICAgIGNvbnN0cmFpbnRzOiB7fSwKICAgIG1hdGVyaWFsczoge30sCiAgICByYXlzOiB7fSwKICAgIHNwcmluZ0luc3RhbmNlczoge30sCiAgICBzcHJpbmdzOiB7fSwKICAgIHN1YnNjcmlwdGlvbnM6IHt9LAogICAgdmVoaWNsZXM6IHt9LAogICAgd29ybGQ6IG5ldyBXb3JsZCgpCiAgfTsKCiAgLy8vIDxyZWZlcmVuY2Ugbm8tZGVmYXVsdC1saWI9InRydWUiLz4KICBjb25zdCBpc0hpbmdlQ29uc3RyYWludCA9IGMgPT4gYyBpbnN0YW5jZW9mIEhpbmdlQ29uc3RyYWludDsKICBmdW5jdGlvbiBzeW5jQm9kaWVzKCkgewogICAgc3RhdGUuYm9kaWVzTmVlZFN5bmNpbmcgPSB0cnVlOwogICAgc3RhdGUuYm9kaWVzID0gc3RhdGUud29ybGQuYm9kaWVzLnJlZHVjZSgoYm9kaWVzLCBib2R5KSA9PiBib2R5LnV1aWQgPyB7CiAgICAgIC4uLmJvZGllcywKICAgICAgW2JvZHkudXVpZF06IGJvZHkKICAgIH0gOiBib2RpZXMsIHt9KTsKICB9CiAgY29uc3QgYnJvYWRwaGFzZXMgPSB7CiAgICBOYWl2ZUJyb2FkcGhhc2UsCiAgICBTQVBCcm9hZHBoYXNlCiAgfTsKICBjb25zdCBjcmVhdGVNYXRlcmlhbCA9IGNyZWF0ZU1hdGVyaWFsRmFjdG9yeShzdGF0ZS5tYXRlcmlhbHMpOwogIHNlbGYub25tZXNzYWdlID0gX3JlZiA9PiB7CiAgICBsZXQgewogICAgICBkYXRhCiAgICB9ID0gX3JlZjsKICAgIHN3aXRjaCAoZGF0YS5vcCkgewogICAgICBjYXNlICdpbml0JzoKICAgICAgICB7CiAgICAgICAgICBpbml0KHN0YXRlLndvcmxkLCBkYXRhLnByb3BzKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnc3RlcCc6CiAgICAgICAgewogICAgICAgICAgc3RlcChzdGF0ZSwgZGF0YSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ2FkZEJvZGllcyc6CiAgICAgICAgewogICAgICAgICAgYWRkQm9kaWVzKHN0YXRlLCBjcmVhdGVNYXRlcmlhbCwgZGF0YSk7CiAgICAgICAgICBzeW5jQm9kaWVzKCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3JlbW92ZUJvZGllcyc6CiAgICAgICAgewogICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLnV1aWQubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgc3RhdGUud29ybGQucmVtb3ZlQm9keShzdGF0ZS5ib2RpZXNbZGF0YS51dWlkW2ldXSk7CiAgICAgICAgICAgIGNvbnN0IGtleSA9IE9iamVjdC5rZXlzKHN0YXRlLnN1YnNjcmlwdGlvbnMpLmZpbmQoayA9PiBzdGF0ZS5zdWJzY3JpcHRpb25zW2tdWzBdID09PSBkYXRhLnV1aWRbaV0pOwogICAgICAgICAgICBpZiAoa2V5KSB7CiAgICAgICAgICAgICAgZGVsZXRlIHN0YXRlLnN1YnNjcmlwdGlvbnNba2V5XTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgc3luY0JvZGllcygpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdzdWJzY3JpYmUnOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IHsKICAgICAgICAgICAgaWQsCiAgICAgICAgICAgIHRhcmdldCwKICAgICAgICAgICAgdHlwZQogICAgICAgICAgfSA9IGRhdGEucHJvcHM7CiAgICAgICAgICBzdGF0ZS5zdWJzY3JpcHRpb25zW2lkXSA9IFtkYXRhLnV1aWQsIHR5cGUsIHRhcmdldF07CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3Vuc3Vic2NyaWJlJzoKICAgICAgICB7CiAgICAgICAgICBkZWxldGUgc3RhdGUuc3Vic2NyaXB0aW9uc1tkYXRhLnByb3BzXTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnc2V0UG9zaXRpb24nOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLnBvc2l0aW9uLnNldChkYXRhLnByb3BzWzBdLCBkYXRhLnByb3BzWzFdLCBkYXRhLnByb3BzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0UXVhdGVybmlvbic6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0ucXVhdGVybmlvbi5zZXQoZGF0YS5wcm9wc1swXSwgZGF0YS5wcm9wc1sxXSwgZGF0YS5wcm9wc1syXSwgZGF0YS5wcm9wc1szXSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldFJvdGF0aW9uJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5xdWF0ZXJuaW9uLnNldEZyb21FdWxlcihkYXRhLnByb3BzWzBdLCBkYXRhLnByb3BzWzFdLCBkYXRhLnByb3BzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0VmVsb2NpdHknOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLnZlbG9jaXR5LnNldChkYXRhLnByb3BzWzBdLCBkYXRhLnByb3BzWzFdLCBkYXRhLnByb3BzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0QW5ndWxhclZlbG9jaXR5JzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5hbmd1bGFyVmVsb2NpdHkuc2V0KGRhdGEucHJvcHNbMF0sIGRhdGEucHJvcHNbMV0sIGRhdGEucHJvcHNbMl0pOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRMaW5lYXJGYWN0b3InOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmxpbmVhckZhY3Rvci5zZXQoZGF0YS5wcm9wc1swXSwgZGF0YS5wcm9wc1sxXSwgZGF0YS5wcm9wc1syXSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldEFuZ3VsYXJGYWN0b3InOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmFuZ3VsYXJGYWN0b3Iuc2V0KGRhdGEucHJvcHNbMF0sIGRhdGEucHJvcHNbMV0sIGRhdGEucHJvcHNbMl0pOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRNYXNzJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5tYXNzID0gZGF0YS5wcm9wczsKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS51cGRhdGVNYXNzUHJvcGVydGllcygpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRNYXRlcmlhbCc6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0ubWF0ZXJpYWwgPSBkYXRhLnByb3BzID8gY3JlYXRlTWF0ZXJpYWwoZGF0YS5wcm9wcykgOiBudWxsOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRMaW5lYXJEYW1waW5nJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5saW5lYXJEYW1waW5nID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0QW5ndWxhckRhbXBpbmcnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmFuZ3VsYXJEYW1waW5nID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0QWxsb3dTbGVlcCc6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0uYWxsb3dTbGVlcCA9IGRhdGEucHJvcHM7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldFNsZWVwU3BlZWRMaW1pdCc6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0uc2xlZXBTcGVlZExpbWl0ID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0U2xlZXBUaW1lTGltaXQnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLnNsZWVwVGltZUxpbWl0ID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0Q29sbGlzaW9uRmlsdGVyR3JvdXAnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmNvbGxpc2lvbkZpbHRlckdyb3VwID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0Q29sbGlzaW9uRmlsdGVyTWFzayc6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0uY29sbGlzaW9uRmlsdGVyTWFzayA9IGRhdGEucHJvcHM7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldENvbGxpc2lvblJlc3BvbnNlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5jb2xsaXNpb25SZXNwb25zZSA9IGRhdGEucHJvcHM7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldEZpeGVkUm90YXRpb24nOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmZpeGVkUm90YXRpb24gPSBkYXRhLnByb3BzOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRGcmljdGlvbkdyYXZpdHknOgogICAgICAgIHN0YXRlLndvcmxkLmZyaWN0aW9uR3Jhdml0eSA9IGRhdGEucHJvcHMgPyBuZXcgVmVjMyguLi5kYXRhLnByb3BzKSA6IHVuZGVmaW5lZDsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0SXNUcmlnZ2VyJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5pc1RyaWdnZXIgPSBkYXRhLnByb3BzOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRHcmF2aXR5JzoKICAgICAgICBzdGF0ZS53b3JsZC5ncmF2aXR5LnNldChkYXRhLnByb3BzWzBdLCBkYXRhLnByb3BzWzFdLCBkYXRhLnByb3BzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0VG9sZXJhbmNlJzoKICAgICAgICBpZiAoc3RhdGUud29ybGQuc29sdmVyIGluc3RhbmNlb2YgR1NTb2x2ZXIpIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnNvbHZlci50b2xlcmFuY2UgPSBkYXRhLnByb3BzOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0SXRlcmF0aW9ucyc6CiAgICAgICAgaWYgKHN0YXRlLndvcmxkLnNvbHZlciBpbnN0YW5jZW9mIEdTU29sdmVyKSB7CiAgICAgICAgICBzdGF0ZS53b3JsZC5zb2x2ZXIuaXRlcmF0aW9ucyA9IGRhdGEucHJvcHM7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRCcm9hZHBoYXNlJzoKICAgICAgICBzdGF0ZS53b3JsZC5icm9hZHBoYXNlID0gbmV3IChicm9hZHBoYXNlc1tgJHtkYXRhLnByb3BzfUJyb2FkcGhhc2VgXSB8fCBOYWl2ZUJyb2FkcGhhc2UpKHN0YXRlLndvcmxkKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0QXhpc0luZGV4JzoKICAgICAgICBpZiAoc3RhdGUud29ybGQuYnJvYWRwaGFzZSBpbnN0YW5jZW9mIFNBUEJyb2FkcGhhc2UpIHsKICAgICAgICAgIHN0YXRlLndvcmxkLmJyb2FkcGhhc2UuYXhpc0luZGV4ID0gZGF0YS5wcm9wcyA9PT0gdW5kZWZpbmVkIHx8IGRhdGEucHJvcHMgPT09IG51bGwgPyAwIDogZGF0YS5wcm9wczsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ2FwcGx5Rm9yY2UnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmFwcGx5Rm9yY2UobmV3IFZlYzMoLi4uZGF0YS5wcm9wc1swXSksIG5ldyBWZWMzKC4uLmRhdGEucHJvcHNbMV0pKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnYXBwbHlJbXB1bHNlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5hcHBseUltcHVsc2UobmV3IFZlYzMoLi4uZGF0YS5wcm9wc1swXSksIG5ldyBWZWMzKC4uLmRhdGEucHJvcHNbMV0pKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnYXBwbHlMb2NhbEZvcmNlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5hcHBseUxvY2FsRm9yY2UobmV3IFZlYzMoLi4uZGF0YS5wcm9wc1swXSksIG5ldyBWZWMzKC4uLmRhdGEucHJvcHNbMV0pKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnYXBwbHlMb2NhbEltcHVsc2UnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmFwcGx5TG9jYWxJbXB1bHNlKG5ldyBWZWMzKC4uLmRhdGEucHJvcHNbMF0pLCBuZXcgVmVjMyguLi5kYXRhLnByb3BzWzFdKSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ2FwcGx5VG9ycXVlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5hcHBseVRvcnF1ZShuZXcgVmVjMyguLi5kYXRhLnByb3BzWzBdKSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ2FkZENvbnN0cmFpbnQnOgogICAgICAgIHsKICAgICAgICAgIGFkZENvbnN0cmFpbnQoc3RhdGUsIGRhdGEpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdyZW1vdmVDb25zdHJhaW50JzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoX3JlZjIgPT4gewogICAgICAgICAgbGV0IHsKICAgICAgICAgICAgdXVpZAogICAgICAgICAgfSA9IF9yZWYyOwogICAgICAgICAgcmV0dXJuIHV1aWQgPT09IGRhdGEudXVpZDsKICAgICAgICB9KS5tYXAoYyA9PiBzdGF0ZS53b3JsZC5yZW1vdmVDb25zdHJhaW50KGMpKTsKICAgICAgICBpZiAoc3RhdGUuY29uc3RyYWludHNbZGF0YS51dWlkXSkgewogICAgICAgICAgc3RhdGUud29ybGQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBzdGF0ZS5jb25zdHJhaW50c1tkYXRhLnV1aWRdKTsKICAgICAgICAgIGRlbGV0ZSBzdGF0ZS5jb25zdHJhaW50c1tkYXRhLnV1aWRdOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSAnZW5hYmxlQ29uc3RyYWludCc6CiAgICAgICAgc3RhdGUud29ybGQuY29uc3RyYWludHMuZmlsdGVyKGMgPT4gYy51dWlkID09PSBkYXRhLnV1aWQpLm1hcChjID0+IGMuZW5hYmxlKCkpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdkaXNhYmxlQ29uc3RyYWludCc6CiAgICAgICAgc3RhdGUud29ybGQuY29uc3RyYWludHMuZmlsdGVyKGMgPT4gYy51dWlkID09PSBkYXRhLnV1aWQpLm1hcChjID0+IGMuZGlzYWJsZSgpKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnZW5hYmxlQ29uc3RyYWludE1vdG9yJzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoYyA9PiBjLnV1aWQgPT09IGRhdGEudXVpZCkuZmlsdGVyKGlzSGluZ2VDb25zdHJhaW50KS5tYXAoYyA9PiBjLmVuYWJsZU1vdG9yKCkpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdkaXNhYmxlQ29uc3RyYWludE1vdG9yJzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoYyA9PiBjLnV1aWQgPT09IGRhdGEudXVpZCkuZmlsdGVyKGlzSGluZ2VDb25zdHJhaW50KS5tYXAoYyA9PiBjLmRpc2FibGVNb3RvcigpKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0Q29uc3RyYWludE1vdG9yU3BlZWQnOgogICAgICAgIHN0YXRlLndvcmxkLmNvbnN0cmFpbnRzLmZpbHRlcihjID0+IGMudXVpZCA9PT0gZGF0YS51dWlkKS5maWx0ZXIoaXNIaW5nZUNvbnN0cmFpbnQpLm1hcChjID0+IGMuc2V0TW90b3JTcGVlZChkYXRhLnByb3BzKSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldENvbnN0cmFpbnRNb3Rvck1heEZvcmNlJzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoYyA9PiBjLnV1aWQgPT09IGRhdGEudXVpZCkuZmlsdGVyKGlzSGluZ2VDb25zdHJhaW50KS5tYXAoYyA9PiBjLnNldE1vdG9yTWF4Rm9yY2UoZGF0YS5wcm9wcykpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdhZGRTcHJpbmcnOgogICAgICAgIHsKICAgICAgICAgIGFkZFNwcmluZyhzdGF0ZSwgZGF0YSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3NldFNwcmluZ1N0aWZmbmVzcyc6CiAgICAgICAgewogICAgICAgICAgc3RhdGUuc3ByaW5nSW5zdGFuY2VzW2RhdGEudXVpZF0uc3RpZmZuZXNzID0gZGF0YS5wcm9wczsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnc2V0U3ByaW5nUmVzdExlbmd0aCc6CiAgICAgICAgewogICAgICAgICAgc3RhdGUuc3ByaW5nSW5zdGFuY2VzW2RhdGEudXVpZF0ucmVzdExlbmd0aCA9IGRhdGEucHJvcHM7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3NldFNwcmluZ0RhbXBpbmcnOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLnNwcmluZ0luc3RhbmNlc1tkYXRhLnV1aWRdLmRhbXBpbmcgPSBkYXRhLnByb3BzOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdyZW1vdmVTcHJpbmcnOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Bvc3RTdGVwJywgc3RhdGUuc3ByaW5nc1tkYXRhLnV1aWRdKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnYWRkUmF5JzoKICAgICAgICB7CiAgICAgICAgICBhZGRSYXkoc3RhdGUsIGRhdGEpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdyZW1vdmVSYXknOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3ByZVN0ZXAnLCBzdGF0ZS5yYXlzW2RhdGEudXVpZF0pOwogICAgICAgICAgZGVsZXRlIHN0YXRlLnJheXNbZGF0YS51dWlkXTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnYWRkUmF5Y2FzdFZlaGljbGUnOgogICAgICAgIHsKICAgICAgICAgIGFkZFJheWNhc3RWZWhpY2xlKHN0YXRlLCBkYXRhKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAncmVtb3ZlUmF5Y2FzdFZlaGljbGUnOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3ByZVN0ZXAnLCBzdGF0ZS52ZWhpY2xlc1tkYXRhLnV1aWRdLnByZVN0ZXApOwogICAgICAgICAgc3RhdGUud29ybGQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBzdGF0ZS52ZWhpY2xlc1tkYXRhLnV1aWRdLnBvc3RTdGVwKTsKICAgICAgICAgIHN0YXRlLnZlaGljbGVzW2RhdGEudXVpZF0udmVoaWNsZS53b3JsZCA9IG51bGw7CiAgICAgICAgICBkZWxldGUgc3RhdGUudmVoaWNsZXNbZGF0YS51dWlkXTsKICAgICAgICAgIGNvbnN0IGtleSA9IE9iamVjdC5rZXlzKHN0YXRlLnN1YnNjcmlwdGlvbnMpLmZpbmQoayA9PiBzdGF0ZS5zdWJzY3JpcHRpb25zW2tdWzBdID09PSBkYXRhLnV1aWQpOwogICAgICAgICAgaWYgKGtleSkgewogICAgICAgICAgICBkZWxldGUgc3RhdGUuc3Vic2NyaXB0aW9uc1trZXldOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdzZXRSYXljYXN0VmVoaWNsZVN0ZWVyaW5nVmFsdWUnOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IFt2YWx1ZSwgd2hlZWxJbmRleF0gPSBkYXRhLnByb3BzOwogICAgICAgICAgc3RhdGUudmVoaWNsZXNbZGF0YS51dWlkXS52ZWhpY2xlLnNldFN0ZWVyaW5nVmFsdWUodmFsdWUsIHdoZWVsSW5kZXgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdhcHBseVJheWNhc3RWZWhpY2xlRW5naW5lRm9yY2UnOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IFt2YWx1ZSwgd2hlZWxJbmRleF0gPSBkYXRhLnByb3BzOwogICAgICAgICAgc3RhdGUudmVoaWNsZXNbZGF0YS51dWlkXS52ZWhpY2xlLmFwcGx5RW5naW5lRm9yY2UodmFsdWUsIHdoZWVsSW5kZXgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdzZXRSYXljYXN0VmVoaWNsZUJyYWtlJzoKICAgICAgICB7CiAgICAgICAgICBjb25zdCBbYnJha2UsIHdoZWVsSW5kZXhdID0gZGF0YS5wcm9wczsKICAgICAgICAgIHN0YXRlLnZlaGljbGVzW2RhdGEudXVpZF0udmVoaWNsZS5zZXRCcmFrZShicmFrZSwgd2hlZWxJbmRleCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ2FkZENvbnRhY3RNYXRlcmlhbCc6CiAgICAgICAgewogICAgICAgICAgYWRkQ29udGFjdE1hdGVyaWFsKHN0YXRlLndvcmxkLCBjcmVhdGVNYXRlcmlhbCwgZGF0YS5wcm9wcywgZGF0YS51dWlkKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAncmVtb3ZlQ29udGFjdE1hdGVyaWFsJzoKICAgICAgICB7CiAgICAgICAgICByZW1vdmVDb250YWN0TWF0ZXJpYWwoc3RhdGUud29ybGQsIGRhdGEudXVpZCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3dha2VVcCc6CiAgICAgICAgewogICAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0ud2FrZVVwKCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3NsZWVwJzoKICAgICAgICB7CiAgICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5zbGVlcCgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQogIH07Cgp9KSgpOwoK",null,!1);class oB extends iB{get axisIndex(){return this.config.axisIndex}set axisIndex(e){this.config.axisIndex=e,this.postMessage({op:"setAxisIndex",props:e})}get broadphase(){return this.config.broadphase}set broadphase(e){this.config.broadphase=e,this.postMessage({op:"setBroadphase",props:e})}get frictionGravity(){return this.config.frictionGravity}set frictionGravity(e){this.config.frictionGravity=e,this.postMessage({op:"setFrictionGravity",props:e})}get gravity(){return this.config.gravity}set gravity(e){this.config.gravity=e,this.postMessage({op:"setGravity",props:e})}get iterations(){return this.config.iterations}set iterations(e){this.config.iterations=e,this.postMessage({op:"setIterations",props:e})}get tolerance(){return this.config.tolerance}set tolerance(e){this.config.tolerance=e,this.postMessage({op:"setTolerance",props:e})}constructor(e){let{allowSleep:t=!1,axisIndex:n=0,broadphase:i="Naive",defaultContactMaterial:r={contactEquationStiffness:1e6},frictionGravity:s=null,gravity:o=[0,-9.81,0],iterations:a=5,quatNormalizeFast:l=!1,quatNormalizeSkip:c=0,size:g=1e3,solver:u="GS",tolerance:A=.001}=e;super(),hC(this,"messageQueue",[]),hC(this,"worker",null),this.config={allowSleep:t,axisIndex:n,broadphase:i,defaultContactMaterial:r,frictionGravity:s,gravity:o,iterations:a,quatNormalizeFast:l,quatNormalizeSkip:c,size:g,solver:u,tolerance:A},this.buffers={positions:new Float32Array(3*g),quaternions:new Float32Array(4*g)}}addBodies(e){let{props:t,type:n,uuid:i}=e;this.postMessage({op:"addBodies",props:t,type:n,uuid:i})}addConstraint(e){let{props:[t,n,i],type:r,uuid:s}=e;this.postMessage({op:"addConstraint",props:[t,n,i],type:r,uuid:s})}addContactMaterial(e){let{props:t,uuid:n}=e;this.postMessage({op:"addContactMaterial",props:t,uuid:n})}addRay(e){let{props:t,uuid:n}=e;this.postMessage({op:"addRay",props:t,uuid:n})}addRaycastVehicle(e){let{props:[t,n,i,r,s,o],uuid:a}=e;this.postMessage({op:"addRaycastVehicle",props:[t,n,i,r,s,o],uuid:a})}addSpring(e){let{props:[t,n,i],uuid:r}=e;this.postMessage({op:"addSpring",props:[t,n,i],uuid:r})}applyForce(e){let{props:t,uuid:n}=e;this.postMessage({op:"applyForce",props:t,uuid:n})}applyImpulse(e){let{props:t,uuid:n}=e;this.postMessage({op:"applyImpulse",props:t,uuid:n})}applyLocalForce(e){let{props:t,uuid:n}=e;this.postMessage({op:"applyLocalForce",props:t,uuid:n})}applyLocalImpulse(e){let{props:t,uuid:n}=e;this.postMessage({op:"applyLocalImpulse",props:t,uuid:n})}applyRaycastVehicleEngineForce(e){let{props:t,uuid:n}=e;this.postMessage({op:"applyRaycastVehicleEngineForce",props:t,uuid:n})}applyTorque(e){let{props:t,uuid:n}=e;this.postMessage({op:"applyTorque",props:t,uuid:n})}connect(){this.worker=new sB,this.worker.onmessage=e=>{if("frame"===e.data.op)return this.buffers.positions=e.data.positions,this.buffers.quaternions=e.data.quaternions,void this.emit(e.data.op,e.data);this.emit(e.data.type,e.data)};for(const e of this.messageQueue)this.worker.postMessage(e);this.messageQueue.length=0}disableConstraint(e){let{uuid:t}=e;this.postMessage({op:"disableConstraint",uuid:t})}disableConstraintMotor(e){let{uuid:t}=e;this.postMessage({op:"disableConstraintMotor",uuid:t})}disconnect(){this.worker&&(this.worker.onmessage=null)}enableConstraint(e){let{uuid:t}=e;this.postMessage({op:"enableConstraint",uuid:t})}enableConstraintMotor(e){let{uuid:t}=e;this.postMessage({op:"enableConstraintMotor",uuid:t})}init(){const{allowSleep:e,axisIndex:t,broadphase:n,defaultContactMaterial:i,frictionGravity:r,gravity:s,iterations:o,quatNormalizeFast:a,quatNormalizeSkip:l,solver:c,tolerance:g}=this.config;this.postMessage({op:"init",props:{allowSleep:e,axisIndex:t,broadphase:n,defaultContactMaterial:i,frictionGravity:r,gravity:s,iterations:o,quatNormalizeFast:a,quatNormalizeSkip:l,solver:c,tolerance:g}})}removeBodies(e){let{uuid:t}=e;this.postMessage({op:"removeBodies",uuid:t})}removeConstraint(e){let{uuid:t}=e;this.postMessage({op:"removeConstraint",uuid:t})}removeContactMaterial(e){let{uuid:t}=e;this.postMessage({op:"removeContactMaterial",uuid:t})}removeRay(e){let{uuid:t}=e;this.postMessage({op:"removeRay",uuid:t})}removeRaycastVehicle(e){let{uuid:t}=e;this.postMessage({op:"removeRaycastVehicle",uuid:t})}removeSpring(e){let{uuid:t}=e;this.postMessage({op:"removeSpring",uuid:t})}setAllowSleep(e){let{props:t,uuid:n}=e;this.postMessage({op:"setAllowSleep",props:t,uuid:n})}setAngularDamping(e){let{props:t,uuid:n}=e;this.postMessage({op:"setAngularDamping",props:t,uuid:n})}setAngularFactor(e){let{props:t,uuid:n}=e;this.postMessage({op:"setAngularFactor",props:t,uuid:n})}setAngularVelocity(e){let{props:t,uuid:n}=e;this.postMessage({op:"setAngularVelocity",props:t,uuid:n})}setCollisionFilterGroup(e){let{props:t,uuid:n}=e;this.postMessage({op:"setCollisionFilterGroup",props:t,uuid:n})}setCollisionFilterMask(e){let{props:t,uuid:n}=e;this.postMessage({op:"setCollisionFilterMask",props:t,uuid:n})}setCollisionResponse(e){let{props:t,uuid:n}=e;this.postMessage({op:"setCollisionResponse",props:t,uuid:n})}setConstraintMotorMaxForce(e){let{props:t,uuid:n}=e;this.postMessage({op:"setConstraintMotorMaxForce",props:t,uuid:n})}setConstraintMotorSpeed(e){let{props:t,uuid:n}=e;this.postMessage({op:"setConstraintMotorSpeed",props:t,uuid:n})}setFixedRotation(e){let{props:t,uuid:n}=e;this.postMessage({op:"setFixedRotation",props:t,uuid:n})}setIsTrigger(e){let{props:t,uuid:n}=e;this.postMessage({op:"setIsTrigger",props:t,uuid:n})}setLinearDamping(e){let{props:t,uuid:n}=e;this.postMessage({op:"setLinearDamping",props:t,uuid:n})}setLinearFactor(e){let{props:t,uuid:n}=e;this.postMessage({op:"setLinearFactor",props:t,uuid:n})}setMass(e){let{props:t,uuid:n}=e;this.postMessage({op:"setMass",props:t,uuid:n})}setMaterial(e){let{props:t,uuid:n}=e;this.postMessage({op:"setMaterial",props:t,uuid:n})}setPosition(e){let{props:t,uuid:n}=e;this.postMessage({op:"setPosition",props:t,uuid:n})}setQuaternion(e){let{props:[t,n,i,r],uuid:s}=e;this.postMessage({op:"setQuaternion",props:[t,n,i,r],uuid:s})}setRaycastVehicleBrake(e){let{props:t,uuid:n}=e;this.postMessage({op:"setRaycastVehicleBrake",props:t,uuid:n})}setRaycastVehicleSteeringValue(e){let{props:t,uuid:n}=e;this.postMessage({op:"setRaycastVehicleSteeringValue",props:t,uuid:n})}setRotation(e){let{props:t,uuid:n}=e;this.postMessage({op:"setRotation",props:t,uuid:n})}setSleepSpeedLimit(e){let{props:t,uuid:n}=e;this.postMessage({op:"setSleepSpeedLimit",props:t,uuid:n})}setSleepTimeLimit(e){let{props:t,uuid:n}=e;this.postMessage({op:"setSleepTimeLimit",props:t,uuid:n})}setSpringDamping(e){let{props:t,uuid:n}=e;this.postMessage({op:"setSpringDamping",props:t,uuid:n})}setSpringRestLength(e){let{props:t,uuid:n}=e;this.postMessage({op:"setSpringRestLength",props:t,uuid:n})}setSpringStiffness(e){let{props:t,uuid:n}=e;this.postMessage({op:"setSpringStiffness",props:t,uuid:n})}setUserData(e){let{props:t,uuid:n}=e;this.postMessage({op:"setUserData",props:t,uuid:n})}setVelocity(e){let{props:t,uuid:n}=e;this.postMessage({op:"setVelocity",props:t,uuid:n})}sleep(e){let{uuid:t}=e;this.postMessage({op:"sleep",uuid:t})}step(e){var t;const{buffers:{positions:n,quaternions:i}}=this;(n.byteLength||i.byteLength)&&(null==(t=this.worker)||t.postMessage({op:"step",positions:n,props:e,quaternions:i},[n.buffer,i.buffer]))}subscribe(e){let{props:{id:t,target:n,type:i},uuid:r}=e;this.postMessage({op:"subscribe",props:{id:t,target:n,type:i},uuid:r})}terminate(){var e;null==(e=this.worker)||e.terminate(),this.worker=null}unsubscribe(e){let{props:t}=e;this.postMessage({op:"unsubscribe",props:t})}wakeUp(e){let{uuid:t}=e;this.postMessage({op:"wakeUp",uuid:t})}postMessage(e){if(this.worker)return this.worker.postMessage(e);this.messageQueue.push(e)}}class aB{constructor(e){void 0===e&&(e=[0,0,0,0,0,0,0,0,0]),this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}getTrace(e){void 0===e&&(e=new cB);const t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}vmult(e,t){void 0===t&&(t=new cB);const n=this.elements,i=e.x,r=e.y,s=e.z;return t.x=n[0]*i+n[1]*r+n[2]*s,t.y=n[3]*i+n[4]*r+n[5]*s,t.z=n[6]*i+n[7]*r+n[8]*s,t}smult(e){for(let t=0;t<this.elements.length;t++)this.elements[t]*=e}mmult(e,t){void 0===t&&(t=new aB);const n=this.elements,i=e.elements,r=t.elements,s=n[0],o=n[1],a=n[2],l=n[3],c=n[4],g=n[5],u=n[6],A=n[7],d=n[8],h=i[0],I=i[1],p=i[2],C=i[3],m=i[4],f=i[5],y=i[6],b=i[7],B=i[8];return r[0]=s*h+o*C+a*y,r[1]=s*I+o*m+a*b,r[2]=s*p+o*f+a*B,r[3]=l*h+c*C+g*y,r[4]=l*I+c*m+g*b,r[5]=l*p+c*f+g*B,r[6]=u*h+A*C+d*y,r[7]=u*I+A*m+d*b,r[8]=u*p+A*f+d*B,t}scale(e,t){void 0===t&&(t=new aB);const n=this.elements,i=t.elements;for(let r=0;3!==r;r++)i[3*r+0]=e.x*n[3*r+0],i[3*r+1]=e.y*n[3*r+1],i[3*r+2]=e.z*n[3*r+2];return t}solve(e,t){void 0===t&&(t=new cB);const n=[];let i,r;for(i=0;i<12;i++)n.push(0);for(i=0;i<3;i++)for(r=0;r<3;r++)n[i+4*r]=this.elements[i+3*r];n[3]=e.x,n[7]=e.y,n[11]=e.z;let s=3;const o=s;let a;let l;do{if(i=o-s,0===n[i+4*i])for(r=i+1;r<o;r++)if(0!==n[i+4*r]){a=4;do{l=4-a,n[l+4*i]+=n[l+4*r]}while(--a);break}if(0!==n[i+4*i])for(r=i+1;r<o;r++){const e=n[i+4*r]/n[i+4*i];a=4;do{l=4-a,n[l+4*r]=l<=i?0:n[l+4*r]-n[l+4*i]*e}while(--a)}}while(--s);if(t.z=n[11]/n[10],t.y=(n[7]-n[6]*t.z)/n[5],t.x=(n[3]-n[2]*t.z-n[1]*t.y)/n[0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw"Could not solve equation! Got x=[".concat(t.toString(),"], b=[").concat(e.toString(),"], A=[").concat(this.toString(),"]");return t}e(e,t,n){if(void 0===n)return this.elements[t+3*e];this.elements[t+3*e]=n}copy(e){for(let t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}toString(){let e="";for(let t=0;t<9;t++)e+=this.elements[t]+",";return e}reverse(e){void 0===e&&(e=new aB);const t=lB;let n,i;for(n=0;n<3;n++)for(i=0;i<3;i++)t[n+6*i]=this.elements[n+3*i];t[3]=1,t[9]=0,t[15]=0,t[4]=0,t[10]=1,t[16]=0,t[5]=0,t[11]=0,t[17]=1;let r=3;const s=r;let o;let a;do{if(n=s-r,0===t[n+6*n])for(i=n+1;i<s;i++)if(0!==t[n+6*i]){o=6;do{a=6-o,t[a+6*n]+=t[a+6*i]}while(--o);break}if(0!==t[n+6*n])for(i=n+1;i<s;i++){const e=t[n+6*i]/t[n+6*n];o=6;do{a=6-o,t[a+6*i]=a<=n?0:t[a+6*i]-t[a+6*n]*e}while(--o)}}while(--r);n=2;do{i=n-1;do{const e=t[n+6*i]/t[n+6*n];o=6;do{a=6-o,t[a+6*i]=t[a+6*i]-t[a+6*n]*e}while(--o)}while(i--)}while(--n);n=2;do{const e=1/t[n+6*n];o=6;do{a=6-o,t[a+6*n]=t[a+6*n]*e}while(--o)}while(n--);n=2;do{i=2;do{if(a=t[3+i+6*n],isNaN(a)||a===1/0)throw"Could not reverse! A=[".concat(this.toString(),"]");e.e(n,i,a)}while(i--)}while(n--);return e}setRotationFromQuaternion(e){const t=e.x,n=e.y,i=e.z,r=e.w,s=t+t,o=n+n,a=i+i,l=t*s,c=t*o,g=t*a,u=n*o,A=n*a,d=i*a,h=r*s,I=r*o,p=r*a,C=this.elements;return C[0]=1-(u+d),C[1]=c-p,C[2]=g+I,C[3]=c+p,C[4]=1-(l+d),C[5]=A-h,C[6]=g-I,C[7]=A+h,C[8]=1-(l+u),this}transpose(e){void 0===e&&(e=new aB);const t=this.elements,n=e.elements;let i;return n[0]=t[0],n[4]=t[4],n[8]=t[8],i=t[1],n[1]=t[3],n[3]=i,i=t[2],n[2]=t[6],n[6]=i,i=t[5],n[5]=t[7],n[7]=i,e}}const lB=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class cB{constructor(e,t,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),this.x=e,this.y=t,this.z=n}cross(e,t){void 0===t&&(t=new cB);const n=e.x,i=e.y,r=e.z,s=this.x,o=this.y,a=this.z;return t.x=o*r-a*i,t.y=a*n-s*r,t.z=s*i-o*n,t}set(e,t,n){return this.x=e,this.y=t,this.z=n,this}setZero(){this.x=this.y=this.z=0}vadd(e,t){if(!t)return new cB(this.x+e.x,this.y+e.y,this.z+e.z);t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z}vsub(e,t){if(!t)return new cB(this.x-e.x,this.y-e.y,this.z-e.z);t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z}crossmat(){return new aB([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,t=this.y,n=this.z,i=Math.sqrt(e*e+t*t+n*n);if(i>0){const e=1/i;this.x*=e,this.y*=e,this.z*=e}else this.x=0,this.y=0,this.z=0;return i}unit(e){void 0===e&&(e=new cB);const t=this.x,n=this.y,i=this.z;let r=Math.sqrt(t*t+n*n+i*i);return r>0?(r=1/r,e.x=t*r,e.y=n*r,e.z=i*r):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,t=this.y,n=this.z;return Math.sqrt(e*e+t*t+n*n)}lengthSquared(){return this.dot(this)}distanceTo(e){const t=this.x,n=this.y,i=this.z,r=e.x,s=e.y,o=e.z;return Math.sqrt((r-t)*(r-t)+(s-n)*(s-n)+(o-i)*(o-i))}distanceSquared(e){const t=this.x,n=this.y,i=this.z,r=e.x,s=e.y,o=e.z;return(r-t)*(r-t)+(s-n)*(s-n)+(o-i)*(o-i)}scale(e,t){void 0===t&&(t=new cB);const n=this.x,i=this.y,r=this.z;return t.x=e*n,t.y=e*i,t.z=e*r,t}vmul(e,t){return void 0===t&&(t=new cB),t.x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t}addScaledVector(e,t,n){return void 0===n&&(n=new cB),n.x=this.x+e*t.x,n.y=this.y+e*t.y,n.z=this.z+e*t.z,n}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(e){return void 0===e&&(e=new cB),e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,t){const n=this.length();if(n>0){const i=gB,r=1/n;i.set(this.x*r,this.y*r,this.z*r);const s=uB;Math.abs(i.x)<.9?(s.set(1,0,0),i.cross(s,e)):(s.set(0,1,0),i.cross(s,e)),i.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}toString(){return"".concat(this.x,",").concat(this.y,",").concat(this.z)}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,t,n){const i=this.x,r=this.y,s=this.z;n.x=i+(e.x-i)*t,n.y=r+(e.y-r)*t,n.z=s+(e.z-s)*t}almostEquals(e,t){return void 0===t&&(t=1e-6),!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}almostZero(e){return void 0===e&&(e=1e-6),!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,t){return this.negate(AB),AB.almostEquals(e,t)}clone(){return new cB(this.x,this.y,this.z)}}cB.ZERO=new cB(0,0,0),cB.UNIT_X=new cB(1,0,0),cB.UNIT_Y=new cB(0,1,0),cB.UNIT_Z=new cB(0,0,1);const gB=new cB,uB=new cB,AB=new cB;class dB{constructor(e){void 0===e&&(e={}),this.lowerBound=new cB,this.upperBound=new cB,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,t,n,i){const r=this.lowerBound,s=this.upperBound,o=n;r.copy(e[0]),o&&o.vmult(r,r),s.copy(r);for(let a=1;a<e.length;a++){let t=e[a];o&&(o.vmult(t,hB),t=hB),t.x>s.x&&(s.x=t.x),t.x<r.x&&(r.x=t.x),t.y>s.y&&(s.y=t.y),t.y<r.y&&(r.y=t.y),t.z>s.z&&(s.z=t.z),t.z<r.z&&(r.z=t.z)}return t&&(t.vadd(r,r),t.vadd(s,s)),i&&(r.x-=i,r.y-=i,r.z-=i,s.x+=i,s.y+=i,s.z+=i),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return(new dB).copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const t=this.lowerBound,n=this.upperBound,i=e.lowerBound,r=e.upperBound,s=i.x<=n.x&&n.x<=r.x||t.x<=r.x&&r.x<=n.x,o=i.y<=n.y&&n.y<=r.y||t.y<=r.y&&r.y<=n.y,a=i.z<=n.z&&n.z<=r.z||t.z<=r.z&&r.z<=n.z;return s&&o&&a}volume(){const e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}contains(e){const t=this.lowerBound,n=this.upperBound,i=e.lowerBound,r=e.upperBound;return t.x<=i.x&&n.x>=r.x&&t.y<=i.y&&n.y>=r.y&&t.z<=i.z&&n.z>=r.z}getCorners(e,t,n,i,r,s,o,a){const l=this.lowerBound,c=this.upperBound;e.copy(l),t.set(c.x,l.y,l.z),n.set(c.x,c.y,l.z),i.set(l.x,c.y,c.z),r.set(c.x,l.y,c.z),s.set(l.x,c.y,l.z),o.set(l.x,l.y,c.z),a.copy(c)}toLocalFrame(e,t){const n=IB,i=n[0],r=n[1],s=n[2],o=n[3],a=n[4],l=n[5],c=n[6],g=n[7];this.getCorners(i,r,s,o,a,l,c,g);for(let u=0;8!==u;u++){const t=n[u];e.pointToLocal(t,t)}return t.setFromPoints(n)}toWorldFrame(e,t){const n=IB,i=n[0],r=n[1],s=n[2],o=n[3],a=n[4],l=n[5],c=n[6],g=n[7];this.getCorners(i,r,s,o,a,l,c,g);for(let u=0;8!==u;u++){const t=n[u];e.pointToWorld(t,t)}return t.setFromPoints(n)}overlapsRay(e){const{direction:t,from:n}=e,i=1/t.x,r=1/t.y,s=1/t.z,o=(this.lowerBound.x-n.x)*i,a=(this.upperBound.x-n.x)*i,l=(this.lowerBound.y-n.y)*r,c=(this.upperBound.y-n.y)*r,g=(this.lowerBound.z-n.z)*s,u=(this.upperBound.z-n.z)*s,A=Math.max(Math.max(Math.min(o,a),Math.min(l,c)),Math.min(g,u)),d=Math.min(Math.min(Math.max(o,a),Math.max(l,c)),Math.max(g,u));return!(d<0)&&!(A>d)}}const hB=new cB,IB=[new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB];class pB{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;return void 0===n[e]&&(n[e]=[]),n[e].includes(t)||n[e].push(t),this}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return!(void 0===n[e]||!n[e].includes(t))}hasAnyEventListener(e){if(void 0===this._listeners)return!1;return void 0!==this._listeners[e]}removeEventListener(e,t){if(void 0===this._listeners)return this;const n=this._listeners;if(void 0===n[e])return this;const i=n[e].indexOf(t);return-1!==i&&n[e].splice(i,1),this}dispatchEvent(e){if(void 0===this._listeners)return this;const t=this._listeners[e.type];if(void 0!==t){e.target=this;for(let n=0,i=t.length;n<i;n++)t[n].call(this,e)}return this}}class CB{constructor(e,t,n,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===i&&(i=1),this.x=e,this.y=t,this.z=n,this.w=i}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}toString(){return"".concat(this.x,",").concat(this.y,",").concat(this.z,",").concat(this.w)}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,t){const n=Math.sin(.5*t);return this.x=e.x*n,this.y=e.y*n,this.z=e.z*n,this.w=Math.cos(.5*t),this}toAxisAngle(e){void 0===e&&(e=new cB),this.normalize();const t=2*Math.acos(this.w),n=Math.sqrt(1-this.w*this.w);return n<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/n,e.y=this.y/n,e.z=this.z/n),[e,t]}setFromVectors(e,t){if(e.isAntiparallelTo(t)){const t=mB,n=fB;e.tangents(t,n),this.setFromAxisAngle(t,Math.PI)}else{const n=e.cross(t);this.x=n.x,this.y=n.y,this.z=n.z,this.w=Math.sqrt(e.length()**2*t.length()**2)+e.dot(t),this.normalize()}return this}mult(e,t){void 0===t&&(t=new CB);const n=this.x,i=this.y,r=this.z,s=this.w,o=e.x,a=e.y,l=e.z,c=e.w;return t.x=n*c+s*o+i*l-r*a,t.y=i*c+s*a+r*o-n*l,t.z=r*c+s*l+n*a-i*o,t.w=s*c-n*o-i*a-r*l,t}inverse(e){void 0===e&&(e=new CB);const t=this.x,n=this.y,i=this.z,r=this.w;this.conjugate(e);const s=1/(t*t+n*n+i*i+r*r);return e.x*=s,e.y*=s,e.z*=s,e.w*=s,e}conjugate(e){return void 0===e&&(e=new CB),e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,t){void 0===t&&(t=new cB);const n=e.x,i=e.y,r=e.z,s=this.x,o=this.y,a=this.z,l=this.w,c=l*n+o*r-a*i,g=l*i+a*n-s*r,u=l*r+s*i-o*n,A=-s*n-o*i-a*r;return t.x=c*l+A*-s+g*-a-u*-o,t.y=g*l+A*-o+u*-s-c*-a,t.z=u*l+A*-a+c*-o-g*-s,t}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,t){let n,i,r;void 0===t&&(t="YZX");const s=this.x,o=this.y,a=this.z,l=this.w;if("YZX"!==t)throw new Error("Euler order ".concat(t," not supported yet."));{const e=s*o+a*l;if(e>.499&&(n=2*Math.atan2(s,l),i=Math.PI/2,r=0),e<-.499&&(n=-2*Math.atan2(s,l),i=-Math.PI/2,r=0),void 0===n){const t=s*s,c=o*o,g=a*a;n=Math.atan2(2*o*l-2*s*a,1-2*c-2*g),i=Math.asin(2*e),r=Math.atan2(2*s*l-2*o*a,1-2*t-2*g)}}e.y=n,e.z=i,e.x=r}setFromEuler(e,t,n,i){void 0===i&&(i="XYZ");const r=Math.cos(e/2),s=Math.cos(t/2),o=Math.cos(n/2),a=Math.sin(e/2),l=Math.sin(t/2),c=Math.sin(n/2);return"XYZ"===i?(this.x=a*s*o+r*l*c,this.y=r*l*o-a*s*c,this.z=r*s*c+a*l*o,this.w=r*s*o-a*l*c):"YXZ"===i?(this.x=a*s*o+r*l*c,this.y=r*l*o-a*s*c,this.z=r*s*c-a*l*o,this.w=r*s*o+a*l*c):"ZXY"===i?(this.x=a*s*o-r*l*c,this.y=r*l*o+a*s*c,this.z=r*s*c+a*l*o,this.w=r*s*o-a*l*c):"ZYX"===i?(this.x=a*s*o-r*l*c,this.y=r*l*o+a*s*c,this.z=r*s*c-a*l*o,this.w=r*s*o+a*l*c):"YZX"===i?(this.x=a*s*o+r*l*c,this.y=r*l*o+a*s*c,this.z=r*s*c-a*l*o,this.w=r*s*o-a*l*c):"XZY"===i&&(this.x=a*s*o-r*l*c,this.y=r*l*o-a*s*c,this.z=r*s*c+a*l*o,this.w=r*s*o+a*l*c),this}clone(){return new CB(this.x,this.y,this.z,this.w)}slerp(e,t,n){void 0===n&&(n=new CB);const i=this.x,r=this.y,s=this.z,o=this.w;let a,l,c,g,u,A=e.x,d=e.y,h=e.z,I=e.w;return l=i*A+r*d+s*h+o*I,l<0&&(l=-l,A=-A,d=-d,h=-h,I=-I),1-l>1e-6?(a=Math.acos(l),c=Math.sin(a),g=Math.sin((1-t)*a)/c,u=Math.sin(t*a)/c):(g=1-t,u=t),n.x=g*i+u*A,n.y=g*r+u*d,n.z=g*s+u*h,n.w=g*o+u*I,n}integrate(e,t,n,i){void 0===i&&(i=new CB);const r=e.x*n.x,s=e.y*n.y,o=e.z*n.z,a=this.x,l=this.y,c=this.z,g=this.w,u=.5*t;return i.x+=u*(r*g+s*c-o*l),i.y+=u*(s*g+o*a-r*c),i.z+=u*(o*g+r*l-s*a),i.w+=u*(-r*a-s*l-o*c),i}}const mB=new cB,fB=new cB;class yB{constructor(e){void 0===e&&(e={}),this.id=yB.idCounter++,this.type=e.type||0,this.boundingSphereRadius=0,this.collisionResponse=!e.collisionResponse||e.collisionResponse,this.collisionFilterGroup=void 0!==e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask=void 0!==e.collisionFilterMask?e.collisionFilterMask:-1,this.material=e.material?e.material:null,this.body=null}updateBoundingSphereRadius(){throw"computeBoundingSphereRadius() not implemented for shape type ".concat(this.type)}volume(){throw"volume() not implemented for shape type ".concat(this.type)}calculateLocalInertia(e,t){throw"calculateLocalInertia() not implemented for shape type ".concat(this.type)}calculateWorldAABB(e,t,n,i){throw"calculateWorldAABB() not implemented for shape type ".concat(this.type)}}yB.idCounter=0,yB.types={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};class bB{constructor(e){void 0===e&&(e={}),this.position=new cB,this.quaternion=new CB,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,t){return bB.pointToLocalFrame(this.position,this.quaternion,e,t)}pointToWorld(e,t){return bB.pointToWorldFrame(this.position,this.quaternion,e,t)}vectorToWorldFrame(e,t){return void 0===t&&(t=new cB),this.quaternion.vmult(e,t),t}static pointToLocalFrame(e,t,n,i){return void 0===i&&(i=new cB),n.vsub(e,i),t.conjugate(BB),BB.vmult(i,i),i}static pointToWorldFrame(e,t,n,i){return void 0===i&&(i=new cB),t.vmult(n,i),i.vadd(e,i),i}static vectorToWorldFrame(e,t,n){return void 0===n&&(n=new cB),e.vmult(t,n),n}static vectorToLocalFrame(e,t,n,i){return void 0===i&&(i=new cB),t.w*=-1,t.vmult(n,i),t.w*=-1,i}}const BB=new CB;class vB extends yB{constructor(e){void 0===e&&(e={});const{vertices:t=[],faces:n=[],normals:i=[],axes:r,boundingSphereRadius:s}=e;super({type:yB.types.CONVEXPOLYHEDRON}),this.vertices=t,this.faces=n,this.faceNormals=i,0===this.faceNormals.length&&this.computeNormals(),s?this.boundingSphereRadius=s:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=r?r.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const e=this.faces,t=this.vertices,n=this.uniqueEdges;n.length=0;const i=new cB;for(let r=0;r!==e.length;r++){const s=e[r],o=s.length;for(let e=0;e!==o;e++){const r=(e+1)%o;t[s[e]].vsub(t[s[r]],i),i.normalize();let a=!1;for(let e=0;e!==n.length;e++)if(n[e].almostEquals(i)||n[e].almostEquals(i)){a=!0;break}a||n.push(i.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let e=0;e<this.faces.length;e++){for(let i=0;i<this.faces[e].length;i++)if(!this.vertices[this.faces[e][i]])throw new Error("Vertex ".concat(this.faces[e][i]," not found!"));const t=this.faceNormals[e]||new cB;this.getFaceNormal(e,t),t.negate(t),this.faceNormals[e]=t;const n=this.vertices[this.faces[e][0]];if(t.dot(n)<0){console.error(".faceNormals[".concat(e,"] = Vec3(").concat(t.toString(),") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule."));for(let t=0;t<this.faces[e].length;t++)console.warn(".vertices[".concat(this.faces[e][t],"] = Vec3(").concat(this.vertices[this.faces[e][t]].toString(),")"))}}}getFaceNormal(e,t){const n=this.faces[e],i=this.vertices[n[0]],r=this.vertices[n[1]],s=this.vertices[n[2]];vB.computeNormal(i,r,s,t)}static computeNormal(e,t,n,i){const r=new cB,s=new cB;t.vsub(e,s),n.vsub(t,r),r.cross(s,i),i.isZero()||i.normalize()}clipAgainstHull(e,t,n,i,r,s,o,a,l){const c=new cB;let g=-1,u=-Number.MAX_VALUE;for(let d=0;d<n.faces.length;d++){c.copy(n.faceNormals[d]),r.vmult(c,c);const e=c.dot(s);e>u&&(u=e,g=d)}const A=[];for(let d=0;d<n.faces[g].length;d++){const e=n.vertices[n.faces[g][d]],t=new cB;t.copy(e),r.vmult(t,t),i.vadd(t,t),A.push(t)}g>=0&&this.clipFaceAgainstHull(s,e,t,A,o,a,l)}findSeparatingAxis(e,t,n,i,r,s,o,a){const l=new cB,c=new cB,g=new cB,u=new cB,A=new cB,d=new cB;let h=Number.MAX_VALUE;const I=this;if(I.uniqueAxes)for(let p=0;p!==I.uniqueAxes.length;p++){n.vmult(I.uniqueAxes[p],l);const o=I.testSepAxis(l,e,t,n,i,r);if(!1===o)return!1;o<h&&(h=o,s.copy(l))}else{const a=o?o.length:I.faces.length;for(let c=0;c<a;c++){const a=o?o[c]:c;l.copy(I.faceNormals[a]),n.vmult(l,l);const g=I.testSepAxis(l,e,t,n,i,r);if(!1===g)return!1;g<h&&(h=g,s.copy(l))}}if(e.uniqueAxes)for(let p=0;p!==e.uniqueAxes.length;p++){r.vmult(e.uniqueAxes[p],c);const o=I.testSepAxis(c,e,t,n,i,r);if(!1===o)return!1;o<h&&(h=o,s.copy(c))}else{const o=a?a.length:e.faces.length;for(let l=0;l<o;l++){const o=a?a[l]:l;c.copy(e.faceNormals[o]),r.vmult(c,c);const g=I.testSepAxis(c,e,t,n,i,r);if(!1===g)return!1;g<h&&(h=g,s.copy(c))}}for(let p=0;p!==I.uniqueEdges.length;p++){n.vmult(I.uniqueEdges[p],u);for(let o=0;o!==e.uniqueEdges.length;o++)if(r.vmult(e.uniqueEdges[o],A),u.cross(A,d),!d.almostZero()){d.normalize();const o=I.testSepAxis(d,e,t,n,i,r);if(!1===o)return!1;o<h&&(h=o,s.copy(d))}}return i.vsub(t,g),g.dot(s)>0&&s.negate(s),!0}testSepAxis(e,t,n,i,r,s){vB.project(this,e,n,i,wB),vB.project(t,e,r,s,GB);const o=wB[0],a=wB[1],l=GB[0],c=GB[1];if(o<c||l<a)return!1;const g=o-c,u=l-a;return g<u?g:u}calculateLocalInertia(e,t){const n=new cB,i=new cB;this.computeLocalAABB(i,n);const r=n.x-i.x,s=n.y-i.y,o=n.z-i.z;t.x=1/12*e*(2*s*2*s+2*o*2*o),t.y=1/12*e*(2*r*2*r+2*o*2*o),t.z=1/12*e*(2*s*2*s+2*r*2*r)}getPlaneConstantOfFace(e){const t=this.faces[e],n=this.faceNormals[e],i=this.vertices[t[0]];return-n.dot(i)}clipFaceAgainstHull(e,t,n,i,r,s,o){const a=new cB,l=new cB,c=new cB,g=new cB,u=new cB,A=new cB,d=new cB,h=new cB,I=this,p=i,C=[];let m=-1,f=Number.MAX_VALUE;for(let w=0;w<I.faces.length;w++){a.copy(I.faceNormals[w]),n.vmult(a,a);const t=a.dot(e);t<f&&(f=t,m=w)}if(m<0)return;const y=I.faces[m];y.connectedFaces=[];for(let w=0;w<I.faces.length;w++)for(let e=0;e<I.faces[w].length;e++)-1!==y.indexOf(I.faces[w][e])&&w!==m&&-1===y.connectedFaces.indexOf(w)&&y.connectedFaces.push(w);const b=y.length;for(let w=0;w<b;w++){const e=I.vertices[y[w]],i=I.vertices[y[(w+1)%b]];e.vsub(i,l),c.copy(l),n.vmult(c,c),t.vadd(c,c),g.copy(this.faceNormals[m]),n.vmult(g,g),t.vadd(g,g),c.cross(g,u),u.negate(u),A.copy(e),n.vmult(A,A),t.vadd(A,A);const r=y.connectedFaces[w];d.copy(this.faceNormals[r]);const s=this.getPlaneConstantOfFace(r);h.copy(d),n.vmult(h,h);const o=s-h.dot(t);for(this.clipFaceAgainstPlane(p,C,h,o);p.length;)p.shift();for(;C.length;)p.push(C.shift())}d.copy(this.faceNormals[m]);const B=this.getPlaneConstantOfFace(m);h.copy(d),n.vmult(h,h);const v=B-h.dot(t);for(let w=0;w<p.length;w++){let e=h.dot(p[w])+v;if(e<=r&&(console.log("clamped: depth=".concat(e," to minDist=").concat(r)),e=r),e<=s){const t=p[w];if(e<=1e-6){const n={point:t,normal:h,depth:e};o.push(n)}}}}clipFaceAgainstPlane(e,t,n,i){let r,s;const o=e.length;if(o<2)return t;let a=e[e.length-1],l=e[0];r=n.dot(a)+i;for(let c=0;c<o;c++){if(l=e[c],s=n.dot(l)+i,r<0)if(s<0){const e=new cB;e.copy(l),t.push(e)}else{const e=new cB;a.lerp(l,r/(r-s),e),t.push(e)}else if(s<0){const e=new cB;a.lerp(l,r/(r-s),e),t.push(e),t.push(l)}a=l,r=s}return t}computeWorldVertices(e,t){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new cB);const n=this.vertices,i=this.worldVertices;for(let r=0;r!==this.vertices.length;r++)t.vmult(n[r],i[r]),e.vadd(i[r],i[r]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(e,t){const n=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let i=0;i<this.vertices.length;i++){const r=n[i];r.x<e.x?e.x=r.x:r.x>t.x&&(t.x=r.x),r.y<e.y?e.y=r.y:r.y>t.y&&(t.y=r.y),r.z<e.z?e.z=r.z:r.z>t.z&&(t.z=r.z)}}computeWorldFaceNormals(e){const t=this.faceNormals.length;for(;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new cB);const n=this.faceNormals,i=this.worldFaceNormals;for(let r=0;r!==t;r++)e.vmult(n[r],i[r]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let e=0;const t=this.vertices;for(let n=0;n!==t.length;n++){const i=t[n].lengthSquared();i>e&&(e=i)}this.boundingSphereRadius=Math.sqrt(e)}calculateWorldAABB(e,t,n,i){const r=this.vertices;let s,o,a,l,c,g,u=new cB;for(let A=0;A<r.length;A++){u.copy(r[A]),t.vmult(u,u),e.vadd(u,u);const n=u;(void 0===s||n.x<s)&&(s=n.x),(void 0===l||n.x>l)&&(l=n.x),(void 0===o||n.y<o)&&(o=n.y),(void 0===c||n.y>c)&&(c=n.y),(void 0===a||n.z<a)&&(a=n.z),(void 0===g||n.z>g)&&(g=n.z)}n.set(s,o,a),i.set(l,c,g)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(e){void 0===e&&(e=new cB);const t=this.vertices;for(let n=0;n<t.length;n++)e.vadd(t[n],e);return e.scale(1/t.length,e),e}transformAllPoints(e,t){const n=this.vertices.length,i=this.vertices;if(t){for(let e=0;e<n;e++){const n=i[e];t.vmult(n,n)}for(let e=0;e<this.faceNormals.length;e++){const n=this.faceNormals[e];t.vmult(n,n)}}if(e)for(let r=0;r<n;r++){const t=i[r];t.vadd(e,t)}}pointIsInside(e){const t=this.vertices,n=this.faces,i=this.faceNormals,r=new cB;this.getAveragePointLocal(r);for(let s=0;s<this.faces.length;s++){let o=i[s];const a=t[n[s][0]],l=new cB;e.vsub(a,l);const c=o.dot(l),g=new cB;r.vsub(a,g);const u=o.dot(g);if(c<0&&u>0||c>0&&u<0)return!1}return-1}static project(e,t,n,i,r){const s=e.vertices.length,o=EB;let a=0,l=0;const c=xB,g=e.vertices;c.setZero(),bB.vectorToLocalFrame(n,i,t,o),bB.pointToLocalFrame(n,i,c,c);const u=c.dot(o);l=a=g[0].dot(o);for(let A=1;A<s;A++){const e=g[A].dot(o);e>a&&(a=e),e<l&&(l=e)}if(l-=u,a-=u,l>a){const e=l;l=a,a=e}r[0]=a,r[1]=l}}const wB=[],GB=[];new cB;const EB=new cB,xB=new cB;class SB extends yB{constructor(e){super({type:yB.types.BOX}),this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const e=this.halfExtents.x,t=this.halfExtents.y,n=this.halfExtents.z,i=cB,r=[new i(-e,-t,-n),new i(e,-t,-n),new i(e,t,-n),new i(-e,t,-n),new i(-e,-t,n),new i(e,-t,n),new i(e,t,n),new i(-e,t,n)],s=[new i(0,0,1),new i(0,1,0),new i(1,0,0)],o=new vB({vertices:r,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:s});this.convexPolyhedronRepresentation=o,o.material=this.material}calculateLocalInertia(e,t){return void 0===t&&(t=new cB),SB.calculateInertia(this.halfExtents,e,t),t}static calculateInertia(e,t,n){const i=e;n.x=1/12*t*(2*i.y*2*i.y+2*i.z*2*i.z),n.y=1/12*t*(2*i.x*2*i.x+2*i.z*2*i.z),n.z=1/12*t*(2*i.y*2*i.y+2*i.x*2*i.x)}getSideNormals(e,t){const n=e,i=this.halfExtents;if(n[0].set(i.x,0,0),n[1].set(0,i.y,0),n[2].set(0,0,i.z),n[3].set(-i.x,0,0),n[4].set(0,-i.y,0),n[5].set(0,0,-i.z),void 0!==t)for(let r=0;r!==n.length;r++)t.vmult(n[r],n[r]);return n}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(e,t,n){const i=this.halfExtents,r=[[i.x,i.y,i.z],[-i.x,i.y,i.z],[-i.x,-i.y,i.z],[-i.x,-i.y,-i.z],[i.x,-i.y,-i.z],[i.x,i.y,-i.z],[-i.x,i.y,-i.z],[i.x,-i.y,i.z]];for(let s=0;s<r.length;s++)RB.set(r[s][0],r[s][1],r[s][2]),t.vmult(RB,RB),e.vadd(RB,RB),n(RB.x,RB.y,RB.z)}calculateWorldAABB(e,t,n,i){const r=this.halfExtents;ZB[0].set(r.x,r.y,r.z),ZB[1].set(-r.x,r.y,r.z),ZB[2].set(-r.x,-r.y,r.z),ZB[3].set(-r.x,-r.y,-r.z),ZB[4].set(r.x,-r.y,-r.z),ZB[5].set(r.x,r.y,-r.z),ZB[6].set(-r.x,r.y,-r.z),ZB[7].set(r.x,-r.y,r.z);const s=ZB[0];t.vmult(s,s),e.vadd(s,s),i.copy(s),n.copy(s);for(let o=1;o<8;o++){const r=ZB[o];t.vmult(r,r),e.vadd(r,r);const s=r.x,a=r.y,l=r.z;s>i.x&&(i.x=s),a>i.y&&(i.y=a),l>i.z&&(i.z=l),s<n.x&&(n.x=s),a<n.y&&(n.y=a),l<n.z&&(n.z=l)}}}const RB=new cB,ZB=[new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB],DB=1,FB=2,NB=4,MB=0,WB=1,kB=2;class TB extends pB{constructor(e){void 0===e&&(e={}),super(),this.id=TB.idCounter++,this.index=-1,this.world=null,this.vlambda=new cB,this.collisionFilterGroup="number"===typeof e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask="number"===typeof e.collisionFilterMask?e.collisionFilterMask:-1,this.collisionResponse="boolean"!==typeof e.collisionResponse||e.collisionResponse,this.position=new cB,this.previousPosition=new cB,this.interpolatedPosition=new cB,this.initPosition=new cB,e.position&&(this.position.copy(e.position),this.previousPosition.copy(e.position),this.interpolatedPosition.copy(e.position),this.initPosition.copy(e.position)),this.velocity=new cB,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new cB,this.force=new cB;const t="number"===typeof e.mass?e.mass:0;this.mass=t,this.invMass=t>0?1/t:0,this.material=e.material||null,this.linearDamping="number"===typeof e.linearDamping?e.linearDamping:.01,this.type=t<=0?TB.STATIC:TB.DYNAMIC,typeof e.type===typeof TB.STATIC&&(this.type=e.type),this.allowSleep="undefined"===typeof e.allowSleep||e.allowSleep,this.sleepState=TB.AWAKE,this.sleepSpeedLimit="undefined"!==typeof e.sleepSpeedLimit?e.sleepSpeedLimit:.1,this.sleepTimeLimit="undefined"!==typeof e.sleepTimeLimit?e.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new cB,this.quaternion=new CB,this.initQuaternion=new CB,this.previousQuaternion=new CB,this.interpolatedQuaternion=new CB,e.quaternion&&(this.quaternion.copy(e.quaternion),this.initQuaternion.copy(e.quaternion),this.previousQuaternion.copy(e.quaternion),this.interpolatedQuaternion.copy(e.quaternion)),this.angularVelocity=new cB,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new cB,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new cB,this.invInertia=new cB,this.invInertiaWorld=new aB,this.invMassSolve=0,this.invInertiaSolve=new cB,this.invInertiaWorldSolve=new aB,this.fixedRotation="undefined"!==typeof e.fixedRotation&&e.fixedRotation,this.angularDamping="undefined"!==typeof e.angularDamping?e.angularDamping:.01,this.linearFactor=new cB(1,1,1),e.linearFactor&&this.linearFactor.copy(e.linearFactor),this.angularFactor=new cB(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.aabb=new dB,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new cB,this.isTrigger=Boolean(e.isTrigger),e.shape&&this.addShape(e.shape),this.updateMassProperties()}wakeUp(){const e=this.sleepState;this.sleepState=TB.AWAKE,this.wakeUpAfterNarrowphase=!1,e===TB.SLEEPING&&this.dispatchEvent(TB.wakeupEvent)}sleep(){this.sleepState=TB.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(e){if(this.allowSleep){const t=this.sleepState,n=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),i=this.sleepSpeedLimit**2;t===TB.AWAKE&&n<i?(this.sleepState=TB.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(TB.sleepyEvent)):t===TB.SLEEPY&&n>i?this.wakeUp():t===TB.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(TB.sleepEvent))}}updateSolveMassProperties(){this.sleepState===TB.SLEEPING||this.type===TB.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(e,t){return void 0===t&&(t=new cB),e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t}vectorToLocalFrame(e,t){return void 0===t&&(t=new cB),this.quaternion.conjugate().vmult(e,t),t}pointToWorldFrame(e,t){return void 0===t&&(t=new cB),this.quaternion.vmult(e,t),t.vadd(this.position,t),t}vectorToWorldFrame(e,t){return void 0===t&&(t=new cB),this.quaternion.vmult(e,t),t}addShape(e,t,n){const i=new cB,r=new CB;return t&&i.copy(t),n&&r.copy(n),this.shapes.push(e),this.shapeOffsets.push(i),this.shapeOrientations.push(r),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this}removeShape(e){const t=this.shapes.indexOf(e);return-1===t?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(t,1),this.shapeOffsets.splice(t,1),this.shapeOrientations.splice(t,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=null,this)}updateBoundingRadius(){const e=this.shapes,t=this.shapeOffsets,n=e.length;let i=0;for(let r=0;r!==n;r++){const n=e[r];n.updateBoundingSphereRadius();const s=t[r].length(),o=n.boundingSphereRadius;s+o>i&&(i=s+o)}this.boundingRadius=i}updateAABB(){const e=this.shapes,t=this.shapeOffsets,n=this.shapeOrientations,i=e.length,r=VB,s=LB,o=this.quaternion,a=this.aabb,l=HB;for(let c=0;c!==i;c++){const i=e[c];o.vmult(t[c],r),r.vadd(this.position,r),o.mult(n[c],s),i.calculateWorldAABB(r,s,l.lowerBound,l.upperBound),0===c?a.copy(l):a.extend(l)}this.aabbNeedsUpdate=!1}updateInertiaWorld(e){const t=this.invInertia;if(t.x!==t.y||t.y!==t.z||e){const e=QB,n=KB;e.setRotationFromQuaternion(this.quaternion),e.transpose(n),e.scale(t,e),e.mmult(n,this.invInertiaWorld)}else;}applyForce(e,t){if(void 0===t&&(t=new cB),this.type!==TB.DYNAMIC)return;this.sleepState===TB.SLEEPING&&this.wakeUp();const n=XB;t.cross(e,n),this.force.vadd(e,this.force),this.torque.vadd(n,this.torque)}applyLocalForce(e,t){if(void 0===t&&(t=new cB),this.type!==TB.DYNAMIC)return;const n=YB,i=zB;this.vectorToWorldFrame(e,n),this.vectorToWorldFrame(t,i),this.applyForce(n,i)}applyTorque(e){this.type===TB.DYNAMIC&&(this.sleepState===TB.SLEEPING&&this.wakeUp(),this.torque.vadd(e,this.torque))}applyImpulse(e,t){if(void 0===t&&(t=new cB),this.type!==TB.DYNAMIC)return;this.sleepState===TB.SLEEPING&&this.wakeUp();const n=t,i=PB;i.copy(e),i.scale(this.invMass,i),this.velocity.vadd(i,this.velocity);const r=UB;n.cross(e,r),this.invInertiaWorld.vmult(r,r),this.angularVelocity.vadd(r,this.angularVelocity)}applyLocalImpulse(e,t){if(void 0===t&&(t=new cB),this.type!==TB.DYNAMIC)return;const n=_B,i=OB;this.vectorToWorldFrame(e,n),this.vectorToWorldFrame(t,i),this.applyImpulse(n,i)}updateMassProperties(){const e=JB;this.invMass=this.mass>0?1/this.mass:0;const t=this.inertia,n=this.fixedRotation;this.updateAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),SB.calculateInertia(e,this.mass,t),this.invInertia.set(t.x>0&&!n?1/t.x:0,t.y>0&&!n?1/t.y:0,t.z>0&&!n?1/t.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(e,t){const n=new cB;return e.vsub(this.position,n),this.angularVelocity.cross(n,t),this.velocity.vadd(t,t),t}integrate(e,t,n){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),this.type!==TB.DYNAMIC&&this.type!==TB.KINEMATIC||this.sleepState===TB.SLEEPING)return;const i=this.velocity,r=this.angularVelocity,s=this.position,o=this.force,a=this.torque,l=this.quaternion,c=this.invMass,g=this.invInertiaWorld,u=this.linearFactor,A=c*e;i.x+=o.x*A*u.x,i.y+=o.y*A*u.y,i.z+=o.z*A*u.z;const d=g.elements,h=this.angularFactor,I=a.x*h.x,p=a.y*h.y,C=a.z*h.z;r.x+=e*(d[0]*I+d[1]*p+d[2]*C),r.y+=e*(d[3]*I+d[4]*p+d[5]*C),r.z+=e*(d[6]*I+d[7]*p+d[8]*C),s.x+=i.x*e,s.y+=i.y*e,s.z+=i.z*e,l.integrate(this.angularVelocity,e,this.angularFactor,l),t&&(n?l.normalizeFast():l.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}TB.idCounter=0,TB.COLLIDE_EVENT_NAME="collide",TB.DYNAMIC=DB,TB.STATIC=FB,TB.KINEMATIC=NB,TB.AWAKE=MB,TB.SLEEPY=WB,TB.SLEEPING=kB,TB.wakeupEvent={type:"wakeup"},TB.sleepyEvent={type:"sleepy"},TB.sleepEvent={type:"sleep"};const VB=new cB,LB=new CB,HB=new dB,QB=new aB,KB=new aB;new aB;const XB=new cB,YB=new cB,zB=new cB,PB=new cB,UB=new cB,_B=new cB,OB=new cB,JB=new cB;new cB,new cB,new CB,new cB,new cB,new cB,new cB;class jB{constructor(){this.rayFromWorld=new cB,this.rayToWorld=new cB,this.hitNormalWorld=new cB,this.hitPointWorld=new cB,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,t,n,i,r,s,o){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(n),this.hitPointWorld.copy(i),this.shape=r,this.body=s,this.distance=o}}let qB,$B,ev,tv,nv,iv,rv;const sv=1,ov=2,av=4;qB=yB.types.SPHERE,$B=yB.types.PLANE,ev=yB.types.BOX,tv=yB.types.CYLINDER,nv=yB.types.CONVEXPOLYHEDRON,iv=yB.types.HEIGHTFIELD,rv=yB.types.TRIMESH;class lv{get[qB](){return this._intersectSphere}get[$B](){return this._intersectPlane}get[ev](){return this._intersectBox}get[tv](){return this._intersectConvex}get[nv](){return this._intersectConvex}get[iv](){return this._intersectHeightfield}get[rv](){return this._intersectTrimesh}constructor(e,t){void 0===e&&(e=new cB),void 0===t&&(t=new cB),this.from=e.clone(),this.to=t.clone(),this.direction=new cB,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=lv.ANY,this.result=new jB,this.hasHit=!1,this.callback=e=>{}}intersectWorld(e,t){return this.mode=t.mode||lv.ANY,this.result=t.result||new jB,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask="undefined"!==typeof t.collisionFilterMask?t.collisionFilterMask:-1,this.collisionFilterGroup="undefined"!==typeof t.collisionFilterGroup?t.collisionFilterGroup:-1,this.checkCollisionResponse="undefined"===typeof t.checkCollisionResponse||t.checkCollisionResponse,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(cv),gv.length=0,e.broadphase.aabbQuery(e,cv,gv),this.intersectBodies(gv),this.hasHit}intersectBody(e,t){t&&(this.result=t,this.updateDirection());const n=this.checkCollisionResponse;if(n&&!e.collisionResponse)return;if(0===(this.collisionFilterGroup&e.collisionFilterMask)||0===(e.collisionFilterGroup&this.collisionFilterMask))return;const i=dv,r=hv;for(let s=0,o=e.shapes.length;s<o;s++){const t=e.shapes[s];if((!n||t.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[s],r),e.quaternion.vmult(e.shapeOffsets[s],i),i.vadd(e.position,i),this.intersectShape(t,r,i,e),this.result.shouldStop))break}}intersectBodies(e,t){t&&(this.result=t,this.updateDirection());for(let n=0,i=e.length;!this.result.shouldStop&&n<i;n++)this.intersectBody(e[n])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,t,n,i){const r=function(e,t,n){n.vsub(e,Wv);const i=Wv.dot(t);t.scale(i,kv),kv.vadd(e,kv);const r=n.distanceTo(kv);return r}(this.from,this.direction,n);if(r>e.boundingSphereRadius)return;const s=this[e.type];s&&s.call(this,e,t,n,i,e)}_intersectBox(e,t,n,i,r){return this._intersectConvex(e.convexPolyhedronRepresentation,t,n,i,r)}_intersectPlane(e,t,n,i,r){const s=this.from,o=this.to,a=this.direction,l=new cB(0,0,1);t.vmult(l,l);const c=new cB;s.vsub(n,c);const g=c.dot(l);o.vsub(n,c);if(g*c.dot(l)>0)return;if(s.distanceTo(o)<g)return;const u=l.dot(a);if(Math.abs(u)<this.precision)return;const A=new cB,d=new cB,h=new cB;s.vsub(n,A);const I=-l.dot(A)/u;a.scale(I,d),s.vadd(d,h),this.reportIntersection(l,h,r,i,-1)}getAABB(e){const{lowerBound:t,upperBound:n}=e,i=this.to,r=this.from;t.x=Math.min(i.x,r.x),t.y=Math.min(i.y,r.y),t.z=Math.min(i.z,r.z),n.x=Math.max(i.x,r.x),n.y=Math.max(i.y,r.y),n.z=Math.max(i.z,r.z)}_intersectHeightfield(e,t,n,i,r){e.data,e.elementSize;const s=bv;s.from.copy(this.from),s.to.copy(this.to),bB.pointToLocalFrame(n,t,s.from,s.from),bB.pointToLocalFrame(n,t,s.to,s.to),s.updateDirection();const o=Bv;let a,l,c,g;a=l=0,c=g=e.data.length-1;const u=new dB;s.getAABB(u),e.getIndexOfPosition(u.lowerBound.x,u.lowerBound.y,o,!0),a=Math.max(a,o[0]),l=Math.max(l,o[1]),e.getIndexOfPosition(u.upperBound.x,u.upperBound.y,o,!0),c=Math.min(c,o[0]+1),g=Math.min(g,o[1]+1);for(let A=a;A<c;A++)for(let o=l;o<g;o++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(A,o,u),u.overlapsRay(s)){if(e.getConvexTrianglePillar(A,o,!1),bB.pointToWorldFrame(n,t,e.pillarOffset,yv),this._intersectConvex(e.pillarConvex,t,yv,i,r,fv),this.result.shouldStop)return;e.getConvexTrianglePillar(A,o,!0),bB.pointToWorldFrame(n,t,e.pillarOffset,yv),this._intersectConvex(e.pillarConvex,t,yv,i,r,fv)}}}_intersectSphere(e,t,n,i,r){const s=this.from,o=this.to,a=e.radius,l=(o.x-s.x)**2+(o.y-s.y)**2+(o.z-s.z)**2,c=2*((o.x-s.x)*(s.x-n.x)+(o.y-s.y)*(s.y-n.y)+(o.z-s.z)*(s.z-n.z)),g=c**2-4*l*((s.x-n.x)**2+(s.y-n.y)**2+(s.z-n.z)**2-a**2),u=vv,A=wv;if(!(g<0))if(0===g)s.lerp(o,g,u),u.vsub(n,A),A.normalize(),this.reportIntersection(A,u,r,i,-1);else{const e=(-c-Math.sqrt(g))/(2*l),t=(-c+Math.sqrt(g))/(2*l);if(e>=0&&e<=1&&(s.lerp(o,e,u),u.vsub(n,A),A.normalize(),this.reportIntersection(A,u,r,i,-1)),this.result.shouldStop)return;t>=0&&t<=1&&(s.lerp(o,t,u),u.vsub(n,A),A.normalize(),this.reportIntersection(A,u,r,i,-1))}}_intersectConvex(e,t,n,i,r,s){const o=Gv,a=Ev,l=s&&s.faceList||null,c=e.faces,g=e.vertices,u=e.faceNormals,A=this.direction,d=this.from,h=this.to,I=d.distanceTo(h),p=l?l.length:c.length,C=this.result;for(let m=0;!C.shouldStop&&m<p;m++){const e=l?l[m]:m,s=c[e],h=u[e],p=t,f=n;a.copy(g[s[0]]),p.vmult(a,a),a.vadd(f,a),a.vsub(d,a),p.vmult(h,o);const y=A.dot(o);if(Math.abs(y)<this.precision)continue;const b=o.dot(a)/y;if(!(b<0)){A.scale(b,Iv),Iv.vadd(d,Iv),pv.copy(g[s[0]]),p.vmult(pv,pv),f.vadd(pv,pv);for(let t=1;!C.shouldStop&&t<s.length-1;t++){Cv.copy(g[s[t]]),mv.copy(g[s[t+1]]),p.vmult(Cv,Cv),p.vmult(mv,mv),f.vadd(Cv,Cv),f.vadd(mv,mv);const n=Iv.distanceTo(d);!lv.pointInTriangle(Iv,pv,Cv,mv)&&!lv.pointInTriangle(Iv,Cv,pv,mv)||n>I||this.reportIntersection(o,Iv,r,i,e)}}}}_intersectTrimesh(e,t,n,i,r,s){const o=xv,a=Nv,l=Mv,c=Ev,g=Sv,u=Rv,A=Zv,d=Fv,h=Dv,I=e.indices;e.vertices;const p=this.from,C=this.to,m=this.direction;l.position.copy(n),l.quaternion.copy(t),bB.vectorToLocalFrame(n,t,m,g),bB.pointToLocalFrame(n,t,p,u),bB.pointToLocalFrame(n,t,C,A),A.x*=e.scale.x,A.y*=e.scale.y,A.z*=e.scale.z,u.x*=e.scale.x,u.y*=e.scale.y,u.z*=e.scale.z,A.vsub(u,g),g.normalize();const f=u.distanceSquared(A);e.tree.rayQuery(this,l,a);for(let y=0,b=a.length;!this.result.shouldStop&&y!==b;y++){const s=a[y];e.getNormal(s,o),e.getVertex(I[3*s],pv),pv.vsub(u,c);const l=g.dot(o),A=o.dot(c)/l;if(A<0)continue;g.scale(A,Iv),Iv.vadd(u,Iv),e.getVertex(I[3*s+1],Cv),e.getVertex(I[3*s+2],mv);const p=Iv.distanceSquared(u);!lv.pointInTriangle(Iv,Cv,pv,mv)&&!lv.pointInTriangle(Iv,pv,Cv,mv)||p>f||(bB.vectorToWorldFrame(t,o,h),bB.pointToWorldFrame(n,t,Iv,d),this.reportIntersection(h,d,r,i,s))}a.length=0}reportIntersection(e,t,n,i,r){const s=this.from,o=this.to,a=s.distanceTo(t),l=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(l.hitFaceIndex="undefined"!==typeof r?r:-1,this.mode){case lv.ALL:this.hasHit=!0,l.set(s,o,e,t,n,i,a),l.hasHit=!0,this.callback(l);break;case lv.CLOSEST:(a<l.distance||!l.hasHit)&&(this.hasHit=!0,l.hasHit=!0,l.set(s,o,e,t,n,i,a));break;case lv.ANY:this.hasHit=!0,l.hasHit=!0,l.set(s,o,e,t,n,i,a),l.shouldStop=!0}}static pointInTriangle(e,t,n,i){i.vsub(t,Wv),n.vsub(t,uv),e.vsub(t,Av);const r=Wv.dot(Wv),s=Wv.dot(uv),o=Wv.dot(Av),a=uv.dot(uv),l=uv.dot(Av);let c,g;return(c=a*o-s*l)>=0&&(g=r*l-s*o)>=0&&c+g<r*a-s*s}}lv.CLOSEST=sv,lv.ANY=ov,lv.ALL=av;const cv=new dB,gv=[],uv=new cB,Av=new cB,dv=new cB,hv=new CB,Iv=new cB,pv=new cB,Cv=new cB,mv=new cB;new cB,new jB;const fv={faceList:[0]},yv=new cB,bv=new lv,Bv=[],vv=new cB,wv=new cB,Gv=new cB;new cB,new cB;const Ev=new cB,xv=new cB,Sv=new cB,Rv=new cB,Zv=new cB,Dv=new cB,Fv=new cB;new dB;const Nv=[],Mv=new bB,Wv=new cB,kv=new cB;new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB;class Tv{constructor(e){void 0===e&&(e={});let t="";"string"===typeof e&&(t=e,e={}),this.name=t,this.id=Tv.idCounter++,this.friction="undefined"!==typeof e.friction?e.friction:-1,this.restitution="undefined"!==typeof e.restitution?e.restitution:-1}}Tv.idCounter=0,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new lv,new cB,new cB,new cB,new cB(1,0,0),new cB(0,1,0),new cB(0,0,1),new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB;new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB;new cB;new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB;new cB,new dB;new cB,new dB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new dB,new cB,new bB,new dB;yB.types.SPHERE,yB.types.SPHERE,yB.types.PLANE,yB.types.BOX,yB.types.BOX,yB.types.SPHERE,yB.types.BOX,yB.types.PLANE,yB.types.BOX,yB.types.CONVEXPOLYHEDRON,yB.types.SPHERE,yB.types.CONVEXPOLYHEDRON,yB.types.PLANE,yB.types.CONVEXPOLYHEDRON,yB.types.BOX,yB.types.CONVEXPOLYHEDRON,yB.types.SPHERE,yB.types.HEIGHTFIELD,yB.types.BOX,yB.types.HEIGHTFIELD,yB.types.CONVEXPOLYHEDRON,yB.types.HEIGHTFIELD,yB.types.PARTICLE,yB.types.SPHERE,yB.types.PLANE,yB.types.PARTICLE,yB.types.BOX,yB.types.PARTICLE,yB.types.PARTICLE,yB.types.CONVEXPOLYHEDRON,yB.types.CYLINDER,yB.types.SPHERE,yB.types.CYLINDER,yB.types.PLANE,yB.types.CYLINDER,yB.types.BOX,yB.types.CYLINDER,yB.types.CONVEXPOLYHEDRON,yB.types.CYLINDER,yB.types.HEIGHTFIELD,yB.types.CYLINDER,yB.types.PARTICLE,yB.types.CYLINDER,yB.types.SPHERE,yB.types.TRIMESH,yB.types.PLANE,yB.types.TRIMESH,new cB,new cB,new cB,new cB,new cB,new CB,new CB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new dB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new CB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new cB,new dB,new lv;const Vv=globalThis.performance||{};if(!Vv.now){let e=Date.now();Vv.timing&&Vv.timing.navigationStart&&(e=Vv.timing.navigationStart),Vv.now=()=>Date.now()-e}new cB;class Lv{constructor(e){void 0===e&&(e=[0,0,0,0,0,0,0,0,0]),this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}getTrace(e){void 0===e&&(e=new Qv);const t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}vmult(e,t){void 0===t&&(t=new Qv);const n=this.elements,i=e.x,r=e.y,s=e.z;return t.x=n[0]*i+n[1]*r+n[2]*s,t.y=n[3]*i+n[4]*r+n[5]*s,t.z=n[6]*i+n[7]*r+n[8]*s,t}smult(e){for(let t=0;t<this.elements.length;t++)this.elements[t]*=e}mmult(e,t){void 0===t&&(t=new Lv);const n=this.elements,i=e.elements,r=t.elements,s=n[0],o=n[1],a=n[2],l=n[3],c=n[4],g=n[5],u=n[6],A=n[7],d=n[8],h=i[0],I=i[1],p=i[2],C=i[3],m=i[4],f=i[5],y=i[6],b=i[7],B=i[8];return r[0]=s*h+o*C+a*y,r[1]=s*I+o*m+a*b,r[2]=s*p+o*f+a*B,r[3]=l*h+c*C+g*y,r[4]=l*I+c*m+g*b,r[5]=l*p+c*f+g*B,r[6]=u*h+A*C+d*y,r[7]=u*I+A*m+d*b,r[8]=u*p+A*f+d*B,t}scale(e,t){void 0===t&&(t=new Lv);const n=this.elements,i=t.elements;for(let r=0;3!==r;r++)i[3*r+0]=e.x*n[3*r+0],i[3*r+1]=e.y*n[3*r+1],i[3*r+2]=e.z*n[3*r+2];return t}solve(e,t){void 0===t&&(t=new Qv);const n=[];let i,r;for(i=0;i<12;i++)n.push(0);for(i=0;i<3;i++)for(r=0;r<3;r++)n[i+4*r]=this.elements[i+3*r];n[3]=e.x,n[7]=e.y,n[11]=e.z;let s=3;const o=s;let a;let l;do{if(i=o-s,0===n[i+4*i])for(r=i+1;r<o;r++)if(0!==n[i+4*r]){a=4;do{l=4-a,n[l+4*i]+=n[l+4*r]}while(--a);break}if(0!==n[i+4*i])for(r=i+1;r<o;r++){const e=n[i+4*r]/n[i+4*i];a=4;do{l=4-a,n[l+4*r]=l<=i?0:n[l+4*r]-n[l+4*i]*e}while(--a)}}while(--s);if(t.z=n[11]/n[10],t.y=(n[7]-n[6]*t.z)/n[5],t.x=(n[3]-n[2]*t.z-n[1]*t.y)/n[0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw"Could not solve equation! Got x=[".concat(t.toString(),"], b=[").concat(e.toString(),"], A=[").concat(this.toString(),"]");return t}e(e,t,n){if(void 0===n)return this.elements[t+3*e];this.elements[t+3*e]=n}copy(e){for(let t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}toString(){let e="";for(let t=0;t<9;t++)e+=this.elements[t]+",";return e}reverse(e){void 0===e&&(e=new Lv);const t=Hv;let n,i;for(n=0;n<3;n++)for(i=0;i<3;i++)t[n+6*i]=this.elements[n+3*i];t[3]=1,t[9]=0,t[15]=0,t[4]=0,t[10]=1,t[16]=0,t[5]=0,t[11]=0,t[17]=1;let r=3;const s=r;let o;let a;do{if(n=s-r,0===t[n+6*n])for(i=n+1;i<s;i++)if(0!==t[n+6*i]){o=6;do{a=6-o,t[a+6*n]+=t[a+6*i]}while(--o);break}if(0!==t[n+6*n])for(i=n+1;i<s;i++){const e=t[n+6*i]/t[n+6*n];o=6;do{a=6-o,t[a+6*i]=a<=n?0:t[a+6*i]-t[a+6*n]*e}while(--o)}}while(--r);n=2;do{i=n-1;do{const e=t[n+6*i]/t[n+6*n];o=6;do{a=6-o,t[a+6*i]=t[a+6*i]-t[a+6*n]*e}while(--o)}while(i--)}while(--n);n=2;do{const e=1/t[n+6*n];o=6;do{a=6-o,t[a+6*n]=t[a+6*n]*e}while(--o)}while(n--);n=2;do{i=2;do{if(a=t[3+i+6*n],isNaN(a)||a===1/0)throw"Could not reverse! A=[".concat(this.toString(),"]");e.e(n,i,a)}while(i--)}while(n--);return e}setRotationFromQuaternion(e){const t=e.x,n=e.y,i=e.z,r=e.w,s=t+t,o=n+n,a=i+i,l=t*s,c=t*o,g=t*a,u=n*o,A=n*a,d=i*a,h=r*s,I=r*o,p=r*a,C=this.elements;return C[0]=1-(u+d),C[1]=c-p,C[2]=g+I,C[3]=c+p,C[4]=1-(l+d),C[5]=A-h,C[6]=g-I,C[7]=A+h,C[8]=1-(l+u),this}transpose(e){void 0===e&&(e=new Lv);const t=this.elements,n=e.elements;let i;return n[0]=t[0],n[4]=t[4],n[8]=t[8],i=t[1],n[1]=t[3],n[3]=i,i=t[2],n[2]=t[6],n[6]=i,i=t[5],n[5]=t[7],n[7]=i,e}}const Hv=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class Qv{constructor(e,t,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),this.x=e,this.y=t,this.z=n}cross(e,t){void 0===t&&(t=new Qv);const n=e.x,i=e.y,r=e.z,s=this.x,o=this.y,a=this.z;return t.x=o*r-a*i,t.y=a*n-s*r,t.z=s*i-o*n,t}set(e,t,n){return this.x=e,this.y=t,this.z=n,this}setZero(){this.x=this.y=this.z=0}vadd(e,t){if(!t)return new Qv(this.x+e.x,this.y+e.y,this.z+e.z);t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z}vsub(e,t){if(!t)return new Qv(this.x-e.x,this.y-e.y,this.z-e.z);t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z}crossmat(){return new Lv([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,t=this.y,n=this.z,i=Math.sqrt(e*e+t*t+n*n);if(i>0){const e=1/i;this.x*=e,this.y*=e,this.z*=e}else this.x=0,this.y=0,this.z=0;return i}unit(e){void 0===e&&(e=new Qv);const t=this.x,n=this.y,i=this.z;let r=Math.sqrt(t*t+n*n+i*i);return r>0?(r=1/r,e.x=t*r,e.y=n*r,e.z=i*r):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,t=this.y,n=this.z;return Math.sqrt(e*e+t*t+n*n)}lengthSquared(){return this.dot(this)}distanceTo(e){const t=this.x,n=this.y,i=this.z,r=e.x,s=e.y,o=e.z;return Math.sqrt((r-t)*(r-t)+(s-n)*(s-n)+(o-i)*(o-i))}distanceSquared(e){const t=this.x,n=this.y,i=this.z,r=e.x,s=e.y,o=e.z;return(r-t)*(r-t)+(s-n)*(s-n)+(o-i)*(o-i)}scale(e,t){void 0===t&&(t=new Qv);const n=this.x,i=this.y,r=this.z;return t.x=e*n,t.y=e*i,t.z=e*r,t}vmul(e,t){return void 0===t&&(t=new Qv),t.x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t}addScaledVector(e,t,n){return void 0===n&&(n=new Qv),n.x=this.x+e*t.x,n.y=this.y+e*t.y,n.z=this.z+e*t.z,n}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(e){return void 0===e&&(e=new Qv),e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,t){const n=this.length();if(n>0){const i=Kv,r=1/n;i.set(this.x*r,this.y*r,this.z*r);const s=Xv;Math.abs(i.x)<.9?(s.set(1,0,0),i.cross(s,e)):(s.set(0,1,0),i.cross(s,e)),i.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}toString(){return"".concat(this.x,",").concat(this.y,",").concat(this.z)}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,t,n){const i=this.x,r=this.y,s=this.z;n.x=i+(e.x-i)*t,n.y=r+(e.y-r)*t,n.z=s+(e.z-s)*t}almostEquals(e,t){return void 0===t&&(t=1e-6),!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}almostZero(e){return void 0===e&&(e=1e-6),!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,t){return this.negate(Yv),Yv.almostEquals(e,t)}clone(){return new Qv(this.x,this.y,this.z)}}Qv.ZERO=new Qv(0,0,0),Qv.UNIT_X=new Qv(1,0,0),Qv.UNIT_Y=new Qv(0,1,0),Qv.UNIT_Z=new Qv(0,0,1);const Kv=new Qv,Xv=new Qv,Yv=new Qv;class zv{constructor(e){void 0===e&&(e={}),this.lowerBound=new Qv,this.upperBound=new Qv,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,t,n,i){const r=this.lowerBound,s=this.upperBound,o=n;r.copy(e[0]),o&&o.vmult(r,r),s.copy(r);for(let a=1;a<e.length;a++){let t=e[a];o&&(o.vmult(t,Pv),t=Pv),t.x>s.x&&(s.x=t.x),t.x<r.x&&(r.x=t.x),t.y>s.y&&(s.y=t.y),t.y<r.y&&(r.y=t.y),t.z>s.z&&(s.z=t.z),t.z<r.z&&(r.z=t.z)}return t&&(t.vadd(r,r),t.vadd(s,s)),i&&(r.x-=i,r.y-=i,r.z-=i,s.x+=i,s.y+=i,s.z+=i),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return(new zv).copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const t=this.lowerBound,n=this.upperBound,i=e.lowerBound,r=e.upperBound,s=i.x<=n.x&&n.x<=r.x||t.x<=r.x&&r.x<=n.x,o=i.y<=n.y&&n.y<=r.y||t.y<=r.y&&r.y<=n.y,a=i.z<=n.z&&n.z<=r.z||t.z<=r.z&&r.z<=n.z;return s&&o&&a}volume(){const e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}contains(e){const t=this.lowerBound,n=this.upperBound,i=e.lowerBound,r=e.upperBound;return t.x<=i.x&&n.x>=r.x&&t.y<=i.y&&n.y>=r.y&&t.z<=i.z&&n.z>=r.z}getCorners(e,t,n,i,r,s,o,a){const l=this.lowerBound,c=this.upperBound;e.copy(l),t.set(c.x,l.y,l.z),n.set(c.x,c.y,l.z),i.set(l.x,c.y,c.z),r.set(c.x,l.y,c.z),s.set(l.x,c.y,l.z),o.set(l.x,l.y,c.z),a.copy(c)}toLocalFrame(e,t){const n=Uv,i=n[0],r=n[1],s=n[2],o=n[3],a=n[4],l=n[5],c=n[6],g=n[7];this.getCorners(i,r,s,o,a,l,c,g);for(let u=0;8!==u;u++){const t=n[u];e.pointToLocal(t,t)}return t.setFromPoints(n)}toWorldFrame(e,t){const n=Uv,i=n[0],r=n[1],s=n[2],o=n[3],a=n[4],l=n[5],c=n[6],g=n[7];this.getCorners(i,r,s,o,a,l,c,g);for(let u=0;8!==u;u++){const t=n[u];e.pointToWorld(t,t)}return t.setFromPoints(n)}overlapsRay(e){const{direction:t,from:n}=e,i=1/t.x,r=1/t.y,s=1/t.z,o=(this.lowerBound.x-n.x)*i,a=(this.upperBound.x-n.x)*i,l=(this.lowerBound.y-n.y)*r,c=(this.upperBound.y-n.y)*r,g=(this.lowerBound.z-n.z)*s,u=(this.upperBound.z-n.z)*s,A=Math.max(Math.max(Math.min(o,a),Math.min(l,c)),Math.min(g,u)),d=Math.min(Math.min(Math.max(o,a),Math.max(l,c)),Math.max(g,u));return!(d<0)&&!(A>d)}}const Pv=new Qv,Uv=[new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv];class _v{constructor(e,t,n,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===i&&(i=1),this.x=e,this.y=t,this.z=n,this.w=i}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}toString(){return"".concat(this.x,",").concat(this.y,",").concat(this.z,",").concat(this.w)}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,t){const n=Math.sin(.5*t);return this.x=e.x*n,this.y=e.y*n,this.z=e.z*n,this.w=Math.cos(.5*t),this}toAxisAngle(e){void 0===e&&(e=new Qv),this.normalize();const t=2*Math.acos(this.w),n=Math.sqrt(1-this.w*this.w);return n<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/n,e.y=this.y/n,e.z=this.z/n),[e,t]}setFromVectors(e,t){if(e.isAntiparallelTo(t)){const t=Ov,n=Jv;e.tangents(t,n),this.setFromAxisAngle(t,Math.PI)}else{const n=e.cross(t);this.x=n.x,this.y=n.y,this.z=n.z,this.w=Math.sqrt(e.length()**2*t.length()**2)+e.dot(t),this.normalize()}return this}mult(e,t){void 0===t&&(t=new _v);const n=this.x,i=this.y,r=this.z,s=this.w,o=e.x,a=e.y,l=e.z,c=e.w;return t.x=n*c+s*o+i*l-r*a,t.y=i*c+s*a+r*o-n*l,t.z=r*c+s*l+n*a-i*o,t.w=s*c-n*o-i*a-r*l,t}inverse(e){void 0===e&&(e=new _v);const t=this.x,n=this.y,i=this.z,r=this.w;this.conjugate(e);const s=1/(t*t+n*n+i*i+r*r);return e.x*=s,e.y*=s,e.z*=s,e.w*=s,e}conjugate(e){return void 0===e&&(e=new _v),e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,t){void 0===t&&(t=new Qv);const n=e.x,i=e.y,r=e.z,s=this.x,o=this.y,a=this.z,l=this.w,c=l*n+o*r-a*i,g=l*i+a*n-s*r,u=l*r+s*i-o*n,A=-s*n-o*i-a*r;return t.x=c*l+A*-s+g*-a-u*-o,t.y=g*l+A*-o+u*-s-c*-a,t.z=u*l+A*-a+c*-o-g*-s,t}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,t){let n,i,r;void 0===t&&(t="YZX");const s=this.x,o=this.y,a=this.z,l=this.w;if("YZX"!==t)throw new Error("Euler order ".concat(t," not supported yet."));{const e=s*o+a*l;if(e>.499&&(n=2*Math.atan2(s,l),i=Math.PI/2,r=0),e<-.499&&(n=-2*Math.atan2(s,l),i=-Math.PI/2,r=0),void 0===n){const t=s*s,c=o*o,g=a*a;n=Math.atan2(2*o*l-2*s*a,1-2*c-2*g),i=Math.asin(2*e),r=Math.atan2(2*s*l-2*o*a,1-2*t-2*g)}}e.y=n,e.z=i,e.x=r}setFromEuler(e,t,n,i){void 0===i&&(i="XYZ");const r=Math.cos(e/2),s=Math.cos(t/2),o=Math.cos(n/2),a=Math.sin(e/2),l=Math.sin(t/2),c=Math.sin(n/2);return"XYZ"===i?(this.x=a*s*o+r*l*c,this.y=r*l*o-a*s*c,this.z=r*s*c+a*l*o,this.w=r*s*o-a*l*c):"YXZ"===i?(this.x=a*s*o+r*l*c,this.y=r*l*o-a*s*c,this.z=r*s*c-a*l*o,this.w=r*s*o+a*l*c):"ZXY"===i?(this.x=a*s*o-r*l*c,this.y=r*l*o+a*s*c,this.z=r*s*c+a*l*o,this.w=r*s*o-a*l*c):"ZYX"===i?(this.x=a*s*o-r*l*c,this.y=r*l*o+a*s*c,this.z=r*s*c-a*l*o,this.w=r*s*o+a*l*c):"YZX"===i?(this.x=a*s*o+r*l*c,this.y=r*l*o+a*s*c,this.z=r*s*c-a*l*o,this.w=r*s*o-a*l*c):"XZY"===i&&(this.x=a*s*o-r*l*c,this.y=r*l*o-a*s*c,this.z=r*s*c+a*l*o,this.w=r*s*o+a*l*c),this}clone(){return new _v(this.x,this.y,this.z,this.w)}slerp(e,t,n){void 0===n&&(n=new _v);const i=this.x,r=this.y,s=this.z,o=this.w;let a,l,c,g,u,A=e.x,d=e.y,h=e.z,I=e.w;return l=i*A+r*d+s*h+o*I,l<0&&(l=-l,A=-A,d=-d,h=-h,I=-I),1-l>1e-6?(a=Math.acos(l),c=Math.sin(a),g=Math.sin((1-t)*a)/c,u=Math.sin(t*a)/c):(g=1-t,u=t),n.x=g*i+u*A,n.y=g*r+u*d,n.z=g*s+u*h,n.w=g*o+u*I,n}integrate(e,t,n,i){void 0===i&&(i=new _v);const r=e.x*n.x,s=e.y*n.y,o=e.z*n.z,a=this.x,l=this.y,c=this.z,g=this.w,u=.5*t;return i.x+=u*(r*g+s*c-o*l),i.y+=u*(s*g+o*a-r*c),i.z+=u*(o*g+r*l-s*a),i.w+=u*(-r*a-s*l-o*c),i}}const Ov=new Qv,Jv=new Qv;class jv{constructor(e){void 0===e&&(e={}),this.id=jv.idCounter++,this.type=e.type||0,this.boundingSphereRadius=0,this.collisionResponse=!e.collisionResponse||e.collisionResponse,this.collisionFilterGroup=void 0!==e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask=void 0!==e.collisionFilterMask?e.collisionFilterMask:-1,this.material=e.material?e.material:null,this.body=null}updateBoundingSphereRadius(){throw"computeBoundingSphereRadius() not implemented for shape type ".concat(this.type)}volume(){throw"volume() not implemented for shape type ".concat(this.type)}calculateLocalInertia(e,t){throw"calculateLocalInertia() not implemented for shape type ".concat(this.type)}calculateWorldAABB(e,t,n,i){throw"calculateWorldAABB() not implemented for shape type ".concat(this.type)}}jv.idCounter=0,jv.types={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};class qv{constructor(e){void 0===e&&(e={}),this.position=new Qv,this.quaternion=new _v,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,t){return qv.pointToLocalFrame(this.position,this.quaternion,e,t)}pointToWorld(e,t){return qv.pointToWorldFrame(this.position,this.quaternion,e,t)}vectorToWorldFrame(e,t){return void 0===t&&(t=new Qv),this.quaternion.vmult(e,t),t}static pointToLocalFrame(e,t,n,i){return void 0===i&&(i=new Qv),n.vsub(e,i),t.conjugate($v),$v.vmult(i,i),i}static pointToWorldFrame(e,t,n,i){return void 0===i&&(i=new Qv),t.vmult(n,i),i.vadd(e,i),i}static vectorToWorldFrame(e,t,n){return void 0===n&&(n=new Qv),e.vmult(t,n),n}static vectorToLocalFrame(e,t,n,i){return void 0===i&&(i=new Qv),t.w*=-1,t.vmult(n,i),t.w*=-1,i}}const $v=new _v;new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new _v,new zv,new Lv,new Lv,new Lv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new _v,new Qv,new Qv,new Qv,new Qv;class ew{constructor(){this.rayFromWorld=new Qv,this.rayToWorld=new Qv,this.hitNormalWorld=new Qv,this.hitPointWorld=new Qv,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,t,n,i,r,s,o){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(n),this.hitPointWorld.copy(i),this.shape=r,this.body=s,this.distance=o}}let tw,nw,iw,rw,sw,ow,aw;const lw=1,cw=2,gw=4;tw=jv.types.SPHERE,nw=jv.types.PLANE,iw=jv.types.BOX,rw=jv.types.CYLINDER,sw=jv.types.CONVEXPOLYHEDRON,ow=jv.types.HEIGHTFIELD,aw=jv.types.TRIMESH;class uw{get[tw](){return this._intersectSphere}get[nw](){return this._intersectPlane}get[iw](){return this._intersectBox}get[rw](){return this._intersectConvex}get[sw](){return this._intersectConvex}get[ow](){return this._intersectHeightfield}get[aw](){return this._intersectTrimesh}constructor(e,t){void 0===e&&(e=new Qv),void 0===t&&(t=new Qv),this.from=e.clone(),this.to=t.clone(),this.direction=new Qv,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=uw.ANY,this.result=new ew,this.hasHit=!1,this.callback=e=>{}}intersectWorld(e,t){return this.mode=t.mode||uw.ANY,this.result=t.result||new ew,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask="undefined"!==typeof t.collisionFilterMask?t.collisionFilterMask:-1,this.collisionFilterGroup="undefined"!==typeof t.collisionFilterGroup?t.collisionFilterGroup:-1,this.checkCollisionResponse="undefined"===typeof t.checkCollisionResponse||t.checkCollisionResponse,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(Aw),dw.length=0,e.broadphase.aabbQuery(e,Aw,dw),this.intersectBodies(dw),this.hasHit}intersectBody(e,t){t&&(this.result=t,this.updateDirection());const n=this.checkCollisionResponse;if(n&&!e.collisionResponse)return;if(0===(this.collisionFilterGroup&e.collisionFilterMask)||0===(e.collisionFilterGroup&this.collisionFilterMask))return;const i=pw,r=Cw;for(let s=0,o=e.shapes.length;s<o;s++){const t=e.shapes[s];if((!n||t.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[s],r),e.quaternion.vmult(e.shapeOffsets[s],i),i.vadd(e.position,i),this.intersectShape(t,r,i,e),this.result.shouldStop))break}}intersectBodies(e,t){t&&(this.result=t,this.updateDirection());for(let n=0,i=e.length;!this.result.shouldStop&&n<i;n++)this.intersectBody(e[n])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,t,n,i){const r=function(e,t,n){n.vsub(e,Vw);const i=Vw.dot(t);t.scale(i,Lw),Lw.vadd(e,Lw);const r=n.distanceTo(Lw);return r}(this.from,this.direction,n);if(r>e.boundingSphereRadius)return;const s=this[e.type];s&&s.call(this,e,t,n,i,e)}_intersectBox(e,t,n,i,r){return this._intersectConvex(e.convexPolyhedronRepresentation,t,n,i,r)}_intersectPlane(e,t,n,i,r){const s=this.from,o=this.to,a=this.direction,l=new Qv(0,0,1);t.vmult(l,l);const c=new Qv;s.vsub(n,c);const g=c.dot(l);o.vsub(n,c);if(g*c.dot(l)>0)return;if(s.distanceTo(o)<g)return;const u=l.dot(a);if(Math.abs(u)<this.precision)return;const A=new Qv,d=new Qv,h=new Qv;s.vsub(n,A);const I=-l.dot(A)/u;a.scale(I,d),s.vadd(d,h),this.reportIntersection(l,h,r,i,-1)}getAABB(e){const{lowerBound:t,upperBound:n}=e,i=this.to,r=this.from;t.x=Math.min(i.x,r.x),t.y=Math.min(i.y,r.y),t.z=Math.min(i.z,r.z),n.x=Math.max(i.x,r.x),n.y=Math.max(i.y,r.y),n.z=Math.max(i.z,r.z)}_intersectHeightfield(e,t,n,i,r){e.data,e.elementSize;const s=ww;s.from.copy(this.from),s.to.copy(this.to),qv.pointToLocalFrame(n,t,s.from,s.from),qv.pointToLocalFrame(n,t,s.to,s.to),s.updateDirection();const o=Gw;let a,l,c,g;a=l=0,c=g=e.data.length-1;const u=new zv;s.getAABB(u),e.getIndexOfPosition(u.lowerBound.x,u.lowerBound.y,o,!0),a=Math.max(a,o[0]),l=Math.max(l,o[1]),e.getIndexOfPosition(u.upperBound.x,u.upperBound.y,o,!0),c=Math.min(c,o[0]+1),g=Math.min(g,o[1]+1);for(let A=a;A<c;A++)for(let o=l;o<g;o++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(A,o,u),u.overlapsRay(s)){if(e.getConvexTrianglePillar(A,o,!1),qv.pointToWorldFrame(n,t,e.pillarOffset,vw),this._intersectConvex(e.pillarConvex,t,vw,i,r,Bw),this.result.shouldStop)return;e.getConvexTrianglePillar(A,o,!0),qv.pointToWorldFrame(n,t,e.pillarOffset,vw),this._intersectConvex(e.pillarConvex,t,vw,i,r,Bw)}}}_intersectSphere(e,t,n,i,r){const s=this.from,o=this.to,a=e.radius,l=(o.x-s.x)**2+(o.y-s.y)**2+(o.z-s.z)**2,c=2*((o.x-s.x)*(s.x-n.x)+(o.y-s.y)*(s.y-n.y)+(o.z-s.z)*(s.z-n.z)),g=c**2-4*l*((s.x-n.x)**2+(s.y-n.y)**2+(s.z-n.z)**2-a**2),u=Ew,A=xw;if(!(g<0))if(0===g)s.lerp(o,g,u),u.vsub(n,A),A.normalize(),this.reportIntersection(A,u,r,i,-1);else{const e=(-c-Math.sqrt(g))/(2*l),t=(-c+Math.sqrt(g))/(2*l);if(e>=0&&e<=1&&(s.lerp(o,e,u),u.vsub(n,A),A.normalize(),this.reportIntersection(A,u,r,i,-1)),this.result.shouldStop)return;t>=0&&t<=1&&(s.lerp(o,t,u),u.vsub(n,A),A.normalize(),this.reportIntersection(A,u,r,i,-1))}}_intersectConvex(e,t,n,i,r,s){const o=Sw,a=Rw,l=s&&s.faceList||null,c=e.faces,g=e.vertices,u=e.faceNormals,A=this.direction,d=this.from,h=this.to,I=d.distanceTo(h),p=l?l.length:c.length,C=this.result;for(let m=0;!C.shouldStop&&m<p;m++){const e=l?l[m]:m,s=c[e],h=u[e],p=t,f=n;a.copy(g[s[0]]),p.vmult(a,a),a.vadd(f,a),a.vsub(d,a),p.vmult(h,o);const y=A.dot(o);if(Math.abs(y)<this.precision)continue;const b=o.dot(a)/y;if(!(b<0)){A.scale(b,mw),mw.vadd(d,mw),fw.copy(g[s[0]]),p.vmult(fw,fw),f.vadd(fw,fw);for(let t=1;!C.shouldStop&&t<s.length-1;t++){yw.copy(g[s[t]]),bw.copy(g[s[t+1]]),p.vmult(yw,yw),p.vmult(bw,bw),f.vadd(yw,yw),f.vadd(bw,bw);const n=mw.distanceTo(d);!uw.pointInTriangle(mw,fw,yw,bw)&&!uw.pointInTriangle(mw,yw,fw,bw)||n>I||this.reportIntersection(o,mw,r,i,e)}}}}_intersectTrimesh(e,t,n,i,r,s){const o=Zw,a=kw,l=Tw,c=Rw,g=Dw,u=Fw,A=Nw,d=Ww,h=Mw,I=e.indices;e.vertices;const p=this.from,C=this.to,m=this.direction;l.position.copy(n),l.quaternion.copy(t),qv.vectorToLocalFrame(n,t,m,g),qv.pointToLocalFrame(n,t,p,u),qv.pointToLocalFrame(n,t,C,A),A.x*=e.scale.x,A.y*=e.scale.y,A.z*=e.scale.z,u.x*=e.scale.x,u.y*=e.scale.y,u.z*=e.scale.z,A.vsub(u,g),g.normalize();const f=u.distanceSquared(A);e.tree.rayQuery(this,l,a);for(let y=0,b=a.length;!this.result.shouldStop&&y!==b;y++){const s=a[y];e.getNormal(s,o),e.getVertex(I[3*s],fw),fw.vsub(u,c);const l=g.dot(o),A=o.dot(c)/l;if(A<0)continue;g.scale(A,mw),mw.vadd(u,mw),e.getVertex(I[3*s+1],yw),e.getVertex(I[3*s+2],bw);const p=mw.distanceSquared(u);!uw.pointInTriangle(mw,yw,fw,bw)&&!uw.pointInTriangle(mw,fw,yw,bw)||p>f||(qv.vectorToWorldFrame(t,o,h),qv.pointToWorldFrame(n,t,mw,d),this.reportIntersection(h,d,r,i,s))}a.length=0}reportIntersection(e,t,n,i,r){const s=this.from,o=this.to,a=s.distanceTo(t),l=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(l.hitFaceIndex="undefined"!==typeof r?r:-1,this.mode){case uw.ALL:this.hasHit=!0,l.set(s,o,e,t,n,i,a),l.hasHit=!0,this.callback(l);break;case uw.CLOSEST:(a<l.distance||!l.hasHit)&&(this.hasHit=!0,l.hasHit=!0,l.set(s,o,e,t,n,i,a));break;case uw.ANY:this.hasHit=!0,l.hasHit=!0,l.set(s,o,e,t,n,i,a),l.shouldStop=!0}}static pointInTriangle(e,t,n,i){i.vsub(t,Vw),n.vsub(t,hw),e.vsub(t,Iw);const r=Vw.dot(Vw),s=Vw.dot(hw),o=Vw.dot(Iw),a=hw.dot(hw),l=hw.dot(Iw);let c,g;return(c=a*o-s*l)>=0&&(g=r*l-s*o)>=0&&c+g<r*a-s*s}}uw.CLOSEST=lw,uw.ANY=cw,uw.ALL=gw;const Aw=new zv,dw=[],hw=new Qv,Iw=new Qv,pw=new Qv,Cw=new _v,mw=new Qv,fw=new Qv,yw=new Qv,bw=new Qv;new Qv,new ew;const Bw={faceList:[0]},vw=new Qv,ww=new uw,Gw=[],Ew=new Qv,xw=new Qv,Sw=new Qv;new Qv,new Qv;const Rw=new Qv,Zw=new Qv,Dw=new Qv,Fw=new Qv,Nw=new Qv,Mw=new Qv,Ww=new Qv;new zv;const kw=[],Tw=new qv,Vw=new Qv,Lw=new Qv;new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new uw,new Qv,new Qv,new Qv,new Qv(1,0,0),new Qv(0,1,0),new Qv(0,0,1),new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new zv,new Qv,new zv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new zv,new Qv,new qv,new zv,jv.types.SPHERE,jv.types.SPHERE,jv.types.PLANE,jv.types.BOX,jv.types.BOX,jv.types.SPHERE,jv.types.BOX,jv.types.PLANE,jv.types.BOX,jv.types.CONVEXPOLYHEDRON,jv.types.SPHERE,jv.types.CONVEXPOLYHEDRON,jv.types.PLANE,jv.types.CONVEXPOLYHEDRON,jv.types.BOX,jv.types.CONVEXPOLYHEDRON,jv.types.SPHERE,jv.types.HEIGHTFIELD,jv.types.BOX,jv.types.HEIGHTFIELD,jv.types.CONVEXPOLYHEDRON,jv.types.HEIGHTFIELD,jv.types.PARTICLE,jv.types.SPHERE,jv.types.PLANE,jv.types.PARTICLE,jv.types.BOX,jv.types.PARTICLE,jv.types.PARTICLE,jv.types.CONVEXPOLYHEDRON,jv.types.CYLINDER,jv.types.SPHERE,jv.types.CYLINDER,jv.types.PLANE,jv.types.CYLINDER,jv.types.BOX,jv.types.CYLINDER,jv.types.CONVEXPOLYHEDRON,jv.types.CYLINDER,jv.types.HEIGHTFIELD,jv.types.CYLINDER,jv.types.PARTICLE,jv.types.CYLINDER,jv.types.SPHERE,jv.types.TRIMESH,jv.types.PLANE,jv.types.TRIMESH,new Qv,new Qv,new Qv,new Qv,new Qv,new _v,new _v,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new zv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new _v,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new Qv,new zv,new uw;const Hw=globalThis.performance||{};if(!Hw.now){let e=Date.now();Hw.timing&&Hw.timing.navigationStart&&(e=Hw.timing.navigationStart),Hw.now=()=>Date.now()-e}new Qv;const Qw=(0,t.createContext)(null),Kw=()=>(0,t.useContext)(Qw),Xw=(0,t.createContext)(null),Yw=()=>{const e=(0,t.useContext)(Xw);if(!e)throw new Error("Physics context not found. @react-three/cannon & components can only be used within a Physics provider");return e};new xr,new Sr(1,1,1),new Sr,new rs;const zw=new Rs;function Pw(e){const n=(0,t.useRef)(null);return e&&"function"!==typeof e?e:n}function Uw(e){return e.charAt(0).toUpperCase()+e.slice(1)}function _w(e,t){const n=void 0===t?"":"/".concat(t);return"function"===typeof e?null:e&&e.current&&"".concat(e.current.uuid).concat(n)}const Ow=new hs,Jw=new xr,jw=e=>t=>e(Ow.setFromQuaternion(Jw.fromArray(t)).toArray());let qw=0;function $w(e,t,n,i,r,s){return void 0===s&&(s="bodies"),o=>{const a=qw++;n[a]={[i]:o};const l=_w(e,r);return l&&t.subscribe({props:{id:a,target:s,type:i},uuid:l}),()=>{delete n[a],t.unsubscribe({props:a})}}}function eG(e,t){let{position:n=[0,0,0],rotation:i=[0,0,0],userData:r={}}=t;e.userData=r,e.position.set(...n),e.rotation.set(...i),e.updateMatrix()}function tG(e,t,n){let{onCollide:i,onCollideBegin:r,onCollideEnd:s}=t;e[n]={collide:i,collideBegin:r,collideEnd:s}}function nG(e,n,i,r,s){void 0===r&&(r=null),void 0===s&&(s=[]);const o=Pw(r),{events:a,refs:l,scaleOverrides:c,subscriptions:g,worker:u}=Yw(),A=Kw();(0,t.useLayoutEffect)((()=>{o.current||(o.current=new Rs);const t=o.current,r=u,s=t instanceof Hg?(t.instanceMatrix.setUsage(Bi),t.count):1,c=t instanceof Hg?new Array(s).fill(0).map(((e,n)=>"".concat(t.uuid,"/").concat(n))):[t.uuid],g=t instanceof Hg?c.map(((r,s)=>{const o=n(s);return eG(zw,o),t.setMatrixAt(s,zw.matrix),t.instanceMatrix.needsUpdate=!0,l[r]=t,null==A||A.add(r,o,e),tG(a,o,r),{...o,args:i(o.args)}})):c.map(((r,s)=>{const o=n(s);return eG(t,o),l[r]=t,null==A||A.add(r,o,e),tG(a,o,r),{...o,args:i(o.args)}}));return r.addBodies({props:g.map((e=>{let{onCollide:t,onCollideBegin:n,onCollideEnd:i,...r}=e;return{onCollide:Boolean(t),...r}})),type:e,uuid:c}),()=>{c.forEach((e=>{delete l[e],null==A||A.remove(e),delete a[e]})),r.removeBodies({uuid:c})}}),s);const d=(0,t.useMemo)((()=>{const e=(e,t)=>{const n="set".concat(Uw(e));return{set:e=>{const i=_w(o,t);i&&u[n]({props:e,uuid:i})},subscribe:$w(o,u,g,e,t)}},t=e=>({copy:t=>{let{w:n,x:i,y:r,z:s}=t;const a=_w(o,e);a&&u.setQuaternion({props:[i,r,s,n],uuid:a})},set:(t,n,i,r)=>{const s=_w(o,e);s&&u.setQuaternion({props:[t,n,i,r],uuid:s})},subscribe:$w(o,u,g,"quaternion",e)}),n=e=>({copy:t=>{let{x:n,y:i,z:r}=t;const s=_w(o,e);s&&u.setRotation({props:[n,i,r],uuid:s})},set:(t,n,i)=>{const r=_w(o,e);r&&u.setRotation({props:[t,n,i],uuid:r})},subscribe:t=>{const n=qw++,i="quaternion",r=_w(o,e);return g[n]={[i]:jw(t)},r&&u.subscribe({props:{id:n,target:"bodies",type:i},uuid:r}),()=>{delete g[n],u.unsubscribe({props:n})}}}),i=(e,t)=>{const n="set".concat(Uw(e));return{copy:e=>{let{x:i,y:r,z:s}=e;const a=_w(o,t);a&&u[n]({props:[i,r,s],uuid:a})},set:(e,i,r)=>{const s=_w(o,t);s&&u[n]({props:[e,i,r],uuid:s})},subscribe:$w(o,u,g,e,t)}};function r(r){return{allowSleep:e("allowSleep",r),angularDamping:e("angularDamping",r),angularFactor:i("angularFactor",r),angularVelocity:i("angularVelocity",r),applyForce(e,t){const n=_w(o,r);n&&u.applyForce({props:[e,t],uuid:n})},applyImpulse(e,t){const n=_w(o,r);n&&u.applyImpulse({props:[e,t],uuid:n})},applyLocalForce(e,t){const n=_w(o,r);n&&u.applyLocalForce({props:[e,t],uuid:n})},applyLocalImpulse(e,t){const n=_w(o,r);n&&u.applyLocalImpulse({props:[e,t],uuid:n})},applyTorque(e){const t=_w(o,r);t&&u.applyTorque({props:[e],uuid:t})},collisionFilterGroup:e("collisionFilterGroup",r),collisionFilterMask:e("collisionFilterMask",r),collisionResponse:e("collisionResponse",r),fixedRotation:e("fixedRotation",r),isTrigger:e("isTrigger",r),linearDamping:e("linearDamping",r),linearFactor:i("linearFactor",r),mass:e("mass",r),material:e("material",r),position:i("position",r),quaternion:t(r),rotation:n(r),scaleOverride(e){const t=_w(o,r);t&&(c[t]=new Sr(...e))},sleep(){const e=_w(o,r);e&&u.sleep({uuid:e})},sleepSpeedLimit:e("sleepSpeedLimit",r),sleepTimeLimit:e("sleepTimeLimit",r),userData:e("userData",r),velocity:i("velocity",r),wakeUp(){const e=_w(o,r);e&&u.wakeUp({uuid:e})}}}const s={};return{...r(void 0),at:e=>s[e]||(s[e]=r(e))}}),[]);return[o,d]}function iG(e,t,n){return nG("Plane",e,(()=>[]),t,n)}function rG(e,t,n){const i=[1,1,1];return nG("Box",e,(function(e){return void 0===e&&(e=i),e}),t,n)}function sG(e){return"string"===typeof e}function oG(e,n,i){void 0===n&&(n=null),void 0===i&&(i=[]);const r=Pw(n),{worker:s,subscriptions:o}=Yw();(0,t.useLayoutEffect)((()=>{r.current||(r.current=new Rs);const t=s,n=r.current.uuid,{chassisBody:i,indexForwardAxis:o=2,indexRightAxis:a=0,indexUpAxis:l=1,wheelInfos:c,wheels:g}=e(),u=_w(i),A=g.map((e=>_w(e)));if(u&&A.every(sG))return t.addRaycastVehicle({props:[u,A,c,o,a,l],uuid:n}),()=>{t.removeRaycastVehicle({uuid:n})}}),i);const a=(0,t.useMemo)((()=>({applyEngineForce(e,t){const n=_w(r);n&&s.applyRaycastVehicleEngineForce({props:[e,t],uuid:n})},setBrake(e,t){const n=_w(r);n&&s.setRaycastVehicleBrake({props:[e,t],uuid:n})},setSteeringValue(e,t){const n=_w(r);n&&s.setRaycastVehicleSteeringValue({props:[e,t],uuid:n})},sliding:{subscribe:$w(r,s,o,"sliding",void 0,"vehicles")}})),i);return[r,a]}const aG=new Sr,lG=new Sr(1,1,1),cG=new xr,gG=new rs;function uG(e,t,n,i,r){return void 0===i&&(i=lG),void 0!==e?(gG.compose(aG.fromArray(t,3*e),cG.fromArray(n,4*e),i),r&&(r.matrixAutoUpdate=!1,r.matrix.copy(gG)),gG):gG.identity()}function AG(e){let{allowSleep:n=!1,axisIndex:i=0,broadphase:r="Naive",children:s,defaultContactMaterial:o={contactEquationStiffness:1e6},frictionGravity:a=null,gravity:l=[0,-9.81,0],isPaused:c=!1,iterations:g=5,maxSubSteps:u=10,quatNormalizeFast:A=!1,quatNormalizeSkip:d=0,shouldInvalidate:h=!0,size:p=1e3,solver:C="GS",stepSize:m=1/60,tolerance:f=.001}=e;const{invalidate:y}=_p(),[{bodies:b,events:B,refs:v,scaleOverrides:w,subscriptions:G,worker:E}]=(0,t.useState)((()=>({bodies:{},events:{},refs:{},scaleOverrides:{},subscriptions:{},worker:new oB({allowSleep:n,axisIndex:i,broadphase:r,defaultContactMaterial:o,frictionGravity:a,gravity:l,iterations:g,quatNormalizeFast:A,quatNormalizeSkip:d,size:p,solver:C,tolerance:f})})));let x=0;const S=(0,t.useCallback)(((e,t)=>{c||(x+=t,E.step({maxSubSteps:u,stepSize:m,timeSinceLastCalled:x}),x=0)}),[c,u,m]),R=e=>{var t;let{body:n,contact:{bi:i,bj:r,...s},target:o,...a}=e;const l=null==(t=B[o])?void 0:t.collide;l&&l({body:v[n],contact:{bi:v[i],bj:v[r],...s},target:v[o],...a})},Z=e=>{var t,n;let{bodyA:i,bodyB:r}=e;const s=null==(t=B[i])?void 0:t.collideBegin;s&&s({body:v[r],op:"event",target:v[i],type:"collideBegin"});const o=null==(n=B[r])?void 0:n.collideBegin;o&&o({body:v[i],op:"event",target:v[r],type:"collideBegin"})},D=e=>{var t,n;let{bodyA:i,bodyB:r}=e;const s=null==(t=B[i])?void 0:t.collideEnd;s&&s({body:v[r],op:"event",target:v[i],type:"collideEnd"});const o=null==(n=B[r])?void 0:n.collideEnd;o&&o({body:v[i],op:"event",target:v[r],type:"collideEnd"})},F=e=>{let{active:t,bodies:n=[],observations:i,positions:r,quaternions:s}=e;for(let o=0;o<n.length;o++)b[n[o]]=o;if(i.forEach((e=>{let[t,n,i]=e;const r=(G[t]||{})[i];r&&r(n)})),t){for(const e of Object.values(v).filter((()=>{const e=[];return t=>!e.includes(t)&&!!e.push(t)})()))if(e instanceof Hg)for(let t=0;t<e.count;t++){const n="".concat(e.uuid,"/").concat(t),i=b[n];void 0!==i&&(e.setMatrixAt(t,uG(i,r,s,w[n])),e.instanceMatrix.needsUpdate=!0)}else{const t=w[e.uuid]||e.scale;uG(b[e.uuid],r,s,t,e)}h&&y()}},N=e=>{var t;let{body:n,ray:{uuid:i,...r},...s}=e;const o=null==(t=B[i])?void 0:t.rayhit;o&&o({body:n?v[n]:null,ray:{uuid:i,...r},...s})};Op(S),(0,t.useEffect)((()=>(E.connect(),E.init(),E.on("collide",R),E.on("collideBegin",Z),E.on("collideEnd",D),E.on("frame",F),E.on("rayhit",N),()=>{E.terminate(),E.removeAllListeners()})),[]),(0,t.useEffect)((()=>{E.axisIndex=i}),[i]),(0,t.useEffect)((()=>{E.broadphase=r}),[r]),(0,t.useEffect)((()=>{E.gravity=l}),[l]),(0,t.useEffect)((()=>{E.iterations=g}),[g]),(0,t.useEffect)((()=>{E.tolerance=f}),[f]);const M=(0,t.useMemo)((()=>({bodies:b,events:B,refs:v,scaleOverrides:w,subscriptions:G,worker:E})),[b,B,v,G,E]);return(0,I.jsx)(Xw.Provider,{value:M,children:s})}const dG=new WeakMap;class hG extends Zd{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,i){const r=new Nd(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,(e=>{const n={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(e,n).then(t).catch(i)}),n,i)}decodeDracoFile(e,t,n,i){const r={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,r).then(t)}decodeGeometry(e,t){for(const a in t.attributeTypes){const e=t.attributeTypes[a];void 0!==e.BYTES_PER_ELEMENT&&(t.attributeTypes[a]=e.name)}const n=JSON.stringify(t);if(dG.has(e)){const t=dG.get(e);if(t.key===n)return t.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i;const r=this.workerNextTaskID++,s=e.byteLength,o=this._getWorker(r,s).then((n=>(i=n,new Promise(((n,s)=>{i._callbacks[r]={resolve:n,reject:s},i.postMessage({type:"decode",id:r,taskConfig:t,buffer:e},[e])}))))).then((e=>this._createGeometry(e.geometry)));return o.catch((()=>!0)).then((()=>{i&&r&&this._releaseTask(i,r)})),dG.set(e,{key:n,promise:o}),o}_createGeometry(e){const t=new vo;e.index&&t.setIndex(new ro(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const i=e.attributes[n],r=i.name,s=i.array,o=i.itemSize;t.setAttribute(r,new ro(s,o))}return t}_loadLibrary(e,t){const n=new Nd(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise(((t,i)=>{n.load(e,t,void 0,i)}))}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!==typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then((t=>{const n=t[0];e||(this.decoderConfig.wasmBinary=t[1]);const i=IG.toString(),r=["/* draco decoder */",n,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([r]))})),this.decoderPending}_getWorker(e,t){return this._initDecoder().then((()=>{if(this.workerPool.length<this.workerLimit){const e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){const n=t.data;switch(n.type){case"decode":e._callbacks[n.id].resolve(n);break;case"error":e._callbacks[n.id].reject(n);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+n.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n}))}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map((e=>e._taskLoad)))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function IG(){let e,t;function n(e,t,n,i,r,s){const o=s.num_components(),a=n.num_points()*o,l=a*r.BYTES_PER_ELEMENT,c=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,r),g=e._malloc(l);t.GetAttributeDataArrayForAllPoints(n,s,c,l,g);const u=new r(e.HEAPF32.buffer,g,a).slice();return e._free(g),{name:i,array:u,itemSize:o}}onmessage=function(i){const r=i.data;switch(r.type){case"init":e=r.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":const i=r.buffer,s=r.taskConfig;t.then((e=>{const t=e.draco,o=new t.Decoder,a=new t.DecoderBuffer;a.Init(new Int8Array(i),i.byteLength);try{const e=function(e,t,i,r){const s=r.attributeIDs,o=r.attributeTypes;let a,l;const c=t.GetEncodedGeometryType(i);if(c===e.TRIANGULAR_MESH)a=new e.Mesh,l=t.DecodeBufferToMesh(i,a);else{if(c!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");a=new e.PointCloud,l=t.DecodeBufferToPointCloud(i,a)}if(!l.ok()||0===a.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+l.error_msg());const g={index:null,attributes:[]};for(const u in s){const i=self[o[u]];let l,c;if(r.useUniqueIDs)c=s[u],l=t.GetAttributeByUniqueId(a,c);else{if(c=t.GetAttributeId(a,e[s[u]]),-1===c)continue;l=t.GetAttribute(a,c)}g.attributes.push(n(e,t,a,u,i,l))}c===e.TRIANGULAR_MESH&&(g.index=function(e,t,n){const i=n.num_faces(),r=3*i,s=4*r,o=e._malloc(s);t.GetTrianglesUInt32Array(n,s,o);const a=new Uint32Array(e.HEAPF32.buffer,o,r).slice();return e._free(o),{array:a,itemSize:1}}(e,t,a));return e.destroy(a),g}(t,o,a,s),i=e.attributes.map((e=>e.array.buffer));e.index&&i.push(e.index.array.buffer),self.postMessage({type:"decode",id:r.id,geometry:e},i)}catch(HY){console.error(HY),self.postMessage({type:"error",id:r.id,error:HY.message})}finally{t.destroy(a),t.destroy(o)}}))}}}let pG;const CG=()=>{if(pG)return pG;const e=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),t=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if("object"!==typeof WebAssembly)return{supported:!1};let n,i="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB";WebAssembly.validate(e)&&(i="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB");const r=WebAssembly.instantiate(function(e){const n=new Uint8Array(e.length);for(let t=0;t<e.length;++t){const i=e.charCodeAt(t);n[t]=i>96?i-71:i>64?i-65:i>47?i+4:i>46?63:62}let i=0;for(let r=0;r<e.length;++r)n[i++]=n[r]<60?t[n[r]]:64*(n[r]-60)+n[++r];return n.buffer.slice(0,i)}(i),{}).then((e=>{n=e.instance,n.exports.__wasm_call_ctors()}));function s(e,t,i,r,s,o){const a=n.exports.sbrk,l=i+3&-4,c=a(l*r),g=a(s.length),u=new Uint8Array(n.exports.memory.buffer);u.set(s,g);const A=e(c,i,r,g,s.length);if(0===A&&o&&o(c,l,r),t.set(u.subarray(c,c+i*r)),a(c-a(0)),0!==A)throw new Error("Malformed buffer data: ".concat(A))}const o={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},a={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return pG={ready:r,supported:!0,decodeVertexBuffer(e,t,i,r,a){s(n.exports.meshopt_decodeVertexBuffer,e,t,i,r,n.exports[o[a]])},decodeIndexBuffer(e,t,i,r){s(n.exports.meshopt_decodeIndexBuffer,e,t,i,r)},decodeIndexSequence(e,t,i,r){s(n.exports.meshopt_decodeIndexSequence,e,t,i,r)},decodeGltfBuffer(e,t,i,r,l,c){s(n.exports[a[l]],e,t,i,r,n.exports[o[c]])}},pG};function mG(e,t){if(t===Nn)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t===Wn||t===Mn){let n=e.getIndex();if(null===n){const t=[],i=e.getAttribute("position");if(void 0===i)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<i.count;e++)t.push(e);e.setIndex(t),n=e.getIndex()}const i=n.count-2,r=[];if(n)if(t===Wn)for(let e=1;e<=i;e++)r.push(n.getX(0)),r.push(n.getX(e)),r.push(n.getX(e+1));else for(let e=0;e<i;e++)e%2===0?(r.push(n.getX(e)),r.push(n.getX(e+1)),r.push(n.getX(e+2))):(r.push(n.getX(e+2)),r.push(n.getX(e+1)),r.push(n.getX(e)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=e.clone();return s.setIndex(r),s.clearGroups(),s}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}const fG=parseInt(O.replace(/\D+/g,""));function yG(e){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(Ow){return t}}const bG="srgb",BG="srgb-linear";class vG extends Zd{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new RG(e)})),this.register((function(e){return new ZG(e)})),this.register((function(e){return new LG(e)})),this.register((function(e){return new HG(e)})),this.register((function(e){return new QG(e)})),this.register((function(e){return new FG(e)})),this.register((function(e){return new NG(e)})),this.register((function(e){return new MG(e)})),this.register((function(e){return new WG(e)})),this.register((function(e){return new SG(e)})),this.register((function(e){return new kG(e)})),this.register((function(e){return new DG(e)})),this.register((function(e){return new VG(e)})),this.register((function(e){return new TG(e)})),this.register((function(e){return new EG(e)})),this.register((function(e){return new KG(e)})),this.register((function(e){return new XG(e)}))}load(e,t,n,i){const r=this;let s;if(""!==this.resourcePath)s=this.resourcePath;else if(""!==this.path){const t=oh.extractUrlBase(e);s=oh.resolveURL(t,this.path)}else s=oh.extractUrlBase(e);this.manager.itemStart(e);const o=function(t){i?i(t):console.error(t),r.manager.itemError(e),r.manager.itemEnd(e)},a=new Nd(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){try{r.parse(n,s,(function(n){t(n),r.manager.itemEnd(e)}),o)}catch(Ow){o(Ow)}}),n,o)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,i){let r;const s={},o={};if("string"===typeof e)r=JSON.parse(e);else if(e instanceof ArrayBuffer){if(yG(new Uint8Array(e.slice(0,4)))===YG){try{s[GG.KHR_BINARY_GLTF]=new UG(e)}catch(HY){return void(i&&i(HY))}r=JSON.parse(s[GG.KHR_BINARY_GLTF].content)}else r=JSON.parse(yG(new Uint8Array(e)))}else r=e;if(void 0===r.asset||r.asset.version[0]<2)return void(i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const a=new mE(r,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});a.fileLoader.setRequestHeader(this.requestHeader);for(let l=0;l<this.pluginCallbacks.length;l++){const e=this.pluginCallbacks[l](a);e.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),o[e.name]=e,s[e.name]=!0}if(r.extensionsUsed)for(let l=0;l<r.extensionsUsed.length;++l){const e=r.extensionsUsed[l],t=r.extensionsRequired||[];switch(e){case GG.KHR_MATERIALS_UNLIT:s[e]=new xG;break;case GG.KHR_DRACO_MESH_COMPRESSION:s[e]=new _G(r,this.dracoLoader);break;case GG.KHR_TEXTURE_TRANSFORM:s[e]=new OG;break;case GG.KHR_MESH_QUANTIZATION:s[e]=new JG;break;default:t.indexOf(e)>=0&&void 0===o[e]&&console.warn('THREE.GLTFLoader: Unknown extension "'+e+'".')}}a.setExtensions(s),a.setPlugins(o),a.parse(n,i)}parseAsync(e,t){const n=this;return new Promise((function(i,r){n.parse(e,t,i,r)}))}}function wG(){let e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const GG={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class EG{constructor(e){this.parser=e,this.name=GG.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,i=t.length;n<i;n++){const i=t[n];i.extensions&&i.extensions[this.name]&&void 0!==i.extensions[this.name].light&&e._addNodeRef(this.cache,i.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let i=t.cache.get(n);if(i)return i;const r=t.json,s=((r.extensions&&r.extensions[this.name]||{}).lights||[])[e];let o;const a=new Ps(16777215);void 0!==s.color&&a.setRGB(s.color[0],s.color[1],s.color[2],BG);const l=void 0!==s.range?s.range:0;switch(s.type){case"directional":o=new eh(a),o.target.position.set(0,0,-1),o.add(o.target);break;case"point":o=new qd(a),o.distance=l;break;case"spot":o=new Ud(a),o.distance=l,s.spot=s.spot||{},s.spot.innerConeAngle=void 0!==s.spot.innerConeAngle?s.spot.innerConeAngle:0,s.spot.outerConeAngle=void 0!==s.spot.outerConeAngle?s.spot.outerConeAngle:Math.PI/4,o.angle=s.spot.outerConeAngle,o.penumbra=1-s.spot.innerConeAngle/s.spot.outerConeAngle,o.target.position.set(0,0,-1),o.add(o.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+s.type)}return o.position.set(0,0,0),o.decay=2,AE(o,s),void 0!==s.intensity&&(o.intensity=s.intensity),o.name=t.createUniqueName(s.name||"light_"+e),i=Promise.resolve(o),t.cache.add(n,i),i}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,i=n.json.nodes[e],r=(i.extensions&&i.extensions[this.name]||{}).light;return void 0===r?null:this._loadLight(r).then((function(e){return n._getNodeRef(t.cache,r,e)}))}}class xG{constructor(){this.name=GG.KHR_MATERIALS_UNLIT}getMaterialType(){return Js}extendParams(e,t,n){const i=[];e.color=new Ps(1,1,1),e.opacity=1;const r=t.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const t=r.baseColorFactor;e.color.setRGB(t[0],t[1],t[2],BG),e.opacity=t[3]}void 0!==r.baseColorTexture&&i.push(n.assignTexture(e,"map",r.baseColorTexture,bG))}return Promise.all(i)}}class SG{constructor(e){this.parser=e,this.name=GG.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const i=n.extensions[this.name].emissiveStrength;return void 0!==i&&(t.emissiveIntensity=i),Promise.resolve()}}class RG{constructor(e){this.parser=e,this.name=GG.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ed:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];if(void 0!==s.clearcoatFactor&&(t.clearcoat=s.clearcoatFactor),void 0!==s.clearcoatTexture&&r.push(n.assignTexture(t,"clearcoatMap",s.clearcoatTexture)),void 0!==s.clearcoatRoughnessFactor&&(t.clearcoatRoughness=s.clearcoatRoughnessFactor),void 0!==s.clearcoatRoughnessTexture&&r.push(n.assignTexture(t,"clearcoatRoughnessMap",s.clearcoatRoughnessTexture)),void 0!==s.clearcoatNormalTexture&&(r.push(n.assignTexture(t,"clearcoatNormalMap",s.clearcoatNormalTexture)),void 0!==s.clearcoatNormalTexture.scale)){const e=s.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Oi(e,e)}return Promise.all(r)}}class ZG{constructor(e){this.parser=e,this.name=GG.KHR_MATERIALS_DISPERSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ed:null}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const i=n.extensions[this.name];return t.dispersion=void 0!==i.dispersion?i.dispersion:0,Promise.resolve()}}class DG{constructor(e){this.parser=e,this.name=GG.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ed:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];return void 0!==s.iridescenceFactor&&(t.iridescence=s.iridescenceFactor),void 0!==s.iridescenceTexture&&r.push(n.assignTexture(t,"iridescenceMap",s.iridescenceTexture)),void 0!==s.iridescenceIor&&(t.iridescenceIOR=s.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==s.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=s.iridescenceThicknessMinimum),void 0!==s.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=s.iridescenceThicknessMaximum),void 0!==s.iridescenceThicknessTexture&&r.push(n.assignTexture(t,"iridescenceThicknessMap",s.iridescenceThicknessTexture)),Promise.all(r)}}class FG{constructor(e){this.parser=e,this.name=GG.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ed:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[];t.sheenColor=new Ps(0,0,0),t.sheenRoughness=0,t.sheen=1;const s=i.extensions[this.name];if(void 0!==s.sheenColorFactor){const e=s.sheenColorFactor;t.sheenColor.setRGB(e[0],e[1],e[2],BG)}return void 0!==s.sheenRoughnessFactor&&(t.sheenRoughness=s.sheenRoughnessFactor),void 0!==s.sheenColorTexture&&r.push(n.assignTexture(t,"sheenColorMap",s.sheenColorTexture,bG)),void 0!==s.sheenRoughnessTexture&&r.push(n.assignTexture(t,"sheenRoughnessMap",s.sheenRoughnessTexture)),Promise.all(r)}}class NG{constructor(e){this.parser=e,this.name=GG.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ed:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];return void 0!==s.transmissionFactor&&(t.transmission=s.transmissionFactor),void 0!==s.transmissionTexture&&r.push(n.assignTexture(t,"transmissionMap",s.transmissionTexture)),Promise.all(r)}}class MG{constructor(e){this.parser=e,this.name=GG.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ed:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];t.thickness=void 0!==s.thicknessFactor?s.thicknessFactor:0,void 0!==s.thicknessTexture&&r.push(n.assignTexture(t,"thicknessMap",s.thicknessTexture)),t.attenuationDistance=s.attenuationDistance||1/0;const o=s.attenuationColor||[1,1,1];return t.attenuationColor=(new Ps).setRGB(o[0],o[1],o[2],BG),Promise.all(r)}}class WG{constructor(e){this.parser=e,this.name=GG.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ed:null}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const i=n.extensions[this.name];return t.ior=void 0!==i.ior?i.ior:1.5,Promise.resolve()}}class kG{constructor(e){this.parser=e,this.name=GG.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ed:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];t.specularIntensity=void 0!==s.specularFactor?s.specularFactor:1,void 0!==s.specularTexture&&r.push(n.assignTexture(t,"specularIntensityMap",s.specularTexture));const o=s.specularColorFactor||[1,1,1];return t.specularColor=(new Ps).setRGB(o[0],o[1],o[2],BG),void 0!==s.specularColorTexture&&r.push(n.assignTexture(t,"specularColorMap",s.specularColorTexture,bG)),Promise.all(r)}}class TG{constructor(e){this.parser=e,this.name=GG.EXT_MATERIALS_BUMP}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ed:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];return t.bumpScale=void 0!==s.bumpFactor?s.bumpFactor:1,void 0!==s.bumpTexture&&r.push(n.assignTexture(t,"bumpMap",s.bumpTexture)),Promise.all(r)}}class VG{constructor(e){this.parser=e,this.name=GG.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ed:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];return void 0!==s.anisotropyStrength&&(t.anisotropy=s.anisotropyStrength),void 0!==s.anisotropyRotation&&(t.anisotropyRotation=s.anisotropyRotation),void 0!==s.anisotropyTexture&&r.push(n.assignTexture(t,"anisotropyMap",s.anisotropyTexture)),Promise.all(r)}}class LG{constructor(e){this.parser=e,this.name=GG.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,i=n.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const r=i.extensions[this.name],s=t.options.ktx2Loader;if(!s){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,r.source,s)}}class HG{constructor(e){this.parser=e,this.name=GG.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,i=n.json,r=i.textures[e];if(!r.extensions||!r.extensions[t])return null;const s=r.extensions[t],o=i.images[s.source];let a=n.textureLoader;if(o.uri){const e=n.options.manager.getHandler(o.uri);null!==e&&(a=e)}return this.detectSupport().then((function(r){if(r)return n.loadTextureImage(e,s.source,a);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class QG{constructor(e){this.parser=e,this.name=GG.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,i=n.json,r=i.textures[e];if(!r.extensions||!r.extensions[t])return null;const s=r.extensions[t],o=i.images[s.source];let a=n.textureLoader;if(o.uri){const e=n.options.manager.getHandler(o.uri);null!==e&&(a=e)}return this.detectSupport().then((function(r){if(r)return n.loadTextureImage(e,s.source,a);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class KG{constructor(e){this.name=GG.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const e=n.extensions[this.name],i=this.parser.getDependency("buffer",e.buffer),r=this.parser.options.meshoptDecoder;if(!r||!r.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return i.then((function(t){const n=e.byteOffset||0,i=e.byteLength||0,s=e.count,o=e.byteStride,a=new Uint8Array(t,n,i);return r.decodeGltfBufferAsync?r.decodeGltfBufferAsync(s,o,a,e.mode,e.filter).then((function(e){return e.buffer})):r.ready.then((function(){const t=new ArrayBuffer(s*o);return r.decodeGltfBuffer(new Uint8Array(t),s,o,a,e.mode,e.filter),t}))}))}return null}}class XG{constructor(e){this.name=GG.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||void 0===n.mesh)return null;const i=t.meshes[n.mesh];for(const a of i.primitives)if(a.mode!==eE.TRIANGLES&&a.mode!==eE.TRIANGLE_STRIP&&a.mode!==eE.TRIANGLE_FAN&&void 0!==a.mode)return null;const r=n.extensions[this.name].attributes,s=[],o={};for(const a in r)s.push(this.parser.getDependency("accessor",r[a]).then((e=>(o[a]=e,o[a]))));return s.length<1?null:(s.push(this.parser.createNodeMesh(e)),Promise.all(s).then((e=>{const t=e.pop(),n=t.isGroup?t.children:[t],i=e[0].count,r=[];for(const s of n){const e=new rs,t=new Sr,n=new xr,a=new Sr(1,1,1),l=new Hg(s.geometry,s.material,i);for(let r=0;r<i;r++)o.TRANSLATION&&t.fromBufferAttribute(o.TRANSLATION,r),o.ROTATION&&n.fromBufferAttribute(o.ROTATION,r),o.SCALE&&a.fromBufferAttribute(o.SCALE,r),l.setMatrixAt(r,e.compose(t,n,a));for(const i in o)if("_COLOR_0"===i){const e=o[i];l.instanceColor=new Fg(e.array,e.itemSize,e.normalized)}else"TRANSLATION"!==i&&"ROTATION"!==i&&"SCALE"!==i&&s.geometry.setAttribute(i,o[i]);Rs.prototype.copy.call(l,s),this.parser.assignFinalMaterial(l),r.push(l)}return t.isGroup?(t.clear(),t.add(...r),t):r[0]})))}}const YG="glTF",zG=1313821514,PG=5130562;class UG{constructor(e){this.name=GG.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12);if(this.header={magic:yG(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==YG)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-12,i=new DataView(e,12);let r=0;for(;r<n;){const t=i.getUint32(r,!0);r+=4;const n=i.getUint32(r,!0);if(r+=4,n===zG){const n=new Uint8Array(e,12+r,t);this.content=yG(n)}else if(n===PG){const n=12+r;this.body=e.slice(n,n+t)}r+=t}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class _G{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=GG.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,i=this.dracoLoader,r=e.extensions[this.name].bufferView,s=e.extensions[this.name].attributes,o={},a={},l={};for(const c in s){const e=sE[c]||c.toLowerCase();o[e]=s[c]}for(const c in e.attributes){const t=sE[c]||c.toLowerCase();if(void 0!==s[c]){const i=n.accessors[e.attributes[c]],r=tE[i.componentType];l[t]=r.name,a[t]=!0===i.normalized}}return t.getDependency("bufferView",r).then((function(e){return new Promise((function(t,n){i.decodeDracoFile(e,(function(e){for(const t in e.attributes){const n=e.attributes[t],i=a[t];void 0!==i&&(n.normalized=i)}t(e)}),o,l,BG,n)}))}))}}class OG{constructor(){this.name=GG.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&t.texCoord!==e.channel||void 0!==t.offset||void 0!==t.rotation||void 0!==t.scale?(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0,e):e}}class JG{constructor(){this.name=GG.KHR_MESH_QUANTIZATION}}class jG extends dd{constructor(e,t,n,i){super(e,t,n,i)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i*3+i;for(let s=0;s!==i;s++)t[s]=n[r+s];return t}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=2*o,l=3*o,c=i-t,g=(n-t)/c,u=g*g,A=u*g,d=e*l,h=d-l,I=-2*A+3*u,p=A-u,C=1-I,m=p-u+g;for(let f=0;f!==o;f++){const e=s[h+f+o],t=s[h+f+a]*c,n=s[d+f+o],i=s[d+f]*c;r[f]=C*e+m*t+I*n+p*i}return r}}const qG=new xr;class $G extends jG{interpolate_(e,t,n,i){const r=super.interpolate_(e,t,n,i);return qG.fromArray(r).normalize().toArray(r),r}}const eE={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},tE={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},nE={9728:ut,9729:pt,9984:At,9985:Ct,9986:ht,9987:ft},iE={33071:ct,33648:gt,10497:lt},rE={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},sE={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...fG>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},oE={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},aE={CUBICSPLINE:void 0,LINEAR:En,STEP:Gn},lE="OPAQUE",cE="MASK",gE="BLEND";function uE(e,t,n){for(const i in n.extensions)void 0===e[i]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[i]=n.extensions[i])}function AE(e,t){void 0!==t.extras&&("object"===typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function dE(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let n=0,i=t.weights.length;n<i;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){const n=t.extras.targetNames;if(e.morphTargetInfluences.length===n.length){e.morphTargetDictionary={};for(let t=0,i=n.length;t<i;t++)e.morphTargetDictionary[n[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function hE(e){let t;const n=e.extensions&&e.extensions[GG.KHR_DRACO_MESH_COMPRESSION];if(t=n?"draco:"+n.bufferView+":"+n.indices+":"+IE(n.attributes):e.indices+":"+IE(e.attributes)+":"+e.mode,void 0!==e.targets)for(let i=0,r=e.targets.length;i<r;i++)t+=":"+IE(e.targets[i]);return t}function IE(e){let t="";const n=Object.keys(e).sort();for(let i=0,r=n.length;i<r;i++)t+=n[i]+":"+e[n[i]]+";";return t}function pE(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const CE=new rs;class mE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new wG,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,i=!1,r=-1;"undefined"!==typeof navigator&&"undefined"!==typeof navigator.userAgent&&(n=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),i=navigator.userAgent.indexOf("Firefox")>-1,r=i?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),"undefined"===typeof createImageBitmap||n||i&&r<98?this.textureLoader=new Ld(this.options.manager):this.textureLoader=new dh(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Nd(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,i=this.json,r=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(t){const s={scene:t[0][i.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:i.asset,parser:n,userData:{}};return uE(r,s,i),AE(s,i),Promise.all(n._invokeAll((function(e){return e.afterRoot&&e.afterRoot(s)}))).then((function(){for(const e of s.scenes)e.updateMatrixWorld();e(s)}))})).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let i=0,r=t.length;i<r;i++){const n=t[i].joints;for(let t=0,i=n.length;t<i;t++)e[n[t]].isBone=!0}for(let i=0,r=e.length;i<r;i++){const t=e[i];void 0!==t.mesh&&(this._addNodeRef(this.meshCache,t.mesh),void 0!==t.skin&&(n[t.mesh].isSkinnedMesh=!0)),void 0!==t.camera&&this._addNodeRef(this.cameraCache,t.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const i=n.clone(),r=(e,t)=>{const n=this.associations.get(e);null!=n&&this.associations.set(t,n);for(const[i,s]of e.children.entries())r(s,t.children[i])};return r(n,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const i=e(t[n]);if(i)return i}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let i=0;i<t.length;i++){const r=e(t[i]);r&&n.push(r)}return n}getDependency(e,t){const n=e+":"+t;let i=this.cache.get(n);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne((function(e){return e.loadNode&&e.loadNode(t)}));break;case"mesh":i=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":i=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne((function(e){return e.loadAnimation&&e.loadAnimation(t)}));break;case"camera":i=this.loadCamera(t);break;default:if(i=this._invokeOne((function(n){return n!=this&&n.getDependency&&n.getDependency(e,t)})),!i)throw new Error("Unknown type: "+e)}this.cache.add(n,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,i=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(i.map((function(t,i){return n.getDependency(e,i)}))),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[GG.KHR_BINARY_GLTF].body);const i=this.options;return new Promise((function(e,r){n.load(oh.resolveURL(t.uri,i.path),e,void 0,(function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){const n=t.byteLength||0,i=t.byteOffset||0;return e.slice(i,i+n)}))}loadAccessor(e){const t=this,n=this.json,i=this.json.accessors[e];if(void 0===i.bufferView&&void 0===i.sparse){const e=rE[i.type],t=tE[i.componentType],n=!0===i.normalized,r=new t(i.count*e);return Promise.resolve(new ro(r,e,n))}const r=[];return void 0!==i.bufferView?r.push(this.getDependency("bufferView",i.bufferView)):r.push(null),void 0!==i.sparse&&(r.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(r).then((function(e){const r=e[0],s=rE[i.type],o=tE[i.componentType],a=o.BYTES_PER_ELEMENT,l=a*s,c=i.byteOffset||0,g=void 0!==i.bufferView?n.bufferViews[i.bufferView].byteStride:void 0,u=!0===i.normalized;let A,d;if(g&&g!==l){const e=Math.floor(c/g),n="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+e+":"+i.count;let l=t.cache.get(n);l||(A=new o(r,e*g,i.count*g/a),l=new Oc(A,g/a),t.cache.add(n,l)),d=new jc(l,s,c%g/a,u)}else A=null===r?new o(i.count*s):new o(r,c,i.count*s),d=new ro(A,s,u);if(void 0!==i.sparse){const t=rE.SCALAR,n=tE[i.sparse.indices.componentType],a=i.sparse.indices.byteOffset||0,l=i.sparse.values.byteOffset||0,c=new n(e[1],a,i.sparse.count*t),g=new o(e[2],l,i.sparse.count*s);null!==r&&(d=new ro(d.array.slice(),d.itemSize,d.normalized));for(let e=0,i=c.length;e<i;e++){const t=c[e];if(d.setX(t,g[e*s]),s>=2&&d.setY(t,g[e*s+1]),s>=3&&d.setZ(t,g[e*s+2]),s>=4&&d.setW(t,g[e*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return d}))}loadTexture(e){const t=this.json,n=this.options,i=t.textures[e].source,r=t.images[i];let s=this.textureLoader;if(r.uri){const e=n.manager.getHandler(r.uri);null!==e&&(s=e)}return this.loadTextureImage(e,i,s)}loadTextureImage(e,t,n){const i=this,r=this.json,s=r.textures[e],o=r.images[t],a=(o.uri||o.bufferView)+":"+s.sampler;if(this.textureCache[a])return this.textureCache[a];const l=this.loadImageSource(t,n).then((function(t){t.flipY=!1,t.name=s.name||o.name||"",""===t.name&&"string"===typeof o.uri&&!1===o.uri.startsWith("data:image/")&&(t.name=o.uri);const n=(r.samplers||{})[s.sampler]||{};return t.magFilter=nE[n.magFilter]||pt,t.minFilter=nE[n.minFilter]||ft,t.wrapS=iE[n.wrapS]||lt,t.wrapT=iE[n.wrapT]||lt,i.associations.set(t,{textures:e}),t})).catch((function(){return null}));return this.textureCache[a]=l,l}loadImageSource(e,t){const n=this,i=this.json,r=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then((e=>e.clone()));const s=i.images[e],o=self.URL||self.webkitURL;let a=s.uri||"",l=!1;if(void 0!==s.bufferView)a=n.getDependency("bufferView",s.bufferView).then((function(e){l=!0;const t=new Blob([e],{type:s.mimeType});return a=o.createObjectURL(t),a}));else if(void 0===s.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const c=Promise.resolve(a).then((function(e){return new Promise((function(n,i){let s=n;!0===t.isImageBitmapLoader&&(s=function(e){const t=new mr(e);t.needsUpdate=!0,n(t)}),t.load(oh.resolveURL(e,r.path),s,void 0,i)}))})).then((function(e){var t;return!0===l&&o.revokeObjectURL(a),AE(e,s),e.userData.mimeType=s.mimeType||((t=s.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":"image/png"),e})).catch((function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",a),e}));return this.sourceCache[e]=c,c}assignTexture(e,t,n,i){const r=this;return this.getDependency("texture",n.index).then((function(s){if(!s)return null;if(void 0!==n.texCoord&&n.texCoord>0&&((s=s.clone()).channel=n.texCoord),r.extensions[GG.KHR_TEXTURE_TRANSFORM]){const e=void 0!==n.extensions?n.extensions[GG.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const t=r.associations.get(s);s=r.extensions[GG.KHR_TEXTURE_TRANSFORM].extendTexture(s,e),r.associations.set(s,t)}}return void 0!==i&&("number"===typeof i&&(i=3001===i?bG:BG),"colorSpace"in s?s.colorSpace=i:s.encoding=i===bG?3001:3e3),e[t]=s,s}))}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const i=void 0===t.attributes.tangent,r=void 0!==t.attributes.color,s=void 0===t.attributes.normal;if(e.isPoints){const e="PointsMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new Iu,Os.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,t.sizeAttenuation=!1,this.cache.add(e,t)),n=t}else if(e.isLine){const e="LineBasicMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new ru,Os.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,this.cache.add(e,t)),n=t}if(i||r||s){let e="ClonedMaterial:"+n.uuid+":";i&&(e+="derivative-tangents:"),r&&(e+="vertex-colors:"),s&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=n.clone(),r&&(t.vertexColors=!0),s&&(t.flatShading=!0),i&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(n))),n=t}e.material=n}getMaterialType(){return $A}loadMaterial(e){const t=this,n=this.json,i=this.extensions,r=n.materials[e];let s;const o={},a=[];if((r.extensions||{})[GG.KHR_MATERIALS_UNLIT]){const e=i[GG.KHR_MATERIALS_UNLIT];s=e.getMaterialType(),a.push(e.extendParams(o,r,t))}else{const n=r.pbrMetallicRoughness||{};if(o.color=new Ps(1,1,1),o.opacity=1,Array.isArray(n.baseColorFactor)){const e=n.baseColorFactor;o.color.setRGB(e[0],e[1],e[2],BG),o.opacity=e[3]}void 0!==n.baseColorTexture&&a.push(t.assignTexture(o,"map",n.baseColorTexture,bG)),o.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,o.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(a.push(t.assignTexture(o,"metalnessMap",n.metallicRoughnessTexture)),a.push(t.assignTexture(o,"roughnessMap",n.metallicRoughnessTexture))),s=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),a.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,o)}))))}!0===r.doubleSided&&(o.side=le);const l=r.alphaMode||lE;if(l===gE?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,l===cE&&(o.alphaTest=void 0!==r.alphaCutoff?r.alphaCutoff:.5)),void 0!==r.normalTexture&&s!==Js&&(a.push(t.assignTexture(o,"normalMap",r.normalTexture)),o.normalScale=new Oi(1,1),void 0!==r.normalTexture.scale)){const e=r.normalTexture.scale;o.normalScale.set(e,e)}if(void 0!==r.occlusionTexture&&s!==Js&&(a.push(t.assignTexture(o,"aoMap",r.occlusionTexture)),void 0!==r.occlusionTexture.strength&&(o.aoMapIntensity=r.occlusionTexture.strength)),void 0!==r.emissiveFactor&&s!==Js){const e=r.emissiveFactor;o.emissive=(new Ps).setRGB(e[0],e[1],e[2],BG)}return void 0!==r.emissiveTexture&&s!==Js&&a.push(t.assignTexture(o,"emissiveMap",r.emissiveTexture,bG)),Promise.all(a).then((function(){const n=new s(o);return r.name&&(n.name=r.name),AE(n,r),t.associations.set(n,{materials:e}),r.extensions&&uE(i,n,r),n}))}createUniqueName(e){const t=Kh.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,i=this.primitiveCache;function r(e){return n[GG.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return fE(n,e,t)}))}const s=[];for(let o=0,a=e.length;o<a;o++){const n=e[o],a=hE(n),l=i[a];if(l)s.push(l.promise);else{let e;e=n.extensions&&n.extensions[GG.KHR_DRACO_MESH_COMPRESSION]?r(n):fE(new vo,n,t),i[a]={primitive:n,promise:e},s.push(e)}}return Promise.all(s)}loadMesh(e){const t=this,n=this.json,i=this.extensions,r=n.meshes[e],s=r.primitives,o=[];for(let l=0,c=s.length;l<c;l++){const e=void 0===s[l].material?(void 0===(a=this.cache).DefaultMaterial&&(a.DefaultMaterial=new $A({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:oe})),a.DefaultMaterial):this.getDependency("material",s[l].material);o.push(e)}var a;return o.push(t.loadGeometries(s)),Promise.all(o).then((function(n){const o=n.slice(0,n.length-1),a=n[n.length-1],l=[];for(let g=0,u=a.length;g<u;g++){const n=a[g],c=s[g];let u;const A=o[g];if(c.mode===eE.TRIANGLES||c.mode===eE.TRIANGLE_STRIP||c.mode===eE.TRIANGLE_FAN||void 0===c.mode)u=!0===r.isSkinnedMesh?new Eg(n,A):new Qo(n,A),!0===u.isSkinnedMesh&&u.normalizeSkinWeights(),c.mode===eE.TRIANGLE_STRIP?u.geometry=mG(u.geometry,Mn):c.mode===eE.TRIANGLE_FAN&&(u.geometry=mG(u.geometry,Wn));else if(c.mode===eE.LINES)u=new du(n,A);else if(c.mode===eE.LINE_STRIP)u=new gu(n,A);else if(c.mode===eE.LINE_LOOP)u=new hu(n,A);else{if(c.mode!==eE.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+c.mode);u=new yu(n,A)}Object.keys(u.geometry.morphAttributes).length>0&&dE(u,r),u.name=t.createUniqueName(r.name||"mesh_"+e),AE(u,r),c.extensions&&uE(i,u,c),t.assignFinalMaterial(u),l.push(u)}for(let i=0,r=l.length;i<r;i++)t.associations.set(l[i],{meshes:e,primitives:i});if(1===l.length)return r.extensions&&uE(i,l[0],r),l[0];const c=new Vc;r.extensions&&uE(i,c,r),t.associations.set(c,{meshes:e});for(let e=0,t=l.length;e<t;e++)c.add(l[e]);return c}))}loadCamera(e){let t;const n=this.json.cameras[e],i=n[n.type];if(i)return"perspective"===n.type?t=new Jo(_i.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===n.type&&(t=new ba(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),AE(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n=[];for(let i=0,r=t.joints.length;i<r;i++)n.push(this._loadNodeShallow(t.joints[i]));return void 0!==t.inverseBindMatrices?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then((function(e){const n=e.pop(),i=e,r=[],s=[];for(let o=0,a=i.length;o<a;o++){const e=i[o];if(e){r.push(e);const t=new rs;null!==n&&t.fromArray(n.array,16*o),s.push(t)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[o])}return new Dg(r,s)}))}loadAnimation(e){const t=this.json,n=this,i=t.animations[e],r=i.name?i.name:"animation_"+e,s=[],o=[],a=[],l=[],c=[];for(let g=0,u=i.channels.length;g<u;g++){const e=i.channels[g],t=i.samplers[e.sampler],n=e.target,r=n.node,u=void 0!==i.parameters?i.parameters[t.input]:t.input,A=void 0!==i.parameters?i.parameters[t.output]:t.output;void 0!==n.node&&(s.push(this.getDependency("node",r)),o.push(this.getDependency("accessor",u)),a.push(this.getDependency("accessor",A)),l.push(t),c.push(n))}return Promise.all([Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c)]).then((function(e){const t=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=[];for(let r=0,c=t.length;r<c;r++){const e=t[r],c=i[r],g=s[r],u=o[r],A=a[r];if(void 0===e)continue;e.updateMatrix&&e.updateMatrix();const d=n._createAnimationTracks(e,c,g,u,A);if(d)for(let t=0;t<d.length;t++)l.push(d[t])}return new Gd(r,void 0,l)}))}createNodeMesh(e){const t=this.json,n=this,i=t.nodes[e];return void 0===i.mesh?null:n.getDependency("mesh",i.mesh).then((function(e){const t=n._getNodeRef(n.meshCache,i.mesh,e);return void 0!==i.weights&&t.traverse((function(e){if(e.isMesh)for(let t=0,n=i.weights.length;t<n;t++)e.morphTargetInfluences[t]=i.weights[t]})),t}))}loadNode(e){const t=this,n=this.json.nodes[e],i=t._loadNodeShallow(e),r=[],s=n.children||[];for(let a=0,l=s.length;a<l;a++)r.push(t.getDependency("node",s[a]));const o=void 0===n.skin?Promise.resolve(null):t.getDependency("skin",n.skin);return Promise.all([i,Promise.all(r),o]).then((function(e){const t=e[0],n=e[1],i=e[2];null!==i&&t.traverse((function(e){e.isSkinnedMesh&&e.bind(i,CE)}));for(let r=0,s=n.length;r<s;r++)t.add(n[r]);return t}))}_loadNodeShallow(e){const t=this.json,n=this.extensions,i=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const r=t.nodes[e],s=r.name?i.createUniqueName(r.name):"",o=[],a=i._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)}));return a&&o.push(a),void 0!==r.camera&&o.push(i.getDependency("camera",r.camera).then((function(e){return i._getNodeRef(i.cameraCache,r.camera,e)}))),i._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){o.push(e)})),this.nodeCache[e]=Promise.all(o).then((function(t){let o;if(o=!0===r.isBone?new xg:t.length>1?new Vc:1===t.length?t[0]:new Rs,o!==t[0])for(let e=0,n=t.length;e<n;e++)o.add(t[e]);if(r.name&&(o.userData.name=r.name,o.name=s),AE(o,r),r.extensions&&uE(n,o,r),void 0!==r.matrix){const e=new rs;e.fromArray(r.matrix),o.applyMatrix4(e)}else void 0!==r.translation&&o.position.fromArray(r.translation),void 0!==r.rotation&&o.quaternion.fromArray(r.rotation),void 0!==r.scale&&o.scale.fromArray(r.scale);return i.associations.has(o)||i.associations.set(o,{}),i.associations.get(o).nodes=e,o})),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],i=this,r=new Vc;n.name&&(r.name=i.createUniqueName(n.name)),AE(r,n),n.extensions&&uE(t,r,n);const s=n.nodes||[],o=[];for(let a=0,l=s.length;a<l;a++)o.push(i.getDependency("node",s[a]));return Promise.all(o).then((function(e){for(let t=0,n=e.length;t<n;t++)r.add(e[t]);return i.associations=(e=>{const t=new Map;for(const[n,r]of i.associations)(n instanceof Os||n instanceof mr)&&t.set(n,r);return e.traverse((e=>{const n=i.associations.get(e);null!=n&&t.set(e,n)})),t})(r),r}))}_createAnimationTracks(e,t,n,i,r){const s=[],o=e.name?e.name:e.uuid,a=[];let l;switch(oE[r.path]===oE.weights?e.traverse((function(e){e.morphTargetInfluences&&a.push(e.name?e.name:e.uuid)})):a.push(o),oE[r.path]){case oE.weights:l=yd;break;case oE.rotation:l=Bd;break;case oE.position:case oE.scale:l=wd;break;default:if(1===n.itemSize)l=yd;else l=wd}const c=void 0!==i.interpolation?aE[i.interpolation]:En,g=this._getArrayFromAccessor(n);for(let u=0,A=a.length;u<A;u++){const e=new l(a[u]+"."+oE[r.path],t.array,g,c);"CUBICSPLINE"===i.interpolation&&this._createCubicSplineTrackInterpolant(e),s.push(e)}return s}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const e=pE(t.constructor),n=new Float32Array(t.length);for(let i=0,r=t.length;i<r;i++)n[i]=t[i]*e;t=n}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(e){return new(this instanceof Bd?$G:jG)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function fE(e,t,n){const i=t.attributes,r=[];function s(t,i){return n.getDependency("accessor",t).then((function(t){e.setAttribute(i,t)}))}for(const o in i){const t=sE[o]||o.toLowerCase();t in e.attributes||r.push(s(i[o],t))}if(void 0!==t.indices&&!e.index){const i=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));r.push(i)}return AE(e,t),function(e,t,n){const i=t.attributes,r=new Dr;if(void 0===i.POSITION)return;{const e=n.json.accessors[i.POSITION],t=e.min,s=e.max;if(void 0===t||void 0===s)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new Sr(t[0],t[1],t[2]),new Sr(s[0],s[1],s[2])),e.normalized){const t=pE(tE[e.componentType]);r.min.multiplyScalar(t),r.max.multiplyScalar(t)}}const s=t.targets;if(void 0!==s){const e=new Sr,t=new Sr;for(let i=0,r=s.length;i<r;i++){const r=s[i];if(void 0!==r.POSITION){const i=n.json.accessors[r.POSITION],s=i.min,o=i.max;if(void 0!==s&&void 0!==o){if(t.setX(Math.max(Math.abs(s[0]),Math.abs(o[0]))),t.setY(Math.max(Math.abs(s[1]),Math.abs(o[1]))),t.setZ(Math.max(Math.abs(s[2]),Math.abs(o[2]))),i.normalized){const e=pE(tE[i.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(e)}e.boundingBox=r;const o=new Or;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,e.boundingSphere=o}(e,t,n),Promise.all(r).then((function(){return void 0!==t.targets?function(e,t,n){let i=!1,r=!1,s=!1;for(let c=0,g=t.length;c<g;c++){const e=t[c];if(void 0!==e.POSITION&&(i=!0),void 0!==e.NORMAL&&(r=!0),void 0!==e.COLOR_0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(e);const o=[],a=[],l=[];for(let c=0,g=t.length;c<g;c++){const g=t[c];if(i){const t=void 0!==g.POSITION?n.getDependency("accessor",g.POSITION):e.attributes.position;o.push(t)}if(r){const t=void 0!==g.NORMAL?n.getDependency("accessor",g.NORMAL):e.attributes.normal;a.push(t)}if(s){const t=void 0!==g.COLOR_0?n.getDependency("accessor",g.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then((function(t){const n=t[0],o=t[1],a=t[2];return i&&(e.morphAttributes.position=n),r&&(e.morphAttributes.normal=o),s&&(e.morphAttributes.color=a),e.morphTargetsRelative=!0,e}))}(e,t.targets,n):e}))}let yE=null,bE="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function BE(e,t,n){return i=>{n&&n(i),e&&(yE||(yE=new hG),yE.setDecoderPath("string"===typeof e?e:bE),i.setDRACOLoader(yE)),t&&i.setMeshoptDecoder("function"===typeof CG?CG():CG)}}function vE(e){return qp(vG,e,BE(!(arguments.length>1&&void 0!==arguments[1])||arguments[1],!(arguments.length>2&&void 0!==arguments[2])||arguments[2],arguments.length>3?arguments[3]:void 0))}vE.preload=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0;return qp.preload(vG,e,BE(t,n,i))},vE.clear=e=>qp.clear(vG,e),vE.setDecoderPath=e=>{bE=e};function wE(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"video";const[n,i]=(0,t.useState)(),r=KI(e);return(0,t.useEffect)((()=>{r&&i(new Bu(r))}),[r]),n}vE.preload("/Beetle.glb");const GE=(0,t.forwardRef)(((e,n)=>{const{nodes:i,materials:r}=vE("/Beetle.glb"),s=wE(),o=(0,t.useMemo)((()=>new Js({map:null!==s&&void 0!==s?s:null,wireframe:!0})),[s]);return(0,I.jsx)("mesh",{name:"car",ref:n,children:(0,I.jsxs)("group",{position:[0,-.6,0],children:[(0,I.jsx)("mesh",{visible:!0,material:o,geometry:i.chassis_1.geometry}),(0,I.jsx)("mesh",{visible:!0,material:o,geometry:i.chassis_2.geometry}),(0,I.jsx)("mesh",{visible:!0,material:o,geometry:i.chassis_3.geometry}),(0,I.jsx)("mesh",{visible:!0,material:o,geometry:i.chassis_4.geometry}),(0,I.jsx)("mesh",{visible:!0,material:o,geometry:i.chassis_5.geometry}),(0,I.jsx)("mesh",{visible:!0,material:o,geometry:i.chassis_6.geometry}),(0,I.jsx)("mesh",{visible:!0,material:o,geometry:i.chassis_7.geometry}),(0,I.jsx)("mesh",{visible:!0,material:o,geometry:i.chassis_8.geometry}),(0,I.jsx)("mesh",{visible:!1,material:o,geometry:i.chassis_9.geometry}),(0,I.jsx)("mesh",{visible:!0,material:o,geometry:i.chassis_10.geometry}),(0,I.jsx)("mesh",{visible:!0,material:o,geometry:i.chassis_11.geometry}),(0,I.jsx)("mesh",{visible:!0,material:o,geometry:i.chassis_12.geometry}),(0,I.jsx)("mesh",{visible:!0,material:o,geometry:i.chassis_13.geometry}),(0,I.jsx)("mesh",{visible:!0,material:o,geometry:i.chassis_14.geometry}),(0,I.jsx)("mesh",{visible:!0,material:o,geometry:i.chassis_15.geometry}),(0,I.jsx)("mesh",{visible:!0,material:o,geometry:i.chassis_16.geometry})]})})}));const EE={shift:"brake"," ":"handbrake",ArrowDown:"backward",ArrowLeft:"left",ArrowRight:"right",ArrowUp:"forward",a:"left",d:"right",r:"reset",s:"backward",w:"forward"},xE=Object.keys(EE),SE=e=>xE.includes(e);function RE(){const e=(0,t.useRef)({backward:!1,brake:!1,forward:!1,left:!1,reset:!1,right:!1,handbrake:!1});return function(e,n){let{current:i}=e;(0,t.useEffect)((()=>{const e=e=>{let{key:t}=e;SE(t)&&(i[n[t]]=!0)};window.addEventListener("keydown",e);const t=e=>{let{key:t}=e;SE(t)&&(i[n[t]]=!1)};return window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}}),[i,n])}(e,EE),e}vE.preload("/wheel.glb");const ZE=(0,t.forwardRef)(((e,n)=>{let{leftSide:i,radius:r=.7,...s}=e;const{materials:{Chrom:o,Rubber:a,Steel:l},nodes:c}=vE("/wheel.glb");!function(e,t,n){nG("Compound",e,(e=>e),t,n)}((()=>({collisionFilterGroup:0,mass:1,material:"wheel",shapes:[{args:[r,r,.5,16],rotation:[0,0,-Math.PI/2],type:"Cylinder"}],type:"Kinematic",...s})),n);const g=wE(),u=(0,t.useMemo)((()=>new Js({map:null!==g&&void 0!==g?g:null,wireframe:!0})),[g]);return(0,I.jsx)("group",{ref:n,children:(0,I.jsxs)("group",{rotation:[0,0,(i?1:-1)*Math.PI/2],children:[(0,I.jsx)("mesh",{material:u,geometry:c.wheel_1.geometry}),(0,I.jsx)("mesh",{material:u,geometry:c.wheel_2.geometry}),(0,I.jsx)("mesh",{material:u,geometry:c.wheel_3.geometry})]})})}));const DE=function(e){let{angularVelocity:n,back:i=-1.15,force:r=1500,front:s=1.3,height:o=-.04,maxBrake:a=50,position:l,radius:c=.7,rotation:g,steer:u=.5,width:A=1.2}=e;const d=[(0,t.useRef)(null),(0,t.useRef)(null),(0,t.useRef)(null),(0,t.useRef)(null)],h=RE(),p={axleLocal:[-1,0,0],customSlidingRotationalSpeed:-30,dampingCompression:4.4,dampingRelaxation:10,directionLocal:[0,-1,0],frictionSlip:2,maxSuspensionForce:1e4,maxSuspensionTravel:.3,radius:c,suspensionRestLength:.3,suspensionStiffness:30,useCustomSlidingRotationalSpeed:!0},C={...p,frictionSlip:.8},m={...p,chassisConnectionPointLocal:[-A/2,o,s],isFrontWheel:!0},f={...p,chassisConnectionPointLocal:[A/2,o,s],isFrontWheel:!0},y={...C,chassisConnectionPointLocal:[-A/2,o,i],isFrontWheel:!1},b={...C,chassisConnectionPointLocal:[A/2,o,i],isFrontWheel:!1},[B,v]=rG((()=>({allowSleep:!1,angularVelocity:n,args:[1.7,1,4],mass:500,onCollide:e=>console.log("bonk",e.body.userData),position:l,rotation:g})),(0,t.useRef)(null)),[w,G]=oG((()=>({chassisBody:B,wheelInfos:[m,f,y,b],wheels:d})),(0,t.useRef)(null));return Op((()=>{const{backward:e,brake:t,forward:i,left:s,reset:o,right:c,handbrake:A}=h.current;for(let n=2;n<4;n++)G.applyEngineForce(i||e?r*(i&&!e?-1:1):0,n);for(let n=0;n<2;n++)G.setSteeringValue(s||c?u*(s&&!c?1:-1):0,n);for(let n=2;n<4;n++)G.setBrake(t||A?a*(A?2:1):0,n);o&&(v.position.set(...l),v.velocity.set(0,0,0),v.angularVelocity.set(...n),v.rotation.set(...g))})),(0,I.jsxs)("group",{ref:w,position:[0,-.4,0],children:[(0,I.jsx)(GE,{ref:B}),(0,I.jsx)(ZE,{ref:d[0],radius:c,leftSide:!0}),(0,I.jsx)(ZE,{ref:d[1],radius:c}),(0,I.jsx)(ZE,{ref:d[2],radius:c,leftSide:!0}),(0,I.jsx)(ZE,{ref:d[3],radius:c})]})};function FE(e){const[n]=iG((()=>({material:"ground",type:"Static",...e})),(0,t.useRef)(null));return(0,I.jsx)("group",{ref:n,visible:!1,children:(0,I.jsxs)("mesh",{children:[(0,I.jsx)("planeGeometry",{args:[100,100]}),(0,I.jsx)("meshStandardMaterial",{color:"#303030"})]})})}const NE=()=>(0,I.jsx)(I.Fragment,{children:(0,I.jsxs)(AG,{broadphase:"SAP",defaultContactMaterial:{contactEquationRelaxation:4,friction:.001},allowSleep:!0,children:[(0,I.jsx)(FE,{rotation:[-Math.PI/2,0,0],userData:{id:"floor"}}),(0,I.jsx)(DE,{position:[0,2,0],rotation:[0,-Math.PI/4,0],angularVelocity:[0,.5,0]})]})}),ME=()=>(0,I.jsx)(NE,{});function WE(e){let{name:n="",interval:i=1,position:r=[0,0,0],rotation:s=[0,0,0]}=e;const{scene:o,camera:a}=_p(),[l,c]=(0,t.useState)(),g=(0,t.useRef)();return(0,t.useEffect)((()=>{const e=setInterval((()=>{console.log("Buscando el objeto ".concat(n," para seguirlo con la camara"));const t=o.getObjectByName(n);t&&(clearInterval(e),g.current=t,c((e=>t)))}),i)}),[n]),(0,t.useEffect)((()=>(g.current&&(g.current.add(a),a.position.set(r[0],r[1],r[2]),a.rotation.set(s[0],s[1],s[2])),()=>{g.current&&g.current.remove(a)})),[g.current,l]),null}const kE=t.memo((()=>(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(ME,{}),(0,I.jsx)(WE,{name:"car",position:[0,.6,-0],rotation:[.3,3.1,0]})]})));function TE(){const e=G((e=>e.controlsId)),n=Z((e=>e.sceneId)),{camera:i}=_p(),[r,s]=(0,t.useState)([0,0,0]);return(0,t.useEffect)((()=>{switch(n){case 0:case 2:s((e=>[0,0,400]));break;case 1:s((e=>[0,0,.1]));break;default:s((e=>[0,0,0]))}1===e&&(null===i||void 0===i||i.position.set(0,0,0),null===i||void 0===i||i.rotation.set(0,0,0))}),[n,e]),(0,I.jsx)(I.Fragment,{children:(()=>{switch(e){case 0:return(0,I.jsx)(Hb,{position:r});case 1:return(0,I.jsx)(Zb,{});case 2:return(0,I.jsx)(Rb,{position:r});case 3:return(0,I.jsx)(kE,{});default:return console.warn("No se ha definido el control elegido, Control: "+e),null}})()})}const VE=20,LE=.5;function HE(){const e=fb("left"),n=fb("right"),i=(0,t.useRef)(null),[r,s]=(0,t.useState)(0),[o,a]=(0,t.useState)(0),l=(0,t.useCallback)((e=>{const t=new Sr;i.current.getWorldDirection(t),t.y=0,t.normalize(),i.current.position.addScaledVector(t,e)}),[i.current]),c=(0,t.useCallback)((e=>{const t=new Sr;i.current.getWorldDirection(t),t.y=0,t.normalize(),t.cross(i.current.up),i.current.position.addScaledVector(t,e)}),[i.current]),g=(0,t.useCallback)((e=>{i.current.position.y+=e}),[i.current]),u=(0,t.useCallback)(((e,t)=>{s((t=>t+e)),a((e=>Math.max(-Math.PI/2,Math.min(Math.PI/2,e+t))))}),[i.current]);return Op(((t,s)=>{var o,a,A,d;if(null==i.current||null==n||null==e)return;const h=s*VE,I=s*LE,p=e.gamepad["xr-standard-thumbstick"];if(null==p)return;const C=null!==(o=p.xAxis)&&void 0!==o?o:0,m=null!==(a=p.yAxis)&&void 0!==a?a:0;l(m*h),c(-C*h);const f=n.gamepad["xr-standard-thumbstick"];if(null==f)return;const y=null!==(A=f.xAxis)&&void 0!==A?A:0,b=null!==(d=f.yAxis)&&void 0!==d?d:0;u(y*I,-b*I),i.current.rotation.set(0,-r,0,"YXZ"),g(-b*h)})),(0,I.jsx)(Bb,{ref:i})}function QE(e){let{name:n="train",interval:i=1}=e;const r=(0,t.useRef)(null),{scene:s}=_p(),[o,a]=(0,t.useState)(),l=(0,t.useRef)();return(0,t.useEffect)((()=>{const e=setInterval((()=>{const t=s.getObjectByName(n);t&&(clearInterval(e),l.current=t,a((e=>t)))}),i)}),[n]),(0,t.useEffect)((()=>(l.current&&r.current&&l.current.add(r.current),()=>{l.current&&r.current&&l.current.remove(r.current)})),[l.current,o,r.current]),(0,I.jsx)(Bb,{ref:r})}const KE=function(e){let{angularVelocity:n,back:i=-1.15,force:r=1500,front:s=1.3,height:o=-.04,maxBrake:a=50,position:l,radius:c=.7,rotation:g,steer:u=.5,width:A=1.2}=e;const d=[(0,t.useRef)(null),(0,t.useRef)(null),(0,t.useRef)(null),(0,t.useRef)(null)],h=fb("left"),p=fb("right"),C={axleLocal:[-1,0,0],customSlidingRotationalSpeed:-30,dampingCompression:4.4,dampingRelaxation:10,directionLocal:[0,-1,0],frictionSlip:2,maxSuspensionForce:1e4,maxSuspensionTravel:.3,radius:c,suspensionRestLength:.3,suspensionStiffness:30,useCustomSlidingRotationalSpeed:!0},m={...C,frictionSlip:.8},f={...C,chassisConnectionPointLocal:[-A/2,o,s],isFrontWheel:!0},y={...C,chassisConnectionPointLocal:[A/2,o,s],isFrontWheel:!0},b={...m,chassisConnectionPointLocal:[-A/2,o,i],isFrontWheel:!1},B={...m,chassisConnectionPointLocal:[A/2,o,i],isFrontWheel:!1},[v,w]=rG((()=>({allowSleep:!1,angularVelocity:n,args:[1.7,1,4],mass:500,onCollide:e=>console.log("bonk",e.body.userData),position:l,rotation:g})),(0,t.useRef)(null)),[G,E]=oG((()=>({chassisBody:v,wheelInfos:[f,y,b,B],wheels:d})),(0,t.useRef)(null));return Op((()=>{var e,t,i,s;let{backward:o,brake:c,forward:A,left:d,reset:I,right:C,handbrake:m}={backward:!1,brake:!1,forward:!1,left:!1,reset:!1,right:!1,handbrake:!1};if(null==p||null==h)return;const f=h.gamepad["xr-standard-thumbstick"];if(null==f)return;const y=null!==(e=f.xAxis)&&void 0!==e?e:0,b=null!==(t=f.yAxis)&&void 0!==t?t:0;y<0&&(d=!0),y>0&&(C=!0),-b<0&&(o=!0);const B=p.gamepad["xr-standard-thumbstick"];if(null==B)return;i=B.xAxis;const v=null!==(s=B.yAxis)&&void 0!==s?s:0;-v<.1&&(m=!0),-v>.1&&(A=!0);for(let n=2;n<4;n++)E.applyEngineForce(A||o?r*(A&&!o?-1:1):0,n);for(let n=0;n<2;n++)E.setSteeringValue(d||C?u*(d&&!C?1:-1):0,n);for(let n=2;n<4;n++)E.setBrake(c||m?a*(m?2:1):0,n);I&&(w.position.set(...l),w.velocity.set(0,0,0),w.angularVelocity.set(...n),w.rotation.set(...g))})),(0,I.jsxs)("group",{ref:G,position:[0,-.4,0],children:[(0,I.jsx)(GE,{ref:v}),(0,I.jsx)(ZE,{ref:d[0],radius:c,leftSide:!0}),(0,I.jsx)(ZE,{ref:d[1],radius:c}),(0,I.jsx)(ZE,{ref:d[2],radius:c,leftSide:!0}),(0,I.jsx)(ZE,{ref:d[3],radius:c})]})};function XE(e){const[n]=iG((()=>({material:"ground",type:"Static",...e})),(0,t.useRef)(null));return(0,I.jsx)("group",{ref:n,visible:!1,children:(0,I.jsxs)("mesh",{children:[(0,I.jsx)("planeGeometry",{args:[100,100]}),(0,I.jsx)("meshStandardMaterial",{color:"#303030"})]})})}const YE=()=>(0,I.jsx)(I.Fragment,{children:(0,I.jsxs)(AG,{broadphase:"SAP",defaultContactMaterial:{contactEquationRelaxation:4,friction:.001},allowSleep:!0,children:[(0,I.jsx)(XE,{rotation:[-Math.PI/2,0,0],userData:{id:"floor"}}),(0,I.jsx)(KE,{position:[0,2,0],rotation:[0,0,0],angularVelocity:[0,.5,0]})]})}),zE=()=>(0,I.jsx)(YE,{});function PE(e){let{name:n="",interval:i=1,position:r=[0,0,0],rotation:s=[0,0,0]}=e;const o=(0,t.useRef)(null),{scene:a}=_p(),[l,c]=(0,t.useState)(),g=(0,t.useRef)();return(0,t.useEffect)((()=>{const e=setInterval((()=>{console.log("Buscando el objeto ".concat(n," para seguirlo con la camara"));const t=a.getObjectByName(n);t&&(clearInterval(e),g.current=t,c((e=>t)))}),i)}),[n]),(0,t.useEffect)((()=>(g.current&&o.current&&(g.current.add(o.current),o.current.position.set(r[0],r[1],r[2]),o.current.rotation.set(s[0],s[1],s[2])),()=>{g.current&&o.current&&g.current.remove(o.current)})),[g.current,l]),(0,I.jsx)(Bb,{ref:o})}const UE=t.memo((()=>(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(zE,{}),(0,I.jsx)(PE,{name:"car",position:[0,0,0],rotation:[0,3,0]})]})));function _E(){const e=E((e=>e.controlsXRId)),n=Z((e=>e.sceneId)),{camera:i}=_p(),[r,s]=(0,t.useState)([0,0,0]);return(0,t.useEffect)((()=>{switch(n){case 0:case 2:s((e=>[0,0,400]));break;case 1:s((e=>[0,0,.1]));break;default:s((e=>[0,0,0]))}1===e&&(null===i||void 0===i||i.position.set(0,0,0),null===i||void 0===i||i.rotation.set(0,0,0))}),[n,e]),(0,I.jsx)(I.Fragment,{children:(()=>{switch(e){case 0:return(0,I.jsx)(HE,{});case 1:return(0,I.jsx)(QE,{});case 2:return(0,I.jsx)(UE,{});default:return console.warn("No se ha definido el control XR elegido, Control: "+e),null}})()})}let OE,JE,jE;class qE{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2048;if(e){!function(e){window.contextAnalyser?(OE=window.contextAnalyser,JE=window.srcAnalyser,jE=window.analyser):(OE=new AudioContext,JE=OE.createMediaElementSource(e),jE=OE.createAnalyser(),JE.connect(jE),jE.connect(OE.destination),window.contextAnalyser=OE,window.srcAnalyser=JE,window.analyser=jE)}(e),jE.fftSize=t;const n=jE.frequencyBinCount,i=new Uint8Array(n);this.fftSize=t,this.bufferLength=n,this.context=OE,this.analyser=jE,this.dataArray=i,this.dataTexture=void 0}else console.error("No se ha podido crear el Analyser")}disconnect(){}getDataTexture(){if(!this.dataTexture){const e=Vt;this.dataTexture=new Sg(this.dataArray,this.bufferLength,1,e)}return this.dataTexture}update(){this.analyser&&this.dataArray&&this.analyser.getByteFrequencyData(this.dataArray)}getLowerMax(){const e=this.getLowerHalfArray();return Math.max(...this.getLowerHalfArray())/e.length}getUpdateLowerMax(){return this.update(),this.getLowerMax()}getLowerHalfArray(){const e=this.dataArray;return e?e.slice(0,e.length/2-1):[0]}getUpperHalfArray(){const e=this.dataArray;return e?e.slice(e.length/2-1,e.length-1):[0]}}class $E extends _o{constructor(){super({uniforms:{iTime:{type:"f",value:0},iResolution:{value:new Sr(1,1,1)},bass:{type:"f",value:0},mid:{type:"f",value:0},treble:{type:"f",value:0},pointSize:{type:"f",value:1.5},amplitudeDistance:{type:"f",value:1},colorInput:{value:new Sr(0,0,0)},iChannel0:{type:"t",value:void 0}},vertexShader:"\n      varying vec2 vUv;\n\n      uniform float iTime;\n      uniform sampler2D iChannel0;\n  \n      uniform float bass;\n      uniform float mid;\n      uniform float treble;\n\n      uniform float pointSize;\n\n      uniform float amplitudeDistance;\n  \n  \n          void main() {\n              vUv = uv;\n  \n              vec4 textureVideo = texture2D( iChannel0, vec2( vUv.x, vUv.y) );\n              float gray = (textureVideo.r + textureVideo.g + textureVideo.b) / 3.0;\n              float threshold = 300.0;\n              vec3 pos = position;\n  \n              float r = bass + 0.5;\n              float g = treble;\n              float b = mid;\n              float distance = 400.0;\n              float distance2 = 300.0;\n              float distance3 = 100.0;\n  \n              if(gray < 0.1){\n                  pos.z = - gray * ( bass * 1.0) ;\n              } else if (gray < 0.3) {\n                  pos.z = - gray * ( bass * distance) ;\n              } else if(gray < 0.4) {\n                  pos.z = - gray * bass * distance2;\n                  // pos.z = -1000.0;\n              } else if(gray < 0.6) {\n                  pos.z = - gray * bass * distance3;\n              } else if(gray < 0.8) {\n                  pos.z = - gray * bass * distance2;\n              }\n  \n              // if(gray < 0.3){\n              //     pos.z = - gray * r * bass * distance;\n              // } else if(gray < 0.6) {\n              //     pos.z = gray * r * bass * distance2;\n              // } else {\n              //     pos.z = gray * bass * distance3;\n              // }\n              \n              pos.z += gray * bass * (amplitudeDistance * -1.0);\n  \n  \n              gl_PointSize = pointSize ;\n  \n              gl_Position = projectionMatrix * modelViewMatrix * vec4( pos, 1.0 );\n            }\n        ",fragmentShader:"\n\n      #include <common>\n\n      varying vec2 vUv;\n  \n      uniform vec3 iResolution;\n      uniform float iTime;\n  \n      uniform float bass;\n      uniform float mid;\n      uniform float treble;\n      uniform sampler2D iChannel0;\n  \n      uniform vec3 colorInput;\n  \n      vec3 colorA = vec3(0.3,0.0,0.0);\n      vec3 colorB = vec3(1.0,0.0,0.0);\n  \n      void mainImage(out vec4 fragColor, in vec2 fragCoord) {\n          \n          vec2 uv = fragCoord.xy / iResolution.xy;\n          uv.x *= iResolution.x / iResolution.y;\n  \n          \n          //vec3 color = mix(colorA,colorB,bass+0.3);\n  \n          //vec4 textureVideo = texture2D( iChannel0, vec2( vUv.x, vUv.y) );\n          //float gray = (textureVideo.r + textureVideo.g + textureVideo.b) / 3.0;\n          //vec3 color = textureVideo.rgb;                        \n          //vec3 color_red = vec3(bass+gray,0.0,0.0);\n          //color = ( textureVideo.rgb  ) * vec3(bass + 0.5 , bass + 0.5 , bass + 0.5 ) * 1.0;\n          //float isColor = colorInput.r + colorInput.g + colorInput.b;\n          //if ( isColor  != 0.0 ) {\n          //    color = vec3( colorInput.r * (bass + gray), colorInput.g * (bass + gray), colorInput.b * (bass + gray)  );\n          //    color = vec3(1.0,0.0,0.0);\n          //}\n          //color = vec3( textureVideo.r - 0.1, textureVideo.g - 0.1, textureVideo.b - 0.1 ) + vec3( bass * 0.2, bass * 0.2, bass * 0.2 );\n  \n          vec4 textureVideo = texture2D( iChannel0, vec2( vUv.x, vUv.y) );\n          vec3 color = textureVideo.rgb;\n          //color.r += bass - 0.6 ;\n          //color.g += bass - 0.6;\n          //color.b += bass - 0.6;\n          fragColor = vec4(color, 1.0 );\n  \n  \n      }\n      void main() {\n          mainImage(gl_FragColor, vUv * iResolution.xy);\n      }\n    "})}get iTime(){return this.uniforms.iTime.value}set iTime(e){this.uniforms.iTime.value=e}get iResolution(){return this.uniforms.iResolution.value}set iResolution(e){return this.uniforms.iResolution.value=e}get bass(){return this.uniforms.bass.value}set bass(e){return this.uniforms.bass.value=e}get mid(){return this.uniforms.mid.value}set mid(e){return this.uniforms.mid.value=e}get treble(){return this.uniforms.treble.value}set treble(e){return this.uniforms.treble.value=e}get pointSize(){return this.uniforms.pointSize.value}set pointSize(e){return this.uniforms.pointSize.value=e}get colorInput(){return this.uniforms.colorInput.value}set colorInput(e){return this.uniforms.colorInput.value=e}get iChannel0(){return this.uniforms.iChannel0.value}set iChannel0(e){return this.uniforms.iChannel0.value=e}}function ex(e){let{id_video:n="video",position:i=[0,0,0]}=e;const{scene:r}=_p(),s=KI(n),o=y((e=>e.resolution)),[a,l]=(0,t.useState)();(0,t.useEffect)((()=>{if(s){const e=new vo,t=[],n=[],a=o.width,c=o.height;for(let i=0,r=c;i<r;i+=1)for(let e=0,s=a;e<s;e+=1){const r=new Sr(e-a/2,c/2-i,0);t.push(r.x,r.y,r.z),n.push(e/a,i/c)}e.setAttribute("position",new ho(t,3)),e.setAttribute("uv",new ho(n,2));const g=new $E;g.uniforms.iChannel0.value=new Bu(s);const u=new yu(e,g);return u.rotation.x+=Math.PI,u.position.set(i[0],i[1],i[2]),r.add(u),l((e=>u)),window.videoPoints=u,()=>{r.remove(u),l((e=>null))}}}),[s,o]);const c=function(e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2048;const[i,r]=(0,t.useState)();return(0,t.useEffect)((()=>{if(e){const t=new qE(e,n);r((e=>t))}}),[e]),i}(s);return Op((()=>{c&&a&&(a.material.uniforms.bass.value=c.getUpdateLowerMax())})),null}np({VideoPointShader:$E});class tx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;this.maxEdgeLength=e,this.maxIterations=t}modify(e){null!==e.index&&(e=e.toNonIndexed());const t=this.maxIterations,n=this.maxEdgeLength*this.maxEdgeLength,i=new Sr,r=new Sr,s=new Sr,o=new Sr,a=[i,r,s,o],l=new Sr,c=new Sr,g=new Sr,u=new Sr,A=[l,c,g,u],d=new Ps,h=new Ps,I=new Ps,p=new Ps,C=[d,h,I,p],m=new Oi,f=new Oi,y=new Oi,b=new Oi,B=[m,f,y,b],v=new Oi,w=new Oi,G=new Oi,E=new Oi,x=[v,w,G,E],S=e.attributes,R=void 0!==S.normal,Z=void 0!==S.color,D=void 0!==S.uv,F=void 0!==S.uv1;let N=S.position.array,M=R?S.normal.array:null,W=Z?S.color.array:null,k=D?S.uv.array:null,T=F?S.uv1.array:null,V=N,L=M,H=W,Q=k,K=T,X=0,Y=!0;function z(e,t,n){const i=a[e],r=a[t],s=a[n];if(V.push(i.x,i.y,i.z),V.push(r.x,r.y,r.z),V.push(s.x,s.y,s.z),R){const i=A[e],r=A[t],s=A[n];L.push(i.x,i.y,i.z),L.push(r.x,r.y,r.z),L.push(s.x,s.y,s.z)}if(Z){const i=C[e],r=C[t],s=C[n];H.push(i.r,i.g,i.b),H.push(r.r,r.g,r.b),H.push(s.r,s.g,s.b)}if(D){const i=B[e],r=B[t],s=B[n];Q.push(i.x,i.y),Q.push(r.x,r.y),Q.push(s.x,s.y)}if(F){const i=x[e],r=x[t],s=x[n];K.push(i.x,i.y),K.push(r.x,r.y),K.push(s.x,s.y)}}for(;Y&&X<t;){X++,Y=!1,N=V,V=[],R&&(M=L,L=[]),Z&&(W=H,H=[]),D&&(k=Q,Q=[]),F&&(T=K,K=[]);for(let e=0,t=0,a=N.length;e<a;e+=9,t+=6){i.fromArray(N,e+0),r.fromArray(N,e+3),s.fromArray(N,e+6),R&&(l.fromArray(M,e+0),c.fromArray(M,e+3),g.fromArray(M,e+6)),Z&&(d.fromArray(W,e+0),h.fromArray(W,e+3),I.fromArray(W,e+6)),D&&(m.fromArray(k,t+0),f.fromArray(k,t+2),y.fromArray(k,t+4)),F&&(v.fromArray(T,t+0),w.fromArray(T,t+2),G.fromArray(T,t+4));const a=i.distanceToSquared(r),A=r.distanceToSquared(s),C=i.distanceToSquared(s);a>n||A>n||C>n?(Y=!0,a>=A&&a>=C?(o.lerpVectors(i,r,.5),R&&u.lerpVectors(l,c,.5),Z&&p.lerpColors(d,h,.5),D&&b.lerpVectors(m,f,.5),F&&E.lerpVectors(v,w,.5),z(0,3,2),z(3,1,2)):A>=a&&A>=C?(o.lerpVectors(r,s,.5),R&&u.lerpVectors(c,g,.5),Z&&p.lerpColors(h,I,.5),D&&b.lerpVectors(f,y,.5),F&&E.lerpVectors(w,G,.5),z(0,1,3),z(3,2,0)):(o.lerpVectors(i,s,.5),R&&u.lerpVectors(l,g,.5),Z&&p.lerpColors(d,I,.5),D&&b.lerpVectors(m,y,.5),F&&E.lerpVectors(v,G,.5),z(0,1,3),z(3,1,2))):z(0,1,2)}}const P=new vo;return P.setAttribute("position",new ho(V,3)),R&&P.setAttribute("normal",new ho(L,3)),Z&&P.setAttribute("color",new ho(H,3)),D&&P.setAttribute("uv",new ho(Q,2)),F&&P.setAttribute("uv1",new ho(K,2)),P}}class nx extends Zd{constructor(e){super(e)}load(e,t,n,i){const r=this,s=new Nd(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(e){const n=r.parse(JSON.parse(e));t&&t(n)}),n,i)}parse(e){return new ix(e)}}class ix{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e){const t=[],n=function(e,t,n){const i=Array.from(e),r=t/n.resolution,s=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*r,o=[];let a=0,l=0;for(let c=0;c<i.length;c++){const e=i[c];if("\n"===e)a=0,l-=s;else{const t=rx(e,r,a,l,n);a+=t.offsetX,o.push(t.path)}}return o}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,this.data);for(let i=0,r=n.length;i<r;i++)t.push(...n[i].toShapes());return t}}function rx(e,t,n,i,r){const s=r.glyphs[e]||r.glyphs["?"];if(!s)return void console.error('THREE.Font: character "'+e+'" does not exists in font family '+r.familyName+".");const o=new LI;let a,l,c,g,u,A,d,h;if(s.o){const e=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let r=0,s=e.length;r<s;){switch(e[r++]){case"m":a=e[r++]*t+n,l=e[r++]*t+i,o.moveTo(a,l);break;case"l":a=e[r++]*t+n,l=e[r++]*t+i,o.lineTo(a,l);break;case"q":c=e[r++]*t+n,g=e[r++]*t+i,u=e[r++]*t+n,A=e[r++]*t+i,o.quadraticCurveTo(u,A,c,g);break;case"b":c=e[r++]*t+n,g=e[r++]*t+i,u=e[r++]*t+n,A=e[r++]*t+i,d=e[r++]*t+n,h=e[r++]*t+i,o.bezierCurveTo(u,A,d,h,c,g)}}}return{offsetX:s.ha*t,path:o}}class sx extends TA{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t.font;if(void 0===n)super();else{const i=n.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),super(i,t)}this.type="TextGeometry"}}function ox(e){(e instanceof _c||e instanceof Qo)&&e.traverse((e=>{if(e.geometry&&e.geometry.dispose(),e.material)if(Array.isArray(e.material))for(let t of e.material)ax(t);else ax(e.material)}))}function ax(e){e.map&&e.map.dispose(),e.lightMap&&e.lightMap.dispose(),e.aoMap&&e.aoMap.dispose(),e.emissiveMap&&e.emissiveMap.dispose(),e.bumpMap&&e.bumpMap.dispose(),e.normalMap&&e.normalMap.dispose(),e.displacementMap&&e.displacementMap.dispose(),e.roughnessMap&&e.roughnessMap.dispose(),e.metalnessMap&&e.metalnessMap.dispose(),e.alphaMap&&e.alphaMap.dispose(),e.envMap&&e.envMap.dispose(),e.dispose()}const lx=class{constructor(){this.mesh=null,this.videoTexture=null,this.isInitialized=!1}async initialize(e,t,n,i){if(this.isInitialized)return;this.isInitialized=!0;const r=new nx,s=await r.loadAsync("helvetiker_bold.typeface.json");let o=new sx(e,{font:s,size:t,depth:5,curveSegments:3,bevelThickness:2,bevelSize:1,bevelEnabled:!0});o.center();o=new tx(8,6).modify(o);const a=o.attributes.position.count/3,l=new Float32Array(3*a*3),c=new Float32Array(3*a*3),g=new Ps;for(let d=0;d<a;d++){const e=9*d;g.setHex(3342387);const t=10*(.5-Math.random());for(let n=0;n<3;n++)l[e+3*n]=g.r,l[e+3*n+1]=g.g,l[e+3*n+2]=g.b,c[e+3*n]=t,c[e+3*n+1]=t,c[e+3*n+2]=t}o.setAttribute("customColor",new ro(l,3)),o.setAttribute("displacement",new ro(c,3)),this.videoTexture=new Bu(n);const u={amplitude:{value:0},iTime:{value:0},videoTexture:{value:this.videoTexture}},A=new _o({uniforms:u,vertexShader:"\n\n    uniform float amplitude;\n\n    attribute vec3 customColor;\n    attribute vec3 displacement;\n\n    varying vec3 vNormal;\n    varying vec3 vColor;\n\n    varying vec2 vUv;\n\n    void main() {\n        vUv = uv;\n        vNormal = normal;\n        vColor = customColor;\n        vec3 newPosition = position + normal * amplitude * displacement;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );\n    }\n",fragmentShader:"\n\n    uniform float iTime;\n    uniform sampler2D videoTexture;\n\n    varying vec3 vNormal;\n    varying vec3 vColor;\n\n    varying vec2 vUv;\n\n    void main() {\n        const float ambient = 0.5;\n        vec3 light = vec3( 1.0 );\n        light = normalize( light );\n        float directional = max( dot( vNormal, light ), 0.0 );\n\n        //vec3 colorFinal = vec3(sin(iTime*vNormal.z * 0.5 ),sin(iTime*vColor.g * 0.5 ),sin(iTime*vColor.z * 0.5 ));\n\n        vec3 videoColor = texture2D(videoTexture, vUv).rgb;\n        //vec3 colorFinal = mix(vColor, videoColor, 0.5) * vec3(sin(iTime * vNormal.z * 0.5), sin(iTime * vColor.g * 0.5), sin(iTime * vColor.z * 0.5));\n\n        gl_FragColor = vec4( ( directional + ambient ) * videoColor, 1.0 );\n        //gl_FragColor = vec4( ( directional + ambient ) * colorFinal, 1.0 );\n    }\n"});this.mesh=new Qo(o,A),i.add(this.mesh),this.scene=i}update(e){this.mesh&&this.mesh.material&&this.mesh.material.uniforms.amplitude&&(this.mesh.material.uniforms.amplitude.value=1+Math.sin(.5*e.getElapsedTime()),this.mesh.material.uniforms.iTime.value=e.getElapsedTime())}dispose(){this.scene.remove(this.mesh),ox(this.mesh)}};function cx(e){let{text:n="Text Default",size:i=40,...r}=e;const[s]=(0,t.useState)((()=>new lx)),o=KI(),{scene:a}=_p();return(0,t.useEffect)((()=>{if(n&&i&&s&&o&&a)return s.initialize(n,i,o,a),()=>{s.dispose()}}),[n,i,s,o,a]),Op((e=>{s.update(e.clock)})),null}class gx extends vo{constructor(e,t){super();const n=[],i=[],r=[],s=[1,1,1],o=[1,1,0],a=new Sr(0,1,0),l=new Sr,c=new Sr,g=new xr,u=new xr;u.setFromAxisAngle(a,Math.PI/2);const A=new Sr,d=new Sr;d.copy(e.getPointAt(0));const h=[new Sr(-.225,0,0),new Sr(0,-.05,0),new Sr(0,-.175,0),new Sr(0,-.05,0),new Sr(.225,0,0),new Sr(0,-.175,0)],I=2*Math.PI;let p=5;const C=[];for(let F=0;F<p;F++){const e=F/p*I;C.push(new Sr(.06*Math.sin(e),.06*Math.cos(e),0))}p=6;const m=[];for(let F=0;F<p;F++){const e=F/p*I;m.push(new Sr(.025*Math.sin(e),.025*Math.cos(e),0))}const f=new Sr,y=new Sr;function b(e,t){y.set(0,0,-1).applyQuaternion(g);for(let s=0;s<e.length;s++)f.copy(e[s]),f.applyQuaternion(g),f.add(A),n.push(f.x,f.y,f.z),i.push(y.x,y.y,y.z),r.push(t[0],t[1],t[2]);y.set(0,0,1).applyQuaternion(g);for(let s=e.length-1;s>=0;s--)f.copy(e[s]),f.applyQuaternion(g),f.add(A),n.push(f.x,f.y,f.z),i.push(y.x,y.y,y.z),r.push(t[0],t[1],t[2])}const B=new Sr,v=new Sr,w=new Sr,G=new Sr,E=new Sr,x=new Sr,S=new Sr,R=new Sr;function Z(e,t,s){for(let o=0,a=e.length;o<a;o++){const l=e[o],c=e[(o+1)%a];B.copy(l).add(t),B.applyQuaternion(g),B.add(A),v.copy(c).add(t),v.applyQuaternion(g),v.add(A),w.copy(c).add(t),w.applyQuaternion(u),w.add(d),G.copy(l).add(t),G.applyQuaternion(u),G.add(d),n.push(B.x,B.y,B.z),n.push(v.x,v.y,v.z),n.push(G.x,G.y,G.z),n.push(v.x,v.y,v.z),n.push(w.x,w.y,w.z),n.push(G.x,G.y,G.z),E.copy(l),E.applyQuaternion(g),E.normalize(),x.copy(c),x.applyQuaternion(g),x.normalize(),S.copy(c),S.applyQuaternion(u),S.normalize(),R.copy(l),R.applyQuaternion(u),R.normalize(),i.push(E.x,E.y,E.z),i.push(x.x,x.y,x.z),i.push(R.x,R.y,R.z),i.push(x.x,x.y,x.z),i.push(S.x,S.y,S.z),i.push(R.x,R.y,R.z),r.push(s[0],s[1],s[2]),r.push(s[0],s[1],s[2]),r.push(s[0],s[1],s[2]),r.push(s[0],s[1],s[2]),r.push(s[0],s[1],s[2]),r.push(s[0],s[1],s[2])}}const D=new Sr;for(let F=1;F<=t;F++){A.copy(e.getPointAt(F/t)),a.set(0,1,0),l.subVectors(A,d).normalize(),c.crossVectors(a,l).normalize(),a.crossVectors(l,c);const n=Math.atan2(l.x,l.z);g.setFromAxisAngle(a,n),F%2===0&&b(h,o),Z(C,D.set(0,-.125,0),o),Z(m,D.set(.2,0,0),s),Z(m,D.set(-.2,0,0),s),d.copy(A),u.copy(g)}this.setAttribute("position",new ro(new Float32Array(n),3)),this.setAttribute("normal",new ro(new Float32Array(i),3)),this.setAttribute("color",new ro(new Float32Array(r),3))}}class ux extends vo{constructor(e,t){super();const n=[],i=[],r=new xr,s=new Sr(0,1,0),o=new Sr,a=new Sr,l=[new Sr(0,.05,-.05),new Sr(0,.05,.05),new Sr(0,-.05,0)],c=[new Sr(-.05,0,.05),new Sr(-.05,0,-.05),new Sr(.05,0,0)],g=[new Sr(.05,0,-.05),new Sr(.05,0,.05),new Sr(-.05,0,0)],u=new Sr,A=new Sr,d=new Sr,h=new Sr,I=new Sr,p=new Sr,C=new Sr,m=new Sr;function f(e,t,s){for(let o=0,a=e.length;o<a;o++){const l=e[o],c=e[(o+1)%a];u.copy(l),u.applyQuaternion(r),u.add(t),A.copy(c),A.applyQuaternion(r),A.add(t),d.copy(c),d.applyQuaternion(r),d.add(s),h.copy(l),h.applyQuaternion(r),h.add(s),n.push(u.x,u.y,u.z),n.push(A.x,A.y,A.z),n.push(h.x,h.y,h.z),n.push(A.x,A.y,A.z),n.push(d.x,d.y,d.z),n.push(h.x,h.y,h.z),I.copy(l),I.applyQuaternion(r),I.normalize(),p.copy(c),p.applyQuaternion(r),p.normalize(),C.copy(c),C.applyQuaternion(r),C.normalize(),m.copy(l),m.applyQuaternion(r),m.normalize(),i.push(I.x,I.y,I.z),i.push(p.x,p.y,p.z),i.push(m.x,m.y,m.z),i.push(p.x,p.y,p.z),i.push(C.x,C.y,C.z),i.push(m.x,m.y,m.z)}}const y=new Sr,b=new Sr;for(let B=1;B<=t;B++){o.copy(e.getPointAt(B/t)),a.copy(e.getTangentAt(B/t));const n=Math.atan2(a.x,a.z);r.setFromAxisAngle(s,n),o.y>10?(y.set(-.75,-.35,0),y.applyQuaternion(r),y.add(o),b.set(.75,-.35,0),b.applyQuaternion(r),b.add(o),f(l,y,b),y.set(-.7,-.3,0),y.applyQuaternion(r),y.add(o),b.set(-.7,-o.y,0),b.applyQuaternion(r),b.add(o),f(c,y,b),y.set(.7,-.3,0),y.applyQuaternion(r),y.add(o),b.set(.7,-o.y,0),b.applyQuaternion(r),b.add(o),f(g,y,b)):(y.set(0,-.2,0),y.applyQuaternion(r),y.add(o),b.set(0,-o.y,0),b.applyQuaternion(r),b.add(o),f(g,y,b))}this.setAttribute("position",new ro(new Float32Array(n),3)),this.setAttribute("normal",new ro(new Float32Array(i),3))}}class Ax extends vo{constructor(e,t){super();const n=[],i=new Sr(0,1,0),r=new Sr,s=new xr,o=new xr;o.setFromAxisAngle(i,Math.PI/2);const a=new Sr,l=new Sr;l.copy(e.getPointAt(0)),l.y=0;const c=new Sr,g=new Sr,u=new Sr,A=new Sr;for(let d=1;d<=t;d++){a.copy(e.getPointAt(d/t)),a.y=0,r.subVectors(a,l);const h=Math.atan2(r.x,r.z);s.setFromAxisAngle(i,h),c.set(-.3,0,0),c.applyQuaternion(s),c.add(a),g.set(.3,0,0),g.applyQuaternion(s),g.add(a),u.set(.3,0,0),u.applyQuaternion(o),u.add(l),A.set(-.3,0,0),A.applyQuaternion(o),A.add(l),n.push(c.x,c.y,c.z),n.push(g.x,g.y,g.z),n.push(A.x,A.y,A.z),n.push(g.x,g.y,g.z),n.push(u.x,u.y,u.z),n.push(A.x,A.y,A.z),l.copy(a),o.copy(s)}this.setAttribute("position",new ro(new Float32Array(n),3))}}class dx{constructor(e){let t,n,i,{scene:r,camera:s,videoTexture:o,isWireframe:a=!1,isColor:l=!1,urlSound:c="videos/jaguar.mp4",volume:g=0,circuit:u=0,isVisibleTube:A=!1}=e;this.meshesRollercoaster=[];const d=new Rs;d.name="train",r.add(d),this.train=d;const h=2*Math.PI,I=function(){const e=new Sr,t=new Sr;return{getPointAt:function(t){let n,i,r;return t*=h,0===u&&(n=Math.sin(3*t)*Math.cos(4*t)*50,i=2*Math.sin(10*t)+2*Math.cos(17*t)+5,r=Math.sin(t)*Math.sin(4*t)*50),1===u&&(n=Math.sin(6*t)*Math.cos(3*t)*70,i=30*Math.sin(10*t)+10*Math.cos(15*t)+20,r=Math.sin(8*t)*Math.cos(4*t)*60),e.set(n,i,r).multiplyScalar(5)},getTangentAt:function(e){const n=1e-4,i=Math.max(0,e-n),r=Math.min(1,e+n);return t.copy(this.getPointAt(r)).sub(this.getPointAt(i)).normalize()}}}();t=new gx(I,1500),n=new td({vertexColors:l,wireframe:a,map:o}),i=new Qo(t,n),r.add(i),this.meshesRollercoaster.push(i),t=new ux(I,100),n=new td({wireframe:a,map:o}),i=new Qo(t,n),i.position.y=.1,r.add(i),this.meshesRollercoaster.push(i),t=new Ax(I,500),n=new Js({color:l?3166208:null,depthWrite:!1,transparent:!0,wireframe:a,map:o}),i=new Qo(t,n),i.position.y=.1,r.add(i),this.meshesRollercoaster.push(i);class p extends Su{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;super(),this.scale=e}getPoint(e){const t=new Sr;let n,i,r;return e*=h,0===u&&(n=Math.sin(3*e)*Math.cos(4*e)*50,i=2*Math.sin(10*e)+2*Math.cos(17*e)+5,r=Math.sin(e)*Math.sin(4*e)*50),1===u&&(n=Math.sin(6*e)*Math.cos(3*e)*70,i=30*Math.sin(10*e)+10*Math.cos(15*e)+20,r=Math.sin(8*e)*Math.cos(4*e)*60),t.set(n,i,r).multiplyScalar(5)}}if(A){const e=new p(100);t=new UA(e,500,10,500,!1),n=new Js({wireframe:!0,map:o,side:le}),i=new Qo(t,n),r.add(i),this.meshesRollercoaster.push(i)}const C=[];t=new $u(10,10,5,15),n=new rd({color:l?16744576:null,wireframe:a,map:o}),i=new Qo(t,n),i.position.set(-80,10,-70),i.rotation.x=Math.PI/2,r.add(i),C.push(i),t=new $u(5,6,4,10),n=new rd({color:l?8421631:null,wireframe:a,map:o}),i=new Qo(t,n),i.position.set(50,2,30),r.add(i),C.push(i),t=new Xo(10,10,10),n=new rd({color:l?8421631:null,wireframe:a,map:o,side:le}),i=new Qo(t,n),i.position.set(0,2,50),r.add(i),C.push(i);for(let B=0;B<C.length;B++)C[B].scale.set(2,2,2);this.funfairs=C;const m=new Sr,f=new Sr,y=new Sr;let b=performance.now();this.prevTime=b,this.funfairs=C,this.progress=0,this.position=m,this.curve=I,this.train=d,this.tangent=f,this.velocity=0,this.lookAt=y,this.camera=s,this.urlSound=c,this.volume=g,this.scene=r,this.initSound()}initSound(){const e=new xh;this.camera.add(e);const t=new Sh(e),n=this.volume;(new ph).load(this.urlSound,(function(e){t.setBuffer(e),t.setLoop(!0),t.setVolume(n),t.play()})),this.audio=t}update(){var e;const t=performance.now(),n=t-this.prevTime;for(let i=0;i<this.funfairs.length;i++)this.funfairs[i].rotation.y=4e-4*t;this.progress+=this.velocity,this.progress=this.progress%1,this.position.copy(this.curve.getPointAt(this.progress)),this.position.y+=.3,this.train.position.copy(this.position),this.tangent.copy(this.curve.getTangentAt(this.progress)),this.velocity-=1e-7*this.tangent.y*n,this.velocity=Math.max(4e-5,Math.min(2e-4,this.velocity)),this.train.lookAt(this.lookAt.copy(this.position).sub(this.tangent)),this.prevTime=t,null!==(e=this.audio)&&void 0!==e&&e.isPlaying&&this.audio.setPlaybackRate(1e4*this.velocity)}dispose(){this.meshesRollercoaster.forEach((e=>{this.scene.remove(e),ox(e)})),this.funfairs.forEach((e=>{this.scene.remove(e),ox(e)}))}}function hx(){const{scene:e,camera:n}=_p(),i=wE(),[r,s]=(0,t.useState)(),o=(0,t.useRef)();return(0,t.useEffect)((()=>{if(i){const t=new dx({scene:e,camera:n,videoTexture:i});s(t),o.current=t}return()=>{o.current&&o.current.dispose()}}),[i]),Op((()=>{r&&r.update()})),null}const Ix=d((e=>({showVideoPoints:!0,showTextTessellation:!0,showRollercoaster:!0,setShowVideoPoints:t=>e({showVideoPoints:t}),setShowTextTessellation:t=>e({showTextTessellation:t}),setShowRollercoaster:t=>e({showRollercoaster:t})}))),px=(()=>parseInt(O.replace(/\D+/g,"")))();class Cx extends _o{constructor(){super({uniforms:{time:{value:0},fade:{value:1}},vertexShader:"\n      uniform float time;\n      attribute float size;\n      varying vec3 vColor;\n      void main() {\n        vColor = color;\n        vec4 mvPosition = modelViewMatrix * vec4(position, 0.5);\n        gl_PointSize = size * (30.0 / -mvPosition.z) * (3.0 + sin(time + 100.0));\n        gl_Position = projectionMatrix * mvPosition;\n      }",fragmentShader:"\n      uniform sampler2D pointTexture;\n      uniform float fade;\n      varying vec3 vColor;\n      void main() {\n        float opacity = 1.0;\n        if (fade == 1.0) {\n          float d = distance(gl_PointCoord, vec2(0.5, 0.5));\n          opacity = 1.0 / (1.0 + exp(16.0 * (d - 0.25)));\n        }\n        gl_FragColor = vec4(vColor, opacity);\n\n        #include <tonemapping_fragment>\n\t      #include <".concat(px>=154?"colorspace_fragment":"encodings_fragment",">\n      }")})}}const mx=e=>(new Sr).setFromSpherical(new tI(e,Math.acos(1-2*Math.random()),2*Math.random()*Math.PI)),fx=t.forwardRef(((e,n)=>{let{radius:i=100,depth:r=50,count:s=5e3,saturation:o=0,factor:a=4,fade:l=!1,speed:c=1}=e;const g=t.useRef(),[u,A,d]=t.useMemo((()=>{const e=[],t=[],n=Array.from({length:s},(()=>(.5+.5*Math.random())*a)),l=new Ps;let c=i+r;const g=r/s;for(let i=0;i<s;i++)c-=g*Math.random(),e.push(...mx(c).toArray()),l.setHSL(i/s,o,.9),t.push(l.r,l.g,l.b);return[new Float32Array(e),new Float32Array(t),new Float32Array(n)]}),[s,r,a,i,o]);Op((e=>g.current&&(g.current.uniforms.time.value=e.clock.getElapsedTime()*c)));const[h]=t.useState((()=>new Cx));return t.createElement("points",{ref:n},t.createElement("bufferGeometry",null,t.createElement("bufferAttribute",{attach:"attributes-position",args:[u,3]}),t.createElement("bufferAttribute",{attach:"attributes-color",args:[A,3]}),t.createElement("bufferAttribute",{attach:"attributes-size",args:[d,1]})),t.createElement("primitive",{ref:g,object:h,attach:"material",blending:Ae,"uniforms-fade-value":l,depthWrite:!1,transparent:!0,vertexColors:!0}))}));function yx(){const e=(0,t.useRef)();return(0,t.useEffect)((()=>{e.current&&(window.stars=e.current,window.stars.isRotating=!0)}),[e.current]),Op((e=>{var t,n;let{clock:i}=e;var r,s;null!==(t=window)&&void 0!==t&&null!==(n=t.orbitControls)&&void 0!==n&&n.autoRotate||null!==(r=window)&&void 0!==r&&null!==(s=r.stars)&&void 0!==s&&s.isRotating&&window.stars.rotation.set(window.stars.rotation.x,.03*i.elapsedTime,window.stars.rotation.z)})),(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(fx,{ref:e,radius:1e3,count:1999,depth:400,factor:55,fade:!0})})}const bx={borderWidth:["borderBottomWidth","borderTopWidth","borderLeftWidth","borderRightWidth"],borderXWidth:["borderLeftWidth","borderRightWidth"],borderYWidth:["borderTopWidth","borderBottomWidth"],inset:["positionTop","positionLeft","positionRight","positionBottom"],padding:["paddingBottom","paddingTop","paddingLeft","paddingRight"],paddingX:["paddingLeft","paddingRight"],paddingY:["paddingTop","paddingBottom"],margin:["marginBottom","marginTop","marginLeft","marginRight"],marginX:["marginLeft","marginRight"],marginY:["marginTop","marginBottom"],gap:["gapRow","gapColumn"]},Bx=Object.assign({},bx,{borderRadius:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"],borderTopRadius:["borderTopLeftRadius","borderTopRightRadius"],borderLeftRadius:["borderTopLeftRadius","borderBottomLeftRadius"],borderRightRadius:["borderTopRightRadius","borderBottomRightRadius"],borderBottomRadius:["borderBottomLeftRadius","borderBottomRightRadius"]},{scrollbarBorderRadius:["scrollbarBorderTopLeftRadius","scrollbarBorderTopRightRadius","scrollbarBorderBottomLeftRadius","scrollbarBorderBottomRightRadius"],scrollbarBorderTopRadius:["scrollbarBorderTopLeftRadius","scrollbarBorderTopRightRadius"],scrollbarBorderLeftRadius:["scrollbarBorderTopLeftRadius","scrollbarBorderBottomLeftRadius"],scrollbarBorderRightRadius:["scrollbarBorderTopRightRadius","scrollbarBorderBottomRightRadius"],scrollbarBorderBottomRadius:["scrollbarBorderBottomLeftRadius","scrollbarBorderBottomRightRadius"],scrollbarBorderWidth:["scrollbarBorderBottomWidth","scrollbarBorderTopWidth","scrollbarBorderLeftWidth","scrollbarBorderRightWidth"],scrollbarBorderXWidth:["scrollbarBorderLeftWidth","scrollbarBorderRightWidth"],scrollbarBorderYWidth:["scrollbarBorderTopWidth","scrollbarBorderBottomWidth"]},{transformScale:["transformScaleX","transformScaleY","transformScaleZ"]},{caretBorderRadius:["caretBorderTopLeftRadius","caretBorderTopRightRadius","caretBorderBottomLeftRadius","caretBorderBottomRightRadius"],caretBorderTopRadius:["caretBorderTopLeftRadius","caretBorderTopRightRadius"],caretBorderLeftRadius:["caretBorderTopLeftRadius","caretBorderBottomLeftRadius"],caretBorderRightRadius:["caretBorderTopRightRadius","caretBorderBottomRightRadius"],caretBorderBottomRadius:["caretBorderBottomLeftRadius","caretBorderBottomRightRadius"],caretBorderWidth:["caretBorderBottomWidth","caretBorderTopWidth","caretBorderLeftWidth","caretBorderRightWidth"],caretBorderXWidth:["caretBorderLeftWidth","caretBorderRightWidth"],caretBorderYWidth:["caretBorderTopWidth","caretBorderBottomWidth"]},{selectionBorderRadius:["selectionBorderTopLeftRadius","selectionBorderTopRightRadius","selectionBorderBottomLeftRadius","selectionBorderBottomRightRadius"],selectionBorderTopRadius:["selectionBorderTopLeftRadius","selectionBorderTopRightRadius"],selectionBorderLeftRadius:["selectionBorderTopLeftRadius","selectionBorderBottomLeftRadius"],selectionBorderRightRadius:["selectionBorderTopRightRadius","selectionBorderBottomRightRadius"],selectionBorderBottomRadius:["selectionBorderBottomLeftRadius","selectionBorderBottomRightRadius"],selectionBorderWidth:["selectionBorderBottomWidth","selectionBorderTopWidth","selectionBorderLeftWidth","selectionBorderRightWidth"],selectionBorderXWidth:["selectionBorderLeftWidth","selectionBorderRightWidth"],selectionBorderYWidth:["selectionBorderTopWidth","selectionBorderBottomWidth"]});var vx=Symbol.for("preact-signals");function wx(){if(Rx>1)Rx--;else{for(var e,t=!1;void 0!==Sx;){var n=Sx;for(Sx=void 0,Zx++;void 0!==n;){var i=n.o;if(n.o=void 0,n.f&=-3,!(8&n.f)&&Wx(n))try{n.c()}catch(n){t||(e=n,t=!0)}n=i}}if(Zx=0,Rx--,t)throw e}}function Gx(e){if(Rx>0)return e();Rx++;try{return e()}finally{wx()}}var Ex=void 0;function xx(e){var t=Ex;Ex=void 0;try{return e()}finally{Ex=t}}var Sx=void 0,Rx=0,Zx=0,Dx=0;function Fx(e){if(void 0!==Ex){var t=e.n;if(void 0===t||t.t!==Ex)return t={i:0,S:e,p:Ex.s,n:void 0,t:Ex,e:void 0,x:void 0,r:t},void 0!==Ex.s&&(Ex.s.n=t),Ex.s=t,e.n=t,32&Ex.f&&e.S(t),t;if(-1===t.i)return t.i=0,void 0!==t.n&&(t.n.p=t.p,void 0!==t.p&&(t.p.n=t.n),t.p=Ex.s,t.n=void 0,Ex.s.n=t,Ex.s=t),t}}function Nx(e){this.v=e,this.i=0,this.n=void 0,this.t=void 0}function Mx(e){return new Nx(e)}function Wx(e){for(var t=e.s;void 0!==t;t=t.n)if(t.S.i!==t.i||!t.S.h()||t.S.i!==t.i)return!0;return!1}function kx(e){for(var t=e.s;void 0!==t;t=t.n){var n=t.S.n;if(void 0!==n&&(t.r=n),t.S.n=t,t.i=-1,void 0===t.n){e.s=t;break}}}function Tx(e){for(var t=e.s,n=void 0;void 0!==t;){var i=t.p;-1===t.i?(t.S.U(t),void 0!==i&&(i.n=t.n),void 0!==t.n&&(t.n.p=i)):n=t,t.S.n=t.r,void 0!==t.r&&(t.r=void 0),t=i}e.s=n}function Vx(e){Nx.call(this,void 0),this.x=e,this.s=void 0,this.g=Dx-1,this.f=4}function Lx(e){return new Vx(e)}function Hx(e){var t=e.u;if(e.u=void 0,"function"==typeof t){Rx++;var n=Ex;Ex=void 0;try{t()}catch(wx){throw e.f&=-2,e.f|=8,Qx(e),wx}finally{Ex=n,wx()}}}function Qx(e){for(var t=e.s;void 0!==t;t=t.n)t.S.U(t);e.x=void 0,e.s=void 0,Hx(e)}function Kx(e){if(Ex!==this)throw new Error("Out-of-order effect");Tx(this),Ex=e,this.f&=-2,8&this.f&&Qx(this),wx()}function Xx(e){this.x=e,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}function Yx(e){var t=new Xx(e);try{t.c()}catch(e){throw t.d(),e}return t.d.bind(t)}Nx.prototype.brand=vx,Nx.prototype.h=function(){return!0},Nx.prototype.S=function(e){this.t!==e&&void 0===e.e&&(e.x=this.t,void 0!==this.t&&(this.t.e=e),this.t=e)},Nx.prototype.U=function(e){if(void 0!==this.t){var t=e.e,n=e.x;void 0!==t&&(t.x=n,e.e=void 0),void 0!==n&&(n.e=t,e.x=void 0),e===this.t&&(this.t=n)}},Nx.prototype.subscribe=function(e){var t=this;return Yx((function(){var n=t.value,i=Ex;Ex=void 0;try{e(n)}finally{Ex=i}}))},Nx.prototype.valueOf=function(){return this.value},Nx.prototype.toString=function(){return this.value+""},Nx.prototype.toJSON=function(){return this.value},Nx.prototype.peek=function(){var e=Ex;Ex=void 0;try{return this.value}finally{Ex=e}},Object.defineProperty(Nx.prototype,"value",{get:function(){var e=Fx(this);return void 0!==e&&(e.i=this.i),this.v},set:function(e){if(e!==this.v){if(Zx>100)throw new Error("Cycle detected");this.v=e,this.i++,Dx++,Rx++;try{for(var t=this.t;void 0!==t;t=t.x)t.t.N()}finally{wx()}}}}),(Vx.prototype=new Nx).h=function(){if(this.f&=-3,1&this.f)return!1;if(32==(36&this.f))return!0;if(this.f&=-5,this.g===Dx)return!0;if(this.g=Dx,this.f|=1,this.i>0&&!Wx(this))return this.f&=-2,!0;var e=Ex;try{kx(this),Ex=this;var t=this.x();(16&this.f||this.v!==t||0===this.i)&&(this.v=t,this.f&=-17,this.i++)}catch(e){this.v=e,this.f|=16,this.i++}return Ex=e,Tx(this),this.f&=-2,!0},Vx.prototype.S=function(e){if(void 0===this.t){this.f|=36;for(var t=this.s;void 0!==t;t=t.n)t.S.S(t)}Nx.prototype.S.call(this,e)},Vx.prototype.U=function(e){if(void 0!==this.t&&(Nx.prototype.U.call(this,e),void 0===this.t)){this.f&=-33;for(var t=this.s;void 0!==t;t=t.n)t.S.U(t)}},Vx.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var e=this.t;void 0!==e;e=e.x)e.t.N()}},Object.defineProperty(Vx.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var e=Fx(this);if(this.h(),void 0!==e&&(e.i=this.i),16&this.f)throw this.v;return this.v}}),Xx.prototype.c=function(){var e=this.S();try{if(8&this.f)return;if(void 0===this.x)return;var t=this.x();"function"==typeof t&&(this.u=t)}finally{e()}},Xx.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,Hx(this),kx(this),Rx++;var e=Ex;return Ex=this,Kx.bind(this,e)},Xx.prototype.N=function(){2&this.f||(this.f|=2,this.o=Sx,Sx=this)},Xx.prototype.d=function(){this.f|=8,1&this.f||Qx(this)};const zx=/(-?\d+(?:\.\d+)?)%/;function Px(e){const t=e.length;for(let n=0;n<t;n++)e[n]();e.length=0}function Ux(e,t){const n=e.length;for(let i=0;i<n;i++){const n=e[i](t);Array.isArray(n)||t.push(n)}}const _x={left:.5,center:0,middle:0,right:-.5},Ox={top:-.5,center:0,middle:0,bottom:.5},Jx={back:-.5,center:0,middle:0,front:.5};function jx(e,t,n,i,r,s,o){if(null==n.value||null==i.value||null==r.value)return;const[a,l]=n.value,[c,g,u,A]=i.value,[d,h,I,p]=r.value,C=c+d,m=g+h,f=u+I,y=A+p;e.set(.5*(y-m)*s,.5*(f-C)*s,0);const b=a-y-m,B=l-C-f;b/B>o?t.setScalar(B*s):t.setScalar(b*s/o)}function qx(e){return e instanceof Nx?e.value:e}function $x(e){const t=new Map;return(n,i)=>{if("object"!=typeof n)throw new Error('Invalid properties "'.concat(n,'"'));for(const r in n){const s=n[r];if(void 0===s)return;let o=t.get(s);null==o&&t.set(s,o=Lx((()=>e()?qx(s):void 0))),i.add(r,o)}}}function eS(e,t){const n=t.map((t=>tS(e,t,0)));return Lx((()=>n.map((e=>e.value))))}function tS(e,t,n){return Lx((()=>e.value.read(t,n)))}function nS(e,t,n,i){return Lx((()=>{var r,s,o,a;return null!==(r=null!==(s=qx(null===(o=e.value)||void 0===o?void 0:o[n]))&&void 0!==s?s:qx(null===(a=t.value)||void 0===a?void 0:a[n]))&&void 0!==r?r:i}))}function iS(e,t,n,i){null!=n&&(rS(n.classes,i),i(n)),null!=t&&(rS(t.classes,i),i(t)),null!=e&&(rS(e.classes,i),i(e))}function rS(e,t){if(null==e)return;if(!Array.isArray(e))return void t(e);const n=e.length;for(let i=0;i<n;i++)t(e[i])}class sS{constructor(e){hC(this,"preTransformers",void 0),hC(this,"propertyMap",new Map),this.preTransformers=e}add(e,t){var n;if(void 0===t)return;const i=null===(n=this.preTransformers)||void 0===n?void 0:n[e];if(null!=i)return void i(t,this);const r=Bx[e];if(null==r)return void this.addToMap(e,t);const s=r.length;for(let o=0;o<s;o++)this.addToMap(r[o],t)}addToMap(e,t){let n=this.propertyMap.get(e);null==n&&this.propertyMap.set(e,n=[]),t instanceof Nx||(n.length=0),n.push(t)}read(e,t){const n=this.propertyMap.get(e);if(null==n)return t;for(let i=n.length-1;i>=0;i--){const e=n[i],t=e instanceof Nx?e.value:e;if(void 0!==t)return t}return t}filterCompare(e,t,n,i,r){for(const s of this.propertyMap.keys()){if(!e(s))continue;if(null==t){n(s);continue}const r=t.propertyMap.get(s);if(null==r){n(s);continue}oS(r,this.propertyMap.get(s))||i(s)}if(null!=t)for(const s of t.propertyMap.keys())e(s)&&(this.propertyMap.has(s)||r(s))}isEqual(e,t){const n=this.propertyMap.get(t),i=e.propertyMap.get(t);return null==n||null==i?n===i:oS(n,i)}addAll(e,t,n,i){iS(e,t,n,(e=>{for(const t in e)this.add(t,e[t]);for(const t in i){const n=e[t];null!=n&&i[t](n,this)}}))}}function oS(e,t){const n=e.length;if(n!=t.length)return!1;for(let i=0;i<n;i++)if(e[i]!=t[i])return!1;return!0}const aS=Symbol("camera-distance-key"),lS=Symbol("order-info-key");function cS(e,t){if(e.groupOrder!==t.groupOrder)return e.groupOrder-t.groupOrder;if(e.renderOrder!==t.renderOrder)return e.renderOrder-t.renderOrder;const n=e.object[aS],i=t.object[aS];return null==n||null==i?e.z!==t.z?t.z-e.z:e.id-t.id:n===i?function(e,t){if(null==e||null==t)return 0;let n=e.majorIndex-t.majorIndex;if(0!=n)return n;if(n=e.elementType-t.elementType,0!=n)return n;return e.minorIndex-t.minorIndex}(e.object[lS].value,t.object[lS].value):i.cameraDistance-n.cameraDistance}const gS={Panel:0,Image:1,Object:2,Custom:3,Svg:4,Text:5};function uS(e,t,n,i){const r=null==e?void 0:tS(e,"zIndexOffset",void 0);return Lx((()=>{var e,s;let o;if(null==i)o=void 0;else{if(null==i.value)return;o=i.value}const a=null===r||void 0===r?void 0:r.value,l="number"===typeof a?a:null!==(e=null===a||void 0===a?void 0:a.major)&&void 0!==e?e:0,c="number"===typeof a?0:null!==(s=null===a||void 0===a?void 0:a.minor)&&void 0!==s?s:0;let g,u;return null==o?(g=0,u=0):t>o.elementType?(g=o.majorIndex,u=0):t==o.elementType&&function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;let n=0;for(const i in e){if(e[i]!=t[i])return!1;++n}return n===Object.keys(t).length}(qx(n),qx(o.instancedGroupDependencies))?(g=o.majorIndex,u=o.minorIndex+1):(g=o.majorIndex+1,u=0),l>0&&(g+=l,u=0),u+=c,{instancedGroupDependencies:n,elementType:t,majorIndex:g,minorIndex:u}}))}function AS(e,t,n){return e[aS]=t,e[lS]=n,e}const dS=new Sr,hS=new Sr,IS=new Sr,pS=new rs,CS=new hs,mS=new xr,fS=Math.PI/180;const yS="center",bS="center";function BS(e,t,n){let{relativeCenter:i,size:r}=t;const s=tS(e,"transformTranslateX",0),o=tS(e,"transformTranslateY",0),a=tS(e,"transformTranslateZ",0),l=tS(e,"transformRotateX",0),c=tS(e,"transformRotateY",0),g=tS(e,"transformRotateZ",0),u=tS(e,"transformScaleX",1),A=tS(e,"transformScaleY",1),d=tS(e,"transformScaleZ",1),h=tS(e,"transformOriginX",yS),I=tS(e,"transformOriginY",bS);return Lx((()=>{if(null==i.value)return;const[e,t]=i.value,p=n.value,C=(new rs).makeTranslation(e*p,t*p,0);let m=!0;if("center"!=h.value||"center"!=I.value){if(null==r.value)return;const[e,t]=r.value;m=!1,IS.set(-_x[h.value]*e*p,-Ox[I.value]*t*p,0),C.multiply(pS.makeTranslation(IS)),IS.negate()}const f=[l.value,c.value,g.value],y=[wS(s.value,r,0),-wS(o.value,r,1),a.value],b=[vS(u.value),vS(A.value),vS(d.value)];return(y.some((e=>0!=e))||f.some((e=>0!=e))||b.some((e=>1!=e)))&&C.multiply(pS.compose(dS.fromArray(y).multiplyScalar(p),function(e){let[t,n,i]=e;return mS.setFromEuler(CS.set(t*fS,n*fS,i*fS))}(f),hS.fromArray(b))),m||C.multiply(pS.makeTranslation(IS)),C}))}function vS(e){if("number"===typeof e)return e;const t=zx.exec(e);if(null==t)throw new Error('invalid value "'.concat(e,'", expected number of percentage'));return parseFloat(t[1])/100}function wS(e,t,n){var i,r;if("number"===typeof e)return e;const s=zx.exec(e);if(null==s)throw new Error('invalid value "'.concat(e,'", expected number of percentage'));return(null!==(i=null===(r=t.value)||void 0===r?void 0:r[n])&&void 0!==i?i:0)*parseFloat(s[1])/100}function GS(e,t,n,i){i.push((()=>Yx((()=>{var i,r;null!=n.value?(null===(i=t.current)||void 0===i||i.matrix.copy(n.value),e.requestRender()):null===(r=t.current)||void 0===r||r.matrix.elements.fill(0)}))))}var ES=(()=>{var e="file:///Users/joseangel/Proyectos/Web/games/ultimate-react-three-espinaco/node_modules/yoga-layout/dist/binaries/yoga-wasm-base64-esm.js";return function(t){var n,i,r;t=t||{},n||(n="undefined"!==typeof t?t:{}),n.ready=new Promise((function(e,t){i=e,r=t}));var s=Object.assign({},n),o="";"undefined"!=typeof document&&document.currentScript&&(o=document.currentScript.src),e&&(o=e),o=0!==o.indexOf("blob:")?o.substr(0,o.replace(/[?#].*/,"").lastIndexOf("/")+1):"";var a,l=n.print||console.log.bind(console),c=n.printErr||console.warn.bind(console);Object.assign(n,s),s=null,n.wasmBinary&&(a=n.wasmBinary);n.noExitRuntime;"object"!=typeof WebAssembly&&F("no native wasm support detected");var g,u,A,d,h,I,p,C,m,f,y=!1;function b(e,t,n){n=t+n;for(var i="";!(t>=n);){var r=e[t++];if(!r)break;if(128&r){var s=63&e[t++];if(192==(224&r))i+=String.fromCharCode((31&r)<<6|s);else{var o=63&e[t++];65536>(r=224==(240&r)?(15&r)<<12|s<<6|o:(7&r)<<18|s<<12|o<<6|63&e[t++])?i+=String.fromCharCode(r):(r-=65536,i+=String.fromCharCode(55296|r>>10,56320|1023&r))}}else i+=String.fromCharCode(r)}return i}function B(){var e=g.buffer;u=e,n.HEAP8=A=new Int8Array(e),n.HEAP16=h=new Int16Array(e),n.HEAP32=p=new Int32Array(e),n.HEAPU8=d=new Uint8Array(e),n.HEAPU16=I=new Uint16Array(e),n.HEAPU32=C=new Uint32Array(e),n.HEAPF32=m=new Float32Array(e),n.HEAPF64=f=new Float64Array(e)}var v,w=[],G=[],E=[];function x(){var e=n.preRun.shift();w.unshift(e)}var S,R=0,Z=null,D=null;function F(e){throw n.onAbort&&n.onAbort(e),c(e="Aborted("+e+")"),y=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),r(e),e}function N(e){return e.startsWith("data:application/octet-stream;base64,")}if(!N(S="data:application/octet-stream;base64,AGFzbQEAAAABqwM2YAF/AGABfwF/YAJ/fwBgA39/fwBgAn98AGACf38Bf2ADf39/AX9gBH9/f30BfWADf398AGAAAGAEf39/fwBgAX8BfGACf38BfGAFf39/f38Bf2AAAX9gA39/fwF9YAZ/f31/fX8AYAV/f39/fwBgAn9/AX1gAX8BfWADf35/AX5gB39/f39/f38AYAZ/f39/f38AYAR/f39/AX9gBH9/fX8AYAN/f30BfWAGf3x/f39/AX9gAn99AGAEf3x8fwBgCH9/f39/f39/AGANf39/f39/f39/f39/fwBgCn9/f39/f39/f38AYAV/f39/fwF8YAR/f319AX1gBHx8f38BfWANf319f39/fX1/f39/fwF/YAZ/f319f38AYAJ+fwF/YAN/fX0BfWABfAF8YAN/fHwAYAR/f319AGAFf399fX0BfWANf31/fX99f319fX19fwF/YAt/f39/f39/fX19fQBgCH9/f39/f319AGAEf39+fgBgB39/f39/f38Bf2ACfH8BfGAFf398fH8AYAN/f38BfGAEf39/fABgA39/fQBgBn9/fX99fwF/ArUBHgFhAWEAHQFhAWIAAwFhAWMACQFhAWQAFQFhAWUAEQFhAWYAHgFhAWcAAAFhAWgAHwFhAWkAAwFhAWoAAAFhAWsAFgFhAWwACgFhAW0ABQFhAW4AAwFhAW8AAgFhAXAAFgFhAXEABgFhAXIAAAFhAXMAIAFhAXQACgFhAXUADQFhAXYAFQFhAXcAAQFhAXgAAwFhAXkAFwFhAXoAAQFhAUEAAgFhAUIAEQFhAUMAAgFhAUQAAAOTApECAQMSDw8HBwcHCQADChEGIQoKBgYiBxgPAxMjBSQTBwcDJQIGFwMDCgoYGRMKDwoDAwEJAQAABRkBAQYHAQMCAggMAAAnCQAFAAcFBREAKCkAAAEqBwArASwHBy0DLgkDBQoBLw0wAQkDAQABAgYKAgECBQIAAQkFAgIBDgEBBQICGwMODQ0GFAECGhQGAQkBEAAAAAUxDzIMBQYIMwUBAwUODg40AQMBAQEDBgEBNQECDAwMAgsLCwsLCxwBAAEAAAACABACBQEBAgMBEgMMCwICAgICAgsLAgEBAwEBAQEBAQEDAQgIAggICAQEBAQEBAQEBAAEBAAEBAQEAAQEBAICAggIAgICAgICAggIAgIABAcBcAHRAdEBBQcBAYACgIACBg0CfwFB4MMEC38BQQALByQIAUUCAAFGAGMBRwCtAQFIAKwBAUkAVgFKAQABSwAoAUwAowEJgQMBAEEBC9ABqAGnAaIB4gHfAZQBzQFSzAHLAVFRUpIBkQGQAcoByQHIAccBUo8BxgFRUVKSAZEBkAHFAcQBwwFmjgGhAY0BZqABjAGfAcIBngE2nQE2nAGLAZsBOZoBOcEBYMABYL8BYF9evgG9AbwBZI4BmQG7AZgBjQFkrgKPAa0CNqwCNqsCugGqAqkCqAKnAqYCpAKjAqICoQKgAp8CngKdArkBnAKbApoCmQKYApcClgKVApQCkwKSApECkAKPAo4CjQKMAosCigKJAogChwKGAoQCgwKlAoICOYECuAGAAv8B/gH9AfsB+gH5AfYBtwH1AbYB9AHzAfIB8QHwAe8B7gHtAewBtQH4AfcB6wHqAbQB6AGMAecBNuYBOeUBOeQBiwHOATbpATmFAuMBNuEB4AE23gHdAdwBOdsB2gHZAbMB2AHXAdYB1QHUAdMB0gGyAdEB0AHPAfwBX15fXoUBhwGvAa4BiAF8iQGxAbABiAGrAaoBqQGmAaUBpAF8CreNBJECMwEBfyAAQQEgABshAAJAA0AgABBWIgENAUHYwwAoAgAiAQRAIAERCQAMAQsLEAIACyABC+0BAgJ9A39DAADAfyEEAkACQAJAAkAgAkEHcSIGDgUCAQEBAAELQQMhBQwBCyAGQQFrQQJPDQEgAkHw/wNxQQR2IQcCfSACQQhxBEAgASAHEJUBvgwBC0EAIAdB/w9xIgFrIAEgAsFBAEgbsgshAyAGQQFGBEAgAyADXA0BQwAAwH8gAyADQwAAgH9bIANDAACA/1tyIgEbIQQgAUUhBQwBCyADIANcDQBBAEECIANDAACAf1sgA0MAAID/W3IiARshBUMAAMB/IAMgARshBAsgACAFOgAEIAAgBDgCAA8LQfQNQZkYQTpB6RYQCwALZwIBfQF/QwAAwH8hAgJAAkACQCABQQdxDgQCAAABAAtBxBJBmRhByQBBuhIQCwALIAFB8P8DcUEEdiEDIAFBCHEEQCAAIAMQlQG+DwtBACADQf8PcSIAayAAIAHBQQBIG7IhAgsgAguBAQIBfwF9IwBBEGsiAyQAIANBCGogAEEDIAJBAkdBAXQgAUH+AXFBAkcbIAIQTEMAAMB/IQQCQAJAAkAgAy0ADEEBaw4CAAECCyADKgIIIQQMAQsgAyoCCEMAAAAAlEMK1yM8lCEECyADQRBqJAAgBEMAAAAAl0MAAAAAIAQgBFsbC4EBAgF/AX0jAEEQayIDJAAgA0EIaiAAQQEgAkECRkEBdCABQf4BcUECRxsgAhBMQwAAwH8hBAJAAkACQCADLQAMQQFrDgIAAQILIAMqAgghBAwBCyADKgIIQwAAAACUQwrXIzyUIQQLIANBEGokACAEQwAAAACXQwAAAAAgBCAEWxsLeAIBfwF9IwBBEGsiBCQAIARBCGogAEEDIAJBAkdBAXQgAUH+AXFBAkcbIAIQKkMAAMB/IQUCQAJAAkAgBC0ADEEBaw4CAAECCyAEKgIIIQUMAQsgBCoCCCADlEMK1yM8lCEFCyAEQRBqJAAgBUMAAAAAIAUgBVsbC3gCAX8BfSMAQRBrIgQkACAEQQhqIABBASACQQJGQQF0IAFB/gFxQQJHGyACECpDAADAfyEFAkACQAJAIAQtAAxBAWsOAgABAgsgBCoCCCEFDAELIAQqAgggA5RDCtcjPJQhBQsgBEEQaiQAIAVDAAAAACAFIAVbGwt+AgF/AX0jAEEQayIEJAAgBEEIaiAAQQMgAkECR0EBdCABQf4BcUECRxsgAhBKQwAAwH8hBQJAAkACQCAELQAMQQFrDgIAAQILIAQqAgghBQwBCyAEKgIIIAOUQwrXIzyUIQULIARBEGokACAFQwAAAACXQwAAAAAgBSAFWxsLfgIBfwF9IwBBEGsiBCQAIARBCGogAEEBIAJBAkZBAXQgAUH+AXFBAkcbIAIQSkMAAMB/IQUCQAJAAkAgBC0ADEEBaw4CAAECCyAEKgIIIQUMAQsgBCoCCCADlEMK1yM8lCEFCyAEQRBqJAAgBUMAAAAAl0MAAAAAIAUgBVsbCw4AQagyKAIAEQkAEFAAC8wCAQV/IAAEQCAAQQRrIgEoAgAiBSEDIAEhAiAAQQhrKAIAIgAgAEF+cSIERwRAIAEgBGsiAigCBCIAIAIoAgg2AgggAigCCCAANgIEIAQgBWohAwsgASAFaiIEKAIAIgEgASAEakEEaygCAEcEQCAEKAIEIgAgBCgCCDYCCCAEKAIIIAA2AgQgASADaiEDCyACIAM2AgAgA0F8cSACakEEayADQQFyNgIAIAICfyACKAIAQQhrIgFB/wBNBEAgAUEDdkEBawwBCyABQR0gAWciAGt2QQRzIABBAnRrQe4AaiABQf8fTQ0AGkE/IAFBHiAAa3ZBAnMgAEEBdGtBxwBqIgAgAEE/TxsLIgFBBHQiAEGwMmo2AgQgAiAAQbgyaiIAKAIANgIIIAAgAjYCACACKAIIIAI2AgRBuDpBuDopAwBCASABrYaENwMACwu/AQEDfyAALQAAQSBxRQRAAkAgASEDAkAgAiAAIgEoAhAiAAR/IAAFIAEQkwENASABKAIQCyABKAIUIgVrSwRAIAEgAyACIAEoAiQRBgAaDAILAkAgASgCUEEASA0AIAIhAANAIAAiBEUNASADIARBAWsiAGotAABBCkcNAAsgASADIAQgASgCJBEGACAESQ0BIAMgBGohAyACIARrIQIgASgCFCEFCyAFIAMgAhAsGiABIAEoAhQgAmo2AhQLCwsLUAACQAJAAkACQAJAIAIOBAQAAQIDCyAAIAEgAUEMahBEDwsgACABIAFBDGogAxBFDwsgACABIAFBDGoQQw8LECcACyAAIAEgAUEMaiADEEYLbQEBfyMAQYACayIFJAAgBEGAwARxIAIgA0xyRQRAIAUgAUH/AXEgAiADayIDQYACIANBgAJJIgEbEDAaIAFFBEADQCAAIAVBgAIQKSADQYACayIDQf8BSw0ACwsgACAFIAMQKQsgBUGAAmokAAuABAEDfyACQYAETwRAIAAgASACEBcgAA8LIAAgAmohAwJAIAAgAXNBA3FFBEACQCAAQQNxRQRAIAAhAgwBCyACRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAkEDcUUNASACIANJDQALCwJAIANBfHEiBEHAAEkNACACIARBQGoiBUsNAANAIAIgASgCADYCACACIAEoAgQ2AgQgAiABKAIINgIIIAIgASgCDDYCDCACIAEoAhA2AhAgAiABKAIUNgIUIAIgASgCGDYCGCACIAEoAhw2AhwgAiABKAIgNgIgIAIgASgCJDYCJCACIAEoAig2AiggAiABKAIsNgIsIAIgASgCMDYCMCACIAEoAjQ2AjQgAiABKAI4NgI4IAIgASgCPDYCPCABQUBrIQEgAkFAayICIAVNDQALCyACIARPDQEDQCACIAEoAgA2AgAgAUEEaiEBIAJBBGoiAiAESQ0ACwwBCyADQQRJBEAgACECDAELIAAgA0EEayIESwRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAiABLQABOgABIAIgAS0AAjoAAiACIAEtAAM6AAMgAUEEaiEBIAJBBGoiAiAETQ0ACwsgAiADSQRAA0AgAiABLQAAOgAAIAFBAWohASACQQFqIgIgA0cNAAsLIAAL3AICAn8CfSMAQRBrIgQkACAAQfwAaiEFAkACQAJAIAFBAU0EQCAEQQhqIAUgAC8BdBAfQwAAwH8hBkMAAMB/IQcCQAJAAkAgBC0ADEEBaw4CAAECCyAEKgIIIQcMAQsgBCoCCCADlEMK1yM8lCEHCyAEQQhqIAUgAC8BeBAfAkAgBC0ADEEBaw4CAgAECyAEKgIIIAOUQwrXIzyUIQYMAwsgBEEIaiAFIAAvAXIQH0MAAMB/IQZDAADAfyEHAkACQAJAIAQtAAxBAWsOAgABAgsgBCoCCCEHDAELIAQqAgggA5RDCtcjPJQhBwsgBEEIaiAFIAAvAXYQHyAELQAMQQFrDgIAAQILIAQqAgghBgwBCyAEKgIIIAOUQwrXIzyUIQYLAkAgAiAGXiAGQwAAAABgcQ0AIAdDAAAAAGBFBEAgAiEGDAELIAcgAiACIAddGyEGCyAEQRBqJAAgBgtIAQF/IwBBEGsiBCQAIAQgAzYCDAJAIABFBEBBAEEAIAEgAiAEKAIMEGoMAQsgACgC7AMgACABIAIgBCgCDBBqCyAEQRBqJAALUAACQAJAAkACQAJAIAIOBAQAAQIDCyAAIAEgAUEeahBEDwsgACABIAFBHmogAxBFDwsgACABIAFBHmoQQw8LECcACyAAIAEgAUEeaiADEEYL8gICAn8BfgJAIAJFDQAgACABOgAAIAAgAmoiA0EBayABOgAAIAJBA0kNACAAIAE6AAIgACABOgABIANBA2sgAToAACADQQJrIAE6AAAgAkEHSQ0AIAAgAToAAyADQQRrIAE6AAAgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBBGsgATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQQhrIAE2AgAgAkEMayABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkEQayABNgIAIAJBFGsgATYCACACQRhrIAE2AgAgAkEcayABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa1CgYCAgBB+IQUgAyAEaiEBA0AgASAFNwMYIAEgBTcDECABIAU3AwggASAFNwMAIAFBIGohASACQSBrIgJBH0sNAAsLIAAL6AIBAn8CQCAAIAFGDQAgASAAIAJqIgRrQQAgAkEBdGtNBEAgACABIAIQLA8LIAAgAXNBA3EhAwJAAkAgACABSQRAIAMEQCAAIQMMAwsgAEEDcUUEQCAAIQMMAgsgACEDA0AgAkUNBCADIAEtAAA6AAAgAUEBaiEBIAJBAWshAiADQQFqIgNBA3ENAAsMAQsCQCADDQAgBEEDcQRAA0AgAkUNBSAAIAJBAWsiAmoiAyABIAJqLQAAOgAAIANBA3ENAAsLIAJBA00NAANAIAAgAkEEayICaiABIAJqKAIANgIAIAJBA0sNAAsLIAJFDQIDQCAAIAJBAWsiAmogASACai0AADoAACACDQALDAILIAJBA00NAANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIAJBBGsiAkEDSw0ACwsgAkUNAANAIAMgAS0AADoAACADQQFqIQMgAUEBaiEBIAJBAWsiAg0ACwsgAAuUAgIBfAF/AkAgACABoiIAEGIiBEQAAAAAAADwP6AgBCAERAAAAAAAAAAAYxsiBCAEYiIFIASZRC1DHOviNho/Y0VyRQRAIAAgBKEhAAwBCyAFIAREAAAAAAAA8L+gmUQtQxzr4jYaP2NFckUEQCAAIAShRAAAAAAAAPA/oCEADAELIAAgBKEhACACBEAgAEQAAAAAAADwP6AhAAwBCyADDQAgAAJ8RAAAAAAAAAAAIAUNABpEAAAAAAAA8D8gBEQAAAAAAADgP2QNABpEAAAAAAAA8D9EAAAAAAAAAAAgBEQAAAAAAADgv6CZRC1DHOviNho/YxsLoCEACyAAIABiIAEgAWJyBEBDAADAfw8LIAAgAaO2C3ACAX8BfSMAQRBrIgQkACAEQQhqIAAgAUECdEG0JWooAgAgAhAqQwAAwH8hBQJAAkACQCAELQAMQQFrDgIAAQILIAQqAgghBQwBCyAEKgIIIAOUQwrXIzyUIQULIARBEGokACAFQwAAAAAgBSAFWxsLTwACQAJAAkAgA0H/AXEiAw4EAAICAQILIAEgAS8AAEH4/wNxOwAADwsgASABLwAAQfj/A3FBBHI7AAAPCyAAIAEgAkEBQQIgA0EBRhsQRwt5AgF/AX0jAEEQayIDJAAgA0EIaiAAIAFBAnRBtCVqKAIAIAIQTEMAAMB/IQQCQAJAAkAgAy0ADEEBaw4CAAECCyADKgIIIQQMAQsgAyoCCEMAAAAAlEMK1yM8lCEECyADQRBqJAAgBEMAAAAAl0MAAAAAIAQgBFsbCzcBAX8gASAAKAIEIgNBAXVqIQEgACgCACEAIAEgAiADQQFxBH8gASgCACAAaigCAAUgAAsRAgALYgICfQJ/AkAgACgC3ANFDQAgAEH8AGoiAyAAQRpqIgQvAQAQICICIAJcBEAgAyAAQRhqIgQvAQAQICICIAJcDQEgAyAALwEYECBDAAAAAF5FDQELIAMgBC8BABAgIQELIAELi4ABAxt9LX8BfiMAQeAAayIoJAACfwJAIAAtAABBBHEEQCAAKAKgASAMRw0BC0EAIAAtAKQBIANGDQEaCyAAQoCAgPyLgIDAv383AvwCIABCgYCAgBA3AvQCIABCgICA/IuAgMC/fzcC7AIgAEEANgKoAUEBCyFHAkACQAJAAkACQCAAKAIIBEAgAEEUaiIpQQJBASAGECQhDSApQQJBASAGECMhDiApQQBBASAGECQhESApQQBBASAGECMhDyAEIAEgBSACIAAoAvQCIABB7AJqIikqAgAgACgC+AIgACoC8AIgACoC/AIgACoCgAMgDSAOkiINIBEgD5IiDiAAKALsAyIsEHQNASAAKAKoASIuRQ0CIABBrAFqISsDQCAEIAEgBSACICsgL0EYbGoiKSgCCCApKgIAICkoAgwgKSoCBCApKgIQICkqAhQgDSAOICwQdA0CIC9BAWoiLyAuRw0ACwwCCyAIRQRAIAAoAqgBIitFDQIgAEGsAWohLANAAkACQCAsIC9BGGwiLmoiKSoCACINIA1cIAEgAVxyRQRAIA0gAZOLQxe30ThdDQEMAgsgASABWyANIA1bcg0BCwJAICwgLmoiLioCBCINIA1cIAIgAlxyRQRAIA0gApOLQxe30ThdDQEMAgsgAiACWyANIA1bcg0BCyAuKAIIIARHDQAgLigCDCAFRg0DCyArIC9BAWoiL0cNAAsMAgsCQCAAQewCaiIpKgIAIg0gDVwgASABXHJFBEAgDSABk4tDF7fROF0NAQwDCyABIAFbIA0gDVtyDQILIClBACAAKAL4AiAFRhtBACAAKAL0AiAERhtBAAJ/IAIgAlwiKSAAKgLwAiINIA1cckUEQCANIAKTi0MXt9E4XQwBC0EAIA0gDVsNABogKQsbISkLIClFIEdyBEAgKSFEDAELIAAgKSoCEDgCkAMgACApKgIUOAKUAyAKQQxBECAIG2oiAyADKAIAQQFqNgIAICkhRAwBCyAEQQFGIAEgAVtyRQRAIChBqgs2AiAgAEEFQa4lIChBIGoQLgwDCyAFQQFGIAIgAltyRQRAIChB2Qo2AhAgAEEFQa4lIChBEGoQLgwDCyAKQQBBBCAIG2oiKSApKAIAQQFqNgIAIAAgAC0AhANB/AFxIAAtABRBA3EiKSADQQEgAxsiSSApGyIqQQNxcjoAhAMgAEGoA2oiKyAqQQFHQQN0IixqIABBFGoiLUEDQQIgKkECRhsiKSAqIAYQJCINOAIAICsgKkEBRkEDdCIuaiAtICkgKiAGECMiDjgCACAAIC1BACAqIAYQJCIROAKsAyAAIC1BACAqIAYQIyIPOAK0AyAAQbgDaiIrICxqIC0gKSAqECI4AgAgKyAuaiAtICkgKhAhOAIAIAAgLUEAICoQIjgCvAMgACAtQQAgKhAhOALEAyAsIABByANqIitqIC0gKSAqIAYQJjgCACArIC5qIC0gKSAqIAYQJTgCACAAIC1BACAqIAYQJjgCzAMgACAtQQAgKiAGECUiFTgC1AMgDSAOkiEOIBEgD5IhEwJAIAAoAggiKQRAQwAAwH8hEUMAAMB/IAEgDpMgBEEBRhshDUMAAMB/IAIgE5MgBUEBRhshEyAEIAVyRQRAIChByABqIABB/ABqIgkgAC8BchAfAkACQAJAICgtAExBAWsOAgABAgsgKCoCSCERDAELICgqAkggBpRDCtcjPJQhEQsgKEHIAGogCSAALwF2EB8CQAJAAn0CQAJAICgtAExBAWsOAgABAwsgKCoCSAwBCyAoKgJIIAaUQwrXIzyUCyIPQwAAAABgRQ0AIA0gD14NAQsgEUMAAAAAYEUEQCANIQ8MAQsgESANIA0gEV0bIQ8LIAAgLUECICogBhAmIC1BAiAqECKSIC1BAiAqIAYQJSAtQQIgKhAhkpIiDSAPIA0gD14bIA0gDyAPIA9cGyAPIA9bIA0gDVtxGzgCkAMgKEHIAGogCSAALwF0EB9DAADAfyEPAkACQAJAICgtAExBAWsOAgABAgsgKCoCSCEPDAELICgqAkggB5RDCtcjPJQhDwsgKEHIAGogCSAALwF4EB8CQAJAAn0CQAJAICgtAExBAWsOAgABAwsgKCoCSAwBCyAoKgJIIAeUQwrXIzyUCyIOQwAAAABgRQ0AIA4gE10NAQsgD0MAAAAAYEUEQCATIQ4MAQsgDyATIA8gE14bIQ4LIAAgLUEAICogBhAmIC1BACAqECKSIC1BACAqIAYQJSAtQQAgKhAhkpIiBiAOIAYgDl4bIAYgDiAOIA5cGyAOIA5bIAYgBltxGzgClAMMAgsgBEEDTyAFQQNPcg0EIChByABqIAAgDSANIAAqAsgDIAAqAtADkiAAKgK4A5IgACoCwAOSIg6TIhFDAAAAACARQwAAAABeGyANIA1cG0GBgAggBEEDdEH4//8HcXZB/wFxIBMgEyAAKgLMAyAVkiAAKgK8A5IgACoCxAOSIhWTIhFDAAAAACARQwAAAABeGyATIBNcG0GBgAggBUEDdEH4//8HcXZB/wFxICkREAAgKCoCTCIRQwAAAABgICgqAkgiD0MAAAAAYHFFBEAgKCARuzkDCCAoIA+7OQMAIABBAUGyHSAoEC4gKCoCSCIRQwAAAAAgEUMAAAAAXhshDyAoKgJMIhFDAAAAACARQwAAAABeGyERCyAKIAooAhRBAWo2AhQgCiAJQQJ0aiIJIAkoAhhBAWo2AhggKEHIAGogAEH8AGoiCSAALwFyEB8gDiAPkiEOIARBAWtBAkkhC0MAAMB/IQ8CQAJAAkAgKC0ATEEBaw4CAAECCyAoKgJIIQ8MAQsgKCoCSCAGlEMK1yM8lCEPCyAOIA0gCxshDSAoQcgAaiAJIAAvAXYQHwJAAkACfQJAAkAgKC0ATEEBaw4CAAEDCyAoKgJIDAELICgqAkggBpRDCtcjPJQLIg5DAAAAAGBFDQAgDSAOXg0BCyAPQwAAAABgRQRAIA0hDgwBCyAPIA0gDSAPXRshDgsgACAtQQIgKiAGECYgLUECICoQIpIgLUECICogBhAlIC1BAiAqECGSkiINIA4gDSAOXhsgDSAOIA4gDlwbIA4gDlsgDSANW3EbOAKQAyAoQcgAaiAJIAAvAXQQHyAVIBGSIQ0gBUEBa0ECSSELQwAAwH8hDwJAAkACQCAoLQBMQQFrDgIAAQILICgqAkghDwwBCyAoKgJIIAeUQwrXIzyUIQ8LIA0gEyALGyENIChByABqIAkgAC8BeBAfAkACQAJ9AkACQCAoLQBMQQFrDgIAAQMLICgqAkgMAQsgKCoCSCAHlEMK1yM8lAsiDkMAAAAAYEUNACANIA5eDQELIA9DAAAAAGBFBEAgDSEODAELIA8gDSANIA9dGyEOCyAAIC1BACAqIAYQJiAtQQAgKhAikiAtQQAgKiAGECUgLUEAICoQIZKSIgYgDiAGIA5eGyAGIA4gDiAOXBsgDiAOWyAGIAZbcRs4ApQDDAELIAAoAuQDIj4gACgC4AMiP0YEQCAEQQFrQQFLBH0gASAOkwUgACoCyAMgACoC0AOSIAAqArgDkiAAKgLAA5ILIQ0gKEHIAGogAEH8AGoiCSAALwFyEB9DAADAfyEPAkACQAJAICgtAExBAWsOAgABAgsgKCoCSCEPDAELICgqAkggBpRDCtcjPJQhDwsgKEHIAGogCSAALwF2EB8CQAJAAn0CQAJAICgtAExBAWsOAgABAwsgKCoCSAwBCyAoKgJIIAaUQwrXIzyUCyIOQwAAAABgRQ0AIA0gDl4NAQsgD0MAAAAAYEUEQCANIQ4MAQsgDyANIA0gD10bIQ4LIAAgLUECICogBhAmIC1BAiAqECKSIC1BAiAqIAYQJSAtQQIgKhAhkpIiDSAOIA0gDl4bIA0gDiAOIA5cGyAOIA5bIA0gDVtxGzgCkAMgBUEBa0EBSwR9IAIgE5MFIAAqAswDIAAqAtQDkiAAKgK8A5IgACoCxAOSCyERIChByABqIAkgAC8BdBAfQwAAwH8hDQJAAkACQCAoLQBMQQFrDgIAAQILICgqAkghDQwBCyAoKgJIIAeUQwrXIzyUIQ0LIChByABqIAkgAC8BeBAfAkACQAJ9AkACQCAoLQBMQQFrDgIAAQMLICgqAkgMAQsgKCoCSCAHlEMK1yM8lAsiDkMAAAAAYEUNACAOIBFdDQELIA1DAAAAAGBFBEAgESEODAELIA0gESANIBFeGyEOCyAAIC1BACAqIAYQJiAtQQAgKhAikiAtQQAgKiAGECUgLUEAICoQIZKSIgYgDiAGIA5eGyAGIA4gDiAOXBsgDiAOWyAGIAZbcRs4ApQDDAELAkAgCA0AIAVBAkYgAiATkyIPIA9bcSAPQwAAAABfcSAEIAVyRSAEQQJGIAEgDpMiDUMAAAAAX3FyckUNACAoQcgAaiAAQfwAaiIJIAAvAXIQH0MAAAAAIA0gDUMAAAAAXRsgDSAEQQJGGyEOIA0gDVwhC0MAAMB/IQ0CQAJAAkAgKC0ATEEBaw4CAAECCyAoKgJIIQ0MAQsgKCoCSCAGlEMK1yM8lCENC0MAAAAAIA4gCxshESAoQcgAaiAJIAAvAXYQHwJAAkACfQJAAkAgKC0ATEEBaw4CAAEDCyAoKgJIDAELICgqAkggBpRDCtcjPJQLIg5DAAAAAGBFDQAgDiARXQ0BCyANQwAAAABgRQRAIBEhDgwBCyANIBEgDSARXhshDgsgACAtQQIgKiAGECYgLUECICoQIpIgLUECICogBhAlIC1BAiAqECGSkiINIA4gDSAOXhsgDSAOIA4gDlwbIA4gDlsgDSANW3EbOAKQAyAoQcgAaiAJIAAvAXQQH0MAAAAAIA8gD0MAAAAAXRsgDyAFQQJGGyEOIA8gD1whC0MAAMB/IQ0CQAJAAkAgKC0ATEEBaw4CAAECCyAoKgJIIQ0MAQsgKCoCSCAHlEMK1yM8lCENC0MAAAAAIA4gCxshESAoQcgAaiAJIAAvAXgQHwJAAkACfQJAAkAgKC0ATEEBaw4CAAEDCyAoKgJIDAELICgqAkggB5RDCtcjPJQLIg5DAAAAAGBFDQAgDiARXQ0BCyANQwAAAABgRQRAIBEhDgwBCyANIBEgDSARXhshDgsgACAtQQAgKiAGECYgLUEAICoQIpIgLUEAICogBhAlIC1BACAqECGSkiIGIA4gBiAOXhsgBiAOIA4gDlwbIA4gDlsgBiAGW3EbOAKUAwwBCyAAEHMgACAALQCEA0H7AXE6AIQDQQMhLyAALQAUQQJ2QQNxISkCQAJ/AkAgKkECRgRAQQAhCQJAIClBAmsOAgQAAgtBAiEvDAMLQQIhL0EAIClBAUsNARoLIC8LIQkgKSEvCyAALwAVIUAgLSAvICogBhAmIQ0gLSAvICoQIiERIC0gLyAqIAYQJSEPIC0gLyAqECEhFSAtIAkgKiAGECYhECAtIAkgKhAiIRQgLSAJICogBhAlIRIgLSAJICoQISEYIC0gCSAqIAYQciEZIC0gCSAqEDUhFiAAQQAgASAOkyIjIA0gEZIgDyAVkpIiHSAQIBSSIBIgGJKSIhsgL0EBSyI3GyAGEHEhEiAAQQEgAiATkyIkIBsgHSA3GyAHEHEhGAJAIAQgBSA3GyI5DQACQCAAKALgAyIpIAAoAuQDIi5GDQADQAJAICkoAgAiLBBwRQ0AIDINAiAsEDciDSANWyANi0MXt9E4XXENAiAsEDsiDSANXARAICwhMgwBCyAsITIgDYtDF7fROF0NAgsgKUEEaiIpIC5HDQALDAELQQAhMgsgC0EBaiFBQwAAAAAhDyAAKALgAyIuIAAoAuQDIkJHBEAgGCAYXCI8IAVBAEdyIUUgEiASXCI9IARBAEdyIUYDQCAuKAIAIiwQbwJAICwvABUgLC0AF0EQdHIiKUGAgBBxBEAgLBBuICwgLC0AACIpQQFyIixB+wFxICwgKUEEcRs6AAAMAQsgCAR/ICwgLC0AFEEDcSIpICogKRsgEiAYEG0gLC8AFSAsLQAXQRB0cgUgKQtBgOAAcUGAwABGDQAgLEEUaiExAkAgLCAyRgRAIDJBADYCnAEgMiAMNgKYAUMAAAAAIQ0MAQsgLS0AAEECdkEDcSEpAkACQCAqQQJHDQBBAyErAkAgKUECaw4CAgABC0ECISsMAQsgKSErCyAoQYCAgP4HNgI4IChBgICA/gc2AjQgKEHIAGogLEH8AGoiKSAsLwEeEB8gEiAYICtBAUsiNhshDgJAAkACQAJAICgtAEwiMA4EAAEBAAELAkAgKSAsLwEYECAiDSANXA0AICkgLC8BGBAgQwAAAABeRQ0AICwoAuwDLQAIQQFxDQBDAAAAACENDAILQwAAwH8hEQwCCyAoKgJIIQ1DAADAfyERAkAgMEEBaw4CAQACCyAOIA2UQwrXIzyUIREMAQsgDSERCyAsKgLwAyENQQAhM0EAITACQAJAAkAgLC0A9ANBAWsOAgEAAgsgEiANlEMK1yM8lCENCyANIA1cDQAgDUMAAAAAYCEwCyAsKgL4AyENAkACQAJAICwtAPwDQQFrDgIBAAILIBggDZRDCtcjPJQhDQsgDSANXA0AIA1DAAAAAGAhMwsCQCAsAn0gESARXCAOIA5cckUEQCAsKgKcASINIA1bBEAgLCgC7AMtAAxBAXFFDQMgLCgCmAEgDEYNAwsgMSArICogEhAmIDEgKyAqECKSIDEgKyAqIBIQJSAxICsgKhAhkpIiDSARIA0gEV4bDAELIDAgNnEEQCAxQQIgKiASECYgMUECICoQIpIgMUECICogEhAlIDFBAiAqECGSkiERICwqAvADIQ5DAADAfyENAkACQAJAICwtAPQDQQFrDgIAAQILIA4hDQwBCyASIA6UQwrXIzyUIQ0LIBEgDSANIBFdGyARIA0gDSANXBsgDSANWyARIBFbcRsMAQsgNiAzQQFzckUEQCAxQQAgKiASECYgMUEAICoQIpIgMUEAICogEhAlIDFBACAqECGSkiERICwqAvgDIQ5DAADAfyENAkACQAJAICwtAPwDQQFrDgIAAQILIA4hDQwBCyAYIA6UQwrXIzyUIQ0LIBEgDSANIBFdGyARIA0gDSANXBsgDSANWyARIBFbcRsMAQtBASE1IChBATYCMCAoQQE2AkggMUECQQEgEhAkIDFBAkEBIBIQI5IhEyAxQQBBASASECQhFSAxQQBBASASECMhEEMAAMB/IRFBASE4QwAAwH8hDSAwBEAgLCoC8AMhDgJAAkACQCAsLQD0A0EBaw4CAAECCyAOIQ0MAQsgEiAOlEMK1yM8lCENCyAoQQA2AkggKCATIA2SIg04AjhBACE4CyAVIBCSIRUgMwRAICwqAvgDIQ4CQAJAAkAgLC0A/ANBAWsOAgABAgsgDiERDAELIBggDpRDCtcjPJQhEQsgKEEANgIwICggFSARkiIROAI0QQAhNQsCQAJAAkAgAC0AF0EQdEGAgAxxQYCACEYiNCArQQJJIjtxRQRAIDQgPXINAiANIA1cDQEMAgsgPSANIA1bcg0CC0ECITggKEECNgJIICggEjgCOCASIQ0LAkAgO0EBIDQbBEAgNCA8cg0CIBEgEVwNAQwCCyA8IBEgEVtyDQELQQIhNSAoQQI2AjAgKCAYOAI0IBghEQsCQCApICwvAXoQICIOIA5cDQACfyA2IDhyRQRAICkgLC8BehAgIQ4gKEEANgIwICggFSANIBOTIA6VkjgCNEEADAELIDUgO3INASApICwvAXoQICENIChBADYCSCAoIA0gESAVk5QgE5I4AjhBAAshNUEAITgLICwvABZBD3EiNEUEQCAALQAVQQR2ITQLAkAgOEUgNEEFRiA2ciAwIEZyIDRBBEdycnINACAoQQA2AkggKCASOAI4ICkgLC8BehAgIg0gDVwNAEEAITUgKSAsLwF6ECAhDSAoQQA2AjAgKCASIBOTIA2VOAI0CyAsLwAWQQ9xIjBFBEAgAC0AFUEEdiEwCwJAIDsgRXIgM3IgMEEFRnIgNUUgMEEER3JyDQAgKEEANgIwICggGDgCNCApICwvAXoQICINIA1cDQAgKSAsLwF6ECAhDSAoQQA2AkggKCANIBggFZOUOAI4CyAsQQIgEiASIChByABqIChBOGoQOiAsQQAgGCASIChBMGogKEE0ahA6ICwgKCoCOCAoKgI0ICogKCgCSCAoKAIwIBIgGEEAQQUgCiBBIAwQOBogLCArQQJ0QdQlaigCAEECdGoqApADIQ0gMSArICogEhAmIDEgKyAqECKSIDEgKyAqIBIQJSAxICsgKhAhkpIiDiANIA0gDl0bIA4gDSANIA1cGyANIA1bIA4gDltxGwsiDTgCnAELICwgDDYCmAELIA8gDSAxIC9BASASECQgMSAvQQEgEhAjkpKSIQ8LIC5BBGoiLiBCRw0ACwsgPiA/ayIpQQJ1ITggEiAYIDcbIREgD0MAAAAAkiENIBkgFpIhFSAHIAYgNxshISAGIAcgNxshH0EBQQIgGCASIDcbIhkgGVwiShshS0EAIDkgKUEFTwR9IC0gLyAREEggOEEBa7OUIA2SBSANCyARXiIpGyA5IEBBgIADcSI/GyA5IDlBAkYbITsgKUUgOUEBRnIhTCAvQQJJIUAgAEHyAGohQiAAQfwAaiE1IC9BAnQiKUHEJWohTSAJQQJ0IixBxCVqIT4gLEG0JWohOSApQbQlaiFFIClB1CVqIUYgLEHUJWohPCAFIAQgNxsiPUEARyJOIAhyIU8gPUUiUCAIQQFzcSFRID0gP3JFIVIgKEFAayFIIC0gCSAZEEghJiA9QQFrQQJJIVNBACEsQQAhKQNAICkhNyAoQQA2AkAgKEIANwM4AkAgACgC5AMiKSAAKALgAyIuRg0AICkgLmsiKUEASA0EIChByABqIClBAnVBACBIEEIhKyAoKAJMICgoAjwgKCgCOCIpayIuayApIC4QMSEuICggKCgCOCIpNgJMICggLjYCOCAoKQNQIVUgKCAoKAI8Ii42AlAgKCgCQCEyICggVTcCPCAoIDI2AlQgKyApNgIAICkgLkcEQCAoIC4gKSAua0EDakF8cWo2AlALIClFDQAgKRAoCyAtLQAAIilBAnZBA3EhLgJAAkAgKUEDcSIpIEkgKRtBAkcNAEEDISkCQCAuQQJrDgICAAELQQIhKQwBCyAuISkLIAAvABUhLiAtICkgERBIIQ4CQCAsIAAoAuQDIjAgACgC4AMiK2tBAnVPBEBBACEzQwAAAAAhFiAsIS5DAAAAACEUQwAAAAAhEwwBCyAuQYCAA3EhNiApQQJ0Ii5BxCVqITQgLkG0JWohQ0EAITNDAAAAACETQwAAAAAhFEMAAAAAIRYgLCIuITJDAAAAACENA0AgMCAra0ECdSAuTQ0FAkAgKyAuQQJ0aigCACIxLwAVIDEtABdBEHRyIjpBgIAQcUUgOkGA4ABxQYDAAEdxRQRAIDIgLiAyRmohMgwBCyAoQcgAaiIwIDFBFGoiKyBDKAIAIAMQKiAoLQBMITogMCArIDQoAgAgAxAqICgtAEwhMCAxIDc2AtgDIDMgOkEDRmogMEEDRmohMyA2RUMAAAAAIA4gLiAyRhsiDyArIClBASASECQgKyApQQEgEhAjkiIQIA0gMSApIDEqApwBIB8QLSIXkpKSIBFeRXJFBEAgKCgCOCAoKAI8Rw0DCyAxEHAEQCAUIDEQN5IhFCAWIDEQOyAxKgKcAZSTIRYLAkAgKCgCPCIrICgoAkBHBEAgKyAxNgIAICggK0EEajYCPAwBCyArICgoAjhrIitBAnUiOkEBaiIwQYCAgIAETw0HIChByABqQf////8DICtBAXUiVCAwIDAgVEkbICtB/P///wdPGyA6IEgQQiEwICgoAlAgMTYCACAoICgoAlBBBGo2AlAgKCgCTCAoKAI8ICgoAjgiK2siMWsgKyAxEDEhMSAoICgoAjgiKzYCTCAoIDE2AjggKCkDUCFVICggKCgCPCIxNgJQICgoAkAhOiAoIFU3AjwgKCA6NgJUIDAgKzYCACArIDFHBEAgKCAxICsgMWtBA2pBfHFqNgJQCyArRQ0AICsQKAsgEyAPIBAgF5KSIg+SIRMgDSAPkiENIAAoAuQDITAgACgC4AMhKwsgLkEBaiIuIDAgK2tBAnVJDQALC0MAAIA/IBQgFEMAAIA/XRsgFCAUQwAAAABeGyEUICgoAjwhNiAoKAI4ITECfQJAAn0CQAJAAkAgO0UNACAoQcgAaiA1IEIvAQAQH0MAAMB/IQ5DAADAfyENAkACQAJAICgtAExBAWsOAgABAgsgKCoCSCENDAELICgqAkggBpRDCtcjPJQhDQsgKEHIAGogNSAALwF2EB8CQAJAAkAgKC0ATEEBaw4CAAECCyAoKgJIIQ4MAQsgKCoCSCAGlEMK1yM8lCEOCyAoQcgAaiA1IAAvAXQQH0MAAMB/IRBDAADAfyEPAkACQAJAICgtAExBAWsOAgABAgsgKCoCSCEPDAELICgqAkggB5RDCtcjPJQhDwsgKEHIAGogNSAALwF4EB8CQAJAAkAgKC0ATEEBaw4CAAECCyAoKgJIIRAMAQsgKCoCSCAHlEMK1yM8lCEQCyANIA8gL0EBSyIpGyAdkyINIA1bIA0gE15xDQEgDiAQICkbIB2TIg0gDVsgDSATXXENASAAKALsAy0AEEEBcQ0AIBMgFEMAAAAAWw0DGiAAEDciDSANXA0CIBMgABA3QwAAAABbDQMaDAILIBEhDQsgDSANWw0CIA0hEQsgEQshDSATjEMAAAAAIBNDAAAAAF0bIQ4gDQwBCyANIBOTIQ4gDQshESBRRQRAAkAgMSA2RgRAQwAAAAAhEwwBC0MAAIA/IBYgFkMAAIA/XRsgFiAWQwAAAABeGyEWQwAAAAAhDyAxISsDQCArKAIAIikgLyApKgKcASAfEC0hEwJAIA5DAAAAAF0EQCATICkQO4yUIg1DAAAAAF4gDUMAAAAAXXJFDQEgKSAvIA4gFpUgDZQgE5IiFyAREC0hDSApQRRqIjIgLyAqIBIQJiEQIDIgLyAqECIhGiAyIC8gKiASECUhHiAyIC8gKhAhISAgFyAXXA0BIBAgGpIgHiAgkpIiECANIA0gEF0bIBAgDSANIA1cGyANIA1bIBAgEFtxGyINIA1cIA0gF1tyDQEgDyANIBOTkiEPICkQOyApKgKcAZQgFpIhFgwBCyAOQwAAAABeRQ0AICkQNyIXQwAAAABeIBdDAAAAAF1yRQ0AICkgLyAOIBSVIBeUIBOSIhogERAtIQ0gKUEUaiIpIC8gKiASECYhECApIC8gKhAiIR4gKSAvICogEhAlISAgKSAvICoQISElIBogGlwNACAQIB6SICAgJZKSIhAgDSANIBBdGyAQIA0gDSANXBsgDSANWyAQIBBbcRsiDSANXCANIBpbcg0AIBQgF5MhFCAPIA0gE5OSIQ8LICtBBGoiKyA2Rw0ACyAOIA+TIhcgFpUhHiAXIBSVISAgAC8AFUGAgANxRSBMciFDQwAAAAAhEyAxITADQCAwKAIAIisgLyArKgKcASAfEC0hDQJAIBdDAAAAAF0EQCANIg8gKxA7jJQiEEMAAAAAWw0BICsgLyANIBCSIB4gEJQgDZIgFkMAAAAAWxsgERAtIQ8gK0EUaiIpIC8gKiASECYgKSAvICoQIpIgKSAvICogEhAlICkgLyAqECGSkiIQIA8gDyAQXRsgECAPIA8gD1wbIA8gD1sgECAQW3EbIQ8MAQsgDSEPIBdDAAAAAF5FDQAgKxA3IhBDAAAAAF4gEEMAAAAAXXJFDQAgKyAvICAgEJQgDZIgERAtIQ8gK0EUaiIpIC8gKiASECYgKSAvICoQIpIgKSAvICogEhAlICkgLyAqECGSkiIQIA8gDyAQXRsgECAPIA8gD1wbIA8gD1sgECAQW3EbIQ8LICtBFGoiNCAvQQEgEhAkIRAgNCAvQQEgEhAjIRQgNCAJQQEgEhAkIRogNCAJQQEgEhAjISUgKCAPIBAgFJIiFJIiJzgCNCAoQQA2AiwgGiAlkiEaAkAgK0H8AGoiKSArLwF6ECAiECAQWwRAICkgKy8BehAgIRAgKEEANgIwICggGiAnIBSTIhQgEJQgFCAQlSBAG5I4AjgMAQsgPCgCACEyAkAgSg0AICsgMkEDdGoiOioC8AMhEEEAISkCQAJAAkAgOi0A9ANBAWsOAgEAAgsgGSAQlEMK1yM8lCEQCyAQIBBcDQAgEEMAAAAAYCEpCyBDIFAgKUEBc3FxRQ0AICsvABZBD3EiKQR/ICkFIAAtABVBBHYLQQRHDQAgKEHIAGogNCA5KAIAICoQKiAoLQBMQQNGDQAgKEHIAGogNCA+KAIAICoQKiAoLQBMQQNGDQAgKEEANgIwICggGTgCOAwBCyArIDJBA3RqIikqAvADIhQhEAJAAkACQAJAICktAPQDQQFrIjIOAgEAAgsgGSAUlEMK1yM8lCEQCyAQQwAAAABgDQELICggSzYCMCAoIBk4AjgMAQtDAADAfyEQAkACQAJAIDIOAgABAgsgFCEQDAELIBkgFJRDCtcjPJQhEAsgKCAaIBCSIhA4AjggKCBOICkxAPQDQiCGQoCAgIAgUXEgECAQXHI2AjALICsgLyARIBIgKEEsaiAoQTRqEDogKyAJIBkgEiAoQTBqIChBOGoQOiArIDwoAgBBA3RqIikqAvADIRACQAJAAkACQCApLQD0A0EBaw4CAQACCyAZIBCUQwrXIzyUIRALQQEhMiAQQwAAAABgDQELQQEhMiArLwAWQQ9xIikEfyApBSAALQAVQQR2C0EERw0AIChByABqIDQgOSgCACAqECogKC0ATEEDRg0AIChByABqIDQgPigCACAqECogKC0ATEEDRiEyCyArICgqAjQiECAoKgI4IhQgL0EBSyIpGyAUIBAgKRsgAC0AhANBA3EgKCgCLCI0ICgoAjAiOiApGyA6IDQgKRsgEiAYIAggMnEiKUEEQQcgKRsgCiBBIAwQOBogEyAPIA2TkiETIAACfyAALQCEAyIpQQRxRQRAQQAgKy0AhANBBHFFDQEaC0EECyApQfsBcXI6AIQDIDBBBGoiMCA2Rw0ACwsgDiATkyEOCyAAIAAtAIQDIilB+wFxQQQgDkMAAAAAXUECdCApQQRxQQJ2G3I6AIQDIC0gLyAqIAYQciEPIC0gLyAqEDUhEyAoQcgAaiAtIE0oAgAiQyAqEEpDAADAfyENAkACQAJAICgtAExBAWsOAgABAgsgKCoCSCENDAELICgqAkggBpRDCtcjPJQhDQsgDyATkiEPIA1DAAAAAJdDAAAAACANIA1bGyAtIC8gKhBLkiEeIC0gLyAREEghFgJ/An0CQCAOQwAAAABeRSA7QQJHckUEQCAoQcgAaiA1IEIgRigCAEEBdGoiKS8BABAfICgtAExFDQEgKEE4aiA1ICkvAQAQHwJ9AkACQCAoLQA8QQFrDgIAAQQLICgqAjgMAQsgHyAoKgI4lEMK1yM8lAsiDSANXA0BIChByABqIDUgKS8BABAfQwAAwH8hDQJAAkACQCAoLQBMQQFrDgIAAQILICgqAkghDQwBCyAfICgqAkiUQwrXIzyUIQ0LQwAAAAAgDSAPkyAekyARIA6TkyIOQwAAAABeRQ0CGgsgDiAOQwAAAABgDQEaIA4hFCAtLQAAQQR2QQdxIilBACApQQNrQQNPGwwCC0MAAAAACyEUIC0tAABBBHZBB3ELISlDAAAAACENAkACQCAzDQBDAAAAACETAkACQAJAAkACQCApQQFrDgUAAQIEAwYLIBRDAAAAP5QhEwwFCyAUIRMMBAsgNiAxayIpQQVJDQIgFiAUIClBAnVBAWuzlZIhFgwCCyAWIBQgNiAxa0ECdUEBarOVIhOSIRYMAgsgFEMAAAA/lCA2IDFrQQJ1s5UiEyATkiAWkiEWDAELQwAAAAAhEwsgDyATkiEQIAAQdSE0AkAgLCAuTyI6BEBDAAAAACEPQwAAAAAhDgwBCyA2QQRrITYgFCAzs5UhIEMAAAAAIQ5DAAAAACEPICwhKQNAIAAoAuQDIAAoAuADIitrQQJ1IClNDQUCQCArIClBAnRqKAIAIisvABUgKy0AF0EQdHIiMEGAgBBxDQAgK0EUaiEyAkACQAJ/AkACQAJAAkACQCAwQYDgAHFBgMAARgR/IChByABqIDIgRSgCACIwICoQLyAoLQBMDQEgKy8AFSArLQAXQRB0cgUgMAtBgOAAcUGAwABGDQcgKEHIAGogMiBFKAIAICoQKiAQQwAAAIAgIEMAAACAIBRDAAAAAF4bIhcgKC0ATEEDRxuSIRAgCEUNBiAvQQFrDgMCAwQBCyAIRQ0HICsgMEECdGogMiAvICogERA9IC0gLyAqEDWSIDIgLyAqIBIQM5I4ApgDDAcLQQEhMCArQZwDagwDC0EDITAgK0GkA2oMAgtBACEwICtBmANqDAELQQIhMCArQaADagshMyArIDBBAnRqIDMqAgAgEJI4ApgDCyA2KAIAITAgKEHIAGogMiBDICoQKiAQQwAAAIAgFiArIDBGG5JDAAAAgCAXICgtAExBA0cbkiEQIE9FBEAgECAyIC9BASASECQgMiAvQQEgEhAjkiArKgKcAZKSIRAgGSENDAILICsgLyASEFUgEJIhECA0BEAgKxBJIRcgMkEAICogEhAzIRogKyoClAMgMkEAQQEgEhAkIDJBAEEBIBIQI5KSIBcgGpIiF5MiGiAPIA8gGl0bIBogDyAPIA9cGyAPIA9bIBogGltxGyEPIBcgDiAOIBddGyAXIA4gDiAOXBsgDiAOWyAXIBdbcRshDgwCCyArIAkgEhBVIhcgDSANIBddGyAXIA0gDSANXBsgDSANWyAXIBdbcRshDQwBCyAIRQ0AICsCfwJAAkACQAJAIC9BAWsOAwECAwALICtBnANqITBBAQwDCyArQaQDaiEwQQMMAgsgK0GYA2ohMEEADAELICtBoANqITBBAgtBAnRqIBMgMCoCACAtIC8gKhA1kpI4ApgDCyApQQFqIikgLkcNAAsLIA8gDpIgDSA0GyETAn0gUwRAIAAgCSAbIBOSICEQLSENIC0gCSAqIAYQJiAtIAkgKhAikiAtIAkgKiAGECUgLSAJICoQIZKSIg4gDSANIA5dGyAOIA0gDSANXBsgDSANWyAOIA5bcRsgG5MMAQsgGSATIFIbIRMgGQshFCA/RQRAIAAgCSAbIBOSICEQLSENIC0gCSAqIAYQJiAtIAkgKhAikiAtIAkgKiAGECUgLSAJICoQIZKSIg4gDSANIA5dGyAOIA0gDSANXBsgDSANWyAOIA5bcRsgG5MhEwsgCEUgOnJFBEADQCAAKALkAyAAKALgAyIpa0ECdSAsTQ0FAkAgKSAsQQJ0aigCACIpLwAVICktABdBEHRyIjJBgIAQcQ0AIClBFGohKwJ9IDJBgOAAcUGAwABGBEAgKEHIAGogKyA5KAIAIjAgKhAvICgtAEwEQCApIDBBAnRqICsgCSAqIBkQPSAtIAkgKhA1kiArIAkgKiASEDOSIg04ApgDIA0gDVsNAwsgLSAJICoQNSArIAkgKiASEDOSDAELIDJBCHZBD3EiMEUEQCAALQAVQQR2ITALAkACQAJAAkAgMEEEaw4CAAECCyAoQcgAaiArIDkoAgAgKhAqQQQhMCAoLQBMQQNGDQEgKEHIAGogKyA+KAIAICoQKiAoLQBMQQNGDQEgKSA8KAIAQQN0aiIyKgLwAyEPAkACQAJAIDItAPQDQQFrDgIBAAILIBkgD5RDCtcjPJQhDwsgFSENIA9DAAAAAGANAwsgKSBGKAIAQQJ0aioCkAMhDSAoIClB/ABqIjIgKS8BehAgIg4gDlsEfSArIAlBASASECQgKyAJQQEgEhAjkiANIDIgKS8BehAgIg6UIA0gDpUgQBuSBSATCzgCOCAoIA0gKyAvQQEgEhAkICsgL0EBIBIQI5KSOAJIIChBADYCNCAoQQA2AjAgKSAvIBEgEiAoQTRqIChByABqEDogKSAJIBkgEiAoQTBqIChBOGoQOiAoKgI4Ig4gKCoCSCIPIC9BAUsiMCIrGyENID9BAEcgAC8AFUEPcUEER3EiMiBAcSAPIA4gKxsiDiAOXHIhKyApIA4gDSAqICsgMCAycSANIA1cciASIBhBAUECIAogQSAMEDgaIBUhDQwCC0EFQQEgLS0AAEEIcRshMAsgKSAJIBIQVSENIChByABqICsgOSgCACIzICoQKiAUIA2TIQ4CQCAoLQBMQQNHBEAgPigCACEyDAELIChByABqICsgPigCACIyICoQKiAoLQBMQQNHDQAgFSAOQwAAAD+UIg1DAAAAACANQwAAAABeG5IhDQwBCyAoQcgAaiArIDIgKhAqIBUhDSAoLQBMQQNGDQAgKEHIAGogKyAzICoQKiAoLQBMQQNGBEAgFSAOQwAAAAAgDkMAAAAAXhuSIQ0MAQsCQAJAIDBBAWsOAgIAAQsgFSAOQwAAAD+UkiENDAELIBUgDpIhDQsgDSAiAn8CQAJAAkACQCAJDgQAAQIDDQtBASEwIClBnANqDAMLQQMhMCApQaQDagwCC0EAITAgKUGYA2oMAQtBAiEwIClBoANqCyoCAJKSCyENICkgMEECdGogDTgCmAMLICxBAWoiLCAuRw0ACwsgHiAQkiINIBwgHCAcXBshDiAxBEAgMRAoCyANIBwgDSAcXhsgDiAcIBxbIA0gDVtxGyEcICIgJkMAAAAAIDcbIBOSkiEiIDdBAWohKSA4IC4iLEsNAAsCQCAIRQ0AID9FBEAgABB1RQ0BCwJAID1FBEAgGyAZkiENDAELIABB8ANqIiwgPCgCAEEDdGoiLioCACENAkACQAJAIC4tAARBAWsOAgEAAgsgISANlEMK1yM8lCENCyANQwAAAABgRQ0AICxBgQIgCUEDdHZBAXFBA3RqIiwqAgAhDkMAAMB/IQ0CQAJAICwtAARBAWsOAgABAwsgDiENDAILICEgDpRDCtcjPJQhDQwBCyAbICKSIQ0LIAAgCSANIAcQLSENIC0gCSAqIAYQJiEOIC0gCSAqECIhDyAtIAkgKiAGECUhEyAtIAkgKhAhIRBDAAAAACEWIAAvABVBD3EhLAJAAkACQAJAAkACQAJAAkAgDiAPkiATIBCSkiIOIA0gDSAOXRsgDiANIA0gDVwbIA0gDVsgDiAOW3EbIBuTICKTIg1DAAAAAGBFBEAgLEECaw4CAQYHCyAsQQJrDgcABQEGBAIDBgsgFSANQwAAAD+UkiEVDAULIA0gKbOVIRYMBAsgDSApsyIOlSEWIBUgDSAOIA6SlZIhFQwDCyAVIA0gN0ECarOVIhaSIRUMAgsgKUECSQ0BIA0gN7OVIRYMAgsgFSANkiEVCyApRQ0BC0EAITJBACEpQQAhKwNAQwAAAAAhEEMAAAAAIQ5DAAAAACENICkhLkMAAAAAIQ9DAAAAACETICkgOEkEQAJ/A0AgACgC5AMgACgC4AMiLGtBAnUgLk0NBwJAICwgLkECdGooAgAiLC8AFSAsLQAXQRB0ciIxQYCAEHEgMUGA4ABxQYDAAEZyDQAgLiAyICwoAtgDRw0CGiAsQRRqISsgLCA8KAIAQQJ0aioCkAMiD0MAAAAAYAR/IA8gKyAJQQEgEhAkICsgCUEBIBIQI5KSIg8gDSANIA9dGyAPIA0gDSANXBsgDSANWyAPIA9bcRshDSAsLQAWBSAxQQh2C0EPcSIxBH8gMQUgAC0AFUEEdgtBBUcNACAtLQAAQQhxRQ0AICwQSSArQQAgKiASEDOSIg8gDiAOIA9dGyAPIA4gDiAOXBsgDiAOWyAPIA9bcRsiDiAsKgKUAyArQQBBASASECQgK0EAQQEgEhAjkpIgD5MiDyAQIA8gEF4bIA8gECAQIBBcGyAQIBBbIA8gD1txGyIQkiIPIA0gDSAPXRsgDyANIA0gDVwbIA0gDVsgDyAPW3EbIQ0LIC5BAWoiLiA4Rw0ACyA4CyErIA4hEyANIQ8LIBUgJkMAAAAAIDIbkiEVICkgK0kEQCAVIBOSIRQgFSAPkiEXIBYgD5IhDQNAIAAoAuQDIAAoAuADIixrQQJ1IClNDQYCQCAsIClBAnRqKAIAIi4vABUgLi0AF0EQdHIiMUGAgBBxIDFBgOAAcUGAwABGcg0AIC5BFGohLAJAAkACQAJAAkACQCAxQQh2QQ9xIjEEfyAxBSAALQAVQQR2C0EBaw4FAQMCBAAGCyAtLQAAQQhxDQQLICwgCSAqIBIQPSEOIC4gOSgCAEECdGogFSAOkjgCmAMMBAsgLCAJICogEhA8IQ4CQAJAAkACQCAJDgQBAQIADwsgLioCkAMhEEECISwMAgtBASEsIC4qApQDIRACQCAJDgICAA4LQQMhLAwBCyAuKgKQAyEQQQAhLAsgLiAsQQJ0aiAXIA6TIBCTOAKYAwwDCwJAAkACQAJAIAkOBAEBAgAOCyAuKgKQAyEOQQIhLAwCC0EBISwgLioClAMhDgJAIAkOAgIADQtBAyEsDAELIC4qApADIQ5BACEsCyAuICxBAnRqIBUgDyAOk0MAAAA/lJI4ApgDDAILICwgCSAqIBIQMyEOIC4gOSgCAEECdGogFSAOkjgCmAMgLiA8KAIAQQN0aiIxKgLwAyEOAkACQAJAIDEtAPQDQQFrDgIBAAILIBkgDpRDCtcjPJQhDgsgDkMAAAAAYA0CCwJAAkACfSAvQQFNBEAgLioClAMgLCAJQQEgEhAkICwgCUEBIBIQI5KSIRAgDQwBCyANIRAgLioCkAMgLCAvQQEgEhAkICwgL0EBIBIQI5KSCyIOIA5cIC4qApADIhMgE1xyRQRAIA4gE5OLQxe30ThdDQEMAgsgDiAOWyATIBNbcg0BCyAuKgKUAyITIBNcIiwgECAQXHJFBEAgECATk4tDF7fROF1FDQEMAwsgECAQWw0AICwNAgsgLiAOIBAgKkEAQQAgEiAYQQFBAyAKIEEgDBA4GgwBCyAuIBQgLhBJkyAsQQAgKiAZED2SOAKcAwsgKUEBaiIpICtHDQALCyAWIBWSIA+SIRUgMiA3RyEsIDJBAWohMiArISkgLA0ACwsgKEHIAGogNSBCLwEAEB9DAADAfyEPAkACQAJAICgtAExBAWsOAgABAgsgKCoCSCEPDAELICgqAkggBpRDCtcjPJQhDwsgKEHIAGogNSAALwF2EB8CQAJAAn0CQAJAICgtAExBAWsOAgABAwsgKCoCSAwBCyAoKgJIIAaUQwrXIzyUCyINQwAAAABgRQ0AIA0gI10NAQsgD0MAAAAAYEUEQCAjIQ0MAQsgDyAjIA8gI14bIQ0LIABBkANqIisgLUECICogBhAmIC1BAiAqECKSIC1BAiAqIAYQJSAtQQIgKhAhkpIiDiANIA0gDl0bIA4gDSANIA1cGyANIA1bIA4gDltxGzgCACAoQcgAaiA1IAAvAXQQH0MAAMB/IQ8CQAJAAkAgKC0ATEEBaw4CAAECCyAoKgJIIQ8MAQsgKCoCSCAHlEMK1yM8lCEPCyAoQcgAaiA1IAAvAXgQHwJAAkACfQJAAkAgKC0ATEEBaw4CAAEDCyAoKgJIDAELICgqAkggB5RDCtcjPJQLIg1DAAAAAGBFDQAgDSAkXQ0BCyAPQwAAAABgRQRAICQhDQwBCyAPICQgDyAkXhshDQsgAEGUA2oiMSAtQQAgKiAGECYgLUEAICoQIpIgLUEAICogBhAlIC1BACAqECGSkiIHIA0gByANXhsgByANIA0gDVwbIA0gDVsgByAHW3EbOAIAAkAgK0GBAiAvQQN0dkEBcUECdGoCfQJAIDtBAUcEQCAALQAXQQNxIilBAkYgO0ECR3INAQsgACAvIBwgHxAtIQcgLSAvICogBhAmIC0gLyAqECKSIC0gLyAqIAYQJSAtIC8gKhAhkpIiDSAHIAcgDV0bIA0gByAHIAdcGyAHIAdbIA0gDVtxGwwBCyA7QQJHIClBAkdyDQEgHSAAIC8gHCAfEC0iDSAdIBGSIgcgByANXhsgDSAHIAcgB1wbIAcgB1sgDSANW3EbIgcgByAdXRsgHSAHIAcgB1wbIAcgB1sgHSAdW3EbCzgCAAsCQCArQYECIAlBA3R2QQFxQQJ0agJ9AkAgPUEBRwRAID1BAkciKSAALQAXQQNxIixBAkZyDQELIAAgCSAbICKSICEQLSEHIC0gCSAqIAYQJiAtIAkgKhAikiAtIAkgKiAGECUgLSAJICoQIZKSIgYgByAGIAdeGyAGIAcgByAHXBsgByAHWyAGIAZbcRsMAQsgKSAsQQJHcg0BIBsgACAJIBsgIpIgIRAtIgcgGyAZkiIGIAYgB14bIAcgBiAGIAZcGyAGIAZbIAcgB1txGyIGIAYgG10bIBsgBiAGIAZcGyAGIAZbIBsgG1txGws4AgALIAhFDQAgAC8AFUGAgANxQYCAAkYEQEEBIDggOEEBTRshMCAAKALkAyAAKALgAyI3a0ECdSEtQQAhKQNAICkgLUYNBCA3IClBAnRqKAIAIi4vABVBgOAAcUGAwABHBEACfQJAAkACQCAJDgQCAgABCgsgLkGQA2ohMkEAISwgKyoCACAuKgKYA5MMAgsgLkGQA2ohMkECISwgKyoCACAuKgKgA5MMAQsgMSoCACEGAkACQCAJDgIAAQkLIC5BlANqITJBASEsIAYgLioCnAOTDAELIC5BlANqITJBAyEsIAYgLioCpAOTCyEGIC4gLEECdGogBiAyKgIAkzgCmAMLIClBAWoiKSAwRw0ACwsgL0EBcSIyIAlBAXEiN3IEQEEBIDggOEEBTRshLSAAKALkAyAAKALgAyI1a0ECdSE4QQAhKSAvQQFrITkDQCApIDhGDQQCQCA1IClBAnRqKAIAIi4vABUgLi0AF0EQdHIiLEGAgBBxICxBgOAAcUGAwABGcg0AIDIEQAJ/An8CQAJAAkAgOQ4DAAECDAsgLkGUA2ohLCAuQaQDaiEzQQEhMCAxDAMLIC5BmANqITNBAiEwIC5BkANqDAELIC5BoANqITNBACEwIC5BkANqCyEsICsLITYgLiAwQQJ0aiA2KgIAICwqAgCTIDMqAgCTOAKYAwsgN0UNAAJ/An8CQAJAAkAgCUEBaw4DAAECCwsgLkGUA2ohLCAuQaQDaiEzQQEhMCAxDAMLIC5BmANqITNBAiEwIC5BkANqDAELIC5BoANqITNBACEwIC5BkANqCyEsICsLITYgLiAwQQJ0aiA2KgIAICwqAgCTIDMqAgCTOAKYAwsgKUEBaiIpIC1HDQALCyALRSAALwAVQYDgAHFyRQRAIAAtAABBCHFFDQELIAAgACA7IAQgL0EBSxsgKiAKIEEgDEMAAAAAQwAAAAAgEiAYEHYLIAAgAzoApAEgRA0AIAogCigCCCIDIAAoAqgBIilBAWoiCSADIAlLGzYCCCApQQhGBEAgAEEANgKoAUEAISkLIAgEfyAAQewCagUgACApQQFqNgKoASAAIClBGGxqQawBagsiAyAFNgIMIAMgBDYCCCADIAI4AgQgAyABOAIAIAMgACoCkAM4AhAgAyAAKgKUAzgCFEEAIUQLIAgEQCAAIAApApADNwKIAyAAIAAtAAAiA0EBciIEQfsBcSAEIANBBHEbOgAACyAAIAw2AqABIChB4ABqJAAgRyBERXIPCxACAAsQJwALNQEBfyABIAAoAgQiAkEBdWohASAAKAIAIQAgASACQQFxBH8gASgCACAAaigCAAUgAAsRAQAL1AECAX8BfSMAQRBrIgYkACAGQQhqIABB/ABqIABBFGoiACABQQJ0QdQlaigCAEEBdGovAWIQH0MAAMB/IQcCQAJAAkAgBi0ADEEBaw4CAAECCyAGKgIIIQcMAQsgBioCCCAClEMK1yM8lCEHCyAHIAAgAUEBIAMQJCAAIAFBASADECOSkiEDAkACQAJAAkAgBCgCAA4DAAEAAwsgBSoCACICIAIgAyACIANdGyADIANcGyEDDAELIAMgA1wNASAEQQI2AgALIAUgAzgCAAsgBkEQaiQAC4wBAgF/AX0gACgC3ANFBEBDAAAAAA8LIABB/ABqIgEgAC8BHBAgIgIgAlsEQCABIAAvARwQIA8LAkAgACgC7AMtAAhBAXENACABIAAvARgQICICIAJcDQAgASAALwEYECBDAAAAAF1FDQAgASAALwEYECCMDwtDAACAP0MAAAAAIAAoAuwDLQAIQQFxGwtwAgF/AX0jAEEQayIEJAAgBEEIaiAAIAFBAnRBxCVqKAIAIAIQKkMAAMB/IQUCQAJAAkAgBC0ADEEBaw4CAAECCyAEKgIIIQUMAQsgBCoCCCADlEMK1yM8lCEFCyAEQRBqJAAgBUMAAAAAIAUgBVsbC3ACAX8BfSMAQRBrIgQkACAEQQhqIAAgAUECdEG0JWooAgAgAhAvQwAAwH8hBQJAAkACQCAELQAMQQFrDgIAAQILIAQqAgghBQwBCyAEKgIIIAOUQwrXIzyUIQULIARBEGokACAFQwAAAAAgBSAFWxsLzgECA38CfSMAQRBrIgMkAEEBIQQgA0EIaiAAQfwAaiIFIAAgAUEBdGpB7gBqIgEvAQAQHwJAAkAgAyoCCCIHIAIqAgAiBlwEQCAHIAdbBEAgAi0ABCECDAILIAYgBlwhBAsgAi0ABCECIARFDQAgAy0ADCACQf8BcUYNAQsgBSABIAYgAhA0A0AgAC0AACIBQQRxDQEgACABQQRyOgAAIAAoAhAiAQRAIAAgAREAAAsgAEGAgID+BzYCnAEgACgC3AMiAA0ACwsgA0EQaiQAC4UBAgN/AX4CQCAAQoCAgIAQVARAIAAhBQwBCwNAIAFBAWsiASAAQgqAIgVC9gF+IAB8p0EwcjoAACAAQv////+fAVYhAiAFIQAgAg0ACwsgBaciAgRAA0AgAUEBayIBIAJBCm4iA0H2AWwgAmpBMHI6AAAgAkEJSyEEIAMhAiAEDQALCyABCzcBAn9BBBAeIgIgATYCAEEEEB4iAyABNgIAQY07IABBrjtByihBvAEgAkGuO0HOKEG9ASADEAcLDwAgACABIAJBAUECEIIBC14BAX8gAEEANgIMIAAgAzYCEAJAIAEEQCABQYCAgIAETw0BIAFBAnQQHiEECyAAIAQ2AgAgACAEIAJBAnRqIgI2AgggACAEIAFBAnRqNgIMIAAgAjYCBCAADwsQUAALRwEBfyACLwAGIgNBB3EEQCAAIAFB6ABqIAMQHw8LIAFB6ABqIQEgAi8ADiIDQQdxBEAgACABIAMQHw8LIAAgASACLwAQEB8LRwEBfyACLwACIgNBB3EEQCAAIAFB6ABqIAMQHw8LIAFB6ABqIQEgAi8ADiIDQQdxBEAgACABIAMQHw8LIAAgASACLwAQEB8LewACQAJAAkACQCADQQFrDgIAAQILIAIvAAoiA0EHcUUNAQwCCyACLwAIIgNBB3FFDQAMAQsgAi8ABCIDQQdxBEAMAQsgAUHoAGohASACLwAMIgNBB3EEQCAAIAEgAxAfDwsgACABIAIvABAQHw8LIAAgAUHoAGogAxAfC3sAAkACQAJAAkAgA0EBaw4CAAECCyACLwAIIgNBB3FFDQEMAgsgAi8ACiIDQQdxRQ0ADAELIAIvAAAiA0EHcQRADAELIAFB6ABqIQEgAi8ADCIDQQdxBEAgACABIAMQHw8LIAAgASACLwAQEB8PCyAAIAFB6ABqIAMQHwucCgELfyMAQRBrIggkACABIAEvAABBeHEgA3IiAzsAAAJAAkACQAJAAkACQAJAAkACQAJAIANBCHEEQCADQf//A3EiBkEEdiEEIAZBP00EfyAAIARBAnRqQQRqBSAEQQRrIgQgACgCGCIAKAIEIAAoAgAiAGtBAnVPDQIgACAEQQJ0agsgAjgCAAwKCwJ/IAKLQwAAAE9dBEAgAqgMAQtBgICAgHgLIgRB/w9qQf4fSyAEsiACXHJFBEAgA0EPcUEAIARrQYAQciAEIAJDAAAAAF0bQQR0ciEDDAoLIAAgAC8BACILQQFqOwEAIAtBgCBPDQMgC0EDTQRAIAAgC0ECdGogAjgCBAwJCyAAKAIYIgNFBEBBGBAeIgNCADcCACADQgA3AhAgA0IANwIIIAAgAzYCGAsCQCADKAIEIgQgAygCCEcEQCAEIAI4AgAgAyAEQQRqNgIEDAELIAQgAygCACIHayIEQQJ1IglBAWoiBkGAgICABE8NAQJ/Qf////8DIARBAXUiBSAGIAUgBksbIARB/P///wdPGyIGRQRAQQAhBSAJDAELIAZBgICAgARPDQYgBkECdBAeIQUgAygCBCADKAIAIgdrIgRBAnULIQogBSAJQQJ0aiIJIAI4AgAgCSAKQQJ0ayAHIAQQMSEHIAMgBSAGQQJ0ajYCCCADIAlBBGo2AgQgAygCACEEIAMgBzYCACAERQ0AIAQQKAsgACgCGCIGKAIQIgMgBigCFCIAQQV0Rw0HIANBAWpBAEgNACADQf7///8DSw0BIAMgAEEGdCIAIANBYHFBIGoiBCAAIARLGyIATw0HIABBAE4NAgsQAgALQf////8HIQAgA0H/////B08NBQsgCEEANgIIIAhCADcDACAIIAAQlgEgBigCDCEEIAggCCgCBCIHIAYoAhAiAEEfcWogAEFgcWoiAzYCBCAHRQRAIANBAWshBQwDCyADQQFrIgUgB0EBa3NBH0sNAiAIKAIAIQoMAwtB6yRB0RdBIkHMFxALAAsQUAALIAgoAgAiCiAFQQV2QQAgA0EhTxtBAnRqQQA2AgALIAogB0EDdkH8////AXFqIQMCQCAHQR9xIgdFBEAgAEEATA0BIABBIG0hBSAAQR9qQT9PBEAgAyAEIAVBAnQQMRoLIAAgBUEFdGsiAEEATA0BIAMgBUECdCIFaiIDIAMoAgBBf0EgIABrdiIAQX9zcSAEIAVqKAIAIABxcjYCAAwBCyAAQQBMDQBBfyAHdCEMQSAgB2shCSAAQSBOBEAgDEF/cyENIAMoAgAhBQNAIAMgBSANcSAEKAIAIgUgB3RyNgIAIAMgAygCBCAMcSAFIAl2ciIFNgIEIARBBGohBCADQQRqIQMgAEE/SyEOIABBIGshACAODQALIABBAEwNAQsgAyADKAIAQX8gCSAJIAAgACAJShsiBWt2IAxxQX9zcSAEKAIAQX9BICAAa3ZxIgQgB3RyNgIAIAAgBWsiAEEATA0AIAMgBSAHakEDdkH8////AXFqIgMgAygCAEF/QSAgAGt2QX9zcSAEIAV2cjYCAAsgBigCDCEAIAYgCjYCDCAGIAgoAgQiAzYCECAGIAgoAgg2AhQgAEUNACAAECggBigCECEDCyAGIANBAWo2AhAgBigCDCADQQN2Qfz///8BcWoiACAAKAIAQX4gA3dxNgIAIAEvAAAhAwsgA0EHcSALQQR0ckEIciEDCyABIAM7AAAgCEEQaiQAC48BAgF/AX0jAEEQayIDJAAgA0EIaiAAQegAaiAAQdQAQdYAIAFB/gFxQQJGG2ovAQAiASAALwFYIAFBB3EbEB9DAADAfyEEAkACQAJAIAMtAAxBAWsOAgABAgsgAyoCCCEEDAELIAMqAgggApRDCtcjPJQhBAsgA0EQaiQAIARDAAAAAJdDAAAAACAEIARbGwueAgIHfwF9IwBBEGsiAyQAAkAgACgCDCIBBEAgACAAKgKQAyAAKgKUAyABESYAIgggCFsNASADQYAeNgIAIABBBUGuJSADEC4QJwALAkACQCAAKALkAyIBIAAoAuADIgZHBEBBASABIAZrQQJ1IgEgAUEBTRshBwNAIAYgBEECdGooAgAiASgC2ANFBEAgAS8AFSABLQAXQRB0ciIFQYDgAHFBgMAARwRAIAVBCHZBD3EiBQR/IAUFIAAtABVBBHYLQQVGBEAgAC0AFEEIcQ0FCyABLQAAQQJxDQQgAiABIAIbIQILIARBAWoiBCAHRw0BCwsgAg0CCyAAKgKUAyEIDAILIAEhAgsgAhBJIAIqApwDkiEICyADQRBqJAAgCAtQAAJAAkACQAJAAkAgAg4EBAABAgMLIAAgASABQTBqEEQPCyAAIAEgAUEwaiADEEUPCyAAIAEgAUEwahBDDwsQJwALIAAgASABQTBqIAMQRgt5AgF/AX0jAEEQayIDJAAgA0EIaiAAIAFBAnRBxCVqKAIAIAIQTEMAAMB/IQQCQAJAAkAgAy0ADEEBaw4CAAECCyADKgIIIQQMAQsgAyoCCEMAAAAAlEMK1yM8lCEECyADQRBqJAAgBEMAAAAAl0MAAAAAIAQgBFsbC1QAAkACQAJAAkACQCACDgQEAAECAwsgACABIAFBwgBqEEQPCyAAIAEgAUHCAGogAxBFDwsgACABIAFBwgBqEEMPCxAnAAsgACABIAFBwgBqIAMQRgvOAQIDfwJ9IwBBEGsiAyQAQQEhBCADQQhqIABB/ABqIgUgACABQQF0akH2AGoiAS8BABAfAkACQCADKgIIIgcgAioCACIGXARAIAcgB1sEQCACLQAEIQIMAgsgBiAGXCEECyACLQAEIQIgBEUNACADLQAMIAJB/wFxRg0BCyAFIAEgBiACEDQDQCAALQAAIgFBBHENASAAIAFBBHI6AAAgACgCECIBBEAgACABEQAACyAAQYCAgP4HNgKcASAAKALcAyIADQALCyADQRBqJAALzgECA38CfSMAQRBrIgMkAEEBIQQgA0EIaiAAQfwAaiIFIAAgAUEBdGpB8gBqIgEvAQAQHwJAAkAgAyoCCCIHIAIqAgAiBlwEQCAHIAdbBEAgAi0ABCECDAILIAYgBlwhBAsgAi0ABCECIARFDQAgAy0ADCACQf8BcUYNAQsgBSABIAYgAhA0A0AgAC0AACIBQQRxDQEgACABQQRyOgAAIAAoAhAiAQRAIAAgAREAAAsgAEGAgID+BzYCnAEgACgC3AMiAA0ACwsgA0EQaiQACwoAIABBMGtBCkkLBQAQAgALBAAgAAsUACAABEAgACAAKAIAKAIEEQAACwsrAQF/IAAoAgwiAQRAIAEQKAsgACgCACIBBEAgACABNgIEIAEQKAsgABAoC/wDAQN/IwBBEGsiAyQAIABCADcCBCAAQcEgOwAVIABCADcCDCAAQoCAgICAgIACNwIYIAAgAC0AF0H4AXE6ABcgACAALQAAQeABcUEFcjoAACAAIAAtABRBgAFxOgAUIABBIGpBAEHOABAwGiAAQgA3AXIgAEGEgBA2AW4gAEEANgF6IABCADcCgAEgAEIANwKIASAAQgA3ApABIABBADYCmAEgAEEAOgCkASAAQoCAgP4HNwKcASAAQagBakEAQcQBEDAaIABB7AJqIQQgAEGsAWohAgNAIAJCgICA/IuAgMC/fzcCECACQoGAgIAQNwIIIAJCgICA/IuAgMC/fzcCACACQRhqIgIgBEcNAAsgAEKAgID8i4CAwL9/NwLsAiAAQoCAgPyLgIDAv383AvwCIABCgYCAgBA3AvQCIABCgICA/oeAgOD/ADcCkAMgAEKAgID+h4CA4P8ANwKIAyAAQYQDaiICIAItAABB+AFxOgAAIABBmANqQQBB1AAQMBogAEEAOgD8AyAAQYCAgP4HNgL4AyAAQQA6APQDIABBgICA/gc2AvADIAAgATYC7AMgAQRAIAEtAAhBAXEEQCAAIAAtABRB8wFxQQhyOgAUIAAgAC8AFUHw/wNxQQRyOwAVCyADQRBqJAAgAA8LIANB+Bk2AgAgAxBrECcACzMAIAAgAUECdEHUJWooAgBBAnRqKgKQAyAAQRRqIgAgAUEBIAIQJCAAIAFBASACECOSkguiBAIGfwJ+An9BCCEEAkACQCAAQUdLDQADQEEIIAQgBEEITRshBEG4OikDACIHAn9BCCAAQQNqQXxxIABBCE0bIgBB/wBNBEAgAEEDdkEBawwBCyAAQR0gAGciAWt2QQRzIAFBAnRrQe4AaiAAQf8fTQ0AGkE/IABBHiABa3ZBAnMgAUEBdGtBxwBqIgEgAUE/TxsLIgOtiCIIUEUEQANAIAggCHoiCIghBwJ+IAMgCKdqIgNBBHQiAkG4MmooAgAiASACQbAyaiIGRwRAIAEgBCAAEFgiBQ0FIAEoAgQiBSABKAIINgIIIAEoAgggBTYCBCABIAY2AgggASACQbQyaiICKAIANgIEIAIgATYCACABKAIEIAE2AgggA0EBaiEDIAdCAYgMAQtBuDpBuDopAwBCfiADrYmDNwMAIAdCAYULIghCAFINAAtBuDopAwAhBwsCQCAHUEUEQEE/IAd5p2siBkEEdCICQbgyaigCACEBAkAgB0KAgICABFQNAEHjACEDIAEgAkGwMmoiAkYNAANAIANFDQEgASAEIAAQWCIFDQUgA0EBayEDIAEoAggiASACRw0ACyACIQELIABBMGoQWg0BIAFFDQQgASAGQQR0QbAyaiICRg0EA0AgASAEIAAQWCIFDQQgASgCCCIBIAJHDQALDAQLIABBMGoQWkUNAwtBACEFIAQgBEEBa3ENASAAQUdNDQALCyAFDAELQQALC0wBAX9BASEBAkAgAC0AHkEHcQ0AIAAtACJBB3ENACAALQAuQQdxDQAgAC0AKkEHcQ0AIAAtACZBB3ENACAALQAoQQdxQQBHIQELIAELoAMBA38gASAAQQRqIgRqQQFrQQAgAWtxIgUgAmogACAAKAIAIgFqQQRrTQR/IAAoAgQiAyAAKAIINgIIIAAoAgggAzYCBCAEIAVHBEAgACAAQQRrKAIAQX5xayIDIAUgBGsiBCADKAIAaiIFNgIAIAVBfHEgA2pBBGsgBTYCACAAIARqIgAgASAEayIBNgIACwJAIAEgAkEYak8EQCAAIAJqQQhqIgMgASACa0EIayIBNgIAIAFBfHEgA2pBBGsgAUEBcjYCACADAn8gAygCAEEIayIBQf8ATQRAIAFBA3ZBAWsMAQsgAWchBCABQR0gBGt2QQRzIARBAnRrQe4AaiABQf8fTQ0AGkE/IAFBHiAEa3ZBAnMgBEEBdGtBxwBqIgEgAUE/TxsLIgFBBHQiBEGwMmo2AgQgAyAEQbgyaiIEKAIANgIIIAQgAzYCACADKAIIIAM2AgRBuDpBuDopAwBCASABrYaENwMAIAAgAkEIaiIBNgIAIAFBfHEgAGpBBGsgATYCAAwBCyAAIAFqQQRrIAE2AgALIABBBGoFIAMLC3ACAX8BfSMAQRBrIgQkACAEQQhqIAAgAUECdEHEJWooAgAgAhAvQwAAwH8hBQJAAkACQCAELQAMQQFrDgIAAQILIAQqAgghBQwBCyAEKgIIIAOUQwrXIzyUIQULIARBEGokACAFQwAAAAAgBSAFWxsL5gMBBX8Cf0GAMCgCACIBIABBB2pBeHEiA2ohAgJAIANBACABIAJPGw0AIAI/AEEQdEsEQCACEBZFDQELQYAwIAI2AgAgAQwBC0HIO0EwNgIAQX8LIgJBf0cEQCAAIAJqIgNBEGsiAUEQNgIMIAFBEDYCAAJAAn9BsDooAgAiAAR/IAAoAggFQQALIAJGBEAgAiACQQRrKAIAQX5xayIEQQRrKAIAIQUgACADNgIIQXAgBCAFQX5xayIAIAAoAgBqQQRrLQAAQQFxRQ0BGiAAKAIEIgMgACgCCDYCCCAAKAIIIAM2AgQgACABIABrIgE2AgAMAgsgAkEQNgIMIAJBEDYCACACIAM2AgggAiAANgIEQbA6IAI2AgBBEAsgAmoiACABIABrIgE2AgALIAFBfHEgAGpBBGsgAUEBcjYCACAAAn8gACgCAEEIayIBQf8ATQRAIAFBA3ZBAWsMAQsgAUEdIAFnIgNrdkEEcyADQQJ0a0HuAGogAUH/H00NABpBPyABQR4gA2t2QQJzIANBAXRrQccAaiIBIAFBP08bCyIBQQR0IgNBsDJqNgIEIAAgA0G4MmoiAygCADYCCCADIAA2AgAgACgCCCAANgIEQbg6Qbg6KQMAQgEgAa2GhDcDAAsgAkF/RwvNAQIDfwJ9IwBBEGsiAyQAQQEhBCADQQhqIABB/ABqIgUgACABQQF0akEgaiIBLwEAEB8CQAJAIAMqAggiByACKgIAIgZcBEAgByAHWwRAIAItAAQhAgwCCyAGIAZcIQQLIAItAAQhAiAERQ0AIAMtAAwgAkH/AXFGDQELIAUgASAGIAIQNANAIAAtAAAiAUEEcQ0BIAAgAUEEcjoAACAAKAIQIgEEQCAAIAERAAALIABBgICA/gc2ApwBIAAoAtwDIgANAAsLIANBEGokAAtAAQF/AkBB+DotAABBAXEEQEH0OigCACECDAELQQFB0CYQDCECQfg6QQE6AABB9DogAjYCAAsgAiAAIAFBABATC8cBAgR/An0jAEEQayICJAAgAkEIaiAAQfwAaiIEIABBHmoiBS8BABAfQQEhAwJAAkAgAioCCCIHIAEqAgAiBlwEQCAHIAdbBEAgAS0ABCEBDAILIAYgBlwhAwsgAS0ABCEBIANFDQAgAi0ADCABQf8BcUYNAQsgBCAFIAYgARA0A0AgAC0AACIBQQRxDQEgACABQQRyOgAAIAAoAhAiAQRAIAAgAREAAAsgAEGAgID+BzYCnAEgACgC3AMiAA0ACwsgAkEQaiQACw8AIAEgACgCAGogAjkDAAsNACABIAAoAgBqKwMACwsAIAAEQCAAECgLCwYAIAAQKAuWAwIDfgJ/IAC9IgJCNIinQf8PcSIEQf8PRgRAIABEAAAAAAAA8D+iIgAgAKMPCyACQgGGIgFCgICAgICAgPD/AFgEQCAARAAAAAAAAAAAoiAAIAFCgICAgICAgPD/AFEbDwsCfiAERQRAQQAhBCACQgyGIgFCAFkEQANAIARBAWshBCABQgGGIgFCAFkNAAsLIAJBASAEa62GDAELIAJC/////////weDQoCAgICAgIAIhAshASAEQf8HSgRAA0ACQCABQoCAgICAgIAIfSIDQgBTDQAgAyIBQgBSDQAgAEQAAAAAAAAAAKIPCyABQgGGIQEgBEEBayIEQf8HSg0AC0H/ByEECwJAIAFCgICAgICAgAh9IgNCAFMNACADIgFCAFINACAARAAAAAAAAAAAog8LIAFC/////////wdYBEADQCAEQQFrIQQgAUKAgICAgICABFQhBSABQgGGIQEgBQ0ACwsgAkKAgICAgICAgIB/gyABQoCAgICAgIAIfSAErUI0hoQgAUEBIARrrYggBEEAShuEvwuLAQEDfwNAIABBBHQiAUG0MmogAUGwMmoiAjYCACABQbgyaiACNgIAIABBAWoiAEHAAEcNAAtBMBBaGkHkOkEGNgIAQeg6QQA2AgAQlAFB6DpBlDsoAgA2AgBBlDtB5Do2AgBBmDtBwAE2AgBBnDtBADYCABCFAUGcO0GUOygCADYCAEGUO0GYOzYCAAu9AwEHfyAABEAjAEEgayIGJAAgACgCACIBKALcAyIDBEAgAyABEGgaIAFBADYC3AMLIAEoAuQDIgIgASgC4AMiA0cEQEEBIAIgA2tBAnUiAiACQQFNGyEEQQAhAgNAIAMgAkECdGooAgBBADYC3AMgAkEBaiICIARHDQALCyABIAM2AuQDAkAgAyABQegDaiICKAIARg0AIAZBCGpBAEEAIAIQQiICKAIEIAEoAuQDIAEoAuADIgRrIgVrIgMgBCAFEDEhBSABKALgAyEEIAEgBTYC4AMgAiAENgIEIAEoAuQDIQUgASACKAIINgLkAyACIAU2AgggASgC6AMhByABIAIoAgw2AugDIAIgBDYCACACIAc2AgwgBCAFRwRAIAIgBSAEIAVrQQNqQXxxajYCCAsgBEUNACAEEGEgASgC4AMhAwsgAwRAIAEgAzYC5AMgAxBhCyABKAKUASEDIAFBADYClAEgAwRAIAMQUwsgARBhIAAoAgghASAAQQA2AgggAQRAIAEgASgCACgCBBEAAAsgACgCBCEBIABBADYCBCABBEAgASABKAIAKAIEEQAACyAGQSBqJAAgABAoCwupAQEBfyMAQRBrIgIkAAJ/IAEEQCABKAIAIQFBgAQQHiABEFQgAQ0BGiACQc0ZNgIAIAIQaxAnAAtB4DotAABFBEBByDpBAzYCAEHYOkKAgID8AzcCAEHQOkIANwIAQeA6QQE6AABBzDpBzDotAABB/gFxOgAAQcQ6QQA2AgALQYAEEB5BxDoQVAshASAAQgA3AgQgACABNgIAIAEgADYCBCACQRBqJAAgAAsbAQF/IAAEQCAAKAIAIgEEQCABECgLIAAQKAsLcQEBfyMAQRBrIgQkAAJ9QwAAAAAgAC8AFUGA4ABxRQ0AGiAEQQhqIABBFGoiAEEBIAJBAkZBAXQgAUH+AXFBAkcbIAIQLyAELQAMBEAgACABIAIgAxB4DAELIAAgASACIAMQd4wLIQMgBEEQaiQAIAMLYAECfwJAAkAgACgC4AMiAiAAKALkAyIDRg0AA0AgAigCACABRg0BIAJBBGoiAiADRw0ACwwBCyACIANGDQAgAiACQQRqIgEgAyABaxAxGiAAIANBBGs2AuQDQQEPC0EACwsAQZgxIAAgARBBCzwAIABFBEAgAkEFR0EAIAIbRQRAQYgwIAMgBBBBGg8LIAMgBBBpGg8LIAAgASACIAMgBCAAKAIEEQ0AGgsmAQF/IwBBEGsiASQAIAEgADYCDEGIMEGuJSAAEEEaIAFBEGokAAuHAwMDfwV8An0gACoCnAO7IgYgAqAhAiAAKgKYA7siByABoCEIIAAoAuwDKgIUIgtDAAAAAFwEQCAAKgKMA7shCSAAKgKIAyEMIAAgByALuyIBQQAgAC0AAEEQcSIDQQR2IgQQMjgCmAMgACAGIAFBACAEEDI4ApwDIAEgDLsiB6IQYiIGIAZiIgRFIAaZRC1DHOviNho/Y3FFBEAgBCAGRAAAAAAAAPC/oJlELUMc6+I2Gj9jRXIhBQsgAiAJoCEKIAggB6AhBwJ/IAEgCaIQYiIGIAZiIgRFBEBBACAGmUQtQxzr4jYaP2MNARoLIAQgBkQAAAAAAADwv6CZRC1DHOviNho/Y0VyCyEEIAAgByABIANBAEciAyAFcSADIAVBAXNxEDIgCCABQQAgAxAykzgCiAMgACAKIAEgAyAEcSADIARBAXNxEDIgAiABQQAgAxAykzgCjAMLIAAoAuADIgMgACgC5AMiAEcEQANAIAMoAgAgCCACEGwgA0EEaiIDIABHDQALCwuZAgIGfwF9IABBFGohB0EDIQQgAC0AFEECdkEDcSEFAkACfwJAIAFBASAAKALcAxsiCEECRgRAAkAgBUECaw4CBAACC0ECIQQMAwtBAiEEQQAgBUEBSw0BGgsgBAshBiAFIQQLIAAgBCAIIAMgAiAEQQJJIgUbEGchCiAAIAYgCCACIAMgBRsQZyEDIABBmANqIgBBASABQQJGQQF0IgggBRtBAnRqIAogByAEIAEgAhAkkjgCACAAQQMgAUECR0EBdCIJIAUbQQJ0aiAKIAcgBCABIAIQI5I4AgAgACAIQQEgBkEBdiIEG0ECdGogAyAHIAYgASACECSSOAIAIAAgCUEDIAQbQQJ0aiADIAcgBiABIAIQI5I4AgALvwIBA38jAEHAAmsiASQAIAFBAEHAAhAwIgFBgICA/gc2AgQgAUEQakEAQcQBEDAaIAFB1AFqIQMgAUEUaiECA0AgAkKAgID8i4CAwL9/NwIQIAJCgYCAgBA3AgggAkKAgID8i4CAwL9/NwIAIAJBGGoiAiADRw0ACyABQoCAgPyLgIDAv383AuQBIAFCgYCAgBA3AtwBIAFCgICA/IuAgMC/fzcC1AEgAUKAgID+h4CA4P8ANwP4ASABQoCAgP6HgIDg/wA3A/ABIAEgAS0A7AFB+AFxOgDsASABQYACakEAQcAAEDAaIABBmAFqIAFBwAIQLBogAEIANwKIAyAAIAAtAABBAXI6AAAgABBzIAAoAuADIgIgACgC5AMiAEcEQANAIAIoAgAQbiACQQRqIgIgAEcNAAsLIAFBwAJqJAALrgICCn8CfSMAQSBrIgEkACABQYACOwAeIABB7gBqIQcgAEHwA2ohBSAAQfIAaiEIIABB9gBqIQkgAEH8AGohA0EAIQADQCABQRBqIAMgCSABQR5qIARqLQAAIgJBAXQiBGoiBi8BABAfAkACQCABLQAURQ0AIAFBCGogAyAGLwEAEB8gASADIAQgCGovAQAQHyABLQAMIAEtAARHDQACQCABKgIIIgwgDFwiCiABKgIAIgsgC1xyRQRAIAwgC5OLQxe30ThdDQEMAgsgCkUgCyALW3INAQsgAUEQaiADIAYvAQAQHwwBCyABQRBqIAMgBCAHai8BABAfCyAFIAJBA3RqIgIgAS0AFDoABCACIAEoAhA2AgBBASEEIAAhAkEBIQAgAkUNAAsgAUEgaiQACzIAAn9BACAALwAVQYDgAHFBgMAARg0AGkEBIAAQN0MAAAAAXA0AGiAAEDtDAAAAAFwLC48CAgJ/AX0jAEEQayIFJAAgAiADkyICIAJbBEAgBUEIaiAAQfwAaiIGIAAgAUEBdGovAXIQHwJ9AkACQAJ9AkACQCAFLQAMQQFrDgIAAQMLIAUqAggMAQsgBSoCCCAElEMK1yM8lAsiByAHWw0BC0MAAAAADAELIAcgA5MLIQcgBUEIaiAGIAAgAUEBdGovAXYQHyAHAn0CQAJAAn0CQAJAIAUtAAxBAWsOAgABAwsgBSoCCAwBCyAFKgIIIASUQwrXIzyUCyIEIARbDQELQ///f38MAQsgBCADkwsiAyACIAIgA14bIgIgAiAHXRsgByACIAIgAlwbIAIgAlsgByAHW3EbIQILIAVBEGokACACC3YCAX8BfSMAQRBrIgQkACAEQQhqIAAgAUECdEG0JWooAgAgAhBKQwAAwH8hBQJAAkACQCAELQAMQQFrDgIAAQILIAQqAgghBQwBCyAEKgIIIAOUQwrXIzyUIQULIARBEGokACAFQwAAAACXQwAAAAAgBSAFWxsLoQMBCH8CQCAAKALgAyIFIAAoAuQDIgdHBEADQCAAIAUoAgAiAigC3ANHBEACQCAAKALsAygCACIBBEAgAiAAIAYgAREGACIBDQELQYAEEB4iASACKAIQNgIQIAEgAikCCDcCCCABIAIpAgA3AgAgAUEUaiACQRRqQegAECwaIAFCADcCgAEgAUH8AGoiA0EAOwEAIAFCADcCiAEgAUIANwKQASADIAJB/ABqEJcBIAFBmAFqIAJBmAFqQcgCECwaIAFBADYC6AMgAUIANwLgAyACKALkAyIDIAIoAuADIgRHBEAgAyAEayIEQQBIDQUgASAEEB4iAzYC5AMgASADNgLgAyABIAMgBGo2AugDIAIoAuADIgQgAigC5AMiCEcEQANAIAMgBCgCADYCACADQQRqIQMgBEEEaiIEIAhHDQALCyABIAM2AuQDCyABIAIpAuwDNwLsAyABIAIoAvwDNgL8AyABIAIpAvQDNwL0AyABQQA2AtwDCyAFIAE2AgAgASAANgLcAwsgBkEBaiEGIAVBBGoiBSAHRw0ACwsPCxACAAvfBQMEfwV9AXwgCUMAAAAAXSAIQwAAAABdcgR/IA0FIAUhEiABIRMgAyEUIAchESAMKgIUIhVDAAAAAFwEQCABuyAVuyIWQQBBABAyIRMgA7sgFkEAQQAQMiEUIAW7IBZBAEEAEDIhEiAHuyAWQQBBABAyIRELAn9BACAAIARHDQAaIBIgE5OLQxe30ThdIBMgE1wiDSASIBJcckUNABpBACASIBJbDQAaIA0LIQwCQCACIAZHDQAgFCAUXCINIBEgEVxyRQRAIBEgFJOLQxe30ThdIQ8MAQsgESARWw0AIA0hDwtBASEOQQEhDQJAIAwNACABIAqTIQECQCAARQRAIAEgAVwiACAIIAhcckUEQEEAIQwgASAIk4tDF7fROF1FDQIMAwtBACEMIAggCFsNASAADQIMAQsgAEECRiEMIABBAkcNACAEQQFHDQAgASAIYA0BAkAgCCAIXCIAIAEgAVxyRQRAIAEgCJOLQxe30ThdRQ0BDAMLQQAhDSABIAFbDQJBASENIAANAgtBACENDAELQQAhDSAIIAhcIgAgASAFXUVyDQAgDEUgASABXCIQIAUgBVxyIARBAkdycg0AQQEhDSABIAhgDQBBACENIAAgEHINACABIAiTi0MXt9E4XSENCwJAIA8NACADIAuTIQECQAJAIAJFBEAgASABXCICIAkgCVxyRQRAQQAhACABIAmTi0MXt9E4XUUNAgwEC0EAIQAgCSAJWw0BIAINAwwBCyACQQJGIQAgAkECRyAGQQFHcg0AIAEgCWAEQAwDCyAJIAlcIgAgASABXHJFBEAgASAJk4tDF7fROF1FDQIMAwtBACEOIAEgAVsNAkEBIQ4gAA0CDAELIAkgCVwiAiABIAddRXINACAARSABIAFcIgQgByAHXHIgBkECR3JyDQAgASAJYA0BQQAhDiACIARyDQEgASAJk4tDF7fROF0hDgwBC0EAIQ4LIA0gDnELC5kBAQN/AkAgAC0AFEEIcUUNAEEBIQEgAC8AFUHwAXFB0ABGDQBBACEBIAAoAuQDIgIgACgC4AMiA0YNAEEBIAIgA2tBAnUiACAAQQFNGyECQQAhAANAIAMgAEECdGooAgAiAS8AFSABLQAXQRB0ciIBQYDgAHFBgMAARyABQYAecUGACkZxIgENASAAQQFqIgAgAkcNAAsLIAEL/xICDX8KfSMAQRBrIg4kACABKALgAyIUIAEoAuQDIhVHBEAgA0EBIAMbIRYgAEEUaiETIAVBAWohFwNAAkAgFCgCACILLwAVIAstABdBEHRyIgxBgIAQcQ0AAkACfwJAAkACQAJAAkACQAJAIAxBDHZBA3EOAwEJAAkLIAkhGiAKIR0gASgC7AMtABBBBHFFBEAgACoCkAMgE0ECQQEQIiATQQJBARAhkpMhGiAAKgKUAyATQQBBARAiIBNBAEEBECGSkyEdCyALQRRqIQ0gAS0AFEECdkEDcSEMAkACfwJAIANBAkciEkUEQEEAIQ9BAyEQAkAgDEECaw4CBAACC0ECIRAMAwtBAiEQQQAgDEEBSw0BGgsgEAshDyAMIRALIA1BAkEBIBoQJCANQQJBASAaECOSIR8gDUEAQQEgGhAkIR4gDUEAQQEgGhAjISAgCyoC8AMiGCEZAkACQAJAAkAgCy0A9ANBAWsiDA4CAQACCyAYIBqUQwrXIzyUIRkLIBlDAAAAAGBFDQBDAADAfyEZAkACQAJAIAwOAgABAgsgGCEZDAELIBggGpRDCtcjPJQhGQsgHyAZkiEZDAELIA5BCGogDSALQTJqIgwgAxBGQwAAwH8hGSAOLQAMRQ0AIA5BCGogDSAMIAMQRSAOLQAMRQ0AIAAqApADISEgE0ECIAMQNSEcIBNBAiADEEshGyANQQIgAyAaED0hGSANQQIgAyAaEFkhGCAOQQhqIAtB/ABqIgwgCy8BchAfIBkgGJIhGSAhIBwgG5KTIRhDAADAfyEcAkACQAJAIA4tAAxBAWsOAgABAgsgDioCCCEcDAELIA4qAgggGpRDCtcjPJQhHAsgGCAZkyEYIA5BCGogDCALLwF2EB8CQAJAAn0CQAJAIA4tAAxBAWsOAgABAwsgDioCCAwBCyAOKgIIIBqUQwrXIzyUCyIZQwAAAABgRQ0AIBggGV4NAQsgHEMAAAAAYEUEQCAYIRkMAQsgHCAYIBggHF0bIRkLIA1BAiADIBoQJiANQQIgAxAikiANQQIgAyAaECUgDUECIAMQIZKSIhggGSAYIBleGyAYIBkgGSAZXBsgGSAZWyAYIBhbcRshGQsgHiAgkiEeIAsqAvgDIhshGAJAAkACQCALLQD8A0EBayIMDgIBAAILIBsgHZRDCtcjPJQhGAsgGEMAAAAAYEUNAEMAAMB/IRgCQAJAAkAgDA4CAAECCyAbIRgMAQsgGyAdlEMK1yM8lCEYCyAeIBiSIRgMAgsgDkEIaiANIAtBMmoiDBBEAkAgDi0ADEUNACAOQQhqIA0gDBBDIA4tAAxFDQAgACoClAMhICATQQAgAxA1ISEgE0EAIAMQSyEcIA1BACADIB0QPSEbIA1BACADIB0QWSEYIA5BCGogC0H8AGoiDCALLwF0EB8gGyAYkiEbICAgISAckpMhGEMAAMB/IRwCQAJAAkAgDi0ADEEBaw4CAAECCyAOKgIIIRwMAQsgDioCCCAdlEMK1yM8lCEcCyAYIBuTIRsgDkEIaiAMIAsvAXgQHwJAAkACfQJAAkAgDi0ADEEBaw4CAAEDCyAOKgIIDAELIA4qAgggHZRDCtcjPJQLIhhDAAAAAGBFDQAgGCAbXQ0BCyAcQwAAAABgRQRAIBshGAwBCyAcIBsgGyAcXRshGAsgDUEAIAMgGhAmIA1BACADECKSIA1BACADIBoQJSANQQAgAxAhkpIiGyAYIBggG10bIBsgGCAYIBhcGyAYIBhbIBsgG1txGyEYDAILQwAAwH8hGCAZIBlcDQUgC0H8AGoiDCALQfoAaiIRLwEAECAiGyAbWw0CDAQLIAstAABBCHENByAAIAsgAiALLQAUQQNxIgwgFiAMGyAEIBcgBiALKgKYAyAHkiALKgKcAyAIkiAJIAoQdgwHCyAZIBlcIBggGFxGDQEgC0H8AGoiDCALQfoAaiIRLwEAECAiGyAbXA0BIBkgGVwEQCAYIB6TIAwgCy8BehAglCAfkiEZDAILIBggGFsNAQsgHiAZIB+TIAwgES8BABAglZIhGAsgGSAZXA0BIBggGFsNAwtBAAwBC0EBCyEMIAsgGiAZIAJBAUcgEEECSXEgGkMAAAAAXnEgDHEiERsgGCADQQIgDCARGyAYIBhcIBogHUEAQQYgBCAFIAYQOBogCyoCkAMgDUECQQEgGhAkIA1BAkEBIBoQI5KSIRkgCyoClAMgDUEAQQEgGhAkIA1BAEEBIBoQI5KSIRgLIAsgGSAYIANBAEEAIBogHUEBQQEgBCAFIAYQOBogACABIAsgAyAQQQEgGiAdEHkgACABIAsgAyAPQQAgGiAdEHkgAS0AFCIRQQJ2QQNxIQwCQAJ/AkACQAJAAkACQAJAAkACQAJAAn8CQCASRQRAQQAhEEEDIQ8gDEECaw4CAw0BC0ECIQ9BACAMQQFLDQEaCyAPCyEQIBFBBHFFDQQgEUEIcUUNASAMIQ8LIAEhDCANEFcNAQwCCwJAIAstADRBB3ENACALLQA4QQdxDQAgCy0AQkEHcQ0AIAwhDyABIQwgC0FAay8BAEEHcUUNAgwBCyAMIQ8LIAAhDAsCfwJAAkACQCAPQQFrDgMAAQIFCyALQZQDaiEPIAtBpANqIRJBASERIAxBlANqDAILIAtBkANqIQ8gC0GYA2ohEkECIREgDEGQA2oMAQsgC0GQA2ohDyALQaADaiESQQAhESAMQZADagshDCALIBFBAnRqIAwqAgAgDyoCAJMgEioCAJM4ApgDCyAQQQFxRQ0FAkACQCAQQQJxBEAgASEMIA0QVw0BDAILIAstADRBB3ENACALLQA4QQdxDQAgCy0AQkEHcQ0AIAEhDCALQUBrLwEAQQdxRQ0BCyAAIQwLIBBBAWsOAwECAwALECcACyALQZQDaiEQIAtBpANqIQ9BASESIAxBlANqDAILIAtBkANqIRAgC0GYA2ohD0ECIRIgDEGQA2oMAQsgC0GQA2ohECALQaADaiEPQQAhEiAMQZADagshDCALIBJBAnRqIAwqAgAgECoCAJMgDyoCAJM4ApgDCyALKgKcAyEbIAsqApgDIAdDAAAAACANEFcbkyEZAn0CQCALLQA0QQdxDQAgCy0AOEEHcQ0AIAstAEJBB3ENACALQUBrLwEAQQdxDQBDAAAAAAwBCyAICyEYIAsgGTgCmAMgCyAbIBiTOAKcAwsgFEEEaiIUIBVHDQALCyAOQRBqJAALeAIBfwF9IwBBEGsiBCQAIARBCGogAEEDIAJBAkdBAXQgAUH+AXFBAkcbIAIQL0MAAMB/IQUCQAJAAkAgBC0ADEEBaw4CAAECCyAEKgIIIQUMAQsgBCoCCCADlEMK1yM8lCEFCyAEQRBqJAAgBUMAAAAAIAUgBVsbC3gCAX8BfSMAQRBrIgQkACAEQQhqIABBASACQQJGQQF0IAFB/gFxQQJHGyACEC9DAADAfyEFAkACQAJAIAQtAAxBAWsOAgABAgsgBCoCCCEFDAELIAQqAgggA5RDCtcjPJQhBQsgBEEQaiQAIAVDAAAAACAFIAVbGwuLEwIGfwR9IwBBEGsiCiQAIARB/gFxIQwCQAJAAkACQAJAIAIoAuwDLQAQQQJxBEAgBQ0BIAIvABZBD3EiCSEFAn8gCUUEQCABLQAVQQR2IQULIAVBBUYEQEEBIAEtABRBCHFFDQEaCyAFC0ECRiEIAn8gCUUEQCABLQAVQQR2IQkLIAlBBUYEQEEBIAEtABRBCHFFDQEaCyAJC0EDRiABLwAVQYCAA3FBgIACRnMhCQwDC0EBIQkgCkEIaiACQRRqIgggA0ECRkEBdEEBIAxBAkYiDRsiCyADEC8gBiAHIA0bIQcgCi0ADARAIAggBCADIAcQeCAAQRRqIAQgAxAikiAIIAQgAyAHECSSIQYCQAJ/AkACQAJAAkAgBA4EAgMBAAoLQQIhCQwBC0EAIQkLIAkgC0YNAgJAAkAgBA4EAgIAAQkLIABBkANqIQNBAAwCCyAAQZADaiEDQQAMAQsgAEGUA2ohA0EBCyEAIAMqAgAgAiAAQQJ0aioCkAOTIAaTIQYLIAIgBEECdEG0JWooAgBBAnRqIAY4ApgDDAULIApBCGogCEEDIANBAkdBAXQgDEECRxsgAxAvIAotAAwEQAJ/AkACQAJAIAQOBAICAAEIC0EAIQUgAEGQA2oMAgtBACEFIABBkANqDAELQQEhBSAAQZQDagsqAgAgAkGQA2oiASAFQQJ0aioCAJMgAEEUaiAEIAMQIZMgCCAEIAMgBxAjkyAIIAQgAyAHEHeTIQZBASEDAkACfwJAAkACQAJAIAQOBAIDAQAKC0ECIQMMAQtBACEDCyADIAtGDQICQAJAIAQOBAICAAEJCyAAQZADaiEDQQAMAgsgAEGQA2ohA0EADAELIABBlANqIQNBAQshACADKgIAIAEgAEECdGoqAgCTIAaTIQYLIAIgBEECdEG0JWooAgBBAnRqIAY4ApgDDAULAkACQAJAIAUEQCABLQAUQQR2QQdxIgBBBUsNCEEBIAB0IgBBMnENASAAQQlxRQ0DIAggBCADIAYQMyEGIAICfwJAAkACQAJAIAQOBAABAgMMCyABQcwDaiEEIAFBvANqIQNBAQwDCyABQdQDaiEEIAFBxANqIQNBAwwCCyABQcgDaiEEIAFBuANqIQNBAAwBCyABQdADaiEEIAFBwANqIQNBAgtBAnRqIAYgAyoCAJIgBCoCAJI4ApgDDAgLIAIvABZBD3EiAEUEQCABLQAVQQR2IQALIABBBUYEQCABLQAUQQhxRQ0CCyABLwAVQYCAA3FBgIACRgRAIABBAmsOAgEFAwsgAEEISw0HQQEgAHRB8wNxDQQgAEECRw0CC0EAIQgCQAJAAkACQAJAAkACQCAEDgQBAQAEAgsgASoCkAMgAUG4A2oiACoCAJMgASoCwAOTIAFByANqIgkqAgCTIQcgAioCkAMhDiABKgLQAyEPIAJBFGoiBUECQQEgBhAkIRAgBUECQQEgBhAjIREMBQsgASoClAMhBwJ/AkACQCAEDgIAAQMLIAcgASoCvAOTIAEqAsQDkyEHQQMhACABQcwDagwBCyAHIAEqAsQDkyABKgK8A5MhB0EBIQAgAUHUA2oLIQUgAUHIA2oiCSAAQQJ0aioCACEPIAFBuANqIQAgByAFKgIAkyEHIAIqApQDIQ4gAkEUaiIFIARBASAGECQhECAFIARBASAGECMhEQJAIAQOBAACBQQBCyABQcwDaiEJIAFBvANqIQBBASEIDAQLECcACyABQdQDaiEJIAFBxANqIQBBAyEIDAILIAEqApADIAEqAsADkyABKgK4A5MgASoC0AOTIQcgAioCkAMhDiABKgLIAyEPIAJBFGoiBUEDQQEgBhAkIRAgBUEDQQEgBhAjIRELIAFB0ANqIQkgAUHAA2ohAEECIQgLIAIgCEECdGogByAPkyAOIBAgEZKSk0MAAAA/lCAAKgIAkiAJKgIAkiAFIAQgAyAGEDOSOAKYAwwGCyABLwAVQYCAA3FBgIACRw0CCwJ/AkACQAJAAkACQCAEDgQAAgMEAQsgASoCxAMgASoC1AOSIAJBFGpBACADIAYQPJIhBiACQZQDaiEAQQEhAyABQZQDagwECxAnAAsgASoCvAMgASoCzAOSIAJBFGpBASADIAYQPJIhBiACQZQDaiEAQQMhAyABQZQDagwCCyABKgLAAyABKgLQA5IgAkEUakECIAMgBhA8kiEGIAJBkANqIQBBACEDIAFBkANqDAELIAEqArgDIAEqAsgDkiACQRRqQQMgAyAGEDySIQYgAkGQA2ohAEECIQMgAUGQA2oLIQEgAiADQQJ0aiABKgIAIAAqAgCTIAaTOAKYAwwECyABLQAUQfAAcSIFQSBGIQkgBUEQRiEIDAELIAggBCADIAYQMyEGIAICfwJAAkACQAJAIAQOBAABAgMGCyABQcwDaiEEIAFBvANqIQNBAQwDCyABQdQDaiEEIAFBxANqIQNBAwwCCyABQcgDaiEEIAFBuANqIQNBAAwBCyABQdADaiEEIAFBwANqIQNBAgtBAnRqIAYgAyoCAJIgBCoCAJI4ApgDDAILIApBCGogAkEUaiILIARBAnQiBUHEJWooAgAgAxAvAkAgCi0ADEUEQCAFQbQlaigCACEFDAELIApBCGogCyAFQbQlaigCACIFIAMQLyAKLQAMDQACfwJAAkACQCAEDgQCAgABBQtBACEIIABBkANqDAILQQAhCCAAQZADagwBC0EBIQggAEGUA2oLIQEgAkGYAWoiAiAFQQJ0aiABKgIAIAIgCEECdGoqAvgBkyAAQRRqIAQgAxBLkyALIAQgAyAGIAcgDEECRhsiBhA8kyALIAQgAyAGEFmTOAKAAgwCCyAKQQhqIAsgBSADEC8gCEUgCi0ADEEAR3JFBEACQAJAAkACQCAEDgQBAQIABQsgASoCkAMgAioCkAOTIQZBAiEDDAILIAEqApQDIAIqApQDkyEGQQEhAwJAIAQOAgIABAtBAyEDDAELIAEqApADIAIqApADkyEGQQAhAwsgAiADQQJ0aiAGQwAAAD+UOAKYAwwCCyAKQQhqIAsgBSADEC8gCi0ADCAJQQFzcg0BAkACQAJAAkAgBA4EAQECAAQLIAEqApADIAIqApADkyEGQQIhAwwCCyABKgKUAyACKgKUA5MhBkEBIQMCQCAEDgICAAMLQQMhAwwBCyABKgKQAyACKgKQA5MhBkEAIQMLIAIgA0ECdGogBjgCmAMMAQsQJwALIApBEGokAAvOAQIDfwJ9IwBBEGsiAyQAQQEhBCADQQhqIABB/ABqIgUgACABQQF0akHoAGoiAS8BABAfAkACQCADKgIIIgcgAioCACIGXARAIAcgB1sEQCACLQAEIQIMAgsgBiAGXCEECyACLQAEIQIgBEUNACADLQAMIAJB/wFxRg0BCyAFIAEgBiACEDQDQCAALQAAIgFBBHENASAAIAFBBHI6AAAgACgCECIBBEAgACABEQAACyAAQYCAgP4HNgKcASAAKALcAyIADQALCyADQRBqJAALHAAgACABQQggAqcgAkIgiKcgA6cgA0IgiKcQFQsFABBQAAvOAQIDfwJ9IwBBEGsiAyQAQQEhBCADQQhqIABB/ABqIgUgACABQQF0akHEAGoiAS8BABAfAkACQCADKgIIIgcgAioCACIGXARAIAcgB1sEQCACLQAEIQIMAgsgBiAGXCEECyACLQAEIQIgBEUNACADLQAMIAJB/wFxRg0BCyAFIAEgBiACEDQDQCAALQAAIgFBBHENASAAIAFBBHI6AAAgACgCECIBBEAgACABEQAACyAAQYCAgP4HNgKcASAAKALcAyIADQALCyADQRBqJAALOQAgAEUEQEEADwsCfyABQYB/cUGAvwNGIAFB/wBNckUEQEHIO0EZNgIAQX8MAQsgACABOgAAQQELC8QCAAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAIAFBCWsOEgAKCwwKCwIDBAUMCwwMCgsHCAkLIAIgAigCACIBQQRqNgIAIAAgASgCADYCAA8LAAsgAiACKAIAIgFBBGo2AgAgACABMgEANwMADwsgAiACKAIAIgFBBGo2AgAgACABMwEANwMADwsgAiACKAIAIgFBBGo2AgAgACABMAAANwMADwsgAiACKAIAIgFBBGo2AgAgACABMQAANwMADwsACyACIAIoAgBBB2pBeHEiAUEIajYCACAAIAErAwA5AwAPCyAAIAIgAxECAAsPCyACIAIoAgAiAUEEajYCACAAIAE0AgA3AwAPCyACIAIoAgAiAUEEajYCACAAIAE1AgA3AwAPCyACIAIoAgBBB2pBeHEiAUEIajYCACAAIAEpAwA3AwALXQEEfyAAKAIAIQIDQCACLAAAIgMQTwRAQX8hBCAAIAJBAWoiAjYCACABQcyZs+YATQR/QX8gA0EwayIDIAFBCmwiBGogAyAEQf////8Hc0obBSAECyEBDAELCyABC6oUAhJ/AX4jAEHQAGsiCCQAIAggATYCTCAIQTdqIRcgCEE4aiEUAkACQAJAAkADQCABIQ0gByAOQf////8Hc0oNASAHIA5qIQ4CQAJAAkAgDSIHLQAAIgkEQANAAkACQCAJQf8BcSIBRQRAIAchAQwBCyABQSVHDQEgByEJA0AgCS0AAUElRwRAIAkhAQwCCyAHQQFqIQcgCS0AAiEKIAlBAmoiASEJIApBJUYNAAsLIAcgDWsiByAOQf////8HcyIYSg0HIAAEQCAAIA0gBxApCyAHDQYgCCABNgJMIAFBAWohB0F/IRICQCABLAABIgoQT0UNACABLQACQSRHDQAgAUEDaiEHIApBMGshEkEBIRULIAggBzYCTEEAIQwCQCAHLAAAIglBIGsiAUEfSwRAIAchCgwBCyAHIQpBASABdCIBQYnRBHFFDQADQCAIIAdBAWoiCjYCTCABIAxyIQwgBywAASIJQSBrIgFBIE8NASAKIQdBASABdCIBQYnRBHENAAsLAkAgCUEqRgRAAn8CQCAKLAABIgEQT0UNACAKLQACQSRHDQAgAUECdCAEakHAAWtBCjYCACAKQQNqIQlBASEVIAosAAFBA3QgA2pBgANrKAIADAELIBUNBiAKQQFqIQkgAEUEQCAIIAk2AkxBACEVQQAhEwwDCyACIAIoAgAiAUEEajYCAEEAIRUgASgCAAshEyAIIAk2AkwgE0EATg0BQQAgE2shEyAMQYDAAHIhDAwBCyAIQcwAahCAASITQQBIDQggCCgCTCEJC0EAIQdBfyELAn8gCS0AAEEuRwRAIAkhAUEADAELIAktAAFBKkYEQAJ/AkAgCSwAAiIBEE9FDQAgCS0AA0EkRw0AIAFBAnQgBGpBwAFrQQo2AgAgCUEEaiEBIAksAAJBA3QgA2pBgANrKAIADAELIBUNBiAJQQJqIQFBACAARQ0AGiACIAIoAgAiCkEEajYCACAKKAIACyELIAggATYCTCALQX9zQR92DAELIAggCUEBajYCTCAIQcwAahCAASELIAgoAkwhAUEBCyEPA0AgByERQRwhCiABIhAsAAAiB0H7AGtBRkkNCSAQQQFqIQEgByARQTpsakHPKmotAAAiB0EBa0EISQ0ACyAIIAE2AkwCQAJAIAdBG0cEQCAHRQ0LIBJBAE4EQCAEIBJBAnRqIAc2AgAgCCADIBJBA3RqKQMANwNADAILIABFDQggCEFAayAHIAIgBhB/DAILIBJBAE4NCgtBACEHIABFDQcLIAxB//97cSIJIAwgDEGAwABxGyEMQQAhEkGPCSEWIBQhCgJAAkACQAJ/AkACQAJAAkACfwJAAkACQAJAAkACQAJAIBAsAAAiB0FfcSAHIAdBD3FBA0YbIAcgERsiB0HYAGsOIQQUFBQUFBQUFA4UDwYODg4UBhQUFBQCBQMUFAkUARQUBAALAkAgB0HBAGsOBw4UCxQODg4ACyAHQdMARg0JDBMLIAgpA0AhGUGPCQwFC0EAIQcCQAJAAkACQAJAAkACQCARQf8BcQ4IAAECAwQaBQYaCyAIKAJAIA42AgAMGQsgCCgCQCAONgIADBgLIAgoAkAgDqw3AwAMFwsgCCgCQCAOOwEADBYLIAgoAkAgDjoAAAwVCyAIKAJAIA42AgAMFAsgCCgCQCAOrDcDAAwTC0EIIAsgC0EITRshCyAMQQhyIQxB+AAhBwsgFCENIAgpA0AiGVBFBEAgB0EgcSEQA0AgDUEBayINIBmnQQ9xQeAuai0AACAQcjoAACAZQg9WIQkgGUIEiCEZIAkNAAsLIAxBCHFFIAgpA0BQcg0DIAdBBHZBjwlqIRZBAiESDAMLIBQhByAIKQNAIhlQRQRAA0AgB0EBayIHIBmnQQdxQTByOgAAIBlCB1YhDSAZQgOIIRkgDQ0ACwsgByENIAxBCHFFDQIgCyAUIA1rIgdBAWogByALSBshCwwCCyAIKQNAIhlCAFMEQCAIQgAgGX0iGTcDQEEBIRJBjwkMAQsgDEGAEHEEQEEBIRJBkAkMAQtBkQlBjwkgDEEBcSISGwshFiAZIBQQPyENCyAPQQAgC0EASBsNDiAMQf//e3EgDCAPGyEMIAgpA0AiGUIAUiALckUEQCAUIQ1BACELDAwLIAsgGVAgFCANa2oiByAHIAtIGyELDAsLQQAhDAJ/Qf////8HIAsgC0H/////B08bIgoiEUEARyEQAkACfwJAAkAgCCgCQCIHQeQkIAcbIg0iD0EDcUUgEUVyDQADQCAPLQAAIgxFDQIgEUEBayIRQQBHIRAgD0EBaiIPQQNxRQ0BIBENAAsLIBBFDQICQCAPLQAARSARQQRJckUEQANAIA8oAgAiB0F/cyAHQYGChAhrcUGAgYKEeHENAiAPQQRqIQ8gEUEEayIRQQNLDQALCyARRQ0DC0EADAELQQELIRADQCAQRQRAIA8tAAAhDEEBIRAMAQsgDyAMRQ0CGiAPQQFqIQ8gEUEBayIRRQ0BQQAhEAwACwALQQALIgcgDWsgCiAHGyIHIA1qIQogC0EATgRAIAkhDCAHIQsMCwsgCSEMIAchCyAKLQAADQ0MCgsgCwRAIAgoAkAMAgtBACEHIABBICATQQAgDBArDAILIAhBADYCDCAIIAgpA0A+AgggCCAIQQhqIgc2AkBBfyELIAcLIQlBACEHAkADQCAJKAIAIg1FDQEgCEEEaiANEH4iCkEASCINIAogCyAHa0tyRQRAIAlBBGohCSALIAcgCmoiB0sNAQwCCwsgDQ0NC0E9IQogB0EASA0LIABBICATIAcgDBArIAdFBEBBACEHDAELQQAhCiAIKAJAIQkDQCAJKAIAIg1FDQEgCEEEaiANEH4iDSAKaiIKIAdLDQEgACAIQQRqIA0QKSAJQQRqIQkgByAKSw0ACwsgAEEgIBMgByAMQYDAAHMQKyATIAcgByATSBshBwwICyAPQQAgC0EASBsNCEE9IQogACAIKwNAIBMgCyAMIAcgBREaACIHQQBODQcMCQsgCCAIKQNAPAA3QQEhCyAXIQ0gCSEMDAQLIActAAEhCSAHQQFqIQcMAAsACyAADQcgFUUNAkEBIQcDQCAEIAdBAnRqKAIAIgAEQCADIAdBA3RqIAAgAiAGEH9BASEOIAdBAWoiB0EKRw0BDAkLC0EBIQ4gB0EKTw0HA0AgBCAHQQJ0aigCAA0BIAdBAWoiB0EKRw0ACwwHC0EcIQoMBAsgCyAKIA1rIhAgCyAQShsiCSASQf////8Hc0oNAkE9IQogEyAJIBJqIgsgCyATSBsiByAYSg0DIABBICAHIAsgDBArIAAgFiASECkgAEEwIAcgCyAMQYCABHMQKyAAQTAgCSAQQQAQKyAAIA0gEBApIABBICAHIAsgDEGAwABzECsMAQsLQQAhDgwDC0E9IQoLQcg7IAo2AgALQX8hDgsgCEHQAGokACAOC9kCAQR/IwBB0AFrIgUkACAFIAI2AswBIAVBoAFqIgJBAEEoEDAaIAUgBSgCzAE2AsgBAkBBACABIAVByAFqIAVB0ABqIAIgAyAEEIEBQQBIBEBBfyEEDAELQQEgBiAAKAJMQQBOGyEGIAAoAgAhByAAKAJIQQBMBEAgACAHQV9xNgIACwJ/AkACQCAAKAIwRQRAIABB0AA2AjAgAEEANgIcIABCADcDECAAKAIsIQggACAFNgIsDAELIAAoAhANAQtBfyAAEJMBDQEaCyAAIAEgBUHIAWogBUHQAGogBUGgAWogAyAEEIEBCyECIAgEQCAAQQBBACAAKAIkEQYAGiAAQQA2AjAgACAINgIsIABBADYCHCAAKAIUIQEgAEIANwMQIAJBfyABGyECCyAAIAAoAgAiACAHQSBxcjYCAEF/IAIgAEEgcRshBCAGRQ0ACyAFQdABaiQAIAQLfwIBfwF+IAC9IgNCNIinQf8PcSICQf8PRwR8IAJFBEAgASAARAAAAAAAAAAAYQR/QQAFIABEAAAAAAAA8EOiIAEQgwEhACABKAIAQUBqCzYCACAADwsgASACQf4HazYCACADQv////////+HgH+DQoCAgICAgIDwP4S/BSAACwsVACAARQRAQQAPC0HIOyAANgIAQX8LzwMAQaA7Qf4bEBxBoTtB+hVBAUEBQQAQG0GiO0H9EkEBQYB/Qf8AEARBoztB9hJBAUGAf0H/ABAEQaQ7QfQSQQFBAEH/ARAEQaU7QZQKQQJBgIB+Qf//ARAEQaY7QYsKQQJBAEH//wMQBEGnO0GxCkEEQYCAgIB4Qf////8HEARBqDtBqApBBEEAQX8QBEGpO0HoGEEEQYCAgIB4Qf////8HEARBqjtB3xhBBEEAQX8QBEGrO0GPEEKAgICAgICAgIB/Qv///////////wAQe0GsO0GOEEIAQn8Qe0GtO0GIEEEEEA1BrjtByhtBCBANQa87QfoYEA5BsDtB7yEQDkGxO0EEQe0YEAhBsjtBAkGGGRAIQbM7QQRBlRkQCEG0O0H/FRAaQbU7QQBBqiEQAUG2O0EAQZAiEAFBtztBAUHIIRABQbg7QQJBuh4QAUG5O0EDQdkeEAFBujtBBEGBHxABQbs7QQVBnh8QAUG8O0EEQbUiEAFBvTtBBUHTIhABQbY7QQBBhCAQAUG3O0EBQeMfEAFBuDtBAkHGIBABQbk7QQNBpCAQAUG6O0EEQYkhEAFBuztBBUHnIBABQb47QQZBxB8QAUG/O0EHQfoiEAELzQECA38CfSMAQRBrIgMkAEEBIQQgA0EIaiAAQfwAaiIFIAAgAUEBdGpBMmoiAS8BABAfAkACQCADKgIIIgcgAioCACIGXARAIAcgB1sEQCACLQAEIQIMAgsgBiAGXCEECyACLQAEIQIgBEUNACADLQAMIAJB/wFxRg0BCyAFIAEgBiACEDQDQCAALQAAIgFBBHENASAAIAFBBHI6AAAgACgCECIBBEAgACABEQAACyAAQYCAgP4HNgKcASAAKALcAyIADQALCyADQRBqJAALJQAgAEHEJjYCACAALQAEBEAgACgCCEH9DxBcCyAAKAIIEAYgAAsDAAALJQAgAEG8JzYCACAALQAEBEAgACgCCEH9DxBcCyAAKAIIEAYgAAs3AQJ/QQQQHiICIAE2AgBBBBAeIgMgATYCAEHvOiAAQa47QcooQb4BIAJBrjtBzihBvwEgAxAHCzcBAX8gASAAKAIEIgNBAXVqIQEgACgCACEAIAEgAiADQQFxBH8gASgCACAAaigCAAUgAAsRBQALOQEBfyABIAAoAgQiBEEBdWohASAAKAIAIQAgASACIAMgBEEBcQR/IAEoAgAgAGooAgAFIAALEQMACwkAIAEgABEAAAsHACAAEQ4ACzUBAX8gASAAKAIEIgJBAXVqIQEgACgCACEAIAEgAkEBcQR/IAEoAgAgAGooAgAFIAALEQAACzABAX8jAEEQayICJAAgAiABNgIIIAJBCGogABEBACEAIAIoAggQBiACQRBqJAAgAAsMACABIAAoAgARAAALCQAgAEEBOgAEC1kBAX8gACAAKAJIIgFBAWsgAXI2AkggACgCACIBQQhxBEAgACABQSByNgIAQX8PCyAAQgA3AgQgACAAKAIsIgE2AhwgACABNgIUIAAgASAAKAIwajYCEEEAC9knAQJ/Qew6Qe06Qe46QQBB5CVBB0HnJUEAQeclQQBByRZB6SVBCBAFQQgQHiIAQoiAgIAQNwMAQew6Qe0aQQZB8CVBiCZBCSAAQQEQAEHwOkHxOkHyOkHsOkHkJUEKQeQlQQtB5CVBDEG4EUHpJUENEAVBBBAeIgBBDjYCAEHwOkHYFEECQZAmQZgmQQ8gAEEAEABB7DpBowxBAkGcJkGkJkEQQREQA0HsOkHWG0EDQfQmQYAnQRJBExADQYQ7QYU7QYY7QQBB5CVBFEHnJUEAQeclQQBB2RZB6SVBFRAFQQgQHiIAQoiAgIAQNwMAQYQ7Qb4cQQJBiCdBmCZBFiAAQQEQAEGHO0GIO0GJO0GEO0HkJUEXQeQlQRhB5CVBGUHPEUHpJUEaEAVBBBAeIgBBGzYCAEGHO0HYFEECQZAnQZgmQRwgAEEAEABBhDtBowxBAkGYJ0GkJkEdQR4QA0GEO0HWG0EDQfQmQYAnQRJBHxADQYo7QYs7QYw7QQBB5CVBIEHnJUEAQeclQQBBsBpB6SVBIRAFQYo7QQFByCdB5CVBIkEjEA9BijtB5hpBAUHIJ0HkJUEiQSMQA0GKO0HpCEECQcwnQZgmQSRBJRADQQgQHiIAQQA2AgQgAEEmNgIAQYo7QYMcQQRB4CdB8CdBJyAAQQAQAEEIEB4iAEEANgIEIABBKDYCAEGKO0GkEUEDQfgnQYQoQSkgAEEAEABBCBAeIgBBADYCBCAAQSo2AgBBijtBnh1BA0GMKEGYKEErIABBABAAQQgQHiIAQQA2AgQgAEEsNgIAQYo7QaYQQQNBoChBmChBLSAAQQAQAEEIEB4iAEEANgIEIABBLjYCAEGKO0GhHEEDQawoQYAnQS8gAEEAEABBCBAeIgBBADYCBCAAQTA2AgBBijtBqB1BAkG4KEGkJkExIABBABAAQQgQHiIAQQA2AgQgAEEyNgIAQYo7QZcQQQJBwChBpCZBMyAAQQAQAEGNO0GECkHIKEE0QeklQTUQCkHiD0EAEEBB6g5BCBBAQYITQRAQQEHhFUEYEEBB8xZBIBBAQfAOQSgQQEGNOxAJQe86QdUaQcgoQTZB6SVBNxAKQfMWQQAQigFB8A5BCBCKAUHvOhAJQY47QeAaQcgoQThB6SVBORAKQQQQHiIAQQg2AgBBBBAeIgFBCDYCAEGOO0HaGkGuO0HKKEE6IABBrjtBzihBOyABEAdBBBAeIgBBADYCAEEEEB4iAUEANgIAQY47QeUOQac7QaQmQTwgAEGnO0GYKEE9IAEQB0GOOxAJQY87QZA7QZE7QQBB5CVBPkHnJUEAQeclQQBB0RtB6SVBPxAFQY87QQFB1ChB5CVBwABBwQAQD0GPO0HXDkEBQdQoQeQlQcAAQcEAEANBjztBphpBAkHYKEGkJkHCAEHDABADQY87QekIQQJB4ChBmCZBxABBxQAQA0EIEB4iAEEANgIEIABBxgA2AgBBjztB9w9BAkHgKEGYJkHHACAAQQAQAEEIEB4iAEEANgIEIABByAA2AgBBjztBwBtBA0HoKEGYKEHJACAAQQAQAEEIEB4iAEEANgIEIABBygA2AgBBjztB9RpBA0H0KEGYKEHLACAAQQAQAEEIEB4iAEEANgIEIABBzAA2AgBBjztBwBRBBEGAKUGQKUHNACAAQQAQAEEIEB4iAEEANgIEIABBzgA2AgBBjztBiA1BBEGAKUGQKUHNACAAQQAQAEEIEB4iAEEANgIEIABBzwA2AgBBjztB+QtBA0H0KEGYKEHLACAAQQAQAEEIEB4iAEEANgIEIABB0AA2AgBBjztBuBBBA0H0KEGYKEHLACAAQQAQAEEIEB4iAEEANgIEIABB0QA2AgBBjztBuxpBA0H0KEGYKEHLACAAQQAQAEEIEB4iAEEANgIEIABB0gA2AgBBjztB7BRBA0H0KEGYKEHLACAAQQAQAEEIEB4iAEEANgIEIABB0wA2AgBBjztBlRNBA0H0KEGYKEHLACAAQQAQAEEIEB4iAEEANgIEIABB1AA2AgBBjztBtQpBA0H0KEGYKEHLACAAQQAQAEEIEB4iAEEANgIEIABB1QA2AgBBjztBqBVBBEGAKUGQKUHNACAAQQAQAEEIEB4iAEEANgIEIABB1gA2AgBBjztBmw1BBEGAKUGQKUHNACAAQQAQAEEIEB4iAEEANgIEIABB1wA2AgBBjztB3RNBA0H0KEGYKEHLACAAQQAQAEEIEB4iAEEANgIEIABB2AA2AgBBjztBxAlBA0H0KEGYKEHLACAAQQAQAEEIEB4iAEEANgIEIABB2QA2AgBBjztB8QhBA0H0KEGYKEHLACAAQQAQAEEIEB4iAEEANgIEIABB2gA2AgBBjztBhwlBA0GYKUHOKEHbACAAQQAQAEEIEB4iAEEANgIEIABB3AA2AgBBjztB1BBBA0GYKUHOKEHbACAAQQAQAEEIEB4iAEEANgIEIABB3QA2AgBBjztB5gxBA0GYKUHOKEHbACAAQQAQAEEIEB4iAEEANgIEIABB3gA2AgBBjztBzBNBAkHgKEGYJkHHACAAQQAQAEEIEB4iAEEANgIEIABB3wA2AgBBjztBrAlBA0GYKUHOKEHbACAAQQAQAEEIEB4iAEEANgIEIABB4AA2AgBBjztBjxZBA0GYKUHOKEHbACAAQQAQAEEIEB4iAEEANgIEIABB4QA2AgBBjztBkRdBA0GYKUHOKEHbACAAQQAQAEEIEB4iAEEANgIEIABB4gA2AgBBjztBvw1BA0GYKUHOKEHbACAAQQAQAEEIEB4iAEEANgIEIABB4wA2AgBBjztB6xNBAkHgKEGYJkHHACAAQQAQAEEIEB4iAEEANgIEIABB5AA2AgBBjztBkQ9BA0GYKUHOKEHbACAAQQAQAEEIEB4iAEEANgIEIABB5QA2AgBBjztBwQxBA0GYKUHOKEHbACAAQQAQAEEIEB4iAEEANgIEIABB5gA2AgBBjztBvhNBAkHgKEGYJkHHACAAQQAQAEEIEB4iAEEANgIEIABB5wA2AgBBjztBoxdBA0GYKUHOKEHbACAAQQAQAEEIEB4iAEEANgIEIABB6AA2AgBBjztBzw1BA0GYKUHOKEHbACAAQQAQAEEIEB4iAEEANgIEIABB6QA2AgBBjztBpQ9BA0GYKUHOKEHbACAAQQAQAEEIEB4iAEEANgIEIABB6gA2AgBBjztB0gxBA0GYKUHOKEHbACAAQQAQAEEIEB4iAEEANgIEIABB6wA2AgBBjztB+RZBA0GYKUHOKEHbACAAQQAQAEEIEB4iAEEANgIEIABB7AA2AgBBjztBrA1BA0GYKUHOKEHbACAAQQAQAEEIEB4iAEEANgIEIABB7QA2AgBBjztB9w5BA0GYKUHOKEHbACAAQQAQAEEIEB4iAEEANgIEIABB7gA2AgBBjztBrQxBA0GYKUHOKEHbACAAQQAQAEEIEB4iAEEANgIEIABB7wA2AgBBjztBohRBA0GYKUHOKEHbACAAQQAQAEEIEB4iAEEANgIEIABB8AA2AgBBjztBlBJBBEGAKUGQKUHNACAAQQAQAEEIEB4iAEEANgIEIABB8QA2AgBBjztBpBlBBEGAKUGQKUHNACAAQQAQAEEIEB4iAEEANgIEIABB8gA2AgBBjztB4g1BBEGAKUGQKUHNACAAQQAQAEEIEB4iAEEANgIEIABB8wA2AgBBjztBrRNBBEGAKUGQKUHNACAAQQAQAEEIEB4iAEEANgIEIABB9AA2AgBBjztB+gxBBEGAKUGQKUHNACAAQQAQAEEIEB4iAEEANgIEIABB9QA2AgBBjztBjhVBA0H0KEGYKEHLACAAQQAQAEEIEB4iAEEANgIEIABB9gA2AgBBjztBhRtBAkGkKUGkJkH3ACAAQQAQAEEIEB4iAEEANgIEIABB+AA2AgBBjztBzBRBA0GsKUGAJ0H5ACAAQQAQAEEIEB4iAEEANgIEIABB+gA2AgBBjztBiQxBAkGkKUGkJkH3ACAAQQAQAEEIEB4iAEEANgIEIABB+wA2AgBBjztBxhBBAkGkKUGkJkH3ACAAQQAQAEEIEB4iAEEANgIEIABB/AA2AgBBjztByBpBAkGkKUGkJkH3ACAAQQAQAEEIEB4iAEEANgIEIABB/QA2AgBBjztB/RRBAkGkKUGkJkH3ACAAQQAQAEEIEB4iAEEANgIEIABB/gA2AgBBjztBoRNBAkGkKUGkJkH3ACAAQQAQAEEIEB4iAEEANgIEIABB/wA2AgBBjztBxwpBAkGkKUGkJkH3ACAAQQAQAEEIEB4iAEEANgIEIABBgAE2AgBBjztBshVBA0GsKUGAJ0H5ACAAQQAQAEEIEB4iAEEANgIEIABBgQE2AgBBjztB4RBBAkG4KUGkJkGCASAAQQAQAEEIEB4iAEEANgIEIABBgwE2AgBBjztBuAlBAkHAKUHKKEGEASAAQQAQAEEIEB4iAEEANgIEIABBhQE2AgBBjztBnRZBAkHAKUHKKEGEASAAQQAQAEEIEB4iAEEANgIEIABBhgE2AgBBjztBmhdBAkG4KUGkJkGCASAAQQAQAEEIEB4iAEEANgIEIABBhwE2AgBBjztBmw9BAkG4KUGkJkGCASAAQQAQAEEIEB4iAEEANgIEIABBiAE2AgBBjztBrxdBAkG4KUGkJkGCASAAQQAQAEEIEB4iAEEANgIEIABBiQE2AgBBjztBsg9BAkG4KUGkJkGCASAAQQAQAEEIEB4iAEEANgIEIABBigE2AgBBjztBhRdBAkG4KUGkJkGCASAAQQAQAEEIEB4iAEEANgIEIABBiwE2AgBBjztBhA9BAkG4KUGkJkGCASAAQQAQAEEIEB4iAEEANgIEIABBjAE2AgBBjztBsRRBAkHAKUHKKEGEASAAQQAQAEEIEB4iAEEANgIEIABBjQE2AgBBjztBnhJBA0HIKUHUKUGOASAAQQAQAEEIEB4iAEEANgIEIABBjwE2AgBBjztB0AlBAkGkKUGkJkH3ACAAQQAQAEEIEB4iAEEANgIEIABBkAE2AgBBjztB/AhBAkGkKUGkJkH3ACAAQQAQAEEIEB4iAEEANgIEIABBkQE2AgBBjztBrxlBA0GsKUGAJ0H5ACAAQQAQAEEIEB4iAEEANgIEIABBkgE2AgBBjztBtBNBA0HcKUHoKUGTASAAQQAQAEEIEB4iAEEANgIEIABBlAE2AgBBjztB3RtBBEHwKUHwJ0GVASAAQQAQAEEIEB4iAEEANgIEIABBlgE2AgBBjztB8htBA0GAKkGYKEGXASAAQQAQAEEIEB4iAEEANgIEIABBmAE2AgBBjztBmgpBAkGMKkGkJkGZASAAQQAQAEEIEB4iAEEANgIEIABBmgE2AgBBjztBmQxBAkGUKkGkJkGbASAAQQAQAEEIEB4iAEEANgIEIABBnAE2AgBBjztB6RtBA0GcKkGAJ0GdASAAQQAQAEEIEB4iAEEANgIEIABBngE2AgBBjztBqxZBA0GoKkGYKEGfASAAQQAQAEEIEB4iAEEANgIEIABBoAE2AgBBjztBlRtBAkG0KkGkJkGhASAAQQAQAEEIEB4iAEEANgIEIABBogE2AgBBjztBqRtBA0GoKkGYKEGfASAAQQAQAEEIEB4iAEEANgIEIABBowE2AgBBjztB/hxBA0G8KkGYKEGkASAAQQAQAEEIEB4iAEEANgIEIABBpQE2AgBBjztB/BxBAkHgKEGYJkHHACAAQQAQAEEIEB4iAEEANgIEIABBpgE2AgBBjztBjx1BA0HIKkGYKEGnASAAQQAQAEEIEB4iAEEANgIEIABBqAE2AgBBjztBjR1BAkHgKEGYJkHHACAAQQAQAEEIEB4iAEEANgIEIABBqQE2AgBBjztB3whBAkHgKEGYJkHHACAAQQAQAEEIEB4iAEEANgIEIABBqgE2AgBBjztB1whBAkHUKkGkJkGrASAAQQAQAEEIEB4iAEEANgIEIABBrAE2AgBBjztBzhVBAkHgKEGYJkHHACAAQQAQAEEIEB4iAEEANgIEIABBrQE2AgBBjztB3AlBAkHUKkGkJkGrASAAQQAQAEEIEB4iAEEANgIEIABBrgE2AgBBjztB6QlBBUHgKkH0KkGvASAAQQAQAEEIEB4iAEEANgIEIABBsAE2AgBBjztB5w9BAkHAKUHKKEGEASAAQQAQAEEIEB4iAEEANgIEIABBsQE2AgBBjztB0Q9BAkHAKUHKKEGEASAAQQAQAEEIEB4iAEEANgIEIABBsgE2AgBBjztBhhNBAkHAKUHKKEGEASAAQQAQAEEIEB4iAEEANgIEIABBswE2AgBBjztB6BVBAkHAKUHKKEGEASAAQQAQAEEIEB4iAEEANgIEIABBtAE2AgBBjztBuxdBAkHAKUHKKEGEASAAQQAQAEEIEB4iAEEANgIEIABBtQE2AgBBjztBvw9BAkHAKUHKKEGEASAAQQAQAEEIEB4iAEEANgIEIABBtgE2AgBBjztB+QlBAkH8KkGkJkG3ASAAQQAQAEEIEB4iAEEANgIEIABBuAE2AgBBjztBvBVBA0HIKUHUKUGOASAAQQAQAEEIEB4iAEEANgIEIABBuQE2AgBBjztBqBJBA0HIKUHUKUGOASAAQQAQAEEIEB4iAEEANgIEIABBugE2AgBBjztBuhlBA0HIKUHUKUGOASAAQQAQAEEIEB4iAEEANgIEIABBuwE2AgBBjztBmxVBAkGkKUGkJkH3ACAAQQAQAAtHAAJAIAFBA00EfyAAIAFBAnRqQQRqBSABQQRrIgEgACgCGCIAKAIEIAAoAgAiAGtBAnVPDQEgACABQQJ0agsoAgAPCxACAAs4AQF/IAFBAEgEQBACAAsgAUEBa0EFdkEBaiIBQQJ0EB4hAiAAIAE2AgggAEEANgIEIAAgAjYCAAvSBQEJfyAAIAEvAQA7AQAgACABKQIENwIEIAAgASkCDDcCDCAAIAEoAhQ2AhQCQAJAIAEoAhgiA0UNAEEYEB4iBUEANgIIIAVCADcCACADKAIEIgEgAygCACICRwRAIAEgAmsiAkEASA0CIAUgAhAeIgE2AgAgBSABIAJqNgIIIAMoAgAiAiADKAIEIgZHBEADQCABIAIoAgA2AgAgAUEEaiEBIAJBBGoiAiAGRw0ACwsgBSABNgIECyAFQgA3AgwgBUEANgIUIAMoAhAiAUUNACAFQQxqIAEQlgEgAygCDCEGIAUgBSgCECIEIAMoAhAiAkEfcWogAkFgcWoiATYCEAJAAkAgBEUEQCABQQFrIQMMAQsgAUEBayIDIARBAWtzQSBJDQELIAUoAgwgA0EFdkEAIAFBIU8bQQJ0akEANgIACyAFKAIMIARBA3ZB/P///wFxaiEBIARBH3EiA0UEQCACQQBMDQEgAkEgbSEDIAJBH2pBP08EQCABIAYgA0ECdBAxGgsgAiADQQV0ayICQQBMDQEgASADQQJ0IgNqIgEgASgCAEF/QSAgAmt2IgFBf3NxIAMgBmooAgAgAXFyNgIADAELIAJBAEwNAEF/IAN0IQhBICADayEEIAJBIE4EQCAIQX9zIQkgASgCACEHA0AgASAHIAlxIAYoAgAiByADdHI2AgAgASABKAIEIAhxIAcgBHZyIgc2AgQgBkEEaiEGIAFBBGohASACQT9LIQogAkEgayECIAoNAAsgAkEATA0BCyABIAEoAgBBfyAEIAQgAiACIARKGyIEa3YgCHFBf3NxIAYoAgBBf0EgIAJrdnEiBiADdHI2AgAgAiAEayICQQBMDQAgASADIARqQQN2Qfz///8BcWoiASABKAIAQX9BICACa3ZBf3NxIAYgBHZyNgIACyAAKAIYIQEgACAFNgIYIAEEQCABEFMLDwsQAgALCgBBDBAeIAAQZQsKAEEMEB5BABBlCw0AIAAoAgAtAAhBAXELCgAgACgCACgCEAsZACABQf8BcQRAEAIACyAAKAIAKAIMQQFxCxgAIAAoAgAiACAALQAIQf4BcSABcjoACAsMACAAKAIAIAE2AhALegECfyMAQRBrIgIkACAAKAIAIQAgAUMAAAAAYEUEQCACQfgTNgIAIwBBEGsiAyQAIAMgAjYCDAJAIABFBEBBiDBBriUgAhBBGgwBCyAAQQBBBUGuJSACIAAoAgQRDQAaCyADQRBqJAAQJwALIAAgATgCFCACQRBqJAALIwAgAUH/AXEEQBACAAsgACgCACIAIAAoAgxBfnEgAnI2AgwLPgECf0EEEB4hAUEcEB4iAEKAgID8AzcCFCAAQgA3AgwgAEEAOgAIIABBAzYCBCAAQQA2AgAgASAANgIAIAELIAAgAkEFR0EAIAIbRQRAQYgwIAMgBBBBDwsgAyAEEGkLIgEBfiABIAKtIAOtQiCGhCAEIAARFAAiBUIgiKckASAFpwuoAQEFfyAAKAJUIgMoAgAhBSADKAIEIgQgACgCFCAAKAIcIgdrIgYgBCAGSRsiBgRAIAUgByAGECwaIAMgAygCACAGaiIFNgIAIAMgAygCBCAGayIENgIECyAEIAIgAiAESxsiBARAIAUgASAEECwaIAMgAygCACAEaiIFNgIAIAMgAygCBCAEazYCBAsgBUEAOgAAIAAgACgCLCIBNgIcIAAgATYCFCACCwQAQgALBABBAAuKBQIGfgJ/IAEgASgCAEEHakF4cSIBQRBqNgIAIAAhCSABKQMAIQMgASkDCCEGIwBBIGsiCCQAAkAgBkL///////////8AgyIEQoCAgICAgMCAPH0gBEKAgICAgIDA/8MAfVQEQCAGQgSGIANCPIiEIQQgA0L//////////w+DIgNCgYCAgICAgIAIWgRAIARCgYCAgICAgIDAAHwhAgwCCyAEQoCAgICAgICAQH0hAiADQoCAgICAgICACFINASACIARCAYN8IQIMAQsgA1AgBEKAgICAgIDA//8AVCAEQoCAgICAgMD//wBRG0UEQCAGQgSGIANCPIiEQv////////8Dg0KAgICAgICA/P8AhCECDAELQoCAgICAgID4/wAhAiAEQv///////7//wwBWDQBCACECIARCMIinIgBBkfcASQ0AIAMhAiAGQv///////z+DQoCAgICAgMAAhCIFIQcCQCAAQYH3AGsiAUHAAHEEQCACIAFBQGqthiEHQgAhAgwBCyABRQ0AIAcgAa0iBIYgAkHAACABa62IhCEHIAIgBIYhAgsgCCACNwMQIAggBzcDGAJAQYH4ACAAayIAQcAAcQRAIAUgAEFAaq2IIQNCACEFDAELIABFDQAgBUHAACAAa62GIAMgAK0iAoiEIQMgBSACiCEFCyAIIAM3AwAgCCAFNwMIIAgpAwhCBIYgCCkDACIDQjyIhCECIAgpAxAgCCkDGIRCAFKtIANC//////////8Pg4QiA0KBgICAgICAgAhaBEAgAkIBfCECDAELIANCgICAgICAgIAIUg0AIAJCAYMgAnwhAgsgCEEgaiQAIAkgAiAGQoCAgICAgICAgH+DhL85AwALmRgDEn8BfAN+IwBBsARrIgwkACAMQQA2AiwCQCABvSIZQgBTBEBBASERQZkJIRMgAZoiAb0hGQwBCyAEQYAQcQRAQQEhEUGcCSETDAELQZ8JQZoJIARBAXEiERshEyARRSEVCwJAIBlCgICAgICAgPj/AINCgICAgICAgPj/AFEEQCAAQSAgAiARQQNqIgMgBEH//3txECsgACATIBEQKSAAQd0VQbIeIAVBIHEiBRtBtxpBth4gBRsgASABYhtBAxApIABBICACIAMgBEGAwABzECsgAyACIAIgA0gbIQoMAQsgDEEQaiESAkACfwJAIAEgDEEsahCDASIBIAGgIgFEAAAAAAAAAABiBEAgDCAMKAIsIgZBAWs2AiwgBUEgciIOQeEARw0BDAMLIAVBIHIiDkHhAEYNAiAMKAIsIQlBBiADIANBAEgbDAELIAwgBkEdayIJNgIsIAFEAAAAAAAAsEGiIQFBBiADIANBAEgbCyELIAxBMGpBoAJBACAJQQBOG2oiDSEHA0AgBwJ/IAFEAAAAAAAA8EFjIAFEAAAAAAAAAABmcQRAIAGrDAELQQALIgM2AgAgB0EEaiEHIAEgA7ihRAAAAABlzc1BoiIBRAAAAAAAAAAAYg0ACwJAIAlBAEwEQCAJIQMgByEGIA0hCAwBCyANIQggCSEDA0BBHSADIANBHU4bIQMCQCAHQQRrIgYgCEkNACADrSEaQgAhGQNAIAYgGUL/////D4MgBjUCACAahnwiG0KAlOvcA4AiGUKA7JSjDH4gG3w+AgAgBkEEayIGIAhPDQALIBmnIgZFDQAgCEEEayIIIAY2AgALA0AgCCAHIgZJBEAgBkEEayIHKAIARQ0BCwsgDCAMKAIsIANrIgM2AiwgBiEHIANBAEoNAAsLIANBAEgEQCALQRlqQQluQQFqIQ8gDkHmAEYhEANAQQlBACADayIDIANBCU4bIQoCQCAGIAhNBEAgCCgCACEHDAELQYCU69wDIAp2IRRBfyAKdEF/cyEWQQAhAyAIIQcDQCAHIAMgBygCACIXIAp2ajYCACAWIBdxIBRsIQMgB0EEaiIHIAZJDQALIAgoAgAhByADRQ0AIAYgAzYCACAGQQRqIQYLIAwgDCgCLCAKaiIDNgIsIA0gCCAHRUECdGoiCCAQGyIHIA9BAnRqIAYgBiAHa0ECdSAPShshBiADQQBIDQALC0EAIQMCQCAGIAhNDQAgDSAIa0ECdUEJbCEDQQohByAIKAIAIgpBCkkNAANAIANBAWohAyAKIAdBCmwiB08NAAsLIAsgA0EAIA5B5gBHG2sgDkHnAEYgC0EAR3FrIgcgBiANa0ECdUEJbEEJa0gEQEEEQaQCIAlBAEgbIAxqIAdBgMgAaiIKQQltIg9BAnRqQdAfayEJQQohByAPQXdsIApqIgpBB0wEQANAIAdBCmwhByAKQQFqIgpBCEcNAAsLAkAgCSgCACIQIBAgB24iDyAHbCIKRiAJQQRqIhQgBkZxDQAgECAKayEQAkAgD0EBcUUEQEQAAAAAAABAQyEBIAdBgJTr3ANHIAggCU9yDQEgCUEEay0AAEEBcUUNAQtEAQAAAAAAQEMhAQtEAAAAAAAA4D9EAAAAAAAA8D9EAAAAAAAA+D8gBiAURhtEAAAAAAAA+D8gECAHQQF2IhRGGyAQIBRJGyEYAkAgFQ0AIBMtAABBLUcNACAYmiEYIAGaIQELIAkgCjYCACABIBigIAFhDQAgCSAHIApqIgM2AgAgA0GAlOvcA08EQANAIAlBADYCACAIIAlBBGsiCUsEQCAIQQRrIghBADYCAAsgCSAJKAIAQQFqIgM2AgAgA0H/k+vcA0sNAAsLIA0gCGtBAnVBCWwhA0EKIQcgCCgCACIKQQpJDQADQCADQQFqIQMgCiAHQQpsIgdPDQALCyAJQQRqIgcgBiAGIAdLGyEGCwNAIAYiByAITSIKRQRAIAdBBGsiBigCAEUNAQsLAkAgDkHnAEcEQCAEQQhxIQkMAQsgA0F/c0F/IAtBASALGyIGIANKIANBe0pxIgkbIAZqIQtBf0F+IAkbIAVqIQUgBEEIcSIJDQBBdyEGAkAgCg0AIAdBBGsoAgAiDkUNAEEKIQpBACEGIA5BCnANAANAIAYiCUEBaiEGIA4gCkEKbCIKcEUNAAsgCUF/cyEGCyAHIA1rQQJ1QQlsIQogBUFfcUHGAEYEQEEAIQkgCyAGIApqQQlrIgZBACAGQQBKGyIGIAYgC0obIQsMAQtBACEJIAsgAyAKaiAGakEJayIGQQAgBkEAShsiBiAGIAtKGyELC0F/IQogC0H9////B0H+////ByAJIAtyIhAbSg0BIAsgEEEAR2pBAWohDgJAIAVBX3EiFUHGAEYEQCADIA5B/////wdzSg0DIANBACADQQBKGyEGDAELIBIgAyADQR91IgZzIAZrrSASED8iBmtBAUwEQANAIAZBAWsiBkEwOgAAIBIgBmtBAkgNAAsLIAZBAmsiDyAFOgAAIAZBAWtBLUErIANBAEgbOgAAIBIgD2siBiAOQf////8Hc0oNAgsgBiAOaiIDIBFB/////wdzSg0BIABBICACIAMgEWoiBSAEECsgACATIBEQKSAAQTAgAiAFIARBgIAEcxArAkACQAJAIBVBxgBGBEAgDEEQaiIGQQhyIQMgBkEJciEJIA0gCCAIIA1LGyIKIQgDQCAINQIAIAkQPyEGAkAgCCAKRwRAIAYgDEEQak0NAQNAIAZBAWsiBkEwOgAAIAYgDEEQaksNAAsMAQsgBiAJRw0AIAxBMDoAGCADIQYLIAAgBiAJIAZrECkgCEEEaiIIIA1NDQALIBAEQCAAQeIkQQEQKQsgC0EATCAHIAhNcg0BA0AgCDUCACAJED8iBiAMQRBqSwRAA0AgBkEBayIGQTA6AAAgBiAMQRBqSw0ACwsgACAGQQkgCyALQQlOGxApIAtBCWshBiAIQQRqIgggB08NAyALQQlKIQMgBiELIAMNAAsMAgsCQCALQQBIDQAgByAIQQRqIAcgCEsbIQogDEEQaiIGQQhyIQMgBkEJciENIAghBwNAIA0gBzUCACANED8iBkYEQCAMQTA6ABggAyEGCwJAIAcgCEcEQCAGIAxBEGpNDQEDQCAGQQFrIgZBMDoAACAGIAxBEGpLDQALDAELIAAgBkEBECkgBkEBaiEGIAkgC3JFDQAgAEHiJEEBECkLIAAgBiALIA0gBmsiBiAGIAtKGxApIAsgBmshCyAHQQRqIgcgCk8NASALQQBODQALCyAAQTAgC0ESakESQQAQKyAAIA8gEiAPaxApDAILIAshBgsgAEEwIAZBCWpBCUEAECsLIABBICACIAUgBEGAwABzECsgBSACIAIgBUgbIQoMAQsgEyAFQRp0QR91QQlxaiELAkAgA0ELSw0AQQwgA2shBkQAAAAAAAAwQCEYA0AgGEQAAAAAAAAwQKIhGCAGQQFrIgYNAAsgCy0AAEEtRgRAIBggAZogGKGgmiEBDAELIAEgGKAgGKEhAQsgEUECciEJIAVBIHEhCCASIAwoAiwiByAHQR91IgZzIAZrrSASED8iBkYEQCAMQTA6AA8gDEEPaiEGCyAGQQJrIg0gBUEPajoAACAGQQFrQS1BKyAHQQBIGzoAACAEQQhxIQYgDEEQaiEHA0AgByIFAn8gAZlEAAAAAAAA4EFjBEAgAaoMAQtBgICAgHgLIgdB4C5qLQAAIAhyOgAAIAYgA0EASnJFIAEgB7ehRAAAAAAAADBAoiIBRAAAAAAAAAAAYXEgBUEBaiIHIAxBEGprQQFHckUEQCAFQS46AAEgBUECaiEHCyABRAAAAAAAAAAAYg0AC0F/IQpB/f///wcgCSASIA1rIgVqIgZrIANIDQAgAEEgIAIgBgJ/AkAgA0UNACAHIAxBEGprIghBAmsgA04NACADQQJqDAELIAcgDEEQamsiCAsiB2oiAyAEECsgACALIAkQKSAAQTAgAiADIARBgIAEcxArIAAgDEEQaiAIECkgAEEwIAcgCGtBAEEAECsgACANIAUQKSAAQSAgAiADIARBgMAAcxArIAMgAiACIANIGyEKCyAMQbAEaiQAIAoLRgEBfyAAKAI8IQMjAEEQayIAJAAgAyABpyABQiCIpyACQf8BcSAAQQhqEBQQhAEhAiAAKQMIIQEgAEEQaiQAQn8gASACGwu+AgEHfyMAQSBrIgMkACADIAAoAhwiBDYCECAAKAIUIQUgAyACNgIcIAMgATYCGCADIAUgBGsiATYCFCABIAJqIQVBAiEGIANBEGohAQJ/A0ACQAJAAkAgACgCPCABIAYgA0EMahAYEIQBRQRAIAUgAygCDCIHRg0BIAdBAE4NAgwDCyAFQX9HDQILIAAgACgCLCIBNgIcIAAgATYCFCAAIAEgACgCMGo2AhAgAgwDCyABIAcgASgCBCIISyIJQQN0aiIEIAcgCEEAIAkbayIIIAQoAgBqNgIAIAFBDEEEIAkbaiIBIAEoAgAgCGs2AgAgBSAHayEFIAYgCWshBiAEIQEMAQsLIABBADYCHCAAQgA3AxAgACAAKAIAQSByNgIAQQAgBkECRg0AGiACIAEoAgRrCyEEIANBIGokACAECwkAIAAoAjwQGQsjAQF/QZQ7KAIAIgAEQANAIAAoAgARCQAgACgCBCIADQALCwu/AgEFfyMAQeAAayICJAAgAiAANgIAIwBBEGsiAyQAIAMgAjYCDCMAQZABayIAJAAgAEHwLkGQARAsIgAgAkEQaiIFIgE2AiwgACABNgIUIABB/////wdBfiABayIEIARB/////wdPGyIENgIwIAAgASAEaiIBNgIcIAAgATYCECAAQbsTIAJBAEEAEIIBGiAEBEAgACgCFCIBIAEgACgCEEZrQQA6AAALIABBkAFqJAAgA0EQaiQAAkAgBSIAQQNxBEADQCAALQAARQ0CIABBAWoiAEEDcQ0ACwsDQCAAIgFBBGohACABKAIAIgNBf3MgA0GBgoQIa3FBgIGChHhxRQ0ACwNAIAEiAEEBaiEBIAAtAAANAAsLIAAgBWtBAWoiABBWIgEEfyABIAUgABAsBUEACyEAIAJB4ABqJAAgAAvFAQICfwF8IwBBMGsiBiQAIAEoAgghBwJAQYA7LQAAQQFxBEBB/DooAgAhAQwBC0EFQeAmEAwhAUGAO0EBOgAAQfw6IAE2AgALIAYgBTYCKCAGIAQ4AiAgBiADNgIYIAYgAjgCEAJ/IAEgB0HtGiAGQQxqIAZBEGoQEiIIRAAAAAAAAPBBYyAIRAAAAAAAAAAAZnEEQCAIqwwBC0EACyEBIAYoAgwhAyAAIAEpAwA3AwAgACABKQMINwMIIAMQESAGQTBqJAALCQAgABCHARAoCwwAIAAoAghBvhwQXAsJACAAEIkBECgLVQECfyMAQTBrIgIkACABIAAoAgQiA0EBdWohASAAKAIAIQAgAiABIANBAXEEfyABKAIAIABqKAIABSAACxECAEEwEB4gAkEwECwhACACQTBqJAAgAAs7AQF/IAEgACgCBCIFQQF1aiEBIAAoAgAhACABIAIgAyAEIAVBAXEEfyABKAIAIABqKAIABSAACxEcAAs3AQF/IAEgACgCBCIDQQF1aiEBIAAoAgAhACABIAIgA0EBcQR/IAEoAgAgAGooAgAFIAALERIACzcBAX8gASAAKAIEIgNBAXVqIQEgACgCACEAIAEgAiADQQFxBH8gASgCACAAaigCAAUgAAsRDAALNQEBfyABIAAoAgQiAkEBdWohASAAKAIAIQAgASACQQFxBH8gASgCACAAaigCAAUgAAsRCwALYQECfyMAQRBrIgIkACABIAAoAgQiA0EBdWohASAAKAIAIQAgAiABIANBAXEEfyABKAIAIABqKAIABSAACxECAEEQEB4iACACKQMINwMIIAAgAikDADcDACACQRBqJAAgAAtjAQJ/IwBBEGsiAyQAIAEgACgCBCIEQQF1aiEBIAAoAgAhACADIAEgAiAEQQFxBH8gASgCACAAaigCAAUgAAsRAwBBEBAeIgAgAykDCDcDCCAAIAMpAwA3AwAgA0EQaiQAIAALNwEBfyABIAAoAgQiA0EBdWohASAAKAIAIQAgASACIANBAXEEfyABKAIAIABqKAIABSAACxEEAAs5AQF/IAEgACgCBCIEQQF1aiEBIAAoAgAhACABIAIgAyAEQQFxBH8gASgCACAAaigCAAUgAAsRCAALCQAgASAAEQEACwUAQY87Cw8AIAEgACgCAGogAjYCAAsNACABIAAoAgBqKAIACxgBAX9BEBAeIgBCADcDCCAAQQA2AgAgAAsYAQF/QRAQHiIAQgA3AwAgAEIANwMIIAALDABBMBAeQQBBMBAwCzcBAX8gASAAKAIEIgNBAXVqIQEgACgCACEAIAEgAiADQQFxBH8gASgCACAAaigCAAUgAAsRGwALBQBBijsLIQAgACABKAIAIAEgASwAC0EASBtBhzsgAigCABAQNgIACyoBAX9BDBAeIgFBADoABCABIAAoAgA2AgggAEEANgIAIAFBqCc2AgAgAQsFAEGHOwsFAEGEOwshACAAIAEoAgAgASABLAALQQBIG0HwOiACKAIAEBA2AgAL2AEBBH8jAEEgayIDJAAgASgCACIEQfD///8HSQRAAkACQCAEQQtPBEAgBEEPckEBaiIFEB4hBiADIAVBgICAgHhyNgIQIAMgBjYCCCADIAQ2AgwgBCAGaiEFDAELIAMgBDoAEyADQQhqIgYgBGohBSAERQ0BCyAGIAFBBGogBBAsGgsgBUEAOgAAIAMgAjYCACADQRhqIANBCGogAyAAEQMAIAMoAhgQHSADKAIYIgAQBiADKAIAEAYgAywAE0EASARAIAMoAggQKAsgA0EgaiQAIAAPCxACAAsqAQF/QQwQHiIBQQA6AAQgASAAKAIANgIIIABBADYCACABQbAmNgIAIAELBQBB8DoLaQECfyMAQRBrIgYkACABIAAoAgQiB0EBdWohASAAKAIAIQAgBiABIAIgAyAEIAUgB0EBcQR/IAEoAgAgAGooAgAFIAALERAAQRAQHiIAIAYpAwg3AwggACAGKQMANwMAIAZBEGokACAACwUAQew6Cx0AIAAoAgAiACAALQAAQfcBcUEIQQAgARtyOgAAC6oBAgJ/AX0jAEEQayICJAAgACgCACEAIAFB/wFxIgNBBkkEQAJ/AkACQAJAIANBBGsOAgABAgsgAEHQA2ogAC0AhANBA3FBAkYNAhogAEHIA2oMAgsgAEHIA2ogAC0AhANBA3FBAkYNARogAEHQA2oMAQsgACABQf8BcUECdGpByANqCyoCACEEIAJBEGokACAEuw8LIAJB7hA2AgAgAEEFQa4lIAIQLhAnAAuqAQICfwF9IwBBEGsiAiQAIAAoAgAhACABQf8BcSIDQQZJBEACfwJAAkACQCADQQRrDgIAAQILIABBwANqIAAtAIQDQQNxQQJGDQIaIABBuANqDAILIABBuANqIAAtAIQDQQNxQQJGDQEaIABBwANqDAELIAAgAUH/AXFBAnRqQbgDagsqAgAhBCACQRBqJAAgBLsPCyACQe4QNgIAIABBBUGuJSACEC4QJwALqgECAn8BfSMAQRBrIgIkACAAKAIAIQAgAUH/AXEiA0EGSQRAAn8CQAJAAkAgA0EEaw4CAAECCyAAQbADaiAALQCEA0EDcUECRg0CGiAAQagDagwCCyAAQagDaiAALQCEA0EDcUECRg0BGiAAQbADagwBCyAAIAFB/wFxQQJ0akGoA2oLKgIAIQQgAkEQaiQAIAS7DwsgAkHuEDYCACAAQQVBriUgAhAuECcAC08AIAAgASgCACIBKgKYA7s5AwAgACABKgKgA7s5AwggACABKgKcA7s5AxAgACABKgKkA7s5AxggACABKgKIA7s5AyAgACABKgKMA7s5AygLDAAgACgCACoCjAO7CwwAIAAoAgAqAogDuwsMACAAKAIAKgKkA7sLDAAgACgCACoCnAO7CwwAIAAoAgAqAqADuwsMACAAKAIAKgKYA7sL3AUCBX0EfyMAQUBqIgkkACAAKAIAIQAgCUEIakEAQTgQMBpBwDpBwDooAgBBAWo2AgAgABBvIABBFGohCiABtiEFIAAqAvADIgYhBAJ/AkACQAJAIAAtAPQDIgtBAWsOAgEAAgsgBiAFlEMK1yM8lCEECyAEQwAAAABgRQ0AQwAAwH8hBAJAAkACQCALQQFrDgIAAQILIAYhBAwBCyAGIAWUQwrXIzyUIQQLIAQgCkECQQEgBRAkIApBAkEBIAUQI5KSIQdBAAwBCyAJIABB/ABqIgsgAC8BdhAfAkACfQJAAkAgCS0ABEEBaw4CAAEDCyAJKgIADAELIAkqAgAgBZRDCtcjPJQLIgQgBFwNACAJIAsgAC8BdhAfQwAAwH8hBwJAAkACQCAJLQAEQQFrDgIAAQILIAkqAgAhBwwBCyAJKgIAIAWUQwrXIzyUIQcLQQIMAQsgBSEHIAUgBVwLIQsgArYhBiAAKgL4AyIIIQQCfwJAAkACQCAALQD8AyIMQQFrDgIBAAILIAggBpRDCtcjPJQhBAsgBEMAAAAAYEUNAEMAAMB/IQQCQAJAAkAgDEEBaw4CAAECCyAIIQQMAQsgCCAGlEMK1yM8lCEECyAEIApBAEEBIAUQJCAKQQBBASAFECOSkiEEQQAMAQsgCSAAQfwAaiIKIAAvAXgQHwJAAn0CQAJAIAktAARBAWsOAgABAwsgCSoCAAwBCyAJKgIAIAaUQwrXIzyUCyIEIARcDQAgCSAKIAAvAXgQH0MAAMB/IQQCQAJAAkAgCS0ABEEBaw4CAAECCyAJKgIAIQQMAQsgCSoCACAGlEMK1yM8lCEEC0ECDAELIAYhBCAGIAZcCyEMIAAgByAEIANB/wFxIAsgDCAFIAZBAUEAIAlBCGpBAEHAOigCABA4BEAgACAALQCEA0EDcSAFIAYQbSAARAAAAAAAAAAARAAAAAAAAAAAEGwLIAlBQGskAAsNACAAKAIALQAAQQFxCxUAIAAoAgAiACAALQAAQf4BcToAAAsQACAAKAIALQAAQQRxQQJ2C3oBAn8jAEEQayIBJAAgACgCACIAKAIIBEADQCAALQAAIgJBBHFFBEAgACACQQRyOgAAIAAoAhAiAgRAIAAgAhEAAAsgAEGAgID+BzYCnAEgACgC3AMiAA0BCwsgAUEQaiQADwsgAUGACDYCACAAQQVBriUgARAuECcACy4BAX8gACgCCCEBIABBADYCCCABBEAgASABKAIAKAIEEQAACyAAKAIAQQA2AhALFwAgACgCBCgCCCIAIAAoAgAoAggRAAALLgEBfyAAKAIIIQIgACABNgIIIAIEQCACIAIoAgAoAgQRAAALIAAoAgBBBTYCEAs+AQF/IAAoAgQhASAAQQA2AgQgAQRAIAEgASgCACgCBBEAAAsgACgCACIAQQA2AgggACAALQAAQe8BcToAAAtJAQF/IwBBEGsiBiQAIAYgASgCBCgCBCIBIAIgAyAEIAUgASgCACgCCBEQACAAIAYrAwC2OAIAIAAgBisDCLY4AgQgBkEQaiQAC3MBAn8jAEEQayICJAAgACgCBCEDIAAgATYCBCADBEAgAyADKAIAKAIEEQAACyAAKAIAIgAoAuADIAAoAuQDRwRAIAJBzyM2AgAgAEEFQa4lIAIQLhAnAAsgAEEENgIIIAAgAC0AAEEQcjoAACACQRBqJAALPAEBfwJAIAAoAgAiACgC5AMgACgC4AMiAGtBAnUgAU0NACAAIAFBAnRqKAIAIgBFDQAgACgCBCECCyACCxkAIAAoAgAoAtwDIgBFBEBBAA8LIAAoAgQLFwAgACgCACIAKALkAyAAKALgA2tBAnUL+QIBBH8jAEHAAmsiBCQAAkAgACgCACIAKALkAyAAKALgA0YNACABKAIAIgMoAtwDIQEgACADEGhFDQAgACABRgRAIARBAEHAAhAwIgJBgICA/gc2AgQgAkEQakEAQcQBEDAaIAJB1AFqIQUgAkEUaiEBA0AgAUKAgID8i4CAwL9/NwIQIAFCgYCAgBA3AgggAUKAgID8i4CAwL9/NwIAIAFBGGoiASAFRw0ACyACQoCAgPyLgIDAv383AuQBIAJCgYCAgBA3AtwBIAJCgICA/IuAgMC/fzcC1AEgAkKAgID+h4CA4P8ANwP4ASACQoCAgP6HgIDg/wA3A/ABIAIgAi0A7AFB+AFxOgDsASACQYACakEAQcAAEDAaIANBmAFqIAJBwAIQLBogA0EANgLcAwsDQCAALQAAIgFBBHENASAAIAFBBHI6AAAgACgCECIBBEAgACABEQAACyAAQYCAgP4HNgKcASAAKALcAyIADQALCyAEQcACaiQAC7wHAQh/IwBB0ABrIgckACAAKAIAIQACQAJAIAEoAgAiCCgC3ANFBEAgACgCCA0BIAAoAuADIgEgAkECdGohBgJAIAAoAuQDIgQgAEHoA2oiAygCACIFSQRAIAQgBkYEQCAGIAg2AgAgACAGQQRqNgLkAwwCCyAEIAQiAkEEayIBSwRAA0AgAiABKAIANgIAIAJBBGohAiABQQRqIgEgBEkNAAsLIAAgAjYC5AMgBkEEaiIBIARHBEAgBCAEIAFrIgFBfHFrIAYgARAxGgsgBiAINgIADAELIAQgAWtBAnVBAWoiBEGAgICABE8NAwJAIAdBIGpB/////wMgBSABayIBQQF1IgUgBCAEIAVJGyABQfz///8HTxsgAiADEEIiAygCCCICIAMoAgxHDQAgAygCBCIBIAMoAgAiBEsEQCADIAEgASAEa0ECdUEBakF+bUECdCIEaiABIAIgAWsiARAxIAFqIgI2AgggAyADKAIEIARqNgIEDAELIAdBOGpBASACIARrQQF1IAIgBEYbIgEgAUECdiADKAIQEEIiBSgCCCEEAn8gAygCCCICIAMoAgQiAUYEQCAEIQIgAQwBCyAEIAIgAWtqIQIDQCAEIAEoAgA2AgAgAUEEaiEBIARBBGoiBCACRw0ACyADKAIIIQEgAygCBAshBCADKAIAIQkgAyAFKAIANgIAIAUgCTYCACADIAUoAgQ2AgQgBSAENgIEIAMgAjYCCCAFIAE2AgggAygCDCEKIAMgBSgCDDYCDCAFIAo2AgwgASAERwRAIAUgASAEIAFrQQNqQXxxajYCCAsgCUUNACAJECggAygCCCECCyACIAg2AgAgAyADKAIIQQRqNgIIIAMgAygCBCAGIAAoAuADIgFrIgJrIAEgAhAxNgIEIAMoAgggBiAAKALkAyAGayIEEDEhBiAAKALgAyEBIAAgAygCBDYC4AMgAyABNgIEIAAoAuQDIQIgACAEIAZqNgLkAyADIAI2AgggACgC6AMhBCAAIAMoAgw2AugDIAMgATYCACADIAQ2AgwgASACRwRAIAMgAiABIAJrQQNqQXxxajYCCAsgAUUNACABECgLIAggADYC3AMDQCAALQAAIgFBBHFFBEAgACABQQRyOgAAIAAoAhAiAQRAIAAgAREAAAsgAEGAgID+BzYCnAEgACgC3AMiAA0BCwsgB0HQAGokAA8LIAdBmiM2AhAgAEEFQa4lIAdBEGoQLhAnAAsgB0GfJDYCACAAQQVBriUgBxAuECcACxACAAsQACAAKAIALQAAQQJxQQF2C1kCAX8BfSMAQRBrIgIkACACQQhqIAAoAgAiAEH8AGogACABQf8BcUEBdGovAWgQH0MAAMB/IQMCQAJAIAItAAwOBAEAAAEACyACKgIIIQMLIAJBEGokACADC04BAX8jAEEQayIDJAAgA0EIaiABKAIAIgFB/ABqIAEgAkH/AXFBAXRqLwFEEB8gAy0ADCEBIAAgAyoCCLs5AwggACABNgIAIANBEGokAAteAgF/AXwjAEEQayICJAAgAkEIaiAAKAIAIgBB/ABqIAAgAUH/AXFBAXRqLwFWEB9EAAAAAAAA+H8hAwJAAkAgAi0ADA4EAQAAAQALIAIqAgi7IQMLIAJBEGokACADCyQBAX1DAADAfyAAKAIAIgBB/ABqIAAvAXoQICIBIAEgAVwbuwtEAQF/IwBBEGsiAiQAIAJBCGogASgCACIBQfwAaiABLwF4EB8gAi0ADCEBIAAgAioCCLs5AwggACABNgIAIAJBEGokAAtEAQF/IwBBEGsiAiQAIAJBCGogASgCACIBQfwAaiABLwF2EB8gAi0ADCEBIAAgAioCCLs5AwggACABNgIAIAJBEGokAAtEAQF/IwBBEGsiAiQAIAJBCGogASgCACIBQfwAaiABLwF0EB8gAi0ADCEBIAAgAioCCLs5AwggACABNgIAIAJBEGokAAtEAQF/IwBBEGsiAiQAIAJBCGogASgCACIBQfwAaiABLwFyEB8gAi0ADCEBIAAgAioCCLs5AwggACABNgIAIAJBEGokAAtEAQF/IwBBEGsiAiQAIAJBCGogASgCACIBQfwAaiABLwFwEB8gAi0ADCEBIAAgAioCCLs5AwggACABNgIAIAJBEGokAAtEAQF/IwBBEGsiAiQAIAJBCGogASgCACIBQfwAaiABLwFuEB8gAi0ADCEBIAAgAioCCLs5AwggACABNgIAIAJBEGokAAtIAgF/AX0CfSAAKAIAIgBB/ABqIgEgAC8BHBAgIgIgAlwEQEMAAIA/QwAAAAAgACgC7AMtAAhBAXEbDAELIAEgAC8BHBAgC7sLNgIBfwF9IAAoAgAiAEH8AGoiASAALwEaECAiAiACXARARAAAAAAAAAAADwsgASAALwEaECC7C0QBAX8jAEEQayICJAAgAkEIaiABKAIAIgFB/ABqIAEvAR4QHyACLQAMIQEgACACKgIIuzkDCCAAIAE2AgAgAkEQaiQACxAAIAAoAgAtABdBAnZBAXELDQAgACgCAC0AF0EDcQtOAQF/IwBBEGsiAyQAIANBCGogASgCACIBQfwAaiABIAJB/wFxQQF0ai8BIBAfIAMtAAwhASAAIAMqAgi7OQMIIAAgATYCACADQRBqJAALEAAgACgCAC0AFEEEdkEHcQsNACAAKAIALwAVQQ52Cw0AIAAoAgAtABRBA3ELEAAgACgCAC0AFEECdkEDcQsNACAAKAIALwAWQQ9xCxAAIAAoAgAvABVBBHZBD3ELDQAgACgCAC8AFUEPcQtOAQF/IwBBEGsiAyQAIANBCGogASgCACIBQfwAaiABIAJB/wFxQQF0ai8BMhAfIAMtAAwhASAAIAMqAgi7OQMIIAAgATYCACADQRBqJAALEAAgACgCAC8AFUEMdkEDcQuAAQIDfwF9IwBBEGsiAyQAIAAoAgAhBAJ9IAK2IgYgBlwEQEEAIQBDAADAfwwBC0EAQQIgBkMAAIB/WyAGQwAAgP9bciIFGyEAQwAAwH8gBiAFGwshBiADIAA6AAwgAyAGOAIIIAMgAykDCDcDACAEIAFB/wFxIAMQeiADQRBqJAALeAIBfQJ/IwBBEGsiBCQAIAAoAgAhBSAEAn8gArYiAyADXARAQwAAwH8hA0EADAELQwAAwH8gAyADQwAAgH9bIANDAACA/1tyIgAbIQMgAEULOgAMIAQgAzgCCCAEIAQpAwg3AwAgBSABQf8BcSAEEHogBEEQaiQAC3EBAX8CQCAAKAIAIgAtAAAiAkECcUEBdiABRg0AIAAgAkH9AXFBAkEAIAEbcjoAAANAIAAtAAAiAUEEcQ0BIAAgAUEEcjoAACAAKAIQIgEEQCAAIAERAAALIABBgICA/gc2ApwBIAAoAtwDIgANAAsLC4ABAgN/AX0jAEEQayIDJAAgACgCACEEAn0gArYiBiAGXARAQQAhAEMAAMB/DAELQQBBAiAGQwAAgH9bIAZDAACA/1tyIgUbIQBDAADAfyAGIAUbCyEGIAMgADoADCADIAY4AgggAyADKQMINwMAIAQgAUH/AXEgAxB9IANBEGokAAt4AgF9An8jAEEQayIEJAAgACgCACEFIAQCfyACtiIDIANcBEBDAADAfyEDQQAMAQtDAADAfyADIANDAACAf1sgA0MAAID/W3IiABshAyAARQs6AAwgBCADOAIIIAQgBCkDCDcDACAFIAFB/wFxIAQQfSAEQRBqJAAL+QECAn0EfyMAQRBrIgUkACAAKAIAIQACfyACtiIDIANcBEBDAADAfyEDQQAMAQtDAADAfyADIANDAACAf1sgA0MAAID/W3IiBhshAyAGRQshBkEBIQcgBUEIaiAAQfwAaiIIIAAgAUH/AXFBAXRqQdYAaiIBLwEAEB8CQAJAIAMgBSoCCCIEXAR/IAQgBFsNASADIANcBSAHC0UNACAFLQAMIAZGDQELIAggASADIAYQNANAIAAtAAAiAUEEcQ0BIAAgAUEEcjoAACAAKAIQIgEEQCAAIAERAAALIABBgICA/gc2ApwBIAAoAtwDIgANAAsLIAVBEGokAAuhAQIDfwJ9AkAgACgCACIAQfwAaiIDIABB+gBqIgIvAQAQICIGIAG2IgVbDQAgBSAFWyIERSAGIAZccQ0AAkAgBEUEQCACIAIvAQBB+P8DcTsBAAwBCyADIAIgBUEDEEcLA0AgAC0AACICQQRxDQEgACACQQRyOgAAIAAoAhAiAgRAIAAgAhEAAAsgAEGAgID+BzYCnAEgACgC3AMiAA0ACwsLfAIDfwF9IwBBEGsiAiQAIAAoAgAhAwJ9IAG2IgUgBVwEQEEAIQBDAADAfwwBC0EAQQIgBUMAAIB/WyAFQwAAgP9bciIEGyEAQwAAwH8gBSAEGwshBSACIAA6AAwgAiAFOAIIIAIgAikDCDcDACADQQEgAhBNIAJBEGokAAt0AgF9An8jAEEQayIDJAAgACgCACEEIAMCfyABtiICIAJcBEBDAADAfyECQQAMAQtDAADAfyACIAJDAACAf1sgAkMAAID/W3IiABshAiAARQs6AAwgAyACOAIIIAMgAykDCDcDACAEQQEgAxBNIANBEGokAAt8AgN/AX0jAEEQayICJAAgACgCACEDAn0gAbYiBSAFXARAQQAhAEMAAMB/DAELQQBBAiAFQwAAgH9bIAVDAACA/1tyIgQbIQBDAADAfyAFIAQbCyEFIAIgADoADCACIAU4AgggAiACKQMINwMAIANBACACEE0gAkEQaiQAC3QCAX0CfyMAQRBrIgMkACAAKAIAIQQgAwJ/IAG2IgIgAlwEQEMAAMB/IQJBAAwBC0MAAMB/IAIgAkMAAIB/WyACQwAAgP9bciIAGyECIABFCzoADCADIAI4AgggAyADKQMINwMAIARBACADEE0gA0EQaiQAC3wCA38BfSMAQRBrIgIkACAAKAIAIQMCfSABtiIFIAVcBEBBACEAQwAAwH8MAQtBAEECIAVDAACAf1sgBUMAAID/W3IiBBshAEMAAMB/IAUgBBsLIQUgAiAAOgAMIAIgBTgCCCACIAIpAwg3AwAgA0EBIAIQTiACQRBqJAALdAIBfQJ/IwBBEGsiAyQAIAAoAgAhBCADAn8gAbYiAiACXARAQwAAwH8hAkEADAELQwAAwH8gAiACQwAAgH9bIAJDAACA/1tyIgAbIQIgAEULOgAMIAMgAjgCCCADIAMpAwg3AwAgBEEBIAMQTiADQRBqJAALfAIDfwF9IwBBEGsiAiQAIAAoAgAhAwJ9IAG2IgUgBVwEQEEAIQBDAADAfwwBC0EAQQIgBUMAAIB/WyAFQwAAgP9bciIEGyEAQwAAwH8gBSAEGwshBSACIAA6AAwgAiAFOAIIIAIgAikDCDcDACADQQAgAhBOIAJBEGokAAt0AgF9An8jAEEQayIDJAAgACgCACEEIAMCfyABtiICIAJcBEBDAADAfyECQQAMAQtDAADAfyACIAJDAACAf1sgAkMAAID/W3IiABshAiAARQs6AAwgAyACOAIIIAMgAykDCDcDACAEQQAgAxBOIANBEGokAAs/AQF/IwBBEGsiASQAIAAoAgAhACABQQM6AAwgAUGAgID+BzYCCCABIAEpAwg3AwAgAEEBIAEQPiABQRBqJAALfAIDfwF9IwBBEGsiAiQAIAAoAgAhAwJ9IAG2IgUgBVwEQEEAIQBDAADAfwwBC0EAQQIgBUMAAIB/WyAFQwAAgP9bciIEGyEAQwAAwH8gBSAEGwshBSACIAA6AAwgAiAFOAIIIAIgAikDCDcDACADQQEgAhA+IAJBEGokAAt0AgF9An8jAEEQayIDJAAgACgCACEEIAMCfyABtiICIAJcBEBDAADAfyECQQAMAQtDAADAfyACIAJDAACAf1sgAkMAAID/W3IiABshAiAARQs6AAwgAyACOAIIIAMgAykDCDcDACAEQQEgAxA+IANBEGokAAs/AQF/IwBBEGsiASQAIAAoAgAhACABQQM6AAwgAUGAgID+BzYCCCABIAEpAwg3AwAgAEEAIAEQPiABQRBqJAALfAIDfwF9IwBBEGsiAiQAIAAoAgAhAwJ9IAG2IgUgBVwEQEEAIQBDAADAfwwBC0EAQQIgBUMAAIB/WyAFQwAAgP9bciIEGyEAQwAAwH8gBSAEGwshBSACIAA6AAwgAiAFOAIIIAIgAikDCDcDACADQQAgAhA+IAJBEGokAAt0AgF9An8jAEEQayIDJAAgACgCACEEIAMCfyABtiICIAJcBEBDAADAfyECQQAMAQtDAADAfyACIAJDAACAf1sgAkMAAID/W3IiABshAiAARQs6AAwgAyACOAIIIAMgAykDCDcDACAEQQAgAxA+IANBEGokAAugAQIDfwJ9AkAgACgCACIAQfwAaiIDIABBHGoiAi8BABAgIgYgAbYiBVsNACAFIAVbIgRFIAYgBlxxDQACQCAERQRAIAIgAi8BAEH4/wNxOwEADAELIAMgAiAFQQMQRwsDQCAALQAAIgJBBHENASAAIAJBBHI6AAAgACgCECICBEAgACACEQAACyAAQYCAgP4HNgKcASAAKALcAyIADQALCwugAQIDfwJ9AkAgACgCACIAQfwAaiIDIABBGmoiAi8BABAgIgYgAbYiBVsNACAFIAVbIgRFIAYgBlxxDQACQCAERQRAIAIgAi8BAEH4/wNxOwEADAELIAMgAiAFQQMQRwsDQCAALQAAIgJBBHENASAAIAJBBHI6AAAgACgCECICBEAgACACEQAACyAAQYCAgP4HNgKcASAAKALcAyIADQALCws9AQF/IwBBEGsiASQAIAAoAgAhACABQQM6AAwgAUGAgID+BzYCCCABIAEpAwg3AwAgACABEF0gAUEQaiQAC3oCA38BfSMAQRBrIgIkACAAKAIAIQMCfSABtiIFIAVcBEBBACEAQwAAwH8MAQtBAEECIAVDAACAf1sgBUMAAID/W3IiBBshAEMAAMB/IAUgBBsLIQUgAiAAOgAMIAIgBTgCCCACIAIpAwg3AwAgAyACEF0gAkEQaiQAC3ICAX0CfyMAQRBrIgMkACAAKAIAIQQgAwJ/IAG2IgIgAlwEQEMAAMB/IQJBAAwBC0MAAMB/IAIgAkMAAIB/WyACQwAAgP9bciIAGyECIABFCzoADCADIAI4AgggAyADKQMINwMAIAQgAxBdIANBEGokAAugAQIDfwJ9AkAgACgCACIAQfwAaiIDIABBGGoiAi8BABAgIgYgAbYiBVsNACAFIAVbIgRFIAYgBlxxDQACQCAERQRAIAIgAi8BAEH4/wNxOwEADAELIAMgAiAFQQMQRwsDQCAALQAAIgJBBHENASAAIAJBBHI6AAAgACgCECICBEAgACACEQAACyAAQYCAgP4HNgKcASAAKALcAyIADQALCwuQAQEBfwJAIAAoAgAiAEEXai0AACICQQJ2QQFxIAFB/wFxRg0AIAAgAC8AFSACQRB0ciICOwAVIAAgAkH//+8HcSABQQFxQRJ0ckEQdjoAFwNAIAAtAAAiAUEEcQ0BIAAgAUEEcjoAACAAKAIQIgEEQCAAIAERAAALIABBgICA/gc2ApwBIAAoAtwDIgANAAsLC40BAQF/AkAgACgCACIAQRdqLQAAIgJBA3EgAUH/AXFGDQAgACAALwAVIAJBEHRyIgI7ABUgACACQf//8wdxIAFBA3FBEHRyQRB2OgAXA0AgAC0AACIBQQRxDQEgACABQQRyOgAAIAAoAhAiAQRAIAAgAREAAAsgAEGAgID+BzYCnAEgACgC3AMiAA0ACwsLQwEBfyMAQRBrIgIkACAAKAIAIQAgAkEDOgAMIAJBgICA/gc2AgggAiACKQMINwMAIAAgAUH/AXEgAhBbIAJBEGokAAuAAQIDfwF9IwBBEGsiAyQAIAAoAgAhBAJ9IAK2IgYgBlwEQEEAIQBDAADAfwwBC0EAQQIgBkMAAIB/WyAGQwAAgP9bciIFGyEAQwAAwH8gBiAFGwshBiADIAA6AAwgAyAGOAIIIAMgAykDCDcDACAEIAFB/wFxIAMQWyADQRBqJAALeAIBfQJ/IwBBEGsiBCQAIAAoAgAhBSAEAn8gArYiAyADXARAQwAAwH8hA0EADAELQwAAwH8gAyADQwAAgH9bIANDAACA/1tyIgAbIQMgAEULOgAMIAQgAzgCCCAEIAQpAwg3AwAgBSABQf8BcSAEEFsgBEEQaiQAC3cBAX8CQCAAKAIAIgAtABQiAkEEdkEHcSABQf8BcUYNACAAIAJBjwFxIAFBBHRB8ABxcjoAFANAIAAtAAAiAUEEcQ0BIAAgAUEEcjoAACAAKAIQIgEEQCAAIAERAAALIABBgICA/gc2ApwBIAAoAtwDIgANAAsLC4kBAQF/AkAgAUH/AXEgACgCACIALwAVIgJBDnZGDQAgAEEXaiACIAAtABdBEHRyIgJBEHY6AAAgACACQf//AHEgAUEOdHI7ABUDQCAALQAAIgFBBHENASAAIAFBBHI6AAAgACgCECIBBEAgACABEQAACyAAQYCAgP4HNgKcASAAKALcAyIADQALCwtwAQF/AkAgACgCACIALQAUIgJBA3EgAUH/AXFGDQAgACACQfwBcSABQQNxcjoAFANAIAAtAAAiAUEEcQ0BIAAgAUEEcjoAACAAKAIQIgEEQCAAIAERAAALIABBgICA/gc2ApwBIAAoAtwDIgANAAsLC3YBAX8CQCAAKAIAIgAtABQiAkECdkEDcSABQf8BcUYNACAAIAJB8wFxIAFBAnRBDHFyOgAUA0AgAC0AACIBQQRxDQEgACABQQRyOgAAIAAoAhAiAQRAIAAgAREAAAsgAEGAgID+BzYCnAEgACgC3AMiAA0ACwsLjwEBAX8CQCAAKAIAIgAvABUiAkEIdkEPcSABQf8BcUYNACAAQRdqIAIgAC0AF0EQdHIiAkEQdjoAACAAIAJB/+EDcSABQQ9xQQh0cjsAFQNAIAAtAAAiAUEEcQ0BIAAgAUEEcjoAACAAKAIQIgEEQCAAIAERAAALIABBgICA/gc2ApwBIAAoAtwDIgANAAsLC48BAQF/AkAgAUH/AXEgACgCACIALwAVIABBF2otAABBEHRyIgJB8AFxQQR2Rg0AIAAgAkEQdjoAFyAAIAJBj/4DcSABQQR0QfABcXI7ABUDQCAALQAAIgFBBHENASAAIAFBBHI6AAAgACgCECIBBEAgACABEQAACyAAQYCAgP4HNgKcASAAKALcAyIADQALCwuHAQEBfwJAIAAoAgAiAC8AFSAAQRdqLQAAQRB0ciICQQ9xIAFB/wFxRg0AIAAgAkEQdjoAFyAAIAJB8P8DcSABQQ9xcjsAFQNAIAAtAAAiAUEEcQ0BIAAgAUEEcjoAACAAKAIQIgEEQCAAIAERAAALIABBgICA/gc2ApwBIAAoAtwDIgANAAsLC4EBAgN/AX0jAEEQayIDJAAgACgCACEEAn0gArYiBiAGXARAQQAhAEMAAMB/DAELQQBBAiAGQwAAgH9bIAZDAACA/1tyIgUbIQBDAADAfyAGIAUbCyEGIAMgADoADCADIAY4AgggAyADKQMINwMAIAQgAUH/AXEgAxCGASADQRBqJAALeQIBfQJ/IwBBEGsiBCQAIAAoAgAhBSAEAn8gArYiAyADXARAQwAAwH8hA0EADAELQwAAwH8gAyADQwAAgH9bIANDAACA/1tyIgAbIQMgAEULOgAMIAQgAzgCCCAEIAQpAwg3AwAgBSABQf8BcSAEEIYBIARBEGokAAuPAQEBfwJAIAAoAgAiAC8AFSICQQx2QQNxIAFB/wFxRg0AIABBF2ogAiAALQAXQRB0ciICQRB2OgAAIAAgAkH/nwNxIAFBA3FBDHRyOwAVA0AgAC0AACIBQQRxDQEgACABQQRyOgAAIAAoAhAiAQRAIAAgAREAAAsgAEGAgID+BzYCnAEgACgC3AMiAA0ACwsL9g0CCH8CfSMAQRBrIgIkAAJAAkAgASgCACIFLQAUIAAoAgAiAS0AFHNB/wBxDQAgBS8AFSAFLQAXQRB0ciABLwAVIAEtABdBEHRyc0H//x9xDQAgBUH8AGohByABQfwAaiEIAkAgAS8AGCIAQQdxRQRAIAUtABhBB3FFDQELIAggABAgIgogByAFLwAYECAiC1sNACAKIApbIAsgC1tyDQELAkAgAS8AGiIAQQdxRQRAIAUtABpBB3FFDQELIAggABAgIgogByAFLwAaECAiC1sNACAKIApbIAsgC1tyDQELAkAgAS8AHCIAQQdxRQRAIAUtABxBB3FFDQELIAggABAgIgogByAFLwAcECAiC1sNACAKIApbIAsgC1tyDQELAkAgAS8AHiIAQQdxRQRAIAUtAB5BB3FFDQELIAJBCGogCCAAEB8gAiAHIAUvAB4QH0EBIQAgAioCCCIKIAIqAgAiC1wEfyAKIApbDQIgCyALXAUgAAtFDQEgAi0ADCACLQAERw0BCyAFQSBqIQAgAUEgaiEGA0ACQCAGIANBAXRqLwAAIgRBB3FFBEAgAC0AAEEHcUUNAQsgAkEIaiAIIAQQHyACIAcgAC8AABAfQQEhBCACKgIIIgogAioCACILXAR/IAogClsNAyALIAtcBSAEC0UNAiACLQAMIAItAARHDQILIABBAmohACADQQFqIgNBCUcNAAsgBUEyaiEAIAFBMmohBkEAIQMDQAJAIAYgA0EBdGovAAAiBEEHcUUEQCAALQAAQQdxRQ0BCyACQQhqIAggBBAfIAIgByAALwAAEB9BASEEIAIqAggiCiACKgIAIgtcBH8gCiAKWw0DIAsgC1wFIAQLRQ0CIAItAAwgAi0ABEcNAgsgAEECaiEAIANBAWoiA0EJRw0ACyAFQcQAaiEAIAFBxABqIQZBACEDA0ACQCAGIANBAXRqLwAAIgRBB3FFBEAgAC0AAEEHcUUNAQsgAkEIaiAIIAQQHyACIAcgAC8AABAfQQEhBCACKgIIIgogAioCACILXAR/IAogClsNAyALIAtcBSAEC0UNAiACLQAMIAItAARHDQILIABBAmohACADQQFqIgNBCUcNAAsgBUHWAGohACABQdYAaiEGQQAhAwNAAkAgBiADQQF0ai8AACIEQQdxRQRAIAAtAABBB3FFDQELIAJBCGogCCAEEB8gAiAHIAAvAAAQH0EBIQQgAioCCCIKIAIqAgAiC1wEfyAKIApbDQMgCyALXAUgBAtFDQIgAi0ADCACLQAERw0CCyAAQQJqIQAgA0EBaiIDQQlHDQALIAVB6ABqIQAgAUHoAGohBkEAIQMDQAJAIAYgA0EBdGovAAAiBEEHcUUEQCAALQAAQQdxRQ0BCyACQQhqIAggBBAfIAIgByAALwAAEB9BASEEIAIqAggiCiACKgIAIgtcBH8gCiAKWw0DIAsgC1wFIAQLRQ0CIAItAAwgAi0ABEcNAgsgAEECaiEAIANBAWoiA0EDRw0ACyAFQe4AaiEAIAFB7gBqIQlBACEEQQAhAwNAAkAgCSADQQF0ai8AACIGQQdxRQRAIAAtAABBB3FFDQELIAJBCGogCCAGEB8gAiAHIAAvAAAQH0EBIQMgAioCCCIKIAIqAgAiC1wEfyAKIApbDQMgCyALXAUgAwtFDQIgAi0ADCACLQAERw0CCyAAQQJqIQBBASEDIAQhBkEBIQQgBkUNAAsgBUHyAGohACABQfIAaiEJQQAhBEEAIQMDQAJAIAkgA0EBdGovAAAiBkEHcUUEQCAALQAAQQdxRQ0BCyACQQhqIAggBhAfIAIgByAALwAAEB9BASEDIAIqAggiCiACKgIAIgtcBH8gCiAKWw0DIAsgC1wFIAMLRQ0CIAItAAwgAi0ABEcNAgsgAEECaiEAQQEhAyAEIQZBASEEIAZFDQALIAVB9gBqIQAgAUH2AGohCUEAIQRBACEDA0ACQCAJIANBAXRqLwAAIgZBB3FFBEAgAC0AAEEHcUUNAQsgAkEIaiAIIAYQHyACIAcgAC8AABAfQQEhAyACKgIIIgogAioCACILXAR/IAogClsNAyALIAtcBSADC0UNAiACLQAMIAItAARHDQILIABBAmohAEEBIQMgBCEGQQEhBCAGRQ0ACyABLwB6IgBBB3FFBEAgBS0AekEHcUUNAgsgCCAAECAiCiAHIAUvAHoQICILWw0BIAogClsNACALIAtcDQELIAFBFGogBUEUakHoABAsGiABQfwAaiAFQfwAahCXAQNAIAEtAAAiAEEEcQ0BIAEgAEEEcjoAACABKAIQIgAEQCABIAARAAALIAFBgICA/gc2ApwBIAEoAtwDIgENAAsLIAJBEGokAAvGAwEEfyMAQaAEayICJAAgACgCBCEBIABBADYCBCABBEAgASABKAIAKAIEEQAACyAAKAIIIQEgAEEANgIIIAEEQCABIAEoAgAoAgQRAAALAkAgACgCACIAKALgAyAAKALkA0YEQCAAKALcAw0BIAAgAkEgaiAAKALsAxBUIgEpAgA3AgAgACABKAIQNgIQIAAgASkCCDcCCCAAQRRqIAFBFGpB6AAQLBogACABKQKMATcCjAEgACABKQKEATcChAEgACABKQJ8NwJ8IAEoApQBIQQgAUEANgKUASAAKAKUASEDIAAgBDYClAEgAwRAIAMQUwsgAEGYAWogAUGYAWpByAIQLBogACgC4AMiAwRAIAAgAzYC5AMgAxAoCyAAIAEoAuADNgLgAyAAIAEoAuQDNgLkAyAAIAEoAugDNgLoAyABQQA2AugDIAFCADcC4AMgACABKQL0AzcC9AMgACABKQLsAzcC7AMgACABKAL8AzYC/AMgASgClAEhACABQQA2ApQBIAAEQCAAEFMLIAJBoARqJAAPCyACQcYcNgIQIABBBUGuJSACQRBqEC4QJwALIAJB5hE2AgAgAEEFQa4lIAIQLhAnAAsLtyYiAEGACAvZHU9ubHkgbGVhZiBub2RlcyB3aXRoIGN1c3RvbSBtZWFzdXJlIGZ1bmN0aW9ucyBzaG91bGQgbWFudWFsbHkgbWFyayB0aGVtc2VsdmVzIGFzIGRpcnR5AGlzRGlydHkAbWFya0RpcnR5AGRlc3Ryb3kAc2V0RGlzcGxheQBnZXREaXNwbGF5AHNldEZsZXgALSsgICAwWDB4AC0wWCswWCAwWC0weCsweCAweABzZXRGbGV4R3JvdwBnZXRGbGV4R3JvdwBzZXRPdmVyZmxvdwBnZXRPdmVyZmxvdwBoYXNOZXdMYXlvdXQAY2FsY3VsYXRlTGF5b3V0AGdldENvbXB1dGVkTGF5b3V0AHVuc2lnbmVkIHNob3J0AGdldENoaWxkQ291bnQAdW5zaWduZWQgaW50AHNldEp1c3RpZnlDb250ZW50AGdldEp1c3RpZnlDb250ZW50AGF2YWlsYWJsZUhlaWdodCBpcyBpbmRlZmluaXRlIHNvIGhlaWdodFNpemluZ01vZGUgbXVzdCBiZSBTaXppbmdNb2RlOjpNYXhDb250ZW50AGF2YWlsYWJsZVdpZHRoIGlzIGluZGVmaW5pdGUgc28gd2lkdGhTaXppbmdNb2RlIG11c3QgYmUgU2l6aW5nTW9kZTo6TWF4Q29udGVudABzZXRBbGlnbkNvbnRlbnQAZ2V0QWxpZ25Db250ZW50AGdldFBhcmVudABpbXBsZW1lbnQAc2V0TWF4SGVpZ2h0UGVyY2VudABzZXRIZWlnaHRQZXJjZW50AHNldE1pbkhlaWdodFBlcmNlbnQAc2V0RmxleEJhc2lzUGVyY2VudABzZXRHYXBQZXJjZW50AHNldFBvc2l0aW9uUGVyY2VudABzZXRNYXJnaW5QZXJjZW50AHNldE1heFdpZHRoUGVyY2VudABzZXRXaWR0aFBlcmNlbnQAc2V0TWluV2lkdGhQZXJjZW50AHNldFBhZGRpbmdQZXJjZW50AGhhbmRsZS50eXBlKCkgPT0gU3R5bGVWYWx1ZUhhbmRsZTo6VHlwZTo6UG9pbnQgfHwgaGFuZGxlLnR5cGUoKSA9PSBTdHlsZVZhbHVlSGFuZGxlOjpUeXBlOjpQZXJjZW50AGNyZWF0ZURlZmF1bHQAdW5pdAByaWdodABoZWlnaHQAc2V0TWF4SGVpZ2h0AGdldE1heEhlaWdodABzZXRIZWlnaHQAZ2V0SGVpZ2h0AHNldE1pbkhlaWdodABnZXRNaW5IZWlnaHQAZ2V0Q29tcHV0ZWRIZWlnaHQAZ2V0Q29tcHV0ZWRSaWdodABsZWZ0AGdldENvbXB1dGVkTGVmdAByZXNldABfX2Rlc3RydWN0AGZsb2F0AHVpbnQ2NF90AHVzZVdlYkRlZmF1bHRzAHNldFVzZVdlYkRlZmF1bHRzAHNldEFsaWduSXRlbXMAZ2V0QWxpZ25JdGVtcwBzZXRGbGV4QmFzaXMAZ2V0RmxleEJhc2lzAENhbm5vdCBnZXQgbGF5b3V0IHByb3BlcnRpZXMgb2YgbXVsdGktZWRnZSBzaG9ydGhhbmRzAHNldFBvaW50U2NhbGVGYWN0b3IATWVhc3VyZUNhbGxiYWNrV3JhcHBlcgBEaXJ0aWVkQ2FsbGJhY2tXcmFwcGVyAENhbm5vdCByZXNldCBhIG5vZGUgc3RpbGwgYXR0YWNoZWQgdG8gYSBvd25lcgBzZXRCb3JkZXIAZ2V0Qm9yZGVyAGdldENvbXB1dGVkQm9yZGVyAGdldE51bWJlcgBoYW5kbGUudHlwZSgpID09IFN0eWxlVmFsdWVIYW5kbGU6OlR5cGU6Ok51bWJlcgB1bnNpZ25lZCBjaGFyAHRvcABnZXRDb21wdXRlZFRvcABzZXRGbGV4V3JhcABnZXRGbGV4V3JhcABzZXRHYXAAZ2V0R2FwACVwAHNldEhlaWdodEF1dG8Ac2V0RmxleEJhc2lzQXV0bwBzZXRNYXJnaW5BdXRvAHNldFdpZHRoQXV0bwBTY2FsZSBmYWN0b3Igc2hvdWxkIG5vdCBiZSBsZXNzIHRoYW4gemVybwBzZXRBc3BlY3RSYXRpbwBnZXRBc3BlY3RSYXRpbwBzZXRQb3NpdGlvbgBnZXRQb3NpdGlvbgBub3RpZnlPbkRlc3RydWN0aW9uAHNldEZsZXhEaXJlY3Rpb24AZ2V0RmxleERpcmVjdGlvbgBzZXREaXJlY3Rpb24AZ2V0RGlyZWN0aW9uAHNldE1hcmdpbgBnZXRNYXJnaW4AZ2V0Q29tcHV0ZWRNYXJnaW4AbWFya0xheW91dFNlZW4AbmFuAGJvdHRvbQBnZXRDb21wdXRlZEJvdHRvbQBib29sAGVtc2NyaXB0ZW46OnZhbABzZXRGbGV4U2hyaW5rAGdldEZsZXhTaHJpbmsAc2V0QWx3YXlzRm9ybXNDb250YWluaW5nQmxvY2sATWVhc3VyZUNhbGxiYWNrAERpcnRpZWRDYWxsYmFjawBnZXRMZW5ndGgAd2lkdGgAc2V0TWF4V2lkdGgAZ2V0TWF4V2lkdGgAc2V0V2lkdGgAZ2V0V2lkdGgAc2V0TWluV2lkdGgAZ2V0TWluV2lkdGgAZ2V0Q29tcHV0ZWRXaWR0aABwdXNoAC9ob21lL3J1bm5lci93b3JrL3lvZ2EveW9nYS9qYXZhc2NyaXB0Ly4uL3lvZ2Evc3R5bGUvU21hbGxWYWx1ZUJ1ZmZlci5oAC9ob21lL3J1bm5lci93b3JrL3lvZ2EveW9nYS9qYXZhc2NyaXB0Ly4uL3lvZ2Evc3R5bGUvU3R5bGVWYWx1ZVBvb2wuaAB1bnNpZ25lZCBsb25nAHN0ZDo6d3N0cmluZwBzdGQ6OnN0cmluZwBzdGQ6OnUxNnN0cmluZwBzdGQ6OnUzMnN0cmluZwBzZXRQYWRkaW5nAGdldFBhZGRpbmcAZ2V0Q29tcHV0ZWRQYWRkaW5nAFRyaWVkIHRvIGNvbnN0cnVjdCBZR05vZGUgd2l0aCBudWxsIGNvbmZpZwBBdHRlbXB0aW5nIHRvIGNvbnN0cnVjdCBOb2RlIHdpdGggbnVsbCBjb25maWcAY3JlYXRlV2l0aENvbmZpZwBpbmYAc2V0QWxpZ25TZWxmAGdldEFsaWduU2VsZgBTaXplAHZhbHVlAFZhbHVlAGNyZWF0ZQBtZWFzdXJlAHNldFBvc2l0aW9uVHlwZQBnZXRQb3NpdGlvblR5cGUAaXNSZWZlcmVuY2VCYXNlbGluZQBzZXRJc1JlZmVyZW5jZUJhc2VsaW5lAGNvcHlTdHlsZQBkb3VibGUATm9kZQBleHRlbmQAaW5zZXJ0Q2hpbGQAZ2V0Q2hpbGQAcmVtb3ZlQ2hpbGQAdm9pZABzZXRFeHBlcmltZW50YWxGZWF0dXJlRW5hYmxlZABpc0V4cGVyaW1lbnRhbEZlYXR1cmVFbmFibGVkAGRpcnRpZWQAQ2Fubm90IHJlc2V0IGEgbm9kZSB3aGljaCBzdGlsbCBoYXMgY2hpbGRyZW4gYXR0YWNoZWQAdW5zZXRNZWFzdXJlRnVuYwB1bnNldERpcnRpZWRGdW5jAHNldEVycmF0YQBnZXRFcnJhdGEATWVhc3VyZSBmdW5jdGlvbiByZXR1cm5lZCBhbiBpbnZhbGlkIGRpbWVuc2lvbiB0byBZb2dhOiBbd2lkdGg9JWYsIGhlaWdodD0lZl0ARXhwZWN0IGN1c3RvbSBiYXNlbGluZSBmdW5jdGlvbiB0byBub3QgcmV0dXJuIE5hTgBOQU4ASU5GAGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PHNob3J0PgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzx1bnNpZ25lZCBzaG9ydD4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8aW50PgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzx1bnNpZ25lZCBpbnQ+AGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PGZsb2F0PgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzx1aW50OF90PgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzxpbnQ4X3Q+AGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PHVpbnQxNl90PgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzxpbnQxNl90PgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzx1aW50MzJfdD4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8aW50MzJfdD4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8Y2hhcj4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8dW5zaWduZWQgY2hhcj4Ac3RkOjpiYXNpY19zdHJpbmc8dW5zaWduZWQgY2hhcj4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8c2lnbmVkIGNoYXI+AGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PGxvbmc+AGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PHVuc2lnbmVkIGxvbmc+AGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PGRvdWJsZT4AQ2hpbGQgYWxyZWFkeSBoYXMgYSBvd25lciwgaXQgbXVzdCBiZSByZW1vdmVkIGZpcnN0LgBDYW5ub3Qgc2V0IG1lYXN1cmUgZnVuY3Rpb246IE5vZGVzIHdpdGggbWVhc3VyZSBmdW5jdGlvbnMgY2Fubm90IGhhdmUgY2hpbGRyZW4uAENhbm5vdCBhZGQgY2hpbGQ6IE5vZGVzIHdpdGggbWVhc3VyZSBmdW5jdGlvbnMgY2Fubm90IGhhdmUgY2hpbGRyZW4uAChudWxsKQBpbmRleCA8IDQwOTYgJiYgIlNtYWxsVmFsdWVCdWZmZXIgY2FuIG9ubHkgaG9sZCB1cCB0byA0MDk2IGNodW5rcyIAJXMKAAAAAQAAAAMAAAAAAAAAAgAAAAMAAAABAAAAAgAAAAAAAAABAAAAAQBB5CULQ2lpAHYAdmkAAAAAAG8dAABtHQAArR0AAKcdAACtHQAApx0AAGlpaWZpZmkAoB0AAHAdAAB2aWkAcR0AALQdAABpaWkAQbAmCwnBAAAAwgAAAMMAQcQmCw7BAAAAxAAAAMUAAACgHQBB4CYLPm8dAACtHQAApx0AAK0dAACnHQAAtB0AAK8dAAC0HQAAaWlpaQAAAACgHQAAhR0AAKAdAACHHQAAiB0AALQdAEGoJwsJxgAAAMcAAADIAEG8JwsWxgAAAMkAAADFAAAAix0AAKAdAACLHQBB4CcLogOgHQAAix0AAKcdAAChHQAAdmlpaWkAAACgHQAAix0AAK0dAAB2aWlmAAAAAKAdAACLHQAApx0AAHZpaWkAAAAAoB0AAIsdAAChHQAAoR0AAIwdAACnHQAApx0AAIwdAAChHQAAjB0AAGkAZGlpAHZpaWQAAJAdAACQHQAAix0AAKAdAACQHQAAoB0AAJAdAACPHQAAoB0AAJAdAACnHQAAoB0AAJAdAACnHQAArh0AAHZpaWlkAAAAoB0AAJAdAACuHQAApx0AAJEdAACOHQAAkR0AAKcdAACOHQAAkR0AAK4dAACRHQAArh0AAJEdAACnHQAAZGlpaQAAAACtHQAAkB0AAKcdAABmaWlpAAAAAKAdAACQHQAAkB0AAKgdAACgHQAAkB0AAJAdAACoHQAAkR0AAJAdAACQHQAAkB0AAJAdAACoHQAAoB0AAJAdAAChHQAAoR0AAJAdAACgHQAAkB0AAG0dAACgHQAAkB0AAIUdAAChHQAAkR0AAAAAAACgHQAAkB0AAK4dAACuHQAApx0AAHZpaWRkaQAAjR0AAJEdAEGQKwtBGQAKABkZGQAAAAAFAAAAAAAACQAAAAALAAAAAAAAAAAZABEKGRkZAwoHAAEACQsYAAAJBgsAAAsABhkAAAAZGRkAQeErCyEOAAAAAAAAAAAZAAoNGRkZAA0AAAIACQ4AAAAJAA4AAA4AQZssCwEMAEGnLAsVEwAAAAATAAAAAAkMAAAAAAAMAAAMAEHVLAsBEABB4SwLFQ8AAAAEDwAAAAAJEAAAAAAAEAAAEABBjy0LARIAQZstCx4RAAAAABEAAAAACRIAAAAAABIAABIAABoAAAAaGhoAQdItCw4aAAAAGhoaAAAAAAAACQBBgy4LARQAQY8uCxUXAAAAABcAAAAACRQAAAAAABQAABQAQb0uCwEWAEHJLgsnFQAAAAAVAAAAAAkWAAAAAAAWAAAWAAAwMTIzNDU2Nzg5QUJDREVGAEGULwsBzwBBvC8LCP//////////AEGAMAsJ4CEBAAAAAAAFAEGUMAsBygBBrDALCssAAADMAAAAyB0AQcQwCwECAEHUMAsI//////////8AQZgxCwEFAEGkMQsBzQBBvDELDssAAADOAAAA2B0AAAAEAEHUMQsBAQBB5DELBf////8KAEGoMgsB0A==")){var M=S;S=n.locateFile?n.locateFile(M,o):o+M}function W(){var e=S;try{if(e==S&&a)return new Uint8Array(a);if(N(e))try{var t=je(e.slice(37)),n=new Uint8Array(t.length);for(e=0;e<t.length;++e)n[e]=t.charCodeAt(e);var i=n}catch(Zx){throw Error("Converting base64 string to bytes failed.")}else i=void 0;if(i)return i;throw"both async and sync fetching of the wasm failed"}catch(Zx){F(Zx)}}function k(e){for(;0<e.length;)e.shift()(n)}function T(e){if(void 0===e)return"_unknown";var t=(e=e.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return 48<=t&&57>=t?"_"+e:e}function V(e,t){return e=T(e),function(){return t.apply(this,arguments)}}var L=[{},{value:void 0},{value:null},{value:!0},{value:!1}],H=[];function Q(e){var t=Error,n=V(e,(function(t){this.name=e,this.message=t,void 0!==(t=Error(t).stack)&&(this.stack=this.toString()+"\n"+t.replace(/^Error(:[^\n]*)?\n/,""))}));return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},n}var K=void 0;function X(e){throw new K(e)}var Y=e=>(e||X("Cannot use deleted val. handle = "+e),L[e].value),z=e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var t=H.length?H.pop():L.length;return L[t]={ga:1,value:e},t}},P=void 0,U=void 0;function _(e){for(var t="";d[e];)t+=U[d[e++]];return t}var O=[];function J(){for(;O.length;){var e=O.pop();e.M.$=!1,e.delete()}}var j=void 0,q={};function $(e,t){for(void 0===t&&X("ptr should not be undefined");e.R;)t=e.ba(t),e=e.R;return t}var ee={};function te(e){var t=_(e=$e(e));return nt(e),t}function ne(e,t){var n=ee[e];return void 0===n&&X(t+" has unknown type "+te(e)),n}function ie(){}var re=!1;function se(e){--e.count.value,0===e.count.value&&(e.T?e.U.W(e.T):e.P.N.W(e.O))}function oe(e,t,n){return t===n?e:void 0===n.R||null===(e=oe(e,t,n.R))?null:n.na(e)}var ae={};var le=void 0;function ce(e){throw new le(e)}function ge(e,t){return t.P&&t.O||ce("makeClassHandle requires ptr and ptrType"),!!t.U!==!!t.T&&ce("Both smartPtrType and smartPtr must be specified"),t.count={value:1},ue(Object.create(e,{M:{value:t}}))}function ue(e){return"undefined"===typeof FinalizationRegistry?(ue=e=>e,e):(re=new FinalizationRegistry((e=>{se(e.M)})),ue=e=>{var t=e.M;return t.T&&re.register(e,{M:t},e),e},ie=e=>{re.unregister(e)},ue(e))}var Ae={};function de(e){for(;e.length;){var t=e.pop();e.pop()(t)}}function he(e){return this.fromWireType(p[e>>2])}var Ie={},pe={};function Ce(e,t,n){function i(t){(t=n(t)).length!==e.length&&ce("Mismatched type converter count");for(var i=0;i<e.length;++i)fe(e[i],t[i])}e.forEach((function(e){pe[e]=t}));var r=Array(t.length),s=[],o=0;t.forEach(((e,t)=>{ee.hasOwnProperty(e)?r[t]=ee[e]:(s.push(e),Ie.hasOwnProperty(e)||(Ie[e]=[]),Ie[e].push((()=>{r[t]=ee[e],++o===s.length&&i(r)})))})),0===s.length&&i(r)}function me(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}function fe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var i=t.name;if(e||X('type "'+i+'" must have a positive integer typeid pointer'),ee.hasOwnProperty(e)){if(n.ua)return;X("Cannot register type '"+i+"' twice")}ee[e]=t,delete pe[e],Ie.hasOwnProperty(e)&&(t=Ie[e],delete Ie[e],t.forEach((e=>e())))}function ye(e){X(e.M.P.N.name+" instance already deleted")}function be(){}function Be(e,t,n){if(void 0===e[t].S){var i=e[t];e[t]=function(){return e[t].S.hasOwnProperty(arguments.length)||X("Function '"+n+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[t].S+")!"),e[t].S[arguments.length].apply(this,arguments)},e[t].S=[],e[t].S[i.Z]=i}}function ve(e,t,n,i,r,s,o,a){this.name=e,this.constructor=t,this.X=n,this.W=i,this.R=r,this.pa=s,this.ba=o,this.na=a,this.ja=[]}function we(e,t,n){for(;t!==n;)t.ba||X("Expected null or instance of "+n.name+", got an instance of "+t.name),e=t.ba(e),t=t.R;return e}function Ge(e,t){return null===t?(this.ea&&X("null is not a valid "+this.name),0):(t.M||X('Cannot pass "'+We(t)+'" as a '+this.name),t.M.O||X("Cannot pass deleted object as a pointer of type "+this.name),we(t.M.O,t.M.P.N,this.N))}function Ee(e,t){if(null===t){if(this.ea&&X("null is not a valid "+this.name),this.da){var n=this.fa();return null!==e&&e.push(this.W,n),n}return 0}if(t.M||X('Cannot pass "'+We(t)+'" as a '+this.name),t.M.O||X("Cannot pass deleted object as a pointer of type "+this.name),!this.ca&&t.M.P.ca&&X("Cannot convert argument of type "+(t.M.U?t.M.U.name:t.M.P.name)+" to parameter type "+this.name),n=we(t.M.O,t.M.P.N,this.N),this.da)switch(void 0===t.M.T&&X("Passing raw pointer to smart pointer is illegal"),this.Ba){case 0:t.M.U===this?n=t.M.T:X("Cannot convert argument of type "+(t.M.U?t.M.U.name:t.M.P.name)+" to parameter type "+this.name);break;case 1:n=t.M.T;break;case 2:if(t.M.U===this)n=t.M.T;else{var i=t.clone();n=this.xa(n,z((function(){i.delete()}))),null!==e&&e.push(this.W,n)}break;default:X("Unsupporting sharing policy")}return n}function xe(e,t){return null===t?(this.ea&&X("null is not a valid "+this.name),0):(t.M||X('Cannot pass "'+We(t)+'" as a '+this.name),t.M.O||X("Cannot pass deleted object as a pointer of type "+this.name),t.M.P.ca&&X("Cannot convert argument of type "+t.M.P.name+" to parameter type "+this.name),we(t.M.O,t.M.P.N,this.N))}function Se(e,t,n,i){this.name=e,this.N=t,this.ea=n,this.ca=i,this.da=!1,this.W=this.xa=this.fa=this.ka=this.Ba=this.wa=void 0,void 0!==t.R?this.toWireType=Ee:(this.toWireType=i?Ge:xe,this.V=null)}function Re(e,t){var i=(e=_(e)).includes("j")?function(e,t){var i=[];return function(){if(i.length=0,Object.assign(i,arguments),e.includes("j")){var r=n["dynCall_"+e];r=i&&i.length?r.apply(null,[t].concat(i)):r.call(null,t)}else r=v.get(t).apply(null,i);return r}}(e,t):v.get(t);return"function"!=typeof i&&X("unknown function pointer with signature "+e+": "+t),i}var Ze=void 0;function De(e,t){var n=[],i={};throw t.forEach((function e(t){i[t]||ee[t]||(pe[t]?pe[t].forEach(e):(n.push(t),i[t]=!0))})),new Ze(e+": "+n.map(te).join([", "]))}function Fe(e,t,n,i,r){var s=t.length;2>s&&X("argTypes array size mismatch! Must at least get return value and 'this' types!");var o=null!==t[1]&&null!==n,a=!1;for(n=1;n<t.length;++n)if(null!==t[n]&&void 0===t[n].V){a=!0;break}var l="void"!==t[0].name,c=s-2,g=Array(c),u=[],A=[];return function(){if(arguments.length!==c&&X("function "+e+" called with "+arguments.length+" arguments, expected "+c+" args!"),A.length=0,u.length=o?2:1,u[0]=r,o){var n=t[1].toWireType(A,this);u[1]=n}for(var s=0;s<c;++s)g[s]=t[s+2].toWireType(A,arguments[s]),u.push(g[s]);if(s=i.apply(null,u),a)de(A);else for(var d=o?1:2;d<t.length;d++){var h=1===d?n:g[d-2];null!==t[d].V&&t[d].V(h)}return n=l?t[0].fromWireType(s):void 0}}function Ne(e,t){for(var n=[],i=0;i<e;i++)n.push(C[t+4*i>>2]);return n}function Me(e){4<e&&0===--L[e].ga&&(L[e]=void 0,H.push(e))}function We(e){if(null===e)return"null";var t=typeof e;return"object"===t||"array"===t||"function"===t?e.toString():""+e}function ke(e,t){switch(t){case 2:return function(e){return this.fromWireType(m[e>>2])};case 3:return function(e){return this.fromWireType(f[e>>3])};default:throw new TypeError("Unknown float type: "+e)}}function Te(e,t,n){switch(t){case 0:return n?function(e){return A[e]}:function(e){return d[e]};case 1:return n?function(e){return h[e>>1]}:function(e){return I[e>>1]};case 2:return n?function(e){return p[e>>2]}:function(e){return C[e>>2]};default:throw new TypeError("Unknown integer type: "+e)}}function Ve(e,t){for(var n="",i=0;!(i>=t/2);++i){var r=h[e+2*i>>1];if(0==r)break;n+=String.fromCharCode(r)}return n}function Le(e,t,n){if(void 0===n&&(n=2147483647),2>n)return 0;var i=t;n=(n-=2)<2*e.length?n/2:e.length;for(var r=0;r<n;++r)h[t>>1]=e.charCodeAt(r),t+=2;return h[t>>1]=0,t-i}function He(e){return 2*e.length}function Qe(e,t){for(var n=0,i="";!(n>=t/4);){var r=p[e+4*n>>2];if(0==r)break;++n,65536<=r?(r-=65536,i+=String.fromCharCode(55296|r>>10,56320|1023&r)):i+=String.fromCharCode(r)}return i}function Ke(e,t,n){if(void 0===n&&(n=2147483647),4>n)return 0;var i=t;n=i+n-4;for(var r=0;r<e.length;++r){var s=e.charCodeAt(r);if(55296<=s&&57343>=s)s=65536+((1023&s)<<10)|1023&e.charCodeAt(++r);if(p[t>>2]=s,(t+=4)+4>n)break}return p[t>>2]=0,t-i}function Xe(e){for(var t=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);55296<=i&&57343>=i&&++n,t+=4}return t}var Ye={};function ze(e){var t=Ye[e];return void 0===t?_(e):t}var Pe=[];var Ue=[],_e=[null,[],[]];K=n.BindingError=Q("BindingError"),n.count_emval_handles=function(){for(var e=0,t=5;t<L.length;++t)void 0!==L[t]&&++e;return e},n.get_first_emval=function(){for(var e=5;e<L.length;++e)if(void 0!==L[e])return L[e];return null},P=n.PureVirtualError=Q("PureVirtualError");for(var Oe=Array(256),Je=0;256>Je;++Je)Oe[Je]=String.fromCharCode(Je);U=Oe,n.getInheritedInstanceCount=function(){return Object.keys(q).length},n.getLiveInheritedInstances=function(){var e,t=[];for(e in q)q.hasOwnProperty(e)&&t.push(q[e]);return t},n.flushPendingDeletes=J,n.setDelayFunction=function(e){j=e,O.length&&j&&j(J)},le=n.InternalError=Q("InternalError"),be.prototype.isAliasOf=function(e){if(!(this instanceof be&&e instanceof be))return!1;var t=this.M.P.N,n=this.M.O,i=e.M.P.N;for(e=e.M.O;t.R;)n=t.ba(n),t=t.R;for(;i.R;)e=i.ba(e),i=i.R;return t===i&&n===e},be.prototype.clone=function(){if(this.M.O||ye(this),this.M.aa)return this.M.count.value+=1,this;var e=ue,t=Object,n=t.create,i=Object.getPrototypeOf(this),r=this.M;return(e=e(n.call(t,i,{M:{value:{count:r.count,$:r.$,aa:r.aa,O:r.O,P:r.P,T:r.T,U:r.U}}}))).M.count.value+=1,e.M.$=!1,e},be.prototype.delete=function(){this.M.O||ye(this),this.M.$&&!this.M.aa&&X("Object already scheduled for deletion"),ie(this),se(this.M),this.M.aa||(this.M.T=void 0,this.M.O=void 0)},be.prototype.isDeleted=function(){return!this.M.O},be.prototype.deleteLater=function(){return this.M.O||ye(this),this.M.$&&!this.M.aa&&X("Object already scheduled for deletion"),O.push(this),1===O.length&&j&&j(J),this.M.$=!0,this},Se.prototype.qa=function(e){return this.ka&&(e=this.ka(e)),e},Se.prototype.ha=function(e){this.W&&this.W(e)},Se.prototype.argPackAdvance=8,Se.prototype.readValueFromPointer=he,Se.prototype.deleteObject=function(e){null!==e&&e.delete()},Se.prototype.fromWireType=function(e){function t(){return this.da?ge(this.N.X,{P:this.wa,O:n,U:this,T:e}):ge(this.N.X,{P:this,O:e})}var n=this.qa(e);if(!n)return this.ha(e),null;var i=function(e,t){return t=$(e,t),q[t]}(this.N,n);if(void 0!==i)return 0===i.M.count.value?(i.M.O=n,i.M.T=e,i.clone()):(i=i.clone(),this.ha(e),i);if(i=this.N.pa(n),!(i=ae[i]))return t.call(this);i=this.ca?i.la:i.pointerType;var r=oe(n,this.N,i.N);return null===r?t.call(this):this.da?ge(i.N.X,{P:i,O:r,U:this,T:e}):ge(i.N.X,{P:i,O:r})},Ze=n.UnboundTypeError=Q("UnboundTypeError");var je="function"==typeof atob?atob:function(e){var t="",n=0;e=e.replace(/[^A-Za-z0-9\+\/=]/g,"");do{var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(n++)),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(n++)),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(n++)),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(n++));i=i<<2|r>>4,r=(15&r)<<4|s>>2;var a=(3&s)<<6|o;t+=String.fromCharCode(i),64!==s&&(t+=String.fromCharCode(r)),64!==o&&(t+=String.fromCharCode(a))}while(n<e.length);return t},qe={l:function(e,t,n,i){F("Assertion failed: "+(e?b(d,e):"")+", at: "+[t?t?b(d,t):"":"unknown filename",n,i?i?b(d,i):"":"unknown function"])},q:function(e,t,n){e=_(e),t=ne(t,"wrapper"),n=Y(n);var i=[].slice,r=t.N,s=r.X,o=r.R.X,a=r.R.constructor;for(var l in e=V(e,(function(){r.R.ja.forEach(function(e){if(this[e]===o[e])throw new P("Pure virtual function "+e+" must be implemented in JavaScript")}.bind(this)),Object.defineProperty(this,"__parent",{value:s}),this.__construct.apply(this,i.call(arguments))})),s.__construct=function(){this===s&&X("Pass correct 'this' to __construct");var e=a.implement.apply(void 0,[this].concat(i.call(arguments)));ie(e);var t=e.M;e.notifyOnDestruction(),t.aa=!0,Object.defineProperties(this,{M:{value:t}}),ue(this),e=t.O,e=$(r,e),q.hasOwnProperty(e)?X("Tried to register registered instance: "+e):q[e]=this},s.__destruct=function(){this===s&&X("Pass correct 'this' to __destruct"),ie(this);var e=this.M.O;e=$(r,e),q.hasOwnProperty(e)?delete q[e]:X("Tried to unregister unregistered instance: "+e)},e.prototype=Object.create(s),n)e.prototype[l]=n[l];return z(e)},j:function(e){var t=Ae[e];delete Ae[e];var n=t.fa,i=t.W,r=t.ia,s=r.map((e=>e.ta)).concat(r.map((e=>e.za)));Ce([e],s,(e=>{var s={};return r.forEach(((t,n)=>{var i=e[n],o=t.ra,a=t.sa,l=e[n+r.length],c=t.ya,g=t.Aa;s[t.oa]={read:e=>i.fromWireType(o(a,e)),write:(e,t)=>{var n=[];c(g,e,l.toWireType(n,t)),de(n)}}})),[{name:t.name,fromWireType:function(e){var t,n={};for(t in s)n[t]=s[t].read(e);return i(e),n},toWireType:function(e,t){for(var r in s)if(!(r in t))throw new TypeError('Missing field:  "'+r+'"');var o=n();for(r in s)s[r].write(o,t[r]);return null!==e&&e.push(i,o),o},argPackAdvance:8,readValueFromPointer:he,V:i}]}))},v:function(){},B:function(e,t,n,i,r){var s=me(n);fe(e,{name:t=_(t),fromWireType:function(e){return!!e},toWireType:function(e,t){return t?i:r},argPackAdvance:8,readValueFromPointer:function(e){if(1===n)var i=A;else if(2===n)i=h;else{if(4!==n)throw new TypeError("Unknown boolean type size: "+t);i=p}return this.fromWireType(i[e>>s])},V:null})},f:function(e,t,i,r,s,o,a,l,c,g,u,A,d){u=_(u),o=Re(s,o),l&&(l=Re(a,l)),g&&(g=Re(c,g)),d=Re(A,d);var h=T(u);!function(e,t){n.hasOwnProperty(e)?(X("Cannot register public name '"+e+"' twice"),Be(n,e,e),n.hasOwnProperty(void 0)&&X("Cannot register multiple overloads of a function with the same number of arguments (undefined)!"),n[e].S[void 0]=t):n[e]=t}(h,(function(){De("Cannot construct "+u+" due to unbound types",[r])})),Ce([e,t,i],r?[r]:[],(function(t){if(t=t[0],r)var i=t.N,s=i.X;else s=be.prototype;t=V(h,(function(){if(Object.getPrototypeOf(this)!==a)throw new K("Use 'new' to construct "+u);if(void 0===c.Y)throw new K(u+" has no accessible constructor");var e=c.Y[arguments.length];if(void 0===e)throw new K("Tried to invoke ctor of "+u+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(c.Y).toString()+") parameters instead!");return e.apply(this,arguments)}));var a=Object.create(s,{constructor:{value:t}});t.prototype=a;var c=new ve(u,t,a,d,i,o,l,g);i=new Se(u,c,!0,!1),s=new Se(u+"*",c,!1,!1);var A=new Se(u+" const*",c,!1,!0);return ae[e]={pointerType:s,la:A},function(e,t){n.hasOwnProperty(e)||ce("Replacing nonexistant public symbol"),n[e]=t,n[e].Z=void 0}(h,t),[i,s,A]}))},d:function(e,t,n,i,r,s,o){var a=Ne(n,i);t=_(t),s=Re(r,s),Ce([],[e],(function(e){function i(){De("Cannot call "+r+" due to unbound types",a)}var r=(e=e[0]).name+"."+t;t.startsWith("@@")&&(t=Symbol[t.substring(2)]);var l=e.N.constructor;return void 0===l[t]?(i.Z=n-1,l[t]=i):(Be(l,t,r),l[t].S[n-1]=i),Ce([],a,(function(e){return e=Fe(r,[e[0],null].concat(e.slice(1)),null,s,o),void 0===l[t].S?(e.Z=n-1,l[t]=e):l[t].S[n-1]=e,[]})),[]}))},p:function(e,t,n,i,r,s){0<t||F();var o=Ne(t,n);r=Re(i,r),Ce([],[e],(function(e){var n="constructor "+(e=e[0]).name;if(void 0===e.N.Y&&(e.N.Y=[]),void 0!==e.N.Y[t-1])throw new K("Cannot register multiple constructors with identical number of parameters ("+(t-1)+") for class '"+e.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return e.N.Y[t-1]=()=>{De("Cannot construct "+e.name+" due to unbound types",o)},Ce([],o,(function(i){return i.splice(1,0,null),e.N.Y[t-1]=Fe(n,i,null,r,s),[]})),[]}))},a:function(e,t,n,i,r,s,o,a){var l=Ne(n,i);t=_(t),s=Re(r,s),Ce([],[e],(function(e){function i(){De("Cannot call "+r+" due to unbound types",l)}var r=(e=e[0]).name+"."+t;t.startsWith("@@")&&(t=Symbol[t.substring(2)]),a&&e.N.ja.push(t);var c=e.N.X,g=c[t];return void 0===g||void 0===g.S&&g.className!==e.name&&g.Z===n-2?(i.Z=n-2,i.className=e.name,c[t]=i):(Be(c,t,r),c[t].S[n-2]=i),Ce([],l,(function(i){return i=Fe(r,i,e,s,o),void 0===c[t].S?(i.Z=n-2,c[t]=i):c[t].S[n-2]=i,[]})),[]}))},A:function(e,t){fe(e,{name:t=_(t),fromWireType:function(e){var t=Y(e);return Me(e),t},toWireType:function(e,t){return z(t)},argPackAdvance:8,readValueFromPointer:he,V:null})},n:function(e,t,n){n=me(n),fe(e,{name:t=_(t),fromWireType:function(e){return e},toWireType:function(e,t){return t},argPackAdvance:8,readValueFromPointer:ke(t,n),V:null})},e:function(e,t,n,i,r){t=_(t),-1===r&&(r=4294967295),r=me(n);var s=e=>e;if(0===i){var o=32-8*n;s=e=>e<<o>>>o}n=t.includes("unsigned")?function(e,t){return t>>>0}:function(e,t){return t},fe(e,{name:t,fromWireType:s,toWireType:n,argPackAdvance:8,readValueFromPointer:Te(t,r,0!==i),V:null})},b:function(e,t,n){function i(e){var t=C;return new r(u,t[(e>>=2)+1],t[e])}var r=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][t];fe(e,{name:n=_(n),fromWireType:i,argPackAdvance:8,readValueFromPointer:i},{ua:!0})},o:function(e,t){var n="std::string"===(t=_(t));fe(e,{name:t,fromWireType:function(e){var t=C[e>>2],i=e+4;if(n)for(var r=i,s=0;s<=t;++s){var o=i+s;if(s==t||0==d[o]){if(r=r?b(d,r,o-r):"",void 0===a)var a=r;else a+=String.fromCharCode(0),a+=r;r=o+1}}else{for(a=Array(t),s=0;s<t;++s)a[s]=String.fromCharCode(d[i+s]);a=a.join("")}return nt(e),a},toWireType:function(e,t){t instanceof ArrayBuffer&&(t=new Uint8Array(t));var i,r="string"==typeof t;if(r||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int8Array||X("Cannot pass non-string to std::string"),n&&r){var s=0;for(i=0;i<t.length;++i){var o=t.charCodeAt(i);127>=o?s++:2047>=o?s+=2:55296<=o&&57343>=o?(s+=4,++i):s+=3}i=s}else i=t.length;if(o=(s=tt(4+i+1))+4,C[s>>2]=i,n&&r){if(r=o,o=i+1,i=d,0<o){o=r+o-1;for(var a=0;a<t.length;++a){var l=t.charCodeAt(a);if(55296<=l&&57343>=l)l=65536+((1023&l)<<10)|1023&t.charCodeAt(++a);if(127>=l){if(r>=o)break;i[r++]=l}else{if(2047>=l){if(r+1>=o)break;i[r++]=192|l>>6}else{if(65535>=l){if(r+2>=o)break;i[r++]=224|l>>12}else{if(r+3>=o)break;i[r++]=240|l>>18,i[r++]=128|l>>12&63}i[r++]=128|l>>6&63}i[r++]=128|63&l}}i[r]=0}}else if(r)for(r=0;r<i;++r)255<(a=t.charCodeAt(r))&&(nt(o),X("String has UTF-16 code units that do not fit in 8 bits")),d[o+r]=a;else for(r=0;r<i;++r)d[o+r]=t[r];return null!==e&&e.push(nt,s),s},argPackAdvance:8,readValueFromPointer:he,V:function(e){nt(e)}})},i:function(e,t,n){if(n=_(n),2===t)var i=Ve,r=Le,s=He,o=()=>I,a=1;else 4===t&&(i=Qe,r=Ke,s=Xe,o=()=>C,a=2);fe(e,{name:n,fromWireType:function(e){for(var n,r=C[e>>2],s=o(),l=e+4,c=0;c<=r;++c){var g=e+4+c*t;c!=r&&0!=s[g>>a]||(l=i(l,g-l),void 0===n?n=l:(n+=String.fromCharCode(0),n+=l),l=g+t)}return nt(e),n},toWireType:function(e,i){"string"!=typeof i&&X("Cannot pass non-string to C++ string type "+n);var o=s(i),l=tt(4+o+t);return C[l>>2]=o>>a,r(i,l+4,o+t),null!==e&&e.push(nt,l),l},argPackAdvance:8,readValueFromPointer:he,V:function(e){nt(e)}})},k:function(e,t,n,i,r,s){Ae[e]={name:_(t),fa:Re(n,i),W:Re(r,s),ia:[]}},h:function(e,t,n,i,r,s,o,a,l,c){Ae[e].ia.push({oa:_(t),ta:n,ra:Re(i,r),sa:s,za:o,ya:Re(a,l),Aa:c})},C:function(e,t){fe(e,{va:!0,name:t=_(t),argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},s:function(e,t,n,i,r){e=Pe[e],t=Y(t),n=ze(n);var s=[];return C[i>>2]=z(s),e(t,n,s,r)},t:function(e,t,n,i){(e=Pe[e])(t=Y(t),n=ze(n),null,i)},g:Me,m:function(e,t){var n=function(e,t){for(var n=Array(e),i=0;i<e;++i)n[i]=ne(C[t+4*i>>2],"parameter "+i);return n}(e,t),i=n[0];t=i.name+"_$"+n.slice(1).map((function(e){return e.name})).join("_")+"$";var r=Ue[t];if(void 0!==r)return r;var s=Array(e-1);return r=function(e){var t=Pe.length;return Pe.push(e),t}(((t,r,o,a)=>{for(var l=0,c=0;c<e-1;++c)s[c]=n[c+1].readValueFromPointer(a+l),l+=n[c+1].argPackAdvance;for(t=t[r].apply(t,s),c=0;c<e-1;++c)n[c+1].ma&&n[c+1].ma(s[c]);if(!i.va)return i.toWireType(o,t)})),Ue[t]=r},D:function(e){4<e&&(L[e].ga+=1)},r:function(e){de(Y(e)),Me(e)},c:function(){F("")},x:function(e,t,n){d.copyWithin(e,t,t+n)},w:function(e){var t=d.length;if(2147483648<(e>>>=0))return!1;for(var n=1;4>=n;n*=2){var i=t*(1+.2/n);i=Math.min(i,e+100663296);var r=Math;i=Math.max(e,i),r=r.min.call(r,2147483648,i+(65536-i%65536)%65536);e:{try{g.grow(r-u.byteLength+65535>>>16),B();var s=1;break e}catch(Qx){}s=void 0}if(s)return!0}return!1},z:function(){return 52},u:function(){return 70},y:function(e,t,n,i){for(var r=0,s=0;s<n;s++){var o=C[t>>2],a=C[t+4>>2];t+=8;for(var g=0;g<a;g++){var u=d[o+g],A=_e[e];0===u||10===u?((1===e?l:c)(b(A,0)),A.length=0):A.push(u)}r+=a}return C[i>>2]=r,0}};!function(){function e(e){n.asm=e.exports,g=n.asm.E,B(),v=n.asm.J,G.unshift(n.asm.F),R--,n.monitorRunDependencies&&n.monitorRunDependencies(R),0==R&&(null!==Z&&(clearInterval(Z),Z=null),D&&(e=D,D=null,e()))}function t(t){e(t.instance)}function i(e){return(a||"function"!=typeof fetch?Promise.resolve().then((function(){return W()})):fetch(S,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+S+"'";return e.arrayBuffer()})).catch((function(){return W()}))).then((function(e){return WebAssembly.instantiate(e,s)})).then((function(e){return e})).then(e,(function(e){c("failed to asynchronously prepare wasm: "+e),F(e)}))}var s={a:qe};if(R++,n.monitorRunDependencies&&n.monitorRunDependencies(R),n.instantiateWasm)try{return n.instantiateWasm(s,e)}catch(Ow){c("Module.instantiateWasm callback failed with error: "+Ow),r(Ow)}(a||"function"!=typeof WebAssembly.instantiateStreaming||N(S)||"function"!=typeof fetch?i(t):fetch(S,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,s).then(t,(function(e){return c("wasm streaming compile failed: "+e),c("falling back to ArrayBuffer instantiation"),i(t)}))}))).catch(r)}(),n.___wasm_call_ctors=function(){return(n.___wasm_call_ctors=n.asm.F).apply(null,arguments)};var $e=n.___getTypeName=function(){return($e=n.___getTypeName=n.asm.G).apply(null,arguments)};n.__embind_initialize_bindings=function(){return(n.__embind_initialize_bindings=n.asm.H).apply(null,arguments)};var et,tt=n._malloc=function(){return(tt=n._malloc=n.asm.I).apply(null,arguments)},nt=n._free=function(){return(nt=n._free=n.asm.K).apply(null,arguments)};function it(){function e(){if(!et&&(et=!0,n.calledRun=!0,!y)){if(k(G),i(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;){var e=n.postRun.shift();E.unshift(e)}k(E)}}if(!(0<R)){if(n.preRun)for("function"==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)x();k(w),0<R||(n.setStatus?(n.setStatus("Running..."),setTimeout((function(){setTimeout((function(){n.setStatus("")}),1),e()}),1)):e())}}if(n.dynCall_jiji=function(){return(n.dynCall_jiji=n.asm.L).apply(null,arguments)},D=function e(){et||it(),et||(D=e)},n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);0<n.preInit.length;)n.preInit.pop()();return it(),t.ready}})();const xS=ES;let SS=function(e){return e[e.Auto=0]="Auto",e[e.FlexStart=1]="FlexStart",e[e.Center=2]="Center",e[e.FlexEnd=3]="FlexEnd",e[e.Stretch=4]="Stretch",e[e.Baseline=5]="Baseline",e[e.SpaceBetween=6]="SpaceBetween",e[e.SpaceAround=7]="SpaceAround",e[e.SpaceEvenly=8]="SpaceEvenly",e}({}),RS=function(e){return e[e.Width=0]="Width",e[e.Height=1]="Height",e}({}),ZS=function(e){return e[e.Inherit=0]="Inherit",e[e.LTR=1]="LTR",e[e.RTL=2]="RTL",e}({}),DS=function(e){return e[e.Flex=0]="Flex",e[e.None=1]="None",e}({}),FS=function(e){return e[e.Left=0]="Left",e[e.Top=1]="Top",e[e.Right=2]="Right",e[e.Bottom=3]="Bottom",e[e.Start=4]="Start",e[e.End=5]="End",e[e.Horizontal=6]="Horizontal",e[e.Vertical=7]="Vertical",e[e.All=8]="All",e}({}),NS=function(e){return e[e.None=0]="None",e[e.StretchFlexBasis=1]="StretchFlexBasis",e[e.AbsolutePositioningIncorrect=2]="AbsolutePositioningIncorrect",e[e.AbsolutePercentAgainstInnerSize=4]="AbsolutePercentAgainstInnerSize",e[e.All=2147483647]="All",e[e.Classic=2147483646]="Classic",e}({}),MS=function(e){return e[e.WebFlexBasis=0]="WebFlexBasis",e}({}),WS=function(e){return e[e.Column=0]="Column",e[e.ColumnReverse=1]="ColumnReverse",e[e.Row=2]="Row",e[e.RowReverse=3]="RowReverse",e}({}),kS=function(e){return e[e.Column=0]="Column",e[e.Row=1]="Row",e[e.All=2]="All",e}({}),TS=function(e){return e[e.FlexStart=0]="FlexStart",e[e.Center=1]="Center",e[e.FlexEnd=2]="FlexEnd",e[e.SpaceBetween=3]="SpaceBetween",e[e.SpaceAround=4]="SpaceAround",e[e.SpaceEvenly=5]="SpaceEvenly",e}({}),VS=function(e){return e[e.Error=0]="Error",e[e.Warn=1]="Warn",e[e.Info=2]="Info",e[e.Debug=3]="Debug",e[e.Verbose=4]="Verbose",e[e.Fatal=5]="Fatal",e}({}),LS=function(e){return e[e.Undefined=0]="Undefined",e[e.Exactly=1]="Exactly",e[e.AtMost=2]="AtMost",e}({}),HS=function(e){return e[e.Default=0]="Default",e[e.Text=1]="Text",e}({}),QS=function(e){return e[e.Visible=0]="Visible",e[e.Hidden=1]="Hidden",e[e.Scroll=2]="Scroll",e}({}),KS=function(e){return e[e.Static=0]="Static",e[e.Relative=1]="Relative",e[e.Absolute=2]="Absolute",e}({}),XS=function(e){return e[e.Undefined=0]="Undefined",e[e.Point=1]="Point",e[e.Percent=2]="Percent",e[e.Auto=3]="Auto",e}({}),YS=function(e){return e[e.NoWrap=0]="NoWrap",e[e.Wrap=1]="Wrap",e[e.WrapReverse=2]="WrapReverse",e}({});const zS={ALIGN_AUTO:SS.Auto,ALIGN_FLEX_START:SS.FlexStart,ALIGN_CENTER:SS.Center,ALIGN_FLEX_END:SS.FlexEnd,ALIGN_STRETCH:SS.Stretch,ALIGN_BASELINE:SS.Baseline,ALIGN_SPACE_BETWEEN:SS.SpaceBetween,ALIGN_SPACE_AROUND:SS.SpaceAround,ALIGN_SPACE_EVENLY:SS.SpaceEvenly,DIMENSION_WIDTH:RS.Width,DIMENSION_HEIGHT:RS.Height,DIRECTION_INHERIT:ZS.Inherit,DIRECTION_LTR:ZS.LTR,DIRECTION_RTL:ZS.RTL,DISPLAY_FLEX:DS.Flex,DISPLAY_NONE:DS.None,EDGE_LEFT:FS.Left,EDGE_TOP:FS.Top,EDGE_RIGHT:FS.Right,EDGE_BOTTOM:FS.Bottom,EDGE_START:FS.Start,EDGE_END:FS.End,EDGE_HORIZONTAL:FS.Horizontal,EDGE_VERTICAL:FS.Vertical,EDGE_ALL:FS.All,ERRATA_NONE:NS.None,ERRATA_STRETCH_FLEX_BASIS:NS.StretchFlexBasis,ERRATA_ABSOLUTE_POSITIONING_INCORRECT:NS.AbsolutePositioningIncorrect,ERRATA_ABSOLUTE_PERCENT_AGAINST_INNER_SIZE:NS.AbsolutePercentAgainstInnerSize,ERRATA_ALL:NS.All,ERRATA_CLASSIC:NS.Classic,EXPERIMENTAL_FEATURE_WEB_FLEX_BASIS:MS.WebFlexBasis,FLEX_DIRECTION_COLUMN:WS.Column,FLEX_DIRECTION_COLUMN_REVERSE:WS.ColumnReverse,FLEX_DIRECTION_ROW:WS.Row,FLEX_DIRECTION_ROW_REVERSE:WS.RowReverse,GUTTER_COLUMN:kS.Column,GUTTER_ROW:kS.Row,GUTTER_ALL:kS.All,JUSTIFY_FLEX_START:TS.FlexStart,JUSTIFY_CENTER:TS.Center,JUSTIFY_FLEX_END:TS.FlexEnd,JUSTIFY_SPACE_BETWEEN:TS.SpaceBetween,JUSTIFY_SPACE_AROUND:TS.SpaceAround,JUSTIFY_SPACE_EVENLY:TS.SpaceEvenly,LOG_LEVEL_ERROR:VS.Error,LOG_LEVEL_WARN:VS.Warn,LOG_LEVEL_INFO:VS.Info,LOG_LEVEL_DEBUG:VS.Debug,LOG_LEVEL_VERBOSE:VS.Verbose,LOG_LEVEL_FATAL:VS.Fatal,MEASURE_MODE_UNDEFINED:LS.Undefined,MEASURE_MODE_EXACTLY:LS.Exactly,MEASURE_MODE_AT_MOST:LS.AtMost,NODE_TYPE_DEFAULT:HS.Default,NODE_TYPE_TEXT:HS.Text,OVERFLOW_VISIBLE:QS.Visible,OVERFLOW_HIDDEN:QS.Hidden,OVERFLOW_SCROLL:QS.Scroll,POSITION_TYPE_STATIC:KS.Static,POSITION_TYPE_RELATIVE:KS.Relative,POSITION_TYPE_ABSOLUTE:KS.Absolute,UNIT_UNDEFINED:XS.Undefined,UNIT_POINT:XS.Point,UNIT_PERCENT:XS.Percent,UNIT_AUTO:XS.Auto,WRAP_NO_WRAP:YS.NoWrap,WRAP_WRAP:YS.Wrap,WRAP_WRAP_REVERSE:YS.WrapReverse};function PS(e){function t(e,t,n){const i=e[t];e[t]=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.call(this,i,...t)}}for(const n of["setPosition","setMargin","setFlexBasis","setWidth","setHeight","setMinWidth","setMinHeight","setMaxWidth","setMaxHeight","setPadding","setGap"]){const i={[XS.Point]:e.Node.prototype[n],[XS.Percent]:e.Node.prototype["".concat(n,"Percent")],[XS.Auto]:e.Node.prototype["".concat(n,"Auto")]};t(e.Node.prototype,n,(function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];const o=r.pop();let a,l;if("auto"===o)a=XS.Auto,l=void 0;else if("object"===typeof o)a=o.unit,l=o.valueOf();else if(a="string"===typeof o&&o.endsWith("%")?XS.Percent:XS.Point,l=parseFloat(o),void 0!==o&&!Number.isNaN(o)&&Number.isNaN(l))throw new Error("Invalid value ".concat(o," for ").concat(n));if(!i[a])throw new Error('Failed to execute "'.concat(n,"\": Unsupported unit '").concat(o,"'"));return void 0!==l?i[a].call(this,...r,l):i[a].call(this,...r)}))}return t(e.Node.prototype,"setMeasureFunc",(function(t,n){return n?t.call(this,(i=n,e.MeasureCallback.implement({measure:function(){const{width:e,height:t}=i(...arguments);return{width:null!==e&&void 0!==e?e:NaN,height:null!==t&&void 0!==t?t:NaN}}}))):this.unsetMeasureFunc();var i})),t(e.Node.prototype,"setDirtiedFunc",(function(t,n){var i;t.call(this,(i=n,e.DirtiedCallback.implement({dirtied:i})))})),t(e.Config.prototype,"free",(function(){e.Config.destroy(this)})),t(e.Node,"create",((t,n)=>n?e.Node.createWithConfig(n):e.Node.createDefault())),t(e.Node.prototype,"free",(function(){e.Node.destroy(this)})),t(e.Node.prototype,"freeRecursive",(function(){for(let e=0,t=this.getChildCount();e<t;++e)this.getChild(0).freeRecursive();this.free()})),t(e.Node.prototype,"calculateLayout",(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NaN,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:NaN,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ZS.LTR;return e.call(this,t,n,i)})),{Config:e.Config,Node:e.Node,...zS}}Math.cos(.25*Math.PI);const US=[new ra,new ra,new ra,new ra],_S=new Sr;class OS{constructor(e,t,n,i,r){hC(this,"planes",void 0),hC(this,"facePlane",void 0),hC(this,"originalCenter",void 0),this.originalCenter=new Sr(t,n,0).applyMatrix4(e),this.facePlane=new ra(new Sr(0,0,1),0).applyMatrix4(e);const s=i/2,o=r/2,a=n+o,l=t+s,c=-n+o,g=-t+s;this.planes=[new ra(new Sr(0,-1,0),c).applyMatrix4(e),new ra(new Sr(-1,0,0),g).applyMatrix4(e),new ra(new Sr(0,1,0),a).applyMatrix4(e),new ra(new Sr(1,0,0),l).applyMatrix4(e)]}min(e){let{planes:t}=e;for(let i=0;i<4;i++){const e=this.facePlane,n=t[i],r=e.normal.dot(n.normal);if(Math.abs(r)>.99)return this;const s=US[i];if(Math.abs(r)<.01){s.copy(n);continue}s.normal.crossVectors(e.normal,n.normal).normalize().cross(e.normal).negate();const o=1-r*r,a=(e.constant-n.constant*r)/o,l=(n.constant-e.constant*r)/o;_S.copy(e.normal).multiplyScalar(a).addScaledVector(n.normal,l),s.constant=-_S.dot(s.normal)}const n=this.planes[0].normal;US[0].normal.dot(n);for(let i=0;i<4;i++){const e=this.planes[i],n=(i+0)%4;US[n].distanceToPoint(this.originalCenter)<e.distanceToPoint(this.originalCenter)&&e.copy(t[n])}return this}toArray(e,t){for(let n=0;n<4;n++){const{normal:i,constant:r}=this.planes[n];i.toArray(e,t),e[t+3]=r,t+=4}}}const JS=[new Sr,new Sr,new Sr,new Sr],jS=[[-.5,-.5],[.5,-.5],[.5,.5],[-.5,.5]];function qS(e,t,n,i){return Lx((()=>{if(null==n.value)return!0;const r=t.value,s=null===e||void 0===e?void 0:e.value;if(null==s||null==r)return!1;const[o,a]=n.value,l=i.value;for(let e=0;e<4;e++){const[t,n]=jS[e];JS[e].set(t*l*o,n*l*a,0).applyMatrix4(r)}const{planes:c}=s;let g;for(let e=0;e<4;e++){const t=c[e];g=!0;for(let e=0;e<4;e++){const n=JS[e];t.distanceToPoint(n)>=0&&(g=!1)}if(g)return!0}return!1}))}function $S(e,t,n,i){let{overflow:r,borderInset:s,size:o}=t;return Lx((()=>{const t=e.value;if(null==t||r.value===QS.Visible)return null===i||void 0===i?void 0:i.value;if(null==o.value||null==s.value)return;const[a,l]=o.value,[c,g,u,A]=s.value,d=n.value,h=new OS(t,(g-A)*d/2,(c-u)*d/2,(a-A-g)*d,(l-c-u)*d);return null!=(null===i||void 0===i?void 0:i.value)&&h.min(i.value),h}))}const eR=new ra(new Sr(-1,0,0),Number.MAX_SAFE_INTEGER),tR=new Float32Array(16);for(let n=0;n<4;n++)eR.normal.toArray(tR,4*n),tR[4*n+3]=eR.constant;function nR(e,t){const n=()=>{var t;return null===(t=e.object.current)||void 0===t?void 0:t.matrixWorld},i=new Array(4).fill(void 0).map(((e,i)=>new rR((()=>{var e;return null===t||void 0===t||null===(e=t.value)||void 0===e?void 0:e.planes[i]}),n)));return i}const iR=new ra;class rR{get normal(){return this.computeInto(iR),iR.normal}get constant(){return this.computeInto(iR),iR.constant}constructor(e,t){hC(this,"getLocalPlane",void 0),hC(this,"getGlobalMatrix",void 0),hC(this,"isPlane",!0),this.getLocalPlane=e,this.getGlobalMatrix=t}computeInto(e){const t=this.getLocalPlane(),n=this.getGlobalMatrix();return null==t||null==n?e.copy(eR):e.copy(t).applyMatrix4(n)}set(e,t){return this}setComponents(e,t,n,i){return this}setFromNormalAndCoplanarPoint(e,t){return this}setFromCoplanarPoints(e,t,n){return this}clone(){return this.computeInto(new ra)}copy(e){return this.computeInto(e),this}normalize(){return this}negate(){return this}distanceToPoint(e){return this.computeInto(iR).distanceToPoint(e)}distanceToSphere(e){return this.computeInto(iR).distanceToSphere(e)}projectPoint(e,t){return this.computeInto(iR).projectPoint(e,t)}intersectLine(e,t){return this.computeInto(iR).intersectLine(e,t)}intersectsLine(e){return this.computeInto(iR).intersectsLine(e)}intersectsBox(e){return this.computeInto(iR).intersectsBox(e)}intersectsSphere(e){return this.computeInto(iR).intersectsSphere(e)}coplanarPoint(e){return this.computeInto(iR).coplanarPoint(e)}applyMatrix4(e,t){return this}translate(e){return this}equals(e){return this.computeInto(iR).equals(e)}isIntersectionLine(e){return this.computeInto(iR).isIntersectionLine(e)}}function sR(e,t,n){if(null==t)return n;const i=e[t];if(null==i)throw new Error("unexpected value ".concat(t,", expected ").concat(Object.keys(e).join(", ")));return i}const oR={static:0,relative:1,absolute:2},aR={auto:0,"flex-start":1,center:2,"flex-end":3,stretch:4,baseline:5,"space-between":6,"space-around":7,"space-evenly":8},lR={column:0,"column-reverse":1,row:2,"row-reverse":3},cR={"no-wrap":0,wrap:1,"wrap-reverse":2},gR={"flex-start":0,center:1,"flex-end":2,"space-between":3,"space-around":4,"space-evenly":5},uR={visible:0,hidden:1,scroll:2},AR={flex:0,none:1},dR={positionType:(e,t)=>e.setPositionType(sR(oR,t,1)),positionTop:(e,t)=>e.setPosition(1,null!==t&&void 0!==t?t:NaN),positionLeft:(e,t)=>e.setPosition(0,null!==t&&void 0!==t?t:NaN),positionRight:(e,t)=>e.setPosition(2,null!==t&&void 0!==t?t:NaN),positionBottom:(e,t)=>e.setPosition(3,null!==t&&void 0!==t?t:NaN),alignContent:(e,t)=>e.setAlignContent(sR(aR,t,4)),alignItems:(e,t)=>e.setAlignItems(sR(aR,t,4)),alignSelf:(e,t)=>e.setAlignSelf(sR(aR,t,0)),flexDirection:(e,t)=>e.setFlexDirection(sR(lR,t,2)),flexWrap:(e,t)=>e.setFlexWrap(sR(cR,t,0)),justifyContent:(e,t)=>e.setJustifyContent(sR(gR,t,0)),marginTop:(e,t)=>e.setMargin(1,null!==t&&void 0!==t?t:NaN),marginLeft:(e,t)=>e.setMargin(0,null!==t&&void 0!==t?t:NaN),marginRight:(e,t)=>e.setMargin(2,null!==t&&void 0!==t?t:NaN),marginBottom:(e,t)=>e.setMargin(3,null!==t&&void 0!==t?t:NaN),flexBasis:(e,t)=>e.setFlexBasis(null!==t&&void 0!==t?t:NaN),flexGrow:(e,t)=>e.setFlexGrow(null!==t&&void 0!==t?t:0),flexShrink:(e,t)=>e.setFlexShrink(null!==t&&void 0!==t?t:1),width:(e,t)=>e.setWidth(null!==t&&void 0!==t?t:NaN),height:(e,t)=>e.setHeight(null!==t&&void 0!==t?t:NaN),minWidth:(e,t)=>e.setMinWidth(null!==t&&void 0!==t?t:NaN),minHeight:(e,t)=>e.setMinHeight(null!==t&&void 0!==t?t:NaN),maxWidth:(e,t)=>e.setMaxWidth(null!==t&&void 0!==t?t:NaN),maxHeight:(e,t)=>e.setMaxHeight(null!==t&&void 0!==t?t:NaN),aspectRatio:(e,t)=>e.setAspectRatio(null!==t&&void 0!==t?t:NaN),borderTopWidth:(e,t)=>e.setBorder(1,null!==t&&void 0!==t?t:NaN),borderLeftWidth:(e,t)=>e.setBorder(0,null!==t&&void 0!==t?t:NaN),borderRightWidth:(e,t)=>e.setBorder(2,null!==t&&void 0!==t?t:NaN),borderBottomWidth:(e,t)=>e.setBorder(3,null!==t&&void 0!==t?t:NaN),overflow:(e,t)=>e.setOverflow(sR(uR,t,0)),display:(e,t)=>e.setDisplay(sR(AR,t,0)),paddingTop:(e,t)=>e.setPadding(1,null!==t&&void 0!==t?t:NaN),paddingLeft:(e,t)=>e.setPadding(0,null!==t&&void 0!==t?t:NaN),paddingRight:(e,t)=>e.setPadding(2,null!==t&&void 0!==t?t:NaN),paddingBottom:(e,t)=>e.setPadding(3,null!==t&&void 0!==t?t:NaN),gapRow:(e,t)=>e.setGap(1,null!==t&&void 0!==t?t:NaN),gapColumn:(e,t)=>e.setGap(0,null!==t&&void 0!==t?t:NaN)};function hR(e,t,n,i,r){let s,o=!1,a={};r.push(Yx((()=>{const t=e.value;o&&IR(n,t,s,a,i),s=t})),Yx((()=>{if(o=t.value,o&&null!=s)return IR(n,s,void 0,a,i),()=>{!function(e){for(const t in e)e[t]()}(a),a={}}})))}function IR(e,t,n,i,r){const s=e=>i[e]=Yx((()=>r(e,t.read(e,void 0)))),o=e=>{var t;null===(t=i[e])||void 0===t||t.call(i),delete i[e],void 0!==n.read(e,void 0)&&r(e,void 0)},a=e=>{var t;null===(t=i[e])||void 0===t||t.call(i),s(e)};xx((()=>t.filterCompare(e,n,s,a,o)))}const pR=100;const CR=Mx(void 0);(async function(){return PS(await xS())})().then((e=>{let{Node:t,Config:n}=e;const i=function(e){const t=e.create();return t.setUseWebDefaults(!0),t.setPointScaleFactor(pR),t.setExperimentalFeatureEnabled(MS.WebFlexBasis,!0),t}(n);CR.value=()=>t.create(i)})).catch(console.error);function mR(e){return"measureFunc"===e||e in dR}function fR(){const e=Mx([!1,!1]);return{size:Mx(void 0),relativeCenter:Mx(void 0),borderInset:Mx(void 0),overflow:Mx(QS.Visible),displayed:Mx(!1),scrollable:e,paddingInset:Mx(void 0),maxScrollPosition:Mx([void 0,void 0])}}class yR{constructor(e,t,n,i,r,s){hC(this,"state",void 0),hC(this,"propertiesSignal",void 0),hC(this,"requestCalculateLayout",void 0),hC(this,"object",void 0),hC(this,"objectVisibileDefault",void 0),hC(this,"children",[]),hC(this,"yogaNode",void 0),hC(this,"layoutChangeListeners",new Set),hC(this,"customLayouting",void 0),hC(this,"active",Mx(!1)),hC(this,"objectVisible",!1),this.state=e,this.propertiesSignal=t,this.requestCalculateLayout=n,this.object=i,this.objectVisibileDefault=r,s.push(Yx((()=>{const e=(()=>{var e;return null===(e=CR.value)||void 0===e?void 0:e.call(CR)})();if(null!=e)return this.yogaNode=e,this.active.value=!0,this.updateMeasureFunction(),()=>{var e,t;null===(e=this.yogaNode)||void 0===e||null===(e=e.getParent())||void 0===e||e.removeChild(this.yogaNode),null===(t=this.yogaNode)||void 0===t||t.free()}}))),hR(t,this.active,mR,((e,t)=>{dR[e](this.yogaNode,t),this.requestCalculateLayout()}),s)}setCustomLayouting(e){this.customLayouting=e,this.updateMeasureFunction()}updateMeasureFunction(){null!=this.customLayouting&&this.active.value&&(!function(e,t){if(null==t)return void e.setMeasureFunc(null);e.setMeasureFunc(((e,n,i,r)=>{const s=t(e,n,i,r);return{width:Math.ceil(s.width*pR+1)/pR,height:Math.ceil(s.height*pR+1)/pR}})),e.markDirty()}(this.yogaNode,this.customLayouting.measure),this.requestCalculateLayout())}calculateLayout(){null!=this.yogaNode&&(this.commit(this.yogaNode.getFlexDirection()),this.yogaNode.calculateLayout(void 0,void 0),Gx((()=>this.updateMeasurements(!0,void 0,void 0))))}addChild(e){this.children.push(e),this.requestCalculateLayout()}removeChild(e){const t=this.children.indexOf(e);-1!==t&&(this.children.splice(t,1),this.requestCalculateLayout())}commit(e){if(null==this.yogaNode)throw new Error("commit cannot be called without a yoga node");const t=e===WS.Column||e===WS.ColumnReverse,n=this.propertiesSignal.peek();if(null!=this.customLayouting&&void 0===xx((()=>n.read(t?"minHeight":"minWidth",void 0)))&&this.yogaNode[t?"setMinHeight":"setMinWidth"](t?this.customLayouting.minHeight:this.customLayouting.minWidth),null==xx((()=>n.read("flexShrink",void 0)))){const e=null!=xx((()=>n.read("height",void 0)));this.yogaNode.setFlexShrink(e&&t?0:void 0)}let i;this.children.sort(((e,t)=>{var n,r;if(null!==(n=i)&&void 0!==n||(i=null===(r=e.object.current)||void 0===r||null===(r=r.parent)||void 0===r?void 0:r.children),null==i)return 0;const s=e.object.current,o=t.object.current;if(null==s||null==o)return 0;const a=i.indexOf(s);if(-1===a)throw new Error("parent mismatch");const l=i.indexOf(o);if(-1===l)throw new Error("parent mismatch");return a-l}));let r=0,s=this.yogaNode.getChild(r),o=this.children[r];for(;null!=o||null!=s;)if(null==o||null==s||(l=s,c=vR(o.yogaNode),l.M.O!==c.M.O)){if(null!=s&&this.yogaNode.removeChild(s),null!=o){var a;const e=vR(o.yogaNode);null===(a=e.getParent())||void 0===a||a.removeChild(e),this.yogaNode.insertChild(e,r),o=this.children[++r]}s=this.yogaNode.getChild(r)}else o=this.children[++r],s=this.yogaNode.getChild(r);var l,c;const g=this.children.length;for(let u=0;u<g;u++)this.children[u].commit(this.yogaNode.getFlexDirection());this.objectVisible=this.objectVisibileDefault||this.children.some((e=>e.objectVisible)),null!=this.object.current&&(this.object.current.visible=this.objectVisible)}updateMeasurements(e,t,n){var i,r;if(null==this.yogaNode)throw new Error("update measurements cannot be called without a yoga node");this.state.overflow.value=this.yogaNode.getOverflow(),e&&(e=this.yogaNode.getDisplay()===DS.Flex),this.state.displayed.value=e;const s=this.yogaNode.getComputedWidth(),o=this.yogaNode.getComputedHeight();bR(this.state.size,s,o),null!==(i=t)&&void 0!==i||(t=s),null!==(r=n)&&void 0!==r||(n=o);const a=this.yogaNode.getComputedLeft(),l=this.yogaNode.getComputedTop(),c=a+.5*s-.5*t,g=-(l+.5*o-.5*n);bR(this.state.relativeCenter,c,g);const u=this.yogaNode.getComputedPadding(FS.Top),A=this.yogaNode.getComputedPadding(FS.Left),d=this.yogaNode.getComputedPadding(FS.Right),h=this.yogaNode.getComputedPadding(FS.Bottom);BR(this.state.paddingInset,u,d,h,A);const I=this.yogaNode.getComputedBorder(FS.Top),p=this.yogaNode.getComputedBorder(FS.Right),C=this.yogaNode.getComputedBorder(FS.Bottom),m=this.yogaNode.getComputedBorder(FS.Left);BR(this.state.borderInset,I,p,C,m);for(const v of this.layoutChangeListeners)v();const f=this.children.length;let y=0,b=0;for(let v=0;v<f;v++){const[t,n]=this.children[v].updateMeasurements(e,s,o);y=Math.max(y,t),b=Math.max(b,n)}if(y-=m,b-=I,this.state.overflow.value===QS.Scroll){y+=d,b+=A;const e=y-(s-m-p),t=b-(o-I-C),n=e>.5,i=t>.5;bR(this.state.maxScrollPosition,n?e:void 0,i?t:void 0),bR(this.state.scrollable,n,i)}else bR(this.state.maxScrollPosition,void 0,void 0),bR(this.state.scrollable,!1,!1);const B=this.state.overflow.value===QS.Visible;return[a+Math.max(s,B?y:0),l+Math.max(o,B?b:0)]}addLayoutChangeListener(e){return this.layoutChangeListeners.add(e),()=>{this.layoutChangeListeners.delete(e)}}}function bR(e,t,n){if(null!=e.value){const[i,r]=e.value;if(i===t&&r===n)return}e.value=[t,n]}function BR(e,t,n,i,r){if(null!=e.value){const[s,o,a,l]=e.value;if(s==t&&o==n&&a==i&&l==r)return}e.value=[t,n,i,r]}function vR(e){if(null==e)throw new Error("commit cannot be called with a children that miss a yoga node");return e}function wR(e){return{active:$x((()=>e.value.length>0))}}function GR(e){null===e||void 0===e||e.traverse((e=>{e instanceof Qo&&(e.material instanceof Os&&e.material.dispose(),e.geometry instanceof vo&&e.geometry.dispose())}))}function ER(e,t){return Lx((()=>{const n=t.value,i=e.value;if(null!=n&&null!=i)return i.clone().multiply(n)}))}function xR(e,t,n){return Lx((()=>e.displayed.value&&(null==t||!(null!==t&&void 0!==t&&t.value))&&"visible"===n.value.read("visibility","visible")))}function SR(e,t,n,i,r){for(var s=arguments.length,o=new Array(s>5?s-5:0),a=5;a<s;a++)o[a-5]=arguments[a];i.push((i=>{if(!(r instanceof Nx)){let n=!1;return t(r,...o).then((t=>n?void 0:e.value=t)),i.push((()=>n=!0)),i}return i.push(Yx((()=>{let n=!1;return t(r.value,...o).then((t=>n?void 0:e.value=t)).catch(console.error),()=>n=!0}))),null!=n&&i.push((()=>{const{value:t}=e;null!=t&&n(t)})),i}))}function RR(e,t,n,i,r,s,o){o.push((o=>{const a=new yR(t,i,n.root.requestCalculateLayout,r,s,o);return null!=e&&(e.value=a),o.push(Yx((()=>{const e=n.node.value;if(null!=e)return e.addChild(a),()=>e.removeChild(a)}))),o}))}const ZR=new Map,DR={keepAspectRatio:(e,t)=>{let n=ZR.get(e);null==n&&ZR.set(e,n=Lx((()=>!1===qx(e)?null:void 0))),t.add("aspectRatio",n)}};function FR(e,t,n,i,r,s,o){return Lx((()=>{const a={};return function(e,t){for(const n in t)NR(n,e,t[n])}(a,null===s||void 0===s?void 0:s.value),function(e,t,n,i,r,s){var o,a;let l=!1;iS(t,n,i,(e=>{"hover"in e&&(l=!0)}));const c=null!==(o=null!==(a=null===t||void 0===t?void 0:t.cursor)&&void 0!==a?a:null===n||void 0===n?void 0:n.cursor)&&void 0!==o?o:s;if(!l&&null==(null===t||void 0===t?void 0:t.onHoverChange)&&null==(null===n||void 0===n?void 0:n.onHoverChange)&&null==c)return void(r.value.length=0);NR("onPointerOver",e,(e=>{let{pointerId:i}=e;var s,o,a,l;(r.value=[i,...r.value],1===r.value.length)&&(null===n||void 0===n||null===(s=n.onHoverChange)||void 0===s||s.call(n,!0),null===t||void 0===t||null===(o=t.onHoverChange)||void 0===o||o.call(t,!0));null!=c&&(a=r,l=c,WF.push(a),kF.push(l),document.body.style.cursor=l)})),NR("onPointerOut",e,(e=>{let{pointerId:i}=e;var s,o;(r.value=r.value.filter((e=>e!=i)),0===r.value.length)&&(null===n||void 0===n||null===(s=n.onHoverChange)||void 0===s||s.call(n,!1),null===t||void 0===t||null===(o=t.onHoverChange)||void 0===o||o.call(t,!1));TF(r)}))}(a,e.value,t.value,n.value,i,o),function(e,t,n,i,r){let s=!1;if(iS(t,i,n,(e=>{"active"in e&&(s=!0)})),!s&&null==(null===t||void 0===t?void 0:t.onActiveChange)&&null==(null===n||void 0===n?void 0:n.onActiveChange))return void(r.value.length=0);const o=e=>{var i,s;let{pointerId:o}=e;r.value=r.value.filter((e=>e!=o)),r.value.length>0||(null===n||void 0===n||null===(i=n.onActiveChange)||void 0===i||i.call(n,!1),null===t||void 0===t||null===(s=t.onActiveChange)||void 0===s||s.call(t,!1))};NR("onPointerDown",e,(e=>{var i,s;let{pointerId:o}=e;r.value=[o,...r.value],1==r.value.length&&(null===n||void 0===n||null===(i=n.onActiveChange)||void 0===i||i.call(n,!0),null===t||void 0===t||null===(s=t.onActiveChange)||void 0===s||s.call(t,!0))})),NR("onPointerUp",e,o),NR("onPointerLeave",e,o)}(a,e.value,t.value,n.value,r),a}))}function NR(e,t,n){if(null==n)return;const i=t[e];t[e]=null!=i?e=>{i(e),"stopped"in e&&e.stopped||n(e)}:n}function MR(e,t,n,i,r,s){return Lx((()=>{const o=new sS(r);return null===s||void 0===s||s(o),o.addAll(e.value,t.value,n.value,i),o}))}const WR=new Ps;function kR(e,t,n,i){const r=tS(e,"color",void 0),s=tS(e,"opacity",1);n.push((()=>Yx((()=>{var e;let n;Array.isArray(r.value)?n=WR.setRGB(...r.value):null!=r.value&&(n=WR.set(r.value)),null===(e=qx(t))||void 0===e||e.traverse((e=>{var t;if(!(e instanceof Qo))return;e.renderOrder=i.renderOrder.value;const r=e.material;r.color.copy(null!==(t=n)&&void 0!==t?t:e.userData.color),r.opacity=s.value,r.depthTest=i.depthTest.value}))}))))}function TR(e,t,n,i){i.push((()=>Yx((()=>{var i,r,s,o;const a=n.value;null!=a&&(null===(i=e.peek())||void 0===i||null===(r=i.onSizeChange)||void 0===r||r.call(i,...a),null===(s=t.peek())||void 0===s||null===(o=s.onSizeChange)||void 0===o||o.call(s,...a))}))))}function VR(e,t,n,i){let r=!0;i.push((()=>Yx((()=>{var i,s,o,a;const l=n.value;r?r=!1:(null===(i=e.peek())||void 0===i||null===(s=i.onIsClippedChange)||void 0===s||s.call(i,l),null===(o=t.peek())||void 0===o||null===(a=o.onIsClippedChange)||void 0===a||a.call(o,l))}))))}function LR(e,t,n,i,r,s,o,a,l,c,g,u){return u.push(Yx((()=>{if(null==t.value)return;const u=[],A=i.getGroup(t.value.majorIndex,null===n||void 0===n?void 0:n.value);return new KR(e,A,t.value.minorIndex,r,s,o,a,l,c,g,u),()=>Px(u)}))),u}const HR=new rs,QR=new rs;class KR{constructor(e,t,n,i,r,s,o,a,l,c,g){hC(this,"group",void 0),hC(this,"minorIndex",void 0),hC(this,"matrix",void 0),hC(this,"size",void 0),hC(this,"offset",void 0),hC(this,"borderInset",void 0),hC(this,"clippingRect",void 0),hC(this,"materialConfig",void 0),hC(this,"indexInBucket",void 0),hC(this,"bucket",void 0),hC(this,"unsubscribeList",[]),hC(this,"insertedIntoGroup",!1),hC(this,"active",Mx(!1)),this.group=t,this.minorIndex=n,this.matrix=i,this.size=r,this.offset=s,this.borderInset=o,this.clippingRect=a,this.materialConfig=c;const u=c.setters;hR(e,this.active,c.hasProperty,((e,t)=>{const n=this.getIndexInBuffer();if(null==n)return;const{instanceData:i,instanceDataOnUpdate:s,root:o}=this.group;u[e](i.array,i.itemSize*n,t,r,s),o.requestRender()}),g);const A=c.computedIsVisibile(e,o,r,l);g.push(Yx((()=>{A.value?this.requestShow():this.hide()})),(()=>this.hide()))}setIndexInBucket(e){this.indexInBucket=e}getIndexInBuffer(){if(null!=this.bucket&&null!=this.indexInBucket)return this.bucket.offset+this.indexInBucket}activate(e,t){this.bucket=e,this.indexInBucket=t,this.active.value=!0,this.unsubscribeList.push(Yx((()=>{if(null==this.matrix.value||null==this.size.value)return;const e=this.getIndexInBuffer();if(null==e)return;const t=16*e,[n,i]=this.size.value,r=this.group.pixelSize.value;if(HR.makeScale(n*r,i*r,1),null!=this.offset){const[e,t]=this.offset.value;HR.premultiply(QR.makeTranslation(e*r,t*r,0))}HR.premultiply(this.matrix.value);const{instanceMatrix:s,root:o}=this.group;HR.toArray(s.array,t),s.addUpdateRange(t,16),s.needsUpdate=!0,o.requestRender()})),Yx((()=>{const e=this.getIndexInBuffer();if(null==e||null==this.size.value)return;const[t,n]=this.size.value,{instanceData:i,root:r}=this.group,{array:s}=i,o=16*e+13;s[o]=t,s[o+1]=n,i.addUpdateRange(o,2),i.needsUpdate=!0,r.requestRender()})),Yx((()=>{const e=this.getIndexInBuffer();if(null==e||null==this.borderInset.value)return;const{instanceData:t,root:n}=this.group,i=16*e+0;t.array.set(this.borderInset.value,i),t.addUpdateRange(i,4),t.needsUpdate=!0,n.requestRender()})),Yx((()=>{var e;const t=this.getIndexInBuffer();if(null==t)return;const{instanceClipping:n,root:i}=this.group,r=16*t,s=null===(e=this.clippingRect)||void 0===e?void 0:e.value;null!=s?s.toArray(n.array,r):n.array.set(tR,r),n.addUpdateRange(r,16),n.needsUpdate=!0,i.requestRender()})))}requestShow(){this.insertedIntoGroup||(this.insertedIntoGroup=!0,this.group.insert(this.minorIndex,this))}hide(){if(!this.insertedIntoGroup)return;this.active.value=!1,this.group.delete(this.minorIndex,this.indexInBucket,this),this.insertedIntoGroup=!1,this.bucket=void 0,this.indexInBucket=void 0;const e=this.unsubscribeList.length;for(let t=0;t<e;t++)this.unsubscribeList[t]();this.unsubscribeList.length=0}}function XR(e,t){for(;t>=e.length;){let t=0,n=0;if(e.length>0){const i=e[e.length-1];t+=i.offset+i.elements.length,n=Math.min(0,i.missingSpace),i.missingSpace-=n}e.push({add:[],missingSpace:n,offset:t,elements:[]})}}function YR(e,t,n,i,r){const s=e[i],o=e[n+1].offset;t(o-r,o,s.offset+s.elements.length);e[n].missingSpace+=r,s.missingSpace-=r;for(let a=n+1;a<=i;a++)e[a].offset-=r}function zR(e,t,n,i,r){const s=e[i],o=e[n+1].offset;t(o+r,o,s.offset+s.elements.length);e[n].missingSpace-=r,s.missingSpace+=r;for(let a=n+1;a<=i;a++)e[a].offset+=r}function PR(){const e=new ga,t=e.getAttribute("position"),n=new Float32Array(4*t.count),i=[1,0,0,1];for(let r=0;r<n.length;r++)n[r]=i[r%4];return e.setAttribute("tangent",new ro(n,4)),e}const UR=PR();function _R(e,t,n,i,r){e[t]=function(e,t,n){const i=Math.pow(50,t);return e+(n-Math.floor(e/i)%50)*i}(e[t],n,Ay(Math.ceil((null!==i&&void 0!==i?i:0)/r*100),0,49))}const OR=new Ps(-1,-1,-1),JR={backgroundColor:OR,backgroundOpacity:-1,borderColor:16777215,borderBottomLeftRadius:0,borderTopLeftRadius:0,borderBottomRightRadius:0,borderTopRightRadius:0,borderBend:0,borderOpacity:1};let jR;function qR(){if(null==jR){const e={};for(const t in JR)e[t]=t;jR=$R(e)}return jR}function $R(e,t){const n={...JR,...t},i={};for(const s in e){const t=eZ[s],r=n[s];i[e[s]]=(e,n,i,s,o)=>t(e,n,null!==i&&void 0!==i?i:r,s,o)}const r=new Float32Array(16);return rZ(r,4,n.backgroundColor,void 0),rZ(r,8,n.borderColor,void 0),r[11]=n.borderBend,r[12]=n.borderOpacity,r[15]=n.backgroundOpacity,{hasProperty:e=>e in i,defaultData:r,setters:i,computedIsVisibile:(t,i,r,s)=>Lx((()=>{if(null==i.value||null==r.value)return!0;const o=null==e.borderOpacity?n.borderOpacity:t.value.read(e.borderOpacity,n.borderOpacity),a=null==e.backgroundOpacity?n.backgroundOpacity:t.value.read(e.backgroundOpacity,n.backgroundOpacity),l=null==e.backgroundColor?n.backgroundColor:t.value.read(e.backgroundColor,n.backgroundColor),c=i.value.some((e=>e>0))&&o>0,[g,u]=r.value;return!(!(g>0&&u>0&&(-1===a||a>0)&&l!=OR)&&!c)&&s.value}))}}const eZ={backgroundColor:(e,t,n,i,r)=>rZ(e,t+4,n,r),borderBottomLeftRadius:(e,t,n,i,r)=>{let{value:s}=i;return null!=s&&tZ(e,t+7,0,n,s[1],r)},borderBottomRightRadius:(e,t,n,i,r)=>{let{value:s}=i;return null!=s&&tZ(e,t+7,1,n,s[1],r)},borderTopRightRadius:(e,t,n,i,r)=>{let{value:s}=i;return null!=s&&tZ(e,t+7,2,n,s[1],r)},borderTopLeftRadius:(e,t,n,i,r)=>{let{value:s}=i;return null!=s&&tZ(e,t+7,3,n,s[1],r)},borderColor:(e,t,n,i,r)=>rZ(e,t+8,n,r),borderBend:(e,t,n,i,r)=>nZ(e,t+11,n,r),borderOpacity:(e,t,n,i,r)=>nZ(e,t+12,n,r),backgroundOpacity:(e,t,n,i,r)=>nZ(e,t+15,n,r)};function tZ(e,t,n,i,r,s){_R(e,t,n,i,r),null===s||void 0===s||s(t,1)}function nZ(e,t,n,i){e[t]=n,null===i||void 0===i||i(t,1)}const iZ=new Ps;function rZ(e,t,n,i){Array.isArray(n)?e.set(n,t):iZ.set(n).toArray(e,t),null===i||void 0===i||i(t,3)}function sZ(e,t){const n=new e;null==n.defines&&(n.defines={}),n.side=oe,n.clipShadows=!0,n.transparent=!0,n.toneMapped=!1,n.depthWrite=!1,n.shadowSide=oe,n.defines.USE_UV="",n.defines.USE_TANGENT="";const i=n.onBeforeCompile;return n.onBeforeCompile=(e,r)=>{i.call(n,e,r),"normal"===t.type&&(e.uniforms.data={value:t.data}),function(e,t){uZ(e,t),e.fragmentShader=e.fragmentShader.replace("#include <color_fragment>"," #include <color_fragment>\n      ".concat(AZ(t,"diffuseColor.a"),"\n      diffuseColor.rgb = mix(borderColor, diffuseColor.rgb * backgroundColor, transition);\n      diffuseColor.a = outOpacity;\n      ")),e.fragmentShader=e.fragmentShader.replace("#include <normal_fragment_maps>"," #include <normal_fragment_maps>\n      vec3 b = normalize(vBitangent);\n      vec3 t = normalize(vTangent);\n      mat4 directions = mat4(vec4(b, 1.0), vec4(t, 1.0), vec4(-b, 1.0), vec4(-t, 1.0));\n      float currentBorderSize = distance.x - distance.y;\n      float outsideNormalWeight = currentBorderSize < 0.00001 ? 0.0 : max(0.0, -distance.y / currentBorderSize) * borderBend;\n      vec3 outsideNormal = (borderWeight * transpose(directions)).xyz;\n      normal = normalize(outsideNormalWeight * outsideNormal + (1.0 - outsideNormalWeight) * normal);\n    ")}(e,"instanced"===t.type)},n}class oZ extends Fc{constructor(e){super(),hC(this,"info",void 0),this.info=e,null==this.defines&&(this.defines={}),this.defines.USE_UV="",this.clipShadows=!0}onBeforeCompile(e,t){super.onBeforeCompile(e,t),"normal"===this.info.type&&(e.uniforms.data={value:this.info.data}),gZ(e,"instanced"===this.info.type)}}class aZ extends Dc{constructor(e){super({depthPacking:Ln}),hC(this,"info",void 0),this.info=e,null==this.defines&&(this.defines={}),this.defines.USE_UV="",this.clipShadows=!0}onBeforeCompile(e,t){super.onBeforeCompile(e,t),"normal"===this.info.type&&(e.uniforms.data={value:this.info.data}),gZ(e,"instanced"===this.info.type)}}const lZ=new aZ({type:"instanced"}),cZ=new oZ({type:"instanced"});function gZ(e,t){uZ(e,t),e.fragmentShader=e.fragmentShader.replace("#include <clipping_planes_fragment>","#include <clipping_planes_fragment>\n    ".concat(AZ(t,void 0),"\n    "))}function uZ(e,t){e.vertexShader=e.vertexShader.replace("#include <common>"," #include <common>\n      out vec4 borderRadius;\n      ".concat(t?"":"uniform highp mat4 data;")),e.vertexShader=e.vertexShader.replace("#include <uv_vertex>"," #include <uv_vertex>\n      highp int packedBorderRadius = int(data[1].w);\n      borderRadius = vec4(\n        packedBorderRadius / 125000 % 50,\n        packedBorderRadius / 2500 % 50,\n        packedBorderRadius / 50 % 50,\n        packedBorderRadius % 50\n      ) * vec4(0.5 / 50.0);"),t&&(e.vertexShader=e.vertexShader.replace("#include <common>"," #include <common>\n        attribute highp mat4 aData;\n        attribute mat4 aClipping;\n        out mat4 data;\n        out mat4 clipping;\n        out vec3 localPosition;"),e.vertexShader=e.vertexShader.replace("#include <uv_vertex>"," #include <uv_vertex>\n        data = aData;\n        clipping = aClipping;\n        localPosition = (instanceMatrix * vec4(position, 1.0)).xyz;")),e.fragmentShader="".concat(t?"in":"uniform"," highp mat4 data;\n    in vec4 borderRadius;\n    ").concat(t?"\n    in vec3 localPosition;\n    in mat4 clipping;\n    ":"","\n\n    float min4 (vec4 v) {\n        return min(min(min(v.x,v.y),v.z),v.w);\n    }\n    float max4 (vec4 v) {\n        return max(max(max(v.x,v.y),v.z),v.w);\n    }\n    vec2 radiusDistance(float radius, vec2 outside, vec2 border, vec2 borderSize) {\n        vec2 outerRadiusXX = vec2(radius, radius);\n        vec2 innerRadiusXX = outerRadiusXX - borderSize;\n        vec2 radiusWeightUnnormalized = abs(innerRadiusXX - border);\n        vec2 radiusWeight = radiusWeightUnnormalized / vec2(radiusWeightUnnormalized.x + radiusWeightUnnormalized.y);\n        return vec2(\n            radius - distance(outside, outerRadiusXX),\n            dot(radiusWeight, innerRadiusXX) - distance(border, innerRadiusXX)\n        );\n    }\n    ")+e.fragmentShader,e.fragmentShader=e.fragmentShader.replace("#include <clipping_planes_fragment>"," ".concat(t?"\n        vec4 plane;\n        float distanceToPlane, distanceGradient;\n        float clipOpacity = 1.0;\n\n        for(int i = 0; i < 4; i++) {\n          plane = clipping[ i ];\n          distanceToPlane = - dot( -localPosition, plane.xyz ) + plane.w;\n          distanceGradient = fwidth( distanceToPlane ) / 2.0;\n          clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n    \n          if ( clipOpacity < 0.01 ) discard;\n        }\n        ":"","\n        vec4 absoluteBorderSize = data[0];\n        vec3 backgroundColor = data[1].xyz;\n        vec3 borderColor = data[2].xyz;\n        float borderBend = data[2].w;\n        float borderOpacity = data[3].x;\n        float width = data[3].y;\n        float height = data[3].z;\n        float backgroundOpacity = data[3].w;\n        float ratio = width / height;\n        vec4 relative = vec4(height, height, height, height);\n        vec4 borderSize = absoluteBorderSize / relative;\n        vec4 v_outsideDistance = vec4(1.0 - vUv.y, (1.0 - vUv.x) * ratio, vUv.y, vUv.x * ratio);\n        vec4 v_borderDistance = v_outsideDistance - borderSize;\n  \n        vec2 distance = vec2(min4(v_outsideDistance), min4(v_borderDistance));\n        vec4 negateBorderDistance = vec4(1.0) - v_borderDistance;\n        float maxWeight = max4(negateBorderDistance);\n        vec4 borderWeight = step(maxWeight, negateBorderDistance);\n  \n        vec4 insideBorder;\n  \n        if(all(lessThan(v_outsideDistance.xw, borderRadius.xx))) {\n            distance = radiusDistance(borderRadius.x, v_outsideDistance.xw, v_borderDistance.xw, borderSize.xw);\n            \n            float tmp = borderRadius.x - borderSize.w;\n            vec2 xIntersection = vec2(tmp, tmp / ratio);\n            tmp = borderRadius.x - borderSize.x;\n            vec2 yIntersection = vec2(tmp * ratio, tmp);\n            vec2 lineIntersection = min(xIntersection, yIntersection);\n  \n            insideBorder.yz = vec2(0.0);\n            insideBorder.xw = max(vec2(0.0), lineIntersection - v_borderDistance.xw);\n  \n        } else if(all(lessThan(v_outsideDistance.xy, borderRadius.yy))) {\n            distance = radiusDistance(borderRadius.y, v_outsideDistance.xy, v_borderDistance.xy, borderSize.xy);\n  \n            float tmp = borderRadius.y - borderSize.y;\n            vec2 xIntersection = vec2(tmp, tmp / ratio);\n            tmp = borderRadius.y - borderSize.x;\n            vec2 yIntersection = vec2(tmp * ratio, tmp);\n            vec2 lineIntersection = min(xIntersection, yIntersection);\n  \n            insideBorder.zw = vec2(0.0);\n            insideBorder.xy = max(vec2(0.0), lineIntersection - v_borderDistance.xy);\n  \n        } else if(all(lessThan(v_outsideDistance.zy, borderRadius.zz))) {\n            distance = radiusDistance(borderRadius.z, v_outsideDistance.zy, v_borderDistance.zy, borderSize.zy);\n  \n            float tmp = borderRadius.z - borderSize.y;\n            vec2 xIntersection = vec2(tmp, tmp / ratio);\n            tmp = borderRadius.z - borderSize.z;\n            vec2 yIntersection = vec2(tmp * ratio, tmp);\n            vec2 lineIntersection = min(xIntersection, yIntersection);\n  \n            insideBorder.xw = vec2(0.0);\n            insideBorder.zy =max(vec2(0.0), lineIntersection - v_borderDistance.zy);\n  \n        } else if(all(lessThan(v_outsideDistance.zw, borderRadius.ww))) {\n            distance = radiusDistance(borderRadius.w, v_outsideDistance.zw, v_borderDistance.zw, borderSize.zw);\n  \n            float tmp = borderRadius.w - borderSize.w;\n            vec2 xIntersection = vec2(tmp, tmp / ratio);\n            tmp = borderRadius.w - borderSize.z;\n            vec2 yIntersection = vec2(tmp * ratio, tmp);\n            vec2 lineIntersection = min(xIntersection, yIntersection);\n  \n            insideBorder.xy = vec2(0.0);\n            insideBorder.zw = max(vec2(0.0), lineIntersection - v_borderDistance.zw);\n  \n        }\n  \n        if(insideBorder.x + insideBorder.y + insideBorder.z + insideBorder.w > 0.0) {\n          borderWeight = normalize(insideBorder);\n        }\n  \n        #include <clipping_planes_fragment>"))}function AZ(e,t){return"float ddx = fwidth(distance.x);\n  float outer = smoothstep(-ddx, ddx, distance.x);\n\n  float ddy = fwidth(distance.y);\n  float inner = smoothstep(-ddy, ddy, distance.y);\n\n  float transition = 1.0 - step(0.1, outer - inner) * (1.0 - inner);\n\n  if(backgroundColor.r < 0.0 && backgroundOpacity >= 0.0) {\n    backgroundColor = vec3(1.0);\n  }\n  if(backgroundOpacity < 0.0) {\n    backgroundOpacity = backgroundColor.r >= 0.0 ? 1.0 : 0.0;\n  }\n\n  if(backgroundOpacity < 0.0) {\n    backgroundOpacity = 0.0;\n  }\n\n  borderOpacity = min(backgroundOpacity + data[3].x, 1.0);\n  borderColor = mix(backgroundColor, data[2].xyz, data[3].x / borderOpacity);\n        \n\n  float outOpacity = ".concat(e?"clipOpacity * ":""," outer * mix(borderOpacity, ").concat(null==t?"":"".concat(t," *")," backgroundOpacity, transition);\n\n  if(outOpacity < 0.01) {\n    discard;\n  }")}const dZ=new ra,hZ=new Sr,IZ=[(new ra).setFromNormalAndCoplanarPoint(new Sr(1,0,0),new Sr(-.5,0,0)),(new ra).setFromNormalAndCoplanarPoint(new Sr(-1,0,0),new Sr(.5,0,0)),(new ra).setFromNormalAndCoplanarPoint(new Sr(0,1,0),new Sr(0,-.5,0)),(new ra).setFromNormalAndCoplanarPoint(new Sr(0,-1,0),new Sr(0,.5,0))],pZ=[0,0,0,0],CZ=new Sr;function mZ(e){return CZ.setFromMatrixScale(e),0===CZ.x||0===CZ.y||0===CZ.z}function fZ(e){return(t,n)=>{const i=e.matrixWorld;if(mZ(i))return;if(dZ.constant=0,dZ.normal.set(0,0,1),dZ.applyMatrix4(i),dZ.projectPoint(t.center,hZ),hZ.distanceToSquared(t.center)>t.radius*t.radius)return;for(let e=0;e<4;e++){const n=IZ[e];dZ.copy(n).applyMatrix4(i);let r=dZ.distanceToPoint(hZ);if(r<0){if(Math.abs(r)>t.radius)return;dZ.projectPoint(hZ,hZ),r=0}pZ[e]=r}const r=t.center.distanceTo(hZ);r>t.radius||n.push({distance:r,object:e,point:hZ.clone(),uv:new Oi(pZ[0]/(pZ[0]+pZ[1]),pZ[3]/(pZ[2]+pZ[3])),normal:new Sr(0,0,1)})}}function yZ(e){return(t,n)=>{const i=e.matrixWorld;if(!mZ(i)&&(dZ.constant=0,dZ.normal.set(0,0,1),dZ.applyMatrix4(i),!(dZ.distanceToPoint(t.ray.origin)<=0||null==t.ray.intersectPlane(dZ,hZ)))){for(let e=0;e<4;e++){const t=IZ[e];if(dZ.copy(t).applyMatrix4(i),(pZ[e]=dZ.distanceToPoint(hZ))<0)return}n.push({distance:hZ.distanceTo(t.ray.origin),object:e,point:hZ.clone(),uv:new Oi(pZ[0]/(pZ[0]+pZ[1]),pZ[3]/(pZ[2]+pZ[3])),normal:new Sr(0,0,1)})}}}function bZ(e,t,n,i,r){return Object.assign(e,{isInteractionPanel:!0}),(s,o)=>{var a;const l=n instanceof Rs?n:n.current;if(null==l||null==r.value)return;const{majorIndex:c,minorIndex:g,elementType:u}=r.value,A=o.length;t.call(e,s,o);const d=null===i||void 0===i||null===(a=i.value)||void 0===a?void 0:a.planes,h=l.matrixWorld;e:for(let e=o.length-1;e>=A;e--){const t=o[e];if(t.distance-=.01*c+.001*u+1e-5*g,null!=d)for(let n=0;n<4;n++)if(dZ.copy(d[n]).applyMatrix4(h),dZ.distanceToPoint(t.point)<0){o.splice(e,1);continue e}}}}function BZ(e,t,n,i,r){const s=new Qo(UR);return s.matrixAutoUpdate=!1,s.raycast=bZ(s,yZ(s),t.object,n,e),s.spherecast=bZ(s,fZ(s),t.object,n,e),s.visible=!1,r.push((()=>Yx((()=>{if(null==i.value)return;const[e,n]=i.value,r=t.pixelSize.value;s.scale.set(e*r,n*r,1),s.updateMatrix()})))),s}class vZ extends Qo{constructor(e,t,n){const i=PR();super(i),hC(this,"instanceMatrix",void 0),hC(this,"count",0),hC(this,"isInstancedMesh",!0),hC(this,"instanceColor",null),hC(this,"morphTexture",null),hC(this,"boundingBox",new Dr),hC(this,"boundingSphere",new Or),this.instanceMatrix=e,this.frustumCulled=!1,i.attributes.aData=t,i.attributes.aClipping=n,this.customDepthMaterial=lZ,this.customDistanceMaterial=cZ}dispose(){this.dispatchEvent({type:"dispose"})}copy(){throw new Error("copy not implemented")}computeBoundingBox(){}computeBoundingSphere(){}updateMorphTargets(){}raycast(){}spherecast(){}}function wZ(e){const t=tS(e,"panelMaterialClass",Js),n=tS(e,"castShadow",!1),i=tS(e,"receiveShadow",!1);return Lx((()=>({panelMaterialClass:t.value,castShadow:n.value,receiveShadow:i.value})))}const GZ={panelMaterialClass:Js,castShadow:!1,receiveShadow:!1};class EZ{constructor(e,t,n,i,r,s){hC(this,"renderOrder",void 0),hC(this,"depthTest",void 0),hC(this,"pixelSize",void 0),hC(this,"root",void 0),hC(this,"object",void 0),hC(this,"map",new Map),this.renderOrder=e,this.depthTest=t,this.pixelSize=n,this.root=i,this.object=r,s.push((()=>{const e=()=>this.traverse((e=>e.onFrame()));return i.onFrameSet.add(e),()=>i.onFrameSet.delete(e)}),(()=>()=>this.traverse((e=>e.destroy()))),(()=>Yx((()=>{const t=e.value;this.traverse((e=>e.setRenderOrder(t))),this.root.requestRender()}))),(()=>Yx((()=>{const e=t.value;this.traverse((t=>t.setDepthTest(e))),this.root.requestRender()}))))}traverse(e){for(const t of this.map.values())for(const n of t.values())e(n)}getGroup(e){let{panelMaterialClass:t,receiveShadow:n,castShadow:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:GZ,r=this.map.get(t);null==r&&this.map.set(t,r=new Map);const s=(e<<2)+((n?1:0)<<1)+(i?1:0);let o=r.get(s);return null==o&&r.set(s,o=new SZ(this.renderOrder.peek(),this.depthTest.peek(),this.object,t,this.pixelSize,this.root,{elementType:gS.Panel,majorIndex:e,minorIndex:0},n,i)),o}}const xZ=Symbol("nextFrame");class SZ{constructor(e,t,n,i,r,s,o,a,l){hC(this,"renderOrder",void 0),hC(this,"object",void 0),hC(this,"pixelSize",void 0),hC(this,"root",void 0),hC(this,"orderInfo",void 0),hC(this,"meshReceiveShadow",void 0),hC(this,"meshCastShadow",void 0),hC(this,"mesh",void 0),hC(this,"instanceMatrix",void 0),hC(this,"instanceData",void 0),hC(this,"instanceClipping",void 0),hC(this,"instanceMaterial",void 0),hC(this,"buckets",[]),hC(this,"elementCount",0),hC(this,"bufferElementSize",0),hC(this,"instanceDataOnUpdate",void 0),hC(this,"nextUpdateTime",void 0),hC(this,"nextUpdateTimeoutRef",void 0),hC(this,"activateElement",((e,t,n)=>{const i=t.offset+n;this.instanceData.set(e.materialConfig.defaultData,16*i),this.instanceData.addUpdateRange(16*i,16),this.instanceData.needsUpdate=!0,e.activate(t,n)})),hC(this,"setElementIndex",((e,t)=>{e.setIndexInBucket(t)})),hC(this,"bufferCopyWithin",((e,t,n)=>{RZ(this.instanceMatrix,e,t,n),RZ(this.instanceData,e,t,n),RZ(this.instanceClipping,e,t,n)})),hC(this,"clearBufferAt",(e=>{const t=16*e;this.instanceMatrix.array.fill(0,t,t+16),this.instanceMatrix.addUpdateRange(t,16),this.instanceMatrix.needsUpdate=!0})),this.renderOrder=e,this.object=n,this.pixelSize=r,this.root=s,this.orderInfo=o,this.meshReceiveShadow=a,this.meshCastShadow=l,this.instanceMaterial=sZ(i,{type:"instanced"}),this.instanceMaterial.depthTest=t}updateCount(){const e=this.buckets[this.buckets.length-1],t=e.offset+e.elements.length;null!=this.mesh&&(this.mesh.count=t,this.mesh.visible=t>0,this.root.requestRender())}requestUpdate(e){if(this.nextUpdateTime==xZ)return;const t=performance.now()+e;null!=this.nextUpdateTime&&this.nextUpdateTime<t||(this.nextUpdateTime=t,clearTimeout(this.nextUpdateTimeoutRef),this.nextUpdateTimeoutRef=setTimeout(this.requestUpdateNextFrame.bind(this),e))}requestUpdateNextFrame(){this.nextUpdateTime=xZ,clearTimeout(this.nextUpdateTimeoutRef),this.nextUpdateTimeoutRef=void 0,this.root.requestRender()}setDepthTest(e){this.instanceMaterial.depthTest=e}setRenderOrder(e){this.renderOrder=e,null!=this.mesh&&(this.mesh.renderOrder=e)}insert(e,t){this.elementCount+=1,function(e,t,n,i){XR(e,t);const r=e[t];return r.missingSpace+=1,r.missingSpace<=0?(i(n,r,r.elements.length),r.elements.push(n),!1):(r.add.push(n),!0)}(this.buckets,e,t,this.activateElement)?this.requestUpdateNextFrame():this.updateCount()}delete(e,t,n){this.elementCount-=1,function(e,t,n,i,r,s,o,a){if(t>=e.length)throw new Error("no bucket at index ".concat(t));const l=e[t];l.missingSpace-=1;const c=l.add.indexOf(n);if(-1!=c)return l.add.splice(c,1),!1;if(null==i||i>=l.elements.length)throw new Error("no element at index ".concat(i));if(l.add.length>0){const e=l.add.shift();return l.elements[i]=e,r(e,l,i),!1}const g=l.offset,u=l.elements.length-1;if(u!=i){const e=g+u;a(g+i,e,e+1);const t=l.elements[u];l.elements[i]=t,o(t,i)}if(s(g+u),l.elements.length-=1,t<e.length-1)return!0;let A=l;for(;0===A.elements.length&&0==A.add.length&&t>0;)e[t-1].missingSpace+=A.missingSpace,A=e[--t];return e.length=t+1,!1}(this.buckets,e,n,t,this.activateElement,this.clearBufferAt,this.setElementIndex,this.bufferCopyWithin)?this.requestUpdate(1e3):this.updateCount()}onFrame(){this.nextUpdateTime==xZ&&(this.nextUpdateTime=void 0,this.update())}update(){0!==this.elementCount?((this.elementCount>this.bufferElementSize||this.elementCount<=this.bufferElementSize/3)&&this.resize(),function(e,t,n){let i=e.length,r=-1;for(let o=0;o<i;o++){const t=e[o];t.elements.length+t.add.length>0&&(r=o);const s=o===i-1;if(!s&&0===t.missingSpace)continue;const a=t.missingSpace<0;for(let i=o-1;i>=0;i--){const r=e[i];if(0===r.missingSpace)continue;const l=r.missingSpace<0;if(l&&(s||a)){YR(e,n,i,o,Math.abs(r.missingSpace));continue}if(!a&&!l)continue;const c=Math.min(Math.abs(r.missingSpace),Math.abs(t.missingSpace));a?zR(e,n,i,o,c):YR(e,n,i,o,c)}}const s=e[r];for(let o=r+1;o<i;o++)s.missingSpace+=e[o].missingSpace;i=e.length=r+1;for(let o=0;o<i;o++){const n=e[o],{elements:i,add:r}=n,s=r.length;for(let e=0;e<s;e++){const s=r[e];t(s,n,i.length),i.push(s)}r.length=0}}(this.buckets,this.activateElement,this.bufferCopyWithin),this.mesh.count=this.elementCount,this.mesh.visible=!0):null!=this.mesh&&(this.mesh.visible=!1)}resize(){var e;const t=this.bufferElementSize;var n,i,r,s;(this.bufferElementSize=Math.ceil(1.5*this.elementCount),null!=this.mesh)&&(this.mesh.dispose(),null===(n=this.object.current)||void 0===n||n.remove(this.mesh));i=this.buckets,r=t,s=this.bufferElementSize,XR(i,0),i[i.length-1].missingSpace+=r-s;const o=new Float32Array(16*this.bufferElementSize);null!=this.instanceMatrix&&o.set(this.instanceMatrix.array.subarray(0,o.length)),this.instanceMatrix=new Fg(o,16,!1),this.instanceMatrix.setUsage(Bi);const a=new Float32Array(16*this.bufferElementSize);null!=this.instanceData&&a.set(this.instanceData.array.subarray(0,a.length)),this.instanceData=new Fg(a,16,!1),this.instanceDataOnUpdate=(e,t)=>{this.instanceData.addUpdateRange(e,t),this.instanceData.needsUpdate=!0},this.instanceData.setUsage(Bi);const l=new Float32Array(16*this.bufferElementSize);null!=this.instanceClipping&&l.set(this.instanceClipping.array.subarray(0,l.length)),this.instanceClipping=new Fg(l,16,!1),this.instanceClipping.setUsage(Bi),this.mesh=new vZ(this.instanceMatrix,this.instanceData,this.instanceClipping),this.mesh.renderOrder=this.renderOrder,AS(this.mesh,this.root,{value:this.orderInfo}),this.mesh.material=this.instanceMaterial,this.mesh.receiveShadow=this.meshReceiveShadow,this.mesh.castShadow=this.meshCastShadow,null===(e=this.object.current)||void 0===e||e.add(this.mesh)}destroy(){clearTimeout(this.nextUpdateTimeoutRef)}}function RZ(e,t,n,i){const r=e.itemSize,s=n*r,o=i*r,a=t*r;e.array.copyWithin(a,s,o);const l=o-s;e.addUpdateRange(s,l),e.addUpdateRange(a,l),e.needsUpdate=!0}const ZZ=new Sr,DZ=new Sr;function FZ(){return Mx([0,0])}function NZ(e,t,n){return Lx((()=>{const i=t.value;if(null==i)return;const[r,s]=e.value,o=n.value;return(new rs).makeTranslation(-r*o,s*o,0).premultiply(i)}))}function MZ(e,t,n,i){return i.push((()=>Yx((()=>{var i,r;const[s,o]=t.value,a=n.value;null===(i=e.current)||void 0===i||i.position.set(-s*a,o*a,0),null===(r=e.current)||void 0===r||r.updateMatrix()}))))}function WZ(e,t){return Lx((()=>{var n;const[i,r]=null!==(n=null===t||void 0===t?void 0:t.value)&&void 0!==n?n:[!1,!1],[s,o]=e.value;return[i||s,r||o]}))}function kZ(e,t,n,i,r,s,o,a){let{scrollable:l,maxScrollPosition:c}=n;const g=Lx((()=>{var e,t;return null!==(e=null===(t=l.value)||void 0===t?void 0:t.some((e=>e)))&&void 0!==e&&e})),u=new Map,A=new Oi,d=(n,i,r,o,a)=>{var l,g,u;if(null==e.value)return;const[d,h]=null==n?[!1,!1]:function(e){var t;return null!==(t=e[TZ])&&void 0!==t?t:[!1,!1]}(n.nativeEvent);d&&(i=0),h&&(r=0);const[I,p]=e.value,[C,m]=c.value;let[f,y]=e.value;const[b,B]=null!==(l=null===t||void 0===t?void 0:t.value)&&void 0!==l?l:[!1,!1];f=VZ(I,C,i,a&&!b),y=VZ(p,m,r,a&&!B),null!=o&&o>0&&A.set(i,r).divideScalar(o),null!=n&&function(e,t,n){e[TZ]=[t,n]}(n.nativeEvent,d||Math.min(I,(null!==C&&void 0!==C?C:0)-I)>5,h||Math.min(p,(null!==m&&void 0!==m?m:0)-p)>5);!1===(null===(g=s.peek())||void 0===g||null===(u=g.onScroll)||void 0===u?void 0:u.call(g,f,y,e,n))||I===f&&p===y||(e.value=[f,y])},h=t=>{if(u.size>0||null==e.value)return;let n=0,i=0;const[r,s]=e.value,[a,l]=c.value,g=HZ(r,0,null!==a&&void 0!==a?a:0),h=HZ(s,0,null!==l&&void 0!==l?l:0);(Math.abs(g)>1||Math.abs(h)>1)&&o.requestFrame(),n+=-.3*g,i+=-.3*h,n+=A.x*t,i+=A.y*t,A.multiplyScalar(.9),Math.abs(A.x)<10?A.x=0:o.requestFrame(),Math.abs(A.y)<10?A.y=0:o.requestFrame(),0===n&&0===i||d(void 0,n,i,void 0,!0)};return a.push((()=>Yx((()=>{if(g.value)return o.onFrameSet.add(h),()=>o.onFrameSet.delete(h)})))),Lx((()=>{if(!g.value)return;const t=t=>{let{pointerId:n}=t;!u.delete(n)||u.size>0||null==e.value||o.requestRender()};return{onPointerDown:e=>{let{pointerId:t,point:n}=e,r=u.get(t);null==r&&u.set(t,r={timestamp:0,point:new Sr}),r.timestamp=performance.now()/1e3,i.current.worldToLocal(r.point.copy(n))},onPointerUp:t,onPointerLeave:t,onPointerCancel:t,onPointerMove:e=>{const t=u.get(e.pointerId);if(null==t)return;i.current.worldToLocal(DZ.copy(e.point)),ZZ.copy(DZ).sub(t.point).divideScalar(o.pixelSize.peek());const n=performance.now()/1e3,r=n-t.timestamp;t.point.copy(DZ),t.timestamp=n,e.defaultPrevented||d(e,-ZZ.x,ZZ.y,r,!0)},onWheel:e=>{if(e.defaultPrevented)return;const{nativeEvent:t}=e;d(e,t.deltaX,t.deltaY,void 0,!1)}}}))}const TZ=Symbol("was-scrolled");function VZ(e,t,n,i){if(0===n)return e;const r=HZ(e,0,null!==t&&void 0!==t?t:0);LZ(n)===LZ(r)&&(n*=Math.max(0,1-Math.abs(r)/100));let s=e+n;return i&&null!=t?s:Ay(s,0,null!==t&&void 0!==t?t:0)}function LZ(e){return e>=0}function HZ(e,t,n){return e<t?e-t:e>n?e-n:0}const QZ=["scrollbarBorderLeftWidth","scrollbarBorderRightWidth","scrollbarBorderTopWidth","scrollbarBorderBottomWidth"];function KZ(e,t,n,i,r,s,o,a,l){const c=uS(void 0,gS.Panel,GZ,o),g=tS(e,"scrollbarWidth",10),u=eS(e,QZ);YZ(e,0,t,n,i,r,s,c,a,g,u,l),YZ(e,1,t,n,i,r,s,c,a,g,u,l)}let XZ;function YZ(e,t,n,i,r,s,o,a,l,c,g,u){const A=Lx((()=>function(e,t,n,i,r,s){if(null==n||null==r||null==s)return;const o=i[e];if(null==o)return;const a=[0,0,0,0],l=1-e,c=n[e]-r[l]-r[l+2],g=Math.max(t,c*c/(o+c)),u=c-g,A=s[e];a[e]=.5*n[e]-.5*g-r[(e+3)%4]-u*Ay(A/o,0,1),a[l]=.5*n[l]-.5*t-r[l+1],0===e&&(a[0]*=-1,a[1]*=-1);return a[e+2]=g,a[l+2]=t,a}(t,c.value,i.size.value,i.maxScrollPosition.value,i.borderInset.value,n.value))),d=Lx((()=>{var e,t;return null!==(e=null===(t=A.value)||void 0===t?void 0:t.slice(0,2))&&void 0!==e?e:[0,0]})),h=Lx((()=>{var e,t;return null!==(e=null===(t=A.value)||void 0===t?void 0:t.slice(2,4))&&void 0!==e?e:[0,0]}));u.push((t=>LR(e,a,void 0,l,r,h,d,g,o,s,function(){var e;return null!==(e=XZ)&&void 0!==e||(XZ=$R({backgroundColor:"scrollbarColor",borderBottomLeftRadius:"scrollbarBorderBottomLeftRadius",borderBottomRightRadius:"scrollbarBorderBottomRightRadius",borderTopRightRadius:"scrollbarBorderTopRightRadius",borderTopLeftRadius:"scrollbarBorderTopLeftRadius",borderColor:"scrollbarBorderColor",borderBend:"scrollbarBorderBend",borderOpacity:"scrollbarBorderOpacity",backgroundOpacity:"scrollbarOpacity"},{backgroundColor:16777215,backgroundOpacity:1})),XZ}(),t)))}class zZ extends Qo{constructor(e,t,n,i,r){const s=new ga;s.translate(.5,-.5,0),super(s,r),hC(this,"instanceMatrix",void 0),hC(this,"instanceRGBA",void 0),hC(this,"instanceUV",void 0),hC(this,"instanceClipping",void 0),hC(this,"count",0),hC(this,"isInstancedMesh",!0),hC(this,"instanceColor",null),hC(this,"morphTexture",null),hC(this,"boundingBox",new Dr),hC(this,"boundingSphere",new Or),this.instanceMatrix=e,this.instanceRGBA=t,this.instanceUV=n,this.instanceClipping=i,s.attributes.instanceUVOffset=n,s.attributes.instanceRGBA=t,s.attributes.instanceClipping=i,this.frustumCulled=!1}copy(){throw new Error("copy not implemented")}dispose(){this.dispatchEvent({type:"dispose"})}computeBoundingBox(){}computeBoundingSphere(){}updateMorphTargets(){}raycast(){}spherecast(){}}class PZ extends Js{constructor(e){super({transparent:!0,depthWrite:!1,toneMapped:!1}),this.onBeforeCompile=t=>{t.uniforms.fontPage={value:e.page},t.uniforms.pageSize={value:[e.pageWidth,e.pageHeight]},t.uniforms.distanceRange={value:e.distanceRange},t.uniforms.v_weight={value:.3},t.vertexShader="attribute vec4 instanceUVOffset;\n        varying vec2 fontUv;\n        attribute vec4 instanceRGBA;\n        varying vec4 rgba;\n        attribute mat4 instanceClipping;\n        varying mat4 clipping;\n        varying vec3 localPosition;\n        "+t.vertexShader,t.vertexShader=t.vertexShader.replace("#include <uv_vertex>","#include <uv_vertex>\n            fontUv = instanceUVOffset.xy + uv * instanceUVOffset.zw;\n            rgba = instanceRGBA;\n            clipping = instanceClipping;\n            localPosition = (instanceMatrix * vec4(position, 1.0)).xyz;"),t.fragmentShader="uniform sampler2D fontPage;\n            uniform vec2 pageSize;\n            uniform int distanceRange;\n            uniform float v_weight;\n        varying vec2 fontUv;\n        varying vec4 rgba;\n        varying mat4 clipping; \n        varying vec3 localPosition;\n        float median(float r, float g, float b) {\n            return max(min(r, g), min(max(r, g), b));\n        }\n        float getDistance() {\n            vec3 msdf = texture(fontPage, fontUv).rgb;\n            return median(msdf.r, msdf.g, msdf.b);\n        }\n        "+t.fragmentShader,t.fragmentShader=t.fragmentShader.replace("#include <map_fragment>"," #include <map_fragment>\n          vec4 plane;\n          float distanceToPlane, distanceGradient;\n          float clipOpacity = 1.0;\n          for(int i = 0; i < 4; i++) {\n            plane = clipping[ i ];\n            distanceToPlane = - dot( -localPosition, plane.xyz ) + plane.w;\n            distanceGradient = fwidth( distanceToPlane ) / 2.0;\n            clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n      \n            if ( clipOpacity == 0.0 ) discard;\n          }\n          vec2 dxdy = fwidth(fontUv) * pageSize;\n          float dist = getDistance() + min(float(v_weight), 0.5 - 1.0 / float(distanceRange)) - 0.5;\n          float multiplier = clamp(dist * float(distanceRange) / length(dxdy) + 0.5, 0.0, 1.0);\n          if(multiplier <= 0.5) {\n              discard;\n          }\n          diffuseColor.a *= clipOpacity * min((multiplier - 0.5) / 0.5, 1.0);\n          diffuseColor *= rgba;\n            ")}}}class UZ{constructor(e,t,n,i,r,s){hC(this,"renderOrder",void 0),hC(this,"depthTest",void 0),hC(this,"pixelSize",void 0),hC(this,"root",void 0),hC(this,"object",void 0),hC(this,"map",new Map),this.renderOrder=e,this.depthTest=t,this.pixelSize=n,this.root=i,this.object=r,s.push((()=>{const e=e=>this.traverse((t=>t.onFrame(e)));return i.onFrameSet.add(e),()=>i.onFrameSet.delete(e)}),(()=>Yx((()=>{const t=e.value;this.traverse((e=>e.setRenderOrder(t)))}))),(()=>Yx((()=>{const e=t.value;this.traverse((t=>t.setDepthTest(e)))}))))}traverse(e){for(const t of this.map.values())for(const n of t.values())e(n)}getGroup(e,t){var n;let i=this.map.get(t);null==i&&this.map.set(t,i=new Map);let r=null===(n=i)||void 0===n?void 0:n.get(e);return null==r&&i.set(e,r=new _Z(this.renderOrder.peek(),this.depthTest.peek(),this.object,t,this.pixelSize,this.root,{majorIndex:e,elementType:gS.Text,minorIndex:0})),r}}class _Z{constructor(e,t,n,i,r,s,o){hC(this,"renderOrder",void 0),hC(this,"object",void 0),hC(this,"pixelSize",void 0),hC(this,"root",void 0),hC(this,"orderInfo",void 0),hC(this,"instanceMatrix",void 0),hC(this,"instanceUV",void 0),hC(this,"instanceRGBA",void 0),hC(this,"instanceClipping",void 0),hC(this,"glyphs",[]),hC(this,"requestedGlyphs",[]),hC(this,"holeIndicies",[]),hC(this,"mesh",void 0),hC(this,"instanceMaterial",void 0),hC(this,"timeTillDecimate",void 0),this.renderOrder=e,this.object=n,this.pixelSize=r,this.root=s,this.orderInfo=o,this.instanceMaterial=new PZ(i),this.instanceMaterial.depthTest=t}setDepthTest(e){this.instanceMaterial.depthTest=e,this.root.requestRender()}setRenderOrder(e){this.renderOrder=e,null!=this.mesh&&(this.mesh.renderOrder=e,this.root.requestRender())}requestActivate(e){const t=this.holeIndicies.shift();if(this.root.requestRender(),null!=t)return this.glyphs[t]=e,void e.activate(t);if(null==this.mesh||this.mesh.count>=this.instanceMatrix.count)return void this.requestedGlyphs.push(e);const n=this.mesh.count;this.glyphs[n]=e,e.activate(n),this.mesh.count+=1}delete(e){if(null==e.index){const t=this.requestedGlyphs.indexOf(e);if(-1===t)return;return void this.requestedGlyphs.splice(t,1)}this.root.requestRender();const t=this.requestedGlyphs.shift();if(null!=t)return t.activate(e.index),this.glyphs[e.index]=t,void(e.index=void 0);if(e.index===this.glyphs.length-1)return this.glyphs.length-=1,this.mesh.count-=1,void(e.index=void 0);const n=16*e.index;this.instanceMatrix.array.fill(0,n,n+16),this.instanceMatrix.addUpdateRange(n,16),this.instanceMatrix.needsUpdate=!0,this.holeIndicies.push(e.index),this.glyphs[e.index]=void 0,e.index=void 0}onFrame(e){var t,n;const i=this.glyphs.length-this.holeIndicies.length+this.requestedGlyphs.length;if(null!=this.mesh&&(this.mesh.visible=i>0),0===i)return;const r=null!==(t=null===(n=this.instanceMatrix)||void 0===n?void 0:n.count)&&void 0!==t?t:0;var s;i<r/3?null!==(s=this.timeTillDecimate)&&void 0!==s||(this.timeTillDecimate=1):this.timeTillDecimate=void 0;if(null!=this.timeTillDecimate&&(this.timeTillDecimate-=e),(null==this.timeTillDecimate||this.timeTillDecimate>0)&&i<=r)return;this.timeTillDecimate=void 0,this.resize(i);const o=this.mesh.count,a=this.requestedGlyphs.length;for(let l=0;l<a;l++){const e=this.requestedGlyphs[l];e.activate(o+l),this.glyphs[o+l]=e}this.mesh.count+=a,this.mesh.visible=!0,this.requestedGlyphs.length=0}resize(e){var t;const n=Math.ceil(1.5*e),i=new Float32Array(16*n),r=new Float32Array(4*n),s=new Float32Array(4*n),o=new Float32Array(16*n);this.instanceMatrix=new Fg(i,16,!1),this.instanceMatrix.setUsage(Bi),this.instanceUV=new Fg(r,4,!1),this.instanceUV.setUsage(Bi),this.instanceRGBA=new Fg(s,4,!1),this.instanceRGBA.setUsage(Bi),this.instanceClipping=new Fg(o,16,!1),this.instanceClipping.setUsage(Bi);const a=this.mesh;if(this.mesh=new zZ(this.instanceMatrix,this.instanceRGBA,this.instanceUV,this.instanceClipping,this.instanceMaterial),this.mesh.renderOrder=this.renderOrder,null!=a){var l;this.holeIndicies.sort(((e,t)=>e-t));const e=this.holeIndicies.length;let t=0,n=0;for(;n<e;){const e=this.holeIndicies[n];OZ(t-n,t,e,a,this.mesh),t=e+1,this.glyphs.splice(e-n,1),n++}if(OZ(t-n,t,a.count,a,this.mesh),this.holeIndicies.length>0)for(let i=this.holeIndicies[0];i<this.glyphs.length;i++)this.glyphs[i].setIndex(i);this.holeIndicies.length=0,null===(l=this.object.current)||void 0===l||l.remove(a),a.dispose()}AS(this.mesh,this.root,{value:this.orderInfo}),this.mesh.count=this.glyphs.length,null===(t=this.object.current)||void 0===t||t.add(this.mesh)}}function OZ(e,t,n,i,r){JZ(e,t,n,i.instanceMatrix.array,r.instanceMatrix.array,16),JZ(e,t,n,i.instanceUV.array,r.instanceUV.array,4),JZ(e,t,n,i.instanceRGBA.array,r.instanceRGBA.array,4),JZ(e,t,n,i.instanceClipping.array,r.instanceClipping.array,16)}function JZ(e,t,n,i,r,s){if(t===n)return;const o=e*s,a=t*s,l=n*s;r.set(i.subarray(a,l),o)}const jZ={sm:640,md:768,lg:1024,xl:1280,"2xl":1536},qZ=Object.keys(jZ),$Z=qZ.length;function eD(e){const t={};for(let n=0;n<$Z;n++){const i=qZ[n];t[i]=$x((()=>{var t,n;return(null!==(t=null===(n=e.value)||void 0===n?void 0:n[0])&&void 0!==t?t:0)>jZ[i]}))}return t}var tD,nD;const iD="undefined"===typeof matchMedia||null===(tD=matchMedia)||void 0===tD?void 0:tD("(prefers-color-scheme: dark)"),rD=Mx(null!==(nD=null===iD||void 0===iD?void 0:iD.matches)&&void 0!==nD&&nD);null===iD||void 0===iD||iD.addEventListener("change",(e=>rD.value=e.matches));const sD=Mx("system"),oD=Lx((()=>{switch(sD.value){case"system":return rD.value;case"dark":return!0;case"light":return!1}}));const aD={dark:$x((()=>oD.value))};const lD=.01,cD=new Sr,gD=new ra,uD=Mx(new rs);function AD(e,t,n,i,r,s,o,a,l){let c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:()=>{},g=arguments.length>10&&void 0!==arguments[10]?arguments[10]:()=>{};const u=Mx([0,0]),A=Mx([]),d=Mx([]),h=[];NF(A,h);const I=MR(t,n,i,{...aD,...eD(u),...MF(A),...wR(d)},{...dD(e,"sizeX","width"),...dD(e,"sizeY","height")}),p=tS(I,"renderOrder",0),C=tS(I,"depthTest",!0),m={cameraDistance:0,onFrameSet:l,requestRender:c,requestFrame:g,pixelSize:e},f=Mx(void 0),y=function(e,t,n){let i=!1;const r=()=>{const e=t.peek();i&&null!=e&&(i=!1,e.calculateLayout())};return n.push((()=>(e.onFrameSet.add(r),()=>e.onFrameSet.delete(r)))),()=>{i=!0,e.requestRender()}}(m,f,h),b=fR();h.push((e=>{const t=new yR(b,I,y,r,!0,e);return f.value=t,e}));const B=BS(I,b,e),v=function(e,t,n,i){const r=tS(e,"anchorX",ID),s=tS(e,"anchorY",pD);return Lx((()=>{var e;if(null==n.value)return;const[o,a]=n.value;return null===(e=t.value)||void 0===e?void 0:e.clone().premultiply(hD.makeTranslation(_x[r.value]*o*i.value,Ox[s.value]*a*i.value,0))}))}(I,B,b.size,e);GS(m,r,v,h);const w=wZ(I),G=uS(void 0,gS.Panel,w,void 0),E=new EZ(p,C,e,m,r,h),x=()=>{null!=r.current?(gD.normal.set(0,0,1),gD.constant=0,gD.applyMatrix4(r.current.matrixWorld),cD.setFromMatrixPosition(o().matrixWorld),m.cameraDistance=gD.distanceToPoint(cD)):m.cameraDistance=0};h.push((()=>(l.add(x),()=>l.delete(x))));const S=xR(b,void 0,I);h.push((e=>LR(I,G,w,E,uD,b.size,void 0,b.borderInset,void 0,S,qR(),e)));const R=FZ();MZ(s,R,e,h);const Z=NZ(R,uD,e);KZ(I,R,b,uD,S,void 0,G,E,h),TR(t,n,b.size,h);const D=new UZ(p,C,e,m,r,h),F=Object.assign(m,{requestFrame:g,scrollPosition:R,requestCalculateLayout:y,cameraDistance:0,gylphGroupManager:D,object:r,panelGroupManager:E,pixelSize:e,renderOrder:p,depthTest:C,renderer:a,size:b.size}),N=BZ(G,F,void 0,b.size,h),M=kZ(R,void 0,b,r,0,n,m,h);return Object.assign(b,{scrollPosition:R,mergedProperties:I,anyAncestorScrollable:b.scrollable,clippingRect:$S(uD,b,e,void 0),childrenMatrix:Z,node:f,orderInfo:G,initializers:h,interactionPanel:N,handlers:FR(t,n,i,A,d,M),root:F})}function dD(e,t,n){const i=new Map;return{[t]:(t,r)=>{let s=i.get(t);null==s&&i.set(t,s=Lx((()=>{const n=qx(t);if(null!=n)return n/e.value}))),r.add(n,s)}}}const hD=new rs,ID="center",pD="center";function CD(e,t,n,i,r,s){const o=Mx(void 0),a=fR(),l=Mx([]),c=Mx([]),g=[];NF(l,g);const u=MR(t,n,i,{...aD,...eD(e.root.size),...MF(l),...wR(c)});RR(o,a,e,u,r,!1,g);const A=BS(u,a,e.root.pixelSize);GS(e.root,r,A,g);const d=ER(e.childrenMatrix,A),h=qS(e.clippingRect,d,a.size,e.root.pixelSize),I=xR(a,h,u),p=wZ(u),C=uS(u,gS.Panel,p,e.orderInfo);g.push((t=>LR(u,C,p,e.root.panelGroupManager,d,a.size,void 0,a.borderInset,e.clippingRect,I,qR(),t)));const m=FZ();MZ(s,m,e.root.pixelSize,g);const f=NZ(m,d,e.root.pixelSize);KZ(u,m,a,d,I,e.clippingRect,C,e.root.panelGroupManager,g);const y=BZ(C,e.root,e.clippingRect,a.size,g),b=kZ(m,e.anyAncestorScrollable,a,r,0,n,e.root,g);return TR(t,n,a.size,g),VR(t,n,h,g),Object.assign(a,{isClipped:h,mergedProperties:u,anyAncestorScrollable:WZ(a.scrollable,e.anyAncestorScrollable),clippingRect:$S(d,a,e.root.pixelSize,e.clippingRect),childrenMatrix:f,node:o,orderInfo:C,root:e.root,scrollPosition:m,interactionPanel:y,handlers:FR(t,n,i,l,c,b),initializers:g})}const mD="fill";function fD(e,t,n,i,r,s){const o=[],a=Mx(void 0),l=Mx([]),c=Mx([]);NF(l,o);const g=Lx((()=>{var e,i,r;return null!==(e=qx(null===(i=t.value)||void 0===i?void 0:i.src))&&void 0!==e?e:qx(null===(r=n.value)||void 0===r?void 0:r.src)}));SR(a,GD,wD,o,g);const u=Lx((()=>{const e=a.value;if(null==e)return;const t=e.source.data;return t.width/t.height})),A=MR(t,n,i,{...aD,...eD(e.root.size),...MF(l),...wR(c)},DR,(e=>e.add("aspectRatio",u))),d=Mx(void 0),h=fR();RR(d,h,e,A,r,!0,o);const I=BS(A,h,e.root.pixelSize);GS(e.root,r,I,o);const p=ER(e.childrenMatrix,I),C=qS(e.clippingRect,p,h.size,e.root.pixelSize),m=xR(h,Lx((()=>C.value||null==a.value)),A),f=uS(A,gS.Image,void 0,e.orderInfo),y=FZ();MZ(s,y,e.root.pixelSize,o);const b=NZ(y,p,e.root.pixelSize);KZ(A,y,h,p,m,e.clippingRect,f,e.root.panelGroupManager,o);const B=function(e,t,n,i,r,s,o,a){const l=new Qo(UR);l.matrixAutoUpdate=!1;const c=nR(s,n.clippingRect),g=bD().computedIsVisibile(e,i.borderInset,i.size,o);(function(e,t,n,i,r,s,o,a){const l=new Float32Array(16),c={data:l,type:"normal"};t.customDepthMaterial=new aZ(c),t.customDistanceMaterial=new oZ(c),t.customDepthMaterial.clippingPlanes=s,t.customDistanceMaterial.clippingPlanes=s;const g=tS(e,"panelMaterialClass",Js);a.push((n=>(n.push(Yx((()=>{const e=sZ(g.value,c);return e.clippingPlanes=s,t.material=e,Yx((()=>{e.depthTest=o.depthTest.value,o.requestRender()}))})),Yx((()=>{t.renderOrder=o.renderOrder.value,o.requestRender()})),Yx((()=>{t.castShadow=e.value.read("castShadow",!1),o.requestRender()})),Yx((()=>{t.receiveShadow=e.value.read("receiveShadow",!1),o.requestRender()}))),n)));const u=bD(),A=[];a.push((()=>Yx((()=>{if(r.value)return l.set(u.defaultData),A.push(Yx((()=>null!=n.value&&l.set(n.value,13))),Yx((()=>null!=i.value&&l.set(i.value,0)))),o.requestRender(),()=>Px(A)}))));const d=u.setters;a.push((t=>(hR(e,r,u.hasProperty,((e,t)=>{d[e](l,0,t,n,void 0),o.requestRender()}),t),t)))})(e,l,i.size,i.borderInset,g,c,s,a),l.raycast=bZ(l,yZ(l),s.object,n.clippingRect,r),l.spherecast=bZ(l,fZ(l),s.object,n.clippingRect,r),AS(l,s,r);const u=tS(e,"objectFit",mD);return a.push((()=>Yx((()=>{const e=t.value;if(null==e||null==i.size.value||null==i.borderInset.value)return;if(e.matrix.identity(),s.requestRender(),"fill"===u.value||null==e)return void BD(i.borderInset,i.size,e);const{width:n,height:r}=e.source.data,o=n/r,[a,l]=i.size.value,[c,g,A,d]=i.borderInset.value,h=(a-d-g)/(l-c-A);o>h?e.matrix.translate(-.5*(h-o)/h,0).scale(h/o,1):e.matrix.translate(0,-.5*(o-h)/o).scale(1,o/h),BD(i.borderInset,i.size,e)})))),a.push((()=>Yx((()=>{l.visible=g.value,n.root.requestRender()})))),a.push((()=>Yx((()=>{var e;const i=null!==(e=t.value)&&void 0!==e?e:null;l.material.map!==i&&(l.material.map=i,l.material.needsUpdate=!0,n.root.requestRender())}))),(()=>Yx((()=>{if(null==i.size.value)return;const[e,t]=i.size.value,r=n.root.pixelSize.value;l.scale.set(e*r,t*r,1),l.updateMatrix(),n.root.requestRender()})))),l}(A,a,e,h,f,e.root,m,o),v=kZ(y,e.anyAncestorScrollable,h,r,0,n,e.root,o);return TR(t,n,h.size,o),VR(t,n,C,o),Object.assign(h,{scrollPosition:y,isClipped:C,mergedProperties:A,anyAncestorScrollable:WZ(h.scrollable,e.anyAncestorScrollable),initializers:o,handlers:FR(t,n,i,l,c,v),interactionPanel:B,clippingRect:$S(p,h,e.root.pixelSize,e.clippingRect),childrenMatrix:b,node:d,orderInfo:f,root:e.root})}let yD;function bD(){var e;return null!==(e=yD)&&void 0!==e||(yD=$R({borderBend:"borderBend",borderBottomLeftRadius:"borderBottomLeftRadius",borderBottomRightRadius:"borderBottomRightRadius",borderColor:"borderColor",borderOpacity:"borderOpacity",borderTopLeftRadius:"borderTopLeftRadius",borderTopRightRadius:"borderTopRightRadius",backgroundOpacity:"opacity"},{backgroundColor:16777215})),yD}function BD(e,t,n){if(null==t.value||null==e.value)return;const[i,r]=t.value,[s,o,a,l]=e.value,c=i-l-o,g=r-s-a;n.matrix.translate((l+c)/i-1,(s+g)/r-1).scale(i/c,r/g)}const vD=new Ld;function wD(e){!0===(null===e||void 0===e?void 0:e.disposable)&&e.dispose()}async function GD(e){if(null==e)return Promise.resolve(void 0);if(e instanceof mr)return Promise.resolve(e);try{const t=await vD.loadAsync(e);return t.colorSpace=Xn,t.matrixAutoUpdate=!1,Object.assign(t,{disposable:!0})}catch(HY){return void console.error(HY)}}function ED(e,t,n,i){return((null==i?0:e.getKerning(i,n.id))+n.xoffset)*t}function xD(e,t){if("number"===typeof e)return e;const n=zx.exec(e);if(null==n)throw new Error('invalid line height "'.concat(e,'"'));return t*parseFloat(n[1])/100}function SD(e,t,n){var i;return(null!==(i=null===n||void 0===n?void 0:n.yoffset)&&void 0!==i?i:0)*e+(xD(t,e)-e)/2}function RD(e,t,n){return t.xadvance*e+n}function ZD(e,t){return xD(e,t)}function DD(e,t){let{lineHeight:n,fontSize:i}=t;return Math.max(e,1)*xD(n,i)}function FD(e,t){const n=e.length;for(;" "===e[t]&&t<n;)t++;return t}const ND=new Map,MD=new Ld;function WD(e,t,n){let i=ND.get(e);if(i instanceof Set)return void i.add(n);if(null!=i)return void n(i);const r=new Set;r.add(n),ND.set(e,r),async function(e,t){const n=await(await fetch(e)).json();if(1!==n.pages.length)throw new Error("only supporting exactly 1 page");const i=await MD.loadAsync(new URL(n.pages[0],new URL(e,window.location.href)).href);return i.anisotropy=t.capabilities.getMaxAnisotropy(),i.flipY=!1,new HD(n,i)}(e,t).then((t=>{for(const e of r)e(t);ND.set(e,t)})).catch(console.error)}const kD={thin:100,"extra-light":200,light:300,normal:400,medium:500,"semi-bold":600,bold:700,"extra-bold":800,black:900,"extra-black":950},TD={inter:{light:"https://pmndrs.github.io/uikit/fonts/inter-light.json",normal:"https://pmndrs.github.io/uikit/fonts/inter-normal.json",medium:"https://pmndrs.github.io/uikit/fonts/inter-medium.json","semi-bold":"https://pmndrs.github.io/uikit/fonts/inter-semi-bold.json",bold:"https://pmndrs.github.io/uikit/fonts/inter-bold.json"}};function VD(e,t,n,i){const r=Mx(void 0),s=tS(e,"fontFamily",void 0),o=tS(e,"fontWeight","normal");return i.push((()=>Yx((()=>{var e;const i=null!==(e=null===t||void 0===t?void 0:t.value)&&void 0!==e?e:TD;let a=s.value;null==a&&(a=Object.keys(i)[0]);const l=function(e,t){let n,i=1/0;for(const r in e){const s=Math.abs(t-LD(r));if(0===s)return e[r];s<i&&(i=s,n=e[r])}if(null==n)throw new Error("font family has no entries ".concat(e));return n}(i[a],"string"===typeof o.value?kD[o.value]:o.value);let c=!1;return WD(l,n,(e=>c?void 0:r.value=e)),()=>c=!0})))),r}function LD(e){if(e in kD)return kD[e];const t=parseFloat(e);if(isNaN(t))throw new Error('invalid font weight "'.concat(e,'"'));return t}class HD{constructor(e,t){hC(this,"page",void 0),hC(this,"glyphInfoMap",new Map),hC(this,"kerningMap",new Map),hC(this,"questionmarkGlyphInfo",void 0),hC(this,"pageWidth",void 0),hC(this,"pageHeight",void 0),hC(this,"distanceRange",void 0),this.page=t;const{scaleW:n,scaleH:i,lineHeight:r}=e.common;this.pageWidth=n,this.pageHeight=i,this.distanceRange=e.distanceField.distanceRange;const{size:s}=e.info;for(const a of e.chars)a.uvX=a.x/n,a.uvY=a.y/i,a.uvWidth=a.width/n,a.uvHeight=a.height/i,a.width/=s,a.height/=s,a.xadvance/=s,a.xoffset/=s,a.yoffset-=r-s,a.yoffset/=s,this.glyphInfoMap.set(a.char,a);for(const{first:a,second:l,amount:c}of e.kernings)this.kerningMap.set("".concat(a,"/").concat(l),c/s);const o=this.glyphInfoMap.get("?");if(null==o)throw new Error("missing '?' glyph in font");this.questionmarkGlyphInfo=o}getGlyphInfo(e){var t,n;return null!==(t=null!==(n=this.glyphInfoMap.get(e))&&void 0!==n?n:"\n"==e?this.glyphInfoMap.get(" "):this.questionmarkGlyphInfo)&&void 0!==t?t:this.questionmarkGlyphInfo}getKerning(e,t){var n;return null!==(n=this.kerningMap.get("".concat(e,"/").concat(t)))&&void 0!==n?n:0}}const QD={"keep-all":(e,t,n,i)=>{let{text:r,fontSize:s,font:o,letterSpacing:a}=e;const l=n=FD(r,n);i.charIndexOffset=l,i.nonWhitespaceCharLength=0,i.charLength=0,i.nonWhitespaceWidth=0,i.whitespacesBetween=0;let c=0,g=0;for(;n<r.length;n++){const e=r[n];if("\n"===e)return void(i.charLength=n-l+1);c+=RD(s,o.getGlyphInfo(e),a)," "!==e?(i.nonWhitespaceWidth=c,i.whitespacesBetween=g,i.nonWhitespaceCharLength=n-l+1):g+=1}i.charLength=n-l},"break-all":(e,t,n,i)=>{let{text:r,fontSize:s,font:o,letterSpacing:a}=e;const l=n=FD(r,n);i.charIndexOffset=l,i.nonWhitespaceCharLength=0,i.charLength=0,i.nonWhitespaceWidth=0,i.whitespacesBetween=0;let c=0,g=0;for(;n<r.length;n++){const e=r[n];if("\n"===e)return void(i.charLength=n-l+1);if(c+=RD(s,o.getGlyphInfo(e),a)," "!==e){if(i.nonWhitespaceWidth>0&&null!=t&&c>t)break;i.nonWhitespaceCharLength=n-l+1,i.nonWhitespaceWidth=c,i.whitespacesBetween=g}else g+=1}i.charLength=n-l},"break-word":(e,t,n,i)=>{let{text:r,fontSize:s,font:o,letterSpacing:a}=e;const l=n=FD(r,n);i.charIndexOffset=l,i.nonWhitespaceCharLength=0,i.charLength=0,i.nonWhitespaceWidth=0,i.whitespacesBetween=0;let c=0,g=0;for(;n<r.length;n++){const e=r[n];if("\n"===e){i.charLength=n-l+1;break}if(c+=RD(s,o.getGlyphInfo(e),a)," "===e){g+=1,i.charLength=n-l+1;continue}if(i.nonWhitespaceWidth>0&&null!=t&&c>t)break;const u=r[n+1];" "!==u&&"\n"!==u&&null!=u||(i.charLength=n-l+1,i.nonWhitespaceCharLength=i.charLength,i.nonWhitespaceWidth=c,i.whitespacesBetween=g)}}},KD={};function XD(e,t){const n=QD[e.wordBreak],i=e.text;let r=0,s=0,o=0;for(;o<i.length;)n(e,t,o,KD),r=Math.max(r,KD.nonWhitespaceWidth),s+=1,o=KD.charLength+KD.charIndexOffset;return"\n"===i[i.length-1]&&(s+=1),{width:r,height:DD(s,e)}}const YD=new rs,zD=new rs;function PD(e){return Lx((()=>({font:e.value})))}class UD{constructor(e,t,n,i,r){hC(this,"group",void 0),hC(this,"baseMatrix",void 0),hC(this,"color",void 0),hC(this,"opacity",void 0),hC(this,"clippingRect",void 0),hC(this,"index",void 0),hC(this,"hidden",!0),hC(this,"glyphInfo",void 0),hC(this,"x",0),hC(this,"y",0),hC(this,"fontSize",0),hC(this,"pixelSize",0),this.group=e,this.baseMatrix=t,this.color=n,this.opacity=i,this.clippingRect=r}getX(e){return null==this.glyphInfo?this.x:this.x+e*this.glyphInfo.width*this.fontSize}show(){this.hidden&&(this.hidden=!1,this.group.requestActivate(this))}hide(){this.hidden||(this.hidden=!0,this.group.delete(this))}activate(e){this.index=e,this.writeUpdatedMatrix(),this.writeUV(),this.updateColor(this.color),this.updateOpacity(this.opacity),this.updateClippingRect(this.clippingRect)}setIndex(e){this.index=e}updateClippingRect(e){if(this.clippingRect=e,null==this.index)return;const t=16*this.index,{instanceClipping:n,root:i}=this.group;null==this.clippingRect?n.set(tR,t):this.clippingRect.toArray(n.array,t),n.addUpdateRange(t,16),n.needsUpdate=!0,i.requestRender()}updateColor(e){if(this.color=e,null==this.index)return;const{instanceRGBA:t,root:n}=this.group,i=t.itemSize*this.index;rZ(t.array,i,e,void 0),t.addUpdateRange(i,3),t.needsUpdate=!0,n.requestRender()}updateOpacity(e){if(this.opacity=e,null==this.index)return;const{instanceRGBA:t,root:n}=this.group,i=4*this.index+3;t.array[i]=e,t.addUpdateRange(i,1),t.needsUpdate=!0,n.requestRender()}updateGlyphAndTransformation(e,t,n,i,r){this.glyphInfo===e&&this.x===t&&this.y===n&&this.fontSize===i&&this.pixelSize===r||(this.glyphInfo!=e&&(this.glyphInfo=e,this.writeUV()),this.x=t,this.y=n,this.fontSize=i,this.pixelSize=r,this.writeUpdatedMatrix())}updateBaseMatrix(e){this.baseMatrix!==e&&(this.baseMatrix=e,this.writeUpdatedMatrix())}writeUV(){if(null==this.index||null==this.glyphInfo)return;const e=4*this.index,{instanceUV:t,root:n}=this.group;!function(e,t,n){t[n+0]=e.uvX,t[n+1]=e.uvY+e.uvHeight,t[n+2]=e.uvWidth,t[n+3]=-e.uvHeight}(this.glyphInfo,t.array,e),t.addUpdateRange(e,4),t.needsUpdate=!0,n.requestRender()}writeUpdatedMatrix(){if(null==this.index||null==this.glyphInfo||null==this.baseMatrix)return;const e=16*this.index,{instanceMatrix:t,root:n}=this.group;t.addUpdateRange(e,16),YD.makeTranslation(this.x*this.pixelSize,this.y*this.pixelSize,0).multiply(zD.makeScale(this.fontSize*this.glyphInfo.width*this.pixelSize,this.fontSize*this.glyphInfo.height*this.pixelSize,1)).premultiply(this.baseMatrix),YD.toArray(t.array,e),t.needsUpdate=!0,n.requestRender()}}const _D="middle",OD="left";function JD(e,t,n,i,r,s,o,a,l,c,g,u,A,d,h,I){let p={current:void 0};const C=function(e,t,n,i,r){const s=tS(e,"fontSize",16),o=tS(e,"letterSpacing",0),a=tS(e,"lineHeight","120%"),l=tS(e,"wordBreak",r);return Lx((()=>{const e=t.value;if(null==e)return;const r=n.value,c={font:e,fontSize:s.value,letterSpacing:o.value,lineHeight:a.value,text:Array.isArray(r)?r.map((e=>qx(e))).join(""):qx(r),wordBreak:l.value};i.current=c;const{width:g}=XD(c,0),{height:u}=XD(c,void 0);return{minHeight:u,minWidth:g,measure:(e,t)=>XD(c,t===LS.Undefined?void 0:e)}}))}(e,l,t,p,I),m=tS(e,"verticalAlign",_D),f=tS(e,"textAlign",OD),y=tS(e,"color",0),b=tS(e,"opacity",1),B=Mx(void 0);return h.push((()=>Yx((()=>{var e;return null===(e=i.value)||void 0===e?void 0:e.addLayoutChangeListener((()=>{const e=p.current,{size:{value:t},paddingInset:{value:n},borderInset:{value:i}}=r;if(null==e||null==t||null==n||null==i)return;const[s,o]=t,[a,l,c,g]=n,[u,A,d,h]=i,I=s-l-g-A-h,C=o-a-c-u-d;B.value=function(e,t,n){const i=[],r=QD[e.wordBreak],s=e.text;let o=0;for(;o<s.length;){const n={};r(e,t,o,n),i.push(n),o=n.charLength+n.charIndexOffset}return 0!==i.length&&"\n"!==s[s.length-1]||i.push({charLength:0,nonWhitespaceWidth:0,whitespacesBetween:0,charIndexOffset:s.length,nonWhitespaceCharLength:0}),{lines:i,availableHeight:n,availableWidth:t,...e}}(e,I,C)}))}))),(()=>Yx((()=>{const e=l.value;if(null==e||null==a.value)return;const t=new qD(c.getGroup(a.value.majorIndex,e),f,m,y,b,B,n,s,o,g,u,A);return null!=d&&(d.current=t),()=>t.destroy()})))),C}const jD=[];class qD{constructor(e,t,n,i,r,s,o,a,l,c,g,u){hC(this,"group",void 0),hC(this,"textAlign",void 0),hC(this,"verticalAlign",void 0),hC(this,"color",void 0),hC(this,"opacity",void 0),hC(this,"layoutSignal",void 0),hC(this,"matrix",void 0),hC(this,"parentClippingRect",void 0),hC(this,"selectionRange",void 0),hC(this,"selectionBoxes",void 0),hC(this,"caretPosition",void 0),hC(this,"glyphLines",[]),hC(this,"lastLayout",void 0),hC(this,"unsubscribeInitialList",[]),hC(this,"unsubscribeShowList",[]),this.group=e,this.textAlign=t,this.verticalAlign=n,this.color=i,this.opacity=r,this.layoutSignal=s,this.matrix=o,this.parentClippingRect=l,this.selectionRange=c,this.selectionBoxes=g,this.caretPosition=u,this.unsubscribeInitialList=[Yx((()=>{!a.value||r.value<.01?this.hide():this.show()})),Yx((()=>this.updateSelectionBoxes(this.lastLayout,null===c||void 0===c?void 0:c.value,n.peek(),t.peek())))]}getCharIndex(e,t){const n=this.lastLayout;if(null==n)return 0;t-=-eF(n,this.verticalAlign.peek());const i=Math.floor(t/-ZD(n.lineHeight,n.fontSize)),r=n.lines;if(i<0||0===r.length)return 0;if(i>=r.length){const e=r[r.length-1];return e.charIndexOffset+e.charLength+1}const s=r[i],o=n.font.getGlyphInfo(" ").xadvance*n.fontSize,a=this.glyphLines[i];let l=a.length;for(let c=0;c<l;c++){const t=a[c];if(e<this.getGlyphX(t,.5,o)+n.availableWidth/2)return c+s.charIndexOffset}return s.charIndexOffset+s.charLength+1}updateSelectionBoxes(e,t,n,i){if(null==this.caretPosition||null==this.selectionBoxes)return;if(null==t||null==e||0===e.lines.length)return this.caretPosition.value=void 0,void(this.selectionBoxes.value=jD);const r=e.font.getGlyphInfo(" ").xadvance*e.fontSize,[s,o]=t;if(o<=s){const{lineIndex:t,x:s}=this.getGlyphLineAndX(e,o,!0,r,i),a=-(eF(e,n)-e.availableHeight/2+t*ZD(e.lineHeight,e.fontSize)+SD(e.fontSize,e.lineHeight));return this.caretPosition.value=[s,a-e.fontSize/2,e.fontSize],void(this.selectionBoxes.value=[])}this.caretPosition.value=void 0;const a=this.getGlyphLineAndX(e,s,!0,r,i),l=this.getGlyphLineAndX(e,o-1,!1,r,i);if(a.lineIndex===l.lineIndex)return void(this.selectionBoxes.value=[this.computeSelectionBox(a.lineIndex,a.x,l.x,e,n,r)]);const c=[this.computeSelectionBox(a.lineIndex,a.x,void 0,e,n,r)];for(let g=a.lineIndex+1;g<l.lineIndex;g++)c.push(this.computeSelectionBox(g,void 0,void 0,e,n,r));c.push(this.computeSelectionBox(l.lineIndex,void 0,l.x,e,n,r)),this.selectionBoxes.value=c}computeSelectionBox(e,t,n,i,r,s){const o=this.glyphLines[e];null==t&&(t=this.getGlyphX(o[0],0,s)),null==n&&(n=this.getGlyphX(o[o.length-1],1,s));const a=ZD(i.lineHeight,i.fontSize),l=n-t;return{position:[t+l/2,-(eF(i,r)-i.availableHeight/2+e*a)-a/2],size:[l,a]}}getGlyphLineAndX(e,t,n,i,r){let{lines:s,availableWidth:o}=e;const a=s.length;for(let g=0;g<a;g++){const e=s[g];if(t>=e.charIndexOffset+e.charLength)continue;const r=this.glyphLines[g][Math.max(t-e.charIndexOffset,0)];return{lineIndex:g,x:this.getGlyphX(r,n?0:1,i)}}const l=s[a-1];if(0===l.charLength)return{lineIndex:a-1,x:$D(o,l.nonWhitespaceWidth,r)-o/2};const c=this.glyphLines[a-1][l.charLength-1];return{lineIndex:a-1,x:this.getGlyphX(c,1,i)}}getGlyphX(e,t,n){return"number"===typeof e?e+t*n:e.getX(t)}show(){this.unsubscribeShowList.length>0||(tF(this.glyphLines,(e=>e.show())),this.unsubscribeShowList.push(Yx((()=>{const e=this.matrix.value;null!=e&&tF(this.glyphLines,(t=>t.updateBaseMatrix(e)))})),Yx((()=>{var e;const t=null===(e=this.parentClippingRect)||void 0===e?void 0:e.value;tF(this.glyphLines,(e=>e.updateClippingRect(t)))})),Yx((()=>{const e=this.color.value;tF(this.glyphLines,(t=>t.updateColor(e)))})),Yx((()=>{const e=this.opacity.value;tF(this.glyphLines,(t=>t.updateOpacity(e)))})),Yx((()=>{var e;const t=this.layoutSignal.value;if(null==t)return;const{text:n,font:i,lines:r,letterSpacing:s=0,fontSize:o=16,lineHeight:a=1.2,availableWidth:l}=t;let c=eF(t,this.verticalAlign.value)-t.availableHeight/2;const g=r.length,u=this.group.pixelSize.value;for(let d=0;d<g;d++){d===this.glyphLines.length&&this.glyphLines.push([]);const{whitespacesBetween:e,nonWhitespaceWidth:t,charIndexOffset:g,nonWhitespaceCharLength:h,charLength:I}=r[d];let p,C="block"===this.textAlign.value?(l-t)/e:0,m=$D(l,t,this.textAlign.value)-l/2;const f=this.glyphLines[d];for(let r=g;r<g+I;r++){const e=r-g,t=n[r],l=i.getGlyphInfo(t);if(" "===t||r>h+g){p=l.id;const t=m+ED(i,o,l,p);"number"===typeof f[e]?f[e]=m:f.splice(e,0,t),m+=C+RD(o,l,s);continue}let d=f[e];for(;e<f.length&&"number"==typeof d;)f.splice(e,1),d=f[e];let I=d;var A;if(null==I)f[e]=I=new UD(this.group,this.matrix.peek(),this.color.peek(),this.opacity.peek(),null===(A=this.parentClippingRect)||void 0===A?void 0:A.peek());I.updateGlyphAndTransformation(l,m+ED(i,o,l,p),-(c+SD(o,a,l)),o,u),I.show(),p=l.id,m+=RD(o,l,s)}c+=ZD(a,o);const y=f.length,b=I;for(let n=b;n<y;n++){const e=f[n];"number"!==typeof e&&e.hide()}f.length=b}tF(this.glyphLines,(e=>e.hide()),g),this.glyphLines.length=g,this.lastLayout=t,this.updateSelectionBoxes(t,null===(e=this.selectionRange)||void 0===e?void 0:e.peek(),this.verticalAlign.value,this.textAlign.value)}))))}hide(){const e=this.unsubscribeShowList.length;if(0!==e){for(let t=0;t<e;t++)this.unsubscribeShowList[t]();this.unsubscribeShowList.length=0,tF(this.glyphLines,(e=>e.hide()))}}destroy(){this.hide(),this.glyphLines.length=0;const e=this.unsubscribeInitialList.length;for(let t=0;t<e;t++)this.unsubscribeInitialList[t]()}}function $D(e,t,n){switch(n){case"right":return e-t;case"center":return(e-t)/2;default:return 0}}function eF(e,t){switch(t){case"center":case"middle":return(e.availableHeight-DD(e.lines.length,e))/2;case"bottom":return e.availableHeight-DD(e.lines.length,e);default:return 0}}function tF(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=e.length;for(let r=n;r<i;r++){const n=e[r],i=n.length;for(let e=0;e<i;e++){const i=n[e];"number"!=typeof i&&t(i)}}}function nF(e,t,n,i,r,s,o){const a=Mx([]),l=Mx([]),c=[];NF(a,c);const g=MR(i,r,s,{...aD,...eD(e.root.size),...MF(a),...wR(l)}),u=Mx(void 0),A=fR();RR(u,A,e,g,o,!1,c);const d=BS(g,A,e.root.pixelSize);GS(e.root,o,d,c);const h=ER(e.childrenMatrix,d),I=qS(e.clippingRect,h,A.size,e.root.pixelSize),p=xR(A,I,g),C=wZ(g),m=uS(g,gS.Panel,C,e.orderInfo);c.push((t=>LR(g,m,C,e.root.panelGroupManager,h,A.size,void 0,A.borderInset,e.clippingRect,p,qR(),t)));const f=VD(g,n,e.root.renderer,c),y=uS(void 0,gS.Text,PD(f),m),b=JD(g,t,h,u,A,p,e.clippingRect,y,f,e.root.gylphGroupManager,void 0,void 0,void 0,void 0,c,"break-word");return c.push((()=>Yx((()=>{var e;return null===(e=u.value)||void 0===e?void 0:e.setCustomLayouting(b.value)})))),TR(i,r,A.size,c),VR(i,r,I,c),Object.assign(A,{isClipped:I,mergedProperties:g,interactionPanel:BZ(m,e.root,e.clippingRect,A.size,c),handlers:FR(i,r,s,a,l),initializers:c})}const iF=Xn;class rF extends Zd{constructor(e){super(e),this.defaultDPI=90,this.defaultUnit="px"}load(e,t,n,i){const r=this,s=new Nd(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(e,(function(n){try{t(r.parse(n))}catch(Ow){i?i(Ow):console.error(Ow),r.manager.itemError(e)}}),n,i)}parse(e){const t=this;function n(e,t,n,r,s,o,a,l){if(0==t||0==n)return void e.lineTo(l.x,l.y);r=r*Math.PI/180,t=Math.abs(t),n=Math.abs(n);const c=(a.x-l.x)/2,g=(a.y-l.y)/2,u=Math.cos(r)*c+Math.sin(r)*g,A=-Math.sin(r)*c+Math.cos(r)*g;let d=t*t,h=n*n;const I=u*u,p=A*A,C=I/d+p/h;if(C>1){const e=Math.sqrt(C);d=(t*=e)*t,h=(n*=e)*n}const m=d*p+h*I,f=(d*h-m)/m;let y=Math.sqrt(Math.max(0,f));s===o&&(y=-y);const b=y*t*A/n,B=-y*n*u/t,v=Math.cos(r)*b-Math.sin(r)*B+(a.x+l.x)/2,w=Math.sin(r)*b+Math.cos(r)*B+(a.y+l.y)/2,G=i(1,0,(u-b)/t,(A-B)/n),E=i((u-b)/t,(A-B)/n,(-u-b)/t,(-A-B)/n)%(2*Math.PI);e.currentPath.absellipse(v,w,t,n,G,G+E,0===o,r)}function i(e,t,n,i){const r=e*n+t*i,s=Math.sqrt(e*e+t*t)*Math.sqrt(n*n+i*i);let o=Math.acos(Math.max(-1,Math.min(1,r/s)));return e*i-t*n<0&&(o=-o),o}function r(e,t){t=Object.assign({},t);let n={};if(e.hasAttribute("class")){const t=e.getAttribute("class").split(/\s/).filter(Boolean).map((e=>e.trim()));for(let e=0;e<t.length;e++)n=Object.assign(n,I["."+t[e]])}function i(i,r,s){void 0===s&&(s=function(e){return e.startsWith("url")&&console.warn("SVGLoader: url access in attributes is not implemented."),e}),e.hasAttribute(i)&&(t[r]=s(e.getAttribute(i))),n[i]&&(t[r]=s(n[i])),e.style&&""!==e.style[i]&&(t[r]=s(e.style[i]))}function r(e){return Math.max(0,Math.min(1,c(e)))}function s(e){return Math.max(0,c(e))}return e.hasAttribute("id")&&(n=Object.assign(n,I["#"+e.getAttribute("id")])),i("fill","fill"),i("fill-opacity","fillOpacity",r),i("fill-rule","fillRule"),i("opacity","opacity",r),i("stroke","stroke"),i("stroke-opacity","strokeOpacity",r),i("stroke-width","strokeWidth",s),i("stroke-linejoin","strokeLineJoin"),i("stroke-linecap","strokeLineCap"),i("stroke-miterlimit","strokeMiterLimit",s),i("visibility","visibility"),t}function s(e,t){return e-(t-e)}function o(e,t,n){if("string"!==typeof e)throw new TypeError("Invalid input: "+typeof e);const i={SEPARATOR:/[ \t\r\n\,.\-+]/,WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i,FLAGS:/[01]/};let r=0,s=!0,o="",a="";const l=[];function c(e,t,n){const i=new SyntaxError('Unexpected character "'+e+'" at index '+t+".");throw i.partial=n,i}function g(){""!==o&&(""===a?l.push(Number(o)):l.push(Number(o)*Math.pow(10,Number(a)))),o="",a=""}let u;const A=e.length;for(let d=0;d<A;d++)if(u=e[d],Array.isArray(t)&&t.includes(l.length%n)&&i.FLAGS.test(u))r=1,o=u,g();else{if(0===r){if(i.WHITESPACE.test(u))continue;if(i.DIGIT.test(u)||i.SIGN.test(u)){r=1,o=u;continue}if(i.POINT.test(u)){r=2,o=u;continue}i.COMMA.test(u)&&(s&&c(u,d,l),s=!0)}if(1===r){if(i.DIGIT.test(u)){o+=u;continue}if(i.POINT.test(u)){o+=u,r=2;continue}if(i.EXP.test(u)){r=3;continue}i.SIGN.test(u)&&1===o.length&&i.SIGN.test(o[0])&&c(u,d,l)}if(2===r){if(i.DIGIT.test(u)){o+=u;continue}if(i.EXP.test(u)){r=3;continue}i.POINT.test(u)&&"."===o[o.length-1]&&c(u,d,l)}if(3===r){if(i.DIGIT.test(u)){a+=u;continue}if(i.SIGN.test(u)){if(""===a){a+=u;continue}1===a.length&&i.SIGN.test(a)&&c(u,d,l)}}i.WHITESPACE.test(u)?(g(),r=0,s=!1):i.COMMA.test(u)?(g(),r=0,s=!0):i.SIGN.test(u)?(g(),r=1,o=u):i.POINT.test(u)?(g(),r=2,o=u):c(u,d,l)}return g(),l}const a=["mm","cm","in","pt","pc","px"],l={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:12,pc:1,px:-1},px:{px:1}};function c(e){let n,i="px";if("string"===typeof e||e instanceof String)for(let t=0,r=a.length;t<r;t++){const n=a[t];if(e.endsWith(n)){i=n,e=e.substring(0,e.length-n.length);break}}return"px"===i&&"px"!==t.defaultUnit?n=l.in[t.defaultUnit]/t.defaultDPI:(n=l[i][t.defaultUnit],n<0&&(n=l[i].in*t.defaultDPI)),n*parseFloat(e)}function g(e){const t=e.elements;return t[0]*t[4]-t[1]*t[3]<0}function u(e){const t=e.elements,n=t[0]*t[3]+t[1]*t[4];if(0===n)return!1;const i=A(e),r=d(e);return Math.abs(n/(i*r))>Number.EPSILON}function A(e){const t=e.elements;return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function d(e){const t=e.elements;return Math.sqrt(t[3]*t[3]+t[4]*t[4])}const h=[],I={},p=[],C=new Ji,m=new Ji,f=new Ji,y=new Ji,b=new Oi,B=new Sr,v=new Ji,w=(new DOMParser).parseFromString(e,"image/svg+xml");!function e(t,i){if(1!==t.nodeType)return;const a=function(e){if(!(e.hasAttribute("transform")||"use"===e.nodeName&&(e.hasAttribute("x")||e.hasAttribute("y"))))return null;const t=function(e){const t=new Ji,n=C;if("use"===e.nodeName&&(e.hasAttribute("x")||e.hasAttribute("y"))){const n=c(e.getAttribute("x")),i=c(e.getAttribute("y"));t.translate(n,i)}if(e.hasAttribute("transform")){const i=e.getAttribute("transform").split(")");for(let e=i.length-1;e>=0;e--){const r=i[e].trim();if(""===r)continue;const s=r.indexOf("("),a=r.length;if(s>0&&s<a){const e=r.slice(0,s),t=o(r.slice(s+1));switch(n.identity(),e){case"translate":if(t.length>=1){const e=t[0];let i=0;t.length>=2&&(i=t[1]),n.translate(e,i)}break;case"rotate":if(t.length>=1){let e=0,i=0,r=0;e=t[0]*Math.PI/180,t.length>=3&&(i=t[1],r=t[2]),m.makeTranslation(-i,-r),f.makeRotation(e),y.multiplyMatrices(f,m),m.makeTranslation(i,r),n.multiplyMatrices(m,y)}break;case"scale":if(t.length>=1){const e=t[0];let i=e;t.length>=2&&(i=t[1]),n.scale(e,i)}break;case"skewX":1===t.length&&n.set(1,Math.tan(t[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":1===t.length&&n.set(1,0,0,Math.tan(t[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":6===t.length&&n.set(t[0],t[2],t[4],t[1],t[3],t[5],0,0,1)}}t.premultiply(n)}}return t}(e);p.length>0&&t.premultiply(p[p.length-1]);return v.copy(t),p.push(t),t}(t);let l=!1,w=null;switch(t.nodeName){case"svg":case"g":i=r(t,i);break;case"style":!function(e){if(!e.sheet||!e.sheet.cssRules||!e.sheet.cssRules.length)return;for(let t=0;t<e.sheet.cssRules.length;t++){const n=e.sheet.cssRules[t];if(1!==n.type)continue;const i=n.selectorText.split(/,/gm).filter(Boolean).map((e=>e.trim()));for(let e=0;e<i.length;e++){const t=Object.fromEntries(Object.entries(n.style).filter((e=>{let[,t]=e;return""!==t})));I[i[e]]=Object.assign(I[i[e]]||{},t)}}}(t);break;case"path":i=r(t,i),t.hasAttribute("d")&&(w=function(e){const t=new LI,i=new Oi,r=new Oi,a=new Oi;let l=!0,c=!1;const g=e.getAttribute("d");if(""===g||"none"===g)return null;const u=g.match(/[a-df-z][^a-df-z]*/gi);for(let A=0,d=u.length;A<d;A++){const e=u[A],g=e.charAt(0),d=e.slice(1).trim();let h;switch(!0===l&&(c=!0,l=!1),g){case"M":h=o(d);for(let e=0,n=h.length;e<n;e+=2)i.x=h[e+0],i.y=h[e+1],r.x=i.x,r.y=i.y,0===e?t.moveTo(i.x,i.y):t.lineTo(i.x,i.y),0===e&&a.copy(i);break;case"H":h=o(d);for(let e=0,n=h.length;e<n;e++)i.x=h[e],r.x=i.x,r.y=i.y,t.lineTo(i.x,i.y),0===e&&!0===c&&a.copy(i);break;case"V":h=o(d);for(let e=0,n=h.length;e<n;e++)i.y=h[e],r.x=i.x,r.y=i.y,t.lineTo(i.x,i.y),0===e&&!0===c&&a.copy(i);break;case"L":h=o(d);for(let e=0,n=h.length;e<n;e+=2)i.x=h[e+0],i.y=h[e+1],r.x=i.x,r.y=i.y,t.lineTo(i.x,i.y),0===e&&!0===c&&a.copy(i);break;case"C":h=o(d);for(let e=0,n=h.length;e<n;e+=6)t.bezierCurveTo(h[e+0],h[e+1],h[e+2],h[e+3],h[e+4],h[e+5]),r.x=h[e+2],r.y=h[e+3],i.x=h[e+4],i.y=h[e+5],0===e&&!0===c&&a.copy(i);break;case"S":h=o(d);for(let e=0,n=h.length;e<n;e+=4)t.bezierCurveTo(s(i.x,r.x),s(i.y,r.y),h[e+0],h[e+1],h[e+2],h[e+3]),r.x=h[e+0],r.y=h[e+1],i.x=h[e+2],i.y=h[e+3],0===e&&!0===c&&a.copy(i);break;case"Q":h=o(d);for(let e=0,n=h.length;e<n;e+=4)t.quadraticCurveTo(h[e+0],h[e+1],h[e+2],h[e+3]),r.x=h[e+0],r.y=h[e+1],i.x=h[e+2],i.y=h[e+3],0===e&&!0===c&&a.copy(i);break;case"T":h=o(d);for(let e=0,n=h.length;e<n;e+=2){const n=s(i.x,r.x),o=s(i.y,r.y);t.quadraticCurveTo(n,o,h[e+0],h[e+1]),r.x=n,r.y=o,i.x=h[e+0],i.y=h[e+1],0===e&&!0===c&&a.copy(i)}break;case"A":h=o(d,[3,4],7);for(let e=0,s=h.length;e<s;e+=7){if(h[e+5]==i.x&&h[e+6]==i.y)continue;const s=i.clone();i.x=h[e+5],i.y=h[e+6],r.x=i.x,r.y=i.y,n(t,h[e],h[e+1],h[e+2],h[e+3],h[e+4],s,i),0===e&&!0===c&&a.copy(i)}break;case"m":h=o(d);for(let e=0,n=h.length;e<n;e+=2)i.x+=h[e+0],i.y+=h[e+1],r.x=i.x,r.y=i.y,0===e?t.moveTo(i.x,i.y):t.lineTo(i.x,i.y),0===e&&a.copy(i);break;case"h":h=o(d);for(let e=0,n=h.length;e<n;e++)i.x+=h[e],r.x=i.x,r.y=i.y,t.lineTo(i.x,i.y),0===e&&!0===c&&a.copy(i);break;case"v":h=o(d);for(let e=0,n=h.length;e<n;e++)i.y+=h[e],r.x=i.x,r.y=i.y,t.lineTo(i.x,i.y),0===e&&!0===c&&a.copy(i);break;case"l":h=o(d);for(let e=0,n=h.length;e<n;e+=2)i.x+=h[e+0],i.y+=h[e+1],r.x=i.x,r.y=i.y,t.lineTo(i.x,i.y),0===e&&!0===c&&a.copy(i);break;case"c":h=o(d);for(let e=0,n=h.length;e<n;e+=6)t.bezierCurveTo(i.x+h[e+0],i.y+h[e+1],i.x+h[e+2],i.y+h[e+3],i.x+h[e+4],i.y+h[e+5]),r.x=i.x+h[e+2],r.y=i.y+h[e+3],i.x+=h[e+4],i.y+=h[e+5],0===e&&!0===c&&a.copy(i);break;case"s":h=o(d);for(let e=0,n=h.length;e<n;e+=4)t.bezierCurveTo(s(i.x,r.x),s(i.y,r.y),i.x+h[e+0],i.y+h[e+1],i.x+h[e+2],i.y+h[e+3]),r.x=i.x+h[e+0],r.y=i.y+h[e+1],i.x+=h[e+2],i.y+=h[e+3],0===e&&!0===c&&a.copy(i);break;case"q":h=o(d);for(let e=0,n=h.length;e<n;e+=4)t.quadraticCurveTo(i.x+h[e+0],i.y+h[e+1],i.x+h[e+2],i.y+h[e+3]),r.x=i.x+h[e+0],r.y=i.y+h[e+1],i.x+=h[e+2],i.y+=h[e+3],0===e&&!0===c&&a.copy(i);break;case"t":h=o(d);for(let e=0,n=h.length;e<n;e+=2){const n=s(i.x,r.x),o=s(i.y,r.y);t.quadraticCurveTo(n,o,i.x+h[e+0],i.y+h[e+1]),r.x=n,r.y=o,i.x=i.x+h[e+0],i.y=i.y+h[e+1],0===e&&!0===c&&a.copy(i)}break;case"a":h=o(d,[3,4],7);for(let e=0,s=h.length;e<s;e+=7){if(0==h[e+5]&&0==h[e+6])continue;const s=i.clone();i.x+=h[e+5],i.y+=h[e+6],r.x=i.x,r.y=i.y,n(t,h[e],h[e+1],h[e+2],h[e+3],h[e+4],s,i),0===e&&!0===c&&a.copy(i)}break;case"Z":case"z":t.currentPath.autoClose=!0,t.currentPath.curves.length>0&&(i.copy(a),t.currentPath.currentPoint.copy(i),l=!0);break;default:console.warn(e)}c=!1}return t}(t));break;case"rect":i=r(t,i),w=function(e){const t=c(e.getAttribute("x")||0),n=c(e.getAttribute("y")||0),i=c(e.getAttribute("rx")||e.getAttribute("ry")||0),r=c(e.getAttribute("ry")||e.getAttribute("rx")||0),s=c(e.getAttribute("width")),o=c(e.getAttribute("height")),a=.448084975506,l=new LI;l.moveTo(t+i,n),l.lineTo(t+s-i,n),(0!==i||0!==r)&&l.bezierCurveTo(t+s-i*a,n,t+s,n+r*a,t+s,n+r);l.lineTo(t+s,n+o-r),(0!==i||0!==r)&&l.bezierCurveTo(t+s,n+o-r*a,t+s-i*a,n+o,t+s-i,n+o);l.lineTo(t+i,n+o),(0!==i||0!==r)&&l.bezierCurveTo(t+i*a,n+o,t,n+o-r*a,t,n+o-r);l.lineTo(t,n+r),(0!==i||0!==r)&&l.bezierCurveTo(t,n+r*a,t+i*a,n,t+i,n);return l}(t);break;case"polygon":i=r(t,i),w=function(e){function t(e,t,n){const s=c(t),o=c(n);0===r?i.moveTo(s,o):i.lineTo(s,o),r++}const n=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,i=new LI;let r=0;return e.getAttribute("points").replace(n,t),i.currentPath.autoClose=!0,i}(t);break;case"polyline":i=r(t,i),w=function(e){function t(e,t,n){const s=c(t),o=c(n);0===r?i.moveTo(s,o):i.lineTo(s,o),r++}const n=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,i=new LI;let r=0;return e.getAttribute("points").replace(n,t),i.currentPath.autoClose=!1,i}(t);break;case"circle":i=r(t,i),w=function(e){const t=c(e.getAttribute("cx")||0),n=c(e.getAttribute("cy")||0),i=c(e.getAttribute("r")||0),r=new Ou;r.absarc(t,n,i,0,2*Math.PI);const s=new LI;return s.subPaths.push(r),s}(t);break;case"ellipse":i=r(t,i),w=function(e){const t=c(e.getAttribute("cx")||0),n=c(e.getAttribute("cy")||0),i=c(e.getAttribute("rx")||0),r=c(e.getAttribute("ry")||0),s=new Ou;s.absellipse(t,n,i,r,0,2*Math.PI);const o=new LI;return o.subPaths.push(s),o}(t);break;case"line":i=r(t,i),w=function(e){const t=c(e.getAttribute("x1")||0),n=c(e.getAttribute("y1")||0),i=c(e.getAttribute("x2")||0),r=c(e.getAttribute("y2")||0),s=new LI;return s.moveTo(t,n),s.lineTo(i,r),s.currentPath.autoClose=!1,s}(t);break;case"defs":l=!0;break;case"use":i=r(t,i);const a=(t.getAttributeNS("http://www.w3.org/1999/xlink","href")||"").substring(1),g=t.viewportElement.getElementById(a);g?e(g,i):console.warn("SVGLoader: 'use node' references non-existent node id: "+a)}w&&(void 0!==i.fill&&"none"!==i.fill&&w.color.setStyle(i.fill,iF),function(e,t){function n(e){B.set(e.x,e.y,1).applyMatrix3(t),e.set(B.x,B.y)}function i(e){const n=e.xRadius,i=e.yRadius,r=Math.cos(e.aRotation),s=Math.sin(e.aRotation),o=new Sr(n*r,n*s,0),a=new Sr(-i*s,i*r,0),l=o.applyMatrix3(t),c=a.applyMatrix3(t),u=C.set(l.x,c.x,0,l.y,c.y,0,0,0,1),A=m.copy(u).invert(),d=f.copy(A).transpose().multiply(A).elements,h=function(e,t,n){let i,r,s,o,a;const l=e+n,c=e-n,g=Math.sqrt(c*c+4*t*t);l>0?(i=.5*(l+g),a=1/i,r=e*a*n-t*a*t):l<0?r=.5*(l-g):(i=.5*g,r=-.5*g);s=c>0?c+g:c-g;Math.abs(s)>2*Math.abs(t)?(a=-2*t/s,o=1/Math.sqrt(1+a*a),s=a*o):0===Math.abs(t)?(s=1,o=0):(a=-.5*s/t,s=1/Math.sqrt(1+a*a),o=a*s);c>0&&(a=s,s=-o,o=a);return{rt1:i,rt2:r,cs:s,sn:o}}(d[0],d[1],d[4]),I=Math.sqrt(h.rt1),p=Math.sqrt(h.rt2);e.xRadius=1/I,e.yRadius=1/p,e.aRotation=Math.atan2(h.sn,h.cs);if(!((e.aEndAngle-e.aStartAngle)%(2*Math.PI)<Number.EPSILON)){const n=m.set(I,0,0,0,p,0,0,0,1),i=f.set(h.cs,h.sn,0,-h.sn,h.cs,0,0,0,1),r=n.multiply(i).multiply(u),s=e=>{const{x:t,y:n}=new Sr(Math.cos(e),Math.sin(e),0).applyMatrix3(r);return Math.atan2(n,t)};e.aStartAngle=s(e.aStartAngle),e.aEndAngle=s(e.aEndAngle),g(t)&&(e.aClockwise=!e.aClockwise)}}function r(e){const n=A(t),i=d(t);e.xRadius*=n,e.yRadius*=i;const r=n>Number.EPSILON?Math.atan2(t.elements[1],t.elements[0]):Math.atan2(-t.elements[3],t.elements[4]);e.aRotation+=r,g(t)&&(e.aStartAngle*=-1,e.aEndAngle*=-1,e.aClockwise=!e.aClockwise)}const s=e.subPaths;for(let o=0,a=s.length;o<a;o++){const e=s[o].curves;for(let s=0;s<e.length;s++){const o=e[s];o.isLineCurve?(n(o.v1),n(o.v2)):o.isCubicBezierCurve?(n(o.v0),n(o.v1),n(o.v2),n(o.v3)):o.isQuadraticBezierCurve?(n(o.v0),n(o.v1),n(o.v2)):o.isEllipseCurve&&(b.set(o.aX,o.aY),n(b),o.aX=b.x,o.aY=b.y,u(t)?i(o):r(o))}}}(w,v),h.push(w),w.userData={node:t,style:i});const G=t.childNodes;for(let n=0;n<G.length;n++){const t=G[n];l&&"style"!==t.nodeName&&"defs"!==t.nodeName||e(t,i)}a&&(p.pop(),p.length>0?v.copy(p[p.length-1]):v.identity())}(w.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4});return{paths:h,xml:w.documentElement}}static createShapes(e){const t=999999999,n=0,i=1,r=2,s=3,o=4,a=5,l=6,c={loc:n,t:0};function g(e,t,i,s){const o=e.x,a=t.x,l=i.x,g=s.x,A=e.y,d=t.y,h=i.y,I=s.y,p=(g-l)*(A-h)-(I-h)*(o-l),C=(I-h)*(a-o)-(g-l)*(d-A),m=p/C,f=((a-o)*(A-h)-(d-A)*(o-l))/C;if(0===C&&0!==p||m<=0||m>=1||f<0||f>1)return null;if(0===p&&0===C){for(let l=0;l<2;l++){if(u(0===l?i:s,e,t),c.loc==n){const e=0===l?i:s;return{x:e.x,y:e.y,t:c.t}}if(c.loc==r){return{x:+(o+c.t*(a-o)).toPrecision(10),y:+(A+c.t*(d-A)).toPrecision(10),t:c.t}}}return null}for(let r=0;r<2;r++)if(u(0===r?i:s,e,t),c.loc==n){const e=0===r?i:s;return{x:e.x,y:e.y,t:c.t}}return{x:+(o+m*(a-o)).toPrecision(10),y:+(A+m*(d-A)).toPrecision(10),t:m}}function u(e,t,g){const u=g.x-t.x,A=g.y-t.y,d=e.x-t.x,h=e.y-t.y,I=u*h-d*A;if(e.x===t.x&&e.y===t.y)return c.loc=n,void(c.t=0);if(e.x===g.x&&e.y===g.y)return c.loc=i,void(c.t=1);if(I<-Number.EPSILON)return void(c.loc=s);if(I>Number.EPSILON)return void(c.loc=o);if(u*d<0||A*h<0)return void(c.loc=a);if(Math.sqrt(u*u+A*A)<Math.sqrt(d*d+h*h))return void(c.loc=l);let p;p=0!==u?d/u:h/A,c.loc=r,c.t=p}function A(e,t,n){const i=new Oi;t.getCenter(i);const r=[];return n.forEach((t=>{if(t.boundingBox.containsPoint(i)){const n=function(e,t){const n=[],i=[];for(let r=1;r<e.length;r++){const s=e[r-1],o=e[r];for(let e=1;e<t.length;e++){const r=g(s,o,t[e-1],t[e]);null!==r&&void 0===n.find((e=>e.t<=r.t+Number.EPSILON&&e.t>=r.t-Number.EPSILON))&&(n.push(r),i.push(new Oi(r.x,r.y)))}}return i}(e,t.points);n.forEach((e=>{r.push({identifier:t.identifier,isCW:t.isCW,point:e})}))}})),r.sort(((e,t)=>e.point.x-t.point.x)),r}let d=t,h=-999999999,I=e.subPaths.map((e=>{const n=e.getPoints();let i=-999999999,r=t,s=-999999999,o=t;for(let t=0;t<n.length;t++){const e=n[t];e.y>i&&(i=e.y),e.y<r&&(r=e.y),e.x>s&&(s=e.x),e.x<o&&(o=e.x)}return h<=s&&(h=s+1),d>=o&&(d=o-1),{curves:e.curves,points:n,isCW:MA.isClockWise(n),identifier:-1,boundingBox:new rI(new Oi(o,r),new Oi(s,i))}}));I=I.filter((e=>e.points.length>1));for(let m=0;m<I.length;m++)I[m].identifier=m;const p=I.map((t=>function(e,t,n,i,r){null!==r&&void 0!==r&&""!==r||(r="nonzero");const s=new Oi;e.boundingBox.getCenter(s);const o=A([new Oi(n,s.y),new Oi(i,s.y)],e.boundingBox,t);o.sort(((e,t)=>e.point.x-t.point.x));const a=[],l=[];o.forEach((t=>{t.identifier===e.identifier?a.push(t):l.push(t)}));const c=a[0].point.x,g=[];let u=0;for(;u<l.length&&l[u].point.x<c;)g.length>0&&g[g.length-1]===l[u].identifier?g.pop():g.push(l[u].identifier),u++;if(g.push(e.identifier),"evenodd"===r){const t=g.length%2===0,n=g[g.length-2];return{identifier:e.identifier,isHole:t,for:n}}if("nonzero"===r){let n=!0,i=null,r=null;for(let e=0;e<g.length;e++){const s=g[e];n?(r=t[s].isCW,n=!1,i=s):r!==t[s].isCW&&(r=t[s].isCW,n=!0)}return{identifier:e.identifier,isHole:n,for:i}}console.warn('fill-rule: "'+r+'" is currently not implemented.')}(t,I,d,h,e.userData?e.userData.style.fillRule:void 0))),C=[];return I.forEach((e=>{if(!p[e.identifier].isHole){const t=new lA;t.curves=e.curves;const n=p.filter((t=>t.isHole&&t.for===e.identifier));n.forEach((e=>{const n=I[e.identifier],i=new Ou;i.curves=n.curves,t.holes.push(i)})),C.push(t)}})),C}static getStrokeStyle(e,t,n,i,r){return{strokeColor:t=void 0!==t?t:"#000",strokeWidth:e=void 0!==e?e:1,strokeLineJoin:n=void 0!==n?n:"miter",strokeLineCap:i=void 0!==i?i:"butt",strokeMiterLimit:r=void 0!==r?r:4}}static pointsToStroke(e,t,n,i){const r=[],s=[],o=[];if(0===rF.pointsToStrokeWithBuffers(e,t,n,i,r,s,o))return null;const a=new vo;return a.setAttribute("position",new ho(r,3)),a.setAttribute("normal",new ho(s,3)),a.setAttribute("uv",new ho(o,2)),a}static pointsToStrokeWithBuffers(e,t,n,i,r,s,o,a){const l=new Oi,c=new Oi,g=new Oi,u=new Oi,A=new Oi,d=new Oi,h=new Oi,I=new Oi,p=new Oi,C=new Oi,m=new Oi,f=new Oi,y=new Oi,b=new Oi,B=new Oi,v=new Oi,w=new Oi;n=void 0!==n?n:12,i=void 0!==i?i:.001,a=void 0!==a?a:0,e=function(e){let t=!1;for(let r=1,s=e.length-1;r<s;r++)if(e[r].distanceTo(e[r+1])<i){t=!0;break}if(!t)return e;const n=[];n.push(e[0]);for(let r=1,s=e.length-1;r<s;r++)e[r].distanceTo(e[r+1])>=i&&n.push(e[r]);return n.push(e[e.length-1]),n}(e);const G=e.length;if(G<2)return 0;const E=e[0].equals(e[G-1]);let x,S,R=e[0];const Z=t.strokeWidth/2,D=1/(G-1);let F,N,M,W,k=0,T=!1,V=0,L=3*a,H=2*a;Q(e[0],e[1],l).multiplyScalar(Z),I.copy(e[0]).sub(l),p.copy(e[0]).add(l),C.copy(I),m.copy(p);for(let _=1;_<G;_++){x=e[_],S=_===G-1?E?e[1]:void 0:e[_+1];const n=l;if(Q(R,x,n),g.copy(n).multiplyScalar(Z),f.copy(x).sub(g),y.copy(x).add(g),F=k+D,N=!1,void 0!==S){Q(x,S,c),g.copy(c).multiplyScalar(Z),b.copy(x).sub(g),B.copy(x).add(g),M=!0,g.subVectors(S,R),n.dot(g)<0&&(M=!1),1===_&&(T=M),g.subVectors(S,x),g.normalize();const e=Math.abs(n.dot(g));if(e>Number.EPSILON){const n=Z/e;g.multiplyScalar(-n),u.subVectors(x,R),A.copy(u).setLength(n).add(g),v.copy(A).negate();const i=A.length(),r=u.length();u.divideScalar(r),d.subVectors(S,x);const s=d.length();switch(d.divideScalar(s),u.dot(v)<r&&d.dot(v)<s&&(N=!0),w.copy(A).add(x),v.add(x),W=!1,N?M?(B.copy(v),y.copy(v)):(b.copy(v),f.copy(v)):Y(),t.strokeLineJoin){case"bevel":z(M,N,F);break;case"round":P(M,N),M?X(x,f,b,F,0):X(x,B,y,F,1);break;default:const e=Z*t.strokeMiterLimit/i;if(e<1){if("miter-clip"!==t.strokeLineJoin){z(M,N,F);break}P(M,N),M?(d.subVectors(w,f).multiplyScalar(e).add(f),h.subVectors(w,b).multiplyScalar(e).add(b),K(f,F,0),K(d,F,0),K(x,F,.5),K(x,F,.5),K(d,F,0),K(h,F,0),K(x,F,.5),K(h,F,0),K(b,F,0)):(d.subVectors(w,y).multiplyScalar(e).add(y),h.subVectors(w,B).multiplyScalar(e).add(B),K(y,F,1),K(d,F,1),K(x,F,.5),K(x,F,.5),K(d,F,1),K(h,F,1),K(x,F,.5),K(h,F,1),K(B,F,1))}else N?(M?(K(p,k,1),K(I,k,0),K(w,F,0),K(p,k,1),K(w,F,0),K(v,F,1)):(K(p,k,1),K(I,k,0),K(w,F,1),K(I,k,0),K(v,F,0),K(w,F,1)),M?b.copy(w):B.copy(w)):M?(K(f,F,0),K(w,F,0),K(x,F,.5),K(x,F,.5),K(w,F,0),K(b,F,0)):(K(y,F,1),K(w,F,1),K(x,F,.5),K(x,F,.5),K(w,F,1),K(B,F,1)),W=!0}}else Y()}else Y();E||_!==G-1||U(e[0],C,m,M,!0,k),k=F,R=x,I.copy(b),p.copy(B)}if(E){if(N&&r){let e=w,t=v;T!==M&&(e=v,t=w),M?(W||T)&&(t.toArray(r,0),t.toArray(r,9),W&&e.toArray(r,3)):!W&&T||(t.toArray(r,3),t.toArray(r,9),W&&e.toArray(r,0))}}else U(x,f,y,M,!1,F);return V;function Q(e,t,n){return n.subVectors(t,e),n.set(-n.y,n.x).normalize()}function K(e,t,n){r&&(r[L]=e.x,r[L+1]=e.y,r[L+2]=0,s&&(s[L]=0,s[L+1]=0,s[L+2]=1),L+=3,o&&(o[H]=t,o[H+1]=n,H+=2)),V+=3}function X(e,t,i,r,s){l.copy(t).sub(e).normalize(),c.copy(i).sub(e).normalize();let o=Math.PI;const a=l.dot(c);Math.abs(a)<1&&(o=Math.abs(Math.acos(a))),o/=n,g.copy(t);for(let l=0,c=n-1;l<c;l++)u.copy(g).rotateAround(e,o),K(g,r,s),K(u,r,s),K(e,r,.5),g.copy(u);K(u,r,s),K(i,r,s),K(e,r,.5)}function Y(){K(p,k,1),K(I,k,0),K(f,F,0),K(p,k,1),K(f,F,1),K(y,F,0)}function z(e,t,n){t?e?(K(p,k,1),K(I,k,0),K(f,F,0),K(p,k,1),K(f,F,0),K(v,F,1),K(f,n,0),K(b,n,0),K(v,n,.5)):(K(p,k,1),K(I,k,0),K(y,F,1),K(I,k,0),K(v,F,0),K(y,F,1),K(y,n,1),K(v,n,0),K(B,n,1)):e?(K(f,n,0),K(b,n,0),K(x,n,.5)):(K(y,n,1),K(B,n,0),K(x,n,.5))}function P(e,t){t&&(e?(K(p,k,1),K(I,k,0),K(f,F,0),K(p,k,1),K(f,F,0),K(v,F,1),K(f,k,0),K(x,F,.5),K(v,F,1),K(x,F,.5),K(b,k,0),K(v,F,1)):(K(p,k,1),K(I,k,0),K(y,F,1),K(I,k,0),K(v,F,0),K(y,F,1),K(y,k,1),K(v,F,0),K(x,F,.5),K(x,F,.5),K(v,F,0),K(B,k,1)))}function U(e,n,i,s,o,a){switch(t.strokeLineCap){case"round":o?X(e,i,n,a,.5):X(e,n,i,a,.5);break;case"square":if(o)l.subVectors(n,e),c.set(l.y,-l.x),g.addVectors(l,c).add(e),u.subVectors(c,l).add(e),s?(g.toArray(r,3),u.toArray(r,0),u.toArray(r,9)):(g.toArray(r,3),g.toArray(r,9),u.toArray(r,0));else{l.subVectors(i,e),c.set(l.y,-l.x),g.addVectors(l,c).add(e),u.subVectors(c,l).add(e);const t=r.length;s?(g.toArray(r,t-3),u.toArray(r,t-6),u.toArray(r,t-12)):(u.toArray(r,t-6),g.toArray(r,t-3),u.toArray(r,t-12))}}}}}function sF(e,t,n,i,r,s){const o=[],a=Mx([]),l=Mx([]);NF(a,o);const c=Mx(void 0),g=MR(t,n,i,{...aD,...eD(e.root.size),...MF(a),...wR(l)},DR,(e=>e.add("aspectRatio",c))),u=Mx(void 0),A=fR();RR(u,A,e,g,r,!0,o);const d=BS(g,A,e.root.pixelSize);GS(e.root,r,d,o);const h=ER(e.childrenMatrix,d),I=qS(e.clippingRect,h,A.size,e.root.pixelSize),p=xR(A,I,g),C=wZ(g),m=uS(g,gS.Panel,C,e.orderInfo);o.push((t=>LR(g,m,C,e.root.panelGroupManager,h,A.size,void 0,A.borderInset,e.clippingRect,p,qR(),t)));const f=uS(void 0,gS.Svg,void 0,m),y=Lx((()=>{var e,i,r;return null!==(e=qx(null===(i=t.value)||void 0===i?void 0:i.src))&&void 0!==e?e:qx(null===(r=n.value)||void 0===r?void 0:r.src)})),b=Mx(void 0),B=nR(e.root,e.clippingRect);SR(b,gF,GR,o,y,e.root,B,e.clippingRect,f,c),kR(g,b,o,e.root);const v=function(e,t,n,i,r,s){const o=new Vc;return o.matrixAutoUpdate=!1,s.push((()=>Yx((()=>{var n;jx(o.position,o.scale,t.size,t.paddingInset,t.borderInset,e.pixelSize.value,null!==(n=i.value)&&void 0!==n?n:1),o.updateMatrix(),e.requestRender()}))),(()=>Yx((()=>{const t=n.value;if(null!=t)return o.add(t),e.requestRender(),()=>{o.remove(t),e.requestRender()}}))),(()=>Yx((()=>{o.visible=null!=n.value&&r.value,e.requestRender()})))),o}(e.root,A,b,c,p,o),w=FZ();MZ(s,w,e.root.pixelSize,o);const G=NZ(w,h,e.root.pixelSize);KZ(g,w,A,h,p,e.clippingRect,f,e.root.panelGroupManager,o);const E=BZ(f,e.root,e.clippingRect,A.size,o),x=kZ(w,e.anyAncestorScrollable,A,r,0,n,e.root,o);return TR(t,n,A.size,o),VR(t,n,I,o),Object.assign(A,{scrollPosition:w,isClipped:I,mergedProperties:g,anyAncestorScrollable:WZ(A.scrollable,e.anyAncestorScrollable),clippingRect:$S(h,A,e.root.pixelSize,e.clippingRect),childrenMatrix:G,node:u,orderInfo:f,root:e.root,initializers:o,centerGroup:v,handlers:FR(t,n,i,a,l,x),interactionPanel:E})}const oF=new rF,aF=new Dr,lF=new Sr,cF=new Map;async function gF(e,t,n,i,r,s){if(null==e)return;const o=new Vc;o.matrixAutoUpdate=!1;let a=cF.get(e);null==a&&cF.set(e,a=await oF.loadAsync(e)),aF.makeEmpty();for(const c of a.paths){const e=rF.createShapes(c),s=new Js;s.transparent=!0,s.depthWrite=!1,s.toneMapped=!1,s.clippingPlanes=n;for(const n of e){const e=new KA(n);e.computeBoundingBox(),aF.union(e.boundingBox);const a=new Qo(e,s);a.matrixAutoUpdate=!1,a.raycast=bZ(a,a.raycast,t.object,i,r),AS(a,t,r),a.userData.color=c.color,a.scale.y=-1,a.updateMatrix(),o.add(a)}}aF.getSize(lF),s.value=lF.x/lF.y;const l=1/lF.y;return o.scale.set(1,1,1).multiplyScalar(l),aF.getCenter(lF),lF.y*=-1,o.position.copy(lF).negate().multiplyScalar(l),o.updateMatrix(),o}function uF(e,t,n,i,r,s,o,a){const l=[],c=Mx([]),g=Mx([]);NF(c,l);const u=MR(r,s,o,{...aD,...eD(e.root.size),...MF(c),...wR(g)},DR,(e=>{e.add("aspectRatio",n/i),e.add("width",n),e.add("height",i)})),A=fR();RR(void 0,A,e,u,a,!0,l);const d=BS(u,A,e.root.pixelSize);GS(e.root,a,d,l);const h=ER(e.childrenMatrix,d),I=qS(e.clippingRect,h,A.size,e.root.pixelSize),p=xR(A,I,u),C=wZ(u),m=uS(u,gS.Panel,C,e.orderInfo);l.push((t=>LR(u,m,C,e.root.panelGroupManager,h,A.size,void 0,A.borderInset,e.clippingRect,p,qR(),t)));const f=uS(void 0,gS.Svg,void 0,m),y=nR(e.root,e.clippingRect),b=function(e,t,n,i,r,s,o,a,l,c){const g=new Vc;g.matrixAutoUpdate=!1;const u=AF.parse(t);for(const d of u.paths){const e=rF.createShapes(d),t=new Js;t.transparent=!0,t.depthWrite=!1,t.toneMapped=!1,t.clippingPlanes=l;for(const n of e){const e=new KA(n);e.computeBoundingBox();const i=new Qo(e,t);i.matrixAutoUpdate=!1,i.raycast=bZ(i,i.raycast,r.root.object,r.clippingRect,s),AS(i,r.root,s),i.userData.color=d.color,i.scale.y=-1,i.updateMatrix(),g.add(i)}}const A=n/i;return c.push((()=>Yx((()=>{jx(g.position,g.scale,o.size,o.paddingInset,o.borderInset,r.root.pixelSize.value,A),g.position.x-=g.scale.x*A/2,g.position.y+=g.scale.x/2,g.scale.divideScalar(i),g.updateMatrix(),r.root.requestRender()}))),(()=>Yx((()=>{g.visible=a.value,r.root.requestRender()})))),kR(e,g,c,r.root),g}(u,t,n,i,e,f,A,p,y,l);return TR(r,s,A.size,l),VR(r,s,I,l),Object.assign(A,{isClipped:I,mergedProperties:u,initializers:l,iconGroup:b,handlers:FR(r,s,o,c,g),interactionPanel:BZ(f,e.root,e.clippingRect,A.size,l)})}const AF=new rF;const dF=["caretBorderRightWidth","caretBorderTopWidth","caretBorderLeftWidth","caretBorderBottomWidth"];let hF;function IF(e,t,n,i,r,s,o,a){const l=uS(void 0,gS.Panel,GZ,r),c=Mx(void 0);a.push((()=>Yx((()=>{const e=n.value;null==e&&(c.value=void 0),c.value=e;const t=setInterval((()=>c.value=null==c.peek()?e:void 0),500);return()=>clearInterval(t)}))));const g=eS(e,dF),u=tS(e,"caretWidth",1.5);a.push((n=>LR(e,l,void 0,o,t,Lx((()=>{const e=c.value;return null==e?[0,0]:[u.value,e[2]]})),Lx((()=>{const e=c.value;return null==e?[0,0]:[e[0]-u.value/2,e[1]]})),g,s,i,function(){var e;return null!==(e=hF)&&void 0!==e||(hF=$R({backgroundColor:"caretColor",backgroundOpacity:"caretOpacity",borderBend:"caretBorderBend",borderBottomLeftRadius:"caretBorderBottomLeftRadius",borderBottomRightRadius:"caretBorderBottomRightRadius",borderColor:"caretBorderColor",borderOpacity:"caretBorderOpacity",borderTopLeftRadius:"caretBorderTopLeftRadius",borderTopRightRadius:"caretBorderTopRightRadius"},{backgroundColor:0,backgroundOpacity:1})),hF}(),n)))}const pF=["selectionBorderRightWidth","selectionBorderTopWidth","selectionBorderLeftWidth","selectionBorderBottomWidth"];let CF;function mF(){var e;return null!==(e=CF)&&void 0!==e||(CF=$R({backgroundColor:"selectionColor",backgroundOpacity:"selectionOpacity",borderBend:"selectionBorderBend",borderBottomLeftRadius:"selectionBorderBottomLeftRadius",borderBottomRightRadius:"selectionBorderBottomRightRadius",borderColor:"selectionBorderColor",borderOpacity:"selectionBorderOpacity",borderTopLeftRadius:"selectionBorderTopLeftRadius",borderTopRightRadius:"selectionBorderTopRightRadius"},{backgroundColor:11851775,backgroundOpacity:1})),CF}function fF(e){return{focus:$x((()=>e.value))}}const yF=new Set;function bF(e,t,n,i,r,s){var o,a,l,c,g,u,A,d,h;const I=Mx([]),p=Mx([]),C=Mx(!1),m=[];NF(I,m);const f=MR(n,i,r,{...aD,...eD(e.root.size),...MF(I),...wR(p),...fF(C)},void 0,(e=>{iS(n.value,i.value,r.value,(t=>{e.add("caretOpacity",t.opacity),e.add("caretColor",t.color)}))})),y=fR(),b=Mx(void 0);RR(b,y,e,f,s,!1,m);const B=BS(f,y,e.root.pixelSize);GS(e.root,s,B,m);const v=ER(e.childrenMatrix,B),w=qS(e.clippingRect,v,y.size,e.root.pixelSize),G=xR(y,w,f),E=wZ(f),x=uS(f,gS.Panel,E,e.orderInfo);m.push((t=>LR(f,x,E,e.root.panelGroupManager,v,y.size,void 0,y.borderInset,e.clippingRect,G,qR(),t)));const S={},R=Mx([]),Z=Mx(void 0),D=Mx(void 0);IF(f,v,Z,G,x,e.clippingRect,e.root.panelGroupManager,m);const F=function(e,t,n,i,r,s,o,a){const l=[],c=uS(void 0,gS.Panel,GZ,r),g=eS(e,pF);return a.push((()=>Yx((()=>{const r=n.value,a=r.length;for(let n=0;n<a;n++){let a=l[n];if(null==a){const r=Mx([0,0]),u=Mx([0,0]),A=[];LR(e,c,void 0,o,t,r,u,g,s,i,mF(),A),l[n]=a={panelSubscriptions:A,offset:u,size:r}}const u=r[n];a.size.value=u.size,a.offset.value=u.position}const u=l.length;for(let e=a;e<u;e++)Px(l[e].panelSubscriptions);l.length=a}))),(()=>()=>{const e=l.length;for(let t=0;t<e;t++)Px(l[t].panelSubscriptions)})),c}(f,v,R,G,x,e.clippingRect,e.root.panelGroupManager,m),N=VD(f,t,e.root.renderer,m),M=uS(void 0,gS.Text,PD(N),F),W=null!==(o=null===(a=n.peek())||void 0===a?void 0:a.defaultValue)&&void 0!==o?o:null===(l=i.peek())||void 0===l?void 0:l.defaultValue,k=null==(null===(c=n.peek())||void 0===c?void 0:c.value)&&null==(null===(g=i.peek())||void 0===g?void 0:g.value)?Mx(null!==W&&void 0!==W?W:""):void 0,T=Lx((()=>{var e,t,r,s,o;return null!==(e=null!==(t=null!==(r=null===k||void 0===k?void 0:k.value)&&void 0!==r?r:qx(null===(s=n.value)||void 0===s?void 0:s.value))&&void 0!==t?t:qx(null===(o=i.value)||void 0===o?void 0:o.value))&&void 0!==e?e:""})),V=nS(n,i,"type","text"),L=Lx((()=>{var e;return"text"===V.value?T.value:"*".repeat(null!==(e=T.value.length)&&void 0!==e?e:0)})),H=null!==(u=null!==(A=null===(d=n.peek())||void 0===d?void 0:d.multiline)&&void 0!==A?A:null===(h=i.peek())||void 0===h?void 0:h.multiline)&&void 0!==u&&u,Q=JD(f,L,v,b,y,G,e.clippingRect,M,N,e.root.gylphGroupManager,D,R,Z,S,m,H?"break-word":"keep-all");m.push((()=>Yx((()=>{var e;return null===(e=b.value)||void 0===e?void 0:e.setCustomLayouting(Q.value)})))),TR(n,i,y.size,m),VR(n,i,w,m);const K=nS(n,i,"disabled",!1),X=function(e,t,n,i,r,s,o,a){const l=Mx(void 0);return a.push((a=>{const c=document.createElement(i?"textarea":"input"),g=c.style;g.setProperty("position","absolute"),g.setProperty("left","-1000vw"),g.setProperty("top","0"),g.setProperty("pointerEvents","none"),g.setProperty("opacity","0"),c.addEventListener("input",(()=>{null===n||void 0===n||n(c.value),u()}));const u=()=>{const{selectionStart:e,selectionEnd:n}=c;if(null==e||null==n)return void(t.value=void 0);const i=t.peek();null!=i&&i[0]===e&&i[1]===n||(t.value=[e,n])};return c.addEventListener("keydown",u),c.addEventListener("keyup",u),c.addEventListener("blur",(()=>t.value=void 0)),document.body.appendChild(c),l.value=c,a.push((()=>{l.value=void 0,c.remove()}),Yx((()=>c.value=e.value)),Yx((()=>c.disabled=s.value)),Yx((()=>c.tabIndex=o.value)),Yx((()=>c.setAttribute("type",r.value)))),a})),l}(T,D,(e=>{var t,r,s,o;null!=k&&(k.value=e),null===(t=n.peek())||void 0===t||null===(r=t.onValueChange)||void 0===r||r.call(t,e),null===(s=i.peek())||void 0===s||null===(o=s.onValueChange)||void 0===o||o.call(s,e)}),H,V,K,nS(n,i,"tabIndex",0),m),Y=(e,t,n)=>{var i,r;const s=X.peek();null!=s&&(C.peek()||s.focus(),null!=e&&null!=t&&s.setSelectionRange(e,t,n),D.value=[null!==(i=s.selectionStart)&&void 0!==i?i:0,null!==(r=s.selectionEnd)&&void 0!==r?r:0])};!function(e,t,n,i){n.push((()=>Yx((()=>{const n=e.value;if(null==n)return;t.value=document.activeElement===n;const r=()=>{const e=document.activeElement===n;e!=t.value&&(t.value=e,i(e))};return n.addEventListener("focus",r),n.addEventListener("blur",r),()=>{n.removeEventListener("focus",r),n.removeEventListener("blur",r)}}))))}(X,C,m,(e=>{var t,r,s,o;null===(t=i.peek())||void 0===t||null===(r=t.onFocusChange)||void 0===r||r.call(t,e),null===(s=n.peek())||void 0===s||null===(o=s.onFocusChange)||void 0===o||o.call(s,e)}));const z=function(e,t,n,i){return Lx((()=>{if(i.value)return;let r;return{onPointerDown:i=>{var s,o;if(i.defaultPrevented||null==i.uv||null==t.current)return;o=i.nativeEvent,yF.add(o),null===(s=i.stopPropagation)||void 0===s||s.call(i);const a=BF(e,i.uv,t.current);r=a,setTimeout((()=>n(a,a)))},onPointerUp:e=>{r=void 0},onPointerLeave:e=>{r=void 0},onPointerMove:i=>{var s;if(null==r||null==i.uv||null==t.current)return;null===(s=i.stopPropagation)||void 0===s||s.call(i);const o=BF(e,i.uv,t.current),a=Math.min(r,o),l=Math.max(r,o),c=r<o?"forward":"backward";setTimeout((()=>n(a,l,c)))}}}))}(y,S,Y,K);return Object.assign(y,{isClipped:w,mergedProperties:f,valueSignal:T,focus:()=>Y(),root:e.root,element:X,node:b,interactionPanel:BZ(x,e.root,e.clippingRect,y.size,m),handlers:FR(n,i,r,I,p,z,"text"),initializers:m})}function BF(e,t,n){let{size:i,borderInset:r,paddingInset:s}=e;const o=i.peek(),a=r.peek(),l=s.peek();if(null==o||null==a||null==l)return 0;const[c,g]=o,[u,,,A]=a,[d,,,h]=l,I=t.x*c-A-h,p=-t.y*g+u+d;return n.getCharIndex(I,p)}function vF(e,t,n,i,r,s){const o=Mx([]),a=Mx([]),l=[];NF(o,l);const c=MR(t,n,i,{...aD,...eD(e.root.size),...MF(o),...wR(a)}),g=fR();RR(void 0,g,e,c,r,!0,l);const u=BS(c,g,e.root.pixelSize);GS(e.root,r,u,l);const A=ER(e.childrenMatrix,u),d=qS(e.clippingRect,A,g.size,e.root.pixelSize),h=xR(g,d,c),I=uS(c,gS.Custom,void 0,e.orderInfo),p=nR(e.root,e.clippingRect);return l.push((t=>{const n=s.current;if(null==n)return t;if(n.matrixAutoUpdate=!1,n.material instanceof Os){const i=n.material;i.clippingPlanes=p,i.needsUpdate=!0,i.shadowSide=oe,t.push((()=>Yx((()=>{i.depthTest=e.root.depthTest.value,e.root.requestRender()}))))}return n.raycast=bZ(n,n.raycast,e.root.object,e.clippingRect,I),AS(n,e.root,I),t.push(Yx((()=>{n.renderOrder=e.root.renderOrder.value,e.root.requestRender()})),Yx((()=>{n.receiveShadow=c.value.read("receiveShadow",!1),e.root.requestRender()})),Yx((()=>{n.castShadow=c.value.read("castShadow",!1),e.root.requestRender()})),Yx((()=>{if(null==g.size.value)return;const[t,i]=g.size.value,r=e.root.pixelSize.value;n.scale.set(t*r,i*r,1),n.updateMatrix(),e.root.requestRender()})),Yx((()=>{n.visible=h.value,e.root.requestRender()}))),t})),TR(t,n,g.size,l),VR(t,n,d,l),Object.assign(g,{isClipped:d,mergedProperties:c,root:e.root,handlers:FR(t,n,i,o,a),initializers:l})}function wF(e,t,n,i,r,s){const o=Mx([]),a=Mx([]),l=[],c=fR();NF(o,l);const g=Mx(new Sr(1,1,1)),u=Lx((()=>g.value.x/g.value.y)),A=MR(t,n,i,{...aD,...eD(e.root.size),...MF(o),...wR(a)},DR,(e=>e.add("aspectRatio",u)));RR(void 0,c,e,A,r,!0,l);const d=BS(A,c,e.root.pixelSize);GS(e.root,r,d,l);const h=ER(e.childrenMatrix,d),I=qS(e.clippingRect,h,c.size,e.root.pixelSize),p=xR(c,I,A),C=wZ(A),m=uS(A,gS.Panel,C,e.orderInfo);l.push((t=>LR(A,m,C,e.root.panelGroupManager,h,c.size,void 0,c.borderInset,e.clippingRect,p,qR(),t)));const f=uS(void 0,gS.Object,void 0,m);return TR(t,n,c.size,l),VR(t,n,I,l),Object.assign(c,{isClipped:I,mergedProperties:A,remeasureContent:RF(A,e.root,c,e.clippingRect,p,f,g,s,l),interactionPanel:BZ(m,e.root,e.clippingRect,c.size,l),handlers:FR(t,n,i,o,a),initializers:l})}const GF=new Dr,EF=(new Sr).setScalar(.001),xF=new Sr,SF="back";function RF(e,t,n,i,r,s,o,a,l){const c=nR(t,i),g=tS(e,"depthAlign",SF),u=tS(e,"keepAspectRatio",!0),A=new Sr,d=new Sr,h=(e,n,i,r)=>{null!=e&&(e.visible=n,e.traverse((e=>{e instanceof Qo&&(e.renderOrder=i,e.material instanceof Os&&(e.material.depthTest=r))})),t.requestRender())},I=()=>{const e=a.current;if(null==e)return A.copy(EF),void d.set(0,0,0);e.traverse((e=>{e instanceof Qo&&(AS(e,t,s),e.material.clippingPlanes=c,e.material.needsUpdate=!0,e.raycast=bZ(e,e.raycast,t.object,i,s))}));const n=e.parent;e.parent=null,GF.setFromObject(e),GF.getSize(A).max(EF),o.value=A,null!=n&&(e.parent=n),GF.getCenter(d),t.requestRender()};return l.push((()=>Yx((()=>{h(a.current,r.value,t.renderOrder.value,t.depthTest.value),t.requestRender()}))),(e=>{const i=a.current;return null==i||(I(),e.push(Yx((()=>{const{size:{value:e},paddingInset:{value:r},borderInset:{value:s}}=n;if(null==e||null==r||null==s)return;const[o,a]=e,[l,c,h,I]=r,[p,C,m,f]=s,y=l+p,b=c+C,B=h+m,v=I+f,w=o-v-b,G=a-y-B,E=t.pixelSize.value;i.scale.set(w*E,G*E,u.value?G*E*A.z/A.y:A.z).divide(A),i.position.copy(d).negate(),i.position.z-=Jx[g.value]*A.z,i.position.multiply(i.scale),i.position.add(xF.set(.5*(v-b)*E,.5*(B-y)*E,0)),i.updateMatrix(),t.requestRender()})))),e})),()=>{h(a.current,r.peek(),t.renderOrder.peek(),t.depthTest.peek()),I()}}function ZF(e,t,n,i,r,s){if(r instanceof Jo){const o=2*Math.tan(Math.PI*r.fov/360)*i;n.value=o/s,t.value=o,e.value=o*r.aspect}if(r instanceof ba){const i=r.top-r.bottom,o=r.right-r.left;n.value=i/s,t.value=i,e.value=o}}function DF(e,t){let{src:n,autoplay:i,loop:r,muted:s,playbackRate:o,preservesPitch:a,volume:l}=t;if(!(n instanceof HTMLElement)){if(i&&(e.remove(),document.body.append(e),e.style.position="absolute",e.style.width="1px",e.style.zIndex="-1000",e.style.top="0px",e.style.left="0px"),e.playsInline=!0,e.volume=null!==l&&void 0!==l?l:1,e.preservesPitch=null===a||void 0===a||a,e.playbackRate=null!==o&&void 0!==o?o:1,e.muted=null!==s&&void 0!==s&&s,e.loop=null!==r&&void 0!==r&&r,e.autoplay=null!==i&&void 0!==i&&i,null==n)return e.removeAttribute("src"),void e.removeAttribute("srcObject");"string"===typeof n?e.src=n:e.srcObject=n}}function FF(e,t){let n;const i=()=>{t(),n=e.requestVideoFrameCallback(i)};return n=e.requestVideoFrameCallback(i),()=>e.cancelVideoFrameCallback(n)}function NF(e,t){t.push((()=>()=>TF(e)))}function MF(e){return{hover:$x((()=>e.value.length>0))}}const WF=[],kF=[];function TF(e){var t;const n=WF.indexOf(e);-1!=n&&(WF.splice(n,1),kF.splice(n,1),document.body.style.cursor=null!==(t=kF[kF.length-1])&&void 0!==t?t:"default")}var VF;n(403);var LF,HF=Object.create,QF=Object.defineProperty,KF=Object.getOwnPropertyDescriptor,XF=Object.getOwnPropertyNames,YF=Object.getPrototypeOf,zF=Object.prototype.hasOwnProperty,PF=(e,t)=>()=>(e&&(t=e(e=0)),t),UF=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),_F=(e,t)=>{for(var n in t)QF(e,n,{get:t[n],enumerable:!0})},OF=(e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of XF(t))!zF.call(e,r)&&r!==n&&QF(e,r,{get:()=>t[r],enumerable:!(i=KF(t,r))||i.enumerable});return e},JF=(e,t,n)=>(n=null!=e?HF(YF(e)):{},OF(!t&&e&&e.__esModule?n:QF(n,"default",{value:e,enumerable:!0}),e)),jF=e=>OF(QF({},"__esModule",{value:!0}),e),qF=PF((()=>{LF='*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:theme("borderColor.DEFAULT",currentColor)}:before,:after{--tw-content: ""}html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:theme("fontFamily.sans",ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji");font-feature-settings:theme("fontFamily.sans[1].fontFeatureSettings",normal);font-variation-settings:theme("fontFamily.sans[1].fontVariationSettings",normal)}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:theme("fontFamily.mono",ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace);font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;font-weight:inherit;line-height:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:theme("colors.gray.400",#9ca3af)}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}\n'})),$F={};_F($F,{default:()=>eN});var eN,tN=PF((()=>{qF(),eN={readFileSync:()=>LF}})),nN=UF(((e,t)=>{var n=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if("number"==typeof e.maxAge&&0===e.maxAge)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||1/0,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if("function"==typeof this.onEviction)for(let[t,n]of e)this.onEviction(t,n.value)}_deleteIfExpired(e,t){return"number"==typeof t.expiry&&t.expiry<=Date.now()&&("function"==typeof this.onEviction&&this.onEviction(e,t.value),this.delete(e))}_getOrDeleteIfExpired(e,t){if(!1===this._deleteIfExpired(e,t))return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){let n=t.get(e);return this._getItemValue(e,n)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(let e of this.oldCache){let[t,n]=e;this.cache.has(t)||!1===this._deleteIfExpired(t,n)&&(yield e)}for(let e of this.cache){let[t,n]=e;!1===this._deleteIfExpired(t,n)&&(yield e)}}get(e){if(this.cache.has(e)){let t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){let t=this.oldCache.get(e);if(!1===this._deleteIfExpired(e,t))return this._moveToRecent(e,t),t.value}}set(e,t){let{maxAge:n=(this.maxAge===1/0?void 0:Date.now()+this.maxAge)}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.cache.has(e)?this.cache.set(e,{value:t,maxAge:n}):this._set(e,{value:t,expiry:n})}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):!!this.oldCache.has(e)&&!this._deleteIfExpired(e,this.oldCache.get(e))}peek(e){return this.cache.has(e)?this._peek(e,this.cache):this.oldCache.has(e)?this._peek(e,this.oldCache):void 0}delete(e){let t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");let t=[...this._entriesAscending()],n=t.length-e;n<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(n>0&&this._emitEvictions(t.slice(0,n)),this.oldCache=new Map(t.slice(n)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(let[e]of this)yield e}*values(){for(let[,e]of this)yield e}*[Symbol.iterator](){for(let e of this.cache){let[t,n]=e;!1===this._deleteIfExpired(t,n)&&(yield[t,n.value])}for(let e of this.oldCache){let[t,n]=e;this.cache.has(t)||!1===this._deleteIfExpired(t,n)&&(yield[t,n.value])}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){let n=e[t],[i,r]=n;!1===this._deleteIfExpired(i,r)&&(yield[i,r.value])}e=[...this.oldCache];for(let t=e.length-1;t>=0;--t){let n=e[t],[i,r]=n;this.cache.has(i)||!1===this._deleteIfExpired(i,r)&&(yield[i,r.value])}}*entriesAscending(){for(let[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(let t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}};t.exports=n})),iN={};_F(iN,{default:()=>rN});var rN,sN=PF((()=>{rN={yellow:e=>e}})),oN=UF((()=>{})),aN=UF(((e,t)=>{var n=(sN(),jF(iN)),i=oN(),r=class extends Error{constructor(e,t,n,i,s,o){super(e),this.name="CssSyntaxError",this.reason=e,s&&(this.file=s),i&&(this.source=i),o&&(this.plugin=o),typeof t<"u"&&typeof n<"u"&&("number"==typeof t?(this.line=t,this.column=n):(this.line=t.line,this.column=t.column,this.endLine=n.line,this.endColumn=n.column)),this.setMessage(),Error.captureStackTrace&&Error.captureStackTrace(this,r)}setMessage(){this.message=this.plugin?this.plugin+": ":"",this.message+=this.file?this.file:"<css input>",typeof this.line<"u"&&(this.message+=":"+this.line+":"+this.column),this.message+=": "+this.reason}showSourceCode(e){if(!this.source)return"";let t=this.source;null==e&&(e=n.isColorSupported),i&&e&&(t=i(t));let r,s,o=t.split(/\r?\n/),a=Math.max(this.line-3,0),l=Math.min(this.line+2,o.length),c=String(l).length;if(e){let{bold:e,gray:t,red:i}=n.createColors(!0);r=t=>e(i(t)),s=e=>t(e)}else r=s=e=>e;return o.slice(a,l).map(((e,t)=>{let n=a+1+t,i=" "+(" "+n).slice(-c)+" | ";if(n===this.line){let t=s(i.replace(/\d/g," "))+e.slice(0,this.column-1).replace(/[^\t]/g," ");return r(">")+s(i)+e+"\n "+t+r("^")}return" "+s(i)+e})).join("\n")}toString(){let e=this.showSourceCode();return e&&(e="\n\n"+e+"\n"),this.name+": "+this.message+e}};t.exports=r,r.default=r})),lN=UF(((e,t)=>{t.exports.isClean=Symbol("isClean"),t.exports.my=Symbol("my")})),cN=UF(((e,t)=>{var n={after:"\n",beforeClose:"\n",beforeComment:"\n",beforeDecl:"\n",beforeOpen:" ",beforeRule:"\n",colon:": ",commentLeft:" ",commentRight:" ",emptyBody:"",indent:"    ",semicolon:!1};var i=class{constructor(e){this.builder=e}atrule(e,t){let n="@"+e.name,i=e.params?this.rawValue(e,"params"):"";if(typeof e.raws.afterName<"u"?n+=e.raws.afterName:i&&(n+=" "),e.nodes)this.block(e,n+i);else{let r=(e.raws.between||"")+(t?";":"");this.builder(n+i+r,e)}}beforeAfter(e,t){let n;n="decl"===e.type?this.raw(e,null,"beforeDecl"):"comment"===e.type?this.raw(e,null,"beforeComment"):"before"===t?this.raw(e,null,"beforeRule"):this.raw(e,null,"beforeClose");let i=e.parent,r=0;for(;i&&"root"!==i.type;)r+=1,i=i.parent;if(n.includes("\n")){let t=this.raw(e,null,"indent");if(t.length)for(let e=0;e<r;e++)n+=t}return n}block(e,t){let n,i=this.raw(e,"between","beforeOpen");this.builder(t+i+"{",e,"start"),e.nodes&&e.nodes.length?(this.body(e),n=this.raw(e,"after")):n=this.raw(e,"after","emptyBody"),n&&this.builder(n),this.builder("}",e,"end")}body(e){let t=e.nodes.length-1;for(;t>0&&"comment"===e.nodes[t].type;)t-=1;let n=this.raw(e,"semicolon");for(let i=0;i<e.nodes.length;i++){let r=e.nodes[i],s=this.raw(r,"before");s&&this.builder(s),this.stringify(r,t!==i||n)}}comment(e){let t=this.raw(e,"left","commentLeft"),n=this.raw(e,"right","commentRight");this.builder("/*"+t+e.text+n+"*/",e)}decl(e,t){let n=this.raw(e,"between","colon"),i=e.prop+n+this.rawValue(e,"value");e.important&&(i+=e.raws.important||" !important"),t&&(i+=";"),this.builder(i,e)}document(e){this.body(e)}raw(e,t,i){let r;if(i||(i=t),t&&(r=e.raws[t],typeof r<"u"))return r;let s=e.parent;if("before"===i&&(!s||"root"===s.type&&s.first===e||s&&"document"===s.type))return"";if(!s)return n[i];let o=e.root();if(o.rawCache||(o.rawCache={}),typeof o.rawCache[i]<"u")return o.rawCache[i];if("before"===i||"after"===i)return this.beforeAfter(e,i);{let n="raw"+function(e){return e[0].toUpperCase()+e.slice(1)}(i);this[n]?r=this[n](o,e):o.walk((e=>{if(r=e.raws[t],typeof r<"u")return!1}))}return typeof r>"u"&&(r=n[i]),o.rawCache[i]=r,r}rawBeforeClose(e){let t;return e.walk((e=>{if(e.nodes&&e.nodes.length>0&&typeof e.raws.after<"u")return t=e.raws.after,t.includes("\n")&&(t=t.replace(/[^\n]+$/,"")),!1})),t&&(t=t.replace(/\S/g,"")),t}rawBeforeComment(e,t){let n;return e.walkComments((e=>{if(typeof e.raws.before<"u")return n=e.raws.before,n.includes("\n")&&(n=n.replace(/[^\n]+$/,"")),!1})),typeof n>"u"?n=this.raw(t,null,"beforeDecl"):n&&(n=n.replace(/\S/g,"")),n}rawBeforeDecl(e,t){let n;return e.walkDecls((e=>{if(typeof e.raws.before<"u")return n=e.raws.before,n.includes("\n")&&(n=n.replace(/[^\n]+$/,"")),!1})),typeof n>"u"?n=this.raw(t,null,"beforeRule"):n&&(n=n.replace(/\S/g,"")),n}rawBeforeOpen(e){let t;return e.walk((e=>{if("decl"!==e.type&&(t=e.raws.between,typeof t<"u"))return!1})),t}rawBeforeRule(e){let t;return e.walk((n=>{if(n.nodes&&(n.parent!==e||e.first!==n)&&typeof n.raws.before<"u")return t=n.raws.before,t.includes("\n")&&(t=t.replace(/[^\n]+$/,"")),!1})),t&&(t=t.replace(/\S/g,"")),t}rawColon(e){let t;return e.walkDecls((e=>{if(typeof e.raws.between<"u")return t=e.raws.between.replace(/[^\s:]/g,""),!1})),t}rawEmptyBody(e){let t;return e.walk((e=>{if(e.nodes&&0===e.nodes.length&&(t=e.raws.after,typeof t<"u"))return!1})),t}rawIndent(e){if(e.raws.indent)return e.raws.indent;let t;return e.walk((n=>{let i=n.parent;if(i&&i!==e&&i.parent&&i.parent===e&&typeof n.raws.before<"u"){let e=n.raws.before.split("\n");return t=e[e.length-1],t=t.replace(/\S/g,""),!1}})),t}rawSemicolon(e){let t;return e.walk((e=>{if(e.nodes&&e.nodes.length&&"decl"===e.last.type&&(t=e.raws.semicolon,typeof t<"u"))return!1})),t}rawValue(e,t){let n=e[t],i=e.raws[t];return i&&i.value===n?i.raw:n}root(e){this.body(e),e.raws.after&&this.builder(e.raws.after)}rule(e){this.block(e,this.rawValue(e,"selector")),e.raws.ownSemicolon&&this.builder(e.raws.ownSemicolon,e,"end")}stringify(e,t){if(!this[e.type])throw new Error("Unknown AST node type "+e.type+". Maybe you need to change PostCSS stringifier.");this[e.type](e,t)}};t.exports=i,i.default=i})),gN=UF(((e,t)=>{var n=cN();function i(e,t){new n(t).stringify(e)}t.exports=i,i.default=i})),uN=UF(((e,t)=>{var{isClean:n,my:i}=lN(),r=aN(),s=cN(),o=gN();function a(e,t){let n=new e.constructor;for(let i in e){if(!Object.prototype.hasOwnProperty.call(e,i)||"proxyCache"===i)continue;let r=e[i],s=typeof r;"parent"===i&&"object"===s?t&&(n[i]=t):"source"===i?n[i]=r:Array.isArray(r)?n[i]=r.map((e=>a(e,n))):("object"===s&&null!==r&&(r=a(r)),n[i]=r)}return n}var l=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.raws={},this[n]=!1,this[i]=!0;for(let t in e)if("nodes"===t){this.nodes=[];for(let n of e[t])"function"==typeof n.clone?this.append(n.clone()):this.append(n)}else this[t]=e[t]}addToError(e){if(e.postcssNode=this,e.stack&&this.source&&/\n\s{4}at /.test(e.stack)){let t=this.source;e.stack=e.stack.replace(/\n\s{4}at /,"$&".concat(t.input.from,":").concat(t.start.line,":").concat(t.start.column,"$&"))}return e}after(e){return this.parent.insertAfter(this,e),this}assign(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(let t in e)this[t]=e[t];return this}before(e){return this.parent.insertBefore(this,e),this}cleanRaws(e){delete this.raws.before,delete this.raws.after,e||delete this.raws.between}clone(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=a(this);for(let n in e)t[n]=e[n];return t}cloneAfter(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.clone(e);return this.parent.insertAfter(this,t),t}cloneBefore(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.clone(e);return this.parent.insertBefore(this,t),t}error(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.source){let{end:n,start:i}=this.rangeBy(t);return this.source.input.error(e,{column:i.column,line:i.line},{column:n.column,line:n.line},t)}return new r(e)}getProxyProcessor(){return{get:(e,t)=>"proxyOf"===t?e:"root"===t?()=>e.root().toProxy():e[t],set:(e,t,n)=>(e[t]===n||(e[t]=n,("prop"===t||"value"===t||"name"===t||"params"===t||"important"===t||"text"===t)&&e.markDirty()),!0)}}markDirty(){if(this[n]){this[n]=!1;let e=this;for(;e=e.parent;)e[n]=!1}}next(){if(!this.parent)return;let e=this.parent.index(this);return this.parent.nodes[e+1]}positionBy(e,t){let n=this.source.start;if(e.index)n=this.positionInside(e.index,t);else if(e.word){let i=(t=this.toString()).indexOf(e.word);-1!==i&&(n=this.positionInside(i,t))}return n}positionInside(e,t){let n=t||this.toString(),i=this.source.start.column,r=this.source.start.line;for(let s=0;s<e;s++)"\n"===n[s]?(i=1,r+=1):i+=1;return{column:i,line:r}}prev(){if(!this.parent)return;let e=this.parent.index(this);return this.parent.nodes[e-1]}rangeBy(e){let t={column:this.source.start.column,line:this.source.start.line},n=this.source.end?{column:this.source.end.column+1,line:this.source.end.line}:{column:t.column+1,line:t.line};if(e.word){let i=this.toString(),r=i.indexOf(e.word);-1!==r&&(t=this.positionInside(r,i),n=this.positionInside(r+e.word.length,i))}else e.start?t={column:e.start.column,line:e.start.line}:e.index&&(t=this.positionInside(e.index)),e.end?n={column:e.end.column,line:e.end.line}:e.endIndex?n=this.positionInside(e.endIndex):e.index&&(n=this.positionInside(e.index+1));return(n.line<t.line||n.line===t.line&&n.column<=t.column)&&(n={column:t.column+1,line:t.line}),{end:n,start:t}}raw(e,t){return(new s).raw(this,e,t)}remove(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this}replaceWith(){if(this.parent){let i=this,r=!1;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let e of t)e===this?r=!0:r?(this.parent.insertAfter(i,e),i=e):this.parent.insertBefore(i,e);r||this.remove()}return this}root(){let e=this;for(;e.parent&&"document"!==e.parent.type;)e=e.parent;return e}toJSON(e,t){let n={},i=null==t;t=t||new Map;let r=0;for(let s in this){if(!Object.prototype.hasOwnProperty.call(this,s)||"parent"===s||"proxyCache"===s)continue;let e=this[s];if(Array.isArray(e))n[s]=e.map((e=>"object"==typeof e&&e.toJSON?e.toJSON(null,t):e));else if("object"==typeof e&&e.toJSON)n[s]=e.toJSON(null,t);else if("source"===s){let i=t.get(e.input);null==i&&(i=r,t.set(e.input,r),r++),n[s]={end:e.end,inputId:i,start:e.start}}else n[s]=e}return i&&(n.inputs=[...t.keys()].map((e=>e.toJSON()))),n}toProxy(){return this.proxyCache||(this.proxyCache=new Proxy(this,this.getProxyProcessor())),this.proxyCache}toString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;e.stringify&&(e=e.stringify);let t="";return e(this,(e=>{t+=e})),t}warn(e,t,n){let i={node:this};for(let r in n)i[r]=n[r];return e.warn(t,i)}get proxyOf(){return this}};t.exports=l,l.default=l})),AN=UF(((e,t)=>{var n=uN(),i=class extends n{constructor(e){e&&typeof e.value<"u"&&"string"!=typeof e.value&&(e={...e,value:String(e.value)}),super(e),this.type="decl"}get variable(){return this.prop.startsWith("--")||"$"===this.prop[0]}};t.exports=i,i.default=i})),dN=UF((()=>{})),hN={};_F(hN,{join:()=>IN});var IN,pN=PF((()=>{IN=()=>""})),CN={};_F(CN,{default:()=>mN});var mN,fN=PF((()=>{mN=null})),yN=UF(((e,t)=>{t.exports={nanoid:function(){let e="",t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;for(;t--;)e+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return e},customAlphabet:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:21;return function(){let n="",i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t;for(;i--;)n+=e[Math.random()*e.length|0];return n}}}})),bN=UF(((e,t)=>{var{SourceMapConsumer:n,SourceMapGenerator:i}=dN(),{existsSync:r,readFileSync:s}=(tN(),jF($F)),{dirname:o,join:a}=(pN(),jF(hN));var l=class{constructor(e,t){if(!1===t.map)return;this.loadAnnotation(e),this.inline=this.startWith(this.annotation,"data:");let n=t.map?t.map.prev:void 0,i=this.loadMap(t.from,n);!this.mapFile&&t.from&&(this.mapFile=t.from),this.mapFile&&(this.root=o(this.mapFile)),i&&(this.text=i)}consumer(){return this.consumerCache||(this.consumerCache=new n(this.text)),this.consumerCache}decodeInline(e){if(/^data:application\/json;charset=utf-?8,/.test(e)||/^data:application\/json,/.test(e))return decodeURIComponent(e.substr(RegExp.lastMatch.length));if(/^data:application\/json;charset=utf-?8;base64,/.test(e)||/^data:application\/json;base64,/.test(e))return function(e){return Buffer?Buffer.from(e,"base64").toString():window.atob(e)}(e.substr(RegExp.lastMatch.length));let t=e.match(/data:application\/json;([^,]+),/)[1];throw new Error("Unsupported source map encoding "+t)}getAnnotationURL(e){return e.replace(/^\/\*\s*# sourceMappingURL=/,"").trim()}isMap(e){return"object"==typeof e&&("string"==typeof e.mappings||"string"==typeof e._mappings||Array.isArray(e.sections))}loadAnnotation(e){let t=e.match(/\/\*\s*# sourceMappingURL=/gm);if(!t)return;let n=e.lastIndexOf(t.pop()),i=e.indexOf("*/",n);n>-1&&i>-1&&(this.annotation=this.getAnnotationURL(e.substring(n,i)))}loadFile(e){if(this.root=o(e),r(e))return this.mapFile=e,s(e,"utf-8").toString().trim()}loadMap(e,t){if(!1===t)return!1;if(t){if("string"==typeof t)return t;if("function"!=typeof t){if(t instanceof n)return i.fromSourceMap(t).toString();if(t instanceof i)return t.toString();if(this.isMap(t))return JSON.stringify(t);throw new Error("Unsupported previous source map format: "+t.toString())}{let n=t(e);if(n){let e=this.loadFile(n);if(!e)throw new Error("Unable to load previous source map: "+n.toString());return e}}}else{if(this.inline)return this.decodeInline(this.annotation);if(this.annotation){let t=this.annotation;return e&&(t=a(o(e),t)),this.loadFile(t)}}}startWith(e,t){return!!e&&e.substr(0,t.length)===t}withContent(){return!!(this.consumer().sourcesContent&&this.consumer().sourcesContent.length>0)}};t.exports=l,l.default=l})),BN=UF(((e,t)=>{var{SourceMapConsumer:n,SourceMapGenerator:i}=dN(),{fileURLToPath:r,pathToFileURL:s}=(fN(),jF(CN)),{isAbsolute:o,resolve:a}=(pN(),jF(hN)),{nanoid:l}=yN(),c=oN(),g=aN(),u=bN(),A=Symbol("fromOffsetCache"),d=Boolean(n&&i),h=Boolean(a&&o),I=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null===e||typeof e>"u"||"object"==typeof e&&!e.toString)throw new Error("PostCSS received ".concat(e," instead of CSS string"));if(this.css=e.toString(),"\ufeff"===this.css[0]||"\ufffe"===this.css[0]?(this.hasBOM=!0,this.css=this.css.slice(1)):this.hasBOM=!1,t.from&&(!h||/^\w+:\/\//.test(t.from)||o(t.from)?this.file=t.from:this.file=a(t.from)),h&&d){let e=new u(this.css,t);if(e.text){this.map=e;let t=e.consumer().file;!this.file&&t&&(this.file=this.mapResolve(t))}}this.file||(this.id="<input css "+l(6)+">"),this.map&&(this.map.file=this.from)}error(e,t,n){let i,r,o,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(t&&"object"==typeof t){let e=t,i=n;if("number"==typeof e.offset){let i=this.fromOffset(e.offset);t=i.line,n=i.col}else t=e.line,n=e.column;if("number"==typeof i.offset){let e=this.fromOffset(i.offset);r=e.line,o=e.col}else r=i.line,o=i.column}else if(!n){let e=this.fromOffset(t);t=e.line,n=e.col}let l=this.origin(t,n,r,o);return i=l?new g(e,void 0===l.endLine?l.line:{column:l.column,line:l.line},void 0===l.endLine?l.column:{column:l.endColumn,line:l.endLine},l.source,l.file,a.plugin):new g(e,void 0===r?t:{column:n,line:t},void 0===r?n:{column:o,line:r},this.css,this.file,a.plugin),i.input={column:n,endColumn:o,endLine:r,line:t,source:this.css},this.file&&(s&&(i.input.url=s(this.file).toString()),i.input.file=this.file),i}fromOffset(e){let t,n;if(this[A])n=this[A];else{let e=this.css.split("\n");n=new Array(e.length);let t=0;for(let i=0,r=e.length;i<r;i++)n[i]=t,t+=e[i].length+1;this[A]=n}t=n[n.length-1];let i=0;if(e>=t)i=n.length-1;else{let t,r=n.length-2;for(;i<r;)if(t=i+(r-i>>1),e<n[t])r=t-1;else{if(!(e>=n[t+1])){i=t;break}i=t+1}}return{col:e-n[i]+1,line:i+1}}mapResolve(e){return/^\w+:\/\//.test(e)?e:a(this.map.consumer().sourceRoot||this.map.root||".",e)}origin(e,t,n,i){if(!this.map)return!1;let a,l,c=this.map.consumer(),g=c.originalPositionFor({column:t,line:e});if(!g.source)return!1;"number"==typeof n&&(a=c.originalPositionFor({column:i,line:n})),l=o(g.source)?s(g.source):new URL(g.source,this.map.consumer().sourceRoot||s(this.map.mapFile));let u={column:g.column,endColumn:a&&a.column,endLine:a&&a.line,line:g.line,url:l.toString()};if("file:"===l.protocol){if(!r)throw new Error("file: protocol is not available in this PostCSS build");u.file=r(l)}let A=c.sourceContentFor(g.source);return A&&(u.source=A),u}toJSON(){let e={};for(let t of["hasBOM","css","file","id"])null!=this[t]&&(e[t]=this[t]);return this.map&&(e.map={...this.map},e.map.consumerCache&&(e.map.consumerCache=void 0)),e}get from(){return this.file||this.id}};t.exports=I,I.default=I,c&&c.registerInput&&c.registerInput(I)})),vN=UF(((e,t)=>{var{SourceMapConsumer:n,SourceMapGenerator:i}=dN(),{dirname:r,relative:s,resolve:o,sep:a}=(pN(),jF(hN)),{pathToFileURL:l}=(fN(),jF(CN)),c=BN(),g=Boolean(n&&i),u=Boolean(r&&o&&s&&a);t.exports=class{constructor(e,t,n,i){this.stringify=e,this.mapOpts=n.map||{},this.root=t,this.opts=n,this.css=i,this.usesFileUrls=!this.mapOpts.from&&this.mapOpts.absolute,this.memoizedFileURLs=new Map,this.memoizedPaths=new Map,this.memoizedURLs=new Map}addAnnotation(){let e;e=this.isInline()?"data:application/json;base64,"+this.toBase64(this.map.toString()):"string"==typeof this.mapOpts.annotation?this.mapOpts.annotation:"function"==typeof this.mapOpts.annotation?this.mapOpts.annotation(this.opts.to,this.root):this.outputFile()+".map";let t="\n";this.css.includes("\r\n")&&(t="\r\n"),this.css+=t+"/*# sourceMappingURL="+e+" */"}applyPrevMaps(){for(let e of this.previous()){let t,i=this.toUrl(this.path(e.file)),s=e.root||r(e.file);!1===this.mapOpts.sourcesContent?(t=new n(e.text),t.sourcesContent&&(t.sourcesContent=t.sourcesContent.map((()=>null)))):t=e.consumer(),this.map.applySourceMap(t,i,this.toUrl(this.path(s)))}}clearAnnotation(){if(!1!==this.mapOpts.annotation)if(this.root){let e;for(let t=this.root.nodes.length-1;t>=0;t--)e=this.root.nodes[t],"comment"===e.type&&0===e.text.indexOf("# sourceMappingURL=")&&this.root.removeChild(t)}else this.css&&(this.css=this.css.replace(/(\n)?\/\*#[\S\s]*?\*\/$/gm,""))}generate(){if(this.clearAnnotation(),u&&g&&this.isMap())return this.generateMap();{let e="";return this.stringify(this.root,(t=>{e+=t})),[e]}}generateMap(){if(this.root)this.generateString();else if(1===this.previous().length){let e=this.previous()[0].consumer();e.file=this.outputFile(),this.map=i.fromSourceMap(e)}else this.map=new i({file:this.outputFile()}),this.map.addMapping({generated:{column:0,line:1},original:{column:0,line:1},source:this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>"});return this.isSourcesContent()&&this.setSourcesContent(),this.root&&this.previous().length>0&&this.applyPrevMaps(),this.isAnnotation()&&this.addAnnotation(),this.isInline()?[this.css]:[this.css,this.map]}generateString(){this.css="",this.map=new i({file:this.outputFile()});let e,t,n=1,r=1,s="<no source>",o={generated:{column:0,line:0},original:{column:0,line:0},source:""};this.stringify(this.root,((i,a,l)=>{if(this.css+=i,a&&"end"!==l&&(o.generated.line=n,o.generated.column=r-1,a.source&&a.source.start?(o.source=this.sourcePath(a),o.original.line=a.source.start.line,o.original.column=a.source.start.column-1,this.map.addMapping(o)):(o.source=s,o.original.line=1,o.original.column=0,this.map.addMapping(o))),e=i.match(/\n/g),e?(n+=e.length,t=i.lastIndexOf("\n"),r=i.length-t):r+=i.length,a&&"start"!==l){let e=a.parent||{raws:{}};("decl"!==a.type&&("atrule"!==a.type||a.nodes)||a!==e.last||e.raws.semicolon)&&(a.source&&a.source.end?(o.source=this.sourcePath(a),o.original.line=a.source.end.line,o.original.column=a.source.end.column-1,o.generated.line=n,o.generated.column=r-2,this.map.addMapping(o)):(o.source=s,o.original.line=1,o.original.column=0,o.generated.line=n,o.generated.column=r-1,this.map.addMapping(o)))}}))}isAnnotation(){return!!this.isInline()||(typeof this.mapOpts.annotation<"u"?this.mapOpts.annotation:!this.previous().length||this.previous().some((e=>e.annotation)))}isInline(){if(typeof this.mapOpts.inline<"u")return this.mapOpts.inline;let e=this.mapOpts.annotation;return!(typeof e<"u"&&!0!==e)&&(!this.previous().length||this.previous().some((e=>e.inline)))}isMap(){return typeof this.opts.map<"u"?!!this.opts.map:this.previous().length>0}isSourcesContent(){return typeof this.mapOpts.sourcesContent<"u"?this.mapOpts.sourcesContent:!this.previous().length||this.previous().some((e=>e.withContent()))}outputFile(){return this.opts.to?this.path(this.opts.to):this.opts.from?this.path(this.opts.from):"to.css"}path(e){if(this.mapOpts.absolute||60===e.charCodeAt(0)||/^\w+:\/\//.test(e))return e;let t=this.memoizedPaths.get(e);if(t)return t;let n=this.opts.to?r(this.opts.to):".";"string"==typeof this.mapOpts.annotation&&(n=r(o(n,this.mapOpts.annotation)));let i=s(n,e);return this.memoizedPaths.set(e,i),i}previous(){if(!this.previousMaps)if(this.previousMaps=[],this.root)this.root.walk((e=>{if(e.source&&e.source.input.map){let t=e.source.input.map;this.previousMaps.includes(t)||this.previousMaps.push(t)}}));else{let e=new c(this.css,this.opts);e.map&&this.previousMaps.push(e.map)}return this.previousMaps}setSourcesContent(){let e={};if(this.root)this.root.walk((t=>{if(t.source){let n=t.source.input.from;if(n&&!e[n]){e[n]=!0;let i=this.usesFileUrls?this.toFileUrl(n):this.toUrl(this.path(n));this.map.setSourceContent(i,t.source.input.css)}}}));else if(this.css){let e=this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>";this.map.setSourceContent(e,this.css)}}sourcePath(e){return this.mapOpts.from?this.toUrl(this.mapOpts.from):this.usesFileUrls?this.toFileUrl(e.source.input.from):this.toUrl(this.path(e.source.input.from))}toBase64(e){return Buffer?Buffer.from(e).toString("base64"):window.btoa(unescape(encodeURIComponent(e)))}toFileUrl(e){let t=this.memoizedFileURLs.get(e);if(t)return t;if(l){let t=l(e).toString();return this.memoizedFileURLs.set(e,t),t}throw new Error("`map.absolute` option is not available in this PostCSS build")}toUrl(e){let t=this.memoizedURLs.get(e);if(t)return t;"\\"===a&&(e=e.replace(/\\/g,"/"));let n=encodeURI(e).replace(/[#?]/g,encodeURIComponent);return this.memoizedURLs.set(e,n),n}}})),wN=UF(((e,t)=>{var n=uN(),i=class extends n{constructor(e){super(e),this.type="comment"}};t.exports=i,i.default=i})),GN=UF(((e,t)=>{var n,i,r,s,{isClean:o,my:a}=lN(),l=AN(),c=wN(),g=uN();function u(e){return e.map((e=>(e.nodes&&(e.nodes=u(e.nodes)),delete e.source,e)))}function A(e){if(e[o]=!1,e.proxyOf.nodes)for(let t of e.proxyOf.nodes)A(t)}var d=class extends g{append(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let i of t){let e=this.normalize(i,this.last);for(let t of e)this.proxyOf.nodes.push(t)}return this.markDirty(),this}cleanRaws(e){if(super.cleanRaws(e),this.nodes)for(let t of this.nodes)t.cleanRaws(e)}each(e){if(!this.proxyOf.nodes)return;let t,n,i=this.getIterator();for(;this.indexes[i]<this.proxyOf.nodes.length&&(t=this.indexes[i],n=e(this.proxyOf.nodes[t],t),!1!==n);)this.indexes[i]+=1;return delete this.indexes[i],n}every(e){return this.nodes.every(e)}getIterator(){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach+=1;let e=this.lastEach;return this.indexes[e]=0,e}getProxyProcessor(){return{get:(e,t)=>"proxyOf"===t?e:e[t]?"each"===t||"string"==typeof t&&t.startsWith("walk")?function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e[t](...i.map((e=>"function"==typeof e?(t,n)=>e(t.toProxy(),n):e)))}:"every"===t||"some"===t?n=>e[t]((function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return n(e.toProxy(),...i)})):"root"===t?()=>e.root().toProxy():"nodes"===t?e.nodes.map((e=>e.toProxy())):"first"===t||"last"===t?e[t].toProxy():e[t]:e[t],set:(e,t,n)=>(e[t]===n||(e[t]=n,("name"===t||"params"===t||"selector"===t)&&e.markDirty()),!0)}}index(e){return"number"==typeof e?e:(e.proxyOf&&(e=e.proxyOf),this.proxyOf.nodes.indexOf(e))}insertAfter(e,t){let n,i=this.index(e),r=this.normalize(t,this.proxyOf.nodes[i]).reverse();i=this.index(e);for(let s of r)this.proxyOf.nodes.splice(i+1,0,s);for(let s in this.indexes)n=this.indexes[s],i<n&&(this.indexes[s]=n+r.length);return this.markDirty(),this}insertBefore(e,t){let n,i=this.index(e),r=0===i&&"prepend",s=this.normalize(t,this.proxyOf.nodes[i],r).reverse();i=this.index(e);for(let o of s)this.proxyOf.nodes.splice(i,0,o);for(let o in this.indexes)n=this.indexes[o],i<=n&&(this.indexes[o]=n+s.length);return this.markDirty(),this}normalize(e,t){if("string"==typeof e)e=u(n(e).nodes);else if(Array.isArray(e)){e=e.slice(0);for(let t of e)t.parent&&t.parent.removeChild(t,"ignore")}else if("root"===e.type&&"document"!==this.type){e=e.nodes.slice(0);for(let t of e)t.parent&&t.parent.removeChild(t,"ignore")}else if(e.type)e=[e];else if(e.prop){if(typeof e.value>"u")throw new Error("Value field is missed in node creation");"string"!=typeof e.value&&(e.value=String(e.value)),e=[new l(e)]}else if(e.selector)e=[new i(e)];else if(e.name)e=[new r(e)];else{if(!e.text)throw new Error("Unknown node type in node creation");e=[new c(e)]}return e.map((e=>(e[a]||d.rebuild(e),(e=e.proxyOf).parent&&e.parent.removeChild(e),e[o]&&A(e),typeof e.raws.before>"u"&&t&&typeof t.raws.before<"u"&&(e.raws.before=t.raws.before.replace(/\S/g,"")),e.parent=this.proxyOf,e)))}prepend(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t=t.reverse();for(let i of t){let e=this.normalize(i,this.first,"prepend").reverse();for(let t of e)this.proxyOf.nodes.unshift(t);for(let t in this.indexes)this.indexes[t]=this.indexes[t]+e.length}return this.markDirty(),this}push(e){return e.parent=this,this.proxyOf.nodes.push(e),this}removeAll(){for(let e of this.proxyOf.nodes)e.parent=void 0;return this.proxyOf.nodes=[],this.markDirty(),this}removeChild(e){let t;e=this.index(e),this.proxyOf.nodes[e].parent=void 0,this.proxyOf.nodes.splice(e,1);for(let n in this.indexes)t=this.indexes[n],t>=e&&(this.indexes[n]=t-1);return this.markDirty(),this}replaceValues(e,t,n){return n||(n=t,t={}),this.walkDecls((i=>{t.props&&!t.props.includes(i.prop)||t.fast&&!i.value.includes(t.fast)||(i.value=i.value.replace(e,n))})),this.markDirty(),this}some(e){return this.nodes.some(e)}walk(e){return this.each(((t,n)=>{let i;try{i=e(t,n)}catch(fw){throw t.addToError(fw)}return!1!==i&&t.walk&&(i=t.walk(e)),i}))}walkAtRules(e,t){return t?e instanceof RegExp?this.walk(((n,i)=>{if("atrule"===n.type&&e.test(n.name))return t(n,i)})):this.walk(((n,i)=>{if("atrule"===n.type&&n.name===e)return t(n,i)})):(t=e,this.walk(((e,n)=>{if("atrule"===e.type)return t(e,n)})))}walkComments(e){return this.walk(((t,n)=>{if("comment"===t.type)return e(t,n)}))}walkDecls(e,t){return t?e instanceof RegExp?this.walk(((n,i)=>{if("decl"===n.type&&e.test(n.prop))return t(n,i)})):this.walk(((n,i)=>{if("decl"===n.type&&n.prop===e)return t(n,i)})):(t=e,this.walk(((e,n)=>{if("decl"===e.type)return t(e,n)})))}walkRules(e,t){return t?e instanceof RegExp?this.walk(((n,i)=>{if("rule"===n.type&&e.test(n.selector))return t(n,i)})):this.walk(((n,i)=>{if("rule"===n.type&&n.selector===e)return t(n,i)})):(t=e,this.walk(((e,n)=>{if("rule"===e.type)return t(e,n)})))}get first(){if(this.proxyOf.nodes)return this.proxyOf.nodes[0]}get last(){if(this.proxyOf.nodes)return this.proxyOf.nodes[this.proxyOf.nodes.length-1]}};d.registerParse=e=>{n=e},d.registerRule=e=>{i=e},d.registerAtRule=e=>{r=e},d.registerRoot=e=>{s=e},t.exports=d,d.default=d,d.rebuild=e=>{"atrule"===e.type?Object.setPrototypeOf(e,r.prototype):"rule"===e.type?Object.setPrototypeOf(e,i.prototype):"decl"===e.type?Object.setPrototypeOf(e,l.prototype):"comment"===e.type?Object.setPrototypeOf(e,c.prototype):"root"===e.type&&Object.setPrototypeOf(e,s.prototype),e[a]=!0,e.nodes&&e.nodes.forEach((e=>{d.rebuild(e)}))}})),EN=UF(((e,t)=>{var n,i,r=GN(),s=class extends r{constructor(e){super({type:"document",...e}),this.nodes||(this.nodes=[])}toResult(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n(new i,this,e).stringify()}};s.registerLazyResult=e=>{n=e},s.registerProcessor=e=>{i=e},t.exports=s,s.default=s})),xN=UF(((e,t)=>{var n={};t.exports=function(e){n[e]||(n[e]=!0,typeof console<"u"&&console.warn&&console.warn(e))}})),SN=UF(((e,t)=>{var n=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.type="warning",this.text=e,t.node&&t.node.source){let e=t.node.rangeBy(t);this.line=e.start.line,this.column=e.start.column,this.endLine=e.end.line,this.endColumn=e.end.column}for(let n in t)this[n]=t[n]}toString(){return this.node?this.node.error(this.text,{index:this.index,plugin:this.plugin,word:this.word}).message:this.plugin?this.plugin+": "+this.text:this.text}};t.exports=n,n.default=n})),RN=UF(((e,t)=>{var n=SN(),i=class{constructor(e,t,n){this.processor=e,this.messages=[],this.root=t,this.opts=n,this.css=void 0,this.map=void 0}toString(){return this.css}warn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.plugin||this.lastPlugin&&this.lastPlugin.postcssPlugin&&(t.plugin=this.lastPlugin.postcssPlugin);let i=new n(e,t);return this.messages.push(i),i}warnings(){return this.messages.filter((e=>"warning"===e.type))}get content(){return this.css}};t.exports=i,i.default=i})),ZN=UF(((e,t)=>{var n="'".charCodeAt(0),i='"'.charCodeAt(0),r="\\".charCodeAt(0),s="/".charCodeAt(0),o="\n".charCodeAt(0),a=" ".charCodeAt(0),l="\f".charCodeAt(0),c="\t".charCodeAt(0),g="\r".charCodeAt(0),u="[".charCodeAt(0),A="]".charCodeAt(0),d="(".charCodeAt(0),h=")".charCodeAt(0),I="{".charCodeAt(0),p="}".charCodeAt(0),C=";".charCodeAt(0),m="*".charCodeAt(0),f=":".charCodeAt(0),y="@".charCodeAt(0),b=/[\t\n\f\r "#'()/;[\\\]{}]/g,B=/[\t\n\f\r !"#'():;@[\\\]{}]|\/(?=\*)/g,v=/.[\r\n"'(/\\]/,w=/[\da-f]/i;t.exports=function(e){let t,G,E,x,S,R,Z,D,F,N,M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},W=e.css.valueOf(),k=M.ignoreErrors,T=W.length,V=0,L=[],H=[];function Q(t){throw e.error("Unclosed "+t,V)}return{back:function(e){H.push(e)},endOfFile:function(){return 0===H.length&&V>=T},nextToken:function(e){if(H.length)return H.pop();if(V>=T)return;let M=!!e&&e.ignoreUnclosed;switch(t=W.charCodeAt(V),t){case o:case a:case c:case g:case l:G=V;do{G+=1,t=W.charCodeAt(G)}while(t===a||t===o||t===c||t===g||t===l);N=["space",W.slice(V,G)],V=G-1;break;case u:case A:case I:case p:case f:case C:case h:{let e=String.fromCharCode(t);N=[e,e,V];break}case d:if(D=L.length?L.pop()[1]:"",F=W.charCodeAt(V+1),"url"===D&&F!==n&&F!==i&&F!==a&&F!==o&&F!==c&&F!==l&&F!==g){G=V;do{if(R=!1,G=W.indexOf(")",G+1),-1===G){if(k||M){G=V;break}Q("bracket")}for(Z=G;W.charCodeAt(Z-1)===r;)Z-=1,R=!R}while(R);N=["brackets",W.slice(V,G+1),V,G],V=G}else G=W.indexOf(")",V+1),x=W.slice(V,G+1),-1===G||v.test(x)?N=["(","(",V]:(N=["brackets",x,V,G],V=G);break;case n:case i:E=t===n?"'":'"',G=V;do{if(R=!1,G=W.indexOf(E,G+1),-1===G){if(k||M){G=V+1;break}Q("string")}for(Z=G;W.charCodeAt(Z-1)===r;)Z-=1,R=!R}while(R);N=["string",W.slice(V,G+1),V,G],V=G;break;case y:b.lastIndex=V+1,b.test(W),G=0===b.lastIndex?W.length-1:b.lastIndex-2,N=["at-word",W.slice(V,G+1),V,G],V=G;break;case r:for(G=V,S=!0;W.charCodeAt(G+1)===r;)G+=1,S=!S;if(t=W.charCodeAt(G+1),S&&t!==s&&t!==a&&t!==o&&t!==c&&t!==g&&t!==l&&(G+=1,w.test(W.charAt(G)))){for(;w.test(W.charAt(G+1));)G+=1;W.charCodeAt(G+1)===a&&(G+=1)}N=["word",W.slice(V,G+1),V,G],V=G;break;default:t===s&&W.charCodeAt(V+1)===m?(G=W.indexOf("*/",V+2)+1,0===G&&(k||M?G=W.length:Q("comment")),N=["comment",W.slice(V,G+1),V,G],V=G):(B.lastIndex=V+1,B.test(W),G=0===B.lastIndex?W.length-1:B.lastIndex-2,N=["word",W.slice(V,G+1),V,G],L.push(N),V=G)}return V++,N},position:function(){return V}}}})),DN=UF(((e,t)=>{var n=GN(),i=class extends n{constructor(e){super(e),this.type="atrule"}append(){return this.proxyOf.nodes||(this.nodes=[]),super.append(...arguments)}prepend(){return this.proxyOf.nodes||(this.nodes=[]),super.prepend(...arguments)}};t.exports=i,i.default=i,n.registerAtRule(i)})),FN=UF(((e,t)=>{var n,i,r=GN(),s=class extends r{constructor(e){super(e),this.type="root",this.nodes||(this.nodes=[])}normalize(e,t,n){let i=super.normalize(e);if(t)if("prepend"===n)this.nodes.length>1?t.raws.before=this.nodes[1].raws.before:delete t.raws.before;else if(this.first!==t)for(let r of i)r.raws.before=t.raws.before;return i}removeChild(e,t){let n=this.index(e);return!t&&0===n&&this.nodes.length>1&&(this.nodes[1].raws.before=this.nodes[n].raws.before),super.removeChild(e)}toResult(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n(new i,this,e).stringify()}};s.registerLazyResult=e=>{n=e},s.registerProcessor=e=>{i=e},t.exports=s,s.default=s,r.registerRoot(s)})),NN=UF(((e,t)=>{var n={comma:e=>n.split(e,[","],!0),space:e=>n.split(e,[" ","\n","\t"]),split(e,t,n){let i=[],r="",s=!1,o=0,a=!1,l="",c=!1;for(let g of e)c?c=!1:"\\"===g?c=!0:a?g===l&&(a=!1):'"'===g||"'"===g?(a=!0,l=g):"("===g?o+=1:")"===g?o>0&&(o-=1):0===o&&t.includes(g)&&(s=!0),s?(""!==r&&i.push(r.trim()),r="",s=!1):r+=g;return(n||""!==r)&&i.push(r.trim()),i}};t.exports=n,n.default=n})),MN=UF(((e,t)=>{var n=GN(),i=NN(),r=class extends n{constructor(e){super(e),this.type="rule",this.nodes||(this.nodes=[])}get selectors(){return i.comma(this.selector)}set selectors(e){let t=this.selector?this.selector.match(/,\s*/):null,n=t?t[0]:","+this.raw("between","beforeOpen");this.selector=e.join(n)}};t.exports=r,r.default=r,n.registerRule(r)})),WN=UF(((e,t)=>{var n=AN(),i=ZN(),r=wN(),s=DN(),o=FN(),a=MN(),l={empty:!0,space:!0};t.exports=class{constructor(e){this.input=e,this.root=new o,this.current=this.root,this.spaces="",this.semicolon=!1,this.customProperty=!1,this.createTokenizer(),this.root.source={input:e,start:{column:1,line:1,offset:0}}}atrule(e){let t=new s;t.name=e[1].slice(1),""===t.name&&this.unnamedAtrule(t,e),this.init(t,e[2]);let n,i,r,o=!1,a=!1,l=[],c=[];for(;!this.tokenizer.endOfFile();){if(n=(e=this.tokenizer.nextToken())[0],"("===n||"["===n?c.push("("===n?")":"]"):"{"===n&&c.length>0?c.push("}"):n===c[c.length-1]&&c.pop(),0===c.length){if(";"===n){t.source.end=this.getPosition(e[2]),t.source.end.offset++,this.semicolon=!0;break}if("{"===n){a=!0;break}if("}"===n){if(l.length>0){for(r=l.length-1,i=l[r];i&&"space"===i[0];)i=l[--r];i&&(t.source.end=this.getPosition(i[3]||i[2]),t.source.end.offset++)}this.end(e);break}l.push(e)}else l.push(e);if(this.tokenizer.endOfFile()){o=!0;break}}t.raws.between=this.spacesAndCommentsFromEnd(l),l.length?(t.raws.afterName=this.spacesAndCommentsFromStart(l),this.raw(t,"params",l),o&&(e=l[l.length-1],t.source.end=this.getPosition(e[3]||e[2]),t.source.end.offset++,this.spaces=t.raws.between,t.raws.between="")):(t.raws.afterName="",t.params=""),a&&(t.nodes=[],this.current=t)}checkMissedSemicolon(e){let t=this.colon(e);if(!1===t)return;let n,i=0;for(let r=t-1;r>=0&&(n=e[r],"space"===n[0]||(i+=1,2!==i));r--);throw this.input.error("Missed semicolon","word"===n[0]?n[3]+1:n[2])}colon(e){let t,n,i,r=0;for(let[s,o]of e.entries()){if(t=o,n=t[0],"("===n&&(r+=1),")"===n&&(r-=1),0===r&&":"===n){if(i){if("word"===i[0]&&"progid"===i[1])continue;return s}this.doubleColon(t)}i=t}return!1}comment(e){let t=new r;this.init(t,e[2]),t.source.end=this.getPosition(e[3]||e[2]),t.source.end.offset++;let n=e[1].slice(2,-2);if(/^\s*$/.test(n))t.text="",t.raws.left=n,t.raws.right="";else{let e=n.match(/^(\s*)([^]*\S)(\s*)$/);t.text=e[2],t.raws.left=e[1],t.raws.right=e[3]}}createTokenizer(){this.tokenizer=i(this.input)}decl(e,t){let i=new n;this.init(i,e[0][2]);let r,s=e[e.length-1];for(";"===s[0]&&(this.semicolon=!0,e.pop()),i.source.end=this.getPosition(s[3]||s[2]||function(e){for(let t=e.length-1;t>=0;t--){let n=e[t],i=n[3]||n[2];if(i)return i}}(e)),i.source.end.offset++;"word"!==e[0][0];)1===e.length&&this.unknownWord(e),i.raws.before+=e.shift()[1];for(i.source.start=this.getPosition(e[0][2]),i.prop="";e.length;){let t=e[0][0];if(":"===t||"space"===t||"comment"===t)break;i.prop+=e.shift()[1]}for(i.raws.between="";e.length;){if(r=e.shift(),":"===r[0]){i.raws.between+=r[1];break}"word"===r[0]&&/\w/.test(r[1])&&this.unknownWord([r]),i.raws.between+=r[1]}("_"===i.prop[0]||"*"===i.prop[0])&&(i.raws.before+=i.prop[0],i.prop=i.prop.slice(1));let o,a=[];for(;e.length&&(o=e[0][0],"space"===o||"comment"===o);)a.push(e.shift());this.precheckMissedSemicolon(e);for(let n=e.length-1;n>=0;n--){if(r=e[n],"!important"===r[1].toLowerCase()){i.important=!0;let t=this.stringFrom(e,n);t=this.spacesFromEnd(e)+t," !important"!==t&&(i.raws.important=t);break}if("important"===r[1].toLowerCase()){let t=e.slice(0),r="";for(let e=n;e>0;e--){let n=t[e][0];if(0===r.trim().indexOf("!")&&"space"!==n)break;r=t.pop()[1]+r}0===r.trim().indexOf("!")&&(i.important=!0,i.raws.important=r,e=t)}if("space"!==r[0]&&"comment"!==r[0])break}e.some((e=>"space"!==e[0]&&"comment"!==e[0]))&&(i.raws.between+=a.map((e=>e[1])).join(""),a=[]),this.raw(i,"value",a.concat(e),t),i.value.includes(":")&&!t&&this.checkMissedSemicolon(e)}doubleColon(e){throw this.input.error("Double colon",{offset:e[2]},{offset:e[2]+e[1].length})}emptyRule(e){let t=new a;this.init(t,e[2]),t.selector="",t.raws.between="",this.current=t}end(e){this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.semicolon=!1,this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.spaces="",this.current.parent?(this.current.source.end=this.getPosition(e[2]),this.current.source.end.offset++,this.current=this.current.parent):this.unexpectedClose(e)}endFile(){this.current.parent&&this.unclosedBlock(),this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.root.source.end=this.getPosition(this.tokenizer.position())}freeSemicolon(e){if(this.spaces+=e[1],this.current.nodes){let e=this.current.nodes[this.current.nodes.length-1];e&&"rule"===e.type&&!e.raws.ownSemicolon&&(e.raws.ownSemicolon=this.spaces,this.spaces="")}}getPosition(e){let t=this.input.fromOffset(e);return{column:t.col,line:t.line,offset:e}}init(e,t){this.current.push(e),e.source={input:this.input,start:this.getPosition(t)},e.raws.before=this.spaces,this.spaces="","comment"!==e.type&&(this.semicolon=!1)}other(e){let t=!1,n=null,i=!1,r=null,s=[],o=e[1].startsWith("--"),a=[],l=e;for(;l;){if(n=l[0],a.push(l),"("===n||"["===n)r||(r=l),s.push("("===n?")":"]");else if(o&&i&&"{"===n)r||(r=l),s.push("}");else if(0===s.length){if(";"===n){if(i)return void this.decl(a,o);break}if("{"===n)return void this.rule(a);if("}"===n){this.tokenizer.back(a.pop()),t=!0;break}":"===n&&(i=!0)}else n===s[s.length-1]&&(s.pop(),0===s.length&&(r=null));l=this.tokenizer.nextToken()}if(this.tokenizer.endOfFile()&&(t=!0),s.length>0&&this.unclosedBracket(r),t&&i){if(!o)for(;a.length&&(l=a[a.length-1][0],"space"===l||"comment"===l);)this.tokenizer.back(a.pop());this.decl(a,o)}else this.unknownWord(a)}parse(){let e;for(;!this.tokenizer.endOfFile();)switch(e=this.tokenizer.nextToken(),e[0]){case"space":this.spaces+=e[1];break;case";":this.freeSemicolon(e);break;case"}":this.end(e);break;case"comment":this.comment(e);break;case"at-word":this.atrule(e);break;case"{":this.emptyRule(e);break;default:this.other(e)}this.endFile()}precheckMissedSemicolon(){}raw(e,t,n,i){let r,s,o,a,c=n.length,g="",u=!0;for(let A=0;A<c;A+=1)r=n[A],s=r[0],"space"!==s||A!==c-1||i?"comment"===s?(a=n[A-1]?n[A-1][0]:"empty",o=n[A+1]?n[A+1][0]:"empty",l[a]||l[o]||","===g.slice(-1)?u=!1:g+=r[1]):g+=r[1]:u=!1;if(!u){let i=n.reduce(((e,t)=>e+t[1]),"");e.raws[t]={raw:i,value:g}}e[t]=g}rule(e){e.pop();let t=new a;this.init(t,e[0][2]),t.raws.between=this.spacesAndCommentsFromEnd(e),this.raw(t,"selector",e),this.current=t}spacesAndCommentsFromEnd(e){let t,n="";for(;e.length&&(t=e[e.length-1][0],"space"===t||"comment"===t);)n=e.pop()[1]+n;return n}spacesAndCommentsFromStart(e){let t,n="";for(;e.length&&(t=e[0][0],"space"===t||"comment"===t);)n+=e.shift()[1];return n}spacesFromEnd(e){let t,n="";for(;e.length&&(t=e[e.length-1][0],"space"===t);)n=e.pop()[1]+n;return n}stringFrom(e,t){let n="";for(let i=t;i<e.length;i++)n+=e[i][1];return e.splice(t,e.length-t),n}unclosedBlock(){let e=this.current.source.start;throw this.input.error("Unclosed block",e.line,e.column)}unclosedBracket(e){throw this.input.error("Unclosed bracket",{offset:e[2]},{offset:e[2]+1})}unexpectedClose(e){throw this.input.error("Unexpected }",{offset:e[2]},{offset:e[2]+1})}unknownWord(e){throw this.input.error("Unknown word",{offset:e[0][2]},{offset:e[0][2]+e[0][1].length})}unnamedAtrule(e,t){throw this.input.error("At-rule without name",{offset:t[2]},{offset:t[2]+t[1].length})}}})),kN=UF(((e,t)=>{var n=GN(),i=WN(),r=BN();function s(e,t){let n=new r(e,t),s=new i(n);try{s.parse()}catch(Vp){throw Vp}return s.root}t.exports=s,s.default=s,n.registerParse(s)})),TN=UF(((e,t)=>{var{isClean:n,my:i}=lN(),r=vN(),s=gN(),o=GN(),a=EN(),l=(xN(),RN()),c=kN(),g=FN(),u={atrule:"AtRule",comment:"Comment",decl:"Declaration",document:"Document",root:"Root",rule:"Rule"},A={AtRule:!0,AtRuleExit:!0,Comment:!0,CommentExit:!0,Declaration:!0,DeclarationExit:!0,Document:!0,DocumentExit:!0,Once:!0,OnceExit:!0,postcssPlugin:!0,prepare:!0,Root:!0,RootExit:!0,Rule:!0,RuleExit:!0},d={Once:!0,postcssPlugin:!0,prepare:!0},h=0;function I(e){return"object"==typeof e&&"function"==typeof e.then}function p(e){let t=!1,n=u[e.type];return"decl"===e.type?t=e.prop.toLowerCase():"atrule"===e.type&&(t=e.name.toLowerCase()),t&&e.append?[n,n+"-"+t,h,n+"Exit",n+"Exit-"+t]:t?[n,n+"-"+t,n+"Exit",n+"Exit-"+t]:e.append?[n,h,n+"Exit"]:[n,n+"Exit"]}function C(e){let t;return t="document"===e.type?["Document",h,"DocumentExit"]:"root"===e.type?["Root",h,"RootExit"]:p(e),{eventIndex:0,events:t,iterator:0,node:e,visitorIndex:0,visitors:[]}}function m(e){return e[n]=!1,e.nodes&&e.nodes.forEach((e=>m(e))),e}var f={},y=class{constructor(e,t,n){let r;if(this.stringified=!1,this.processed=!1,"object"!=typeof t||null===t||"root"!==t.type&&"document"!==t.type)if(t instanceof y||t instanceof l)r=m(t.root),t.map&&(typeof n.map>"u"&&(n.map={}),n.map.inline||(n.map.inline=!1),n.map.prev=t.map);else{let e=c;n.syntax&&(e=n.syntax.parse),n.parser&&(e=n.parser),e.parse&&(e=e.parse);try{r=e(t,n)}catch(lG){this.processed=!0,this.error=lG}r&&!r[i]&&o.rebuild(r)}else r=m(t);this.result=new l(e,r,n),this.helpers={...f,postcss:f,result:this.result},this.plugins=this.processor.plugins.map((e=>"object"==typeof e&&e.prepare?{...e,...e.prepare(this.result)}:e))}async(){return this.error?Promise.reject(this.error):this.processed?Promise.resolve(this.result):(this.processing||(this.processing=this.runAsync()),this.processing)}catch(e){return this.async().catch(e)}finally(e){return this.async().then(e,e)}getAsyncError(){throw new Error("Use process(css).then(cb) to work with async plugins")}handleError(e,t){let n=this.result.lastPlugin;try{t&&t.addToError(e),this.error=e,"CssSyntaxError"!==e.name||e.plugin?n.postcssVersion:(e.plugin=n.postcssPlugin,e.setMessage())}catch(Vp){console&&console.error&&console.error(Vp)}return e}prepareVisitors(){this.listeners={};let e=(e,t,n)=>{this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push([e,n])};for(let t of this.plugins)if("object"==typeof t)for(let n in t){if(!A[n]&&/^[A-Z]/.test(n))throw new Error("Unknown event ".concat(n," in ").concat(t.postcssPlugin,". Try to update PostCSS (").concat(this.processor.version," now)."));if(!d[n])if("object"==typeof t[n])for(let i in t[n])e(t,"*"===i?n:n+"-"+i.toLowerCase(),t[n][i]);else"function"==typeof t[n]&&e(t,n,t[n])}this.hasListener=Object.keys(this.listeners).length>0}async runAsync(){this.plugin=0;for(let e=0;e<this.plugins.length;e++){let t=this.plugins[e],n=this.runOnRoot(t);if(I(n))try{await n}catch(Vp){throw this.handleError(Vp)}}if(this.prepareVisitors(),this.hasListener){let e=this.result.root;for(;!e[n];){e[n]=!0;let t=[C(e)];for(;t.length>0;){let e=this.visitTick(t);if(I(e))try{await e}catch(Vp){let n=t[t.length-1].node;throw this.handleError(Vp,n)}}}if(this.listeners.OnceExit)for(let[t,n]of this.listeners.OnceExit){this.result.lastPlugin=t;try{if("document"===e.type){let t=e.nodes.map((e=>n(e,this.helpers)));await Promise.all(t)}else await n(e,this.helpers)}catch(Vp){throw this.handleError(Vp)}}}return this.processed=!0,this.stringify()}runOnRoot(e){this.result.lastPlugin=e;try{if("object"==typeof e&&e.Once){if("document"===this.result.root.type){let t=this.result.root.nodes.map((t=>e.Once(t,this.helpers)));return I(t[0])?Promise.all(t):t}return e.Once(this.result.root,this.helpers)}if("function"==typeof e)return e(this.result.root,this.result)}catch(Gx){throw this.handleError(Gx)}}stringify(){if(this.error)throw this.error;if(this.stringified)return this.result;this.stringified=!0,this.sync();let e=this.result.opts,t=s;e.syntax&&(t=e.syntax.stringify),e.stringifier&&(t=e.stringifier),t.stringify&&(t=t.stringify);let n=new r(t,this.result.root,this.result.opts).generate();return this.result.css=n[0],this.result.map=n[1],this.result}sync(){if(this.error)throw this.error;if(this.processed)return this.result;if(this.processed=!0,this.processing)throw this.getAsyncError();for(let e of this.plugins){if(I(this.runOnRoot(e)))throw this.getAsyncError()}if(this.prepareVisitors(),this.hasListener){let e=this.result.root;for(;!e[n];)e[n]=!0,this.walkSync(e);if(this.listeners.OnceExit)if("document"===e.type)for(let t of e.nodes)this.visitSync(this.listeners.OnceExit,t);else this.visitSync(this.listeners.OnceExit,e)}return this.result}then(e,t){return this.async().then(e,t)}toString(){return this.css}visitSync(e,t){for(let[n,i]of e){let e;this.result.lastPlugin=n;try{e=i(t,this.helpers)}catch(lG){throw this.handleError(lG,t.proxyOf)}if("root"!==t.type&&"document"!==t.type&&!t.parent)return!0;if(I(e))throw this.getAsyncError()}}visitTick(e){let t=e[e.length-1],{node:i,visitors:r}=t;if("root"!==i.type&&"document"!==i.type&&!i.parent)return void e.pop();if(r.length>0&&t.visitorIndex<r.length){let[e,n]=r[t.visitorIndex];t.visitorIndex+=1,t.visitorIndex===r.length&&(t.visitors=[],t.visitorIndex=0),this.result.lastPlugin=e;try{return n(i.toProxy(),this.helpers)}catch(Tx){throw this.handleError(Tx,i)}}if(0!==t.iterator){let r,s=t.iterator;for(;r=i.nodes[i.indexes[s]];)if(i.indexes[s]+=1,!r[n])return r[n]=!0,void e.push(C(r));t.iterator=0,delete i.indexes[s]}let s=t.events;for(;t.eventIndex<s.length;){let e=s[t.eventIndex];if(t.eventIndex+=1,e===h)return void(i.nodes&&i.nodes.length&&(i[n]=!0,t.iterator=i.getIterator()));if(this.listeners[e])return void(t.visitors=this.listeners[e])}e.pop()}walkSync(e){e[n]=!0;let t=p(e);for(let i of t)if(i===h)e.nodes&&e.each((e=>{e[n]||this.walkSync(e)}));else{let t=this.listeners[i];if(t&&this.visitSync(t,e.toProxy()))return}}warnings(){return this.sync().warnings()}get content(){return this.stringify().content}get css(){return this.stringify().css}get map(){return this.stringify().map}get messages(){return this.sync().messages}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){return this.sync().root}get[Symbol.toStringTag](){return"LazyResult"}};y.registerPostcss=e=>{f=e},t.exports=y,y.default=y,g.registerLazyResult(y),a.registerLazyResult(y)})),VN=UF(((e,t)=>{var n=vN(),i=gN(),r=(xN(),kN()),s=RN(),o=class{constructor(e,t,r){t=t.toString(),this.stringified=!1,this._processor=e,this._css=t,this._opts=r,this._map=void 0;let o,a=i;this.result=new s(this._processor,o,this._opts),this.result.css=t;let l=this;Object.defineProperty(this.result,"root",{get:()=>l.root});let c=new n(a,o,this._opts,t);if(c.isMap()){let[e,t]=c.generate();e&&(this.result.css=e),t&&(this.result.map=t)}}async(){return this.error?Promise.reject(this.error):Promise.resolve(this.result)}catch(e){return this.async().catch(e)}finally(e){return this.async().then(e,e)}sync(){if(this.error)throw this.error;return this.result}then(e,t){return this.async().then(e,t)}toString(){return this._css}warnings(){return[]}get content(){return this.result.css}get css(){return this.result.css}get map(){return this.result.map}get messages(){return[]}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){if(this._root)return this._root;let e,t=r;try{e=t(this._css,this._opts)}catch(xx){this.error=xx}if(this.error)throw this.error;return this._root=e,e}get[Symbol.toStringTag](){return"NoWorkResult"}};t.exports=o,o.default=o})),LN=UF(((e,t)=>{var n=VN(),i=TN(),r=EN(),s=FN(),o=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.version="8.4.31",this.plugins=this.normalize(e)}normalize(e){let t=[];for(let n of e)if(!0===n.postcss?n=n():n.postcss&&(n=n.postcss),"object"==typeof n&&Array.isArray(n.plugins))t=t.concat(n.plugins);else if("object"==typeof n&&n.postcssPlugin)t.push(n);else if("function"==typeof n)t.push(n);else if("object"!=typeof n||!n.parse&&!n.stringify)throw new Error(n+" is not a PostCSS plugin");return t}process(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return 0===this.plugins.length&&typeof t.parser>"u"&&typeof t.stringifier>"u"&&typeof t.syntax>"u"?new n(this,e,t):new i(this,e,t)}use(e){return this.plugins=this.plugins.concat(this.normalize([e])),this}};t.exports=o,o.default=o,s.registerProcessor(o),r.registerProcessor(o)})),HN=UF(((e,t)=>{var n=AN(),i=bN(),r=wN(),s=DN(),o=BN(),a=FN(),l=MN();function c(e,t){if(Array.isArray(e))return e.map((e=>c(e)));let{inputs:g,...u}=e;if(g){t=[];for(let e of g){let n={...e,__proto__:o.prototype};n.map&&(n.map={...n.map,__proto__:i.prototype}),t.push(n)}}if(u.nodes&&(u.nodes=e.nodes.map((e=>c(e,t)))),u.source){let{inputId:e,...n}=u.source;u.source=n,null!=e&&(u.source.input=t[e])}if("root"===u.type)return new a(u);if("decl"===u.type)return new n(u);if("rule"===u.type)return new l(u);if("comment"===u.type)return new r(u);if("atrule"===u.type)return new s(u);throw new Error("Unknown node type: "+e.type)}t.exports=c,c.default=c})),QN=UF(((e,t)=>{var n=aN(),i=AN(),r=TN(),s=GN(),o=LN(),a=gN(),l=HN(),c=EN(),g=SN(),u=wN(),A=DN(),d=RN(),h=BN(),I=kN(),p=NN(),C=MN(),m=FN(),f=uN();function y(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 1===t.length&&Array.isArray(t[0])&&(t=t[0]),new o(t)}y.plugin=function(e,t){let n,i=!1;function r(){console&&console.warn&&!i&&(i=!0,console.warn(e+": postcss.plugin was deprecated. Migration guide:\nhttps://evilmartians.com/chronicles/postcss-8-plugin-migration"),{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_VERCEL_ANALYTICS_ID:""}.LANG&&{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_VERCEL_ANALYTICS_ID:""}.LANG.startsWith("cn")&&console.warn(e+": \u91cc\u9762 postcss.plugin \u88ab\u5f03\u7528. \u8fc1\u79fb\u6307\u5357:\nhttps://www.w3ctech.com/topic/2226"));let n=t(...arguments);return n.postcssPlugin=e,n.postcssVersion=(new o).version,n}return Object.defineProperty(r,"postcss",{get:()=>(n||(n=r()),n)}),r.process=function(e,t,n){return y([r(n)]).process(e,t)},r},y.stringify=a,y.parse=I,y.fromJSON=l,y.list=p,y.comment=e=>new u(e),y.atRule=e=>new A(e),y.decl=e=>new i(e),y.rule=e=>new C(e),y.root=e=>new m(e),y.document=e=>new c(e),y.CssSyntaxError=n,y.Declaration=i,y.Container=s,y.Processor=o,y.Document=c,y.Comment=u,y.Warning=g,y.AtRule=A,y.Result=d,y.Input=h,y.Rule=C,y.Root=m,y.Node=f,r.registerPostcss(y),t.exports=y,y.default=y})),KN=UF(((e,t)=>{function n(e){for(var t=e.toLowerCase(),n="",i=!1,r=0;r<6&&void 0!==t[r];r++){var s=t.charCodeAt(r);if(i=32===s,!(s>=97&&s<=102||s>=48&&s<=57))break;n+=t[r]}if(0!==n.length){var o=parseInt(n,16);return o>=55296&&o<=57343||0===o||o>1114111?["\ufffd",n.length+(i?1:0)]:[String.fromCodePoint(o),n.length+(i?1:0)]}}e.__esModule=!0,e.default=function(e){var t=i.test(e);if(!t)return e;for(var r="",s=0;s<e.length;s++)if("\\"!==e[s])r+=e[s];else{var o=n(e.slice(s+1,s+7));if(void 0!==o){r+=o[0],s+=o[1];continue}if("\\"===e[s+1]){r+="\\",s++;continue}e.length===s+1&&(r+=e[s])}return r};var i=/\\/;t.exports=e.default})),XN=UF(((e,t)=>{e.__esModule=!0,e.default=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(;n.length>0;){var r=n.shift();if(!e[r])return;e=e[r]}return e},t.exports=e.default})),YN=UF(((e,t)=>{e.__esModule=!0,e.default=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(;n.length>0;){var r=n.shift();e[r]||(e[r]={}),e=e[r]}},t.exports=e.default})),zN=UF(((e,t)=>{e.__esModule=!0,e.default=function(e){for(var t="",n=e.indexOf("/*"),i=0;n>=0;){t+=e.slice(i,n);var r=e.indexOf("*/",n+2);if(r<0)return t;i=r+2,n=e.indexOf("/*",i)}return t+=e.slice(i),t},t.exports=e.default})),PN=UF((e=>{e.__esModule=!0,e.unesc=e.stripComments=e.getProp=e.ensureObject=void 0;var t=s(KN());e.unesc=t.default;var n=s(XN());e.getProp=n.default;var i=s(YN());e.ensureObject=i.default;var r=s(zN());function s(e){return e&&e.__esModule?e:{default:e}}e.stripComments=r.default})),UN=UF(((e,t)=>{e.__esModule=!0,e.default=void 0;var n=PN();function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r=function e(t,n){if("object"!=typeof t||null===t)return t;var i=new t.constructor;for(var r in t)if(t.hasOwnProperty(r)){var s=t[r];"parent"===r&&"object"===typeof s?n&&(i[r]=n):i[r]=s instanceof Array?s.map((function(t){return e(t,i)})):e(s,i)}return i},s=function(){function e(e){void 0===e&&(e={}),Object.assign(this,e),this.spaces=this.spaces||{},this.spaces.before=this.spaces.before||"",this.spaces.after=this.spaces.after||""}var t=e.prototype;return t.remove=function(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this},t.replaceWith=function(){if(this.parent){for(var e in arguments)this.parent.insertBefore(this,arguments[e]);this.remove()}return this},t.next=function(){return this.parent.at(this.parent.index(this)+1)},t.prev=function(){return this.parent.at(this.parent.index(this)-1)},t.clone=function(e){void 0===e&&(e={});var t=r(this);for(var n in e)t[n]=e[n];return t},t.appendToPropertyAndEscape=function(e,t,n){this.raws||(this.raws={});var i=this[e],r=this.raws[e];this[e]=i+t,r||n!==t?this.raws[e]=(r||i)+n:delete this.raws[e]},t.setPropertyAndEscape=function(e,t,n){this.raws||(this.raws={}),this[e]=t,this.raws[e]=n},t.setPropertyWithoutEscape=function(e,t){this[e]=t,this.raws&&delete this.raws[e]},t.isAtPosition=function(e,t){if(this.source&&this.source.start&&this.source.end)return!(this.source.start.line>e||this.source.end.line<e||this.source.start.line===e&&this.source.start.column>t||this.source.end.line===e&&this.source.end.column<t)},t.stringifyProperty=function(e){return this.raws&&this.raws[e]||this[e]},t.valueToString=function(){return String(this.stringifyProperty("value"))},t.toString=function(){return[this.rawSpaceBefore,this.valueToString(),this.rawSpaceAfter].join("")},function(e,t,n){t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"rawSpaceBefore",get:function(){var e=this.raws&&this.raws.spaces&&this.raws.spaces.before;return void 0===e&&(e=this.spaces&&this.spaces.before),e||""},set:function(e){(0,n.ensureObject)(this,"raws","spaces"),this.raws.spaces.before=e}},{key:"rawSpaceAfter",get:function(){var e=this.raws&&this.raws.spaces&&this.raws.spaces.after;return void 0===e&&(e=this.spaces.after),e||""},set:function(e){(0,n.ensureObject)(this,"raws","spaces"),this.raws.spaces.after=e}}]),e}();e.default=s,t.exports=e.default})),_N=UF((e=>{e.__esModule=!0,e.UNIVERSAL=e.TAG=e.STRING=e.SELECTOR=e.ROOT=e.PSEUDO=e.NESTING=e.ID=e.COMMENT=e.COMBINATOR=e.CLASS=e.ATTRIBUTE=void 0;e.TAG="tag";e.STRING="string";e.SELECTOR="selector";e.ROOT="root";e.PSEUDO="pseudo";e.NESTING="nesting";e.ID="id";e.COMMENT="comment";e.COMBINATOR="combinator";e.CLASS="class";e.ATTRIBUTE="attribute";e.UNIVERSAL="universal"})),ON=UF(((e,t)=>{e.__esModule=!0,e.default=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(UN()),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=r(t);if(n&&n.has(e))return n.get(e);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=s?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(i,o,a):i[o]=e[o]}return i.default=e,n&&n.set(e,i),i}(_N());function r(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(r=function(e){return e?n:t})(e)}function s(e,t){var n=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}var c=function(e){function t(t){var n;return(n=e.call(this,t)||this).nodes||(n.nodes=[]),n}!function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,l(e,t)}(t,e);var n=t.prototype;return n.append=function(e){return e.parent=this,this.nodes.push(e),this},n.prepend=function(e){return e.parent=this,this.nodes.unshift(e),this},n.at=function(e){return this.nodes[e]},n.index=function(e){return"number"==typeof e?e:this.nodes.indexOf(e)},n.removeChild=function(e){var t;for(var n in e=this.index(e),this.at(e).parent=void 0,this.nodes.splice(e,1),this.indexes)(t=this.indexes[n])>=e&&(this.indexes[n]=t-1);return this},n.removeAll=function(){for(var e,t=s(this.nodes);!(e=t()).done;){e.value.parent=void 0}return this.nodes=[],this},n.empty=function(){return this.removeAll()},n.insertAfter=function(e,t){t.parent=this;var n,i=this.index(e);for(var r in this.nodes.splice(i+1,0,t),t.parent=this,this.indexes)i<=(n=this.indexes[r])&&(this.indexes[r]=n+1);return this},n.insertBefore=function(e,t){t.parent=this;var n,i=this.index(e);for(var r in this.nodes.splice(i,0,t),t.parent=this,this.indexes)(n=this.indexes[r])<=i&&(this.indexes[r]=n+1);return this},n._findChildAtPosition=function(e,t){var n=void 0;return this.each((function(i){if(i.atPosition){var r=i.atPosition(e,t);if(r)return n=r,!1}else if(i.isAtPosition(e,t))return n=i,!1})),n},n.atPosition=function(e,t){if(this.isAtPosition(e,t))return this._findChildAtPosition(e,t)||this},n._inferEndPosition=function(){this.last&&this.last.source&&this.last.source.end&&(this.source=this.source||{},this.source.end=this.source.end||{},Object.assign(this.source.end,this.last.source.end))},n.each=function(e){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach++;var t=this.lastEach;if(this.indexes[t]=0,this.length){for(var n,i;this.indexes[t]<this.length&&(n=this.indexes[t],!1!==(i=e(this.at(n),n)));)this.indexes[t]+=1;if(delete this.indexes[t],!1===i)return!1}},n.walk=function(e){return this.each((function(t,n){var i=e(t,n);if(!1!==i&&t.length&&(i=t.walk(e)),!1===i)return!1}))},n.walkAttributes=function(e){var t=this;return this.walk((function(n){if(n.type===i.ATTRIBUTE)return e.call(t,n)}))},n.walkClasses=function(e){var t=this;return this.walk((function(n){if(n.type===i.CLASS)return e.call(t,n)}))},n.walkCombinators=function(e){var t=this;return this.walk((function(n){if(n.type===i.COMBINATOR)return e.call(t,n)}))},n.walkComments=function(e){var t=this;return this.walk((function(n){if(n.type===i.COMMENT)return e.call(t,n)}))},n.walkIds=function(e){var t=this;return this.walk((function(n){if(n.type===i.ID)return e.call(t,n)}))},n.walkNesting=function(e){var t=this;return this.walk((function(n){if(n.type===i.NESTING)return e.call(t,n)}))},n.walkPseudos=function(e){var t=this;return this.walk((function(n){if(n.type===i.PSEUDO)return e.call(t,n)}))},n.walkTags=function(e){var t=this;return this.walk((function(n){if(n.type===i.TAG)return e.call(t,n)}))},n.walkUniversals=function(e){var t=this;return this.walk((function(n){if(n.type===i.UNIVERSAL)return e.call(t,n)}))},n.split=function(e){var t=this,n=[];return this.reduce((function(i,r,s){var o=e.call(t,r);return n.push(r),o?(i.push(n),n=[]):s===t.length-1&&i.push(n),i}),[])},n.map=function(e){return this.nodes.map(e)},n.reduce=function(e,t){return this.nodes.reduce(e,t)},n.every=function(e){return this.nodes.every(e)},n.some=function(e){return this.nodes.some(e)},n.filter=function(e){return this.nodes.filter(e)},n.sort=function(e){return this.nodes.sort(e)},n.toString=function(){return this.map(String).join("")},function(e,t,n){t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"first",get:function(){return this.at(0)}},{key:"last",get:function(){return this.at(this.length-1)}},{key:"length",get:function(){return this.nodes.length}}]),t}(n.default);e.default=c,t.exports=e.default})),JN=UF(((e,t)=>{e.__esModule=!0,e.default=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(ON()),i=_N();function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}var o=function(e){function t(t){var n;return(n=e.call(this,t)||this).type=i.ROOT,n}!function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,s(e,t)}(t,e);var n=t.prototype;return n.toString=function(){var e=this.reduce((function(e,t){return e.push(String(t)),e}),[]).join(",");return this.trailingComma?e+",":e},n.error=function(e,t){return this._error?this._error(e,t):new Error(e)},function(e,t,n){t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"errorGenerator",set:function(e){this._error=e}}]),t}(n.default);e.default=o,t.exports=e.default})),jN=UF(((e,t)=>{e.__esModule=!0,e.default=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(ON()),i=_N();function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}var s=function(e){function t(t){var n;return(n=e.call(this,t)||this).type=i.SELECTOR,n}return function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)}(t,e),t}(n.default);e.default=s,t.exports=e.default})),qN=UF(((e,t)=>{var n={}.hasOwnProperty,i=/[ -,\.\/:-@\[-\^`\{-~]/,r=/[ -,\.\/:-@\[\]\^`\{-~]/,s=/(^|\\+)?(\\[A-F0-9]{1,6})\x20(?![a-fA-F0-9\x20])/g,o=function e(t,o){o=function(e,t){if(!e)return t;var i={};for(var r in t)i[r]=n.call(e,r)?e[r]:t[r];return i}(o,e.options),"single"!=o.quotes&&"double"!=o.quotes&&(o.quotes="single");for(var a="double"==o.quotes?'"':"'",l=o.isIdentifier,c=t.charAt(0),g="",u=0,A=t.length;u<A;){var d=t.charAt(u++),h=d.charCodeAt(),I=void 0;if(h<32||h>126){if(h>=55296&&h<=56319&&u<A){var p=t.charCodeAt(u++);56320==(64512&p)?h=((1023&h)<<10)+(1023&p)+65536:u--}I="\\"+h.toString(16).toUpperCase()+" "}else I=o.escapeEverything?i.test(d)?"\\"+d:"\\"+h.toString(16).toUpperCase()+" ":/[\t\n\f\r\x0B]/.test(d)?"\\"+h.toString(16).toUpperCase()+" ":"\\"==d||!l&&('"'==d&&a==d||"'"==d&&a==d)||l&&r.test(d)?"\\"+d:d;g+=I}return l&&(/^-[-\d]/.test(g)?g="\\-"+g.slice(1):/\d/.test(c)&&(g="\\3"+c+" "+g.slice(1))),g=g.replace(s,(function(e,t,n){return t&&t.length%2?e:(t||"")+n})),!l&&o.wrap?a+g+a:g};o.options={escapeEverything:!1,isIdentifier:!1,quotes:"single",wrap:!1},o.version="3.0.0",t.exports=o})),$N=UF(((e,t)=>{e.__esModule=!0,e.default=void 0;var n=o(qN()),i=PN(),r=o(UN()),s=_N();function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}var c=function(e){function t(t){var n;return(n=e.call(this,t)||this).type=s.CLASS,n._constructed=!0,n}return function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,l(e,t)}(t,e),t.prototype.valueToString=function(){return"."+e.prototype.valueToString.call(this)},function(e,t,n){t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"value",get:function(){return this._value},set:function(e){if(this._constructed){var t=(0,n.default)(e,{isIdentifier:!0});t!==e?((0,i.ensureObject)(this,"raws"),this.raws.value=t):this.raws&&delete this.raws.value}this._value=e}}]),t}(r.default);e.default=c,t.exports=e.default})),eM=UF(((e,t)=>{e.__esModule=!0,e.default=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(UN()),i=_N();function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}var s=function(e){function t(t){var n;return(n=e.call(this,t)||this).type=i.COMMENT,n}return function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)}(t,e),t}(n.default);e.default=s,t.exports=e.default})),tM=UF(((e,t)=>{e.__esModule=!0,e.default=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(UN()),i=_N();function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}var s=function(e){function t(t){var n;return(n=e.call(this,t)||this).type=i.ID,n}return function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)}(t,e),t.prototype.valueToString=function(){return"#"+e.prototype.valueToString.call(this)},t}(n.default);e.default=s,t.exports=e.default})),nM=UF(((e,t)=>{e.__esModule=!0,e.default=void 0;var n=r(qN()),i=PN();function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,t){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},o(e,t)}var a=function(e){function t(){return e.apply(this,arguments)||this}!function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,o(e,t)}(t,e);var r=t.prototype;return r.qualifiedName=function(e){return this.namespace?this.namespaceString+"|"+e:e},r.valueToString=function(){return this.qualifiedName(e.prototype.valueToString.call(this))},function(e,t,n){t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"namespace",get:function(){return this._namespace},set:function(e){if(!0===e||"*"===e||"&"===e)return this._namespace=e,void(this.raws&&delete this.raws.namespace);var t=(0,n.default)(e,{isIdentifier:!0});this._namespace=e,t!==e?((0,i.ensureObject)(this,"raws"),this.raws.namespace=t):this.raws&&delete this.raws.namespace}},{key:"ns",get:function(){return this._namespace},set:function(e){this.namespace=e}},{key:"namespaceString",get:function(){if(this.namespace){var e=this.stringifyProperty("namespace");return!0===e?"":e}return""}}]),t}(r(UN()).default);e.default=a,t.exports=e.default})),iM=UF(((e,t)=>{e.__esModule=!0,e.default=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(nM()),i=_N();function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}var s=function(e){function t(t){var n;return(n=e.call(this,t)||this).type=i.TAG,n}return function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)}(t,e),t}(n.default);e.default=s,t.exports=e.default})),rM=UF(((e,t)=>{e.__esModule=!0,e.default=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(UN()),i=_N();function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}var s=function(e){function t(t){var n;return(n=e.call(this,t)||this).type=i.STRING,n}return function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)}(t,e),t}(n.default);e.default=s,t.exports=e.default})),sM=UF(((e,t)=>{e.__esModule=!0,e.default=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(ON()),i=_N();function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}var s=function(e){function t(t){var n;return(n=e.call(this,t)||this).type=i.PSEUDO,n}return function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)}(t,e),t.prototype.toString=function(){var e=this.length?"("+this.map(String).join(",")+")":"";return[this.rawSpaceBefore,this.stringifyProperty("value"),e,this.rawSpaceAfter].join("")},t}(n.default);e.default=s,t.exports=e.default})),oM=UF(((e,t)=>{function n(e){try{if(!global.localStorage)return!1}catch{return!1}var t=global.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}t.exports=function(e,t){if(n("noDeprecation"))return e;var i=!1;return function(){if(!i){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),i=!0}return e.apply(this,arguments)}}})),aM=UF((e=>{e.__esModule=!0,e.default=void 0,e.unescapeValue=h;var t,n=o(qN()),i=o(KN()),r=o(nM()),s=_N();function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}var c=oM(),g=/^('|")([^]*)\1$/,u=c((function(){}),"Assigning an attribute a value containing characters that might need to be escaped is deprecated. Call attribute.setValue() instead."),A=c((function(){}),"Assigning attr.quoted is deprecated and has no effect. Assign to attr.quoteMark instead."),d=c((function(){}),"Constructing an Attribute selector with a value without specifying quoteMark is deprecated. Note: The value should be unescaped now.");function h(e){var t=!1,n=null,r=e,s=r.match(g);return s&&(n=s[1],r=s[2]),(r=(0,i.default)(r))!==e&&(t=!0),{deprecatedUsage:t,unescaped:r,quoteMark:n}}var I=function(e){function t(t){var n;return void 0===t&&(t={}),n=e.call(this,function(e){if(void 0!==e.quoteMark||void 0===e.value)return e;d();var t=h(e.value),n=t.quoteMark,i=t.unescaped;return e.raws||(e.raws={}),void 0===e.raws.value&&(e.raws.value=e.value),e.value=i,e.quoteMark=n,e}(t))||this,n.type=s.ATTRIBUTE,n.raws=n.raws||{},Object.defineProperty(n.raws,"unquoted",{get:c((function(){return n.value}),"attr.raws.unquoted is deprecated. Call attr.value instead."),set:c((function(){return n.value}),"Setting attr.raws.unquoted is deprecated and has no effect. attr.value is unescaped by default now.")}),n._constructed=!0,n}!function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,l(e,t)}(t,e);var i=t.prototype;return i.getQuotedValue=function(e){void 0===e&&(e={});var t=this._determineQuoteMark(e),i=p[t];return(0,n.default)(this._value,i)},i._determineQuoteMark=function(e){return e.smart?this.smartQuoteMark(e):this.preferredQuoteMark(e)},i.setValue=function(e,t){void 0===t&&(t={}),this._value=e,this._quoteMark=this._determineQuoteMark(t),this._syncRawValue()},i.smartQuoteMark=function(e){var i=this.value,r=i.replace(/[^']/g,"").length,s=i.replace(/[^"]/g,"").length;if(r+s===0){var o=(0,n.default)(i,{isIdentifier:!0});if(o===i)return t.NO_QUOTE;var a=this.preferredQuoteMark(e);if(a===t.NO_QUOTE){var l=this.quoteMark||e.quoteMark||t.DOUBLE_QUOTE,c=p[l];if((0,n.default)(i,c).length<o.length)return l}return a}return s===r?this.preferredQuoteMark(e):s<r?t.DOUBLE_QUOTE:t.SINGLE_QUOTE},i.preferredQuoteMark=function(e){var n=e.preferCurrentQuoteMark?this.quoteMark:e.quoteMark;return void 0===n&&(n=e.preferCurrentQuoteMark?e.quoteMark:this.quoteMark),void 0===n&&(n=t.DOUBLE_QUOTE),n},i._syncRawValue=function(){var e=(0,n.default)(this._value,p[this.quoteMark]);e===this._value?this.raws&&delete this.raws.value:this.raws.value=e},i._handleEscapes=function(e,t){if(this._constructed){var i=(0,n.default)(t,{isIdentifier:!0});i!==t?this.raws[e]=i:delete this.raws[e]}},i._spacesFor=function(e){var t=this.spaces[e]||{},n=this.raws.spaces&&this.raws.spaces[e]||{};return Object.assign({before:"",after:""},t,n)},i._stringFor=function(e,t,n){void 0===t&&(t=e),void 0===n&&(n=C);var i=this._spacesFor(t);return n(this.stringifyProperty(e),i)},i.offsetOf=function(e){var t=1,n=this._spacesFor("attribute");if(t+=n.before.length,"namespace"===e||"ns"===e)return this.namespace?t:-1;if("attributeNS"===e||(t+=this.namespaceString.length,this.namespace&&(t+=1),"attribute"===e))return t;t+=this.stringifyProperty("attribute").length,t+=n.after.length;var i=this._spacesFor("operator");t+=i.before.length;var r=this.stringifyProperty("operator");if("operator"===e)return r?t:-1;t+=r.length,t+=i.after.length;var s=this._spacesFor("value");t+=s.before.length;var o=this.stringifyProperty("value");return"value"===e?o?t:-1:(t+=o.length,t+=s.after.length,t+=this._spacesFor("insensitive").before.length,"insensitive"===e&&this.insensitive?t:-1)},i.toString=function(){var e=this,t=[this.rawSpaceBefore,"["];return t.push(this._stringFor("qualifiedAttribute","attribute")),this.operator&&(this.value||""===this.value)&&(t.push(this._stringFor("operator")),t.push(this._stringFor("value")),t.push(this._stringFor("insensitiveFlag","insensitive",(function(t,n){return t.length>0&&!e.quoted&&0===n.before.length&&!(e.spaces.value&&e.spaces.value.after)&&(n.before=" "),C(t,n)})))),t.push("]"),t.push(this.rawSpaceAfter),t.join("")},function(e,t,n){t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"quoted",get:function(){var e=this.quoteMark;return"'"===e||'"'===e},set:function(e){A()}},{key:"quoteMark",get:function(){return this._quoteMark},set:function(e){this._constructed?this._quoteMark!==e&&(this._quoteMark=e,this._syncRawValue()):this._quoteMark=e}},{key:"qualifiedAttribute",get:function(){return this.qualifiedName(this.raws.attribute||this.attribute)}},{key:"insensitiveFlag",get:function(){return this.insensitive?"i":""}},{key:"value",get:function(){return this._value},set:function(e){if(this._constructed){var t=h(e),n=t.deprecatedUsage,i=t.unescaped,r=t.quoteMark;if(n&&u(),i===this._value&&r===this._quoteMark)return;this._value=i,this._quoteMark=r,this._syncRawValue()}else this._value=e}},{key:"insensitive",get:function(){return this._insensitive},set:function(e){e||(this._insensitive=!1,this.raws&&("I"===this.raws.insensitiveFlag||"i"===this.raws.insensitiveFlag)&&(this.raws.insensitiveFlag=void 0)),this._insensitive=e}},{key:"attribute",get:function(){return this._attribute},set:function(e){this._handleEscapes("attribute",e),this._attribute=e}}]),t}(r.default);e.default=I,I.NO_QUOTE=null,I.SINGLE_QUOTE="'",I.DOUBLE_QUOTE='"';var p=((t={"'":{quotes:"single",wrap:!0},'"':{quotes:"double",wrap:!0}}).null={isIdentifier:!0},t);function C(e,t){return""+t.before+e+t.after}})),lM=UF(((e,t)=>{e.__esModule=!0,e.default=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(nM()),i=_N();function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}var s=function(e){function t(t){var n;return(n=e.call(this,t)||this).type=i.UNIVERSAL,n.value="*",n}return function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)}(t,e),t}(n.default);e.default=s,t.exports=e.default})),cM=UF(((e,t)=>{e.__esModule=!0,e.default=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(UN()),i=_N();function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}var s=function(e){function t(t){var n;return(n=e.call(this,t)||this).type=i.COMBINATOR,n}return function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)}(t,e),t}(n.default);e.default=s,t.exports=e.default})),gM=UF(((e,t)=>{e.__esModule=!0,e.default=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(UN()),i=_N();function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}var s=function(e){function t(t){var n;return(n=e.call(this,t)||this).type=i.NESTING,n.value="&",n}return function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)}(t,e),t}(n.default);e.default=s,t.exports=e.default})),uM=UF(((e,t)=>{e.__esModule=!0,e.default=function(e){return e.sort((function(e,t){return e-t}))},t.exports=e.default})),AM=UF((e=>{e.__esModule=!0,e.word=e.tilde=e.tab=e.str=e.space=e.slash=e.singleQuote=e.semicolon=e.plus=e.pipe=e.openSquare=e.openParenthesis=e.newline=e.greaterThan=e.feed=e.equals=e.doubleQuote=e.dollar=e.cr=e.comment=e.comma=e.combinator=e.colon=e.closeSquare=e.closeParenthesis=e.caret=e.bang=e.backslash=e.at=e.asterisk=e.ampersand=void 0;e.ampersand=38;e.asterisk=42;e.at=64;e.comma=44;e.colon=58;e.semicolon=59;e.openParenthesis=40;e.closeParenthesis=41;e.openSquare=91;e.closeSquare=93;e.dollar=36;e.tilde=126;e.caret=94;e.plus=43;e.equals=61;e.pipe=124;e.greaterThan=62;e.space=32;e.singleQuote=39;e.doubleQuote=34;e.slash=47;e.bang=33;e.backslash=92;e.cr=13;e.feed=12;e.newline=10;e.tab=9;e.str=39;e.comment=-1;e.word=-2;e.combinator=-3})),dM=UF((e=>{e.__esModule=!0,e.FIELDS=void 0,e.default=function(e){var t,n,r,s,o,a,l,c,u,A,d,h,I=[],p=e.css.valueOf(),C=p,m=C.length,f=-1,y=1,b=0,B=0;function v(t,n){if(!e.safe)throw e.error("Unclosed "+t,y,b-f,b);c=(p+=n).length-1}for(;b<m;){switch((t=p.charCodeAt(b))===i.newline&&(f=b,y+=1),t){case i.space:case i.tab:case i.newline:case i.cr:case i.feed:c=b;do{c+=1,(t=p.charCodeAt(c))===i.newline&&(f=c,y+=1)}while(t===i.space||t===i.newline||t===i.tab||t===i.cr||t===i.feed);h=i.space,r=y,n=c-f-1,B=c;break;case i.plus:case i.greaterThan:case i.tilde:case i.pipe:c=b;do{c+=1,t=p.charCodeAt(c)}while(t===i.plus||t===i.greaterThan||t===i.tilde||t===i.pipe);h=i.combinator,r=y,n=b-f,B=c;break;case i.asterisk:case i.ampersand:case i.bang:case i.comma:case i.equals:case i.dollar:case i.caret:case i.openSquare:case i.closeSquare:case i.colon:case i.semicolon:case i.openParenthesis:case i.closeParenthesis:h=t,r=y,n=b-f,B=(c=b)+1;break;case i.singleQuote:case i.doubleQuote:d=t===i.singleQuote?"'":'"',c=b;do{for(s=!1,-1===(c=p.indexOf(d,c+1))&&v("quote",d),o=c;p.charCodeAt(o-1)===i.backslash;)o-=1,s=!s}while(s);h=i.str,r=y,n=b-f,B=c+1;break;default:t===i.slash&&p.charCodeAt(b+1)===i.asterisk?(0===(c=p.indexOf("*/",b+2)+1)&&v("comment","*/"),(a=(l=p.slice(b,c+1).split("\n")).length-1)>0?(u=y+a,A=c-l[a].length):(u=y,A=f),h=i.comment,y=u,r=u,n=c-A):t===i.slash?(h=t,r=y,n=b-f,B=(c=b)+1):(c=g(p,b),h=i.word,r=y,n=c-f),B=c+1}I.push([h,y,b-f,r,n,b,B]),A&&(f=A,A=null),b=B}return I};var t,n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=r(t);if(n&&n.has(e))return n.get(e);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=s?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(i,o,a):i[o]=e[o]}return i.default=e,n&&n.set(e,i),i}(AM());function r(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(r=function(e){return e?n:t})(e)}var s,o=((t={})[i.tab]=!0,t[i.newline]=!0,t[i.cr]=!0,t[i.feed]=!0,t),a=((n={})[i.space]=!0,n[i.tab]=!0,n[i.newline]=!0,n[i.cr]=!0,n[i.feed]=!0,n[i.ampersand]=!0,n[i.asterisk]=!0,n[i.bang]=!0,n[i.comma]=!0,n[i.colon]=!0,n[i.semicolon]=!0,n[i.openParenthesis]=!0,n[i.closeParenthesis]=!0,n[i.openSquare]=!0,n[i.closeSquare]=!0,n[i.singleQuote]=!0,n[i.doubleQuote]=!0,n[i.plus]=!0,n[i.pipe]=!0,n[i.tilde]=!0,n[i.greaterThan]=!0,n[i.equals]=!0,n[i.dollar]=!0,n[i.caret]=!0,n[i.slash]=!0,n),l={},c="0123456789abcdefABCDEF";for(s=0;s<22;s++)l[c.charCodeAt(s)]=!0;function g(e,t){var n,r=t;do{if(n=e.charCodeAt(r),a[n])return r-1;n===i.backslash?r=u(e,r)+1:r++}while(r<e.length);return r-1}function u(e,t){var n=t,r=e.charCodeAt(n+1);if(!o[r])if(l[r]){var s=0;do{n++,s++,r=e.charCodeAt(n+1)}while(l[r]&&s<6);s<6&&r===i.space&&n++}else n++;return n}e.FIELDS={TYPE:0,START_LINE:1,START_COL:2,END_LINE:3,END_COL:4,START_POS:5,END_POS:6}})),hM=UF(((e,t)=>{e.__esModule=!0,e.default=void 0;var n,i,r=v(JN()),s=v(jN()),o=v($N()),a=v(eM()),l=v(tM()),c=v(iM()),g=v(rM()),u=v(sM()),A=B(aM()),d=v(lM()),h=v(cM()),I=v(gM()),p=v(uM()),C=B(dM()),m=B(AM()),f=B(_N()),y=PN();function b(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(b=function(e){return e?n:t})(e)}function B(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=b(t);if(n&&n.has(e))return n.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=r?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(i,s,o):i[s]=e[s]}return i.default=e,n&&n.set(e,i),i}function v(e){return e&&e.__esModule?e:{default:e}}function w(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var G=((n={})[m.space]=!0,n[m.cr]=!0,n[m.feed]=!0,n[m.newline]=!0,n[m.tab]=!0,n),E=Object.assign({},G,((i={})[m.comment]=!0,i));function x(e){return{line:e[C.FIELDS.START_LINE],column:e[C.FIELDS.START_COL]}}function S(e){return{line:e[C.FIELDS.END_LINE],column:e[C.FIELDS.END_COL]}}function R(e,t,n,i){return{start:{line:e,column:t},end:{line:n,column:i}}}function Z(e){return R(e[C.FIELDS.START_LINE],e[C.FIELDS.START_COL],e[C.FIELDS.END_LINE],e[C.FIELDS.END_COL])}function D(e,t){if(e)return R(e[C.FIELDS.START_LINE],e[C.FIELDS.START_COL],t[C.FIELDS.END_LINE],t[C.FIELDS.END_COL])}function F(e,t){var n=e[t];if("string"==typeof n)return-1!==n.indexOf("\\")&&((0,y.ensureObject)(e,"raws"),e[t]=(0,y.unesc)(n),void 0===e.raws[t]&&(e.raws[t]=n)),e}function N(e,t){for(var n=-1,i=[];-1!==(n=e.indexOf(t,n+1));)i.push(n);return i}var M=function(){function e(e,t){void 0===t&&(t={}),this.rule=e,this.options=Object.assign({lossy:!1,safe:!1},t),this.position=0,this.css="string"==typeof this.rule?this.rule:this.rule.selector,this.tokens=(0,C.default)({css:this.css,error:this._errorGenerator(),safe:this.options.safe});var n=D(this.tokens[0],this.tokens[this.tokens.length-1]);this.root=new r.default({source:n}),this.root.errorGenerator=this._errorGenerator();var i=new s.default({source:{start:{line:1,column:1}}});this.root.append(i),this.current=i,this.loop()}var t=e.prototype;return t._errorGenerator=function(){var e=this;return function(t,n){return"string"==typeof e.rule?new Error(t):e.rule.error(t,n)}},t.attribute=function(){var e=[],t=this.currToken;for(this.position++;this.position<this.tokens.length&&this.currToken[C.FIELDS.TYPE]!==m.closeSquare;)e.push(this.currToken),this.position++;if(this.currToken[C.FIELDS.TYPE]!==m.closeSquare)return this.expected("closing square bracket",this.currToken[C.FIELDS.START_POS]);var n=e.length,i={source:R(t[1],t[2],this.currToken[3],this.currToken[4]),sourceIndex:t[C.FIELDS.START_POS]};if(1===n&&!~[m.word].indexOf(e[0][C.FIELDS.TYPE]))return this.expected("attribute",e[0][C.FIELDS.START_POS]);for(var r=0,s="",o="",a=null,l=!1;r<n;){var c=e[r],g=this.content(c),u=e[r+1];switch(c[C.FIELDS.TYPE]){case m.space:if(l=!0,this.options.lossy)break;if(a){(0,y.ensureObject)(i,"spaces",a);var d=i.spaces[a].after||"";i.spaces[a].after=d+g;var h=(0,y.getProp)(i,"raws","spaces",a,"after")||null;h&&(i.raws.spaces[a].after=h+g)}else s+=g,o+=g;break;case m.asterisk:if(u[C.FIELDS.TYPE]===m.equals)i.operator=g,a="operator";else if((!i.namespace||"namespace"===a&&!l)&&u){s&&((0,y.ensureObject)(i,"spaces","attribute"),i.spaces.attribute.before=s,s=""),o&&((0,y.ensureObject)(i,"raws","spaces","attribute"),i.raws.spaces.attribute.before=s,o=""),i.namespace=(i.namespace||"")+g,((0,y.getProp)(i,"raws","namespace")||null)&&(i.raws.namespace+=g),a="namespace"}l=!1;break;case m.dollar:if("value"===a){var I=(0,y.getProp)(i,"raws","value");i.value+="$",I&&(i.raws.value=I+"$");break}case m.caret:u[C.FIELDS.TYPE]===m.equals&&(i.operator=g,a="operator"),l=!1;break;case m.combinator:if("~"===g&&u[C.FIELDS.TYPE]===m.equals&&(i.operator=g,a="operator"),"|"!==g){l=!1;break}u[C.FIELDS.TYPE]===m.equals?(i.operator=g,a="operator"):!i.namespace&&!i.attribute&&(i.namespace=!0),l=!1;break;case m.word:if(u&&"|"===this.content(u)&&e[r+2]&&e[r+2][C.FIELDS.TYPE]!==m.equals&&!i.operator&&!i.namespace)i.namespace=g,a="namespace";else if(!i.attribute||"attribute"===a&&!l){s&&((0,y.ensureObject)(i,"spaces","attribute"),i.spaces.attribute.before=s,s=""),o&&((0,y.ensureObject)(i,"raws","spaces","attribute"),i.raws.spaces.attribute.before=o,o=""),i.attribute=(i.attribute||"")+g,((0,y.getProp)(i,"raws","attribute")||null)&&(i.raws.attribute+=g),a="attribute"}else if(!i.value&&""!==i.value||"value"===a&&!l&&!i.quoteMark){var p=(0,y.unesc)(g),f=(0,y.getProp)(i,"raws","value")||"",b=i.value||"";i.value=b+p,i.quoteMark=null,(p!==g||f)&&((0,y.ensureObject)(i,"raws"),i.raws.value=(f||b)+g),a="value"}else{var B="i"===g||"I"===g;!i.value&&""!==i.value||!i.quoteMark&&!l?(i.value||""===i.value)&&(a="value",i.value+=g,i.raws.value&&(i.raws.value+=g)):(i.insensitive=B,(!B||"I"===g)&&((0,y.ensureObject)(i,"raws"),i.raws.insensitiveFlag=g),a="insensitive",s&&((0,y.ensureObject)(i,"spaces","insensitive"),i.spaces.insensitive.before=s,s=""),o&&((0,y.ensureObject)(i,"raws","spaces","insensitive"),i.raws.spaces.insensitive.before=o,o=""))}l=!1;break;case m.str:if(!i.attribute||!i.operator)return this.error("Expected an attribute followed by an operator preceding the string.",{index:c[C.FIELDS.START_POS]});var v=(0,A.unescapeValue)(g),w=v.unescaped,G=v.quoteMark;i.value=w,i.quoteMark=G,a="value",(0,y.ensureObject)(i,"raws"),i.raws.value=g,l=!1;break;case m.equals:if(!i.attribute)return this.expected("attribute",c[C.FIELDS.START_POS],g);if(i.value)return this.error('Unexpected "=" found; an operator was already defined.',{index:c[C.FIELDS.START_POS]});i.operator=i.operator?i.operator+g:g,a="operator",l=!1;break;case m.comment:if(a)if(l||u&&u[C.FIELDS.TYPE]===m.space||"insensitive"===a){var E=(0,y.getProp)(i,"spaces",a,"after")||"",x=(0,y.getProp)(i,"raws","spaces",a,"after")||E;(0,y.ensureObject)(i,"raws","spaces",a),i.raws.spaces[a].after=x+g}else{var S=i[a]||"",Z=(0,y.getProp)(i,"raws",a)||S;(0,y.ensureObject)(i,"raws"),i.raws[a]=Z+g}else o+=g;break;default:return this.error('Unexpected "'+g+'" found.',{index:c[C.FIELDS.START_POS]})}r++}F(i,"attribute"),F(i,"namespace"),this.newNode(new A.default(i)),this.position++},t.parseWhitespaceEquivalentTokens=function(e){e<0&&(e=this.tokens.length);var t=this.position,n=[],i="",r=void 0;do{if(G[this.currToken[C.FIELDS.TYPE]])this.options.lossy||(i+=this.content());else if(this.currToken[C.FIELDS.TYPE]===m.comment){var s={};i&&(s.before=i,i=""),r=new a.default({value:this.content(),source:Z(this.currToken),sourceIndex:this.currToken[C.FIELDS.START_POS],spaces:s}),n.push(r)}}while(++this.position<e);if(i)if(r)r.spaces.after=i;else if(!this.options.lossy){var o=this.tokens[t],l=this.tokens[this.position-1];n.push(new g.default({value:"",source:R(o[C.FIELDS.START_LINE],o[C.FIELDS.START_COL],l[C.FIELDS.END_LINE],l[C.FIELDS.END_COL]),sourceIndex:o[C.FIELDS.START_POS],spaces:{before:i,after:""}}))}return n},t.convertWhitespaceNodesToSpace=function(e,t){var n=this;void 0===t&&(t=!1);var i="",r="";return e.forEach((function(e){var s=n.lossySpace(e.spaces.before,t),o=n.lossySpace(e.rawSpaceBefore,t);i+=s+n.lossySpace(e.spaces.after,t&&0===s.length),r+=s+e.value+n.lossySpace(e.rawSpaceAfter,t&&0===o.length)})),r===i&&(r=void 0),{space:i,rawSpace:r}},t.isNamedCombinator=function(e){return void 0===e&&(e=this.position),this.tokens[e+0]&&this.tokens[e+0][C.FIELDS.TYPE]===m.slash&&this.tokens[e+1]&&this.tokens[e+1][C.FIELDS.TYPE]===m.word&&this.tokens[e+2]&&this.tokens[e+2][C.FIELDS.TYPE]===m.slash},t.namedCombinator=function(){if(this.isNamedCombinator()){var e=this.content(this.tokens[this.position+1]),t=(0,y.unesc)(e).toLowerCase(),n={};t!==e&&(n.value="/"+e+"/");var i=new h.default({value:"/"+t+"/",source:R(this.currToken[C.FIELDS.START_LINE],this.currToken[C.FIELDS.START_COL],this.tokens[this.position+2][C.FIELDS.END_LINE],this.tokens[this.position+2][C.FIELDS.END_COL]),sourceIndex:this.currToken[C.FIELDS.START_POS],raws:n});return this.position=this.position+3,i}this.unexpected()},t.combinator=function(){var e=this;if("|"===this.content())return this.namespace();var t=this.locateNextMeaningfulToken(this.position);if(!(t<0||this.tokens[t][C.FIELDS.TYPE]===m.comma)){var n,i=this.currToken,r=void 0;if(t>this.position&&(r=this.parseWhitespaceEquivalentTokens(t)),this.isNamedCombinator()?n=this.namedCombinator():this.currToken[C.FIELDS.TYPE]===m.combinator?(n=new h.default({value:this.content(),source:Z(this.currToken),sourceIndex:this.currToken[C.FIELDS.START_POS]}),this.position++):G[this.currToken[C.FIELDS.TYPE]]||r||this.unexpected(),n){if(r){var s=this.convertWhitespaceNodesToSpace(r),o=s.space,a=s.rawSpace;n.spaces.before=o,n.rawSpaceBefore=a}}else{var l=this.convertWhitespaceNodesToSpace(r,!0),c=l.space,g=l.rawSpace;g||(g=c);var u={},A={spaces:{}};c.endsWith(" ")&&g.endsWith(" ")?(u.before=c.slice(0,c.length-1),A.spaces.before=g.slice(0,g.length-1)):c.startsWith(" ")&&g.startsWith(" ")?(u.after=c.slice(1),A.spaces.after=g.slice(1)):A.value=g,n=new h.default({value:" ",source:D(i,this.tokens[this.position-1]),sourceIndex:i[C.FIELDS.START_POS],spaces:u,raws:A})}return this.currToken&&this.currToken[C.FIELDS.TYPE]===m.space&&(n.spaces.after=this.optionalSpace(this.content()),this.position++),this.newNode(n)}var d=this.parseWhitespaceEquivalentTokens(t);if(d.length>0){var I=this.current.last;if(I){var p=this.convertWhitespaceNodesToSpace(d),f=p.space,y=p.rawSpace;void 0!==y&&(I.rawSpaceAfter+=y),I.spaces.after+=f}else d.forEach((function(t){return e.newNode(t)}))}},t.comma=function(){if(this.position===this.tokens.length-1)return this.root.trailingComma=!0,void this.position++;this.current._inferEndPosition();var e=new s.default({source:{start:x(this.tokens[this.position+1])}});this.current.parent.append(e),this.current=e,this.position++},t.comment=function(){var e=this.currToken;this.newNode(new a.default({value:this.content(),source:Z(e),sourceIndex:e[C.FIELDS.START_POS]})),this.position++},t.error=function(e,t){throw this.root.error(e,t)},t.missingBackslash=function(){return this.error("Expected a backslash preceding the semicolon.",{index:this.currToken[C.FIELDS.START_POS]})},t.missingParenthesis=function(){return this.expected("opening parenthesis",this.currToken[C.FIELDS.START_POS])},t.missingSquareBracket=function(){return this.expected("opening square bracket",this.currToken[C.FIELDS.START_POS])},t.unexpected=function(){return this.error("Unexpected '"+this.content()+"'. Escaping special characters with \\ may help.",this.currToken[C.FIELDS.START_POS])},t.unexpectedPipe=function(){return this.error("Unexpected '|'.",this.currToken[C.FIELDS.START_POS])},t.namespace=function(){var e=this.prevToken&&this.content(this.prevToken)||!0;return this.nextToken[C.FIELDS.TYPE]===m.word?(this.position++,this.word(e)):this.nextToken[C.FIELDS.TYPE]===m.asterisk?(this.position++,this.universal(e)):void this.unexpectedPipe()},t.nesting=function(){if(this.nextToken&&"|"===this.content(this.nextToken))return void this.position++;var e=this.currToken;this.newNode(new I.default({value:this.content(),source:Z(e),sourceIndex:e[C.FIELDS.START_POS]})),this.position++},t.parentheses=function(){var e=this.current.last,t=1;if(this.position++,e&&e.type===f.PSEUDO){var n=new s.default({source:{start:x(this.tokens[this.position-1])}}),i=this.current;for(e.append(n),this.current=n;this.position<this.tokens.length&&t;)this.currToken[C.FIELDS.TYPE]===m.openParenthesis&&t++,this.currToken[C.FIELDS.TYPE]===m.closeParenthesis&&t--,t?this.parse():(this.current.source.end=S(this.currToken),this.current.parent.source.end=S(this.currToken),this.position++);this.current=i}else{for(var r,o=this.currToken,a="(";this.position<this.tokens.length&&t;)this.currToken[C.FIELDS.TYPE]===m.openParenthesis&&t++,this.currToken[C.FIELDS.TYPE]===m.closeParenthesis&&t--,r=this.currToken,a+=this.parseParenthesisToken(this.currToken),this.position++;e?e.appendToPropertyAndEscape("value",a,a):this.newNode(new g.default({value:a,source:R(o[C.FIELDS.START_LINE],o[C.FIELDS.START_COL],r[C.FIELDS.END_LINE],r[C.FIELDS.END_COL]),sourceIndex:o[C.FIELDS.START_POS]}))}if(t)return this.expected("closing parenthesis",this.currToken[C.FIELDS.START_POS])},t.pseudo=function(){for(var e=this,t="",n=this.currToken;this.currToken&&this.currToken[C.FIELDS.TYPE]===m.colon;)t+=this.content(),this.position++;return this.currToken?this.currToken[C.FIELDS.TYPE]!==m.word?this.expected(["pseudo-class","pseudo-element"],this.currToken[C.FIELDS.START_POS]):void this.splitWord(!1,(function(i,r){t+=i,e.newNode(new u.default({value:t,source:D(n,e.currToken),sourceIndex:n[C.FIELDS.START_POS]})),r>1&&e.nextToken&&e.nextToken[C.FIELDS.TYPE]===m.openParenthesis&&e.error("Misplaced parenthesis.",{index:e.nextToken[C.FIELDS.START_POS]})})):this.expected(["pseudo-class","pseudo-element"],this.position-1)},t.space=function(){var e=this.content();0===this.position||this.prevToken[C.FIELDS.TYPE]===m.comma||this.prevToken[C.FIELDS.TYPE]===m.openParenthesis||this.current.nodes.every((function(e){return"comment"===e.type}))?(this.spaces=this.optionalSpace(e),this.position++):this.position===this.tokens.length-1||this.nextToken[C.FIELDS.TYPE]===m.comma||this.nextToken[C.FIELDS.TYPE]===m.closeParenthesis?(this.current.last.spaces.after=this.optionalSpace(e),this.position++):this.combinator()},t.string=function(){var e=this.currToken;this.newNode(new g.default({value:this.content(),source:Z(e),sourceIndex:e[C.FIELDS.START_POS]})),this.position++},t.universal=function(e){var t=this.nextToken;if(t&&"|"===this.content(t))return this.position++,this.namespace();var n=this.currToken;this.newNode(new d.default({value:this.content(),source:Z(n),sourceIndex:n[C.FIELDS.START_POS]}),e),this.position++},t.splitWord=function(e,t){for(var n=this,i=this.nextToken,r=this.content();i&&~[m.dollar,m.caret,m.equals,m.word].indexOf(i[C.FIELDS.TYPE]);){this.position++;var s=this.content();if(r+=s,s.lastIndexOf("\\")===s.length-1){var a=this.nextToken;a&&a[C.FIELDS.TYPE]===m.space&&(r+=this.requiredSpace(this.content(a)),this.position++)}i=this.nextToken}var g=N(r,".").filter((function(e){var t="\\"===r[e-1],n=/^\d+\.\d+%$/.test(r);return!t&&!n})),u=N(r,"#").filter((function(e){return"\\"!==r[e-1]})),A=N(r,"#{");A.length&&(u=u.filter((function(e){return!~A.indexOf(e)})));var d=(0,p.default)(function(){var e=Array.prototype.concat.apply([],arguments);return e.filter((function(t,n){return n===e.indexOf(t)}))}([0].concat(g,u)));d.forEach((function(i,s){var a=d[s+1]||r.length,A=r.slice(i,a);if(0===s&&t)return t.call(n,A,d.length);var h,I=n.currToken,p=I[C.FIELDS.START_POS]+d[s],m=R(I[1],I[2]+i,I[3],I[2]+(a-1));if(~g.indexOf(i)){var f={value:A.slice(1),source:m,sourceIndex:p};h=new o.default(F(f,"value"))}else if(~u.indexOf(i)){var y={value:A.slice(1),source:m,sourceIndex:p};h=new l.default(F(y,"value"))}else{var b={value:A,source:m,sourceIndex:p};F(b,"value"),h=new c.default(b)}n.newNode(h,e),e=null})),this.position++},t.word=function(e){var t=this.nextToken;return t&&"|"===this.content(t)?(this.position++,this.namespace()):this.splitWord(e)},t.loop=function(){for(;this.position<this.tokens.length;)this.parse(!0);return this.current._inferEndPosition(),this.root},t.parse=function(e){switch(this.currToken[C.FIELDS.TYPE]){case m.space:this.space();break;case m.comment:this.comment();break;case m.openParenthesis:this.parentheses();break;case m.closeParenthesis:e&&this.missingParenthesis();break;case m.openSquare:this.attribute();break;case m.dollar:case m.caret:case m.equals:case m.word:this.word();break;case m.colon:this.pseudo();break;case m.comma:this.comma();break;case m.asterisk:this.universal();break;case m.ampersand:this.nesting();break;case m.slash:case m.combinator:this.combinator();break;case m.str:this.string();break;case m.closeSquare:this.missingSquareBracket();case m.semicolon:this.missingBackslash();default:this.unexpected()}},t.expected=function(e,t,n){if(Array.isArray(e)){var i=e.pop();e=e.join(", ")+" or "+i}var r=/^[aeiou]/.test(e[0])?"an":"a";return n?this.error("Expected "+r+" "+e+', found "'+n+'" instead.',{index:t}):this.error("Expected "+r+" "+e+".",{index:t})},t.requiredSpace=function(e){return this.options.lossy?" ":e},t.optionalSpace=function(e){return this.options.lossy?"":e},t.lossySpace=function(e,t){return this.options.lossy?t?" ":"":e},t.parseParenthesisToken=function(e){var t=this.content(e);return e[C.FIELDS.TYPE]===m.space?this.requiredSpace(t):t},t.newNode=function(e,t){return t&&(/^ +$/.test(t)&&(this.options.lossy||(this.spaces=(this.spaces||"")+t),t=!0),e.namespace=t,F(e,"namespace")),this.spaces&&(e.spaces.before=this.spaces,this.spaces=""),this.current.append(e)},t.content=function(e){return void 0===e&&(e=this.currToken),this.css.slice(e[C.FIELDS.START_POS],e[C.FIELDS.END_POS])},t.locateNextMeaningfulToken=function(e){void 0===e&&(e=this.position+1);for(var t=e;t<this.tokens.length;){if(E[this.tokens[t][C.FIELDS.TYPE]]){t++;continue}return t}return-1},function(e,t,n){t&&w(e.prototype,t),n&&w(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"currToken",get:function(){return this.tokens[this.position]}},{key:"nextToken",get:function(){return this.tokens[this.position+1]}},{key:"prevToken",get:function(){return this.tokens[this.position-1]}}]),e}();e.default=M,t.exports=e.default})),IM=UF(((e,t)=>{e.__esModule=!0,e.default=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(hM());var i=function(){function e(e,t){this.func=e||function(){},this.funcRes=null,this.options=t}var t=e.prototype;return t._shouldUpdateSelector=function(e,t){return void 0===t&&(t={}),!1!==Object.assign({},this.options,t).updateSelector&&"string"!=typeof e},t._isLossy=function(e){return void 0===e&&(e={}),!1===Object.assign({},this.options,e).lossless},t._root=function(e,t){return void 0===t&&(t={}),new n.default(e,this._parseOptions(t)).root},t._parseOptions=function(e){return{lossy:this._isLossy(e)}},t._run=function(e,t){var n=this;return void 0===t&&(t={}),new Promise((function(i,r){try{var s=n._root(e,t);Promise.resolve(n.func(s)).then((function(i){var r=void 0;return n._shouldUpdateSelector(e,t)&&(r=s.toString(),e.selector=r),{transform:i,root:s,string:r}})).then(i,r)}catch(Nx){return void r(Nx)}}))},t._runSync=function(e,t){void 0===t&&(t={});var n=this._root(e,t),i=this.func(n);if(i&&"function"==typeof i.then)throw new Error("Selector processor returned a promise to a synchronous call.");var r=void 0;return t.updateSelector&&"string"!=typeof e&&(r=n.toString(),e.selector=r),{transform:i,root:n,string:r}},t.ast=function(e,t){return this._run(e,t).then((function(e){return e.root}))},t.astSync=function(e,t){return this._runSync(e,t).root},t.transform=function(e,t){return this._run(e,t).then((function(e){return e.transform}))},t.transformSync=function(e,t){return this._runSync(e,t).transform},t.process=function(e,t){return this._run(e,t).then((function(e){return e.string||e.root.toString()}))},t.processSync=function(e,t){var n=this._runSync(e,t);return n.string||n.root.toString()},e}();e.default=i,t.exports=e.default})),pM=UF((e=>{e.__esModule=!0,e.universal=e.tag=e.string=e.selector=e.root=e.pseudo=e.nesting=e.id=e.comment=e.combinator=e.className=e.attribute=void 0;var t=d(aM()),n=d($N()),i=d(cM()),r=d(eM()),s=d(tM()),o=d(gM()),a=d(sM()),l=d(JN()),c=d(jN()),g=d(rM()),u=d(iM()),A=d(lM());function d(e){return e&&e.__esModule?e:{default:e}}e.attribute=function(e){return new t.default(e)};e.className=function(e){return new n.default(e)};e.combinator=function(e){return new i.default(e)};e.comment=function(e){return new r.default(e)};e.id=function(e){return new s.default(e)};e.nesting=function(e){return new o.default(e)};e.pseudo=function(e){return new a.default(e)};e.root=function(e){return new l.default(e)};e.selector=function(e){return new c.default(e)};e.string=function(e){return new g.default(e)};e.tag=function(e){return new u.default(e)};e.universal=function(e){return new A.default(e)}})),CM=UF((e=>{e.__esModule=!0,e.isComment=e.isCombinator=e.isClassName=e.isAttribute=void 0,e.isContainer=function(e){return!(!r(e)||!e.walk)},e.isIdentifier=void 0,e.isNamespace=function(e){return o(e)||p(e)},e.isNesting=void 0,e.isNode=r,e.isPseudo=void 0,e.isPseudoClass=function(e){return A(e)&&!m(e)},e.isPseudoElement=m,e.isUniversal=e.isTag=e.isString=e.isSelector=e.isRoot=void 0;var t,n=_N(),i=((t={})[n.ATTRIBUTE]=!0,t[n.CLASS]=!0,t[n.COMBINATOR]=!0,t[n.COMMENT]=!0,t[n.ID]=!0,t[n.NESTING]=!0,t[n.PSEUDO]=!0,t[n.ROOT]=!0,t[n.SELECTOR]=!0,t[n.STRING]=!0,t[n.TAG]=!0,t[n.UNIVERSAL]=!0,t);function r(e){return"object"==typeof e&&i[e.type]}function s(e,t){return r(t)&&t.type===e}var o=s.bind(null,n.ATTRIBUTE);e.isAttribute=o;var a=s.bind(null,n.CLASS);e.isClassName=a;var l=s.bind(null,n.COMBINATOR);e.isCombinator=l;var c=s.bind(null,n.COMMENT);e.isComment=c;var g=s.bind(null,n.ID);e.isIdentifier=g;var u=s.bind(null,n.NESTING);e.isNesting=u;var A=s.bind(null,n.PSEUDO);e.isPseudo=A;var d=s.bind(null,n.ROOT);e.isRoot=d;var h=s.bind(null,n.SELECTOR);e.isSelector=h;var I=s.bind(null,n.STRING);e.isString=I;var p=s.bind(null,n.TAG);e.isTag=p;var C=s.bind(null,n.UNIVERSAL);function m(e){return A(e)&&e.value&&(e.value.startsWith("::")||":before"===e.value.toLowerCase()||":after"===e.value.toLowerCase()||":first-letter"===e.value.toLowerCase()||":first-line"===e.value.toLowerCase())}e.isUniversal=C})),mM=UF((e=>{e.__esModule=!0;var t=_N();Object.keys(t).forEach((function(n){"default"===n||"__esModule"===n||n in e&&e[n]===t[n]||(e[n]=t[n])}));var n=pM();Object.keys(n).forEach((function(t){"default"===t||"__esModule"===t||t in e&&e[t]===n[t]||(e[t]=n[t])}));var i=CM();Object.keys(i).forEach((function(t){"default"===t||"__esModule"===t||t in e&&e[t]===i[t]||(e[t]=i[t])}))})),fM=UF(((e,t)=>{e.__esModule=!0,e.default=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(IM()),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=r(t);if(n&&n.has(e))return n.get(e);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=s?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(i,o,a):i[o]=e[o]}return i.default=e,n&&n.set(e,i),i}(mM());function r(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(r=function(e){return e?n:t})(e)}var s=function(e){return new n.default(e)};Object.assign(s,i),delete s.__esModule;var o=s;e.default=o,t.exports=e.default})),yM=UF(((e,t)=>{var{Rule:n,AtRule:i}=QN(),r=fM();function s(e,t){let n;try{r((e=>{n=e})).processSync(e)}catch(xx){throw e.includes(":")?t?t.error("Missed semicolon"):xx:t?t.error(xx.message):xx}return n.at(0)}function o(e,t){let n=!1;return e.each((e=>{if("nesting"===e.type){let i=t.clone({});"&"!==e.value?e.replaceWith(s(e.value.replace("&",i.toString()))):e.replaceWith(i),n=!0}else"nodes"in e&&e.nodes&&o(e,t)&&(n=!0)})),n}function a(e,t){let n=[];return e.selectors.forEach((i=>{let a=s(i,e);t.selectors.forEach((e=>{if(!e)return;let i=s(e,t);o(i,a)||(i.prepend(r.combinator({value:" "})),i.prepend(a.clone({}))),n.push(i.toString())}))})),n}function l(e,t){let n=e.prev();for(t.after(e);n&&"comment"===n.type;){let e=n.prev();t.after(n),n=e}return e}function c(e,t,i){let r=new n({selector:e,nodes:[]});return r.append(t),i.after(r),r}function g(e,t){let n={};for(let i of e)n[i]=!0;if(t)for(let i of t)n[i.replace(/^@/,"")]=!0;return n}function u(e){let t=e[d];if(t){let n,r,s,o,a=e.nodes,l=-1,c=function(e){let t=[],n=e.parent;for(;n&&n instanceof i;)t.push(n),n=n.parent;return t}(e);if(c.forEach(((e,i)=>{if(t(e.name))n=e,l=i,s=o;else{let t=o;o=e.clone({nodes:[]}),t&&o.append(t),r=r||o}})),n?s?(r.append(a),n.after(s)):n.after(a):e.after(a),e.next()&&n){let t;c.slice(0,l+1).forEach(((n,i,r)=>{let s=t;t=n.clone({nodes:[]}),s&&t.append(s);let o=[],a=(r[i-1]||e).next();for(;a;)o.push(a),a=a.next();t.append(o)})),t&&(s||a[a.length-1]).after(t)}}else e.after(e.nodes);e.remove()}var A=Symbol("rootRuleMergeSel"),d=Symbol("rootRuleEscapes");function h(e){let{params:t}=e,{type:i,selector:r,escapes:s}=function(e){let t=(e=e.trim()).match(/^\((.*)\)$/);if(!t)return{type:"basic",selector:e};let n=t[1].match(/^(with(?:out)?):(.+)$/);if(n){let e="with"===n[1],t=Object.fromEntries(n[2].trim().split(/\s+/).map((e=>[e,!0])));if(e&&t.all)return{type:"noop"};let i=e=>!!t[e];return t.all?i=()=>!0:e&&(i=e=>"all"!==e&&!t[e]),{type:"withrules",escapes:i}}return{type:"unknown"}}(t);if("unknown"===i)throw e.error("Unknown @".concat(e.name," parameter ").concat(JSON.stringify(t)));if("basic"===i&&r){let t=new n({selector:r,nodes:e.nodes});e.removeAll(),e.append(t)}e[d]=s,e[A]=s?!s("all"):"noop"===i}var I=Symbol("hasRootRule");t.exports=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=g(["media","supports","layer","container"],e.bubble),n=function(e){return function t(n,i,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r,o=[];if(i.each((l=>{"rule"===l.type&&r?s&&(l.selectors=a(n,l)):"atrule"===l.type&&l.nodes?e[l.name]?t(n,l,s):!1!==i[A]&&o.push(l):o.push(l)})),r&&o.length){let e=n.clone({nodes:[]});for(let t of o)e.append(t);i.prepend(e)}}}(t),i=g(["document","font-face","keyframes","-webkit-keyframes","-moz-keyframes"],e.unwrap),r=(e.rootRuleName||"at-root").replace(/^@/,""),s=e.preserveEmpty;return{postcssPlugin:"postcss-nested",Once(e){e.walkAtRules(r,(t=>{h(t),e[I]=!0}))},Rule(e){let o=!1,g=e,u=!1,d=[];e.each((s=>{"rule"===s.type?(d.length&&(g=c(e.selector,d,g),d=[]),u=!0,o=!0,s.selectors=a(e,s),g=l(s,g)):"atrule"===s.type?(d.length&&(g=c(e.selector,d,g),d=[]),s.name===r?(o=!0,n(e,s,!0,s[A]),g=l(s,g)):t[s.name]?(u=!0,o=!0,n(e,s,!0),g=l(s,g)):i[s.name]?(u=!0,o=!0,n(e,s,!1),g=l(s,g)):u&&d.push(s)):"decl"===s.type&&u&&d.push(s)})),d.length&&(g=c(e.selector,d,g)),o&&!0!==s&&(e.raws.semicolon=!0,0===e.nodes.length&&e.remove())},RootExit(e){e[I]&&(e.walkAtRules(r,u),e[I]=!1)}}},t.exports.postcss=!0})),bM=UF(((e,t)=>{var n=/-(\w|$)/g,i=function(e,t){return t.toUpperCase()};t.exports=function(e){return"float"===(e=e.toLowerCase())?"cssFloat":45===e.charCodeAt(0)&&109===e.charCodeAt(1)&&115===e.charCodeAt(2)&&45===e.charCodeAt(3)?e.substr(1).replace(n,i):e.replace(n,i)}})),BM=UF(((e,t)=>{var n=bM(),i={boxFlex:!0,boxFlexGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0};function r(e){return typeof e.nodes>"u"||s(e)}function s(e){let t,o={};return e.each((e=>{if("atrule"===e.type)t="@"+e.name,e.params&&(t+=" "+e.params),typeof o[t]>"u"?o[t]=r(e):Array.isArray(o[t])?o[t].push(r(e)):o[t]=[o[t],r(e)];else if("rule"===e.type){let t=s(e);if(o[e.selector])for(let n in t)o[e.selector][n]=t[n];else o[e.selector]=t}else if("decl"===e.type){t="-"===e.prop[0]&&"-"===e.prop[1]||e.parent&&":export"===e.parent.selector?e.prop:n(e.prop);let r=e.value;!isNaN(e.value)&&i[t]&&(r=parseFloat(e.value)),e.important&&(r+=" !important"),typeof o[t]>"u"?o[t]=r:Array.isArray(o[t])?o[t].push(r):o[t]=[o[t],r]}})),o}t.exports=s})),vM=UF(((e,t)=>{var n=QN(),i=/\s*!important\s*$/i,r={"box-flex":!0,"box-flex-group":!0,"column-count":!0,flex:!0,"flex-grow":!0,"flex-positive":!0,"flex-shrink":!0,"flex-negative":!0,"font-weight":!0,"line-clamp":!0,"line-height":!0,opacity:!0,order:!0,orphans:!0,"tab-size":!0,widows:!0,"z-index":!0,zoom:!0,"fill-opacity":!0,"stroke-dashoffset":!0,"stroke-opacity":!0,"stroke-width":!0};function s(e,t,s){!1===s||null===s||(t.startsWith("--")||(t=function(e){return e.replace(/([A-Z])/g,"-$1").replace(/^ms-/,"-ms-").toLowerCase()}(t)),"number"==typeof s&&(0===s||r[t]?s=s.toString():s+="px"),"css-float"===t&&(t="float"),i.test(s)?(s=s.replace(i,""),e.push(n.decl({prop:t,value:s,important:!0}))):e.push(n.decl({prop:t,value:s})))}function o(e,t,i){let r=n.atRule({name:t[1],params:t[3]||""});"object"==typeof i&&(r.nodes=[],a(i,r)),e.push(r)}function a(e,t){let i,r,l;for(i in e)if(r=e[i],!(null===r||typeof r>"u"))if("@"===i[0]){let e=i.match(/@(\S+)(\s+([\W\w]*)\s*)?/);if(Array.isArray(r))for(let n of r)o(t,e,n);else o(t,e,r)}else if(Array.isArray(r))for(let e of r)s(t,i,e);else"object"==typeof r?(l=n.rule({selector:i}),a(r,l),t.push(l)):s(t,i,r)}t.exports=function(e){let t=n.root();return a(e,t),t}})),wM=UF(((e,t)=>{var n=BM();t.exports=function(e){return console&&console.warn&&e.warnings().forEach((e=>{let t=e.plugin||"PostCSS";console.warn(t+": "+e.text)})),n(e.root)}})),GM=UF(((e,t)=>{var n=QN(),i=wM(),r=vM();t.exports=function(e){let t=n(e);return async e=>{let n=await t.process(e,{parser:r,from:void 0});return i(n)}}})),EM=UF(((e,t)=>{var n=QN(),i=wM(),r=vM();t.exports=function(e){let t=n(e);return e=>{let n=t.process(e,{parser:r,from:void 0});return i(n)}}})),xM=UF(((e,t)=>{var n=BM(),i=vM(),r=GM(),s=EM();t.exports={objectify:n,parse:i,async:r,sync:s}})),SM=UF(((e,t)=>{!function(n){"object"==typeof e&&typeof t<"u"?t.exports=function(e,t,n,i,r){for(t=t.split?t.split("."):t,i=0;i<t.length;i++)e=e?e[t[i]]:r;return e===r?n:e}:"function"==typeof define&&define.amd?define((function(){return function(e,t,n,i,r){for(t=t.split?t.split("."):t,i=0;i<t.length;i++)e=e?e[t[i]]:r;return e===r?n:e}})):n.dlv=function(e,t,n,i,r){for(t=t.split?t.split("."):t,i=0;i<t.length;i++)e=e?e[t[i]]:r;return e===r?n:e}}(e)})),RM=UF(((e,t)=>{!function(){function e(t,n,r){if(!t)return null;e.caseSensitive||(t=t.toLowerCase());var s,o=null===e.threshold?null:e.threshold*t.length,a=e.thresholdAbsolute;s=null!==o&&null!==a?Math.min(o,a):null!==o?o:null!==a?a:null;var l,c,g,u,A=n.length;for(u=0;u<A;u++)if(c=n[u],r&&(c=c[r]),c&&(g=i(t,e.caseSensitive?c:c.toLowerCase(),s),(null===s||g<s)&&(s=g,l=r&&e.returnWinningObject?n[u]:c,e.returnFirstMatch)))return l;return l||e.nullResultValue}e.threshold=.4,e.thresholdAbsolute=20,e.caseSensitive=!1,e.nullResultValue=null,e.returnWinningObject=null,e.returnFirstMatch=!1,typeof t<"u"&&t.exports?t.exports=e:window.didYouMean=e;var n=Math.pow(2,32)-1;function i(e,t,i){i=i||0===i?i:n;var r=e.length,s=t.length;if(0===r)return Math.min(i+1,s);if(0===s)return Math.min(i+1,r);if(Math.abs(r-s)>i)return i+1;var o,a,l,c,g,u=[];for(o=0;o<=s;o++)u[o]=[o];for(a=0;a<=r;a++)u[0][a]=a;for(o=1;o<=s;o++){for(l=n,c=1,o>i&&(c=o-i),(g=s+1)>i+o&&(g=i+o),a=1;a<=r;a++)a<c||a>g?u[o][a]=i+1:t.charAt(o-1)===e.charAt(a-1)?u[o][a]=u[o-1][a-1]:u[o][a]=Math.min(u[o-1][a-1]+1,Math.min(u[o][a-1]+1,u[o-1][a]+1)),u[o][a]<l&&(l=u[o][a]);if(l>i)return i+1}return u[s][r]}}()})),ZM=UF(((e,t)=>{var n="(".charCodeAt(0),i=")".charCodeAt(0),r="'".charCodeAt(0),s='"'.charCodeAt(0),o="\\".charCodeAt(0),a="/".charCodeAt(0),l=",".charCodeAt(0),c=":".charCodeAt(0),g="*".charCodeAt(0),u="u".charCodeAt(0),A="U".charCodeAt(0),d="+".charCodeAt(0),h=/^[a-f0-9?-]+$/i;t.exports=function(e){for(var t,I,p,C,m,f,y,b,B,v=[],w=e,G=0,E=w.charCodeAt(G),x=w.length,S=[{nodes:v}],R=0,Z="",D="",F="";G<x;)if(E<=32){t=G;do{t+=1,E=w.charCodeAt(t)}while(E<=32);C=w.slice(G,t),p=v[v.length-1],E===i&&R?F=C:p&&"div"===p.type?(p.after=C,p.sourceEndIndex+=C.length):E===l||E===c||E===a&&w.charCodeAt(t+1)!==g&&(!B||B&&"function"===B.type&&"calc"!==B.value)?D=C:v.push({type:"space",sourceIndex:G,sourceEndIndex:t,value:C}),G=t}else if(E===r||E===s){t=G,C={type:"string",sourceIndex:G,quote:I=E===r?"'":'"'};do{if(m=!1,~(t=w.indexOf(I,t+1)))for(f=t;w.charCodeAt(f-1)===o;)f-=1,m=!m;else t=(w+=I).length-1,C.unclosed=!0}while(m);C.value=w.slice(G+1,t),C.sourceEndIndex=C.unclosed?t:t+1,v.push(C),G=t+1,E=w.charCodeAt(G)}else if(E===a&&w.charCodeAt(G+1)===g)C={type:"comment",sourceIndex:G,sourceEndIndex:(t=w.indexOf("*/",G))+2},-1===t&&(C.unclosed=!0,t=w.length,C.sourceEndIndex=t),C.value=w.slice(G+2,t),v.push(C),G=t+2,E=w.charCodeAt(G);else if(E!==a&&E!==g||!B||"function"!==B.type||"calc"!==B.value)if(E===a||E===l||E===c)C=w[G],v.push({type:"div",sourceIndex:G-D.length,sourceEndIndex:G+C.length,value:C,before:D,after:""}),D="",G+=1,E=w.charCodeAt(G);else if(n===E){t=G;do{t+=1,E=w.charCodeAt(t)}while(E<=32);if(b=G,C={type:"function",sourceIndex:G-Z.length,value:Z,before:w.slice(b+1,t)},G=t,"url"===Z&&E!==r&&E!==s){t-=1;do{if(m=!1,~(t=w.indexOf(")",t+1)))for(f=t;w.charCodeAt(f-1)===o;)f-=1,m=!m;else t=(w+=")").length-1,C.unclosed=!0}while(m);y=t;do{y-=1,E=w.charCodeAt(y)}while(E<=32);b<y?(C.nodes=G!==y+1?[{type:"word",sourceIndex:G,sourceEndIndex:y+1,value:w.slice(G,y+1)}]:[],C.unclosed&&y+1!==t?(C.after="",C.nodes.push({type:"space",sourceIndex:y+1,sourceEndIndex:t,value:w.slice(y+1,t)})):(C.after=w.slice(y+1,t),C.sourceEndIndex=t)):(C.after="",C.nodes=[]),G=t+1,C.sourceEndIndex=C.unclosed?t:G,E=w.charCodeAt(G),v.push(C)}else R+=1,C.after="",C.sourceEndIndex=G+1,v.push(C),S.push(C),v=C.nodes=[],B=C;Z=""}else if(i===E&&R)G+=1,E=w.charCodeAt(G),B.after=F,B.sourceEndIndex+=F.length,F="",R-=1,S[S.length-1].sourceEndIndex=G,S.pop(),v=(B=S[R]).nodes;else{t=G;do{E===o&&(t+=1),t+=1,E=w.charCodeAt(t)}while(t<x&&!(E<=32||E===r||E===s||E===l||E===c||E===a||E===n||E===g&&B&&"function"===B.type&&"calc"===B.value||E===a&&"function"===B.type&&"calc"===B.value||E===i&&R));C=w.slice(G,t),n===E?Z=C:u!==C.charCodeAt(0)&&A!==C.charCodeAt(0)||d!==C.charCodeAt(1)||!h.test(C.slice(2))?v.push({type:"word",sourceIndex:G,sourceEndIndex:t,value:C}):v.push({type:"unicode-range",sourceIndex:G,sourceEndIndex:t,value:C}),G=t}else C=w[G],v.push({type:"word",sourceIndex:G-D.length,sourceEndIndex:G+C.length,value:C}),G+=1,E=w.charCodeAt(G);for(G=S.length-1;G;G-=1)S[G].unclosed=!0,S[G].sourceEndIndex=w.length;return S[0].nodes}})),DM=UF(((e,t)=>{t.exports=function e(t,n,i){var r,s,o,a;for(r=0,s=t.length;r<s;r+=1)o=t[r],i||(a=n(o,r,t)),!1!==a&&"function"===o.type&&Array.isArray(o.nodes)&&e(o.nodes,n,i),i&&n(o,r,t)}})),FM=UF(((e,t)=>{function n(e,t){var n,r,s=e.type,o=e.value;return t&&void 0!==(r=t(e))?r:"word"===s||"space"===s?o:"string"===s?(n=e.quote||"")+o+(e.unclosed?"":n):"comment"===s?"/*"+o+(e.unclosed?"":"*/"):"div"===s?(e.before||"")+o+(e.after||""):Array.isArray(e.nodes)?(n=i(e.nodes,t),"function"!==s?n:o+"("+(e.before||"")+n+(e.after||"")+(e.unclosed?"":")")):o}function i(e,t){var i,r;if(Array.isArray(e)){for(i="",r=e.length-1;~r;r-=1)i=n(e[r],t)+i;return i}return n(e,t)}t.exports=i})),NM=UF(((e,t)=>{var n="-".charCodeAt(0),i="+".charCodeAt(0),r=".".charCodeAt(0),s="e".charCodeAt(0),o="E".charCodeAt(0);t.exports=function(e){var t,a,l,c=0,g=e.length;if(0===g||!function(e){var t,s=e.charCodeAt(0);if(s===i||s===n){if((t=e.charCodeAt(1))>=48&&t<=57)return!0;var o=e.charCodeAt(2);return t===r&&o>=48&&o<=57}return s===r?(t=e.charCodeAt(1))>=48&&t<=57:s>=48&&s<=57}(e))return!1;for(((t=e.charCodeAt(c))===i||t===n)&&c++;c<g&&!((t=e.charCodeAt(c))<48||t>57);)c+=1;if(t=e.charCodeAt(c),a=e.charCodeAt(c+1),t===r&&a>=48&&a<=57)for(c+=2;c<g&&!((t=e.charCodeAt(c))<48||t>57);)c+=1;if(t=e.charCodeAt(c),a=e.charCodeAt(c+1),l=e.charCodeAt(c+2),(t===s||t===o)&&(a>=48&&a<=57||(a===i||a===n)&&l>=48&&l<=57))for(c+=a===i||a===n?3:2;c<g&&!((t=e.charCodeAt(c))<48||t>57);)c+=1;return{number:e.slice(0,c),unit:e.slice(c)}}})),MM=UF(((e,t)=>{var n=ZM(),i=DM(),r=FM();function s(e){return this instanceof s?(this.nodes=n(e),this):new s(e)}s.prototype.toString=function(){return Array.isArray(this.nodes)?r(this.nodes):""},s.prototype.walk=function(e,t){return i(this.nodes,e,t),this},s.unit=NM(),s.walk=i,s.stringify=r,t.exports=s})),WM=UF(((e,t)=>{t.exports={content:[],presets:[],darkMode:"media",theme:{accentColor:e=>{let{theme:t}=e;return{...t("colors"),auto:"auto"}},animation:{none:"none",spin:"spin 1s linear infinite",ping:"ping 1s cubic-bezier(0, 0, 0.2, 1) infinite",pulse:"pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite",bounce:"bounce 1s infinite"},aria:{checked:'checked="true"',disabled:'disabled="true"',expanded:'expanded="true"',hidden:'hidden="true"',pressed:'pressed="true"',readonly:'readonly="true"',required:'required="true"',selected:'selected="true"'},aspectRatio:{auto:"auto",square:"1 / 1",video:"16 / 9"},backdropBlur:e=>{let{theme:t}=e;return t("blur")},backdropBrightness:e=>{let{theme:t}=e;return t("brightness")},backdropContrast:e=>{let{theme:t}=e;return t("contrast")},backdropGrayscale:e=>{let{theme:t}=e;return t("grayscale")},backdropHueRotate:e=>{let{theme:t}=e;return t("hueRotate")},backdropInvert:e=>{let{theme:t}=e;return t("invert")},backdropOpacity:e=>{let{theme:t}=e;return t("opacity")},backdropSaturate:e=>{let{theme:t}=e;return t("saturate")},backdropSepia:e=>{let{theme:t}=e;return t("sepia")},backgroundColor:e=>{let{theme:t}=e;return t("colors")},backgroundImage:{none:"none","gradient-to-t":"linear-gradient(to top, var(--tw-gradient-stops))","gradient-to-tr":"linear-gradient(to top right, var(--tw-gradient-stops))","gradient-to-r":"linear-gradient(to right, var(--tw-gradient-stops))","gradient-to-br":"linear-gradient(to bottom right, var(--tw-gradient-stops))","gradient-to-b":"linear-gradient(to bottom, var(--tw-gradient-stops))","gradient-to-bl":"linear-gradient(to bottom left, var(--tw-gradient-stops))","gradient-to-l":"linear-gradient(to left, var(--tw-gradient-stops))","gradient-to-tl":"linear-gradient(to top left, var(--tw-gradient-stops))"},backgroundOpacity:e=>{let{theme:t}=e;return t("opacity")},backgroundPosition:{bottom:"bottom",center:"center",left:"left","left-bottom":"left bottom","left-top":"left top",right:"right","right-bottom":"right bottom","right-top":"right top",top:"top"},backgroundSize:{auto:"auto",cover:"cover",contain:"contain"},blur:{0:"0",none:"0",sm:"4px",DEFAULT:"8px",md:"12px",lg:"16px",xl:"24px","2xl":"40px","3xl":"64px"},borderColor:e=>{let{theme:t}=e;return{...t("colors"),DEFAULT:t("colors.gray.200","currentColor")}},borderOpacity:e=>{let{theme:t}=e;return t("opacity")},borderRadius:{none:"0px",sm:"0.125rem",DEFAULT:"0.25rem",md:"0.375rem",lg:"0.5rem",xl:"0.75rem","2xl":"1rem","3xl":"1.5rem",full:"9999px"},borderSpacing:e=>{let{theme:t}=e;return{...t("spacing")}},borderWidth:{DEFAULT:"1px",0:"0px",2:"2px",4:"4px",8:"8px"},boxShadow:{sm:"0 1px 2px 0 rgb(0 0 0 / 0.05)",DEFAULT:"0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1)",md:"0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)",lg:"0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1)",xl:"0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1)","2xl":"0 25px 50px -12px rgb(0 0 0 / 0.25)",inner:"inset 0 2px 4px 0 rgb(0 0 0 / 0.05)",none:"none"},boxShadowColor:e=>{let{theme:t}=e;return t("colors")},brightness:{0:"0",50:".5",75:".75",90:".9",95:".95",100:"1",105:"1.05",110:"1.1",125:"1.25",150:"1.5",200:"2"},caretColor:e=>{let{theme:t}=e;return t("colors")},colors:e=>{let{colors:t}=e;return{inherit:t.inherit,current:t.current,transparent:t.transparent,black:t.black,white:t.white,slate:t.slate,gray:t.gray,zinc:t.zinc,neutral:t.neutral,stone:t.stone,red:t.red,orange:t.orange,amber:t.amber,yellow:t.yellow,lime:t.lime,green:t.green,emerald:t.emerald,teal:t.teal,cyan:t.cyan,sky:t.sky,blue:t.blue,indigo:t.indigo,violet:t.violet,purple:t.purple,fuchsia:t.fuchsia,pink:t.pink,rose:t.rose}},columns:{auto:"auto",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12","3xs":"16rem","2xs":"18rem",xs:"20rem",sm:"24rem",md:"28rem",lg:"32rem",xl:"36rem","2xl":"42rem","3xl":"48rem","4xl":"56rem","5xl":"64rem","6xl":"72rem","7xl":"80rem"},container:{},content:{none:"none"},contrast:{0:"0",50:".5",75:".75",100:"1",125:"1.25",150:"1.5",200:"2"},cursor:{auto:"auto",default:"default",pointer:"pointer",wait:"wait",text:"text",move:"move",help:"help","not-allowed":"not-allowed",none:"none","context-menu":"context-menu",progress:"progress",cell:"cell",crosshair:"crosshair","vertical-text":"vertical-text",alias:"alias",copy:"copy","no-drop":"no-drop",grab:"grab",grabbing:"grabbing","all-scroll":"all-scroll","col-resize":"col-resize","row-resize":"row-resize","n-resize":"n-resize","e-resize":"e-resize","s-resize":"s-resize","w-resize":"w-resize","ne-resize":"ne-resize","nw-resize":"nw-resize","se-resize":"se-resize","sw-resize":"sw-resize","ew-resize":"ew-resize","ns-resize":"ns-resize","nesw-resize":"nesw-resize","nwse-resize":"nwse-resize","zoom-in":"zoom-in","zoom-out":"zoom-out"},divideColor:e=>{let{theme:t}=e;return t("borderColor")},divideOpacity:e=>{let{theme:t}=e;return t("borderOpacity")},divideWidth:e=>{let{theme:t}=e;return t("borderWidth")},dropShadow:{sm:"0 1px 1px rgb(0 0 0 / 0.05)",DEFAULT:["0 1px 2px rgb(0 0 0 / 0.1)","0 1px 1px rgb(0 0 0 / 0.06)"],md:["0 4px 3px rgb(0 0 0 / 0.07)","0 2px 2px rgb(0 0 0 / 0.06)"],lg:["0 10px 8px rgb(0 0 0 / 0.04)","0 4px 3px rgb(0 0 0 / 0.1)"],xl:["0 20px 13px rgb(0 0 0 / 0.03)","0 8px 5px rgb(0 0 0 / 0.08)"],"2xl":"0 25px 25px rgb(0 0 0 / 0.15)",none:"0 0 #0000"},fill:e=>{let{theme:t}=e;return{none:"none",...t("colors")}},flex:{1:"1 1 0%",auto:"1 1 auto",initial:"0 1 auto",none:"none"},flexBasis:e=>{let{theme:t}=e;return{auto:"auto",...t("spacing"),"1/2":"50%","1/3":"33.333333%","2/3":"66.666667%","1/4":"25%","2/4":"50%","3/4":"75%","1/5":"20%","2/5":"40%","3/5":"60%","4/5":"80%","1/6":"16.666667%","2/6":"33.333333%","3/6":"50%","4/6":"66.666667%","5/6":"83.333333%","1/12":"8.333333%","2/12":"16.666667%","3/12":"25%","4/12":"33.333333%","5/12":"41.666667%","6/12":"50%","7/12":"58.333333%","8/12":"66.666667%","9/12":"75%","10/12":"83.333333%","11/12":"91.666667%",full:"100%"}},flexGrow:{0:"0",DEFAULT:"1"},flexShrink:{0:"0",DEFAULT:"1"},fontFamily:{sans:["ui-sans-serif","system-ui","-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial",'"Noto Sans"',"sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"','"Noto Color Emoji"'],serif:["ui-serif","Georgia","Cambria",'"Times New Roman"',"Times","serif"],mono:["ui-monospace","SFMono-Regular","Menlo","Monaco","Consolas",'"Liberation Mono"','"Courier New"',"monospace"]},fontSize:{xs:["0.75rem",{lineHeight:"1rem"}],sm:["0.875rem",{lineHeight:"1.25rem"}],base:["1rem",{lineHeight:"1.5rem"}],lg:["1.125rem",{lineHeight:"1.75rem"}],xl:["1.25rem",{lineHeight:"1.75rem"}],"2xl":["1.5rem",{lineHeight:"2rem"}],"3xl":["1.875rem",{lineHeight:"2.25rem"}],"4xl":["2.25rem",{lineHeight:"2.5rem"}],"5xl":["3rem",{lineHeight:"1"}],"6xl":["3.75rem",{lineHeight:"1"}],"7xl":["4.5rem",{lineHeight:"1"}],"8xl":["6rem",{lineHeight:"1"}],"9xl":["8rem",{lineHeight:"1"}]},fontWeight:{thin:"100",extralight:"200",light:"300",normal:"400",medium:"500",semibold:"600",bold:"700",extrabold:"800",black:"900"},gap:e=>{let{theme:t}=e;return t("spacing")},gradientColorStops:e=>{let{theme:t}=e;return t("colors")},gradientColorStopPositions:{"0%":"0%","5%":"5%","10%":"10%","15%":"15%","20%":"20%","25%":"25%","30%":"30%","35%":"35%","40%":"40%","45%":"45%","50%":"50%","55%":"55%","60%":"60%","65%":"65%","70%":"70%","75%":"75%","80%":"80%","85%":"85%","90%":"90%","95%":"95%","100%":"100%"},grayscale:{0:"0",DEFAULT:"100%"},gridAutoColumns:{auto:"auto",min:"min-content",max:"max-content",fr:"minmax(0, 1fr)"},gridAutoRows:{auto:"auto",min:"min-content",max:"max-content",fr:"minmax(0, 1fr)"},gridColumn:{auto:"auto","span-1":"span 1 / span 1","span-2":"span 2 / span 2","span-3":"span 3 / span 3","span-4":"span 4 / span 4","span-5":"span 5 / span 5","span-6":"span 6 / span 6","span-7":"span 7 / span 7","span-8":"span 8 / span 8","span-9":"span 9 / span 9","span-10":"span 10 / span 10","span-11":"span 11 / span 11","span-12":"span 12 / span 12","span-full":"1 / -1"},gridColumnEnd:{auto:"auto",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12",13:"13"},gridColumnStart:{auto:"auto",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12",13:"13"},gridRow:{auto:"auto","span-1":"span 1 / span 1","span-2":"span 2 / span 2","span-3":"span 3 / span 3","span-4":"span 4 / span 4","span-5":"span 5 / span 5","span-6":"span 6 / span 6","span-full":"1 / -1"},gridRowEnd:{auto:"auto",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7"},gridRowStart:{auto:"auto",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7"},gridTemplateColumns:{none:"none",1:"repeat(1, minmax(0, 1fr))",2:"repeat(2, minmax(0, 1fr))",3:"repeat(3, minmax(0, 1fr))",4:"repeat(4, minmax(0, 1fr))",5:"repeat(5, minmax(0, 1fr))",6:"repeat(6, minmax(0, 1fr))",7:"repeat(7, minmax(0, 1fr))",8:"repeat(8, minmax(0, 1fr))",9:"repeat(9, minmax(0, 1fr))",10:"repeat(10, minmax(0, 1fr))",11:"repeat(11, minmax(0, 1fr))",12:"repeat(12, minmax(0, 1fr))"},gridTemplateRows:{none:"none",1:"repeat(1, minmax(0, 1fr))",2:"repeat(2, minmax(0, 1fr))",3:"repeat(3, minmax(0, 1fr))",4:"repeat(4, minmax(0, 1fr))",5:"repeat(5, minmax(0, 1fr))",6:"repeat(6, minmax(0, 1fr))"},height:e=>{let{theme:t}=e;return{auto:"auto",...t("spacing"),"1/2":"50%","1/3":"33.333333%","2/3":"66.666667%","1/4":"25%","2/4":"50%","3/4":"75%","1/5":"20%","2/5":"40%","3/5":"60%","4/5":"80%","1/6":"16.666667%","2/6":"33.333333%","3/6":"50%","4/6":"66.666667%","5/6":"83.333333%",full:"100%",screen:"100vh",min:"min-content",max:"max-content",fit:"fit-content"}},hueRotate:{0:"0deg",15:"15deg",30:"30deg",60:"60deg",90:"90deg",180:"180deg"},inset:e=>{let{theme:t}=e;return{auto:"auto",...t("spacing"),"1/2":"50%","1/3":"33.333333%","2/3":"66.666667%","1/4":"25%","2/4":"50%","3/4":"75%",full:"100%"}},invert:{0:"0",DEFAULT:"100%"},keyframes:{spin:{to:{transform:"rotate(360deg)"}},ping:{"75%, 100%":{transform:"scale(2)",opacity:"0"}},pulse:{"50%":{opacity:".5"}},bounce:{"0%, 100%":{transform:"translateY(-25%)",animationTimingFunction:"cubic-bezier(0.8,0,1,1)"},"50%":{transform:"none",animationTimingFunction:"cubic-bezier(0,0,0.2,1)"}}},letterSpacing:{tighter:"-0.05em",tight:"-0.025em",normal:"0em",wide:"0.025em",wider:"0.05em",widest:"0.1em"},lineHeight:{none:"1",tight:"1.25",snug:"1.375",normal:"1.5",relaxed:"1.625",loose:"2",3:".75rem",4:"1rem",5:"1.25rem",6:"1.5rem",7:"1.75rem",8:"2rem",9:"2.25rem",10:"2.5rem"},listStyleType:{none:"none",disc:"disc",decimal:"decimal"},listStyleImage:{none:"none"},margin:e=>{let{theme:t}=e;return{auto:"auto",...t("spacing")}},lineClamp:{1:"1",2:"2",3:"3",4:"4",5:"5",6:"6"},maxHeight:e=>{let{theme:t}=e;return{...t("spacing"),none:"none",full:"100%",screen:"100vh",min:"min-content",max:"max-content",fit:"fit-content"}},maxWidth:e=>{let{theme:t,breakpoints:n}=e;return{none:"none",0:"0rem",xs:"20rem",sm:"24rem",md:"28rem",lg:"32rem",xl:"36rem","2xl":"42rem","3xl":"48rem","4xl":"56rem","5xl":"64rem","6xl":"72rem","7xl":"80rem",full:"100%",min:"min-content",max:"max-content",fit:"fit-content",prose:"65ch",...n(t("screens"))}},minHeight:{0:"0px",full:"100%",screen:"100vh",min:"min-content",max:"max-content",fit:"fit-content"},minWidth:{0:"0px",full:"100%",min:"min-content",max:"max-content",fit:"fit-content"},objectPosition:{bottom:"bottom",center:"center",left:"left","left-bottom":"left bottom","left-top":"left top",right:"right","right-bottom":"right bottom","right-top":"right top",top:"top"},opacity:{0:"0",5:"0.05",10:"0.1",20:"0.2",25:"0.25",30:"0.3",40:"0.4",50:"0.5",60:"0.6",70:"0.7",75:"0.75",80:"0.8",90:"0.9",95:"0.95",100:"1"},order:{first:"-9999",last:"9999",none:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12"},outlineColor:e=>{let{theme:t}=e;return t("colors")},outlineOffset:{0:"0px",1:"1px",2:"2px",4:"4px",8:"8px"},outlineWidth:{0:"0px",1:"1px",2:"2px",4:"4px",8:"8px"},padding:e=>{let{theme:t}=e;return t("spacing")},placeholderColor:e=>{let{theme:t}=e;return t("colors")},placeholderOpacity:e=>{let{theme:t}=e;return t("opacity")},ringColor:e=>{let{theme:t}=e;return{DEFAULT:t("colors.blue.500","#3b82f6"),...t("colors")}},ringOffsetColor:e=>{let{theme:t}=e;return t("colors")},ringOffsetWidth:{0:"0px",1:"1px",2:"2px",4:"4px",8:"8px"},ringOpacity:e=>{let{theme:t}=e;return{DEFAULT:"0.5",...t("opacity")}},ringWidth:{DEFAULT:"3px",0:"0px",1:"1px",2:"2px",4:"4px",8:"8px"},rotate:{0:"0deg",1:"1deg",2:"2deg",3:"3deg",6:"6deg",12:"12deg",45:"45deg",90:"90deg",180:"180deg"},saturate:{0:"0",50:".5",100:"1",150:"1.5",200:"2"},scale:{0:"0",50:".5",75:".75",90:".9",95:".95",100:"1",105:"1.05",110:"1.1",125:"1.25",150:"1.5"},screens:{sm:"640px",md:"768px",lg:"1024px",xl:"1280px","2xl":"1536px"},scrollMargin:e=>{let{theme:t}=e;return{...t("spacing")}},scrollPadding:e=>{let{theme:t}=e;return t("spacing")},sepia:{0:"0",DEFAULT:"100%"},skew:{0:"0deg",1:"1deg",2:"2deg",3:"3deg",6:"6deg",12:"12deg"},space:e=>{let{theme:t}=e;return{...t("spacing")}},spacing:{px:"1px",0:"0px",.5:"0.125rem",1:"0.25rem",1.5:"0.375rem",2:"0.5rem",2.5:"0.625rem",3:"0.75rem",3.5:"0.875rem",4:"1rem",5:"1.25rem",6:"1.5rem",7:"1.75rem",8:"2rem",9:"2.25rem",10:"2.5rem",11:"2.75rem",12:"3rem",14:"3.5rem",16:"4rem",20:"5rem",24:"6rem",28:"7rem",32:"8rem",36:"9rem",40:"10rem",44:"11rem",48:"12rem",52:"13rem",56:"14rem",60:"15rem",64:"16rem",72:"18rem",80:"20rem",96:"24rem"},stroke:e=>{let{theme:t}=e;return{none:"none",...t("colors")}},strokeWidth:{0:"0",1:"1",2:"2"},supports:{},data:{},textColor:e=>{let{theme:t}=e;return t("colors")},textDecorationColor:e=>{let{theme:t}=e;return t("colors")},textDecorationThickness:{auto:"auto","from-font":"from-font",0:"0px",1:"1px",2:"2px",4:"4px",8:"8px"},textIndent:e=>{let{theme:t}=e;return{...t("spacing")}},textOpacity:e=>{let{theme:t}=e;return t("opacity")},textUnderlineOffset:{auto:"auto",0:"0px",1:"1px",2:"2px",4:"4px",8:"8px"},transformOrigin:{center:"center",top:"top","top-right":"top right",right:"right","bottom-right":"bottom right",bottom:"bottom","bottom-left":"bottom left",left:"left","top-left":"top left"},transitionDelay:{0:"0s",75:"75ms",100:"100ms",150:"150ms",200:"200ms",300:"300ms",500:"500ms",700:"700ms",1e3:"1000ms"},transitionDuration:{DEFAULT:"150ms",0:"0s",75:"75ms",100:"100ms",150:"150ms",200:"200ms",300:"300ms",500:"500ms",700:"700ms",1e3:"1000ms"},transitionProperty:{none:"none",all:"all",DEFAULT:"color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter",colors:"color, background-color, border-color, text-decoration-color, fill, stroke",opacity:"opacity",shadow:"box-shadow",transform:"transform"},transitionTimingFunction:{DEFAULT:"cubic-bezier(0.4, 0, 0.2, 1)",linear:"linear",in:"cubic-bezier(0.4, 0, 1, 1)",out:"cubic-bezier(0, 0, 0.2, 1)","in-out":"cubic-bezier(0.4, 0, 0.2, 1)"},translate:e=>{let{theme:t}=e;return{...t("spacing"),"1/2":"50%","1/3":"33.333333%","2/3":"66.666667%","1/4":"25%","2/4":"50%","3/4":"75%",full:"100%"}},width:e=>{let{theme:t}=e;return{auto:"auto",...t("spacing"),"1/2":"50%","1/3":"33.333333%","2/3":"66.666667%","1/4":"25%","2/4":"50%","3/4":"75%","1/5":"20%","2/5":"40%","3/5":"60%","4/5":"80%","1/6":"16.666667%","2/6":"33.333333%","3/6":"50%","4/6":"66.666667%","5/6":"83.333333%","1/12":"8.333333%","2/12":"16.666667%","3/12":"25%","4/12":"33.333333%","5/12":"41.666667%","6/12":"50%","7/12":"58.333333%","8/12":"66.666667%","9/12":"75%","10/12":"83.333333%","11/12":"91.666667%",full:"100%",screen:"100vw",min:"min-content",max:"max-content",fit:"fit-content"}},willChange:{auto:"auto",scroll:"scroll-position",contents:"contents",transform:"transform"},zIndex:{auto:"auto",0:"0",10:"10",20:"20",30:"30",40:"40",50:"50"}},plugins:[]}})),kM=UF(((e,t)=>{var n=Object.prototype.hasOwnProperty,i=Object.prototype.toString,r=Object.defineProperty,s=Object.getOwnPropertyDescriptor,o=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===i.call(e)},a=function(e){if(!e||"[object Object]"!==i.call(e))return!1;var t,r=n.call(e,"constructor"),s=e.constructor&&e.constructor.prototype&&n.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!r&&!s)return!1;for(t in e);return typeof t>"u"||n.call(e,t)},l=function(e,t){r&&"__proto__"===t.name?r(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},c=function(e,t){if("__proto__"===t){if(!n.call(e,t))return;if(s)return s(e,t).value}return e[t]};t.exports=function e(){var t,n,i,r,s,g,u=arguments[0],A=1,d=arguments.length,h=!1;for("boolean"==typeof u&&(h=u,u=arguments[1]||{},A=2),(null==u||"object"!=typeof u&&"function"!=typeof u)&&(u={});A<d;++A)if(null!=(t=arguments[A]))for(n in t)i=c(u,n),u!==(r=c(t,n))&&(h&&r&&(a(r)||(s=o(r)))?(s?(s=!1,g=i&&o(i)?i:[]):g=i&&a(i)?i:{},l(u,{name:n,newValue:e(h,g,r)})):typeof r<"u"&&l(u,{name:n,newValue:r}));return u}})),TM=UF(((e,t)=>{var n=function(e,t){var i=new e.constructor;return Object.keys(e).forEach((function(r){if(e.hasOwnProperty(r)){var s=e[r],o=typeof s;"parent"===r&&"object"===o?t&&(i[r]=t):"source"===r?i[r]=s:s instanceof Array?i[r]="nodes"===r?[]:s.map((function(e){n(e,i)})):"before"!==r&&"after"!==r&&"between"!==r&&"semicolon"!==r&&("object"===o&&(s=n(s)),i[r]=s)}})),i};t.exports=n})),VM=UF(((e,t)=>{function n(e,t,n){e instanceof RegExp&&(e=i(e,n)),t instanceof RegExp&&(t=i(t,n));var s=r(e,t,n);return s&&{start:s[0],end:s[1],pre:n.slice(0,s[0]),body:n.slice(s[0]+e.length,s[1]),post:n.slice(s[1]+t.length)}}function i(e,t){var n=t.match(e);return n?n[0]:null}function r(e,t,n){var i,r,s,o,a,l=n.indexOf(e),c=n.indexOf(t,l+1),g=l;if(l>=0&&c>0){if(e===t)return[l,c];for(i=[],s=n.length;g>=0&&!a;)g==l?(i.push(g),l=n.indexOf(e,g+1)):1==i.length?a=[i.pop(),c]:((r=i.pop())<s&&(s=r,o=c),c=n.indexOf(t,g+1)),g=l<c&&l>=0?l:c;i.length&&(a=[s,o])}return a}t.exports=n,n.range=r})),LM=UF(((e,t)=>{var n=/(.*?(?:(?:\([^\)]+\)|\[[^\]]+\]|(?![><+~\s]).)+)(?:(?:(?:\s(?!>>))|(?:\t(?!>>))|(?:\s?>>\s?))(?!\s+))(?![><+~][\s]+?))/;t.exports=function(e){return e.split(n).filter((function(e){return e.length>0})).map((function(e){return e.trim().replace(/\s*?>>\s*?/g,"")}))}})),HM=UF(((e,t)=>{var n=LM();t.exports=function(e,t){for(var i=[[]],r=(t=t||!1)?e:e.parent;r;){var s=(r.selectors||[]).map((function(e){return{value:e,type:"selector"}}));"atrule"===r.type&&(s=[].concat(r.params).map((function(e){return{value:"@"+r.name+" "+e,type:"atrule"}})));var o=(s.length>0?s:[1]).map((function(){return i.map((function(e){return e.slice(0)}))}));s.forEach((function(e,t){o[t]=o[t].map((function(t){var i=[e.value];return"selector"===e.type&&(i=n(e.value)),t.unshift.apply(t,i),t}))})),i=[],o.forEach((function(e){i=i.concat(e)})),r=r.parent}return i}})),QM=UF(((e,t)=>{var n=/[|\\{}()[\]^$+*?.]/g;t.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(n,"\\$&")}})),KM=UF(((e,t)=>{var n={"*":!0,":root":!0,html:!0};t.exports=function(e){return!!n[e]}})),XM=UF(((e,t)=>{var n=/(.*?(?:(?:\([^\)]+\)|\[[^\]]+\]|(?!>>|<|\+|~|\s).)+)(?:(?:(?:>(?!>))|(?:\s?>(?!>)\s?))(?!\s+))(?!(?:>>|<|\+|~)[\s]+?))/;t.exports=function(e){return e.split(n).filter((function(e){return e.length>0})).map((function(e){return e.trim().replace(/\s*?>\s*?/g,"")}))}})),YM=UF(((e,t)=>{var n=QM(),i=KM(),r=XM(),s=/^@.*/,o=/([^\s:]+)((?::|::)[^\s]*?)(\s+|$)/;function a(e,t){var s,o,l=t.some((function(t){return e.some((function(e){s=null;var l=!0;for(o=0;o<t.length;o++){for(var c=t[o],g=s||0,u=-1,A=e.slice(g),d=0;d<A.length;d++){var h=A[d],I=g+d;if(new RegExp(n(c)+"$").test(h)){u=I;break}if(i(c)||i(h)){u=I;break}var p=r(h);if(p.length>1){var C=[].concat([p]),m=[].concat([t.slice(o).reduce((function(e,t){return e.concat(r(t))}),[])]),f=a(C,m);(f.doesMatchScope||o+1<t.length)&&(u=I,o+=f.scopePieceIndex-1);break}}if(s=u+1,!(l=l&&u>=g))break}return l}))}));return{doesMatchScope:l,nodeScopePieceIndex:s-1,scopePieceIndex:o}}var l=function(e){return e.map((function(e){return e.map((function(e){return s.test(e)?e:e.replace(new RegExp(o.source,"g"),(function(e,t,n,i){return t+i}))}))}))},c=function(e,t,n){return e=l(e),n&&(t=l(t)),a(e,t).doesMatchScope};c.RE_PSEUDO_SELECTOR=o,t.exports=c})),zM=UF(((e,t)=>{var n=YM(),i=HM();t.exports=function(e,t,r){var s=i(e,!0),o=i(t,!0);return n(s,o,r)}})),PM=UF(((e,t)=>{var n=function(e,t,i){i=i||[];var r=!1;return e&&(i=e.reduce((function(e,i){var s=!!t[i],o=!!s&&e.some((function(e){return t[i].some((function(t){return e===t}))}));return r=r||o,s&&!r&&(e=e.concat(t[i]),(t[i]||[]).forEach((function(i){var s=n(i.variablesUsed,t,e);e=s.deps,r=r||s.hasCircularOrSelfReference}))),e}),i)),{deps:i,hasCircularOrSelfReference:r}};t.exports=n})),UM=UF(((e,t)=>{var n=HM();t.exports=function(e,t){for(var i,r=t;r.parent&&!i;){n(r.clone(),!0).some((function(t){return t.some((function(t){return t===e&&(i=r,!0)}))})),r=r.parent}return i}})),_M=UF(((e,t)=>{var n=TM();t.exports=function(e,t,i){i=i||function(){return!0};for(var r=[],s=e,o=!1;s&&!o;)"decl"===s.type?r.push(s.clone()):r.push(n(s)),o=i(s),s=s.parent;for(var a=[],l=t;l;)a.push(n(l)),l=l.parent;return a.forEach((function(e,t,n){t+1<n.length&&(e.parent=n[t+1])})),r.forEach((function(e,t,n){t+1<n.length?e.parent=n[t+1]:(a.slice(-1)[0].parent=s,e.parent=a[0])})),r[0]}})),OM=UF(((e,t)=>{var n=VM(),i=HM(),r=zM(),s=PM(),o=UM(),a=_M();function l(e){var t=n("(",")",e);if(t){if(/(?:^|[^\w-])var$/.test(t.pre))return{pre:t.pre.slice(0,-3),body:t.body,post:t.post};var i=l(t.body);if(i)return{pre:t.pre+"("+i.pre,body:i.body,post:i.post+")"+t.post};var r=l(t.post);if(r)return{pre:t.pre+"("+t.body+")"+r.pre,body:r.body,post:r.post}}}var c=function(e,t,n,g){for(var u=void 0,A=function(e){return String(e)}(e.value),d=[],h={},I=A;u=l(I);){h[y=(m=u.body.split(","))[0].trim()]=!0,I=(u.pre||"")+u.body.replace(y,"")+(u.post||"")}I=void 0;for(var p=Object.keys(h),C=!1;u=l(A);){var m,f=void 0,y=(m=u.body.split(","))[0].trim(),b=m.length>1?m.slice(1).join(",").trim():void 0;(t[y]||[]).forEach((function(t){"root"===t.parent.type||t.parent.selectors[0],r(e.parent,t.parent);r(e.parent,t.parent,n)&&(!(f||{}).isImportant||t.isImportant)&&(f=t)}));var B=(f||{}).calculatedInPlaceValue||function(){var n=b;if(b){var i=e.clone({parent:e.parent,value:b});n=c(i,t,!1,!0).value}return n}();if(void 0!==f&&!s(p,t).hasCircularOrSelfReference){var v=i(e.parent.parent,!0)[0].slice(-1)[0],w=o(v,f.decl.parent),G=a(f.decl,e.parent.parent,(function(e){return e===w}));B=c(G,t,!1,!0).value}(C=void 0===B)&&d.push(["variable "+y+" is undefined and used without a fallback",{node:e}]),A=(u.pre||"")+B+(u.post||"")}return{value:C?void 0:A,variablesUsed:p,warnings:d}};c.RE_VAR_FUNC=/var\(\s*(--[^,\s)]+)/,t.exports=c})),JM=UF(((e,t)=>{var n=OM(),i=HM(),r=PM(),s=YM(),o=zM(),a=TM(),l=UM(),c=_M();t.exports=function(e,t,g,u,A){g=("function"==typeof g?g(e):g)||!1,u=u||!1;var d,h=function(e){return A&&A(e),e},I=h(n(e,t));(function(e,t,n,g){e.forEach((function(u){r(e,t).deps.forEach((function(e){var t;if(e.isUnderAtRule){var r=i(e.parent,!0)[0].slice(-1)[0],u=l(r,n.parent),A=e.parent.parent;t=c(n,A,(function(e){return e===u}))}else if(s.RE_PSEUDO_SELECTOR.test(e.parent.selector)){var d=a(n.parent);d.parent=n.parent.parent,t=n.clone(),d.append(t);var h=e.parent.selector.match(new RegExp(s.RE_PSEUDO_SELECTOR.source+"$")),I=h?h[2]:"";d.selector+=I}t&&o(t,e.parent,!0)&&g(t,e)}))}))})(I.variablesUsed,t,e,(function(i,r){var s=a(e.parent),o=e.clone();let l;if(s.append(o),l="function"==typeof g?g(e):g,!0===l&&o.cloneAfter(),o.value=h(n(i,t,!0)).value,r.isUnderAtRule){var c=a(r.parent.parent);c.append(s);for(var A=c,I=r.parent.parent;"atrule"===I.parent.type;){var p=a(I.parent);p.append(A),A=p,I=I.parent}e.parent.parent.insertAfter(u&&d||e.parent,A),d=A}else s.selector=i.parent.selector,e.parent.parent.insertAfter(u&&d||e.parent,s)})),!0===g&&e.value!==I.value&&e.cloneAfter(),void 0===I.value&&(I.value="undefined"),e.value=I.value}})),jM=UF(((e,t)=>{var n=kM(),i=TM(),r=OM(),s=JM(),o=/(--(.+))/;function a(e){for(var t=e;t&&t.nodes.length<=0;){var n="root"!==t.type?t:null;n?(t=n.parent,n.remove()):t=null}}var l={preserve:!1,variables:{},preserveInjectedVariables:!0,preserveAtRulesOrder:!1};t.exports=function(){var e=n({},l,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return{postcssPlugin:"postcss-css-variables",Once(t,l){let{decl:c,result:g,rule:u}=l;var A=[],d=[],h={};h=n(h,Object.keys(e.variables).reduce((function(n,i){var r=e.variables[i];i="--"===i.slice(0,2)?i:"--"+i;var s=(r||{}).value||r,o=(r||{}).isImportant||!1,a=u({selector:":root"});t.root().prepend(a);var l=c({prop:i,value:s,important:o});return a.append(l),e.preserveInjectedVariables||d.push(l),n[i]=(n[i]||[]).concat({decl:l,prop:i,calculatedInPlaceValue:s,isImportant:o,variablesUsed:[],parent:a,isUnderAtRule:!1}),n}),{}));var I=function(e){return[].concat(e.warnings).forEach((function(e){e=[].concat(e),g.warn.apply(g,e)})),e};!function(e,t){e.walkDecls((function(e){o.test(e.prop)&&t(e)}))}(t,(function(t){var n=t.parent,s=I(r(t,h));let o;t.parent.selectors.forEach((function(e){var n=i(t.parent);n.selector=e,n.parent=t.parent.parent;var r=t.clone();n.append(r);var o=t.prop;h[o]=(h[o]||[]).concat({decl:r,prop:o,calculatedInPlaceValue:s.value,isImportant:t.important||!1,variablesUsed:s.variablesUsed,parent:n,isUnderAtRule:"atrule"===n.parent.type})})),o="function"==typeof e.preserve?e.preserve(t):e.preserve,o?"computed"===o&&(t.value=s.value):t.remove(),n.nodes.length<=0&&A.push(n)}));var p=[];t.walk((function(e){if(void 0!==e.nodes){var t=e.nodes.some((function(e){if("decl"===e.type){var t=e;if(r.RE_VAR_FUNC.test(t.value)&&!o.test(t.prop))return!0}return!1}));t&&p.push(e)}})),p.forEach((function(t){var n=[].concat(t);"rule"===t.type&&t.selectors.length>1&&(n=t.selectors.reverse().map((function(e){var n=t.cloneAfter();return n.selector=e,n})),t.remove()),n.forEach((function(t){t.nodes.slice(0).forEach((function(t){"decl"===t.type&&s(t,h,e.preserve,e.preserveAtRulesOrder,I)}))}))})),A.forEach(a),d.forEach((function(e){e.remove()}))}}},t.exports.postcss=!0})),qM=e=>({extractCSS(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=/(?:[\s\r\n]*)?(?<prop>[\w-]+)\s*:\s*(?<value>[^;\r\n]+)/gm,r={};for(;null!==(t=i.exec(e));){let{prop:e,value:n}=t.groups;r[e]=n}return Object.entries(r).reduce(((e,t)=>{let[i,r]=t;return e+"".concat(n?"\t":"").concat(i,": ").concat(r,"; \n\r")}),"")},merge(){let t,n=/(?<=\.)[^{]+\s*\{(?<content>[^{}]*(?:(?<=;)\s*\n\r?[^{}]*)*)\s*\}/gm,i="";for(;null!==(t=n.exec(e));){let{content:e}=t.groups;i+=e}let r,s=this.extractCSS(i),o=/(?<media>@media\s*\([^\)]*\))\s*\{(?<content>[^\}]*)\}/gm;for(;null!==(r=o.exec(e));){let{media:e,content:t}=r.groups;s+="\n\r".concat(e," {\n\r").concat(this.extractCSS(t,!0),"}\n\r")}return e=s,this},removeUndefined(){return e=e.replace(/^[^{}]*(?:[.#][a-zA-Z0-9_-]+)[^{]*{[^}]*\b(?:[a-z-]+):\s*undefined\s*;?[^}]*}/gm,""),this},combineMediaQueries(){let t=new RegExp("@media\\s*(?<conditions>\\([^)]+\\))\\s*{(?<content>(?:[^{}]+|{(?:[^{}]+|{[^{}]*})*})+)}","gs"),n=new Map,i=e=>e.replace(t,((e,t,r)=>{var s;let o=null!=(s=n.get(t))?s:"";return n.set(t,o+i(r.trim())),i(r),""})),r=[];return r.push(i(e)),r.push(...Array.from(n,(e=>{let[t,n]=e;return"@media".concat(t,"{").concat(n,"}")}))),e=r.join(""),this},minify(){return e=e.replace(/\/\*[\s\S]*?\*\//gm,"").replace(/;\s+/gm,";").replace(/:\s+/gm,":").replace(/\)\s*{/gm,"){").replace(/\s+\(/gm,"(").replace(/{\s+/gm,"{").replace(/}\s+/gm,"}").replace(/\s*{/gm,"{").replace(/;?\s*}/gm,"}"),this},fixRGB(){let t,n=/rgb\(\s*(?<red>\d+)\s*(?<green>\d+)\s*(?<blue>\d+)(?:\s*\/\s*(?<alpha>[\d%.]+))?\s*\)/gm;for(;null!==(t=n.exec(e));){let[n]=t,{red:i,green:r,blue:s,alpha:o=1}=t.groups;e=e.replace(n,"rgb(".concat(i,",").concat(r,",").concat(s).concat("1"===o?"":",".concat(o),")"))}return this},removeMediaQueries(){return e=e.replace(/@media[^\{]+\{[^@]+\}/g,""),this},get:()=>e});function $M(){}var eW={info:$M,warn:$M,risk:$M};tN();var tW=JF(nN()),nW="3.3.2",iW={engine:"stable"},rW=typeof process<"u"?{NODE_ENV:"production",DEBUG:function(e){if(void 0===e)return!1;if("true"===e||"1"===e)return!0;if("false"===e||"0"===e)return!1;if("*"===e)return!0;let t=e.split(",").map((e=>e.split(":")[0]));return!t.includes("-tailwindcss")&&!!t.includes("tailwindcss")}(void 0),ENGINE:iW.engine}:{NODE_ENV:"production",DEBUG:!1,ENGINE:iW.engine},sW=new Map,oW=new String("*"),aW=Symbol("__NONE__");var lW=JF(QN(),1),cW=lW.default,gW=(lW.default.stringify,lW.default.fromJSON,lW.default.plugin,lW.default.parse,lW.default.list,lW.default.document,lW.default.comment,lW.default.atRule,lW.default.rule,lW.default.decl,lW.default.root,lW.default.CssSyntaxError,lW.default.Declaration,lW.default.Container,lW.default.Processor,lW.default.Document,lW.default.Comment,lW.default.Warning,lW.default.AtRule,lW.default.Result,lW.default.Input,lW.default.Rule,lW.default.Root,lW.default.Node,JF(fM())),uW=JF(yM()),AW=JF(xM(),1),dW=AW.default;AW.default.objectify,AW.default.parse,AW.default.async,AW.default.sync;function hW(e){return Array.isArray(e)?e.flatMap((e=>cW([(0,uW.default)({bubble:["screen"]})]).process(e,{parser:dW}).root.nodes)):hW([e])}function IW(e){if("[object Object]"!==Object.prototype.toString.call(e))return!1;let t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}var pW=JF(fM());function CW(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(""===e)return t;let i="string"==typeof t?(0,pW.default)().astSync(t):t;return i.walkClasses((t=>{let i=t.value,r=n&&i.startsWith("-");t.value=r?"-".concat(e).concat(i.slice(1)):"".concat(e).concat(i)})),"string"==typeof t?i.toString():i}function mW(e){return e.replace(/\\,/g,"\\2c ")}var fW={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},yW=/^#([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i,bW=/^#([a-f\d])([a-f\d])([a-f\d])([a-f\d])?$/i,BW=/(?:\d+|\d*\.\d+)%?/,vW=/(?:\s*,\s*|\s+)/,wW=/\s*[,/]\s*/,GW=/var\(--(?:[^ )]*?)\)/,EW=new RegExp("^(rgba?)\\(\\s*(".concat(BW.source,"|").concat(GW.source,")(?:").concat(vW.source,"(").concat(BW.source,"|").concat(GW.source,"))?(?:").concat(vW.source,"(").concat(BW.source,"|").concat(GW.source,"))?(?:").concat(wW.source,"(").concat(BW.source,"|").concat(GW.source,"))?\\s*\\)$")),xW=new RegExp("^(hsla?)\\(\\s*((?:".concat(BW.source,")(?:deg|rad|grad|turn)?|").concat(GW.source,")(?:").concat(vW.source,"(").concat(BW.source,"|").concat(GW.source,"))?(?:").concat(vW.source,"(").concat(BW.source,"|").concat(GW.source,"))?(?:").concat(wW.source,"(").concat(BW.source,"|").concat(GW.source,"))?\\s*\\)$"));function SW(e){let{loose:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,i,r;if("string"!=typeof e)return null;if("transparent"===(e=e.trim()))return{mode:"rgb",color:["0","0","0"],alpha:"0"};if(e in fW)return{mode:"rgb",color:fW[e].map((e=>e.toString()))};let s=e.replace(bW,((e,t,n,i,r)=>["#",t,t,n,n,i,i,r?r+r:""].join(""))).match(yW);if(null!==s)return{mode:"rgb",color:[parseInt(s[1],16),parseInt(s[2],16),parseInt(s[3],16)].map((e=>e.toString())),alpha:s[4]?(parseInt(s[4],16)/255).toString():void 0};let o=null!=(n=e.match(EW))?n:e.match(xW);if(null===o)return null;let a=[o[2],o[3],o[4]].filter(Boolean).map((e=>e.toString()));return 2===a.length&&a[0].startsWith("var(")?{mode:o[1],color:[a[0]],alpha:a[1]}:!t&&3!==a.length||a.length<3&&!a.some((e=>/^var\(.*?\)$/.test(e)))?null:{mode:o[1],color:a,alpha:null==(r=null==(i=o[5])?void 0:i.toString)?void 0:r.call(i)}}function RW(e){let{mode:t,color:n,alpha:i}=e,r=void 0!==i;return"rgba"===t||"hsla"===t?"".concat(t,"(").concat(n.join(", ")).concat(r?", ".concat(i):"",")"):"".concat(t,"(").concat(n.join(" ")).concat(r?" / ".concat(i):"",")")}function ZW(e,t,n){if("function"==typeof e)return e({opacityValue:t});let i=SW(e,{loose:!0});return null===i?n:RW({...i,alpha:t})}function DW(e){let{color:t,property:n,variable:i}=e,r=[].concat(n);if("function"==typeof t)return{[i]:"1",...Object.fromEntries(r.map((e=>[e,t({opacityVariable:i,opacityValue:"var(".concat(i,")")})])))};let s=SW(t);return null===s||void 0!==s.alpha?Object.fromEntries(r.map((e=>[e,t]))):{[i]:"1",...Object.fromEntries(r.map((e=>[e,RW({...s,alpha:"var(".concat(i,")")})])))}}function FW(e,t){let n=[],i=[],r=0,s=!1;for(let o=0;o<e.length;o++){let a=e[o];0===n.length&&a===t[0]&&!s&&(1===t.length||e.slice(o,o+t.length)===t)&&(i.push(e.slice(r,o)),r=o+t.length),s?s=!1:"\\"===a&&(s=!0),"("===a||"["===a||"{"===a?n.push(a):(")"===a&&"("===n[n.length-1]||"]"===a&&"["===n[n.length-1]||"}"===a&&"{"===n[n.length-1])&&n.pop()}return i.push(e.slice(r)),i}var NW=new Set(["inset","inherit","initial","revert","unset"]),MW=/\ +(?![^(]*\))/g,WW=/^-?(\d+|\.\d+)(.*?)$/g;function kW(e){return FW(e,",").map((e=>{let t=e.trim(),n={raw:t},i=t.split(MW),r=new Set;for(let s of i)WW.lastIndex=0,!r.has("KEYWORD")&&NW.has(s)?(n.keyword=s,r.add("KEYWORD")):WW.test(s)?r.has("X")?r.has("Y")?r.has("BLUR")?r.has("SPREAD")||(n.spread=s,r.add("SPREAD")):(n.blur=s,r.add("BLUR")):(n.y=s,r.add("Y")):(n.x=s,r.add("X")):n.color?(n.unknown||(n.unknown=[]),n.unknown.push(s)):n.color=s;return n.valid=void 0!==n.x&&void 0!==n.y,n}))}function TW(e){return e.map((e=>e.valid?[e.keyword,e.x,e.y,e.blur,e.spread,e.color].filter(Boolean).join(" "):e.raw)).join(", ")}var VW=["min","max","clamp","calc"];function LW(e){return VW.some((t=>new RegExp("^".concat(t,"\\(.*\\)")).test(e)))}var HW="--tw-placeholder",QW=new RegExp(HW,"g");function KW(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.startsWith("--")?"var(".concat(e,")"):e.includes("url(")?e.split(/(url\(.*?\))/g).filter(Boolean).map((e=>/^url\(.*?\)$/.test(e)?e:KW(e,!1))).join(""):(e=e.replace(/([^\\])_+/g,((e,t)=>t+" ".repeat(e.length-1))).replace(/^_/g," ").replace(/\\_/g,"_"),t&&(e=e.trim()),e=e.replace(/(calc|min|max|clamp)\(.+\)/g,(e=>{let t=[];return e.replace(/var\((--.+?)[,)]/g,((e,n)=>(t.push(n),e.replace(n,HW)))).replace(/(-?\d*\.?\d(?!\b-\d.+[,)](?![^+\-/*])\D)(?:%|[a-z]+)?|\))([+\-/*])/g,"$1 $2 ").replace(QW,(()=>t.shift()))})),e)}function XW(e){return e.startsWith("url(")}function YW(e){return!isNaN(Number(e))||LW(e)}function zW(e){return e.endsWith("%")&&YW(e.slice(0,-1))||LW(e)}var PW="(?:".concat(["cm","mm","Q","in","pc","pt","px","em","ex","ch","rem","lh","rlh","vw","vh","vmin","vmax","vb","vi","svw","svh","lvw","lvh","dvw","dvh","cqw","cqh","cqi","cqb","cqmin","cqmax"].join("|"),")");function UW(e){return"0"===e||new RegExp("^[+-]?[0-9]*.?[0-9]+(?:[eE][+-]?[0-9]+)?".concat(PW,"$")).test(e)||LW(e)}var _W=new Set(["thin","medium","thick"]);function OW(e){let t=0;return!!FW(e,"_").every((e=>!!(e=KW(e)).startsWith("var(")||null!==SW(e,{loose:!0})&&(t++,!0)))&&t>0}var JW=new Set(["linear-gradient","radial-gradient","repeating-linear-gradient","repeating-radial-gradient","conic-gradient"]);var jW=new Set(["center","top","right","bottom","left"]);var qW=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]);var $W=new Set(["xx-small","x-small","small","medium","large","x-large","x-large","xxx-large"]);var ek=new Set(["larger","smaller"]);function tk(e){if("0"===(e="".concat(e)))return"0";if(/^[+-]?(\d+|\d*\.\d+)(e[+-]?\d+)?(%|\w+)?$/.test(e))return e.replace(/^[+-]?/,(e=>"-"===e?"":"-"));let t=["var","calc","min","max","clamp"];for(let n of t)if(e.includes("".concat(n,"(")))return"calc(".concat(e," * -1)")}sN();var nk={optimizeUniversalDefaults:!1,generalizedModifiers:!0,get disableColorOpacityUtilitiesByDefault(){},get relativeContentPathsByDefault(){}},ik={future:["hoverOnlyWhenSupported","respectDefaultRingColorOpacity","disableColorOpacityUtilitiesByDefault","relativeContentPathsByDefault"],experimental:["optimizeUniversalDefaults","generalizedModifiers"]};function rk(e,t){var n,i,r,s,o,a;return ik.future.includes(t)?"all"===e.future||null!=(r=null!=(i=null==(n=null==e?void 0:e.future)?void 0:n[t])?i:nk[t])&&r:!!ik.experimental.includes(t)&&("all"===e.experimental||null!=(a=null!=(o=null==(s=null==e?void 0:e.experimental)?void 0:s[t])?o:nk[t])&&a)}function sk(e,t){e.walkClasses((e=>{e.value=t(e.value),e.raws&&e.raws.value&&(e.raws.value=mW(e.raws.value))}))}function ok(e,t){if(!lk(e))return;let n=e.slice(1,-1);return t(n)?KW(n):void 0}function ak(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{validate:n=()=>!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var i;let r=null==(i=t.values)?void 0:i[e];return void 0!==r?r:t.supportsNegativeValues&&e.startsWith("-")?function(e){let t=arguments.length>2?arguments[2]:void 0,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})[e];if(void 0!==n)return tk(n);if(lk(e)){let n=ok(e,t);return void 0===n?void 0:tk(n)}}(e.slice(1),t.values,n):ok(e,n)}function lk(e){return e.startsWith("[")&&e.endsWith("]")}function ck(e){let t=e.lastIndexOf("/");return-1===t||t===e.length-1||lk(e)&&!e.includes("]/[")?[e,void 0]:[e.slice(0,t),e.slice(t+1)]}function gk(e){if("string"==typeof e&&e.includes("<alpha-value>")){let t=e;return e=>{let{opacityValue:n=1}=e;return t.replace("<alpha-value>",n)}}return e}function uk(e){return KW(e.slice(1,-1))}function Ak(e){return(t,n)=>ak(t,n,{validate:e})}var dk={any:ak,color:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{tailwindConfig:n={}}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var i,r,s,o,a,l;if(void 0!==(null==(i=t.values)?void 0:i[e]))return gk(null==(r=t.values)?void 0:r[e]);let[c,g]=ck(e);if(void 0!==g){let e=null!=(o=null==(s=t.values)?void 0:s[c])?o:lk(c)?c.slice(1,-1):void 0;return void 0===e?void 0:(e=gk(e),lk(g)?ZW(e,uk(g)):void 0===(null==(l=null==(a=n.theme)?void 0:a.opacity)?void 0:l[g])?void 0:ZW(e,n.theme.opacity[g]))}return ak(e,t,{validate:OW})},url:Ak(XW),image:Ak((function(e){let t=0;return!!FW(e,",").every((e=>!!(e=KW(e)).startsWith("var(")||!!(XW(e)||function(e){e=KW(e);for(let t of JW)if(e.startsWith("".concat(t,"(")))return!0;return!1}(e)||["element(","image(","cross-fade(","image-set("].some((t=>e.startsWith(t))))&&(t++,!0)))&&t>0})),length:Ak(UW),percentage:Ak(zW),position:Ak((function(e){let t=0;return!!FW(e,"_").every((e=>!!(e=KW(e)).startsWith("var(")||!!(jW.has(e)||UW(e)||zW(e))&&(t++,!0)))&&t>0})),lookup:function(e){var t;return null==(t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).values)?void 0:t[e]},"generic-name":Ak((function(e){return qW.has(e)})),"family-name":Ak((function(e){let t=0;return!!FW(e,",").every((e=>!!(e=KW(e)).startsWith("var(")||!(e.includes(" ")&&!/(['"])([^"']+)\1/g.test(e)||/^\d/g.test(e))&&(t++,!0)))&&t>0})),number:Ak(YW),"line-width":Ak((function(e){return _W.has(e)})),"absolute-size":Ak((function(e){return $W.has(e)})),"relative-size":Ak((function(e){return ek.has(e)})),shadow:Ak((function(e){let t=kW(KW(e));for(let n of t)if(!n.valid)return!1;return!0})),size:Ak((function(e){let t=["cover","contain"];return FW(e,",").every((e=>{let n=FW(e,"_").filter(Boolean);return!(1!==n.length||!t.includes(n[0]))||(1===n.length||2===n.length)&&n.every((e=>UW(e)||zW(e)||"auto"===e))}))}))},hk=Object.keys(dk);function Ik(e,t,n,i){if(n.values&&t in n.values)for(let{type:s}of null!=e?e:[]){let e=dk[s](t,n,{tailwindConfig:i});if(void 0!==e)return[e,s,null]}if(lk(t)){let e=t.slice(1,-1),[i,r]=function(e,t){let n=e.indexOf(t);return-1===n?[void 0,e]:[e.slice(0,n),e.slice(n+1)]}(e,":");if(/^[\w-_]+$/g.test(i)){if(void 0!==i&&!hk.includes(i))return[]}else r=e;if(r.length>0&&hk.includes(i))return[ak("[".concat(r,"]"),n),i,null]}let r=pk(e,t,n,i);for(let s of r)return s;return[]}function*pk(e,t,n,i){var r,s;let o=rk(i,"generalizedModifiers"),[a,l]=ck(t);if(o&&null!=n.modifiers&&("any"===n.modifiers||"object"==typeof n.modifiers&&(l&&lk(l)||l in n.modifiers))||(a=t,l=void 0),void 0!==l&&""===a&&(a="DEFAULT"),void 0!==l&&"object"==typeof n.modifiers){let e=null!=(s=null==(r=n.modifiers)?void 0:r[l])?s:null;null!==e?l=e:lk(l)&&(l=uk(l))}for(let{type:c}of null!=e?e:[]){let e=dk[c](a,n,{tailwindConfig:i});void 0!==e&&(yield[e,c,null!=l?l:null])}}var Ck=JF(fM()),mk=JF(KN()),fk=JF(fM());function yk(e){var t,n;let i=fk.default.className();return i.value=e,mW(null!=(n=null==(t=null==i?void 0:i.raws)?void 0:t.value)?n:i.value)}var bk={"::after":["terminal","jumpable"],"::backdrop":["terminal"],"::before":["terminal","jumpable"],"::cue":["terminal"],"::cue-region":["terminal"],"::first-letter":["terminal","jumpable"],"::first-line":["terminal","jumpable"],"::grammar-error":["terminal"],"::marker":["terminal"],"::part":["terminal","actionable"],"::placeholder":["terminal"],"::selection":["terminal"],"::slotted":["terminal"],"::spelling-error":["terminal"],"::target-text":["terminal"],"::file-selector-button":["terminal","actionable"],"::-webkit-progress-bar":["terminal","actionable"],"::-webkit-scrollbar":["terminal","actionable"],"::-webkit-scrollbar-button":["terminal","actionable"],"::-webkit-scrollbar-thumb":["terminal","actionable"],"::-webkit-scrollbar-track":["terminal","actionable"],"::-webkit-scrollbar-track-piece":["terminal","actionable"],"::-webkit-scrollbar-corner":["terminal","actionable"],"::-webkit-resizer":["terminal","actionable"],":after":["terminal","jumpable"],":before":["terminal","jumpable"],":first-letter":["terminal","jumpable"],":first-line":["terminal","jumpable"],__default__:["actionable"]};function Bk(e){let[t]=vk(e);return t.forEach((e=>{let[t,n]=e;return t.removeChild(n)})),e.nodes.push(...t.map((e=>{let[,t]=e;return t}))),e}function vk(e){var t;let n=[],i=null;for(let r of e.nodes)if("combinator"===r.type)n=n.filter((e=>{let[,t]=e;return xk(t).includes("jumpable")})),i=null;else if("pseudo"===r.type){Gk(r)?(i=r,n.push([e,r,null])):i&&Ek(r,i)?n.push([e,r,i]):i=null;for(let e of null!=(t=r.nodes)?t:[]){let[t,r]=vk(e);i=r||i,n.push(...t)}}return[n,i]}function wk(e){return e.value.startsWith("::")||void 0!==bk[e.value]}function Gk(e){return wk(e)&&xk(e).includes("terminal")}function Ek(e,t){return"pseudo"===e.type&&!wk(e)&&xk(t).includes("actionable")}function xk(e){var t;return null!=(t=bk[e.value])?t:bk.__default__}var Sk=":merge";function Rk(e,t){let{context:n,candidate:i}=t;var r;let s=null!=(r=null==n?void 0:n.tailwindConfig.prefix)?r:"",o=e.map((e=>{let t=(0,Ck.default)().astSync(e.format);return{...e,ast:e.isArbitraryVariant?t:CW(s,t)}})),a=Ck.default.root({nodes:[Ck.default.selector({nodes:[Ck.default.className({value:yk(i)})]})]});for(let{ast:l}of o)[a,l]=Nk(a,l),l.walkNesting((e=>e.replaceWith(...a.nodes[0].nodes))),a=l;return a}function Zk(e){let t=[];for(;e.prev()&&"combinator"!==e.prev().type;)e=e.prev();for(;e&&"combinator"!==e.type;)t.push(e),e=e.next();return t}function Dk(e,t){let n=!1;e.walk((e=>{if("class"===e.type&&e.value===t)return n=!0,!1})),n||e.remove()}function Fk(e,t,n){let{context:i,candidate:r,base:s}=n;var o,a;let l=null!=(a=null==(o=null==i?void 0:i.tailwindConfig)?void 0:o.separator)?a:":";s=null!=s?s:r.split(new RegExp("\\".concat(l,"(?![^[]*\\])"))).pop();let c=(0,Ck.default)().astSync(e);c.walkClasses((e=>{e.raws&&e.value.includes(s)&&(e.raws.value=yk((0,mk.default)(e.raws.value)))})),c.each((e=>Dk(e,s)));let g=Array.isArray(t)?Rk(t,{context:i,candidate:r}):t;if(null===g)return c.toString();let u=Ck.default.comment({value:"/*__simple__*/"}),A=Ck.default.comment({value:"/*__simple__*/"});return c.walkClasses((e=>{if(e.value!==s)return;let t=e.parent,n=g.nodes[0].nodes;if(1===t.nodes.length)return void e.replaceWith(...n);let i=Zk(e);t.insertBefore(i[0],u),t.insertAfter(i[i.length-1],A);for(let s of n)t.insertBefore(i[0],s.clone());e.remove(),i=Zk(u);let r=t.index(u);t.nodes.splice(r,i.length,...function(e){return e.sort(((t,n)=>"tag"===t.type&&"class"===n.type?-1:"class"===t.type&&"tag"===n.type?1:"class"===t.type&&"pseudo"===n.type&&n.value.startsWith("::")?-1:"pseudo"===t.type&&t.value.startsWith("::")&&"class"===n.type?1:e.index(t)-e.index(n))),e}(Ck.default.selector({nodes:i})).nodes),u.remove(),A.remove()})),c.walkPseudos((e=>{e.value===Sk&&e.replaceWith(e.nodes)})),c.each((e=>Bk(e))),c.toString()}function Nk(e,t){let n=[];return e.walkPseudos((e=>{e.value===Sk&&n.push({pseudo:e,value:e.nodes[0].toString()})})),t.walkPseudos((e=>{if(e.value!==Sk)return;let t=e.nodes[0].toString(),i=n.find((e=>e.value===t));if(!i)return;let r=[],s=e.next();for(;s&&"combinator"!==s.type;)r.push(s),s=s.next();let o=s;i.pseudo.parent.insertAfter(i.pseudo,Ck.default.selector({nodes:r.map((e=>e.clone()))})),e.remove(),r.forEach((e=>e.remove())),o&&"combinator"===o.type&&o.remove()})),[e,t]}function Mk(e){return mW(".".concat(yk(e)))}function Wk(e,t){return Mk(kk(e,t))}function kk(e,t){return"DEFAULT"===t?e:"-"===t||"-DEFAULT"===t?"-".concat(e):t.startsWith("-")?"-".concat(e).concat(t):t.startsWith("/")?"".concat(e).concat(t):"".concat(e,"-").concat(t)}var Tk=JF(SM()),Vk=JF(fM());function Lk(e){return["fontSize","outline"].includes(e)?e=>("function"==typeof e&&(e=e({})),Array.isArray(e)&&(e=e[0]),e):"fontFamily"===e?e=>{"function"==typeof e&&(e=e({}));let t=Array.isArray(e)&&IW(e[1])?e[0]:e;return Array.isArray(t)?t.join(", "):t}:["boxShadow","transitionProperty","transitionDuration","transitionDelay","transitionTimingFunction","backgroundImage","backgroundSize","backgroundColor","cursor","animation"].includes(e)?e=>("function"==typeof e&&(e=e({})),Array.isArray(e)&&(e=e.join(", ")),e):["gridTemplateColumns","gridTemplateRows","objectPosition"].includes(e)?e=>("function"==typeof e&&(e=e({})),"string"==typeof e&&(e=cW.list.comma(e).join(" ")),e):function(e){return"function"==typeof e&&(e=e(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})),e}}function Hk(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[[e,[e]]],{filterDefault:n=!1,...i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Lk(e);return function(s){let{matchUtilities:o,theme:a}=s;var l;for(let c of t){o((Array.isArray(c[0])?c:[c]).reduce(((e,t)=>{let[n,i]=t;return Object.assign(e,{[n]:e=>i.reduce(((t,n)=>Array.isArray(n)?Object.assign(t,{[n[0]]:n[1]}):Object.assign(t,{[n]:r(e)})),{})})}),{}),{...i,values:n?Object.fromEntries(Object.entries(null!=(l=a(e))?l:{}).filter((e=>{let[t]=e;return"DEFAULT"!==t}))):a(e)})}}}function Qk(e){return(e=Array.isArray(e)?e:[e]).map((e=>{let t=e.values.map((e=>void 0!==e.raw?e.raw:[e.min&&"(min-width: ".concat(e.min,")"),e.max&&"(max-width: ".concat(e.max,")")].filter(Boolean).join(" and ")));return e.not?"not all and ".concat(t):t})).join(", ")}tN(),pN();var Kk=new Set(["normal","reverse","alternate","alternate-reverse"]),Xk=new Set(["running","paused"]),Yk=new Set(["none","forwards","backwards","both"]),zk=new Set(["infinite"]),Pk=new Set(["linear","ease","ease-in","ease-out","ease-in-out","step-start","step-end"]),Uk=["cubic-bezier","steps"],_k=/\,(?![^(]*\))/g,Ok=/\ +(?![^(]*\))/g,Jk=/^(-?[\d.]+m?s)$/,jk=/^(\d+)$/;var qk=e=>Object.assign({},...Object.entries(null!=e?e:{}).flatMap((e=>{let[t,n]=e;return"object"==typeof n?Object.entries(qk(n)).map((e=>{let[n,i]=e;return{[t+("DEFAULT"===n?"":"-".concat(n))]:i}})):[{["".concat(t)]:n}]}))),$k=qk;function eT(e){return"function"==typeof e?e({}):e}function tT(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Array.isArray(e)?e.map((e=>{if(t&&Array.isArray(e))throw new Error("The tuple syntax is not supported for `screens`.");if("string"==typeof e)return{name:e.toString(),not:!1,values:[{min:e,max:void 0}]};let[n,i]=e;return n=n.toString(),"string"==typeof i?{name:n,not:!1,values:[{min:i,max:void 0}]}:Array.isArray(i)?{name:n,not:!1,values:i.map((e=>rT(e)))}:{name:n,not:!1,values:[rT(i)]}})):tT(Object.entries(null!=e?e:{}),!1)}function nT(e){return 1!==e.values.length?{result:!1,reason:"multiple-values"}:void 0!==e.values[0].raw?{result:!1,reason:"raw-values"}:void 0!==e.values[0].min&&void 0!==e.values[0].max?{result:!1,reason:"min-and-max"}:{result:!0,reason:null}}function iT(e,t){return"object"==typeof e?e:{name:"arbitrary-screen",values:[{[t]:e}]}}function rT(){let{"min-width":e,min:t=e,max:n,raw:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{min:t,max:n,raw:i}}function sT(e,t){e.walkDecls((e=>{if(t.includes(e.prop))e.remove();else for(let n of t)e.value.includes("/ var(".concat(n,")"))&&(e.value=e.value.replace("/ var(".concat(n,")"),""))}))}var oT={pseudoElementVariants:e=>{let{addVariant:t}=e;t("first-letter","&::first-letter"),t("first-line","&::first-line"),t("marker",[e=>{let{container:t}=e;return sT(t,["--tw-text-opacity"]),"& *::marker"},e=>{let{container:t}=e;return sT(t,["--tw-text-opacity"]),"&::marker"}]),t("selection",["& *::selection","&::selection"]),t("file","&::file-selector-button"),t("placeholder","&::placeholder"),t("backdrop","&::backdrop"),t("before",(e=>{let{container:t}=e;return t.walkRules((e=>{let t=!1;e.walkDecls("content",(()=>{t=!0})),t||e.prepend(cW.decl({prop:"content",value:"var(--tw-content)"}))})),"&::before"})),t("after",(e=>{let{container:t}=e;return t.walkRules((e=>{let t=!1;e.walkDecls("content",(()=>{t=!0})),t||e.prepend(cW.decl({prop:"content",value:"var(--tw-content)"}))})),"&::after"}))},pseudoClassVariants:e=>{let{addVariant:t,matchVariant:n,config:i}=e,r=[["first","&:first-child"],["last","&:last-child"],["only","&:only-child"],["odd","&:nth-child(odd)"],["even","&:nth-child(even)"],"first-of-type","last-of-type","only-of-type",["visited",e=>{let{container:t}=e;return sT(t,["--tw-text-opacity","--tw-border-opacity","--tw-bg-opacity"]),"&:visited"}],"target",["open","&[open]"],"default","checked","indeterminate","placeholder-shown","autofill","optional","required","valid","invalid","in-range","out-of-range","read-only","empty","focus-within",["hover",rk(i(),"hoverOnlyWhenSupported")?"@media (hover: hover) and (pointer: fine) { &:hover }":"&:hover"],"focus","focus-visible","active","enabled","disabled"].map((e=>Array.isArray(e)?e:[e,"&:".concat(e)]));for(let[o,a]of r)t(o,(e=>"function"==typeof a?a(e):a));let s={group:(e,t)=>{let{modifier:n}=t;return n?[":merge(.group\\/".concat(yk(n),")")," &"]:[":merge(.group)"," &"]},peer:(e,t)=>{let{modifier:n}=t;return n?[":merge(.peer\\/".concat(yk(n),")")," ~ &"]:[":merge(.peer)"," ~ &"]}};for(let[o,a]of Object.entries(s))n(o,(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=KW("function"==typeof e?e(t):e);n.includes("&")||(n="&"+n);let[i,r]=a("",t),s=null,o=null,l=0;for(let a=0;a<n.length;++a){let e=n[a];"&"===e?s=a:"'"===e||'"'===e?l+=1:null!==s&&" "===e&&!l&&(o=a)}return null!==s&&null===o&&(o=n.length),n.slice(0,s)+i+n.slice(s+1,o)+r+n.slice(o)}),{values:Object.fromEntries(r)})},directionVariants:e=>{let{addVariant:t}=e;t("ltr",':is([dir="ltr"] &)'),t("rtl",':is([dir="rtl"] &)')},reducedMotionVariants:e=>{let{addVariant:t}=e;t("motion-safe","@media (prefers-reduced-motion: no-preference)"),t("motion-reduce","@media (prefers-reduced-motion: reduce)")},darkVariants:e=>{let{config:t,addVariant:n}=e,[i,r=".dark"]=[].concat(t("darkMode","media"));!1===i&&(i="media",eW.warn("darkmode-false",["The `darkMode` option in your Tailwind CSS configuration is set to `false`, which now behaves the same as `media`.","Change `darkMode` to `media` or remove it entirely.","https://tailwindcss.com/docs/upgrade-guide#remove-dark-mode-configuration"])),"class"===i?n("dark",":is(".concat(r," &)")):"media"===i&&n("dark","@media (prefers-color-scheme: dark)")},printVariant:e=>{let{addVariant:t}=e;t("print","@media print")},screenVariants:e=>{let{theme:t,addVariant:n,matchVariant:i}=e;var r;let s=null!=(r=t("screens"))?r:{},o=Object.values(s).every((e=>"string"==typeof e)),a=tT(t("screens")),l=new Set([]);function c(e){void 0!==e&&l.add(function(e){var t,n;return null!=(n=null==(t=e.match(/(\D+)$/))?void 0:t[1])?n:"(none)"}(e))}for(let p of a)for(let e of p.values)c(e.min),c(e.max);let g=l.size<=1;function u(e){return(t,n)=>function(e,t,n){let i=iT(t,e),r=iT(n,e),s=nT(i),o=nT(r);if("multiple-values"===s.reason||"multiple-values"===o.reason)throw new Error("Attempted to sort a screen with multiple values. This should never happen. Please open a bug report.");if("raw-values"===s.reason||"raw-values"===o.reason)throw new Error("Attempted to sort a screen with raw values. This should never happen. Please open a bug report.");if("min-and-max"===s.reason||"min-and-max"===o.reason)throw new Error("Attempted to sort a screen with both min and max values. This should never happen. Please open a bug report.");let{min:a,max:l}=i.values[0],{min:c,max:g}=r.values[0];t.not&&([a,l]=[l,a]),n.not&&([c,g]=[g,c]),a=void 0===a?a:parseFloat(a),l=void 0===l?l:parseFloat(l),c=void 0===c?c:parseFloat(c),g=void 0===g?g:parseFloat(g);let[u,A]="min"===e?[a,c]:[g,l];return u-A}(e,t.value,n.value)}let A=u("max"),d=u("min");function h(e){return t=>o?g?"string"!=typeof t||function(e){return c(e),1===l.size}(t)?["@media ".concat(Qk(iT(t,e)))]:(eW.warn("minmax-have-mixed-units",["The `min-*` and `max-*` variants are not supported with a `screens` configuration containing mixed units."]),[]):(eW.warn("mixed-screen-units",["The `min-*` and `max-*` variants are not supported with a `screens` configuration containing mixed units."]),[]):(eW.warn("complex-screen-config",["The `min-*` and `max-*` variants are not supported with a `screens` configuration containing objects."]),[])}i("max",h("max"),{sort:A,values:o?function(e){return Object.fromEntries(a.filter((e=>nT(e).result)).map((t=>{let{min:n,max:i}=t.values[0];return"min"===e&&void 0!==n?t:"min"===e&&void 0!==i?{...t,not:!t.not}:"max"===e&&void 0!==i?t:"max"===e&&void 0!==n?{...t,not:!t.not}:void 0})).map((e=>[e.name,e])))}("max"):{}});let I="min-screens";for(let p of a)n(p.name,"@media ".concat(Qk(p)),{id:I,sort:o&&g?d:void 0,value:p});i("min",h("min"),{id:I,sort:d})},supportsVariants:e=>{let{matchVariant:t,theme:n}=e;var i;t("supports",(function(){let e=KW(arguments.length>0&&void 0!==arguments[0]?arguments[0]:""),t=/^\w*\s*\(/.test(e);return e=t?e.replace(/\b(and|or|not)\b/g," $1 "):e,t||(e.includes(":")||(e="".concat(e,": var(--tw)")),e.startsWith("(")&&e.endsWith(")")||(e="(".concat(e,")"))),"@supports ".concat(e)}),{values:null!=(i=n("supports"))?i:{}})},ariaVariants:e=>{let{matchVariant:t,theme:n}=e;var i,r,s;t("aria",(e=>"&[aria-".concat(KW(e),"]")),{values:null!=(i=n("aria"))?i:{}}),t("group-aria",((e,t)=>{let{modifier:n}=t;return n?":merge(.group\\/".concat(n,")[aria-").concat(KW(e),"] &"):":merge(.group)[aria-".concat(KW(e),"] &")}),{values:null!=(r=n("aria"))?r:{}}),t("peer-aria",((e,t)=>{let{modifier:n}=t;return n?":merge(.peer\\/".concat(n,")[aria-").concat(KW(e),"] ~ &"):":merge(.peer)[aria-".concat(KW(e),"] ~ &")}),{values:null!=(s=n("aria"))?s:{}})},dataVariants:e=>{let{matchVariant:t,theme:n}=e;var i,r,s;t("data",(e=>"&[data-".concat(KW(e),"]")),{values:null!=(i=n("data"))?i:{}}),t("group-data",((e,t)=>{let{modifier:n}=t;return n?":merge(.group\\/".concat(n,")[data-").concat(KW(e),"] &"):":merge(.group)[data-".concat(KW(e),"] &")}),{values:null!=(r=n("data"))?r:{}}),t("peer-data",((e,t)=>{let{modifier:n}=t;return n?":merge(.peer\\/".concat(n,")[data-").concat(KW(e),"] ~ &"):":merge(.peer)[data-".concat(KW(e),"] ~ &")}),{values:null!=(s=n("data"))?s:{}})},orientationVariants:e=>{let{addVariant:t}=e;t("portrait","@media (orientation: portrait)"),t("landscape","@media (orientation: landscape)")},prefersContrastVariants:e=>{let{addVariant:t}=e;t("contrast-more","@media (prefers-contrast: more)"),t("contrast-less","@media (prefers-contrast: less)")}},aT=["translate(var(--tw-translate-x), var(--tw-translate-y))","rotate(var(--tw-rotate))","skewX(var(--tw-skew-x))","skewY(var(--tw-skew-y))","scaleX(var(--tw-scale-x))","scaleY(var(--tw-scale-y))"].join(" "),lT=["var(--tw-blur)","var(--tw-brightness)","var(--tw-contrast)","var(--tw-grayscale)","var(--tw-hue-rotate)","var(--tw-invert)","var(--tw-saturate)","var(--tw-sepia)","var(--tw-drop-shadow)"].join(" "),cT=["var(--tw-backdrop-blur)","var(--tw-backdrop-brightness)","var(--tw-backdrop-contrast)","var(--tw-backdrop-grayscale)","var(--tw-backdrop-hue-rotate)","var(--tw-backdrop-invert)","var(--tw-backdrop-opacity)","var(--tw-backdrop-saturate)","var(--tw-backdrop-sepia)"].join(" "),gT={preflight:e=>{let{addBase:t}=e,n=cW.parse(eN.readFileSync(IN("/","./css/preflight.css"),"utf8"));t([cW.comment({text:"! tailwindcss v".concat(nW," | MIT License | https://tailwindcss.com")}),...n.nodes])},container:function(e){let{addComponents:t,theme:n}=e,i=tT(n("container.screens",n("screens"))),r=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).flatMap((e=>e.values.map((e=>e.min)))).filter((e=>void 0!==e))}(i),s=function(e,t,n){if(typeof n>"u")return[];if("object"!=typeof n||null===n)return[{screen:"DEFAULT",minWidth:0,padding:n}];let i=[];n.DEFAULT&&i.push({screen:"DEFAULT",minWidth:0,padding:n.DEFAULT});for(let r of e)for(let e of t)for(let{min:t}of e.values)t===r&&i.push({minWidth:r,padding:n[e.name]});return i}(r,i,n("container.padding")),o=e=>{let t=s.find((t=>t.minWidth===e));return t?{paddingRight:t.padding,paddingLeft:t.padding}:{}},a=Array.from(new Set(r.slice().sort(((e,t)=>parseInt(e)-parseInt(t))))).map((e=>({["@media (min-width: ".concat(e,")")]:{".container":{"max-width":e,...o(e)}}})));t([{".container":Object.assign({width:"100%"},n("container.center",!1)?{marginRight:"auto",marginLeft:"auto"}:{},o(0))},...a])},accessibility:e=>{let{addUtilities:t}=e;t({".sr-only":{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"},".not-sr-only":{position:"static",width:"auto",height:"auto",padding:"0",margin:"0",overflow:"visible",clip:"auto",whiteSpace:"normal"}})},pointerEvents:e=>{let{addUtilities:t}=e;t({".pointer-events-none":{"pointer-events":"none"},".pointer-events-auto":{"pointer-events":"auto"}})},visibility:e=>{let{addUtilities:t}=e;t({".visible":{visibility:"visible"},".invisible":{visibility:"hidden"},".collapse":{visibility:"collapse"}})},position:e=>{let{addUtilities:t}=e;t({".static":{position:"static"},".fixed":{position:"fixed"},".absolute":{position:"absolute"},".relative":{position:"relative"},".sticky":{position:"sticky"}})},inset:Hk("inset",[["inset",["inset"]],[["inset-x",["left","right"]],["inset-y",["top","bottom"]]],[["start",["inset-inline-start"]],["end",["inset-inline-end"]],["top",["top"]],["right",["right"]],["bottom",["bottom"]],["left",["left"]]]],{supportsNegativeValues:!0}),isolation:e=>{let{addUtilities:t}=e;t({".isolate":{isolation:"isolate"},".isolation-auto":{isolation:"auto"}})},zIndex:Hk("zIndex",[["z",["zIndex"]]],{supportsNegativeValues:!0}),order:Hk("order",void 0,{supportsNegativeValues:!0}),gridColumn:Hk("gridColumn",[["col",["gridColumn"]]]),gridColumnStart:Hk("gridColumnStart",[["col-start",["gridColumnStart"]]]),gridColumnEnd:Hk("gridColumnEnd",[["col-end",["gridColumnEnd"]]]),gridRow:Hk("gridRow",[["row",["gridRow"]]]),gridRowStart:Hk("gridRowStart",[["row-start",["gridRowStart"]]]),gridRowEnd:Hk("gridRowEnd",[["row-end",["gridRowEnd"]]]),float:e=>{let{addUtilities:t}=e;t({".float-right":{float:"right"},".float-left":{float:"left"},".float-none":{float:"none"}})},clear:e=>{let{addUtilities:t}=e;t({".clear-left":{clear:"left"},".clear-right":{clear:"right"},".clear-both":{clear:"both"},".clear-none":{clear:"none"}})},margin:Hk("margin",[["m",["margin"]],[["mx",["margin-left","margin-right"]],["my",["margin-top","margin-bottom"]]],[["ms",["margin-inline-start"]],["me",["margin-inline-end"]],["mt",["margin-top"]],["mr",["margin-right"]],["mb",["margin-bottom"]],["ml",["margin-left"]]]],{supportsNegativeValues:!0}),boxSizing:e=>{let{addUtilities:t}=e;t({".box-border":{"box-sizing":"border-box"},".box-content":{"box-sizing":"content-box"}})},lineClamp:e=>{let{matchUtilities:t,addUtilities:n,theme:i}=e;t({"line-clamp":e=>({overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":"".concat(e)})},{values:i("lineClamp")}),n({".line-clamp-none":{overflow:"visible",display:"block","-webkit-box-orient":"horizontal","-webkit-line-clamp":"none"}})},display:e=>{let{addUtilities:t}=e;t({".block":{display:"block"},".inline-block":{display:"inline-block"},".inline":{display:"inline"},".flex":{display:"flex"},".inline-flex":{display:"inline-flex"},".table":{display:"table"},".inline-table":{display:"inline-table"},".table-caption":{display:"table-caption"},".table-cell":{display:"table-cell"},".table-column":{display:"table-column"},".table-column-group":{display:"table-column-group"},".table-footer-group":{display:"table-footer-group"},".table-header-group":{display:"table-header-group"},".table-row-group":{display:"table-row-group"},".table-row":{display:"table-row"},".flow-root":{display:"flow-root"},".grid":{display:"grid"},".inline-grid":{display:"inline-grid"},".contents":{display:"contents"},".list-item":{display:"list-item"},".hidden":{display:"none"}})},aspectRatio:Hk("aspectRatio",[["aspect",["aspect-ratio"]]]),height:Hk("height",[["h",["height"]]]),maxHeight:Hk("maxHeight",[["max-h",["maxHeight"]]]),minHeight:Hk("minHeight",[["min-h",["minHeight"]]]),width:Hk("width",[["w",["width"]]]),minWidth:Hk("minWidth",[["min-w",["minWidth"]]]),maxWidth:Hk("maxWidth",[["max-w",["maxWidth"]]]),flex:Hk("flex"),flexShrink:Hk("flexShrink",[["flex-shrink",["flex-shrink"]],["shrink",["flex-shrink"]]]),flexGrow:Hk("flexGrow",[["flex-grow",["flex-grow"]],["grow",["flex-grow"]]]),flexBasis:Hk("flexBasis",[["basis",["flex-basis"]]]),tableLayout:e=>{let{addUtilities:t}=e;t({".table-auto":{"table-layout":"auto"},".table-fixed":{"table-layout":"fixed"}})},captionSide:e=>{let{addUtilities:t}=e;t({".caption-top":{"caption-side":"top"},".caption-bottom":{"caption-side":"bottom"}})},borderCollapse:e=>{let{addUtilities:t}=e;t({".border-collapse":{"border-collapse":"collapse"},".border-separate":{"border-collapse":"separate"}})},borderSpacing:e=>{let{addDefaults:t,matchUtilities:n,theme:i}=e;t("border-spacing",{"--tw-border-spacing-x":0,"--tw-border-spacing-y":0}),n({"border-spacing":e=>({"--tw-border-spacing-x":e,"--tw-border-spacing-y":e,"@defaults border-spacing":{},"border-spacing":"var(--tw-border-spacing-x) var(--tw-border-spacing-y)"}),"border-spacing-x":e=>({"--tw-border-spacing-x":e,"@defaults border-spacing":{},"border-spacing":"var(--tw-border-spacing-x) var(--tw-border-spacing-y)"}),"border-spacing-y":e=>({"--tw-border-spacing-y":e,"@defaults border-spacing":{},"border-spacing":"var(--tw-border-spacing-x) var(--tw-border-spacing-y)"})},{values:i("borderSpacing")})},transformOrigin:Hk("transformOrigin",[["origin",["transformOrigin"]]]),translate:Hk("translate",[[["translate-x",[["@defaults transform",{}],"--tw-translate-x",["transform",aT]]],["translate-y",[["@defaults transform",{}],"--tw-translate-y",["transform",aT]]]]],{supportsNegativeValues:!0}),rotate:Hk("rotate",[["rotate",[["@defaults transform",{}],"--tw-rotate",["transform",aT]]]],{supportsNegativeValues:!0}),skew:Hk("skew",[[["skew-x",[["@defaults transform",{}],"--tw-skew-x",["transform",aT]]],["skew-y",[["@defaults transform",{}],"--tw-skew-y",["transform",aT]]]]],{supportsNegativeValues:!0}),scale:Hk("scale",[["scale",[["@defaults transform",{}],"--tw-scale-x","--tw-scale-y",["transform",aT]]],[["scale-x",[["@defaults transform",{}],"--tw-scale-x",["transform",aT]]],["scale-y",[["@defaults transform",{}],"--tw-scale-y",["transform",aT]]]]],{supportsNegativeValues:!0}),transform:e=>{let{addDefaults:t,addUtilities:n}=e;t("transform",{"--tw-translate-x":"0","--tw-translate-y":"0","--tw-rotate":"0","--tw-skew-x":"0","--tw-skew-y":"0","--tw-scale-x":"1","--tw-scale-y":"1"}),n({".transform":{"@defaults transform":{},transform:aT},".transform-cpu":{transform:aT},".transform-gpu":{transform:aT.replace("translate(var(--tw-translate-x), var(--tw-translate-y))","translate3d(var(--tw-translate-x), var(--tw-translate-y), 0)")},".transform-none":{transform:"none"}})},animation:e=>{let{matchUtilities:t,theme:n,config:i}=e;var r;let s=e=>"".concat(i("prefix")).concat(yk(e)),o=Object.fromEntries(Object.entries(null!=(r=n("keyframes"))?r:{}).map((e=>{let[t,n]=e;return[t,{["@keyframes ".concat(s(t))]:n}]})));t({animate:e=>{let t=function(e){return e.split(_k).map((e=>{let t=e.trim(),n={value:t},i=t.split(Ok),r=new Set;for(let s of i)!r.has("DIRECTIONS")&&Kk.has(s)?(n.direction=s,r.add("DIRECTIONS")):!r.has("PLAY_STATES")&&Xk.has(s)?(n.playState=s,r.add("PLAY_STATES")):!r.has("FILL_MODES")&&Yk.has(s)?(n.fillMode=s,r.add("FILL_MODES")):r.has("ITERATION_COUNTS")||!zk.has(s)&&!jk.test(s)?!r.has("TIMING_FUNCTION")&&Pk.has(s)||!r.has("TIMING_FUNCTION")&&Uk.some((e=>s.startsWith("".concat(e,"("))))?(n.timingFunction=s,r.add("TIMING_FUNCTION")):!r.has("DURATION")&&Jk.test(s)?(n.duration=s,r.add("DURATION")):!r.has("DELAY")&&Jk.test(s)?(n.delay=s,r.add("DELAY")):r.has("NAME")?(n.unknown||(n.unknown=[]),n.unknown.push(s)):(n.name=s,r.add("NAME")):(n.iterationCount=s,r.add("ITERATION_COUNTS"));return n}))}(e);return[...t.flatMap((e=>o[e.name])),{animation:t.map((e=>{let{name:t,value:n}=e;return void 0===t||void 0===o[t]?n:n.replace(t,s(t))})).join(", ")}]}},{values:n("animation")})},cursor:Hk("cursor"),touchAction:e=>{let{addDefaults:t,addUtilities:n}=e;t("touch-action",{"--tw-pan-x":" ","--tw-pan-y":" ","--tw-pinch-zoom":" "});let i="var(--tw-pan-x) var(--tw-pan-y) var(--tw-pinch-zoom)";n({".touch-auto":{"touch-action":"auto"},".touch-none":{"touch-action":"none"},".touch-pan-x":{"@defaults touch-action":{},"--tw-pan-x":"pan-x","touch-action":i},".touch-pan-left":{"@defaults touch-action":{},"--tw-pan-x":"pan-left","touch-action":i},".touch-pan-right":{"@defaults touch-action":{},"--tw-pan-x":"pan-right","touch-action":i},".touch-pan-y":{"@defaults touch-action":{},"--tw-pan-y":"pan-y","touch-action":i},".touch-pan-up":{"@defaults touch-action":{},"--tw-pan-y":"pan-up","touch-action":i},".touch-pan-down":{"@defaults touch-action":{},"--tw-pan-y":"pan-down","touch-action":i},".touch-pinch-zoom":{"@defaults touch-action":{},"--tw-pinch-zoom":"pinch-zoom","touch-action":i},".touch-manipulation":{"touch-action":"manipulation"}})},userSelect:e=>{let{addUtilities:t}=e;t({".select-none":{"user-select":"none"},".select-text":{"user-select":"text"},".select-all":{"user-select":"all"},".select-auto":{"user-select":"auto"}})},resize:e=>{let{addUtilities:t}=e;t({".resize-none":{resize:"none"},".resize-y":{resize:"vertical"},".resize-x":{resize:"horizontal"},".resize":{resize:"both"}})},scrollSnapType:e=>{let{addDefaults:t,addUtilities:n}=e;t("scroll-snap-type",{"--tw-scroll-snap-strictness":"proximity"}),n({".snap-none":{"scroll-snap-type":"none"},".snap-x":{"@defaults scroll-snap-type":{},"scroll-snap-type":"x var(--tw-scroll-snap-strictness)"},".snap-y":{"@defaults scroll-snap-type":{},"scroll-snap-type":"y var(--tw-scroll-snap-strictness)"},".snap-both":{"@defaults scroll-snap-type":{},"scroll-snap-type":"both var(--tw-scroll-snap-strictness)"},".snap-mandatory":{"--tw-scroll-snap-strictness":"mandatory"},".snap-proximity":{"--tw-scroll-snap-strictness":"proximity"}})},scrollSnapAlign:e=>{let{addUtilities:t}=e;t({".snap-start":{"scroll-snap-align":"start"},".snap-end":{"scroll-snap-align":"end"},".snap-center":{"scroll-snap-align":"center"},".snap-align-none":{"scroll-snap-align":"none"}})},scrollSnapStop:e=>{let{addUtilities:t}=e;t({".snap-normal":{"scroll-snap-stop":"normal"},".snap-always":{"scroll-snap-stop":"always"}})},scrollMargin:Hk("scrollMargin",[["scroll-m",["scroll-margin"]],[["scroll-mx",["scroll-margin-left","scroll-margin-right"]],["scroll-my",["scroll-margin-top","scroll-margin-bottom"]]],[["scroll-ms",["scroll-margin-inline-start"]],["scroll-me",["scroll-margin-inline-end"]],["scroll-mt",["scroll-margin-top"]],["scroll-mr",["scroll-margin-right"]],["scroll-mb",["scroll-margin-bottom"]],["scroll-ml",["scroll-margin-left"]]]],{supportsNegativeValues:!0}),scrollPadding:Hk("scrollPadding",[["scroll-p",["scroll-padding"]],[["scroll-px",["scroll-padding-left","scroll-padding-right"]],["scroll-py",["scroll-padding-top","scroll-padding-bottom"]]],[["scroll-ps",["scroll-padding-inline-start"]],["scroll-pe",["scroll-padding-inline-end"]],["scroll-pt",["scroll-padding-top"]],["scroll-pr",["scroll-padding-right"]],["scroll-pb",["scroll-padding-bottom"]],["scroll-pl",["scroll-padding-left"]]]]),listStylePosition:e=>{let{addUtilities:t}=e;t({".list-inside":{"list-style-position":"inside"},".list-outside":{"list-style-position":"outside"}})},listStyleType:Hk("listStyleType",[["list",["listStyleType"]]]),listStyleImage:Hk("listStyleImage",[["list-image",["listStyleImage"]]]),appearance:e=>{let{addUtilities:t}=e;t({".appearance-none":{appearance:"none"}})},columns:Hk("columns",[["columns",["columns"]]]),breakBefore:e=>{let{addUtilities:t}=e;t({".break-before-auto":{"break-before":"auto"},".break-before-avoid":{"break-before":"avoid"},".break-before-all":{"break-before":"all"},".break-before-avoid-page":{"break-before":"avoid-page"},".break-before-page":{"break-before":"page"},".break-before-left":{"break-before":"left"},".break-before-right":{"break-before":"right"},".break-before-column":{"break-before":"column"}})},breakInside:e=>{let{addUtilities:t}=e;t({".break-inside-auto":{"break-inside":"auto"},".break-inside-avoid":{"break-inside":"avoid"},".break-inside-avoid-page":{"break-inside":"avoid-page"},".break-inside-avoid-column":{"break-inside":"avoid-column"}})},breakAfter:e=>{let{addUtilities:t}=e;t({".break-after-auto":{"break-after":"auto"},".break-after-avoid":{"break-after":"avoid"},".break-after-all":{"break-after":"all"},".break-after-avoid-page":{"break-after":"avoid-page"},".break-after-page":{"break-after":"page"},".break-after-left":{"break-after":"left"},".break-after-right":{"break-after":"right"},".break-after-column":{"break-after":"column"}})},gridAutoColumns:Hk("gridAutoColumns",[["auto-cols",["gridAutoColumns"]]]),gridAutoFlow:e=>{let{addUtilities:t}=e;t({".grid-flow-row":{gridAutoFlow:"row"},".grid-flow-col":{gridAutoFlow:"column"},".grid-flow-dense":{gridAutoFlow:"dense"},".grid-flow-row-dense":{gridAutoFlow:"row dense"},".grid-flow-col-dense":{gridAutoFlow:"column dense"}})},gridAutoRows:Hk("gridAutoRows",[["auto-rows",["gridAutoRows"]]]),gridTemplateColumns:Hk("gridTemplateColumns",[["grid-cols",["gridTemplateColumns"]]]),gridTemplateRows:Hk("gridTemplateRows",[["grid-rows",["gridTemplateRows"]]]),flexDirection:e=>{let{addUtilities:t}=e;t({".flex-row":{"flex-direction":"row"},".flex-row-reverse":{"flex-direction":"row-reverse"},".flex-col":{"flex-direction":"column"},".flex-col-reverse":{"flex-direction":"column-reverse"}})},flexWrap:e=>{let{addUtilities:t}=e;t({".flex-wrap":{"flex-wrap":"wrap"},".flex-wrap-reverse":{"flex-wrap":"wrap-reverse"},".flex-nowrap":{"flex-wrap":"nowrap"}})},placeContent:e=>{let{addUtilities:t}=e;t({".place-content-center":{"place-content":"center"},".place-content-start":{"place-content":"start"},".place-content-end":{"place-content":"end"},".place-content-between":{"place-content":"space-between"},".place-content-around":{"place-content":"space-around"},".place-content-evenly":{"place-content":"space-evenly"},".place-content-baseline":{"place-content":"baseline"},".place-content-stretch":{"place-content":"stretch"}})},placeItems:e=>{let{addUtilities:t}=e;t({".place-items-start":{"place-items":"start"},".place-items-end":{"place-items":"end"},".place-items-center":{"place-items":"center"},".place-items-baseline":{"place-items":"baseline"},".place-items-stretch":{"place-items":"stretch"}})},alignContent:e=>{let{addUtilities:t}=e;t({".content-normal":{"align-content":"normal"},".content-center":{"align-content":"center"},".content-start":{"align-content":"flex-start"},".content-end":{"align-content":"flex-end"},".content-between":{"align-content":"space-between"},".content-around":{"align-content":"space-around"},".content-evenly":{"align-content":"space-evenly"},".content-baseline":{"align-content":"baseline"},".content-stretch":{"align-content":"stretch"}})},alignItems:e=>{let{addUtilities:t}=e;t({".items-start":{"align-items":"flex-start"},".items-end":{"align-items":"flex-end"},".items-center":{"align-items":"center"},".items-baseline":{"align-items":"baseline"},".items-stretch":{"align-items":"stretch"}})},justifyContent:e=>{let{addUtilities:t}=e;t({".justify-normal":{"justify-content":"normal"},".justify-start":{"justify-content":"flex-start"},".justify-end":{"justify-content":"flex-end"},".justify-center":{"justify-content":"center"},".justify-between":{"justify-content":"space-between"},".justify-around":{"justify-content":"space-around"},".justify-evenly":{"justify-content":"space-evenly"},".justify-stretch":{"justify-content":"stretch"}})},justifyItems:e=>{let{addUtilities:t}=e;t({".justify-items-start":{"justify-items":"start"},".justify-items-end":{"justify-items":"end"},".justify-items-center":{"justify-items":"center"},".justify-items-stretch":{"justify-items":"stretch"}})},gap:Hk("gap",[["gap",["gap"]],[["gap-x",["columnGap"]],["gap-y",["rowGap"]]]]),space:e=>{let{matchUtilities:t,addUtilities:n,theme:i}=e;t({"space-x":e=>({"& > :not([hidden]) ~ :not([hidden])":{"--tw-space-x-reverse":"0","margin-right":"calc(".concat(e="0"===e?"0px":e," * var(--tw-space-x-reverse))"),"margin-left":"calc(".concat(e," * calc(1 - var(--tw-space-x-reverse)))")}}),"space-y":e=>({"& > :not([hidden]) ~ :not([hidden])":{"--tw-space-y-reverse":"0","margin-top":"calc(".concat(e="0"===e?"0px":e," * calc(1 - var(--tw-space-y-reverse)))"),"margin-bottom":"calc(".concat(e," * var(--tw-space-y-reverse))")}})},{values:i("space"),supportsNegativeValues:!0}),n({".space-y-reverse > :not([hidden]) ~ :not([hidden])":{"--tw-space-y-reverse":"1"},".space-x-reverse > :not([hidden]) ~ :not([hidden])":{"--tw-space-x-reverse":"1"}})},divideWidth:e=>{let{matchUtilities:t,addUtilities:n,theme:i}=e;t({"divide-x":e=>({"& > :not([hidden]) ~ :not([hidden])":{"@defaults border-width":{},"--tw-divide-x-reverse":"0","border-right-width":"calc(".concat(e="0"===e?"0px":e," * var(--tw-divide-x-reverse))"),"border-left-width":"calc(".concat(e," * calc(1 - var(--tw-divide-x-reverse)))")}}),"divide-y":e=>({"& > :not([hidden]) ~ :not([hidden])":{"@defaults border-width":{},"--tw-divide-y-reverse":"0","border-top-width":"calc(".concat(e="0"===e?"0px":e," * calc(1 - var(--tw-divide-y-reverse)))"),"border-bottom-width":"calc(".concat(e," * var(--tw-divide-y-reverse))")}})},{values:i("divideWidth"),type:["line-width","length","any"]}),n({".divide-y-reverse > :not([hidden]) ~ :not([hidden])":{"@defaults border-width":{},"--tw-divide-y-reverse":"1"},".divide-x-reverse > :not([hidden]) ~ :not([hidden])":{"@defaults border-width":{},"--tw-divide-x-reverse":"1"}})},divideStyle:e=>{let{addUtilities:t}=e;t({".divide-solid > :not([hidden]) ~ :not([hidden])":{"border-style":"solid"},".divide-dashed > :not([hidden]) ~ :not([hidden])":{"border-style":"dashed"},".divide-dotted > :not([hidden]) ~ :not([hidden])":{"border-style":"dotted"},".divide-double > :not([hidden]) ~ :not([hidden])":{"border-style":"double"},".divide-none > :not([hidden]) ~ :not([hidden])":{"border-style":"none"}})},divideColor:e=>{let{matchUtilities:t,theme:n,corePlugins:i}=e;t({divide:e=>i("divideOpacity")?{"& > :not([hidden]) ~ :not([hidden])":DW({color:e,property:"border-color",variable:"--tw-divide-opacity"})}:{"& > :not([hidden]) ~ :not([hidden])":{"border-color":eT(e)}}},{values:(e=>{let{DEFAULT:t,...n}=e;return n})($k(n("divideColor"))),type:["color","any"]})},divideOpacity:e=>{let{matchUtilities:t,theme:n}=e;t({"divide-opacity":e=>({"& > :not([hidden]) ~ :not([hidden])":{"--tw-divide-opacity":e}})},{values:n("divideOpacity")})},placeSelf:e=>{let{addUtilities:t}=e;t({".place-self-auto":{"place-self":"auto"},".place-self-start":{"place-self":"start"},".place-self-end":{"place-self":"end"},".place-self-center":{"place-self":"center"},".place-self-stretch":{"place-self":"stretch"}})},alignSelf:e=>{let{addUtilities:t}=e;t({".self-auto":{"align-self":"auto"},".self-start":{"align-self":"flex-start"},".self-end":{"align-self":"flex-end"},".self-center":{"align-self":"center"},".self-stretch":{"align-self":"stretch"},".self-baseline":{"align-self":"baseline"}})},justifySelf:e=>{let{addUtilities:t}=e;t({".justify-self-auto":{"justify-self":"auto"},".justify-self-start":{"justify-self":"start"},".justify-self-end":{"justify-self":"end"},".justify-self-center":{"justify-self":"center"},".justify-self-stretch":{"justify-self":"stretch"}})},overflow:e=>{let{addUtilities:t}=e;t({".overflow-auto":{overflow:"auto"},".overflow-hidden":{overflow:"hidden"},".overflow-clip":{overflow:"clip"},".overflow-visible":{overflow:"visible"},".overflow-scroll":{overflow:"scroll"},".overflow-x-auto":{"overflow-x":"auto"},".overflow-y-auto":{"overflow-y":"auto"},".overflow-x-hidden":{"overflow-x":"hidden"},".overflow-y-hidden":{"overflow-y":"hidden"},".overflow-x-clip":{"overflow-x":"clip"},".overflow-y-clip":{"overflow-y":"clip"},".overflow-x-visible":{"overflow-x":"visible"},".overflow-y-visible":{"overflow-y":"visible"},".overflow-x-scroll":{"overflow-x":"scroll"},".overflow-y-scroll":{"overflow-y":"scroll"}})},overscrollBehavior:e=>{let{addUtilities:t}=e;t({".overscroll-auto":{"overscroll-behavior":"auto"},".overscroll-contain":{"overscroll-behavior":"contain"},".overscroll-none":{"overscroll-behavior":"none"},".overscroll-y-auto":{"overscroll-behavior-y":"auto"},".overscroll-y-contain":{"overscroll-behavior-y":"contain"},".overscroll-y-none":{"overscroll-behavior-y":"none"},".overscroll-x-auto":{"overscroll-behavior-x":"auto"},".overscroll-x-contain":{"overscroll-behavior-x":"contain"},".overscroll-x-none":{"overscroll-behavior-x":"none"}})},scrollBehavior:e=>{let{addUtilities:t}=e;t({".scroll-auto":{"scroll-behavior":"auto"},".scroll-smooth":{"scroll-behavior":"smooth"}})},textOverflow:e=>{let{addUtilities:t}=e;t({".truncate":{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},".overflow-ellipsis":{"text-overflow":"ellipsis"},".text-ellipsis":{"text-overflow":"ellipsis"},".text-clip":{"text-overflow":"clip"}})},hyphens:e=>{let{addUtilities:t}=e;t({".hyphens-none":{hyphens:"none"},".hyphens-manual":{hyphens:"manual"},".hyphens-auto":{hyphens:"auto"}})},whitespace:e=>{let{addUtilities:t}=e;t({".whitespace-normal":{"white-space":"normal"},".whitespace-nowrap":{"white-space":"nowrap"},".whitespace-pre":{"white-space":"pre"},".whitespace-pre-line":{"white-space":"pre-line"},".whitespace-pre-wrap":{"white-space":"pre-wrap"},".whitespace-break-spaces":{"white-space":"break-spaces"}})},wordBreak:e=>{let{addUtilities:t}=e;t({".break-normal":{"overflow-wrap":"normal","word-break":"normal"},".break-words":{"overflow-wrap":"break-word"},".break-all":{"word-break":"break-all"},".break-keep":{"word-break":"keep-all"}})},borderRadius:Hk("borderRadius",[["rounded",["border-radius"]],[["rounded-s",["border-start-start-radius","border-end-start-radius"]],["rounded-e",["border-start-end-radius","border-end-end-radius"]],["rounded-t",["border-top-left-radius","border-top-right-radius"]],["rounded-r",["border-top-right-radius","border-bottom-right-radius"]],["rounded-b",["border-bottom-right-radius","border-bottom-left-radius"]],["rounded-l",["border-top-left-radius","border-bottom-left-radius"]]],[["rounded-ss",["border-start-start-radius"]],["rounded-se",["border-start-end-radius"]],["rounded-ee",["border-end-end-radius"]],["rounded-es",["border-end-start-radius"]],["rounded-tl",["border-top-left-radius"]],["rounded-tr",["border-top-right-radius"]],["rounded-br",["border-bottom-right-radius"]],["rounded-bl",["border-bottom-left-radius"]]]]),borderWidth:Hk("borderWidth",[["border",[["@defaults border-width",{}],"border-width"]],[["border-x",[["@defaults border-width",{}],"border-left-width","border-right-width"]],["border-y",[["@defaults border-width",{}],"border-top-width","border-bottom-width"]]],[["border-s",[["@defaults border-width",{}],"border-inline-start-width"]],["border-e",[["@defaults border-width",{}],"border-inline-end-width"]],["border-t",[["@defaults border-width",{}],"border-top-width"]],["border-r",[["@defaults border-width",{}],"border-right-width"]],["border-b",[["@defaults border-width",{}],"border-bottom-width"]],["border-l",[["@defaults border-width",{}],"border-left-width"]]]],{type:["line-width","length"]}),borderStyle:e=>{let{addUtilities:t}=e;t({".border-solid":{"border-style":"solid"},".border-dashed":{"border-style":"dashed"},".border-dotted":{"border-style":"dotted"},".border-double":{"border-style":"double"},".border-hidden":{"border-style":"hidden"},".border-none":{"border-style":"none"}})},borderColor:e=>{let{matchUtilities:t,theme:n,corePlugins:i}=e;t({border:e=>i("borderOpacity")?DW({color:e,property:"border-color",variable:"--tw-border-opacity"}):{"border-color":eT(e)}},{values:(e=>{let{DEFAULT:t,...n}=e;return n})($k(n("borderColor"))),type:["color","any"]}),t({"border-x":e=>i("borderOpacity")?DW({color:e,property:["border-left-color","border-right-color"],variable:"--tw-border-opacity"}):{"border-left-color":eT(e),"border-right-color":eT(e)},"border-y":e=>i("borderOpacity")?DW({color:e,property:["border-top-color","border-bottom-color"],variable:"--tw-border-opacity"}):{"border-top-color":eT(e),"border-bottom-color":eT(e)}},{values:(e=>{let{DEFAULT:t,...n}=e;return n})($k(n("borderColor"))),type:["color","any"]}),t({"border-s":e=>i("borderOpacity")?DW({color:e,property:"border-inline-start-color",variable:"--tw-border-opacity"}):{"border-inline-start-color":eT(e)},"border-e":e=>i("borderOpacity")?DW({color:e,property:"border-inline-end-color",variable:"--tw-border-opacity"}):{"border-inline-end-color":eT(e)},"border-t":e=>i("borderOpacity")?DW({color:e,property:"border-top-color",variable:"--tw-border-opacity"}):{"border-top-color":eT(e)},"border-r":e=>i("borderOpacity")?DW({color:e,property:"border-right-color",variable:"--tw-border-opacity"}):{"border-right-color":eT(e)},"border-b":e=>i("borderOpacity")?DW({color:e,property:"border-bottom-color",variable:"--tw-border-opacity"}):{"border-bottom-color":eT(e)},"border-l":e=>i("borderOpacity")?DW({color:e,property:"border-left-color",variable:"--tw-border-opacity"}):{"border-left-color":eT(e)}},{values:(e=>{let{DEFAULT:t,...n}=e;return n})($k(n("borderColor"))),type:["color","any"]})},borderOpacity:Hk("borderOpacity",[["border-opacity",["--tw-border-opacity"]]]),backgroundColor:e=>{let{matchUtilities:t,theme:n,corePlugins:i}=e;t({bg:e=>i("backgroundOpacity")?DW({color:e,property:"background-color",variable:"--tw-bg-opacity"}):{"background-color":eT(e)}},{values:$k(n("backgroundColor")),type:["color","any"]})},backgroundOpacity:Hk("backgroundOpacity",[["bg-opacity",["--tw-bg-opacity"]]]),backgroundImage:Hk("backgroundImage",[["bg",["background-image"]]],{type:["lookup","image","url"]}),gradientColorStops:(()=>{function e(e){return ZW(e,0,"rgb(255 255 255 / 0)")}return function(t){let{matchUtilities:n,theme:i,addDefaults:r}=t;r("gradient-color-stops",{"--tw-gradient-from-position":" ","--tw-gradient-via-position":" ","--tw-gradient-to-position":" "});let s={values:$k(i("gradientColorStops")),type:["color","any"]},o={values:i("gradientColorStopPositions"),type:["length","percentage"]};n({from:t=>{let n=e(t);return{"@defaults gradient-color-stops":{},"--tw-gradient-from":"".concat(eT(t)," var(--tw-gradient-from-position)"),"--tw-gradient-to":"".concat(n," var(--tw-gradient-to-position)"),"--tw-gradient-stops":"var(--tw-gradient-from), var(--tw-gradient-to)"}}},s),n({from:e=>({"--tw-gradient-from-position":e})},o),n({via:t=>{let n=e(t);return{"@defaults gradient-color-stops":{},"--tw-gradient-to":"".concat(n,"  var(--tw-gradient-to-position)"),"--tw-gradient-stops":"var(--tw-gradient-from), ".concat(eT(t)," var(--tw-gradient-via-position), var(--tw-gradient-to)")}}},s),n({via:e=>({"--tw-gradient-via-position":e})},o),n({to:e=>({"@defaults gradient-color-stops":{},"--tw-gradient-to":"".concat(eT(e)," var(--tw-gradient-to-position)")})},s),n({to:e=>({"--tw-gradient-to-position":e})},o)}})(),boxDecorationBreak:e=>{let{addUtilities:t}=e;t({".decoration-slice":{"box-decoration-break":"slice"},".decoration-clone":{"box-decoration-break":"clone"},".box-decoration-slice":{"box-decoration-break":"slice"},".box-decoration-clone":{"box-decoration-break":"clone"}})},backgroundSize:Hk("backgroundSize",[["bg",["background-size"]]],{type:["lookup","length","percentage","size"]}),backgroundAttachment:e=>{let{addUtilities:t}=e;t({".bg-fixed":{"background-attachment":"fixed"},".bg-local":{"background-attachment":"local"},".bg-scroll":{"background-attachment":"scroll"}})},backgroundClip:e=>{let{addUtilities:t}=e;t({".bg-clip-border":{"background-clip":"border-box"},".bg-clip-padding":{"background-clip":"padding-box"},".bg-clip-content":{"background-clip":"content-box"},".bg-clip-text":{"background-clip":"text"}})},backgroundPosition:Hk("backgroundPosition",[["bg",["background-position"]]],{type:["lookup",["position",{preferOnConflict:!0}]]}),backgroundRepeat:e=>{let{addUtilities:t}=e;t({".bg-repeat":{"background-repeat":"repeat"},".bg-no-repeat":{"background-repeat":"no-repeat"},".bg-repeat-x":{"background-repeat":"repeat-x"},".bg-repeat-y":{"background-repeat":"repeat-y"},".bg-repeat-round":{"background-repeat":"round"},".bg-repeat-space":{"background-repeat":"space"}})},backgroundOrigin:e=>{let{addUtilities:t}=e;t({".bg-origin-border":{"background-origin":"border-box"},".bg-origin-padding":{"background-origin":"padding-box"},".bg-origin-content":{"background-origin":"content-box"}})},fill:e=>{let{matchUtilities:t,theme:n}=e;t({fill:e=>({fill:eT(e)})},{values:$k(n("fill")),type:["color","any"]})},stroke:e=>{let{matchUtilities:t,theme:n}=e;t({stroke:e=>({stroke:eT(e)})},{values:$k(n("stroke")),type:["color","url","any"]})},strokeWidth:Hk("strokeWidth",[["stroke",["stroke-width"]]],{type:["length","number","percentage"]}),objectFit:e=>{let{addUtilities:t}=e;t({".object-contain":{"object-fit":"contain"},".object-cover":{"object-fit":"cover"},".object-fill":{"object-fit":"fill"},".object-none":{"object-fit":"none"},".object-scale-down":{"object-fit":"scale-down"}})},objectPosition:Hk("objectPosition",[["object",["object-position"]]]),padding:Hk("padding",[["p",["padding"]],[["px",["padding-left","padding-right"]],["py",["padding-top","padding-bottom"]]],[["ps",["padding-inline-start"]],["pe",["padding-inline-end"]],["pt",["padding-top"]],["pr",["padding-right"]],["pb",["padding-bottom"]],["pl",["padding-left"]]]]),textAlign:e=>{let{addUtilities:t}=e;t({".text-left":{"text-align":"left"},".text-center":{"text-align":"center"},".text-right":{"text-align":"right"},".text-justify":{"text-align":"justify"},".text-start":{"text-align":"start"},".text-end":{"text-align":"end"}})},textIndent:Hk("textIndent",[["indent",["text-indent"]]],{supportsNegativeValues:!0}),verticalAlign:e=>{let{addUtilities:t,matchUtilities:n}=e;t({".align-baseline":{"vertical-align":"baseline"},".align-top":{"vertical-align":"top"},".align-middle":{"vertical-align":"middle"},".align-bottom":{"vertical-align":"bottom"},".align-text-top":{"vertical-align":"text-top"},".align-text-bottom":{"vertical-align":"text-bottom"},".align-sub":{"vertical-align":"sub"},".align-super":{"vertical-align":"super"}}),n({align:e=>({"vertical-align":e})})},fontFamily:e=>{let{matchUtilities:t,theme:n}=e;t({font:e=>{let[t,n={}]=Array.isArray(e)&&IW(e[1])?e:[e],{fontFeatureSettings:i,fontVariationSettings:r}=n;return{"font-family":Array.isArray(t)?t.join(", "):t,...void 0===i?{}:{"font-feature-settings":i},...void 0===r?{}:{"font-variation-settings":r}}}},{values:n("fontFamily"),type:["lookup","generic-name","family-name"]})},fontSize:e=>{let{matchUtilities:t,theme:n}=e;t({text:(e,t)=>{let{modifier:n}=t,[i,r]=Array.isArray(e)?e:[e];if(n)return{"font-size":i,"line-height":n};let{lineHeight:s,letterSpacing:o,fontWeight:a}=IW(r)?r:{lineHeight:r};return{"font-size":i,...void 0===s?{}:{"line-height":s},...void 0===o?{}:{"letter-spacing":o},...void 0===a?{}:{"font-weight":a}}}},{values:n("fontSize"),modifiers:n("lineHeight"),type:["absolute-size","relative-size","length","percentage"]})},fontWeight:Hk("fontWeight",[["font",["fontWeight"]]],{type:["lookup","number","any"]}),textTransform:e=>{let{addUtilities:t}=e;t({".uppercase":{"text-transform":"uppercase"},".lowercase":{"text-transform":"lowercase"},".capitalize":{"text-transform":"capitalize"},".normal-case":{"text-transform":"none"}})},fontStyle:e=>{let{addUtilities:t}=e;t({".italic":{"font-style":"italic"},".not-italic":{"font-style":"normal"}})},fontVariantNumeric:e=>{let{addDefaults:t,addUtilities:n}=e,i="var(--tw-ordinal) var(--tw-slashed-zero) var(--tw-numeric-figure) var(--tw-numeric-spacing) var(--tw-numeric-fraction)";t("font-variant-numeric",{"--tw-ordinal":" ","--tw-slashed-zero":" ","--tw-numeric-figure":" ","--tw-numeric-spacing":" ","--tw-numeric-fraction":" "}),n({".normal-nums":{"font-variant-numeric":"normal"},".ordinal":{"@defaults font-variant-numeric":{},"--tw-ordinal":"ordinal","font-variant-numeric":i},".slashed-zero":{"@defaults font-variant-numeric":{},"--tw-slashed-zero":"slashed-zero","font-variant-numeric":i},".lining-nums":{"@defaults font-variant-numeric":{},"--tw-numeric-figure":"lining-nums","font-variant-numeric":i},".oldstyle-nums":{"@defaults font-variant-numeric":{},"--tw-numeric-figure":"oldstyle-nums","font-variant-numeric":i},".proportional-nums":{"@defaults font-variant-numeric":{},"--tw-numeric-spacing":"proportional-nums","font-variant-numeric":i},".tabular-nums":{"@defaults font-variant-numeric":{},"--tw-numeric-spacing":"tabular-nums","font-variant-numeric":i},".diagonal-fractions":{"@defaults font-variant-numeric":{},"--tw-numeric-fraction":"diagonal-fractions","font-variant-numeric":i},".stacked-fractions":{"@defaults font-variant-numeric":{},"--tw-numeric-fraction":"stacked-fractions","font-variant-numeric":i}})},lineHeight:Hk("lineHeight",[["leading",["lineHeight"]]]),letterSpacing:Hk("letterSpacing",[["tracking",["letterSpacing"]]],{supportsNegativeValues:!0}),textColor:e=>{let{matchUtilities:t,theme:n,corePlugins:i}=e;t({text:e=>i("textOpacity")?DW({color:e,property:"color",variable:"--tw-text-opacity"}):{color:eT(e)}},{values:$k(n("textColor")),type:["color","any"]})},textOpacity:Hk("textOpacity",[["text-opacity",["--tw-text-opacity"]]]),textDecoration:e=>{let{addUtilities:t}=e;t({".underline":{"text-decoration-line":"underline"},".overline":{"text-decoration-line":"overline"},".line-through":{"text-decoration-line":"line-through"},".no-underline":{"text-decoration-line":"none"}})},textDecorationColor:e=>{let{matchUtilities:t,theme:n}=e;t({decoration:e=>({"text-decoration-color":eT(e)})},{values:$k(n("textDecorationColor")),type:["color","any"]})},textDecorationStyle:e=>{let{addUtilities:t}=e;t({".decoration-solid":{"text-decoration-style":"solid"},".decoration-double":{"text-decoration-style":"double"},".decoration-dotted":{"text-decoration-style":"dotted"},".decoration-dashed":{"text-decoration-style":"dashed"},".decoration-wavy":{"text-decoration-style":"wavy"}})},textDecorationThickness:Hk("textDecorationThickness",[["decoration",["text-decoration-thickness"]]],{type:["length","percentage"]}),textUnderlineOffset:Hk("textUnderlineOffset",[["underline-offset",["text-underline-offset"]]],{type:["length","percentage","any"]}),fontSmoothing:e=>{let{addUtilities:t}=e;t({".antialiased":{"-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale"},".subpixel-antialiased":{"-webkit-font-smoothing":"auto","-moz-osx-font-smoothing":"auto"}})},placeholderColor:e=>{let{matchUtilities:t,theme:n,corePlugins:i}=e;t({placeholder:e=>i("placeholderOpacity")?{"&::placeholder":DW({color:e,property:"color",variable:"--tw-placeholder-opacity"})}:{"&::placeholder":{color:eT(e)}}},{values:$k(n("placeholderColor")),type:["color","any"]})},placeholderOpacity:e=>{let{matchUtilities:t,theme:n}=e;t({"placeholder-opacity":e=>({"&::placeholder":{"--tw-placeholder-opacity":e}})},{values:n("placeholderOpacity")})},caretColor:e=>{let{matchUtilities:t,theme:n}=e;t({caret:e=>({"caret-color":eT(e)})},{values:$k(n("caretColor")),type:["color","any"]})},accentColor:e=>{let{matchUtilities:t,theme:n}=e;t({accent:e=>({"accent-color":eT(e)})},{values:$k(n("accentColor")),type:["color","any"]})},opacity:Hk("opacity",[["opacity",["opacity"]]]),backgroundBlendMode:e=>{let{addUtilities:t}=e;t({".bg-blend-normal":{"background-blend-mode":"normal"},".bg-blend-multiply":{"background-blend-mode":"multiply"},".bg-blend-screen":{"background-blend-mode":"screen"},".bg-blend-overlay":{"background-blend-mode":"overlay"},".bg-blend-darken":{"background-blend-mode":"darken"},".bg-blend-lighten":{"background-blend-mode":"lighten"},".bg-blend-color-dodge":{"background-blend-mode":"color-dodge"},".bg-blend-color-burn":{"background-blend-mode":"color-burn"},".bg-blend-hard-light":{"background-blend-mode":"hard-light"},".bg-blend-soft-light":{"background-blend-mode":"soft-light"},".bg-blend-difference":{"background-blend-mode":"difference"},".bg-blend-exclusion":{"background-blend-mode":"exclusion"},".bg-blend-hue":{"background-blend-mode":"hue"},".bg-blend-saturation":{"background-blend-mode":"saturation"},".bg-blend-color":{"background-blend-mode":"color"},".bg-blend-luminosity":{"background-blend-mode":"luminosity"}})},mixBlendMode:e=>{let{addUtilities:t}=e;t({".mix-blend-normal":{"mix-blend-mode":"normal"},".mix-blend-multiply":{"mix-blend-mode":"multiply"},".mix-blend-screen":{"mix-blend-mode":"screen"},".mix-blend-overlay":{"mix-blend-mode":"overlay"},".mix-blend-darken":{"mix-blend-mode":"darken"},".mix-blend-lighten":{"mix-blend-mode":"lighten"},".mix-blend-color-dodge":{"mix-blend-mode":"color-dodge"},".mix-blend-color-burn":{"mix-blend-mode":"color-burn"},".mix-blend-hard-light":{"mix-blend-mode":"hard-light"},".mix-blend-soft-light":{"mix-blend-mode":"soft-light"},".mix-blend-difference":{"mix-blend-mode":"difference"},".mix-blend-exclusion":{"mix-blend-mode":"exclusion"},".mix-blend-hue":{"mix-blend-mode":"hue"},".mix-blend-saturation":{"mix-blend-mode":"saturation"},".mix-blend-color":{"mix-blend-mode":"color"},".mix-blend-luminosity":{"mix-blend-mode":"luminosity"},".mix-blend-plus-lighter":{"mix-blend-mode":"plus-lighter"}})},boxShadow:(()=>{let e=Lk("boxShadow"),t=["var(--tw-ring-offset-shadow, 0 0 #0000)","var(--tw-ring-shadow, 0 0 #0000)","var(--tw-shadow)"].join(", ");return function(n){let{matchUtilities:i,addDefaults:r,theme:s}=n;r(" box-shadow",{"--tw-ring-offset-shadow":"0 0 #0000","--tw-ring-shadow":"0 0 #0000","--tw-shadow":"0 0 #0000","--tw-shadow-colored":"0 0 #0000"}),i({shadow:n=>{let i=kW(n=e(n));for(let e of i)!e.valid||(e.color="var(--tw-shadow-color)");return{"@defaults box-shadow":{},"--tw-shadow":"none"===n?"0 0 #0000":n,"--tw-shadow-colored":"none"===n?"0 0 #0000":TW(i),"box-shadow":t}}},{values:s("boxShadow"),type:["shadow"]})}})(),boxShadowColor:e=>{let{matchUtilities:t,theme:n}=e;t({shadow:e=>({"--tw-shadow-color":eT(e),"--tw-shadow":"var(--tw-shadow-colored)"})},{values:$k(n("boxShadowColor")),type:["color","any"]})},outlineStyle:e=>{let{addUtilities:t}=e;t({".outline-none":{outline:"2px solid transparent","outline-offset":"2px"},".outline":{"outline-style":"solid"},".outline-dashed":{"outline-style":"dashed"},".outline-dotted":{"outline-style":"dotted"},".outline-double":{"outline-style":"double"}})},outlineWidth:Hk("outlineWidth",[["outline",["outline-width"]]],{type:["length","number","percentage"]}),outlineOffset:Hk("outlineOffset",[["outline-offset",["outline-offset"]]],{type:["length","number","percentage","any"],supportsNegativeValues:!0}),outlineColor:e=>{let{matchUtilities:t,theme:n}=e;t({outline:e=>({"outline-color":eT(e)})},{values:$k(n("outlineColor")),type:["color","any"]})},ringWidth:e=>{let{matchUtilities:t,addDefaults:n,addUtilities:i,theme:r,config:s}=e,o=(()=>{var e,t;if(rk(s(),"respectDefaultRingColorOpacity"))return r("ringColor.DEFAULT");let n=r("ringOpacity.DEFAULT","0.5");return null!=(e=r("ringColor"))&&e.DEFAULT?ZW(null==(t=r("ringColor"))?void 0:t.DEFAULT,n,"rgb(147 197 253 / ".concat(n,")")):"rgb(147 197 253 / ".concat(n,")")})();n("ring-width",{"--tw-ring-inset":" ","--tw-ring-offset-width":r("ringOffsetWidth.DEFAULT","0px"),"--tw-ring-offset-color":r("ringOffsetColor.DEFAULT","#fff"),"--tw-ring-color":o,"--tw-ring-offset-shadow":"0 0 #0000","--tw-ring-shadow":"0 0 #0000","--tw-shadow":"0 0 #0000","--tw-shadow-colored":"0 0 #0000"}),t({ring:e=>({"@defaults ring-width":{},"--tw-ring-offset-shadow":"var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color)","--tw-ring-shadow":"var(--tw-ring-inset) 0 0 0 calc(".concat(e," + var(--tw-ring-offset-width)) var(--tw-ring-color)"),"box-shadow":["var(--tw-ring-offset-shadow)","var(--tw-ring-shadow)","var(--tw-shadow, 0 0 #0000)"].join(", ")})},{values:r("ringWidth"),type:"length"}),i({".ring-inset":{"@defaults ring-width":{},"--tw-ring-inset":"inset"}})},ringColor:e=>{let{matchUtilities:t,theme:n,corePlugins:i}=e;t({ring:e=>i("ringOpacity")?DW({color:e,property:"--tw-ring-color",variable:"--tw-ring-opacity"}):{"--tw-ring-color":eT(e)}},{values:Object.fromEntries(Object.entries($k(n("ringColor"))).filter((e=>{let[t]=e;return"DEFAULT"!==t}))),type:["color","any"]})},ringOpacity:e=>{let{config:t}=e;return Hk("ringOpacity",[["ring-opacity",["--tw-ring-opacity"]]],{filterDefault:!rk(t(),"respectDefaultRingColorOpacity")})(e)},ringOffsetWidth:Hk("ringOffsetWidth",[["ring-offset",["--tw-ring-offset-width"]]],{type:"length"}),ringOffsetColor:e=>{let{matchUtilities:t,theme:n}=e;t({"ring-offset":e=>({"--tw-ring-offset-color":eT(e)})},{values:$k(n("ringOffsetColor")),type:["color","any"]})},blur:e=>{let{matchUtilities:t,theme:n}=e;t({blur:e=>({"--tw-blur":"blur(".concat(e,")"),"@defaults filter":{},filter:lT})},{values:n("blur")})},brightness:e=>{let{matchUtilities:t,theme:n}=e;t({brightness:e=>({"--tw-brightness":"brightness(".concat(e,")"),"@defaults filter":{},filter:lT})},{values:n("brightness")})},contrast:e=>{let{matchUtilities:t,theme:n}=e;t({contrast:e=>({"--tw-contrast":"contrast(".concat(e,")"),"@defaults filter":{},filter:lT})},{values:n("contrast")})},dropShadow:e=>{let{matchUtilities:t,theme:n}=e;t({"drop-shadow":e=>({"--tw-drop-shadow":Array.isArray(e)?e.map((e=>"drop-shadow(".concat(e,")"))).join(" "):"drop-shadow(".concat(e,")"),"@defaults filter":{},filter:lT})},{values:n("dropShadow")})},grayscale:e=>{let{matchUtilities:t,theme:n}=e;t({grayscale:e=>({"--tw-grayscale":"grayscale(".concat(e,")"),"@defaults filter":{},filter:lT})},{values:n("grayscale")})},hueRotate:e=>{let{matchUtilities:t,theme:n}=e;t({"hue-rotate":e=>({"--tw-hue-rotate":"hue-rotate(".concat(e,")"),"@defaults filter":{},filter:lT})},{values:n("hueRotate"),supportsNegativeValues:!0})},invert:e=>{let{matchUtilities:t,theme:n}=e;t({invert:e=>({"--tw-invert":"invert(".concat(e,")"),"@defaults filter":{},filter:lT})},{values:n("invert")})},saturate:e=>{let{matchUtilities:t,theme:n}=e;t({saturate:e=>({"--tw-saturate":"saturate(".concat(e,")"),"@defaults filter":{},filter:lT})},{values:n("saturate")})},sepia:e=>{let{matchUtilities:t,theme:n}=e;t({sepia:e=>({"--tw-sepia":"sepia(".concat(e,")"),"@defaults filter":{},filter:lT})},{values:n("sepia")})},filter:e=>{let{addDefaults:t,addUtilities:n}=e;t("filter",{"--tw-blur":" ","--tw-brightness":" ","--tw-contrast":" ","--tw-grayscale":" ","--tw-hue-rotate":" ","--tw-invert":" ","--tw-saturate":" ","--tw-sepia":" ","--tw-drop-shadow":" "}),n({".filter":{"@defaults filter":{},filter:lT},".filter-none":{filter:"none"}})},backdropBlur:e=>{let{matchUtilities:t,theme:n}=e;t({"backdrop-blur":e=>({"--tw-backdrop-blur":"blur(".concat(e,")"),"@defaults backdrop-filter":{},"backdrop-filter":cT})},{values:n("backdropBlur")})},backdropBrightness:e=>{let{matchUtilities:t,theme:n}=e;t({"backdrop-brightness":e=>({"--tw-backdrop-brightness":"brightness(".concat(e,")"),"@defaults backdrop-filter":{},"backdrop-filter":cT})},{values:n("backdropBrightness")})},backdropContrast:e=>{let{matchUtilities:t,theme:n}=e;t({"backdrop-contrast":e=>({"--tw-backdrop-contrast":"contrast(".concat(e,")"),"@defaults backdrop-filter":{},"backdrop-filter":cT})},{values:n("backdropContrast")})},backdropGrayscale:e=>{let{matchUtilities:t,theme:n}=e;t({"backdrop-grayscale":e=>({"--tw-backdrop-grayscale":"grayscale(".concat(e,")"),"@defaults backdrop-filter":{},"backdrop-filter":cT})},{values:n("backdropGrayscale")})},backdropHueRotate:e=>{let{matchUtilities:t,theme:n}=e;t({"backdrop-hue-rotate":e=>({"--tw-backdrop-hue-rotate":"hue-rotate(".concat(e,")"),"@defaults backdrop-filter":{},"backdrop-filter":cT})},{values:n("backdropHueRotate"),supportsNegativeValues:!0})},backdropInvert:e=>{let{matchUtilities:t,theme:n}=e;t({"backdrop-invert":e=>({"--tw-backdrop-invert":"invert(".concat(e,")"),"@defaults backdrop-filter":{},"backdrop-filter":cT})},{values:n("backdropInvert")})},backdropOpacity:e=>{let{matchUtilities:t,theme:n}=e;t({"backdrop-opacity":e=>({"--tw-backdrop-opacity":"opacity(".concat(e,")"),"@defaults backdrop-filter":{},"backdrop-filter":cT})},{values:n("backdropOpacity")})},backdropSaturate:e=>{let{matchUtilities:t,theme:n}=e;t({"backdrop-saturate":e=>({"--tw-backdrop-saturate":"saturate(".concat(e,")"),"@defaults backdrop-filter":{},"backdrop-filter":cT})},{values:n("backdropSaturate")})},backdropSepia:e=>{let{matchUtilities:t,theme:n}=e;t({"backdrop-sepia":e=>({"--tw-backdrop-sepia":"sepia(".concat(e,")"),"@defaults backdrop-filter":{},"backdrop-filter":cT})},{values:n("backdropSepia")})},backdropFilter:e=>{let{addDefaults:t,addUtilities:n}=e;t("backdrop-filter",{"--tw-backdrop-blur":" ","--tw-backdrop-brightness":" ","--tw-backdrop-contrast":" ","--tw-backdrop-grayscale":" ","--tw-backdrop-hue-rotate":" ","--tw-backdrop-invert":" ","--tw-backdrop-opacity":" ","--tw-backdrop-saturate":" ","--tw-backdrop-sepia":" "}),n({".backdrop-filter":{"@defaults backdrop-filter":{},"backdrop-filter":cT},".backdrop-filter-none":{"backdrop-filter":"none"}})},transitionProperty:e=>{let{matchUtilities:t,theme:n}=e,i=n("transitionTimingFunction.DEFAULT"),r=n("transitionDuration.DEFAULT");t({transition:e=>({"transition-property":e,..."none"===e?{}:{"transition-timing-function":i,"transition-duration":r}})},{values:n("transitionProperty")})},transitionDelay:Hk("transitionDelay",[["delay",["transitionDelay"]]]),transitionDuration:Hk("transitionDuration",[["duration",["transitionDuration"]]],{filterDefault:!0}),transitionTimingFunction:Hk("transitionTimingFunction",[["ease",["transitionTimingFunction"]]],{filterDefault:!0}),willChange:Hk("willChange",[["will-change",["will-change"]]]),content:Hk("content",[["content",["--tw-content",["content","var(--tw-content)"]]]])};function uT(e){if(Array.isArray(e))return e;if(e.split("[").length-1!==e.split("]").length-1)throw new Error("Path is invalid. Has unbalanced brackets: ".concat(e));return e.split(/\.(?![^\[]*\])|[\[\]]/g).filter(Boolean)}var AT=new Map([["{","}"],["[","]"],["(",")"]]),dT=new Map(Array.from(AT.entries()).map((e=>{let[t,n]=e;return[n,t]}))),hT=new Set(['"',"'","`"]);function IT(e){let t=[],n=!1;for(let i=0;i<e.length;i++){let r=e[i];if(":"===r&&!n&&0===t.length)return!1;if(hT.has(r)&&"\\"!==e[i-1]&&(n=!n),!n&&"\\"!==e[i-1])if(AT.has(r))t.push(r);else if(dT.has(r)){let e=dT.get(r);if(t.length<=0||t.pop()!==e)return!1}}return!(t.length>0)}function pT(e){return(e>0n)-(e<0n)}function CT(e,t){let n=0n,i=0n;for(let[r,s]of t)e&r&&(n|=r,i|=s);return e&~n|i}var mT=class{constructor(){this.offsets={defaults:0n,base:0n,components:0n,utilities:0n,variants:0n,user:0n},this.layerPositions={defaults:0n,base:1n,components:2n,utilities:3n,user:4n,variants:5n},this.reservedVariantBits=0n,this.variantOffsets=new Map}create(e){return{layer:e,parentLayer:e,arbitrary:0n,variants:0n,parallelIndex:0n,index:this.offsets[e]++,options:[]}}arbitraryProperty(){return{...this.create("utilities"),arbitrary:1n}}forVariant(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.variantOffsets.get(e);if(void 0===n)throw new Error("Cannot find offset for unknown variant ".concat(e));return{...this.create("variants"),variants:n<<BigInt(t)}}applyVariantOffset(e,t,n){return n.variant=t.variants,{...e,layer:"variants",parentLayer:"variants"===e.layer?e.parentLayer:e.layer,variants:e.variants|t.variants,options:n.sort?[].concat(n,e.options):e.options,parallelIndex:fT([e.parallelIndex,t.parallelIndex])}}applyParallelOffset(e,t){return{...e,parallelIndex:BigInt(t)}}recordVariants(e,t){for(let n of e)this.recordVariant(n,t(n))}recordVariant(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.variantOffsets.set(e,1n<<this.reservedVariantBits),this.reservedVariantBits+=BigInt(t),{...this.create("variants"),variants:this.variantOffsets.get(e)}}compare(e,t){var n;if(e.layer!==t.layer)return this.layerPositions[e.layer]-this.layerPositions[t.layer];if(e.parentLayer!==t.parentLayer)return this.layerPositions[e.parentLayer]-this.layerPositions[t.parentLayer];for(let i of e.options)for(let r of t.options){if(i.id!==r.id||!i.sort||!r.sort)continue;let s=null!=(n=fT([i.variant,r.variant]))?n:0n,o=~(s|s-1n);if((e.variants&o)!==(t.variants&o))continue;let a=i.sort({value:i.value,modifier:i.modifier},{value:r.value,modifier:r.modifier});if(0!==a)return a}return e.variants!==t.variants?e.variants-t.variants:e.parallelIndex!==t.parallelIndex?e.parallelIndex-t.parallelIndex:e.arbitrary!==t.arbitrary?e.arbitrary-t.arbitrary:e.index-t.index}recalculateVariantOffsets(){let e=Array.from(this.variantOffsets.entries()).filter((e=>{let[t]=e;return t.startsWith("[")})).sort(((e,t)=>{let[n]=e,[i]=t;return function(e,t){let n=e.length,i=t.length,r=n<i?n:i;for(let s=0;s<r;s++){let n=e.charCodeAt(s)-t.charCodeAt(s);if(0!==n)return n}return n-i}(n,i)})),t=e.map((e=>{let[,t]=e;return t})).sort(((e,t)=>pT(e-t)));return e.map(((e,n)=>{let[,i]=e;return[i,t[n]]})).filter((e=>{let[t,n]=e;return t!==n}))}remapArbitraryVariantOffsets(e){let t=this.recalculateVariantOffsets();return 0===t.length?e:e.map((e=>{let[n,i]=e;return n={...n,variants:CT(n.variants,t)},[n,i]}))}sort(e){return(e=this.remapArbitraryVariantOffsets(e)).sort(((e,t)=>{let[n]=e,[i]=t;return pT(this.compare(n,i))}))}};function fT(e){let t=null;for(let n of e)t=null!=t?t:n,t=t>n?t:n;return t}var yT={AddVariant:Symbol.for("ADD_VARIANT"),MatchVariant:Symbol.for("MATCH_VARIANT")},bT={Base:1,Dynamic:2};function BT(e,t){let n=e.tailwindConfig.prefix;return"function"==typeof n?n(t):n+t}function vT(e){let{type:t="any",...n}=e;return{...n,types:[].concat(t).map((e=>Array.isArray(e)?{type:e[0],...e[1]}:{type:e,preferOnConflict:!1}))}}function wT(e){return Array.isArray(e)?e.flatMap((e=>Array.isArray(e)||IW(e)?hW(e):e)):wT([e])}function GT(e,t){return(0,Vk.default)((e=>{let n=[];return t&&t(e),e.walkClasses((e=>{n.push(e.value)})),n})).transformSync(e)}function ET(e){return wT(e).flatMap((e=>{let t=new Map,[n,i]=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{containsNonOnDemandable:!1},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=[];if("rule"===e.type){let n=function(e){e.walkPseudos((e=>{":not"===e.value&&e.remove()}))};for(let r of e.selectors){let e=GT(r,n);0===e.length&&(t.containsNonOnDemandable=!0);for(let t of e)i.push(t)}}else"atrule"===e.type&&e.walkRules((e=>{for(let t of e.selectors.flatMap((e=>GT(e))))i.push(t)}));return 0===n?[t.containsNonOnDemandable||0===i.length,i]:i}(e);return n&&i.unshift(oW),i.map((n=>(t.has(e)||t.set(e,e),[n,t.get(e)])))}))}function xT(e){return e.startsWith("@")||e.includes("&")}function ST(e){let t=function(e){let t=[],n="",i=0;for(let r=0;r<e.length;r++){let s=e[r];if("\\"===s)n+="\\"+e[++r];else if("{"===s)++i,t.push(n.trim()),n="";else if("}"===s){if(--i<0)throw new Error("Your { and } are unbalanced.");t.push(n.trim()),n=""}else n+=s}return n.length>0&&t.push(n.trim()),t=t.filter((e=>""!==e)),t}(e=e.replace(/\n+/g,"").replace(/\s{1,}/g," ").trim()).map((e=>{if(!e.startsWith("@"))return t=>{let{format:n}=t;return n(e)};let[,t,n]=/@(.*?)( .+|[({].*)/g.exec(e);return e=>{let{wrap:i}=e;return i(cW.atRule({name:t,params:n.trim()}))}})).reverse();return e=>{for(let n of t)n(e)}}function RT(e,t,n){let{variantList:i,variantMap:r,offsets:s,classList:o}=n;function a(t,n){return t?(0,Tk.default)(e,t,n):e}function l(e,n){return e===oW?oW:n.respectPrefix?t.tailwindConfig.prefix+e:e}let c=0,g={postcss:cW,prefix:function(t){return CW(e.prefix,t)},e:yk,config:a,theme:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=uT(e),r=a(["theme",...i],t);return Lk(i[0])(r,n)},corePlugins:t=>Array.isArray(e.corePlugins)?e.corePlugins.includes(t):a(["corePlugins",t],!0),variants:()=>[],addBase(e){for(let[n,i]of ET(e)){let e=l(n,{}),r=s.create("base");t.candidateRuleMap.has(e)||t.candidateRuleMap.set(e,[]),t.candidateRuleMap.get(e).push([{sort:r,layer:"base"},i])}},addDefaults(e,n){let i={["@defaults ".concat(e)]:n};for(let[r,o]of ET(i)){let e=l(r,{});t.candidateRuleMap.has(e)||t.candidateRuleMap.set(e,[]),t.candidateRuleMap.get(e).push([{sort:s.create("defaults"),layer:"defaults"},o])}},addComponents(e,n){n=Object.assign({},{preserveSource:!1,respectPrefix:!0,respectImportant:!1},Array.isArray(n)?{}:n);for(let[i,r]of ET(e)){let e=l(i,n);o.add(e),t.candidateRuleMap.has(e)||t.candidateRuleMap.set(e,[]),t.candidateRuleMap.get(e).push([{sort:s.create("components"),layer:"components",options:n},r])}},addUtilities(e,n){n=Object.assign({},{preserveSource:!1,respectPrefix:!0,respectImportant:!0},Array.isArray(n)?{}:n);for(let[i,r]of ET(e)){let e=l(i,n);o.add(e),t.candidateRuleMap.has(e)||t.candidateRuleMap.set(e,[]),t.candidateRuleMap.get(e).push([{sort:s.create("utilities"),layer:"utilities",options:n},r])}},matchUtilities:function(n,i){i=vT({respectPrefix:!0,respectImportant:!0,modifiers:!1,...i});let r=s.create("utilities");for(let s in n){let a=function(t,n){let{isOnlyPlugin:r}=n,[o,a,l]=Ik(i.types,t,i,e);if(void 0===o)return[];if(!i.types.some((e=>{let{type:t}=e;return t===a}))){if(!r)return[];eW.warn(["Unnecessary typehint `".concat(a,"` in `").concat(s,"-").concat(t,"`."),"You can safely update it to `".concat(s,"-").concat(t.replace(a+":",""),"`.")])}if(!IT(o))return[];let c={get modifier(){return i.modifiers||eW.warn("modifier-used-without-options-for-".concat(s),["Your plugin must set `modifiers: true` in its options to support modifiers."]),l}},u=rk(e,"generalizedModifiers");return[].concat(u?g(o,c):g(o)).filter(Boolean).map((e=>({[Wk(s,t)]:e})))},c=l(s,i),g=n[s];o.add([c,i]);let u=[{sort:r,layer:"utilities",options:i},a];t.candidateRuleMap.has(c)||t.candidateRuleMap.set(c,[]),t.candidateRuleMap.get(c).push(u)}},matchComponents:function(n,i){i=vT({respectPrefix:!0,respectImportant:!1,modifiers:!1,...i});let r=s.create("components");for(let s in n){let a=function(t,n){let{isOnlyPlugin:r}=n,[o,a,l]=Ik(i.types,t,i,e);if(void 0===o)return[];if(!i.types.some((e=>{let{type:t}=e;return t===a}))){if(!r)return[];eW.warn(["Unnecessary typehint `".concat(a,"` in `").concat(s,"-").concat(t,"`."),"You can safely update it to `".concat(s,"-").concat(t.replace(a+":",""),"`.")])}if(!IT(o))return[];let c={get modifier(){return i.modifiers||eW.warn("modifier-used-without-options-for-".concat(s),["Your plugin must set `modifiers: true` in its options to support modifiers."]),l}},u=rk(e,"generalizedModifiers");return[].concat(u?g(o,c):g(o)).filter(Boolean).map((e=>({[Wk(s,t)]:e})))},c=l(s,i),g=n[s];o.add([c,i]);let u=[{sort:r,layer:"components",options:i},a];t.candidateRuleMap.has(c)||t.candidateRuleMap.set(c,[]),t.candidateRuleMap.get(c).push(u)}},addVariant(e,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n=[].concat(n).map((t=>{if("string"!=typeof t)return function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{args:i,modifySelectors:r,container:o,separator:a,wrap:l,format:c}=n,g=t(Object.assign({modifySelectors:r,container:o,separator:a},s.type===yT.MatchVariant&&{args:i,wrap:l,format:c}));if("string"==typeof g&&!xT(g))throw new Error("Your custom variant `".concat(e,"` has an invalid format string. Make sure it's an at-rule or contains a `&` placeholder."));return Array.isArray(g)?g.filter((e=>"string"==typeof e)).map((e=>ST(e))):g&&"string"==typeof g&&ST(g)(n)};if(!xT(t))throw new Error("Your custom variant `".concat(e,"` has an invalid format string. Make sure it's an at-rule or contains a `&` placeholder."));return ST(t)})),function(e,t){let{before:n=[]}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(n=[].concat(n),n.length<=0)return void e.push(t);let i=e.length-1;for(let r of n){let t=e.indexOf(r);-1!==t&&(i=Math.min(i,t))}e.splice(i,0,t)}(i,e,s),r.set(e,n),t.variantOptions.set(e,s)},matchVariant(t,n,i){var r,s,o;let a=null!=(r=null==i?void 0:i.id)?r:++c,l="@"===t,u=rk(e,"generalizedModifiers");for(let[e,c]of Object.entries(null!=(s=null==i?void 0:i.values)?s:{}))"DEFAULT"!==e&&g.addVariant(l?"".concat(t).concat(e):"".concat(t,"-").concat(e),(e=>{let{args:t,container:i}=e;return n(c,u?{modifier:null==t?void 0:t.modifier,container:i}:{container:i})}),{...i,value:c,id:a,type:yT.MatchVariant,variantInfo:bT.Base});let A="DEFAULT"in(null!=(o=null==i?void 0:i.values)?o:{});g.addVariant(t,(e=>{let{args:t,container:r}=e;var s;return(null==t?void 0:t.value)!==aW||A?n((null==t?void 0:t.value)===aW?i.values.DEFAULT:null!=(s=null==t?void 0:t.value)?s:"string"==typeof t?t:"",u?{modifier:null==t?void 0:t.modifier,container:r}:{container:r}):null}),{...i,id:a,type:yT.MatchVariant,variantInfo:bT.Dynamic})}};return g}function ZT(e){e.walkAtRules((e=>{["responsive","variants"].includes(e.name)&&(ZT(e),e.before(e.nodes),e.remove())}))}function DT(e){let t=[];return e.each((e=>{"atrule"===e.type&&["responsive","variants"].includes(e.name)&&(e.name="layer",e.params="utilities")})),e.walkAtRules("layer",(e=>{if(ZT(e),"base"===e.params){for(let n of e.nodes)t.push((function(e){let{addBase:t}=e;t(n,{respectPrefix:!1})}));e.remove()}else if("components"===e.params){for(let n of e.nodes)t.push((function(e){let{addComponents:t}=e;t(n,{respectPrefix:!1,preserveSource:!0})}));e.remove()}else if("utilities"===e.params){for(let n of e.nodes)t.push((function(e){let{addUtilities:t}=e;t(n,{respectPrefix:!1,preserveSource:!0})}));e.remove()}})),t}function FT(e,t){!e.classCache.has(t)||(e.notClassCache.add(t),e.classCache.delete(t),e.applyClassCache.delete(t),e.candidateRuleMap.delete(t),e.candidateRuleCache.delete(t),e.stylesheetCache=null)}function NT(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:cW.root();var i;let r={disposables:[],ruleCache:new Set,candidateRuleCache:new Map,classCache:new Map,applyClassCache:new Map,notClassCache:new Set(null!=(i=e.blocklist)?i:[]),postCssNodeCache:new Map,candidateRuleMap:new Map,tailwindConfig:e,changedContent:t,variantMap:new Map,stylesheetCache:null,variantOptions:new Map,markInvalidUtilityCandidate:e=>FT(r,e),markInvalidUtilityNode:e=>function(e,t){let n=t.raws.tailwind.candidate;if(n){for(let t of e.ruleCache)t[1].raws.tailwind.candidate===n&&e.ruleCache.delete(t);FT(e,n)}}(r,e)},s=function(e,t){let n=Object.entries({...oT,...gT}).map((t=>{let[n,i]=t;return e.tailwindConfig.corePlugins.includes(n)?i:null})).filter(Boolean),i=e.tailwindConfig.plugins.map((e=>(e.__isOptionsFunction&&(e=e()),"function"==typeof e?e:e.handler))),r=DT(t);return[...n,oT.pseudoElementVariants,oT.pseudoClassVariants,oT.ariaVariants,oT.dataVariants,...i,oT.supportsVariants,oT.directionVariants,oT.reducedMotionVariants,oT.prefersContrastVariants,oT.darkVariants,oT.printVariant,oT.screenVariants,oT.orientationVariants,...r]}(r,n);return function(e,t){var n,i,r;let s=[],o=new Map;t.variantMap=o;let a=new mT;t.offsets=a;let l=new Set,c=RT(t.tailwindConfig,t,{variantList:s,variantMap:o,offsets:a,classList:l});for(let d of e)if(Array.isArray(d))for(let e of d)e(c);else null==d||d(c);a.recordVariants(s,(e=>o.get(e).length));for(let[d,h]of o.entries())t.variantMap.set(d,h.map(((e,t)=>[a.forVariant(d,t),e])));let g=(null!=(n=t.tailwindConfig.safelist)?n:[]).filter(Boolean);if(g.length>0){let e=[];for(let n of g)"string"!=typeof n?n instanceof RegExp?eW.warn("root-regex",["Regular expressions in `safelist` work differently in Tailwind CSS v3.0.","Update your `safelist` configuration to eliminate this warning.","https://tailwindcss.com/docs/content-configuration#safelisting-classes"]):e.push(n):t.changedContent.push({content:n,extension:"html"});if(e.length>0){let n=new Map,i=t.tailwindConfig.prefix.length,r=e.some((e=>e.pattern.source.includes("!")));for(let s of l){let o=Array.isArray(s)?(()=>{var e;let[n,o]=s,a=Object.keys(null!=(e=null==o?void 0:o.values)?e:{}).map((e=>kk(n,e)));return null!=o&&o.supportsNegativeValues&&(a=[...a,...a.map((e=>"-"+e))],a=[...a,...a.map((e=>e.slice(0,i)+"-"+e.slice(i)))]),o.types.some((e=>{let{type:t}=e;return"color"===t}))&&(a=[...a,...a.flatMap((e=>Object.keys(t.tailwindConfig.theme.opacity).map((t=>"".concat(e,"/").concat(t)))))]),r&&(null==o?void 0:o.respectImportant)&&(a=[...a,...a.map((e=>"!"+e))]),a})():[s];for(let i of o)for(let{pattern:r,variants:s=[]}of e)if(r.lastIndex=0,n.has(r)||n.set(r,0),r.test(i)){n.set(r,n.get(r)+1),t.changedContent.push({content:i,extension:"html"});for(let e of s)t.changedContent.push({content:e+t.tailwindConfig.separator+i,extension:"html"})}}for(let[e,t]of n.entries())0===t&&eW.warn(["The safelist pattern `".concat(e,"` doesn't match any Tailwind CSS classes."),"Fix this pattern or remove it from your `safelist` configuration.","https://tailwindcss.com/docs/content-configuration#safelisting-classes"])}}let u=null!=(r=[].concat(null!=(i=t.tailwindConfig.darkMode)?i:"media")[1])?r:"dark",A=[BT(t,u),BT(t,"group"),BT(t,"peer")];t.getClassOrder=function(e){let n=[...e].sort(((e,t)=>e===t?0:e<t?-1:1)),i=new Map(n.map((e=>[e,null]))),r=JT(new Set(n),t);r=t.offsets.sort(r);let s=BigInt(A.length);for(let[,t]of r)i.set(t.raws.tailwind.candidate,s++);return e.map((e=>{var t;let n=null!=(t=i.get(e))?t:null,r=A.indexOf(e);return null===n&&-1!==r&&(n=BigInt(r)),[e,n]}))},t.getClassList=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var n,i,r,s;let o=[];for(let a of l)if(Array.isArray(a)){let[l,c]=a,g=[],u=Object.keys(null!=(n=null==c?void 0:c.modifiers)?n:{});null!=(i=null==c?void 0:c.types)&&i.some((e=>{let{type:t}=e;return"color"===t}))&&u.push(...Object.keys(null!=(r=t.tailwindConfig.theme.opacity)?r:{}));let A={modifiers:u},d=e.includeMetadata&&u.length>0;for(let[e,t]of Object.entries(null!=(s=null==c?void 0:c.values)?s:{})){if(null==t)continue;let n=kk(l,e);if(o.push(d?[n,A]:n),(null==c?void 0:c.supportsNegativeValues)&&tk(t)){let t=kk(l,"-".concat(e));g.push(d?[t,A]:t)}}o.push(...g)}else o.push(a);return o},t.getVariants=function(){var e;let n=[];for(let[i,r]of t.variantOptions.entries())r.variantInfo!==bT.Base&&n.push({name:i,isArbitrary:r.type===Symbol.for("MATCH_VARIANT"),values:Object.keys(null!=(e=r.values)?e:{}),hasDash:"@"!==i,selectors(){let{modifier:e,value:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var s,o,a,l;let c="__TAILWIND_PLACEHOLDER__",g=cW.rule({selector:".".concat(c)}),u=cW.root({nodes:[g.clone()]}),A=u.toString(),d=(null!=(s=t.variantMap.get(i))?s:[]).flatMap((e=>{let[t,n]=e;return n})),h=[];for(let i of d){let s=[],l={args:{modifier:e,value:null!=(a=null==(o=r.values)?void 0:o[n])?a:n},separator:t.tailwindConfig.separator,modifySelectors:e=>(u.each((t=>{"rule"===t.type&&(t.selectors=t.selectors.map((t=>e({get className(){return TT(t)},selector:t}))))})),u),format(e){s.push(e)},wrap(e){s.push("@".concat(e.name," ").concat(e.params," { & }"))},container:u},c=i(l);if(s.length>0&&h.push(s),Array.isArray(c))for(let e of c)s=[],e(l),h.push(s)}let I=[];A!==u.toString()&&(u.walkRules((e=>{let n=e.selector,r=(0,Vk.default)((e=>{e.walkClasses((e=>{e.value="".concat(i).concat(t.tailwindConfig.separator).concat(e.value)}))})).processSync(n);I.push(n.replace(r,"&").replace(c,"&"))})),u.walkAtRules((e=>{I.push("@".concat(e.name," (").concat(e.params,") { & }"))})));let p=!(n in(null!=(l=r.values)?l:{}));h=h.map((e=>e.map((e=>({format:e,isArbitraryVariant:p}))))),I=I.map((e=>({format:e,isArbitraryVariant:p})));let C={candidate:c,context:t},m=h.map((e=>Fk(".".concat(c),Rk(e,C),C).replace(".".concat(c),"&").replace("{ & }","").trim()));return I.length>0&&m.push(Rk(I,C).toString().replace(".".concat(c),"&")),m}});return n}}(s,r),r}var MT=JF(fM());function WT(e,t){let n=(0,MT.default)().astSync(e);return n.each((e=>{"pseudo"===e.nodes[0].type&&":is"===e.nodes[0].value&&e.nodes.every((e=>"combinator"!==e.type))||(e.nodes=[MT.default.pseudo({value:":is",nodes:[e.clone()]})]),Bk(e)})),"".concat(t," ").concat(n.toString())}var kT=(0,gW.default)((e=>e.first.filter((e=>{let{type:t}=e;return"class"===t})).pop().value));function TT(e){return kT.transformSync(e)}function VT(e,t){if(0===e.length||""===t.tailwindConfig.prefix)return e;for(let n of e){let[e]=n;if(e.options.respectPrefix){let e=cW.root({nodes:[n[1].clone()]}),i=n[1].raws.tailwind.classCandidate;e.walkRules((e=>{let n=i.startsWith("-");e.selector=CW(t.tailwindConfig.prefix,e.selector,n)})),n[1]=e.nodes[0]}}return e}function LT(e,t){if(0===e.length)return e;let n=[];for(let[i,r]of e){let e=cW.root({nodes:[r.clone()]});e.walkRules((e=>{let n=(0,gW.default)().astSync(e.selector);n.each((e=>Dk(e,t))),sk(n,(e=>e===t?"!".concat(e):e)),e.selector=n.toString(),e.walkDecls((e=>e.important=!0))})),n.push([{...i,important:!0},e.nodes[0]])}return n}function HT(e,t,n){var i;if(0===t.length)return t;let r={modifier:null,value:aW};{let[t,...i]=FW(e,"/");if(i.length>1&&(t=t+"/"+i.slice(0,-1).join("/"),i=i.slice(-1)),i.length&&!n.variantMap.has(e)&&(e=t,r.modifier=i[0],!rk(n.tailwindConfig,"generalizedModifiers")))return[]}if(e.endsWith("]")&&!e.startsWith("[")){let t=/(.)(-?)\[(.*)\]/g.exec(e);if(t){let[,n,i,s]=t;if("@"===n&&"-"===i)return[];if("@"!==n&&""===i)return[];e=e.replace("".concat(i,"[").concat(s,"]"),""),r.value=s}}if(jT(e)&&!n.variantMap.has(e)){let t=n.offsets.recordVariant(e),i=FW(KW(e.slice(1,-1)),",");if(i.length>1)return[];if(!i.every(xT))return[];let r=i.map(((e,i)=>[n.offsets.applyParallelOffset(t,i),ST(e.trim())]));n.variantMap.set(e,r)}if(n.variantMap.has(e)){let s=jT(e),o=n.variantMap.get(e).slice(),a=[];for(let[l,c]of t){if("user"===l.layer)continue;let t=cW.root({nodes:[c.clone()]});for(let[c,g,u]of o){let A=function(){h.raws.neededBackup||(h.raws.neededBackup=!0,h.walkRules((e=>e.raws.originalSelector=e.selector)))},d=function(e){return A(),h.each((t=>{"rule"===t.type&&(t.selectors=t.selectors.map((t=>e({get className(){return TT(t)},selector:t}))))})),h},h=(null!=u?u:t).clone(),I=[],p=g({get container(){return A(),h},separator:n.tailwindConfig.separator,modifySelectors:d,wrap(e){let t=h.nodes;h.removeAll(),e.append(t),h.append(e)},format(e){I.push({format:e,isArbitraryVariant:s})},args:r});if(Array.isArray(p)){for(let[e,t]of p.entries())o.push([n.offsets.applyParallelOffset(c,e),t,h.clone()]);continue}if("string"==typeof p&&I.push({format:p,isArbitraryVariant:s}),null===p)continue;h.raws.neededBackup&&(delete h.raws.neededBackup,h.walkRules((t=>{let i=t.raws.originalSelector;if(!i||(delete t.raws.originalSelector,i===t.selector))return;let r=t.selector,o=(0,gW.default)((t=>{t.walkClasses((t=>{t.value="".concat(e).concat(n.tailwindConfig.separator).concat(t.value)}))})).processSync(i);I.push({format:r.replace(o,"&"),isArbitraryVariant:s}),t.selector=i}))),h.nodes[0].raws.tailwind={...h.nodes[0].raws.tailwind,parentLayer:l.layer};let C=[{...l,sort:n.offsets.applyVariantOffset(l.sort,c,Object.assign(r,n.variantOptions.get(e))),collectedFormats:(null!=(i=l.collectedFormats)?i:[]).concat(I)},h.nodes[0]];a.push(C)}}return a}return[]}function QT(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return IW(e)||Array.isArray(e)?Array.isArray(e)?QT(e[0],t,e[1]):(t.has(e)||t.set(e,hW(e)),[t.get(e),n]):[[e],n]}var KT=/^[a-z_-]/;function XT(e){let t=!0;return e.walkDecls((e=>{if(!YT(e.prop,e.value))return t=!1,!1})),t}function YT(e,t){if(function(e){if(!e.includes("://"))return!1;try{let t=new URL(e);return""!==t.scheme&&""!==t.host}catch{return!1}}("".concat(e,":").concat(t)))return!1;try{return cW.parse("a{".concat(e,":").concat(t,"}")).toResult(),!0}catch{return!1}}function zT(e,t){var n;let[,i,r]=null!=(n=e.match(/^\[([a-zA-Z0-9-_]+):(\S+)\]$/))?n:[];if(void 0===r||!function(e){return KT.test(e)}(i)||!IT(r))return null;let s=KW(r);return YT(i,s)?[[{sort:t.offsets.arbitraryProperty(),layer:"utilities"},()=>({[Mk(e)]:{[i]:s}})]]:null}function*PT(e,t){var n,i;for(let r of e)r[1].raws.tailwind={...r[1].raws.tailwind,classCandidate:t,preserveSource:null!=(i=null==(n=r[0].options)?void 0:n.preserveSource)&&i},yield r}function UT(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return function*(){var i,r,s,o;let a=t.tailwindConfig.separator,[l,...c]=function(e,t){return e===oW?[oW]:FW(e,t)}(e,a).reverse(),g=!1;if(l.startsWith("!")&&(g=!0,l=l.slice(1)),rk(t.tailwindConfig,"variantGrouping")&&l.startsWith("(")&&l.endsWith(")")){let e=c.slice().reverse().join(a);for(let i of FW(l.slice(1,-1),","))yield*UT(e+a+i,t,n)}for(let u of function*(e,t){t.candidateRuleMap.has(e)&&(yield[t.candidateRuleMap.get(e),"DEFAULT"]),yield*function*(e){null!==e&&(yield[e,"DEFAULT"])}(zT(e,t));let n=e,i=!1,r=t.tailwindConfig.prefix,s=r.length,o=n.startsWith(r)||n.startsWith("-".concat(r));"-"===n[s]&&o&&(i=!0,n=r+n.slice(s+1)),i&&t.candidateRuleMap.has(n)&&(yield[t.candidateRuleMap.get(n),"-DEFAULT"]);for(let[a,l]of function*(e){let t=1/0;for(;t>=0;){let n,i=!1;if(t===1/0&&e.endsWith("]")){let t=e.indexOf("[");"-"===e[t-1]?n=t-1:"/"===e[t-1]?(n=t-1,i=!0):n=-1}else t===1/0&&e.includes("/")?(n=e.lastIndexOf("/"),i=!0):n=e.lastIndexOf("-",t);if(n<0)break;let r=e.slice(0,n),s=e.slice(i?n:n+1);t=n-1,""!==r&&"/"!==s&&(yield[r,s])}}(n))t.candidateRuleMap.has(a)&&(yield[t.candidateRuleMap.get(a),i?"-".concat(l):l])}(l,t)){let a=[],A=new Map,[d,h]=u,I=1===d.length;for(let[e,n]of d){let o=[];if("function"==typeof n)for(let i of[].concat(n(h,{isOnlyPlugin:I}))){let[n,r]=QT(i,t.postCssNodeCache);for(let t of n)o.push([{...e,options:{...e.options,...r}},t])}else if("DEFAULT"===h||"-DEFAULT"===h){let i=n,[r,s]=QT(i,t.postCssNodeCache);for(let t of r)o.push([{...e,options:{...e.options,...s}},t])}if(o.length>0){let n=Array.from(pk(null!=(r=null==(i=e.options)?void 0:i.types)?r:[],h,null!=(s=e.options)?s:{},t.tailwindConfig)).map((e=>{let[t,n]=e;return n}));n.length>0&&A.set(o,n),a.push(o)}}if(jT(h)){if(a.length>1){let t=function(e){return 1===e.length?e[0]:e.find((e=>{let t=A.get(e);return e.some((e=>{let[{options:n},i]=e;return!!XT(i)&&n.types.some((e=>{let{type:n,preferOnConflict:i}=e;return t.includes(n)&&i}))}))}))},[n,i]=a.reduce(((e,t)=>(t.some((e=>{let[{options:t}]=e;return t.types.some((e=>{let{type:t}=e;return"any"===t}))}))?e[0].push(t):e[1].push(t),e)),[[],[]]),r=null!=(o=t(i))?o:t(n);if(!r){let t=a.map((e=>{var t;return new Set([...null!=(t=A.get(e))?t:[]])}));for(let e of t)for(let n of e){let i=!1;for(let r of t)e!==r&&r.has(n)&&(r.delete(n),i=!0);i&&e.delete(n)}let n=[];for(let[i,r]of t.entries())for(let t of r){let r=a[i].map((e=>{let[,t]=e;return t})).flat().map((e=>e.toString().split("\n").slice(1,-1).map((e=>e.trim())).map((e=>"      ".concat(e))).join("\n"))).join("\n\n");n.push("  Use `".concat(e.replace("[","[".concat(t,":")),"` for `").concat(r.trim(),"`"));break}eW.warn(["The class `".concat(e,"` is ambiguous and matches multiple utilities."),...n,"If this is content and not a class, replace it with `".concat(e.replace("[","&lsqb;").replace("]","&rsqb;"),"` to silence this warning.")]);continue}a=[r]}a=a.map((e=>e.filter((e=>XT(e[1])))))}a=a.flat(),a=Array.from(PT(a,l)),a=VT(a,t),g&&(a=LT(a,l));for(let e of c)a=HT(e,a,t);for(let i of a)i[1].raws.tailwind={...i[1].raws.tailwind,candidate:e},i=_T(i,{context:t,candidate:e,original:n}),null!==i&&(yield i)}}()}function _T(e,t){let{context:n,candidate:i,original:r}=t;if(!e[0].collectedFormats)return e;let s,o=!0;try{s=Rk(e[0].collectedFormats,{context:n,candidate:i})}catch{return null}let a=cW.root({nodes:[e[1].clone()]});return a.walkRules((e=>{if(!OT(e))try{e.selector=Fk(e.selector,s,{candidate:r,context:n})}catch{return o=!1,!1}})),o?(e[1]=a.nodes[0],e):null}function OT(e){return e.parent&&"atrule"===e.parent.type&&"keyframes"===e.parent.name}function JT(e,t){var n;let i=[],r=function(e){return!0===e?e=>{OT(e)||e.walkDecls((e=>{"rule"===e.parent.type&&!OT(e.parent)&&(e.important=!0)}))}:"string"==typeof e?t=>{OT(t)||(t.selectors=t.selectors.map((t=>WT(t,e))))}:void 0}(t.tailwindConfig.important);for(let s of e){if(t.notClassCache.has(s))continue;if(t.candidateRuleCache.has(s)){i=i.concat(Array.from(t.candidateRuleCache.get(s)));continue}let e=Array.from(UT(s,t));if(0===e.length){t.notClassCache.add(s);continue}t.classCache.set(s,e);let o=null!=(n=t.candidateRuleCache.get(s))?n:new Set;t.candidateRuleCache.set(s,o);for(let n of e){let[{sort:e,options:s},a]=n;if(s.respectImportant&&r){let e=cW.root({nodes:[a.clone()]});e.walkRules(r),a=e.nodes[0]}let l=[e,a];o.add(l),t.ruleCache.add(l),i.push(l)}}return i}function jT(e){return e.startsWith("[")&&e.endsWith("]")}function qT(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return e.map((e=>{var i;let r=e.clone(),s=!0!==(null==(i=e.raws.tailwind)?void 0:i.preserveSource)||!r.source;return void 0!==t&&s&&(r.source=t,"walk"in r&&r.walk((e=>{e.source=t}))),void 0!==n&&(r.raws.tailwind={...r.raws.tailwind,...n}),r}))}var $T=/[\\^$.*+?()[\]{}|]/g,eV=RegExp($T.source);function tV(e){return e=(e=Array.isArray(e)?e:[e]).map((e=>e instanceof RegExp?e.source:e)),e.join("")}function nV(e){return new RegExp(tV(e),"g")}function iV(e){return"(?:".concat(e.map(tV).join("|"),")")}function rV(e){return"(?:".concat(tV(e),")?")}function sV(e){return"(?:".concat(tV(e),")*")}function oV(e){return e&&eV.test(e)?e.replace($T,"\\$&"):e||""}var aV=/([\[\]'"`])([^\[\]'"`])?/g,lV=/[^"'`\s<>\]]+/;function cV(e){if(!e.includes("-["))return e;let t=0,n=[],i=e.matchAll(aV);i=Array.from(i).flatMap((e=>{let[,...t]=e;return t.map(((t,n)=>Object.assign([],e,{index:e.index+n,0:t})))}));for(let r of i){let i=r[0],s=n[n.length-1];if(i===s?n.pop():("'"===i||'"'===i||"`"===i)&&n.push(i),!s){if("["===i){t++;continue}if("]"===i){t--;continue}if(t<0)return e.substring(0,r.index-1);if(0===t&&!lV.test(i))return e.substring(0,r.index)}}return e}var gV=rW,uV={DEFAULT:function(e){let t=Array.from(function*(e){let t=e.tailwindConfig.separator,n=rk(e.tailwindConfig,"variantGrouping"),i=""!==e.tailwindConfig.prefix?rV(nV([/-?/,oV(e.tailwindConfig.prefix)])):"",r=iV([/\[[^\s:'"`]+:[^\s\[\]]+\]/,/\[[^\s:'"`]+:[^\s]+?\[[^\s]+\][^\s]+?\]/,nV([/-?(?:\w+)/,rV(iV([nV([/-(?:\w+-)*\[[^\s:]+\]/,/(?![{([]])/,/(?:\/[^\s'"`\\><$]*)?/]),nV([/-(?:\w+-)*\[[^\s]+\]/,/(?![{([]])/,/(?:\/[^\s'"`\\$]*)?/]),/[-\/][^\s'"`\\$={><]*/]))])]),s=[iV([nV([/@\[[^\s"'`]+\](\/[^\s"'`]+)?/,t]),nV([/([^\s"'`\[\\]+-)?\[[^\s"'`]+\]/,t]),nV([/[^\s"'`\[\\]+/,t])]),iV([nV([/([^\s"'`\[\\]+-)?\[[^\s`]+\]/,t]),nV([/[^\s`\[\\]+/,t])])];for(let o of s)yield nV(["((?=((",o,")+))\\2)?",/!?/,i,n?iV([nV([/\(/,r,sV([/,/,r]),/\)/]),r]):r]);yield/[^<>"'`\s.(){}[\]#=%$]*[^<>"'`\s.(){}[\]#=%:$]/g}(e));return e=>{var n;let i=[];for(let r of t)i=[...i,...null!=(n=e.match(r))?n:[]];return i.filter((e=>void 0!==e)).map(cV)}}},AV={DEFAULT:e=>e,svelte:e=>e.replace(/(?:^|\s)class:/g," ")};function dV(e,t){let n=e.tailwindConfig.content.extract;return n[t]||n.DEFAULT||uV[t]||uV.DEFAULT(e)}function hV(e,t){let n=e.content.transform;return n[t]||n.DEFAULT||AV[t]||AV.DEFAULT}var IV=new WeakMap;function pV(e,t,n,i){IV.has(t)||IV.set(t,new tW.default({maxSize:25e3}));for(let r of e.split("\n"))if(r=r.trim(),!i.has(r))if(i.add(r),IV.get(t).has(r))for(let e of IV.get(t).get(r))n.add(e);else{let e=t(r).filter((e=>"!*"!==e)),i=new Set(e);for(let t of i)n.add(t);IV.get(t).set(r,i)}}function CV(e){return t=>{var n;let i={base:null,components:null,utilities:null,variants:null};if(t.walkAtRules((e=>{"tailwind"===e.name&&Object.keys(i).includes(e.params)&&(i[e.params]=e)})),Object.values(i).every((e=>null===e)))return t;let r=new Set([...null!=(n=e.candidates)?n:[],oW]),s=new Set;gV.DEBUG&&console.time("Reading changed files");for(let{file:I,content:p,extension:C}of e.changedContent){let t=hV(e.tailwindConfig,C),n=dV(e,C);p=I?eN.readFileSync(I,"utf8"):p,pV(t(p),n,r,s)}gV.DEBUG&&console.timeEnd("Reading changed files");let o=e.classCache.size;gV.DEBUG&&console.time("Generate rules"),gV.DEBUG&&console.time("Sorting candidates");let a=new Set([...r].sort(((e,t)=>e===t?0:e<t?-1:1)));gV.DEBUG&&console.timeEnd("Sorting candidates"),JT(a,e),gV.DEBUG&&console.timeEnd("Generate rules"),gV.DEBUG&&console.time("Build stylesheet"),(null===e.stylesheetCache||e.classCache.size!==o)&&(e.stylesheetCache=function(e,t){let n=t.offsets.sort(e),i={base:new Set,defaults:new Set,components:new Set,utilities:new Set,variants:new Set};for(let[r,s]of n)i[r.layer].add(s);return i}([...e.ruleCache],e)),gV.DEBUG&&console.timeEnd("Build stylesheet");let{defaults:l,base:c,components:g,utilities:u,variants:A}=e.stylesheetCache;i.base&&(i.base.before(qT([...c,...l],i.base.source,{layer:"base"})),i.base.remove()),i.components&&(i.components.before(qT([...g],i.components.source,{layer:"components"})),i.components.remove()),i.utilities&&(i.utilities.before(qT([...u],i.utilities.source,{layer:"utilities"})),i.utilities.remove());let d=Array.from(A).filter((e=>{var t;let n=null==(t=e.raws.tailwind)?void 0:t.parentLayer;return"components"===n?null!==i.components:"utilities"!==n||null!==i.utilities}));i.variants?(i.variants.before(qT(d,i.variants.source,{layer:"variants"})),i.variants.remove()):d.length>0&&t.append(qT(d,t.source,{layer:"variants"}));let h=d.some((e=>{var t;return"utilities"===(null==(t=e.raws.tailwind)?void 0:t.parentLayer)}));i.utilities&&0===u.size&&!h&&eW.warn("content-problems",["No utility classes were detected in your source files. If this is unexpected, double-check the `content` option in your Tailwind CSS configuration.","https://tailwindcss.com/docs/content-configuration"]),gV.DEBUG&&(console.log("Potential classes: ",r.size),console.log("Active contexts: ",sW.size)),e.changedContent=[],t.walkAtRules("layer",(e=>{Object.keys(i).includes(e.params)&&e.remove()}))}}var mV=JF(fM());function fV(e){let t=new Map;cW.root({nodes:[e.clone()]}).walkRules((e=>{(0,mV.default)((e=>{e.walkClasses((e=>{let n=e.parent.toString(),i=t.get(n);i||t.set(n,i=new Set),i.add(e.value)}))})).processSync(e.selector)}));let n=Array.from(t.values(),(e=>Array.from(e))),i=n.flat();return Object.assign(i,{groups:n})}var yV=(0,mV.default)();function bV(e){return yV.astSync(e)}function BV(e,t){let n=new Set;for(let i of e)n.add(i.split(t).pop());return Array.from(n)}function vV(e,t){let n=e.tailwindConfig.prefix;return"function"==typeof n?n(t):n+t}function*wV(e){for(yield e;e.parent;)yield e.parent,e=e.parent}function GV(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.nodes;e.nodes=[];let i=e.clone(t);return e.nodes=n,i}function EV(e,t){let n=new Map;return e.walkRules((e=>{var i;for(let t of wV(e))if(void 0!==(null==(i=t.raws.tailwind)?void 0:i.layer))return;let r=function(e){for(let t of wV(e))if(e!==t){if("root"===t.type)break;e=GV(t,{nodes:[e]})}return e}(e),s=t.offsets.create("user");for(let t of fV(e)){let e=n.get(t)||[];n.set(t,e),e.push([{layer:"user",sort:s,important:!1},r])}})),n}function xV(e,t){for(let n of e){if(t.notClassCache.has(n)||t.applyClassCache.has(n))continue;if(t.classCache.has(n)){t.applyClassCache.set(n,t.classCache.get(n).map((e=>{let[t,n]=e;return[t,n.clone()]})));continue}let e=Array.from(UT(n,t));0!==e.length?t.applyClassCache.set(n,e):t.notClassCache.add(n)}return t.applyClassCache}function SV(e){let t=e.split(/[\s\t\n]+/g);return"!important"===t[t.length-1]?[t.slice(0,-1),!0]:[t,!1]}function RV(e,t,n){let i=new Set,r=[];if(e.walkAtRules("apply",(e=>{let[t]=SV(e.params);for(let n of t)i.add(n);r.push(e)})),0===r.length)return;let s=function(e){return{get:t=>e.flatMap((e=>e.get(t)||[])),has:t=>e.some((e=>e.has(t)))}}([n,xV(i,t)]);function o(e,t,n){let i=bV(e),r=bV(t),s=bV(".".concat(yk(n))).nodes[0].nodes[0];return i.each((e=>{let t=new Set;r.each((n=>{let i=!1;(n=n.clone()).walkClasses((r=>{r.value===s.value&&(i||(r.replaceWith(...e.nodes.map((e=>e.clone()))),t.add(n),i=!0))}))}));for(let n of t){let e=[[]];for(let t of n.nodes)"combinator"===t.type?(e.push(t),e.push([])):e[e.length-1].push(t);n.nodes=[];for(let t of e)Array.isArray(t)&&t.sort(((e,t)=>"tag"===e.type&&"class"===t.type?-1:"class"===e.type&&"tag"===t.type?1:"class"===e.type&&"pseudo"===t.type&&t.value.startsWith("::")?-1:"pseudo"===e.type&&e.value.startsWith("::")&&"class"===t.type?1:0)),n.nodes=n.nodes.concat(t)}e.replaceWith(...t)})),i.toString()}let a=new Map;for(let l of r){let[e]=a.get(l.parent)||[[],l.source];a.set(l.parent,[e,l.source]);let[n,i]=SV(l.params);if("atrule"===l.parent.type){if("screen"===l.parent.name){let e=l.parent.params;throw l.error("@apply is not supported within nested at-rules like @screen. We suggest you write this as @apply ".concat(n.map((t=>"".concat(e,":").concat(t))).join(" ")," instead."))}throw l.error("@apply is not supported within nested at-rules like @".concat(l.parent.name,". You can fix this by un-nesting @").concat(l.parent.name,"."))}for(let r of n){if([vV(t,"group"),vV(t,"peer")].includes(r))throw l.error("@apply should not be used with the '".concat(r,"' utility"));if(!s.has(r))throw l.error("The `".concat(r,"` class does not exist. If `").concat(r,"` is a custom class, make sure it is defined within a `@layer` directive."));let n=s.get(r);e.push([r,i,n])}}for(let[l,[c,g]]of a){let e=[];for(let[i,r,s]of c){let n=[i,...BV([i],t.tailwindConfig.separator)];for(let[a,c]of s){let s=fV(l),u=fV(c);if(u=u.groups.filter((e=>e.some((e=>n.includes(e))))).flat(),u=u.concat(BV(u,t.tailwindConfig.separator)),s.some((e=>u.includes(e))))throw c.error("You cannot `@apply` the `".concat(i,"` utility here because it creates a circular dependency."));let A=cW.root({nodes:[c.clone()]});A.walk((e=>{e.source=g})),("atrule"!==c.type||"atrule"===c.type&&"keyframes"!==c.name)&&A.walkRules((e=>{if(!fV(e).some((e=>e===i)))return void e.remove();let n="string"==typeof t.tailwindConfig.important?t.tailwindConfig.important:null,s=void 0!==l.raws.tailwind&&n&&0===l.selector.indexOf(n)?l.selector.slice(n.length):l.selector;e.selector=o(s,e.selector,i),n&&s!==l.selector&&(e.selector=WT(e.selector,n)),e.walkDecls((e=>{e.important=a.important||r}));let c=(0,mV.default)().astSync(e.selector);c.each((e=>Bk(e))),e.selector=c.toString()})),A.nodes[0]&&e.push([a.sort,A.nodes[0]])}}let n=t.offsets.sort(e).map((e=>e[1]));l.after(n)}for(let l of r)l.parent.nodes.length>1?l.remove():l.parent.remove();RV(e,t,n)}function ZV(e){return t=>{let n=function(e){let t=null;return{get:n=>(t=t||e(),t.get(n)),has:n=>(t=t||e(),t.has(n))}}((()=>EV(t,e)));RV(t,e,n)}}var DV=JF(SM()),FV=JF(RM()),NV=JF(MM());function MV(e){return"object"==typeof e&&null!==e}function WV(e){return"string"==typeof e?e:e.reduce(((e,t,n)=>t.includes(".")?"".concat(e,"[").concat(t,"]"):0===n?t:"".concat(e,".").concat(t)),"")}function kV(e){return e.map((e=>"'".concat(e,"'"))).join(", ")}function TV(e){return kV(Object.keys(e))}function VV(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=Array.isArray(t)?WV(t):t.replace(/^['"]+|['"]+$/g,""),s=Array.isArray(t)?t:uT(r),o=(0,DV.default)(e.theme,s,n);if(void 0===o){let t="'".concat(r,"' does not exist in your theme config."),n=s.slice(0,-1),i=(0,DV.default)(e.theme,n);if(MV(i)){let r=Object.keys(i).filter((t=>VV(e,[...n,t]).isValid)),o=(0,FV.default)(s[s.length-1],r);o?t+=" Did you mean '".concat(WV([...n,o]),"'?"):r.length>0&&(t+=" '".concat(WV(n),"' has the following valid keys: ").concat(kV(r)))}else{let n=function(e,t){let n=uT(t);do{if(n.pop(),void 0!==(0,DV.default)(e,n))break}while(n.length);return n.length?n:void 0}(e.theme,r);if(n){let i=(0,DV.default)(e.theme,n);MV(i)?t+=" '".concat(WV(n),"' has the following keys: ").concat(TV(i)):t+=" '".concat(WV(n),"' is not an object.")}else t+=" Your theme has the following top-level keys: ".concat(TV(e.theme))}return{isValid:!1,error:t}}if(!("string"==typeof o||"number"==typeof o||"function"==typeof o||o instanceof String||o instanceof Number||Array.isArray(o))){let t="'".concat(r,"' was found but does not resolve to a string.");if(MV(o)){let n=Object.keys(o).filter((t=>VV(e,[...s,t]).isValid));n.length&&(t+=" Did you mean something like '".concat(WV([...s,n[0]]),"'?"))}return{isValid:!1,error:t}}let[a]=s;return{isValid:!0,value:Lk(a)(o,i)}}function LV(e,t,n){if("function"===t.type&&void 0!==n[t.value]){let i=function(e,t,n){t=t.map((t=>LV(e,t,n)));let i=[""];for(let r of t)"div"===r.type&&","===r.value?i.push(""):i[i.length-1]+=NV.default.stringify(r);return i}(e,t.nodes,n);t.type="word",t.value=n[t.value](e,...i)}return t}var HV={atrule:"params",decl:"value"};function QV(e){let t=e.tailwindConfig,n={theme:function(n,i){for(var r,s=arguments.length,o=new Array(s>2?s-2:0),a=2;a<s;a++)o[a-2]=arguments[a];let{isValid:l,value:c,error:g,alpha:u}=function(e,t,n){var i;let r=Array.from(function*(e){let t,n=(e=e.replace(/^['"]+|['"]+$/g,"")).match(/^([^\s]+)(?![^\[]*\])(?:\s*\/\s*([^\/\s]+))$/);yield[e,void 0],n&&(e=n[1],t=n[2],yield[e,t])}(t)).map((t=>{let[i,r]=t;return Object.assign(VV(e,i,n,{opacityValue:r}),{resolvedPath:i,alpha:r})}));return null!=(i=r.find((e=>e.isValid)))?i:r[0]}(t,i,o.length?o:void 0);if(!l){let t=n.parent,i=null==(r=null==t?void 0:t.raws.tailwind)?void 0:r.candidate;if(t&&void 0!==i)return e.markInvalidUtilityNode(t),t.remove(),void eW.warn("invalid-theme-key-in-class",["The utility `".concat(i,"` contains an invalid theme value and was not generated.")]);throw n.error(g)}let A=gk(c);return(void 0!==u||void 0!==A&&"function"==typeof A)&&(void 0===u&&(u=1),c=ZW(A,u,A)),c},screen:(e,n)=>{n=n.replace(/^['"]+/g,"").replace(/['"]+$/g,"");let i=tT(t.theme.screens).find((e=>{let{name:t}=e;return t===n}));if(!i)throw e.error("The '".concat(n,"' screen does not exist in your theme."));return Qk(i)}};return e=>{e.walk((e=>{let t=HV[e.type];void 0!==t&&(e[t]=function(e,t,n){return(0,NV.default)(t).walk((t=>{LV(e,t,n)})).toString()}(e,e[t],n))}))}}var KV=JF(fM()),XV={id:e=>KV.default.attribute({attribute:"id",operator:"=",value:e.value,quoteMark:'"'})};var YV=(0,KV.default)((e=>e.map((e=>{let t=e.split((e=>"combinator"===e.type&&" "===e.value)).pop();return function(e){let t=e.filter((e=>"pseudo"!==e.type||e.nodes.length>0||e.value.startsWith("::")||[":before",":after",":first-line",":first-letter"].includes(e.value))).reverse(),n=new Set(["tag","class","id","attribute"]),i=t.findIndex((e=>n.has(e.type)));if(-1===i)return t.reverse().join("").trim();let r=t[i],s=XV[r.type]?XV[r.type](r):r;t=t.slice(0,i);let o=t.findIndex((e=>"combinator"===e.type&&">"===e.value));return-1!==o&&(t.splice(0,o),t.unshift(KV.default.universal())),[s,...t.reverse()].join("").trim()}(t)})))),zV=new Map;function PV(e){return zV.has(e)||zV.set(e,YV.transformSync(e)),zV.get(e)}var UV={atrule:["name","params"],rule:["selector"]},_V=new Set(Object.keys(UV));function OV(){function e(t){let n=null;t.each((e=>{if(!_V.has(e.type))return void(n=null);if(null===n)return void(n=e);let t=UV[e.type];"atrule"===e.type&&"font-face"===e.name?n=e:t.every((t=>{var i,r;return(null!=(i=e[t])?i:"").replace(/\s+/g," ")===(null!=(r=n[t])?r:"").replace(/\s+/g," ")}))?(e.nodes&&n.append(e.nodes),e.remove()):n=e})),t.each((t=>{"atrule"===t.type&&e(t)}))}return t=>{e(t)}}var JV=Symbol("unitless-number");function jV(e){var t;let n=/^-?\d*.?\d+([\w%]+)?$/g.exec(e);return n?null!=(t=n[1])?t:JV:null}function qV(){return e=>{!function(e){if(!e.walkAtRules)return;let t=new Set;if(e.walkAtRules("apply",(e=>{t.add(e.parent)})),0!==t.size)for(let n of t){let e=[],t=[];for(let i of n.nodes)"atrule"===i.type&&"apply"===i.name?(t.length>0&&(e.push(t),t=[]),e.push([i])):t.push(i);if(t.length>0&&e.push(t),1!==e.length){for(let t of[...e].reverse()){let e=n.clone({nodes:[]});e.append(t),n.after(e)}n.remove()}}}(e)}}function $V(e){return function(t,n){let{tailwindDirectives:i,applyDirectives:r}=function(e){let t=new Set,n=new Set,i=new Set;if(e.walkAtRules((e=>{"apply"===e.name&&i.add(e),"import"===e.name&&('"tailwindcss/base"'===e.params||"'tailwindcss/base'"===e.params?(e.name="tailwind",e.params="base"):'"tailwindcss/components"'===e.params||"'tailwindcss/components'"===e.params?(e.name="tailwind",e.params="components"):'"tailwindcss/utilities"'===e.params||"'tailwindcss/utilities'"===e.params?(e.name="tailwind",e.params="utilities"):('"tailwindcss/screens"'===e.params||"'tailwindcss/screens'"===e.params||'"tailwindcss/variants"'===e.params||"'tailwindcss/variants'"===e.params)&&(e.name="tailwind",e.params="variants")),"tailwind"===e.name&&("screens"===e.params&&(e.params="variants"),t.add(e.params)),["layer","responsive","variants"].includes(e.name)&&(["responsive","variants"].includes(e.name)&&eW.warn("".concat(e.name,"-at-rule-deprecated"),["The `@".concat(e.name,"` directive has been deprecated in Tailwind CSS v3.0."),"Use `@layer utilities` or `@layer components` instead.","https://tailwindcss.com/docs/upgrade-guide#replace-variants-with-layer"]),n.add(e))})),!t.has("base")||!t.has("components")||!t.has("utilities"))for(let r of n)if("layer"===r.name&&["base","components","utilities"].includes(r.params)){if(!t.has(r.params))throw r.error("`@layer ".concat(r.params,"` is used but no matching `@tailwind ").concat(r.params,"` directive is present."))}else if("responsive"===r.name){if(!t.has("utilities"))throw r.error("`@responsive` is used but `@tailwind utilities` is missing.")}else if("variants"===r.name&&!t.has("utilities"))throw r.error("`@variants` is used but `@tailwind utilities` is missing.");return{tailwindDirectives:t,applyDirectives:i}}(t);((e,t)=>{let n=!1;e.walkAtRules("tailwind",(e=>!n&&(!e.parent||function(e){return"root"===e.type}(e.parent)||function(e){return"atrule"===e.type&&"layer"===e.name}(e.parent)?void 0:(n=!0,e.warn(t,["Nested @tailwind rules were detected, but are not supported.","Consider using a prefix to scope Tailwind's classes: https://tailwindcss.com/docs/configuration#prefix","Alternatively, use the important selector strategy: https://tailwindcss.com/docs/configuration#selector-strategy"].join("\n")),!1)))),e.walkRules((e=>{if(n)return!1;e.walkRules((e=>(n=!0,e.warn(t,["Nested CSS was detected, but CSS nesting has not been configured correctly.","Please enable a CSS nesting plugin *before* Tailwind in your configuration.","See how here: https://tailwindcss.com/docs/using-with-preprocessors#nesting"].join("\n")),!1)))}))})(t,n),qV()(t,n);let s=e({tailwindDirectives:i,applyDirectives:r,registerDependency(e){n.messages.push({plugin:"tailwindcss",parent:n.opts.from,...e})},createContext:(e,n)=>NT(e,n,t)})(t,n);if("-"===s.tailwindConfig.separator)throw new Error("The '-' character cannot be used as a custom separator in JIT mode due to parsing ambiguity. Please use another character like '_' instead.");s.tailwindConfig,CV(s)(t,n),qV()(t,n),ZV(s)(t,n),QV(s)(t,n),function(e){let{tailwindConfig:{theme:t}}=e;return function(e){e.walkAtRules("screen",(e=>{let n=e.params,i=tT(t.screens).find((e=>{let{name:t}=e;return t===n}));if(!i)throw e.error("No `".concat(n,"` screen found."));e.name="media",e.params=Qk(i)}))}}(s)(t,n),function(e){let{tailwindConfig:t}=e;return e=>{var n,i;let r=new Map,s=new Set;if(e.walkAtRules("defaults",(e=>{if(e.nodes&&e.nodes.length>0)return void s.add(e);let t=e.params;r.has(t)||r.set(t,new Set),r.get(t).add(e.parent),e.remove()})),rk(t,"optimizeUniversalDefaults"))for(let o of s){let e=new Map,s=null!=(n=r.get(o.params))?n:[];for(let t of s)for(let n of PV(t.selector)){let t=n.includes(":-")||n.includes("::-")?n:"__DEFAULT__",r=null!=(i=e.get(t))?i:new Set;e.set(t,r),r.add(n)}if(rk(t,"optimizeUniversalDefaults")){if(0===e.size){o.remove();continue}for(let[,t]of e){let e=cW.rule({source:o.source});e.selectors=[...t],e.append(o.nodes.map((e=>e.clone()))),o.before(e)}}o.remove()}else if(s.size){let e=cW.rule({selectors:["*","::before","::after"]});for(let n of s)e.append(n.nodes),e.parent||n.before(e),e.source||(e.source=n.source),n.remove();let t=e.clone({selectors:["::backdrop"]});e.after(t)}}}(s)(t,n),OV()(t,n),(e=>{e.walkRules((e=>{let t=new Map,n=new Set([]),i=new Map;e.walkDecls((r=>{if(r.parent===e){if(t.has(r.prop)){if(t.get(r.prop).value===r.value)return n.add(t.get(r.prop)),void t.set(r.prop,r);i.has(r.prop)||i.set(r.prop,new Set),i.get(r.prop).add(t.get(r.prop)),i.get(r.prop).add(r)}t.set(r.prop,r)}}));for(let r of n)r.remove();for(let r of i.values()){let e=new Map;for(let t of r){let n=jV(t.value);null!==n&&(e.has(n)||e.set(n,new Set),e.get(n).add(t))}for(let t of e.values()){let e=Array.from(t).slice(0,-1);for(let t of e)t.remove()}}}))})(t)}}var eL=["preflight","container","accessibility","pointerEvents","visibility","position","inset","isolation","zIndex","order","gridColumn","gridColumnStart","gridColumnEnd","gridRow","gridRowStart","gridRowEnd","float","clear","margin","boxSizing","lineClamp","display","aspectRatio","height","maxHeight","minHeight","width","minWidth","maxWidth","flex","flexShrink","flexGrow","flexBasis","tableLayout","captionSide","borderCollapse","borderSpacing","transformOrigin","translate","rotate","skew","scale","transform","animation","cursor","touchAction","userSelect","resize","scrollSnapType","scrollSnapAlign","scrollSnapStop","scrollMargin","scrollPadding","listStylePosition","listStyleType","listStyleImage","appearance","columns","breakBefore","breakInside","breakAfter","gridAutoColumns","gridAutoFlow","gridAutoRows","gridTemplateColumns","gridTemplateRows","flexDirection","flexWrap","placeContent","placeItems","alignContent","alignItems","justifyContent","justifyItems","gap","space","divideWidth","divideStyle","divideColor","divideOpacity","placeSelf","alignSelf","justifySelf","overflow","overscrollBehavior","scrollBehavior","textOverflow","hyphens","whitespace","wordBreak","borderRadius","borderWidth","borderStyle","borderColor","borderOpacity","backgroundColor","backgroundOpacity","backgroundImage","gradientColorStops","boxDecorationBreak","backgroundSize","backgroundAttachment","backgroundClip","backgroundPosition","backgroundRepeat","backgroundOrigin","fill","stroke","strokeWidth","objectFit","objectPosition","padding","textAlign","textIndent","verticalAlign","fontFamily","fontSize","fontWeight","textTransform","fontStyle","fontVariantNumeric","lineHeight","letterSpacing","textColor","textOpacity","textDecoration","textDecorationColor","textDecorationStyle","textDecorationThickness","textUnderlineOffset","fontSmoothing","placeholderColor","placeholderOpacity","caretColor","accentColor","opacity","backgroundBlendMode","mixBlendMode","boxShadow","boxShadowColor","outlineStyle","outlineWidth","outlineOffset","outlineColor","ringWidth","ringColor","ringOpacity","ringOffsetWidth","ringOffsetColor","blur","brightness","contrast","dropShadow","grayscale","hueRotate","invert","saturate","sepia","filter","backdropBlur","backdropBrightness","backdropContrast","backdropGrayscale","backdropHueRotate","backdropInvert","backdropOpacity","backdropSaturate","backdropSepia","backdropFilter","transitionProperty","transitionDelay","transitionDuration","transitionTimingFunction","willChange","content"];function tL(e){let{version:t,from:n,to:i}=e;eW.warn("".concat(n,"-color-renamed"),["As of Tailwind CSS ".concat(t,", `").concat(n,"` has been renamed to `").concat(i,"`."),"Update your configuration file to silence this warning."])}function nL(e){for(var t,n,i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];for(let o of r){for(let n in o)null!=(t=null==e?void 0:e.hasOwnProperty)&&t.call(e,n)||(e[n]=o[n]);for(let t of Object.getOwnPropertySymbols(o))null!=(n=null==e?void 0:e.hasOwnProperty)&&n.call(e,t)||(e[t]=o[t])}return e}function iL(e){return Array.isArray(e)?e.map((e=>iL(e))):"object"==typeof e&&null!==e?Object.fromEntries(Object.entries(e).map((e=>{let[t,n]=e;return[t,iL(n)]}))):e}function rL(e){return"function"==typeof e}function sL(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];let r=n.pop();for(let s of n)for(let t in s){let n=r(e[t],s[t]);void 0===n?IW(e[t])&&IW(s[t])?e[t]=sL({},e[t],s[t],r):e[t]=s[t]:e[t]=n}return e}var oL={colors:{inherit:"inherit",current:"currentColor",transparent:"transparent",black:"#000",white:"#fff",slate:{50:"#f8fafc",100:"#f1f5f9",200:"#e2e8f0",300:"#cbd5e1",400:"#94a3b8",500:"#64748b",600:"#475569",700:"#334155",800:"#1e293b",900:"#0f172a",950:"#020617"},gray:{50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",800:"#1f2937",900:"#111827",950:"#030712"},zinc:{50:"#fafafa",100:"#f4f4f5",200:"#e4e4e7",300:"#d4d4d8",400:"#a1a1aa",500:"#71717a",600:"#52525b",700:"#3f3f46",800:"#27272a",900:"#18181b",950:"#09090b"},neutral:{50:"#fafafa",100:"#f5f5f5",200:"#e5e5e5",300:"#d4d4d4",400:"#a3a3a3",500:"#737373",600:"#525252",700:"#404040",800:"#262626",900:"#171717",950:"#0a0a0a"},stone:{50:"#fafaf9",100:"#f5f5f4",200:"#e7e5e4",300:"#d6d3d1",400:"#a8a29e",500:"#78716c",600:"#57534e",700:"#44403c",800:"#292524",900:"#1c1917",950:"#0c0a09"},red:{50:"#fef2f2",100:"#fee2e2",200:"#fecaca",300:"#fca5a5",400:"#f87171",500:"#ef4444",600:"#dc2626",700:"#b91c1c",800:"#991b1b",900:"#7f1d1d",950:"#450a0a"},orange:{50:"#fff7ed",100:"#ffedd5",200:"#fed7aa",300:"#fdba74",400:"#fb923c",500:"#f97316",600:"#ea580c",700:"#c2410c",800:"#9a3412",900:"#7c2d12",950:"#431407"},amber:{50:"#fffbeb",100:"#fef3c7",200:"#fde68a",300:"#fcd34d",400:"#fbbf24",500:"#f59e0b",600:"#d97706",700:"#b45309",800:"#92400e",900:"#78350f",950:"#451a03"},yellow:{50:"#fefce8",100:"#fef9c3",200:"#fef08a",300:"#fde047",400:"#facc15",500:"#eab308",600:"#ca8a04",700:"#a16207",800:"#854d0e",900:"#713f12",950:"#422006"},lime:{50:"#f7fee7",100:"#ecfccb",200:"#d9f99d",300:"#bef264",400:"#a3e635",500:"#84cc16",600:"#65a30d",700:"#4d7c0f",800:"#3f6212",900:"#365314",950:"#1a2e05"},green:{50:"#f0fdf4",100:"#dcfce7",200:"#bbf7d0",300:"#86efac",400:"#4ade80",500:"#22c55e",600:"#16a34a",700:"#15803d",800:"#166534",900:"#14532d",950:"#052e16"},emerald:{50:"#ecfdf5",100:"#d1fae5",200:"#a7f3d0",300:"#6ee7b7",400:"#34d399",500:"#10b981",600:"#059669",700:"#047857",800:"#065f46",900:"#064e3b",950:"#022c22"},teal:{50:"#f0fdfa",100:"#ccfbf1",200:"#99f6e4",300:"#5eead4",400:"#2dd4bf",500:"#14b8a6",600:"#0d9488",700:"#0f766e",800:"#115e59",900:"#134e4a",950:"#042f2e"},cyan:{50:"#ecfeff",100:"#cffafe",200:"#a5f3fc",300:"#67e8f9",400:"#22d3ee",500:"#06b6d4",600:"#0891b2",700:"#0e7490",800:"#155e75",900:"#164e63",950:"#083344"},sky:{50:"#f0f9ff",100:"#e0f2fe",200:"#bae6fd",300:"#7dd3fc",400:"#38bdf8",500:"#0ea5e9",600:"#0284c7",700:"#0369a1",800:"#075985",900:"#0c4a6e",950:"#082f49"},blue:{50:"#eff6ff",100:"#dbeafe",200:"#bfdbfe",300:"#93c5fd",400:"#60a5fa",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8",800:"#1e40af",900:"#1e3a8a",950:"#172554"},indigo:{50:"#eef2ff",100:"#e0e7ff",200:"#c7d2fe",300:"#a5b4fc",400:"#818cf8",500:"#6366f1",600:"#4f46e5",700:"#4338ca",800:"#3730a3",900:"#312e81",950:"#1e1b4b"},violet:{50:"#f5f3ff",100:"#ede9fe",200:"#ddd6fe",300:"#c4b5fd",400:"#a78bfa",500:"#8b5cf6",600:"#7c3aed",700:"#6d28d9",800:"#5b21b6",900:"#4c1d95",950:"#2e1065"},purple:{50:"#faf5ff",100:"#f3e8ff",200:"#e9d5ff",300:"#d8b4fe",400:"#c084fc",500:"#a855f7",600:"#9333ea",700:"#7e22ce",800:"#6b21a8",900:"#581c87",950:"#3b0764"},fuchsia:{50:"#fdf4ff",100:"#fae8ff",200:"#f5d0fe",300:"#f0abfc",400:"#e879f9",500:"#d946ef",600:"#c026d3",700:"#a21caf",800:"#86198f",900:"#701a75",950:"#4a044e"},pink:{50:"#fdf2f8",100:"#fce7f3",200:"#fbcfe8",300:"#f9a8d4",400:"#f472b6",500:"#ec4899",600:"#db2777",700:"#be185d",800:"#9d174d",900:"#831843",950:"#500724"},rose:{50:"#fff1f2",100:"#ffe4e6",200:"#fecdd3",300:"#fda4af",400:"#fb7185",500:"#f43f5e",600:"#e11d48",700:"#be123c",800:"#9f1239",900:"#881337",950:"#4c0519"},get lightBlue(){return tL({version:"v2.2",from:"lightBlue",to:"sky"}),this.sky},get warmGray(){return tL({version:"v3.0",from:"warmGray",to:"stone"}),this.stone},get trueGray(){return tL({version:"v3.0",from:"trueGray",to:"neutral"}),this.neutral},get coolGray(){return tL({version:"v3.0",from:"coolGray",to:"gray"}),this.gray},get blueGray(){return tL({version:"v3.0",from:"blueGray",to:"slate"}),this.slate}},negative:e=>Object.keys(e).filter((t=>"0"!==e[t])).reduce(((t,n)=>{let i=tk(e[n]);return void 0!==i&&(t["-".concat(n)]=i),t}),{}),breakpoints:e=>Object.keys(e).filter((t=>"string"==typeof e[t])).reduce(((t,n)=>({...t,["screen-".concat(n)]:e[n]})),{})};function aL(e){return e.reduce(((e,t)=>{let{extend:n}=t;return sL(e,n,((e,t)=>void 0===e?[t]:Array.isArray(e)?[t,...e]:[t,e]))}),{})}function lL(e){return{...e.reduce(((e,t)=>nL(e,t)),{}),extend:aL(e)}}function cL(e,t){return Array.isArray(e)&&IW(e[0])?e.concat(t):Array.isArray(t)&&IW(t[0])&&IW(e)?[e,...t]:Array.isArray(t)?t:void 0}function gL(e){let{extend:t,...n}=e;return sL(n,t,((e,t)=>rL(e)||t.some(rL)?(n,i)=>sL({},...[e,...t].map((e=>function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return rL(e)?e(...n):e}(e,n,i))),cL):sL({},e,...t,cL)))}function uL(e){let t=(n,i)=>{for(let r of function*(e){let t=uT(e);if(0===t.length||(yield t,Array.isArray(e)))return;let n=e.match(/^(.*?)\s*\/\s*([^/]+)$/);if(null!==n){let[,e,t]=n,i=uT(e);i.alpha=t,yield i}}(n)){let n=0,i=e;for(;null!=i&&n<r.length;)i=i[r[n++]],i=rL(i)&&(void 0===r.alpha||n<=r.length-1)?i(t,oL):i;if(void 0!==i){if(void 0!==r.alpha){let e=gk(i);return ZW(e,r.alpha,eT(e))}return IW(i)?iL(i):i}}return i};return Object.assign(t,{theme:t,...oL}),Object.keys(e).reduce(((n,i)=>(n[i]=rL(e[i])?e[i](t,oL):e[i],n)),{})}function AL(e){let t=[];return e.forEach((e=>{var n;t=[...t,e];let i=null!=(n=null==e?void 0:e.plugins)?n:[];0!==i.length&&i.forEach((e=>{var n;e.__isOptionsFunction&&(e=e()),t=[...t,...AL([null!=(n=null==e?void 0:e.config)?n:{}])]}))})),t}function dL(e){return[...e].reduceRight(((e,t)=>rL(t)?t({corePlugins:e}):function(e,t){return void 0===e?t:Array.isArray(e)?e:[...new Set(t.filter((t=>!1!==e&&!1!==e[t])).concat(Object.keys(e).filter((t=>!1!==e[t]))))]}(t,e)),eL)}function hL(e){return[...e].reduceRight(((e,t)=>[...e,...t]),[])}function IL(e){let t=[...AL(e),{prefix:"",important:!1,separator:":"}];return function(e){var t;(()=>{if(e.purge||!e.content||!Array.isArray(e.content)&&("object"!=typeof e.content||null===e.content))return!1;if(Array.isArray(e.content))return e.content.every((e=>"string"==typeof e||!("string"!=typeof(null==e?void 0:e.raw)||(null==e?void 0:e.extension)&&"string"!=typeof(null==e?void 0:e.extension))));if("object"==typeof e.content&&null!==e.content){if(Object.keys(e.content).some((e=>!["files","relative","extract","transform"].includes(e))))return!1;if(Array.isArray(e.content.files)){if(!e.content.files.every((e=>"string"==typeof e||!("string"!=typeof(null==e?void 0:e.raw)||(null==e?void 0:e.extension)&&"string"!=typeof(null==e?void 0:e.extension)))))return!1;if("object"==typeof e.content.extract){for(let t of Object.values(e.content.extract))if("function"!=typeof t)return!1}else if(void 0!==e.content.extract&&"function"!=typeof e.content.extract)return!1;if("object"==typeof e.content.transform){for(let t of Object.values(e.content.transform))if("function"!=typeof t)return!1}else if(void 0!==e.content.transform&&"function"!=typeof e.content.transform)return!1;if("boolean"!=typeof e.content.relative&&typeof e.content.relative<"u")return!1}return!0}return!1})()||eW.warn("purge-deprecation",["The `purge`/`content` options have changed in Tailwind CSS v3.0.","Update your configuration file to eliminate this warning.","https://tailwindcss.com/docs/upgrade-guide#configure-content-sources"]),e.safelist=(()=>{var t;let{content:n,purge:i,safelist:r}=e;return Array.isArray(r)?r:Array.isArray(null==n?void 0:n.safelist)?n.safelist:Array.isArray(null==i?void 0:i.safelist)?i.safelist:Array.isArray(null==(t=null==i?void 0:i.options)?void 0:t.safelist)?i.options.safelist:[]})(),e.blocklist=(()=>{let{blocklist:t}=e;if(Array.isArray(t)){if(t.every((e=>"string"==typeof e)))return t;eW.warn("blocklist-invalid",["The `blocklist` option must be an array of strings.","https://tailwindcss.com/docs/content-configuration#discarding-classes"])}return[]})(),"function"==typeof e.prefix?(eW.warn("prefix-function",["As of Tailwind CSS v3.0, `prefix` cannot be a function.","Update `prefix` in your configuration to be a string to eliminate this warning.","https://tailwindcss.com/docs/upgrade-guide#prefix-cannot-be-a-function"]),e.prefix=""):e.prefix=null!=(t=e.prefix)?t:"",e.content={relative:(()=>{let{content:t}=e;return null!=t&&t.relative?t.relative:rk(e,"relativeContentPathsByDefault")})(),files:(()=>{let{content:t,purge:n}=e;return Array.isArray(n)?n:Array.isArray(null==n?void 0:n.content)?n.content:Array.isArray(t)?t:Array.isArray(null==t?void 0:t.content)?t.content:Array.isArray(null==t?void 0:t.files)?t.files:[]})(),extract:(()=>{let t=(()=>{var t,n,i,r,s,o,a,l,c,g;return null!=(t=e.purge)&&t.extract?e.purge.extract:null!=(n=e.content)&&n.extract?e.content.extract:null!=(r=null==(i=e.purge)?void 0:i.extract)&&r.DEFAULT?e.purge.extract.DEFAULT:null!=(o=null==(s=e.content)?void 0:s.extract)&&o.DEFAULT?e.content.extract.DEFAULT:null!=(l=null==(a=e.purge)?void 0:a.options)&&l.extractors?e.purge.options.extractors:null!=(g=null==(c=e.content)?void 0:c.options)&&g.extractors?e.content.options.extractors:{}})(),n={},i=(()=>{var t,n,i,r;return null!=(n=null==(t=e.purge)?void 0:t.options)&&n.defaultExtractor?e.purge.options.defaultExtractor:null!=(r=null==(i=e.content)?void 0:i.options)&&r.defaultExtractor?e.content.options.defaultExtractor:void 0})();if(void 0!==i&&(n.DEFAULT=i),"function"==typeof t)n.DEFAULT=t;else if(Array.isArray(t))for(let{extensions:e,extractor:r}of null!=t?t:[])for(let t of e)n[t]=r;else"object"==typeof t&&null!==t&&Object.assign(n,t);return n})(),transform:(()=>{let t=(()=>{var t,n,i,r,s,o;return null!=(t=e.purge)&&t.transform?e.purge.transform:null!=(n=e.content)&&n.transform?e.content.transform:null!=(r=null==(i=e.purge)?void 0:i.transform)&&r.DEFAULT?e.purge.transform.DEFAULT:null!=(o=null==(s=e.content)?void 0:s.transform)&&o.DEFAULT?e.content.transform.DEFAULT:{}})(),n={};return"function"==typeof t&&(n.DEFAULT=t),"object"==typeof t&&null!==t&&Object.assign(n,t),n})()};for(let n of e.content.files)if("string"==typeof n&&/{([^,]*?)}/g.test(n)){eW.warn("invalid-glob-braces",["The glob pattern ".concat(n," in your Tailwind CSS configuration is invalid."),"Update it to ".concat(n.replace(/{([^,]*?)}/g,"$1")," to silence this warning.")]);break}return e}(nL({theme:uL(gL(lL(t.map((e=>{var t;return null!=(t=null==e?void 0:e.theme)?t:{}}))))),corePlugins:dL(t.map((e=>e.corePlugins))),plugins:hL(e.map((e=>{var t;return null!=(t=null==e?void 0:e.plugins)?t:[]})))},...t))}var pL=JF(WM());function CL(e){var t;let n=(null!=(t=null==e?void 0:e.presets)?t:[pL.default]).slice().reverse().flatMap((e=>CL(e instanceof Function?e():e))),i={respectDefaultRingColorOpacity:{theme:{ringColor:e=>{let{theme:t}=e;return{DEFAULT:"#3b82f67f",...t("colors")}}}},disableColorOpacityUtilitiesByDefault:{corePlugins:{backgroundOpacity:!1,borderOpacity:!1,divideOpacity:!1,placeholderOpacity:!1,ringOpacity:!1,textOpacity:!1}}},r=Object.keys(i).filter((t=>rk(e,t))).map((e=>i[e]));return[e,...r,...n]}function mL(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let[,...i]=CL(t[0]);return IL([...t,...i])}var fL=JF(jM(),1),yL=e=>{let t=(e=>{var t;let n=mL(null!=(t=e.config)?t:{});return $V((t=>()=>t.createContext(n,[{content:e.content}])))})({config:e.config,content:e.content});return cW([t,(0,fL.default)()]).process(bL,{from:void 0}).css},bL=String.raw(VF||(VF=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  @tailwind base;\n  @tailwind components;\n  @tailwind utilities;\n"])));var BL=function(){let e="";for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return"string"==typeof n[0]?e=n[0]:Array.isArray(n[0])?e=n.flat(1/0).map((e=>BL(e))).join(" "):"object"==typeof n[0]&&(e=Object.entries(n[0]).filter((e=>!!e[1])).map((e=>e[0])).join(" ")),e=e.replace(/\s+/g," "),e},vL=(e,t)=>function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];let s=BL(i),{1:o}=i||{},a={merge:!0,minify:!0,ignoreMediaQueries:!0,...t,...o},l=qM(((e,t)=>{var n,i;let r=null!=(i=null==(n=null==t?void 0:t.corePlugins)?void 0:n.preflight)&&i,s=(null==t?void 0:t.corePlugins)||{};return yL({config:{...t,corePlugins:{...s,preflight:r}},content:e})})(s,e));return null!=a&&a.ignoreMediaQueries?l.removeMediaQueries():(l.removeUndefined(),l.combineMediaQueries()),l.fixRGB(),null!=a&&a.merge&&l.merge(),null!=a&&a.minify&&l.minify(),l.get()},wL=(e,t)=>function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return function(e){let t=cW.parse(e);return dW.objectify(t)}(vL(e,t)(i))};vL(),wL();const GL=(0,t.createContext)(null);function EL(){return(0,t.useContext)(GL)}const xL=(0,t.createContext)(void 0);function SL(){const e=(0,t.useContext)(xL);if(null==e)throw new Error("Cannot be used outside of a uikit component.");return e}const RL=xL.Provider;new Oi;const ZL=(0,t.createContext)(void 0);const DL=["onClick","onContextMenu","onDoubleClick","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMissed","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onWheel"],FL=(0,t.forwardRef)(((e,n)=>{let{handlers:i,allowSkippingChildren:r,properties:s,children:o}=e;const[a,l]=(0,t.useState)((()=>i.peek()));(0,t.useEffect)((()=>Yx((()=>{const e=i.value,t=void setTimeout((()=>l(e)),0);return()=>clearTimeout(t)}))),[i]);const c=(0,t.useMemo)((()=>{const e={...a},t=DL.length;for(let n=0;n<t;n++){const t=DL[n];NR(t,e,s[t])}if(0!==Object.keys(e).length)return e}),[a,s]);return r&&null==c?null:(0,I.jsx)("object3D",{pointerEvents:s.pointerEvents,pointerEventsOrder:s.pointerEventsOrder,pointerEventsType:s.pointerEventsType,ref:n,matrixAutoUpdate:!1,...c,children:o})}));function NL(e){const n=(0,t.useMemo)((()=>({style:Mx(void 0),properties:Mx(void 0),default:Mx(void 0)})),[]);return n.properties.value=e,n.default.value=(0,t.useContext)(ZL),n}function ML(e,n,i,r,s,o){(0,t.useImperativeHandle)(e,(()=>{const{scrollPosition:e,paddingInset:t,borderInset:a,relativeCenter:l,size:c,maxScrollPosition:g}=r;return{setStyle:(e,t)=>i.value=t?e:{...i.value,...e},getStyle:()=>i.peek(),getComputedProperty:e=>xx((()=>r.mergedProperties.value.read(e,void 0))),pixelSize:n,borderInset:a,paddingInset:t,center:l,maxScrollPosition:g,size:c,interactionPanel:s instanceof Qo?s:s.current,scrollPosition:e,isClipped:r.isClipped,...o}}),[r,n,s,o,i])}(0,t.forwardRef)(((e,n)=>{var i;const r=SL(),s=(0,t.useRef)(null),o=(0,t.useRef)(null),a=NL(e),l=(0,t.useMemo)((()=>CD(r,a.style,a.properties,a.default,s,o)),[r,a]);return l.interactionPanel.name=null!==(i=e.name)&&void 0!==i?i:"",(0,t.useEffect)((()=>{const e=[];return Ux(l.initializers,e),()=>Px(e)}),[r,a,l]),ML(n,r.root.pixelSize,a.style,l,l.interactionPanel),(0,I.jsxs)(FL,{properties:e,handlers:l.handlers,ref:s,children:[(0,I.jsx)("primitive",{object:l.interactionPanel}),(0,I.jsx)("object3D",{matrixAutoUpdate:!1,ref:o,children:(0,I.jsx)(RL,{value:l,children:e.children})})]})}));const WL=(0,t.forwardRef)(((e,n)=>{var i;const r=_p((e=>e.gl));r.setTransparentSort(cS);const s=Up(),o=(0,t.useRef)(null),a=(0,t.useRef)(null),l=(0,t.useMemo)((()=>Mx(void 0)),[]);l.value=e.pixelSize;const c=NL(e),g=(0,t.useMemo)((()=>new Set),[]),u=(0,t.useRef)(!1),A=_p((e=>e.invalidate)),d=(0,t.useMemo)((()=>AD(Lx((()=>{var e;return null!==(e=qx(l.value))&&void 0!==e?e:lD})),c.style,c.properties,c.default,o,a,(()=>s.getState().camera),r,g,(()=>{u.current||A()}),A)),[A]);return d.interactionPanel.name=null!==(i=e.name)&&void 0!==i?i:"",(0,t.useEffect)((()=>{const e=[];return Ux(d.initializers,e),()=>Px(e)}),[d]),Op(((e,t)=>{u.current=!0;for(const n of g)n(t);u.current=!1})),ML(n,d.root.pixelSize,c.style,d,d.interactionPanel),(0,I.jsxs)(FL,{properties:{pointerEvents:"auto",...e},handlers:d.handlers,ref:o,children:[(0,I.jsx)("primitive",{object:d.interactionPanel}),(0,I.jsx)("object3D",{matrixAutoUpdate:!1,ref:a,children:(0,I.jsx)(RL,{value:d,children:e.children})})]})})),kL=(0,t.forwardRef)(((e,n)=>{var i;const r=SL(),s=(0,t.useRef)(null),o=(0,t.useRef)(null),a=NL(e),l=(0,t.useMemo)((()=>fD(r,a.style,a.properties,a.default,s,o)),[]);return l.interactionPanel.name=null!==(i=e.name)&&void 0!==i?i:"",(0,t.useEffect)((()=>{const e=[];return Ux(l.initializers,e),()=>Px(e)}),[l]),ML(n,r.root.pixelSize,a.style,l,l.interactionPanel),(0,I.jsxs)(FL,{properties:e,ref:s,handlers:l.handlers,children:[(0,I.jsx)("primitive",{object:l.interactionPanel}),(0,I.jsx)("object3D",{matrixAutoUpdate:!1,ref:o,children:(0,I.jsx)(RL,{value:l,children:e.children})})]})})),TL=((0,t.forwardRef)(((e,n)=>{var i;const r=SL(),s=(0,t.useRef)(null),o=NL(e),a=(0,t.useMemo)((()=>Mx(void 0)),[]);a.value=e.children;const l=(0,t.useMemo)((()=>Mx(void 0)),[]);l.value=EL();const c=(0,t.useMemo)((()=>nF(r,a,l,o.style,o.properties,o.default,s)),[l,r,o,a]);return c.interactionPanel.name=null!==(i=e.name)&&void 0!==i?i:"",(0,t.useEffect)((()=>{const e=[];return Ux(c.initializers,e),()=>Px(e)}),[c]),ML(n,r.root.pixelSize,o.style,c,c.interactionPanel),(0,I.jsx)(FL,{allowSkippingChildren:!0,properties:e,handlers:c.handlers,ref:s,children:(0,I.jsx)("primitive",{object:c.interactionPanel})})})),(0,t.forwardRef)(((e,n)=>{var i;const r=SL(),s=(0,t.useRef)(null),o=(0,t.useRef)(null),a=NL(e),l=(0,t.useMemo)((()=>sF(r,a.style,a.properties,a.default,s,o)),[r,a]);return l.interactionPanel.name=null!==(i=e.name)&&void 0!==i?i:"",(0,t.useEffect)((()=>{const e=[];return Ux(l.initializers,e),()=>Px(e)}),[l]),ML(n,r.root.pixelSize,a.style,l,l.interactionPanel),(0,I.jsxs)(FL,{properties:e,ref:s,handlers:l.handlers,children:[(0,I.jsx)("primitive",{object:l.interactionPanel}),(0,I.jsx)("primitive",{object:l.centerGroup}),(0,I.jsx)("object3D",{matrixAutoUpdate:!1,ref:o,children:(0,I.jsx)(RL,{value:l,children:e.children})})]})})),(0,t.forwardRef)(((e,n)=>{var i;const r=SL(),s=(0,t.useRef)(null),o=NL(e),a=(0,t.useMemo)((()=>uF(r,e.text,e.svgWidth,e.svgHeight,o.style,o.properties,o.default,s)),[r,e.svgHeight,e.svgWidth,e.text,o]);return a.interactionPanel.name=null!==(i=e.name)&&void 0!==i?i:"",(0,t.useEffect)((()=>{const e=[];return Ux(a.initializers,e),()=>Px(e)}),[a]),ML(n,r.root.pixelSize,o.style,a,a.interactionPanel),(0,I.jsxs)(FL,{properties:e,ref:s,handlers:a.handlers,children:[(0,I.jsx)("primitive",{object:a.interactionPanel}),(0,I.jsx)("primitive",{object:a.iconGroup})]})})),(0,t.forwardRef)(((e,n)=>{var i;const r=SL(),s=(0,t.useRef)(null),o=NL(e),a=(0,t.useMemo)((()=>Mx(void 0)),[]);a.value=EL();const l=(0,t.useMemo)((()=>bF(r,a,o.style,o.properties,o.default,s)),[]);return l.interactionPanel.name=null!==(i=e.name)&&void 0!==i?i:"",(0,t.useEffect)((()=>{const e=[];return Ux(l.initializers,e),()=>Px(e)}),[l]),ML(n,r.root.pixelSize,o.style,l,l.interactionPanel,(0,t.useMemo)((()=>({focus:l.focus,current:l.valueSignal})),[l.focus,l.valueSignal])),(0,I.jsx)(FL,{allowSkippingChildren:!0,properties:e,handlers:l.handlers,ref:s,children:(0,I.jsx)("primitive",{object:l.interactionPanel})})})),(0,t.forwardRef)(((e,n)=>{const i=SL(),r=(0,t.useRef)(null),s=(0,t.useRef)(null),o=NL(e),a=(0,t.useMemo)((()=>vF(i,o.style,o.properties,o.default,r,s)),[i,o]);return(0,t.useEffect)((()=>{const e=[];return Ux(a.initializers,e),()=>Px(e)}),[a]),ML(n,i.root.pixelSize,o.style,a,s),(0,t.useEffect)((()=>{s.current&&e.name&&(s.current.name=e.name)}),[e.name]),(0,I.jsx)(FL,{properties:e,handlers:a.handlers,ref:r,children:(0,I.jsx)(RL,{value:void 0,children:(0,I.jsx)("mesh",{ref:s,matrixAutoUpdate:!1,geometry:UR,customDepthMaterial:e.customDepthMaterial,customDistanceMaterial:e.customDistanceMaterial,children:e.children})})})})),(0,t.forwardRef)(((e,n)=>{var i;const r=SL(),s=(0,t.useRef)(null),o=(0,t.useRef)(null),a=NL(e),l=(0,t.useMemo)((()=>wF(r,a.style,a.properties,a.default,s,o)),[r,a]);return l.interactionPanel.name=null!==(i=e.name)&&void 0!==i?i:"",(0,t.useEffect)((()=>{const e=[];return Ux(l.initializers,e),()=>Px(e)}),[l]),ML(n,r.root.pixelSize,a.style,l,l.interactionPanel),(0,I.jsxs)(FL,{properties:e,handlers:l.handlers,ref:s,children:[(0,I.jsx)("primitive",{object:l.interactionPanel}),(0,I.jsx)("object3D",{matrixAutoUpdate:!1,ref:o,children:(0,I.jsx)(RL,{value:void 0,children:e.children})})]})})),(0,t.forwardRef)(((e,n)=>{var i,r;const s=Up(),[o,a,l]=(0,t.useMemo)((()=>[Mx(1),Mx(1),Mx(1)]),[]),c=_p((e=>e.camera)),g=null!==(i=e.distanceToCamera)&&void 0!==i?i:c.near+.1;(0,t.useEffect)((()=>{const e=e=>{let{camera:t,size:{height:n}}=e;return Gx((()=>ZF(o,a,l,g,t,n)))};return e(s.getState()),s.subscribe(e)}),[l,o,a,s,g]);const u=null===(r=e.attachCamera)||void 0===r||r;return(0,I.jsxs)(I.Fragment,{children:[u&&(0,I.jsx)("primitive",{object:c}),cC((0,I.jsx)("group",{"position-z":-g,children:(0,I.jsx)(WL,{ref:n,...e,sizeX:o,sizeY:a,pixelSize:l,children:e.children})}),c)]})})),(0,t.forwardRef)(((e,t)=>{let{src:n,...i}=e;const r=qp(Ld,n);return r.colorSpace=Xn,r.matrixAutoUpdate=!1,(0,I.jsx)(kL,{ref:t,src:r,...i})})),["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"]);(0,t.forwardRef)(((e,n)=>{var i;let{children:r,dpr:s,frames:o=1/0,renderPriority:a=0,eventPriority:l=0,...c}=e;const g=(0,t.useMemo)((()=>new Nx(void 0)),[]),u=(0,t.useRef)(null),A=Up();null!==(i=s)&&void 0!==i||(s=A.getState().viewport.dpr),(0,t.useImperativeHandle)(n,(()=>u.current),[]);const h=(0,t.useMemo)((()=>Lx((()=>{var e;return null===(e=g.value)||void 0===e?void 0:e.texture}))),[g]),p=(0,t.useMemo)((()=>{let e=A.getState();const t=new Jo(50,1,.1,1e3);t.position.set(0,0,5);const n=new Oi;let i={events:{compute:VL.bind(null,u),priority:l},size:{width:1,height:1,left:0,top:0},camera:t,scene:new _c,raycaster:new qh,pointer:n,mouse:n,previousRoot:A};const r=d(((n,r)=>{const s=()=>{const n={};for(const t in e)TL.includes(t)||(n[t]=e[t]);return Object.assign(n,i,{events:{...e.events,...i.events},viewport:Object.assign({},e.viewport,e.viewport.getCurrentViewport(t,new Sr,i.size))})},o=()=>n(s());return{...e,set(e){"function"===typeof e&&(e=e(r())),Object.assign(i,e),o()},setPreviousState(t){e=t,o()},get:r,setEvents(e){Object.assign(i.events,e),o()},...s()}}));return Object.assign(r,{setState(e){r.getState().set(e)}})}),[l,A]);return(0,t.useEffect)((()=>A.subscribe(p.getState().setPreviousState)),[A,p]),(0,t.useEffect)((()=>{if(null==u.current)return;const e=g.value=new br(1,1,{minFilter:pt,magFilter:pt,type:St}),{size:t}=u.current,n=Yx((()=>{if(null==t.value)return;const[n,i]=t.value;e.setSize(n*s,i*s),p.setState({size:{width:n,height:i,top:0,left:0},viewport:{...A.getState().viewport,width:n,height:i,aspect:n/i}})}));return()=>{n(),e.dispose()}}),[g,A,p,s]),(0,I.jsxs)(I.Fragment,{children:[nC.createPortal((0,I.jsx)(kp.Provider,{value:p,children:(0,I.jsxs)(LL,{renderPriority:a,frames:o,fbo:g,children:[r,(0,I.jsx)("group",{onPointerOver:()=>null})]})}),p,null),(0,I.jsx)(kL,{src:h,objectFit:"fill",keepAspectRatio:!1,...c,ref:u})]})}));function VL(e,t,n,i){var r,s,o;let{current:a}=e;if(null==a||null==i)return!1;i.raycaster.camera||null===(r=(s=i.events).compute)||void 0===r||r.call(s,t,i,null===(o=i.previousRoot)||void 0===o?void 0:o.getState());const[l]=i.raycaster.intersectObject(a.interactionPanel);if(!l)return!1;const c=l.uv;if(!c)return!1;n.raycaster.setFromCamera(n.pointer.set(2*c.x-1,2*c.y-1),n.camera)}function LL(e){let{frames:n,renderPriority:i,children:r,fbo:s}=e;const o=Up();(0,t.useEffect)((()=>o.subscribe(((e,t)=>{const{size:n,camera:i}=e;var r;n&&((r=i)&&r.isOrthographicCamera?(i.left=n.width/-2,i.right=n.width/2,i.top=n.height/2,i.bottom=n.height/-2):i.aspect=n.width/n.height,n===t.size&&i===t.camera||(i.updateProjectionMatrix(),i.updateMatrixWorld()))}))),[o]);let a,l,c=0;return Op((e=>{const t=s.peek();null!=t&&(n===1/0||c<n)&&(a=e.gl.autoClear,l=e.gl.xr.enabled,e.gl.autoClear=!0,e.gl.xr.enabled=!1,e.gl.setRenderTarget(t),e.gl.render(e.scene,e.camera),e.gl.setRenderTarget(null),e.gl.autoClear=a,e.gl.xr.enabled=l,c++)}),i),(0,I.jsx)(I.Fragment,{children:r})}const HL=(0,t.createContext)(void 0);(0,t.forwardRef)(((e,n)=>{const i=(0,t.useMemo)((()=>Mx(void 0)),[]),r=(0,t.useMemo)((()=>Mx(1)),[]),s=e.src instanceof HTMLVideoElement?e.src:void 0,o=(0,t.useMemo)((()=>null!==s&&void 0!==s?s:document.createElement("video")),[s]),a=_p((e=>e.invalidate));(0,t.useEffect)((()=>FF(o,a)),[o,a]),DF(o,e),(0,t.useEffect)((()=>{const e=()=>r.value=o.videoWidth/o.videoHeight;return e(),o.addEventListener("resize",e),()=>o.removeEventListener("resize",e)}),[r,o]),(0,t.useEffect)((()=>{const e=new Bu(o);return e.colorSpace=Xn,i.value=e,()=>e.dispose()}),[i,o]);const l=(0,t.useRef)(null);return(0,t.useImperativeHandle)(n,(()=>({...l.current,element:o})),[o]),(0,I.jsx)(HL.Provider,{value:o,children:(0,I.jsx)(kL,{aspectRatio:r,...e,ref:l,src:i})})}));var QL=Object.create,KL=Object.defineProperty,XL=Object.getOwnPropertyDescriptor,YL=Object.getOwnPropertyNames,zL=Object.getPrototypeOf,PL=Object.prototype.hasOwnProperty,UL=e=>{throw TypeError(e)},_L=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),OL=(e,t)=>{for(var n in t)KL(e,n,{get:t[n],enumerable:!0})},JL=(e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of YL(t))!PL.call(e,r)&&r!==n&&KL(e,r,{get:()=>t[r],enumerable:!(i=XL(t,r))||i.enumerable});return e},jL=(e,t,n)=>(n=null!=e?QL(zL(e)):{},JL(!t&&e&&e.__esModule?n:KL(n,"default",{value:e,enumerable:!0}),e)),qL=(e,t,n)=>(((e,t,n)=>{t.has(e)||UL("Cannot "+n)})(e,t,"access private method"),n),$L=_L(((e,t)=>{var n=new Proxy(String,{get:()=>n});t.exports=n})),eH={};OL(eH,{default:()=>nH,shouldHighlight:()=>tH});var tH,nH,iH=((e,t)=>()=>(e&&(t=e(e=0)),t))((()=>{tH=()=>!1,nH=String})),rH=_L(((e,t)=>{var n=String,i=function(){return{isColorSupported:!1,reset:n,bold:n,dim:n,italic:n,underline:n,inverse:n,hidden:n,strikethrough:n,black:n,red:n,green:n,yellow:n,blue:n,magenta:n,cyan:n,white:n,gray:n,bgBlack:n,bgRed:n,bgGreen:n,bgYellow:n,bgBlue:n,bgMagenta:n,bgCyan:n,bgWhite:n}};t.exports=i(),t.exports.createColors=i})),sH=_L((e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.codeFrameColumns=c,e.default=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!a){a=!0;let e="Passing lineNumber and colNumber is deprecated to @babel/code-frame. Please use `codeFrameColumns`.";new Error(e).name="DeprecationWarning",console.warn(new Error(e))}return n=Math.max(n,0),c(e,{start:{column:n,line:t}},i)};var t=(iH(),(e=>JL(KL({},"__esModule",{value:!0}),e))(eH)),n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=s?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(rH(),!0);function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}var r,s=n.default,o=(e,t)=>n=>e(t(n));var a=!1;var l=/\r\n|[\n\r\u2028\u2029]/;function c(e,i){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=(a.highlightCode||a.forceColor)&&(0,t.shouldHighlight)(a),g=function(e){return e?(null!=r||(r=(0,n.createColors)(!0)),r):s}(a.forceColor),u=function(e){return{gutter:e.gray,marker:o(e.red,e.bold),message:o(e.red,e.bold)}}(g),A=(e,t)=>c?e(t):t,d=e.split(l),{start:h,end:I,markerLines:p}=function(e,t,n){let i=Object.assign({column:0,line:-1},e.start),r=Object.assign({},i,e.end),{linesAbove:s=2,linesBelow:o=3}=n||{},a=i.line,l=i.column,c=r.line,g=r.column,u=Math.max(a-(s+1),0),A=Math.min(t.length,c+o);-1===a&&(u=0),-1===c&&(A=t.length);let d=c-a,h={};if(d)for(let I=0;I<=d;I++){let e=I+a;if(l)if(0===I){let n=t[e-1].length;h[e]=[l,n-l+1]}else if(I===d)h[e]=[0,g];else{let n=t[e-I].length;h[e]=[0,n]}else h[e]=!0}else h[a]=l===g?!l||[l,0]:[l,g-l];return{start:u,end:A,markerLines:h}}(i,d,a),C=i.start&&"number"==typeof i.start.column,m=String(I).length,f=(c?(0,t.default)(e,a):e).split(l,I).slice(h,I).map(((e,t)=>{let n=h+1+t,i=" ".concat(" ".concat(n).slice(-m)," |"),r=p[n],s=!p[n+1];if(r){let t="";if(Array.isArray(r)){let n=e.slice(0,Math.max(r[0]-1,0)).replace(/[^\t]/g," "),o=r[1]||1;t=["\n ",A(u.gutter,i.replace(/\d/g," "))," ",n,A(u.marker,"^").repeat(o)].join(""),s&&a.message&&(t+=" "+A(u.message,a.message))}return[A(u.marker,">"),A(u.gutter,i),e.length>0?" ".concat(e):"",t].join("")}return" ".concat(A(u.gutter,i)).concat(e.length>0?" ".concat(e):"")})).join("\n");return a.message&&!C&&(f="".concat(" ".repeat(m+1)).concat(a.message,"\n").concat(f)),c?g.reset(f):f}})),oH={};OL(oH,{__debug:()=>dY,check:()=>uY,doc:()=>XX,format:()=>gY,formatWithCursor:()=>cY,getSupportInfo:()=>AY,util:()=>_X,version:()=>UX});var aH=(e,t,n,i)=>{if(!e||null!=t)return t.replaceAll?t.replaceAll(n,i):n.global?t.replace(n,i):t.split(n).join(i)};function lH(){}function cH(e,t,n,i,r){for(var s,o=[];t;)o.push(t),s=t.previousComponent,delete t.previousComponent,t=s;o.reverse();for(var a=0,l=o.length,c=0,g=0;a<l;a++){var u=o[a];if(u.removed){if(u.value=e.join(i.slice(g,g+u.count)),g+=u.count,a&&o[a-1].added){var A=o[a-1];o[a-1]=o[a],o[a]=A}}else{if(!u.added&&r){var d=n.slice(c,c+u.count);d=d.map((function(e,t){var n=i[g+t];return n.length>e.length?n:e})),u.value=e.join(d)}else u.value=e.join(n.slice(c,c+u.count));c+=u.count,u.added||(g+=u.count)}}var h=o[l-1];return l>1&&"string"==typeof h.value&&(h.added||h.removed)&&e.equals("",h.value)&&(o[l-2].value+=h.value,o.pop()),o}lH.prototype={diff:function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=i.callback;"function"==typeof i&&(r=i,i={}),this.options=i;var s=this;function o(e){return r?(setTimeout((function(){r(void 0,e)}),0),!0):e}e=this.castInput(e),t=this.castInput(t),e=this.removeEmpty(this.tokenize(e));var a=(t=this.removeEmpty(this.tokenize(t))).length,l=e.length,c=1,g=a+l;i.maxEditLength&&(g=Math.min(g,i.maxEditLength));var u=null!==(n=i.timeout)&&void 0!==n?n:1/0,A=Date.now()+u,d=[{oldPos:-1,lastComponent:void 0}],h=this.extractCommon(d[0],t,e,0);if(d[0].oldPos+1>=l&&h+1>=a)return o([{value:this.join(t),count:t.length}]);var I=-1/0,p=1/0;function C(){for(var n=Math.max(I,-c);n<=Math.min(p,c);n+=2){var i=void 0,r=d[n-1],g=d[n+1];r&&(d[n-1]=void 0);var u=!1;if(g){var A=g.oldPos-n;u=g&&0<=A&&A<a}var C=r&&r.oldPos+1<l;if(u||C){if(i=!C||u&&r.oldPos+1<g.oldPos?s.addToPath(g,!0,void 0,0):s.addToPath(r,void 0,!0,1),h=s.extractCommon(i,t,e,n),i.oldPos+1>=l&&h+1>=a)return o(cH(s,i.lastComponent,t,e,s.useLongestToken));d[n]=i,i.oldPos+1>=l&&(p=Math.min(p,n-1)),h+1>=a&&(I=Math.max(I,n+1))}else d[n]=void 0}c++}if(r)!function e(){setTimeout((function(){if(c>g||Date.now()>A)return r();C()||e()}),0)}();else for(;c<=g&&Date.now()<=A;){var m=C();if(m)return m}},addToPath:function(e,t,n,i){var r=e.lastComponent;return r&&r.added===t&&r.removed===n?{oldPos:e.oldPos+i,lastComponent:{count:r.count+1,added:t,removed:n,previousComponent:r.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:t,removed:n,previousComponent:r}}},extractCommon:function(e,t,n,i){for(var r=t.length,s=n.length,o=e.oldPos,a=o-i,l=0;a+1<r&&o+1<s&&this.equals(t[a+1],n[o+1]);)a++,o++,l++;return l&&(e.lastComponent={count:l,previousComponent:e.lastComponent}),e.oldPos=o,a},equals:function(e,t){return this.options.comparator?this.options.comparator(e,t):e===t||this.options.ignoreCase&&e.toLowerCase()===t.toLowerCase()},removeEmpty:function(e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};new lH;var gH=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,uH=/\S/,AH=new lH;AH.equals=function(e,t){return this.options.ignoreCase&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t||this.options.ignoreWhitespace&&!uH.test(e)&&!uH.test(t)},AH.tokenize=function(e){for(var t=e.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),n=0;n<t.length-1;n++)!t[n+1]&&t[n+2]&&gH.test(t[n])&&gH.test(t[n+2])&&(t[n]+=t[n+2],t.splice(n+1,2),n--);return t};var dH=new lH;function hH(e){return hH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hH(e)}dH.tokenize=function(e){this.options.stripTrailingCr&&(e=e.replace(/\r\n/g,"\n"));var t=[],n=e.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(var i=0;i<n.length;i++){var r=n[i];i%2&&!this.options.newlineIsToken?t[t.length-1]+=r:(this.options.ignoreWhitespace&&(r=r.trim()),t.push(r))}return t},(new lH).tokenize=function(e){return e.split(/(\S.+?[.!?])(?=\s+|$)/)},(new lH).tokenize=function(e){return e.split(/([{}:;,]|\s+)/)};var IH=Object.prototype.toString,pH=new lH;function CH(e,t,n,i,r){var s,o;for(t=t||[],n=n||[],i&&(e=i(r,e)),s=0;s<t.length;s+=1)if(t[s]===e)return n[s];if("[object Array]"===IH.call(e)){for(t.push(e),o=new Array(e.length),n.push(o),s=0;s<e.length;s+=1)o[s]=CH(e[s],t,n,i,r);return t.pop(),n.pop(),o}if(e&&e.toJSON&&(e=e.toJSON()),"object"===hH(e)&&null!==e){t.push(e),o={},n.push(o);var a,l=[];for(a in e)e.hasOwnProperty(a)&&l.push(a);for(l.sort(),s=0;s<l.length;s+=1)o[a=l[s]]=CH(e[a],t,n,i,a);t.pop(),n.pop()}else o=e;return o}pH.useLongestToken=!0,pH.tokenize=dH.tokenize,pH.castInput=function(e){var t=this.options,n=t.undefinedReplacement,i=t.stringifyReplacer,r=void 0===i?function(e,t){return typeof t>"u"?n:t}:i;return"string"==typeof e?e:JSON.stringify(CH(e,null,null,r),r,"  ")},pH.equals=function(e,t){return lH.prototype.equals.call(pH,e.replace(/,([\r\n])/g,"$1"),t.replace(/,([\r\n])/g,"$1"))};var mH=new lH;function fH(e){switch(e){case"cr":return"\r";case"crlf":return"\r\n";default:return"\n"}}function yH(e,t){let n;switch(t){case"\n":n=/\n/gu;break;case"\r":n=/\r/gu;break;case"\r\n":n=/\r\n/gu;break;default:throw new Error('Unexpected "eol" '.concat(JSON.stringify(t),"."))}let i=e.match(n);return i?i.length:0}mH.tokenize=function(e){return e.slice()},mH.join=mH.removeEmpty=function(e){return e};var bH="string",BH="array",vH="cursor",wH="indent",GH="align",EH="trim",xH="group",SH="fill",RH="if-break",ZH="indent-if-break",DH="line-suffix",FH="line-suffix-boundary",NH="line",MH="label",WH="break-parent",kH=new Set([vH,wH,GH,EH,xH,SH,RH,ZH,DH,FH,NH,MH,WH]);var TH=function(e){if("string"==typeof e)return bH;if(Array.isArray(e))return BH;if(!e)return;let{type:t}=e;return kH.has(t)?t:void 0};function VH(e){let t=null===e?"null":typeof e;if("string"!==t&&"object"!==t)return"Unexpected doc '".concat(t,"', \nExpected it to be 'string' or 'object'.");if(TH(e))throw new Error("doc is valid.");let n=Object.prototype.toString.call(e);if("[object Object]"!==n)return"Unexpected doc '".concat(n,"'.");let i=(e=>new Intl.ListFormat("en-US",{type:"disjunction"}).format(e))([...kH].map((e=>"'".concat(e,"'"))));return"Unexpected doc.type '".concat(e.type,"'.\nExpected it to be ").concat(i,".")}var LH=class extends Error{constructor(e){super(VH(e)),hC(this,"name","InvalidDocError"),this.doc=e}},HH=LH,QH={};var KH=function(e,t,n,i){let r=[e];for(;r.length>0;){let e=r.pop();if(e===QH){n(r.pop());continue}n&&r.push(e,QH);let s=TH(e);if(!s)throw new HH(e);if(!1!==(null==t?void 0:t(e)))switch(s){case BH:case SH:{let t=s===BH?e:e.parts;for(let e=t.length-1;e>=0;--e)r.push(t[e]);break}case RH:r.push(e.flatContents,e.breakContents);break;case xH:if(i&&e.expandedStates)for(let t=e.expandedStates.length-1;t>=0;--t)r.push(e.expandedStates[t]);else r.push(e.contents);break;case GH:case wH:case ZH:case MH:case DH:r.push(e.contents);break;case bH:case vH:case EH:case FH:case NH:case WH:break;default:throw new HH(e)}}},XH=()=>{},YH=XH,zH=XH;function PH(e){return YH(e),{type:wH,contents:e}}function UH(e,t){return YH(t),{type:GH,contents:t,n:e}}function _H(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return YH(e),zH(t.expandedStates,!0),{type:xH,id:t.id,contents:e,break:!!t.shouldBreak,expandedStates:t.expandedStates}}function OH(e){return zH(e),{type:SH,parts:e}}function JH(e){return YH(e),{type:DH,contents:e}}var jH={type:FH},qH={type:WH},$H={type:EH},eQ={type:NH,hard:!0},tQ={type:NH,hard:!0,literal:!0},nQ={type:NH},iQ={type:NH,soft:!0},rQ=[eQ,qH],sQ=[tQ,qH],oQ={type:vH};function aQ(e,t){YH(e),zH(t);let n=[];for(let i=0;i<t.length;i++)0!==i&&n.push(e),n.push(t[i]);return n}function lQ(e,t,n){YH(e);let i=e;if(t>0){for(let e=0;e<Math.floor(t/n);++e)i=PH(i);i=UH(t%n,i),i=UH(Number.NEGATIVE_INFINITY,i)}return i}function cQ(e){var t;if(!e)return"";if(Array.isArray(e)){let t=[];for(let n of e)if(Array.isArray(n))t.push(...cQ(n));else{let e=cQ(n);""!==e&&t.push(e)}return t}return e.type===RH?{...e,breakContents:cQ(e.breakContents),flatContents:cQ(e.flatContents)}:e.type===xH?{...e,contents:cQ(e.contents),expandedStates:null==(t=e.expandedStates)?void 0:t.map(cQ)}:e.type===SH?{type:"fill",parts:e.parts.map(cQ)}:e.contents?{...e,contents:cQ(e.contents)}:e}var gQ=(e,t,n)=>{if(!e||null!=t)return Array.isArray(t)||"string"==typeof t?t[n<0?t.length+n:n]:t.at(n)};var uQ=e=>!(function(e){return 12288===e||e>=65281&&e<=65376||e>=65504&&e<=65510}(e)||function(e){return e>=4352&&e<=4447||8986===e||8987===e||9001===e||9002===e||e>=9193&&e<=9196||9200===e||9203===e||9725===e||9726===e||9748===e||9749===e||e>=9800&&e<=9811||9855===e||9875===e||9889===e||9898===e||9899===e||9917===e||9918===e||9924===e||9925===e||9934===e||9940===e||9962===e||9970===e||9971===e||9973===e||9978===e||9981===e||9989===e||9994===e||9995===e||10024===e||10060===e||10062===e||e>=10067&&e<=10069||10071===e||e>=10133&&e<=10135||10160===e||10175===e||11035===e||11036===e||11088===e||11093===e||e>=11904&&e<=11929||e>=11931&&e<=12019||e>=12032&&e<=12245||e>=12272&&e<=12287||e>=12289&&e<=12350||e>=12353&&e<=12438||e>=12441&&e<=12543||e>=12549&&e<=12591||e>=12593&&e<=12686||e>=12688&&e<=12771||e>=12783&&e<=12830||e>=12832&&e<=12871||e>=12880&&e<=19903||e>=19968&&e<=42124||e>=42128&&e<=42182||e>=43360&&e<=43388||e>=44032&&e<=55203||e>=63744&&e<=64255||e>=65040&&e<=65049||e>=65072&&e<=65106||e>=65108&&e<=65126||e>=65128&&e<=65131||e>=94176&&e<=94180||94192===e||94193===e||e>=94208&&e<=100343||e>=100352&&e<=101589||e>=101632&&e<=101640||e>=110576&&e<=110579||e>=110581&&e<=110587||110589===e||110590===e||e>=110592&&e<=110882||110898===e||e>=110928&&e<=110930||110933===e||e>=110948&&e<=110951||e>=110960&&e<=111355||126980===e||127183===e||127374===e||e>=127377&&e<=127386||e>=127488&&e<=127490||e>=127504&&e<=127547||e>=127552&&e<=127560||127568===e||127569===e||e>=127584&&e<=127589||e>=127744&&e<=127776||e>=127789&&e<=127797||e>=127799&&e<=127868||e>=127870&&e<=127891||e>=127904&&e<=127946||e>=127951&&e<=127955||e>=127968&&e<=127984||127988===e||e>=127992&&e<=128062||128064===e||e>=128066&&e<=128252||e>=128255&&e<=128317||e>=128331&&e<=128334||e>=128336&&e<=128359||128378===e||128405===e||128406===e||128420===e||e>=128507&&e<=128591||e>=128640&&e<=128709||128716===e||e>=128720&&e<=128722||e>=128725&&e<=128727||e>=128732&&e<=128735||128747===e||128748===e||e>=128756&&e<=128764||e>=128992&&e<=129003||129008===e||e>=129292&&e<=129338||e>=129340&&e<=129349||e>=129351&&e<=129535||e>=129648&&e<=129660||e>=129664&&e<=129672||e>=129680&&e<=129725||e>=129727&&e<=129733||e>=129742&&e<=129755||e>=129760&&e<=129768||e>=129776&&e<=129784||e>=131072&&e<=196605||e>=196608&&e<=262141}(e)),AQ=/[^\x20-\x7F]/u;var dQ=function(e){if(!e)return 0;if(!AQ.test(e))return e.length;e=e.replace(/[#*0-9]\uFE0F?\u20E3|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23ED-\u23EF\u23F1\u23F2\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692\u2694-\u2697\u2699\u269B\u269C\u26A0\u26A7\u26AA\u26B0\u26B1\u26BD\u26BE\u26C4\u26C8\u26CF\u26D1\u26E9\u26F0-\u26F5\u26F7\u26F8\u26FA\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B55\u3030\u303D\u3297\u3299]\uFE0F?|[\u261D\u270C\u270D](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\u270A\u270B](?:\uD83C[\uDFFB-\uDFFF])?|[\u23E9-\u23EC\u23F0\u23F3\u25FD\u2693\u26A1\u26AB\u26C5\u26CE\u26D4\u26EA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2795-\u2797\u27B0\u27BF\u2B50]|\u26D3\uFE0F?(?:\u200D\uD83D\uDCA5)?|\u26F9(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\u2764\uFE0F?(?:\u200D(?:\uD83D\uDD25|\uD83E\uDE79))?|\uD83C(?:[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF5\uDFF7]\uFE0F?|[\uDF85\uDFC2\uDFC7](?:\uD83C[\uDFFB-\uDFFF])?|[\uDFC4\uDFCA](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDFCB\uDFCC](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF43\uDF45-\uDF4A\uDF4C-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF8-\uDFFF]|\uDDE6\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF]|\uDDE7\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF]|\uDDE8\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF]|\uDDE9\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF]|\uDDEA\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA]|\uDDEB\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7]|\uDDEC\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE]|\uDDED\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA]|\uDDEE\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9]|\uDDEF\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5]|\uDDF0\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF]|\uDDF1\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE]|\uDDF2\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF]|\uDDF3\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF]|\uDDF4\uD83C\uDDF2|\uDDF5\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE]|\uDDF6\uD83C\uDDE6|\uDDF7\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC]|\uDDF8\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF]|\uDDF9\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF]|\uDDFA\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF]|\uDDFB\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA]|\uDDFC\uD83C[\uDDEB\uDDF8]|\uDDFD\uD83C\uDDF0|\uDDFE\uD83C[\uDDEA\uDDF9]|\uDDFF\uD83C[\uDDE6\uDDF2\uDDFC]|\uDF44(?:\u200D\uD83D\uDFEB)?|\uDF4B(?:\u200D\uD83D\uDFE9)?|\uDFC3(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?|\uDFF3\uFE0F?(?:\u200D(?:\u26A7\uFE0F?|\uD83C\uDF08))?|\uDFF4(?:\u200D\u2620\uFE0F?|\uDB40\uDC67\uDB40\uDC62\uDB40(?:\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDC73\uDB40\uDC63\uDB40\uDC74|\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F)?)|\uD83D(?:[\uDC3F\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3]\uFE0F?|[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC](?:\uD83C[\uDFFB-\uDFFF])?|[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4\uDEB5](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD74\uDD90](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\uDC00-\uDC07\uDC09-\uDC14\uDC16-\uDC25\uDC27-\uDC3A\uDC3C-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE2D\uDE2F-\uDE34\uDE37-\uDE41\uDE43\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED7\uDEDC-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uDC08(?:\u200D\u2B1B)?|\uDC15(?:\u200D\uD83E\uDDBA)?|\uDC26(?:\u200D(?:\u2B1B|\uD83D\uDD25))?|\uDC3B(?:\u200D\u2744\uFE0F?)?|\uDC41\uFE0F?(?:\u200D\uD83D\uDDE8\uFE0F?)?|\uDC68(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDC68\uDC69]\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFE])))?))?|\uDC69(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?[\uDC68\uDC69]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?|\uDC69\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?))|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFE])))?))?|\uDC6F(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDD75(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDE2E(?:\u200D\uD83D\uDCA8)?|\uDE35(?:\u200D\uD83D\uDCAB)?|\uDE36(?:\u200D\uD83C\uDF2B\uFE0F?)?|\uDE42(?:\u200D[\u2194\u2195]\uFE0F?)?|\uDEB6(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?)|\uD83E(?:[\uDD0C\uDD0F\uDD18-\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5\uDEC3-\uDEC5\uDEF0\uDEF2-\uDEF8](?:\uD83C[\uDFFB-\uDFFF])?|[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD\uDDCF\uDDD4\uDDD6-\uDDDD](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDDDE\uDDDF](?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD0D\uDD0E\uDD10-\uDD17\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3F-\uDD45\uDD47-\uDD76\uDD78-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCC\uDDD0\uDDE0-\uDDFF\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC2\uDECE-\uDEDB\uDEE0-\uDEE8]|\uDD3C(?:\u200D[\u2640\u2642]\uFE0F?|\uD83C[\uDFFB-\uDFFF])?|\uDDCE(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?|\uDDD1(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1|\uDDD1\u200D\uD83E\uDDD2(?:\u200D\uD83E\uDDD2)?|\uDDD2(?:\u200D\uD83E\uDDD2)?))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?))?|\uDEF1(?:\uD83C(?:\uDFFB(?:\u200D\uD83E\uDEF2\uD83C[\uDFFC-\uDFFF])?|\uDFFC(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFD-\uDFFF])?|\uDFFD(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])?|\uDFFE(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFD\uDFFF])?|\uDFFF(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFE])?))?)/g,"  ");let t=0;for(let n of e){let e=n.codePointAt(0);e<=31||e>=127&&e<=159||e>=768&&e<=879||(t+=uQ(e)?1:2)}return t};function hQ(e,t){if("string"==typeof e)return t(e);let n=new Map;return i(e);function i(e){if(n.has(e))return n.get(e);let r=function(e){switch(TH(e)){case BH:return t(e.map(i));case SH:return t({...e,parts:e.parts.map(i)});case RH:return t({...e,breakContents:i(e.breakContents),flatContents:i(e.flatContents)});case xH:{let{expandedStates:n,contents:r}=e;return n?(n=n.map(i),r=n[0]):r=i(r),t({...e,contents:r,expandedStates:n})}case GH:case wH:case ZH:case MH:case DH:return t({...e,contents:i(e.contents)});case bH:case vH:case EH:case FH:case NH:case WH:return t(e);default:throw new HH(e)}}(e);return n.set(e,r),r}}function IQ(e,t,n){let i=n,r=!1;return KH(e,(function(e){if(r)return!1;let n=t(e);void 0!==n&&(r=!0,i=n)})),i}function pQ(e){if(e.type===xH&&e.break||e.type===NH&&e.hard||e.type===WH)return!0}function CQ(e){if(e.length>0){let t=gQ(!1,e,-1);!t.expandedStates&&!t.break&&(t.break="propagated")}return null}function mQ(e){return e.type!==NH||e.hard?e.type===RH?e.flatContents:e:e.soft?"":" "}function fQ(e){for(e=[...e];e.length>=2&&gQ(!1,e,-2).type===NH&&gQ(!1,e,-1).type===WH;)e.length-=2;if(e.length>0){let t=yQ(gQ(!1,e,-1));e[e.length-1]=t}return e}function yQ(e){switch(TH(e)){case wH:case ZH:case xH:case DH:case MH:{let t=yQ(e.contents);return{...e,contents:t}}case RH:return{...e,breakContents:yQ(e.breakContents),flatContents:yQ(e.flatContents)};case SH:return{...e,parts:fQ(e.parts)};case BH:return fQ(e);case bH:return e.replace(/[\n\r]*$/u,"");case GH:case vH:case EH:case FH:case NH:case WH:break;default:throw new HH(e)}return e}function bQ(e){return yQ(function(e){return hQ(e,(e=>function(e){switch(TH(e)){case SH:if(e.parts.every((e=>""===e)))return"";break;case xH:if(!e.contents&&!e.id&&!e.break&&!e.expandedStates)return"";if(e.contents.type===xH&&e.contents.id===e.id&&e.contents.break===e.break&&e.contents.expandedStates===e.expandedStates)return e.contents;break;case GH:case wH:case ZH:case DH:if(!e.contents)return"";break;case RH:if(!e.flatContents&&!e.breakContents)return"";break;case BH:{let t=[];for(let n of e){if(!n)continue;let[e,...i]=Array.isArray(n)?n:[n];"string"==typeof e&&"string"==typeof gQ(!1,t,-1)?t[t.length-1]+=e:t.push(e),t.push(...i)}return 0===t.length?"":1===t.length?t[0]:t}case bH:case vH:case EH:case FH:case NH:case MH:case WH:break;default:throw new HH(e)}return e}(e)))}(e))}function BQ(e){if(e.type===NH)return!0}function vQ(e,t){return e.type===MH?{...e,contents:t(e.contents)}:t(e)}var wQ=Symbol("MODE_BREAK"),GQ=Symbol("MODE_FLAT"),EQ=Symbol("cursor");function xQ(e,t){return RQ(e,{type:"indent"},t)}function SQ(e,t,n){return t===Number.NEGATIVE_INFINITY?e.root||{value:"",length:0,queue:[]}:t<0?RQ(e,{type:"dedent"},n):t?"root"===t.type?{...e,root:e}:RQ(e,{type:"string"==typeof t?"stringAlign":"numberAlign",n:t},n):e}function RQ(e,t,n){let i="dedent"===t.type?e.queue.slice(0,-1):[...e.queue,t],r="",s=0,o=0,a=0;for(let d of i)switch(d.type){case"indent":g(),n.useTabs?l(1):c(n.tabWidth);break;case"stringAlign":g(),r+=d.n,s+=d.n.length;break;case"numberAlign":o+=1,a+=d.n;break;default:throw new Error("Unexpected type '".concat(d.type,"'"))}return u(),{...e,value:r,length:s,queue:i};function l(e){r+="\t".repeat(e),s+=n.tabWidth*e}function c(e){r+=" ".repeat(e),s+=e}function g(){n.useTabs?(o>0&&l(o),A()):u()}function u(){a>0&&c(a),A()}function A(){o=0,a=0}}function ZQ(e){let t=0,n=0,i=e.length;e:for(;i--;){let r=e[i];if(r!==EQ)for(let n=r.length-1;n>=0;n--){let s=r[n];if(" "!==s&&"\t"!==s){e[i]=r.slice(0,n+1);break e}t++}else n++}if(t>0||n>0)for(e.length=i+1;n-- >0;)e.push(EQ);return t}function DQ(e,t,n,i,r,s){if(n===Number.POSITIVE_INFINITY)return!0;let o=t.length,a=[e],l=[];for(;n>=0;){if(0===a.length){if(0===o)return!0;a.push(t[--o]);continue}let{mode:e,doc:c}=a.pop(),g=TH(c);switch(g){case bH:l.push(c),n-=dQ(c);break;case BH:case SH:{let t=g===BH?c:c.parts;for(let n=t.length-1;n>=0;n--)a.push({mode:e,doc:t[n]});break}case wH:case GH:case ZH:case MH:a.push({mode:e,doc:c.contents});break;case EH:n+=ZQ(l);break;case xH:{if(s&&c.break)return!1;let t=c.break?wQ:e,n=c.expandedStates&&t===wQ?gQ(!1,c.expandedStates,-1):c.contents;a.push({mode:t,doc:n});break}case RH:{let t=(c.groupId?r[c.groupId]||GQ:e)===wQ?c.breakContents:c.flatContents;t&&a.push({mode:e,doc:t});break}case NH:if(e===wQ||c.hard)return!0;c.soft||(l.push(" "),n--);break;case DH:i=!0;break;case FH:if(i)return!1}}return!1}function FQ(e,t){let n={},i=t.printWidth,r=fH(t.endOfLine),s=0,o=[{ind:{value:"",length:0,queue:[]},mode:wQ,doc:e}],a=[],l=!1,c=[],g=0;for(function(e){let t=new Set,n=[];KH(e,(function(e){if(e.type===WH&&CQ(n),e.type===xH){if(n.push(e),t.has(e))return!1;t.add(e)}}),(function(e){e.type===xH&&n.pop().break&&CQ(n)}),!0)}(e);o.length>0;){let{ind:e,mode:u,doc:A}=o.pop();switch(TH(A)){case bH:{let e="\n"!==r?aH(!1,A,"\n",r):A;a.push(e),o.length>0&&(s+=dQ(e));break}case BH:for(let t=A.length-1;t>=0;t--)o.push({ind:e,mode:u,doc:A[t]});break;case vH:if(g>=2)throw new Error("There are too many 'cursor' in doc.");a.push(EQ),g++;break;case wH:o.push({ind:xQ(e,t),mode:u,doc:A.contents});break;case GH:o.push({ind:SQ(e,A.n,t),mode:u,doc:A.contents});break;case EH:s-=ZQ(a);break;case xH:switch(u){case GQ:if(!l){o.push({ind:e,mode:A.break?wQ:GQ,doc:A.contents});break}case wQ:{l=!1;let t={ind:e,mode:GQ,doc:A.contents},r=i-s,a=c.length>0;if(!A.break&&DQ(t,o,r,a,n))o.push(t);else if(A.expandedStates){let t=gQ(!1,A.expandedStates,-1);if(A.break){o.push({ind:e,mode:wQ,doc:t});break}for(let i=1;i<A.expandedStates.length+1;i++){if(i>=A.expandedStates.length){o.push({ind:e,mode:wQ,doc:t});break}{let t=A.expandedStates[i],s={ind:e,mode:GQ,doc:t};if(DQ(s,o,r,a,n)){o.push(s);break}}}}else o.push({ind:e,mode:wQ,doc:A.contents});break}}A.id&&(n[A.id]=gQ(!1,o,-1).mode);break;case SH:{let t=i-s,{parts:r}=A;if(0===r.length)break;let[a,l]=r,g={ind:e,mode:GQ,doc:a},d={ind:e,mode:wQ,doc:a},h=DQ(g,[],t,c.length>0,n,!0);if(1===r.length){h?o.push(g):o.push(d);break}let I={ind:e,mode:GQ,doc:l},p={ind:e,mode:wQ,doc:l};if(2===r.length){h?o.push(I,g):o.push(p,d);break}r.splice(0,2);let C={ind:e,mode:u,doc:OH(r)},m=r[0];DQ({ind:e,mode:GQ,doc:[a,l,m]},[],t,c.length>0,n,!0)?o.push(C,I,g):h?o.push(C,p,g):o.push(C,p,d);break}case RH:case ZH:{let t=A.groupId?n[A.groupId]:u;if(t===wQ){let t=A.type===RH?A.breakContents:A.negate?A.contents:PH(A.contents);t&&o.push({ind:e,mode:u,doc:t})}if(t===GQ){let t=A.type===RH?A.flatContents:A.negate?PH(A.contents):A.contents;t&&o.push({ind:e,mode:u,doc:t})}break}case DH:c.push({ind:e,mode:u,doc:A.contents});break;case FH:c.length>0&&o.push({ind:e,mode:u,doc:eQ});break;case NH:switch(u){case GQ:if(!A.hard){A.soft||(a.push(" "),s+=1);break}l=!0;case wQ:if(c.length>0){o.push({ind:e,mode:u,doc:A},...c.reverse()),c.length=0;break}A.literal?e.root?(a.push(r,e.root.value),s=e.root.length):(a.push(r),s=0):(s-=ZQ(a),a.push(r+e.value),s=e.length)}break;case MH:o.push({ind:e,mode:u,doc:A.contents});break;case WH:break;default:throw new HH(A)}0===o.length&&c.length>0&&(o.push(...c.reverse()),c.length=0)}let u=a.indexOf(EQ);if(-1!==u){let e=a.indexOf(EQ,u+1),t=a.slice(0,u).join(""),n=a.slice(u+1,e).join("");return{formatted:t+n+a.slice(e+1).join(""),cursorNodeStart:t.length,cursorNodeText:n}}return{formatted:a.join("")}}var NQ,MQ,WQ,kQ=function(e,t){let n=0;for(let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;i<e.length;++i)"\t"===e[i]?n=n+t-n%t:n++;return n};NQ=new WeakSet,MQ=function(e){let{stack:t}=this;for(let n=t.length-1;n>=0;n-=2)if(!Array.isArray(t[n])&&--e<0)return n;return-1},WQ=function*(){let{stack:e}=this;for(let t=e.length-3;t>=0;t-=2){let n=e[t];Array.isArray(n)||(yield n)}};var TQ=class{constructor(e){((e,t,n)=>{t.has(e)?UL("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n)})(this,NQ),this.stack=[e]}get key(){var e;let{stack:t,siblings:n}=this;return null!==(e=gQ(!1,t,null===n?-2:-4))&&void 0!==e?e:null}get index(){return null===this.siblings?null:gQ(!1,this.stack,-2)}get node(){return gQ(!1,this.stack,-1)}get parent(){return this.getNode(1)}get grandparent(){return this.getNode(2)}get isInArray(){return null!==this.siblings}get siblings(){let{stack:e}=this,t=gQ(!1,e,-3);return Array.isArray(t)?t:null}get next(){let{siblings:e}=this;return null===e?null:e[this.index+1]}get previous(){let{siblings:e}=this;return null===e?null:e[this.index-1]}get isFirst(){return 0===this.index}get isLast(){let{siblings:e,index:t}=this;return null!==e&&t===e.length-1}get isRoot(){return 1===this.stack.length}get root(){return this.stack[0]}get ancestors(){return[...qL(this,NQ,WQ).call(this)]}getName(){let{stack:e}=this,{length:t}=e;return t>1?gQ(!1,e,-2):null}getValue(){return gQ(!1,this.stack,-1)}getNode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=qL(this,NQ,MQ).call(this,e);return-1===t?null:this.stack[t]}getParentNode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getNode(e+1)}call(e){let{stack:t}=this,{length:n}=t,i=gQ(!1,t,-1);for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];for(let a of s)i=i[a],t.push(a,i);try{return e(this)}finally{t.length=n}}callParent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=qL(this,NQ,MQ).call(this,t+1),i=this.stack.splice(n+1);try{return e(this)}finally{this.stack.push(...i)}}each(e){let{stack:t}=this,{length:n}=t,i=gQ(!1,t,-1);for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];for(let a of s)i=i[a],t.push(a,i);try{for(let n=0;n<i.length;++n)t.push(n,i[n]),e(this,n,i),t.length-=2}finally{t.length=n}}map(e){let t=[];for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return this.each(((n,i,r)=>{t[i]=e(n,i,r)}),...i),t}match(){let e=this.stack.length-1,t=null,n=this.stack[e--];for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];for(let o of r){if(void 0===n)return!1;let i=null;if("number"==typeof t&&(i=t,t=this.stack[e--],n=this.stack[e--]),o&&!o(n,t,i))return!1;t=this.stack[e--],n=this.stack[e--]}return!0}findAncestor(e){for(let t of qL(this,NQ,WQ).call(this))if(e(t))return t}hasAncestor(e){for(let t of qL(this,NQ,WQ).call(this))if(e(t))return!0;return!1}},VQ=new Proxy((()=>{}),{get:()=>VQ}),LQ=VQ;var HQ=function(e){return null!==e&&"object"==typeof e};function*QQ(e,t){let{getVisitorKeys:n,filter:i=()=>!0}=t,r=e=>HQ(e)&&i(e);for(let s of n(e)){let t=e[s];if(Array.isArray(t))for(let e of t)r(e)&&(yield e);else r(t)&&(yield t)}}function KQ(e){return(t,n,i)=>{let r=!(null==i||!i.backwards);if(!1===n)return!1;let{length:s}=t,o=n;for(;o>=0&&o<s;){let n=t.charAt(o);if(e instanceof RegExp){if(!e.test(n))return o}else if(!e.includes(n))return o;r?o--:o++}return(-1===o||o===s)&&o}}var XQ=KQ(/\s/u),YQ=KQ(" \t"),zQ=KQ(",; \t"),PQ=KQ(/[^\n\r]/u);var UQ=function(e,t,n){let i=!(null==n||!n.backwards);if(!1===t)return!1;let r=e.charAt(t);if(i){if("\r"===e.charAt(t-1)&&"\n"===r)return t-2;if("\n"===r||"\r"===r||"\u2028"===r||"\u2029"===r)return t-1}else{if("\r"===r&&"\n"===e.charAt(t+1))return t+2;if("\n"===r||"\r"===r||"\u2028"===r||"\u2029"===r)return t+1}return t};var _Q=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=YQ(e,n.backwards?t-1:t,n);return i!==UQ(e,i,n)};var OQ=function(e){return Array.isArray(e)&&e.length>0},JQ=new Set(["tokens","comments","parent","enclosingNode","precedingNode","followingNode"]),jQ=e=>Object.keys(e).filter((e=>!JQ.has(e)));var qQ=function(e){return e?t=>e(t,JQ):jQ};function $Q(e,t){var n;(null!==(n=e.comments)&&void 0!==n?n:e.comments=[]).push(t),t.printed=!1,t.nodeDescription=function(e){let t=e.type||e.kind||"(unknown type)",n=String(e.name||e.id&&("object"==typeof e.id?e.id.name:e.id)||e.key&&("object"==typeof e.key?e.key.name:e.key)||e.value&&("object"==typeof e.value?"":String(e.value))||e.operator||"");return n.length>20&&(n=n.slice(0,19)+"\u2026"),t+(n?" "+n:"")}(e)}function eK(e,t){t.leading=!0,t.trailing=!1,$Q(e,t)}function tK(e,t,n){t.leading=!1,t.trailing=!1,n&&(t.marker=n),$Q(e,t)}function nK(e,t){t.leading=!1,t.trailing=!0,$Q(e,t)}var iK=new WeakMap;function rK(e,t){var n;if(iK.has(e))return iK.get(e);let{printer:{getCommentChildNodes:i,canAttachComment:r,getVisitorKeys:s},locStart:o,locEnd:a}=t;if(!r)return[];let l=(null!==(n=null==i?void 0:i(e,t))&&void 0!==n?n:[...QQ(e,{getVisitorKeys:qQ(s)})]).flatMap((e=>r(e)?[e]:rK(e,t)));return l.sort(((e,t)=>o(e)-o(t)||a(e)-a(t))),iK.set(e,l),l}function sK(e,t,n,i){let r,s,{locStart:o,locEnd:a}=n,l=o(t),c=a(t),g=rK(e,n),u=0,A=g.length;for(;u<A;){let e=u+A>>1,i=g[e],d=o(i),h=a(i);if(d<=l&&c<=h)return sK(i,t,n,i);if(h<=l)r=i,u=e+1;else{if(!(c<=d))throw new Error("Comment location overlaps with node location");s=i,A=e}}if("TemplateLiteral"===(null==i?void 0:i.type)){let{quasis:e}=i,o=uK(e,t,n);r&&uK(e,r,n)!==o&&(r=null),s&&uK(e,s,n)!==o&&(s=null)}return{enclosingNode:i,precedingNode:r,followingNode:s}}var oK=()=>!1;var aK=e=>!/[\S\n\u2028\u2029]/u.test(e);function lK(e,t,n,i){let{comment:r,precedingNode:s}=n[i],{locStart:o,locEnd:a}=t,l=o(r);if(s)for(let c=i-1;c>=0;c--){let{comment:t,precedingNode:i}=n[c];if(i!==s||!aK(e.slice(a(t),l)))break;l=o(t)}return _Q(e,l,{backwards:!0})}function cK(e,t,n,i){let{comment:r,followingNode:s}=n[i],{locStart:o,locEnd:a}=t,l=a(r);if(s)for(let c=i+1;c<n.length;c++){let{comment:t,followingNode:i}=n[c];if(i!==s||!aK(e.slice(l,o(t))))break;l=a(t)}return _Q(e,l)}function gK(e,t){var n,i;let r=e.length;if(0===r)return;let s,{precedingNode:o,followingNode:a}=e[0],l=t.locStart(a);for(s=r;s>0;--s){var c;let{comment:r,precedingNode:g,followingNode:u}=e[s-1];LQ.strictEqual(g,o),LQ.strictEqual(u,a);let A=t.originalText.slice(t.locEnd(r),l);if(!(null!==(c=null==(i=(n=t.printer).isGap)?void 0:i.call(n,A,t))&&void 0!==c?c:/^[\s(]*$/u.test(A)))break;l=t.locStart(r)}for(let[g,{comment:u}]of e.entries())g<s?nK(o,u):eK(a,u);for(let g of[o,a])g.comments&&g.comments.length>1&&g.comments.sort(((e,n)=>t.locStart(e)-t.locStart(n)));e.length=0}function uK(e,t,n){let i=n.locStart(t)-1;for(let r=1;r<e.length;++r)if(i<n.locStart(e[r]))return r-1;return 0}var AK=function(e,t){let n=t-1;return n=YQ(e,n,{backwards:!0}),n=UQ(e,n,{backwards:!0}),n=YQ(e,n,{backwards:!0}),n!==UQ(e,n,{backwards:!0})};function dK(e,t){return e.node.printed=!0,t.printer.printComment(e,t)}function hK(e,t){let n=e.node;if(!n)return{};let i=t[Symbol.for("printedComments")];if(0===(n.comments||[]).filter((e=>!i.has(e))).length)return{leading:"",trailing:""};let r,s=[],o=[];return e.each((()=>{let n=e.node;if(null!=i&&i.has(n))return;let{leading:a,trailing:l}=n;a?s.push(function(e,t){var n;let i=e.node,r=[dK(e,t)],{printer:s,originalText:o,locStart:a,locEnd:l}=t;if(null==(n=s.isBlockComment)?void 0:n.call(s,i)){let e=_Q(o,l(i))?_Q(o,a(i),{backwards:!0})?rQ:nQ:" ";r.push(e)}else r.push(rQ);let c=UQ(o,YQ(o,l(i)));return!1!==c&&_Q(o,c)&&r.push(rQ),r}(e,t)):l&&(r=function(e,t,n){var i;let r=e.node,s=dK(e,t),{printer:o,originalText:a,locStart:l}=t,c=null==(i=o.isBlockComment)?void 0:i.call(o,r);if(null!=n&&n.hasLineSuffix&&(null==n||!n.isBlock)||_Q(a,l(r),{backwards:!0})){let e=AK(a,l(r));return{doc:JH([rQ,e?rQ:"",s]),isBlock:c,hasLineSuffix:!0}}return!c||null!=n&&n.hasLineSuffix?{doc:[JH([" ",s]),qH],isBlock:c,hasLineSuffix:!0}:{doc:[" ",s],isBlock:c,hasLineSuffix:!1}}(e,t,r),o.push(r.doc))}),"comments"),{leading:s,trailing:o}}var IK=function(e){return()=>{}},pK=class extends Error{constructor(){super(...arguments),hC(this,"name","ConfigError")}},CK=class extends Error{constructor(){super(...arguments),hC(this,"name","UndefinedParserError")}},mK={cursorOffset:{category:"Special",type:"int",default:-1,range:{start:-1,end:1/0,step:1},description:"Print (to stderr) where a cursor at the given position would move to after formatting.",cliCategory:"Editor"},endOfLine:{category:"Global",type:"choice",default:"lf",description:"Which end of line characters to apply.",choices:[{value:"lf",description:"Line Feed only (\\n), common on Linux and macOS as well as inside git repos"},{value:"crlf",description:"Carriage Return + Line Feed characters (\\r\\n), common on Windows"},{value:"cr",description:"Carriage Return character only (\\r), used very rarely"},{value:"auto",description:"Maintain existing\n(mixed values within one file are normalised by looking at what's used after the first line)"}]},filepath:{category:"Special",type:"path",description:"Specify the input filepath. This will be used to do parser inference.",cliName:"stdin-filepath",cliCategory:"Other",cliDescription:"Path to the file to pretend that stdin comes from."},insertPragma:{category:"Special",type:"boolean",default:!1,description:"Insert @format pragma into file's first docblock comment.",cliCategory:"Other"},parser:{category:"Global",type:"choice",default:void 0,description:"Which parser to use.",exception:e=>"string"==typeof e||"function"==typeof e,choices:[{value:"flow",description:"Flow"},{value:"babel",description:"JavaScript"},{value:"babel-flow",description:"Flow"},{value:"babel-ts",description:"TypeScript"},{value:"typescript",description:"TypeScript"},{value:"acorn",description:"JavaScript"},{value:"espree",description:"JavaScript"},{value:"meriyah",description:"JavaScript"},{value:"css",description:"CSS"},{value:"less",description:"Less"},{value:"scss",description:"SCSS"},{value:"json",description:"JSON"},{value:"json5",description:"JSON5"},{value:"jsonc",description:"JSON with Comments"},{value:"json-stringify",description:"JSON.stringify"},{value:"graphql",description:"GraphQL"},{value:"markdown",description:"Markdown"},{value:"mdx",description:"MDX"},{value:"vue",description:"Vue"},{value:"yaml",description:"YAML"},{value:"glimmer",description:"Ember / Handlebars"},{value:"html",description:"HTML"},{value:"angular",description:"Angular"},{value:"lwc",description:"Lightning Web Components"}]},plugins:{type:"path",array:!0,default:[{value:[]}],category:"Global",description:"Add a plugin. Multiple plugins can be passed as separate `--plugin`s.",exception:e=>"string"==typeof e||"object"==typeof e,cliName:"plugin",cliCategory:"Config"},printWidth:{category:"Global",type:"int",default:80,description:"The line length where Prettier will try wrap.",range:{start:0,end:1/0,step:1}},rangeEnd:{category:"Special",type:"int",default:1/0,range:{start:0,end:1/0,step:1},description:"Format code ending at a given character offset (exclusive).\nThe range will extend forwards to the end of the selected statement.",cliCategory:"Editor"},rangeStart:{category:"Special",type:"int",default:0,range:{start:0,end:1/0,step:1},description:"Format code starting at a given character offset.\nThe range will extend backwards to the start of the first line containing the selected statement.",cliCategory:"Editor"},requirePragma:{category:"Special",type:"boolean",default:!1,description:"Require either '@prettier' or '@format' to be present in the file's first docblock comment\nin order for it to be formatted.",cliCategory:"Other"},tabWidth:{type:"int",category:"Global",default:2,description:"Number of spaces per indentation level.",range:{start:0,end:1/0,step:1}},useTabs:{category:"Global",type:"boolean",default:!1,description:"Indent with tabs instead of spaces."},embeddedLanguageFormatting:{category:"Global",type:"choice",default:"auto",description:"Control how Prettier formats quoted code embedded in the file.",choices:[{value:"auto",description:"Format embedded code if Prettier can automatically identify it."},{value:"off",description:"Never automatically format embedded code."}]}};function fK(){let{plugins:e=[],showDeprecated:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.flatMap((e=>{var t;return null!==(t=e.languages)&&void 0!==t?t:[]})),i=[];for(let r of function(e){let t=[];for(let[n,i]of Object.entries(e)){let e={name:n,...i};Array.isArray(e.default)&&(e.default=gQ(!1,e.default,-1).value),t.push(e)}return t}(Object.assign({},...e.map((e=>{let{options:t}=e;return t})),mK)))!t&&r.deprecated||(Array.isArray(r.choices)&&(t||(r.choices=r.choices.filter((e=>!e.deprecated))),"parser"===r.name&&(r.choices=[...r.choices,...yK(r.choices,n,e)])),r.pluginDefaults=Object.fromEntries(e.filter((e=>{var t;return void 0!==(null==(t=e.defaultOptions)?void 0:t[r.name])})).map((e=>[e.name,e.defaultOptions[r.name]]))),i.push(r));return{languages:n,options:i}}function*yK(e,t,n){let i=new Set(e.map((e=>e.value)));for(let r of t)if(r.parsers)for(let e of r.parsers)if(!i.has(e)){i.add(e);let t=n.find((t=>t.parsers&&Object.prototype.hasOwnProperty.call(t.parsers,e))),s=r.name;null!=t&&t.name&&(s+=" (plugin: ".concat(t.name,")")),yield{value:e,description:s}}}var bK=e=>String(e).split(/[/\\]/u).pop();function BK(e,t){var n;if(!t)return;let i=bK(t).toLowerCase();return null!==(n=e.find((e=>{let{filenames:t}=e;return null==t?void 0:t.some((e=>e.toLowerCase()===i))})))&&void 0!==n?n:e.find((e=>{let{extensions:t}=e;return null==t?void 0:t.some((e=>i.endsWith(e)))}))}var vK=function(e,t){var n,i,r;let s=e.plugins.flatMap((e=>{var t;return null!==(t=e.languages)&&void 0!==t?t:[]})),o=null!==(n=null!==(i=null!==(r=function(e,t){var n,i;if(t)return null!==(n=null!==(i=e.find((e=>{let{name:n}=e;return n.toLowerCase()===t})))&&void 0!==i?i:e.find((e=>{let{aliases:n}=e;return null==n?void 0:n.includes(t)})))&&void 0!==n?n:e.find((e=>{let{extensions:n}=e;return null==n?void 0:n.includes(".".concat(t))}))}(s,t.language))&&void 0!==r?r:BK(s,t.physicalFile))&&void 0!==i?i:BK(s,t.file))&&void 0!==n?n:void t.physicalFile;return null==o?void 0:o.parsers[0]},wK={key:e=>/^[$_a-zA-Z][$_a-zA-Z0-9]*$/.test(e)?e:JSON.stringify(e),value(e){if(null===e||"object"!=typeof e)return JSON.stringify(e);if(Array.isArray(e))return"[".concat(e.map((e=>wK.value(e))).join(", "),"]");let t=Object.keys(e);return 0===t.length?"{}":"{ ".concat(t.map((t=>"".concat(wK.key(t),": ").concat(wK.value(e[t])))).join(", ")," }")},pair:e=>{let{key:t,value:n}=e;return wK.value({[t]:n})}},GK=jL($L(),1),EK=jL($L(),1),xK=Symbol.for("vnopts.VALUE_NOT_EXIST"),SK=Symbol.for("vnopts.VALUE_UNCHANGED"),RK=" ".repeat(2);function ZK(e,t,n,i){return["Invalid ".concat(EK.default.red(i.key(e))," value."),"Expected ".concat(EK.default.blue(n),","),"but received ".concat(t===xK?EK.default.gray("nothing"):EK.default.red(i.value(t)),".")].join(" ")}function DK(e,t){let{text:n,list:i}=e,r=[];return n&&r.push("- ".concat(EK.default.blue(n))),i&&r.push(["- ".concat(EK.default.blue(i.title),":")].concat(i.values.map((e=>DK(e,t-RK.length).replace(/^|\n/g,"$&".concat(RK))))).join("\n")),FK(r,t)}function FK(e,t){if(1===e.length)return e[0];let[n,i]=e,[r,s]=e.map((e=>e.split("\n",1)[0].length));return r>t&&r>s?i:n}var NK=jL($L(),1),MK=[],WK=[];var kK=(e,t,n)=>{let{descriptor:i,logger:r,schemas:s}=n,o=["Ignored unknown option ".concat(NK.default.yellow(i.pair({key:e,value:t})),".")],a=Object.keys(s).sort().find((t=>function(e,t){if(e===t)return 0;let n=e;e.length>t.length&&(e=t,t=n);let i=e.length,r=t.length;for(;i>0&&e.charCodeAt(~-i)===t.charCodeAt(~-r);)i--,r--;let s=0;for(;s<i&&e.charCodeAt(s)===t.charCodeAt(s);)s++;if(i-=s,r-=s,0===i)return r;let o,a,l,c,g=0,u=0;for(;g<i;)WK[g]=e.charCodeAt(s+g),MK[g]=++g;for(;u<r;)for(o=t.charCodeAt(s+u),l=u++,a=u,g=0;g<i;g++)c=o===WK[g]?l:l+1,l=MK[g],a=MK[g]=l>a?c>a?a+1:c:c>l?l+1:c;return a}(e,t)<3));a&&o.push("Did you mean ".concat(NK.default.blue(i.key(a)),"?")),r.warn(o.join(" "))},TK=["default","expected","validate","deprecated","forward","redirect","overlap","preprocess","postprocess"];var VK=class{static create(e){return function(e,t){let n=new e(t),i=Object.create(n);for(let r of TK)r in t&&(i[r]=LK(t[r],n,VK.prototype[r].length));return i}(this,e)}constructor(e){this.name=e.name}default(e){}expected(e){return"nothing"}validate(e,t){return!1}deprecated(e,t){return!1}forward(e,t){}redirect(e,t){}overlap(e,t,n){return e}preprocess(e,t){return e}postprocess(e,t){return SK}};function LK(e,t,n){return"function"==typeof e?function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return e(...r.slice(0,n-1),t,...r.slice(n-1))}:()=>e}var HK=class extends VK{constructor(e){super(e),this._sourceName=e.sourceName}expected(e){return e.schemas[this._sourceName].expected(e)}validate(e,t){return t.schemas[this._sourceName].validate(e,t)}redirect(e,t){return this._sourceName}},QK=class extends VK{expected(){return"anything"}validate(){return!0}},KK=class extends VK{constructor(e){let{valueSchema:t,name:n=t.name,...i}=e;super({...i,name:n}),this._valueSchema=t}expected(e){let{text:t,list:n}=e.normalizeExpectedResult(this._valueSchema.expected(e));return{text:t&&"an array of ".concat(t),list:n&&{title:"an array of the following values",values:[{list:n}]}}}validate(e,t){if(!Array.isArray(e))return!1;let n=[];for(let i of e){let e=t.normalizeValidateResult(this._valueSchema.validate(i,t),i);!0!==e&&n.push(e.value)}return 0===n.length||{value:n}}deprecated(e,t){let n=[];for(let i of e){let e=t.normalizeDeprecatedResult(this._valueSchema.deprecated(i,t),i);!1!==e&&n.push(...e.map((e=>{let{value:t}=e;return{value:[t]}})))}return n}forward(e,t){let n=[];for(let i of e){let e=t.normalizeForwardResult(this._valueSchema.forward(i,t),i);n.push(...e.map(XK))}return n}redirect(e,t){let n=[],i=[];for(let r of e){let e=t.normalizeRedirectResult(this._valueSchema.redirect(r,t),r);"remain"in e&&n.push(e.remain),i.push(...e.redirect.map(XK))}return 0===n.length?{redirect:i}:{redirect:i,remain:n}}overlap(e,t){return e.concat(t)}};function XK(e){let{from:t,to:n}=e;return{from:[t],to:n}}var YK=class extends VK{expected(){return"true or false"}validate(e){return"boolean"==typeof e}};function zK(e,t){let n=Object.create(null);for(let i of e){let e=i[t];if(n[e])throw new Error("Duplicate ".concat(t," ").concat(JSON.stringify(e)));n[e]=i}return n}function PK(e,t){if(e===t)return 0;let n=typeof e,i=typeof t,r=["undefined","object","boolean","number","string"];return n!==i?r.indexOf(n)-r.indexOf(i):"string"!==n?Number(e)-Number(t):e.localeCompare(t)}function UK(e){return void 0===e?{}:e}function _K(e){if("string"==typeof e)return{text:e};let{text:t,list:n}=e;return function(e,t){if(!e)throw new Error(t)}(void 0!==(t||n),"Unexpected `expected` result, there should be at least one field."),n?{text:t,list:{title:n.title,values:n.values.map(_K)}}:{text:t}}function OK(e,t){return!0===e||(!1===e?{value:t}:e)}function JK(e,t){return!1!==e&&(!0===e?!!(arguments.length>2&&void 0!==arguments[2]&&arguments[2])||[{value:t}]:"value"in e?[e]:0!==e.length&&e)}function jK(e,t){return"string"==typeof e||"key"in e?{from:t,to:e}:"from"in e?{from:e.from,to:e.to}:{from:t,to:e.to}}function qK(e,t){return void 0===e?[]:Array.isArray(e)?e.map((e=>jK(e,t))):[jK(e,t)]}function $K(e,t){let n=qK("object"==typeof e&&"redirect"in e?e.redirect:e,t);return 0===n.length?{remain:t,redirect:n}:"object"==typeof e&&"remain"in e?{remain:e.remain,redirect:n}:{redirect:n}}var eX,tX=class extends VK{constructor(e){super(e),this._choices=function(e,t){let n=new Map;for(let i of e){let e=i[t];if(n.has(e))throw new Error("Duplicate ".concat(t," ").concat(JSON.stringify(e)));n.set(e,i)}return n}(e.choices.map((e=>e&&"object"==typeof e?e:{value:e})),"value")}expected(e){let{descriptor:t}=e,n=Array.from(this._choices.keys()).map((e=>this._choices.get(e))).filter((e=>{let{hidden:t}=e;return!t})).map((e=>e.value)).sort(PK).map(t.value),i=n.slice(0,-2),r=n.slice(-2);return{text:i.concat(r.join(" or ")).join(", "),list:{title:"one of the following values",values:n}}}validate(e){return this._choices.has(e)}deprecated(e){let t=this._choices.get(e);return!(!t||!t.deprecated)&&{value:e}}forward(e){let t=this._choices.get(e);return t?t.forward:void 0}redirect(e){let t=this._choices.get(e);return t?t.redirect:void 0}},nX=class extends VK{expected(){return"a number"}validate(e,t){return"number"==typeof e}},iX=class extends nX{expected(){return"an integer"}validate(e,t){return!0===t.normalizeValidateResult(super.validate(e,t),e)&&function(e){return e===Math.floor(e)}(e)}},rX=class extends VK{expected(){return"a string"}validate(e){return"string"==typeof e}},sX=wK,oX=kK,aX=(e,t,n)=>{let{text:i,list:r}=n.normalizeExpectedResult(n.schemas[e].expected(n)),s=[];return i&&s.push(ZK(e,t,i,n.descriptor)),r&&s.push([ZK(e,t,r.title,n.descriptor)].concat(r.values.map((e=>DK(e,n.loggerPrintWidth)))).join("\n")),FK(s,n.loggerPrintWidth)},lX=(e,t,n)=>{let{descriptor:i}=n,r=["".concat(GK.default.yellow("string"==typeof e?i.key(e):i.pair(e))," is deprecated")];return t&&r.push("we now treat it as ".concat(GK.default.blue("string"==typeof t?i.key(t):i.pair(t)))),r.join("; ")+"."},cX=class{constructor(e,t){let{logger:n=console,loggerPrintWidth:i=80,descriptor:r=sX,unknown:s=oX,invalid:o=aX,deprecated:a=lX,missing:l=()=>!1,required:c=()=>!1,preprocess:g=e=>e,postprocess:u=()=>SK}=t||{};this._utils={descriptor:r,logger:n||{warn:()=>{}},loggerPrintWidth:i,schemas:zK(e,"name"),normalizeDefaultResult:UK,normalizeExpectedResult:_K,normalizeDeprecatedResult:JK,normalizeForwardResult:qK,normalizeRedirectResult:$K,normalizeValidateResult:OK},this._unknownHandler=s,this._invalidHandler=function(e){return function(){let t=e(...arguments);return"string"==typeof t?new Error(t):t}}(o),this._deprecatedHandler=a,this._identifyMissing=(e,t)=>!(e in t)||l(e,t),this._identifyRequired=c,this._preprocess=g,this._postprocess=u,this.cleanHistory()}cleanHistory(){this._hasDeprecationWarned=function(){let e=Object.create(null);return t=>{let n=JSON.stringify(t);return!!e[n]||(e[n]=!0,!1)}}()}normalize(e){let t={},n=[this._preprocess(e,this._utils)],i=()=>{for(;0!==n.length;){let e=n.shift(),i=this._applyNormalization(e,t);n.push(...i)}};i();for(let r of Object.keys(this._utils.schemas)){let e=this._utils.schemas[r];if(!(r in t)){let t=UK(e.default(this._utils));"value"in t&&n.push({[r]:t.value})}}i();for(let r of Object.keys(this._utils.schemas)){if(!(r in t))continue;let e=this._utils.schemas[r],n=t[r],i=e.postprocess(n,this._utils);i!==SK&&(this._applyValidation(i,r,e),t[r]=i)}return this._applyPostprocess(t),this._applyRequiredCheck(t),t}_applyNormalization(e,t){let n=[],{knownKeys:i,unknownKeys:r}=this._partitionOptionKeys(e);for(let s of i){let i=this._utils.schemas[s],r=i.preprocess(e[s],this._utils);this._applyValidation(r,s,i);let o=e=>{let{from:t,to:i}=e;n.push("string"==typeof i?{[i]:t}:{[i.key]:i.value})},a=e=>{let{value:t,redirectTo:n}=e,o=JK(i.deprecated(t,this._utils),r,!0);if(!1!==o)if(!0===o)this._hasDeprecationWarned(s)||this._utils.logger.warn(this._deprecatedHandler(s,n,this._utils));else for(let{value:i}of o){let e={key:s,value:i};if(!this._hasDeprecationWarned(e)){let t="string"==typeof n?{key:n,value:i}:n;this._utils.logger.warn(this._deprecatedHandler(e,t,this._utils))}}};qK(i.forward(r,this._utils),r).forEach(o);let l=$K(i.redirect(r,this._utils),r);if(l.redirect.forEach(o),"remain"in l){let e=l.remain;t[s]=s in t?i.overlap(t[s],e,this._utils):e,a({value:e})}for(let{from:e,to:t}of l.redirect)a({value:e,redirectTo:t})}for(let s of r){let i=e[s];this._applyUnknownHandler(s,i,t,((e,t)=>{n.push({[e]:t})}))}return n}_applyRequiredCheck(e){for(let t of Object.keys(this._utils.schemas))if(this._identifyMissing(t,e)&&this._identifyRequired(t))throw this._invalidHandler(t,xK,this._utils)}_partitionOptionKeys(e){let[t,n]=function(e,t){let n=[],i=[];for(let r of e)t(r)?n.push(r):i.push(r);return[n,i]}(Object.keys(e).filter((t=>!this._identifyMissing(t,e))),(e=>e in this._utils.schemas));return{knownKeys:t,unknownKeys:n}}_applyValidation(e,t,n){let i=OK(n.validate(e,this._utils),e);if(!0!==i)throw this._invalidHandler(t,i.value,this._utils)}_applyUnknownHandler(e,t,n,i){let r=this._unknownHandler(e,t,this._utils);if(r)for(let s of Object.keys(r)){if(this._identifyMissing(s,r))continue;let e=r[s];s in this._utils.schemas?i(s,e):n[s]=e}}_applyPostprocess(e){let t=this._postprocess(e,this._utils);if(t!==SK){if(t.delete)for(let n of t.delete)delete e[n];if(t.override){let{knownKeys:n,unknownKeys:i}=this._partitionOptionKeys(t.override);for(let r of n){let n=t.override[r];this._applyValidation(n,r,this._utils.schemas[r]),e[r]=n}for(let r of i){let n=t.override[r];this._applyUnknownHandler(r,n,e,((t,n)=>{let i=this._utils.schemas[t];this._applyValidation(n,t,i),e[t]=n}))}}}}};function gX(e,t){let n,{isCLI:i,optionInfos:r,FlagSchema:s}=t,{name:o}=e,a={name:o},l={};switch(e.type){case"int":n=iX,i&&(a.preprocess=Number);break;case"string":case"path":n=rX;break;case"choice":n=tX,a.choices=e.choices.map((t=>null!=t&&t.redirect?{...t,redirect:{to:{key:e.name,value:t.redirect}}}:t));break;case"boolean":n=YK;break;case"flag":n=s,a.flags=r.flatMap((e=>[e.alias,e.description&&e.name,e.oppositeDescription&&"no-".concat(e.name)].filter(Boolean)));break;default:throw new Error("Unexpected type ".concat(e.type))}if(e.exception?a.validate=(t,n,i)=>e.exception(t)||n.validate(t,i):a.validate=(e,t,n)=>void 0===e||t.validate(e,n),e.redirect&&(l.redirect=t=>t?{to:"string"==typeof e.redirect?e.redirect:{key:e.redirect.option,value:e.redirect.value}}:void 0),e.deprecated&&(l.deprecated=!0),i&&!e.array){let e=a.preprocess||(e=>e);a.preprocess=(t,n,i)=>n.preprocess(e(Array.isArray(t)?gQ(!1,t,-1):t),i)}return e.array?KK.create({...i?{preprocess:e=>Array.isArray(e)?e:[e]}:{},...l,valueSchema:n.create(a)}):n.create({...a,...l})}var uX=function(e,t){let{logger:n=!1,isCLI:i=!1,passThrough:r=!1,FlagSchema:s,descriptor:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(i){if(!s)throw new Error("'FlagSchema' option is required.");if(!o)throw new Error("'descriptor' option is required.")}else o=wK;let a=r?Array.isArray(r)?(e,t)=>r.includes(e)?{[e]:t}:void 0:(e,t)=>({[e]:t}):(e,t,n)=>{let{_:i,...r}=n.schemas;return kK(e,t,{...n,schemas:r})},l=function(e,t){let{isCLI:n,FlagSchema:i}=t,r=[];n&&r.push(QK.create({name:"_"}));for(let s of e)r.push(gX(s,{isCLI:n,optionInfos:e,FlagSchema:i})),s.alias&&n&&r.push(HK.create({name:s.alias,sourceName:s.name}));return r}(t,{isCLI:i,FlagSchema:s}),c=new cX(l,{logger:n,unknown:a,descriptor:o}),g=!1!==n;g&&eX&&(c._hasDeprecationWarned=eX);let u=c.normalize(e);return g&&(eX=c._hasDeprecationWarned),u},AX=(e,t,n)=>{if(!e||null!=t){if(t.findLast)return t.findLast(n);for(let e=t.length-1;e>=0;e--){let i=t[e];if(n(i,e,t))return i}}};function dX(e,t){if(!t)throw new Error("parserName is required.");let n=AX(!1,e,(e=>e.parsers&&Object.prototype.hasOwnProperty.call(e.parsers,t)));if(n)return n;let i="Couldn't resolve parser \"".concat(t,'".');throw i+=" Plugins must be explicitly added to the standalone bundle.",new pK(i)}function hX(e){let{plugins:t,parser:n}=e;return IX(dX(t,n),n)}function IX(e,t){let n=e.parsers[t];return"function"==typeof n?n():n}var pX={astFormat:"estree",printer:{},originalText:void 0,locStart:null,locEnd:null};var CX=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;let i={...e};if(!i.parser){if(!i.filepath)throw new CK("No parser and no file path given, couldn't infer a parser.");if(i.parser=vK(i,{physicalFile:i.filepath}),!i.parser)throw new CK('No parser could be inferred for file "'.concat(i.filepath,'".'))}let r=fK({plugins:e.plugins,showDeprecated:!0}).options,s={...pX,...Object.fromEntries(r.filter((e=>void 0!==e.default)).map((e=>[e.name,e.default])))},o=dX(i.plugins,i.parser),a=await IX(o,i.parser);i.astFormat=a.astFormat,i.locEnd=a.locEnd,i.locStart=a.locStart;let l=null!=(n=o.printers)&&n[a.astFormat]?o:function(e,t){if(!t)throw new Error("astFormat is required.");let n=AX(!1,e,(e=>e.printers&&Object.prototype.hasOwnProperty.call(e.printers,t)));if(n)return n;let i="Couldn't find plugin for AST format \"".concat(t,'".');throw i+=" Plugins must be explicitly added to the standalone bundle.",new pK(i)}(i.plugins,a.astFormat),c=await function(e,t){let n=e.printers[t];return"function"==typeof n?n():n}(l,a.astFormat);i.printer=c;let g=l.defaultOptions?Object.fromEntries(Object.entries(l.defaultOptions).filter((e=>{let[,t]=e;return void 0!==t}))):{},u={...s,...g};for(let[A,d]of Object.entries(u))(null===i[A]||void 0===i[A])&&(i[A]=d);return"json"===i.parser&&(i.trailingComma="none"),uX(i,r,{passThrough:Object.keys(pX),...t})},mX=jL(sH(),1);var fX=async function(e,t){let n,i=await hX(t),r=i.preprocess?i.preprocess(e,t):e;t.originalText=r;try{n=await i.parse(r,t,t)}catch(Nx){!function(e,t){let{loc:n}=e;if(n){let i=(0,mX.codeFrameColumns)(t,n,{highlightCode:!0});throw e.message+="\n"+i,e.codeFrame=i,e}throw e}(Nx,e)}return{text:r,ast:n}};async function yX(e,t,n,i,r){var s;let{embeddedLanguageFormatting:o,printer:{embed:a,hasPrettierIgnore:l=()=>!1,getVisitorKeys:c}}=n;if(!a||"auto"!==o)return;if(a.length>2)throw new Error("printer.embed has too many parameters. The API changed in Prettier v3. Please update your plugin. See https://prettier.io/docs/en/plugins.html#optional-embed");let g=qQ(null!==(s=a.getVisitorKeys)&&void 0!==s?s:c),u=[];!function t(){let{node:i}=e;if(null===i||"object"!=typeof i||l(e))return;for(let n of g(i))Array.isArray(i[n])?e.each(t,n):e.call(t,n);let s=a(e,n);if(s){if("function"==typeof s)return void u.push({print:s,node:i,pathStack:[...e.stack]});r.set(i,s)}}();let A=e.stack;for(let{print:h,node:I,pathStack:p}of u)try{e.stack=p;let i=await h(d,t,e,n);i&&r.set(I,i)}catch(Yx){if(globalThis.PRETTIER_DEBUG)throw Yx}function d(e,t){return async function(e,t,n,i){let r=await CX({...n,...t,parentParser:n.parser,originalText:e},{passThrough:!0}),{ast:s}=await fX(e,r),o=await i(s,r);return bQ(o)}(e,t,n,i)}e.stack=A}var bX=function(e,t){let{originalText:n,[Symbol.for("comments")]:i,locStart:r,locEnd:s,[Symbol.for("printedComments")]:o}=t,{node:a}=e,l=r(a),c=s(a);for(let g of i)r(g)>=l&&s(g)<=c&&o.add(g);return n.slice(l,c)};async function BX(e,t){({ast:e}=await wX(e,t));let n=new Map,i=new TQ(e),r=IK(t),s=new Map;await yX(i,a,t,BX,s);let o=await vX(i,t,a,void 0,s);return function(e){let{[Symbol.for("comments")]:t,[Symbol.for("printedComments")]:n}=e;for(let i of t){if(!i.printed&&!n.has(i))throw new Error('Comment "'+i.value.trim()+'" was not printed. Please report this error!');delete i.printed}}(t),o;function a(e,t){return void 0===e||e===i?l(t):Array.isArray(e)?i.call((()=>l(t)),...e):i.call((()=>l(t)),e)}function l(e){r(i);let o=i.node;if(null==o)return"";let l=o&&"object"==typeof o&&void 0===e;if(l&&n.has(o))return n.get(o);let c=vX(i,t,a,e,s);return l&&n.set(o,c),c}}function vX(e,t,n,i,r){var s;let o,{node:a}=e,{printer:l}=t;return o=null!=(s=l.hasPrettierIgnore)&&s.call(l,e)?bX(e,t):r.has(a)?r.get(a):l.print(e,t,n,i),a===t.cursorNode&&(o=vQ(o,(e=>[oQ,e,oQ]))),l.printComment&&(!l.willPrintOwnComments||!l.willPrintOwnComments(e,t))&&(o=function(e,t,n){let{leading:i,trailing:r}=hK(e,n);return i||r?vQ(t,(e=>[i,e,r])):t}(e,o,t)),o}async function wX(e,t){var n,i;let r=null!==(n=e.comments)&&void 0!==n?n:[];t[Symbol.for("comments")]=r,t[Symbol.for("tokens")]=null!==(i=e.tokens)&&void 0!==i?i:[],t[Symbol.for("printedComments")]=new Set,function(e,t){let{comments:n}=e;if(delete e.comments,!OQ(n)||!t.printer.canAttachComment)return;let i=[],{locStart:r,locEnd:s,printer:{experimentalFeatures:{avoidAstMutation:o=!1}={},handleComments:a={}},originalText:l}=t,{ownLine:c=oK,endOfLine:g=oK,remaining:u=oK}=a,A=n.map(((i,r)=>({...sK(e,i,t),comment:i,text:l,options:t,ast:e,isLastComment:n.length-1===r})));for(let[d,h]of A.entries()){let e,{comment:t,precedingNode:n,enclosingNode:a,followingNode:l,text:I,options:p,ast:C,isLastComment:m}=h;if("json"===p.parser||"json5"===p.parser||"jsonc"===p.parser||"__js_expression"===p.parser||"__ts_expression"===p.parser||"__vue_expression"===p.parser||"__vue_ts_expression"===p.parser){if(r(t)-r(C)<=0){eK(C,t);continue}if(s(t)-s(C)>=0){nK(C,t);continue}}if(o?e=[h]:(t.enclosingNode=a,t.precedingNode=n,t.followingNode=l,e=[t,I,p,C,m]),lK(I,p,A,d))t.placement="ownLine",c(...e)||(l?eK(l,t):n?nK(n,t):tK(a||C,t));else if(cK(I,p,A,d))t.placement="endOfLine",g(...e)||(n?nK(n,t):l?eK(l,t):tK(a||C,t));else if(t.placement="remaining",!u(...e))if(n&&l){let e=i.length;e>0&&i[e-1].followingNode!==l&&gK(i,p),i.push(h)}else n?nK(n,t):l?eK(l,t):tK(a||C,t)}if(gK(i,t),!o)for(let d of n)delete d.precedingNode,delete d.enclosingNode,delete d.followingNode}(e,t);let{printer:{preprocess:s}}=t;return{ast:e=s?await s(e,t):e,comments:r}}var GX=function(e,t){let{cursorOffset:n,locStart:i,locEnd:r}=t,s=qQ(t.printer.getVisitorKeys),o=e=>i(e)<=n&&r(e)>=n,a=e;for(let l of function*(e,t){let n=[e];for(let i=0;i<n.length;i++){let e=n[i];for(let i of QQ(e,t))yield i,n.push(i)}}(e,{getVisitorKeys:s,filter:o}))a=l;return a};var EX=function(e,t){var n;let{printer:{massageAstNode:i,getVisitorKeys:r}}=t;if(!i)return e;let s=qQ(r),o=null!==(n=i.ignoredProperties)&&void 0!==n?n:new Set;return function e(t,n){if(null===t||"object"!=typeof t)return t;if(Array.isArray(t))return t.map((t=>e(t,n))).filter(Boolean);let r={},a=new Set(s(t));for(let i in t)!Object.prototype.hasOwnProperty.call(t,i)||o.has(i)||(a.has(i)?r[i]=e(t[i],t):r[i]=t[i]);let l=i(t,r,n);if(null!==l)return null!==l&&void 0!==l?l:r}(e)},xX=(e,t,n)=>{if(!e||null!=t){if(t.findLastIndex)return t.findLastIndex(n);for(let e=t.length-1;e>=0;e--){if(n(t[e],e,t))return e}return-1}},SX=e=>{let{parser:t}=e;return"json"===t||"json5"===t||"jsonc"===t||"json-stringify"===t};function RX(e){let t=xX(!1,e,(e=>"Program"!==e.type&&"File"!==e.type));return-1===t?e:e.slice(0,t+1)}function ZX(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],s=arguments.length>5?arguments[5]:void 0,{locStart:o,locEnd:a}=n,l=o(e),c=a(e);if(!(t>c||t<l||"rangeEnd"===s&&t===l||"rangeStart"===s&&t===c)){for(let o of rK(e,n)){let a=ZX(o,t,n,i,[e,...r],s);if(a)return a}if(!i||i(e,r[0]))return{node:e,parentNodes:r}}}var DX=new Set(["JsonRoot","ObjectExpression","ArrayExpression","StringLiteral","NumericLiteral","BooleanLiteral","NullLiteral","UnaryExpression","TemplateLiteral"]),FX=new Set(["OperationDefinition","FragmentDefinition","VariableDefinition","TypeExtensionDefinition","ObjectTypeDefinition","FieldDefinition","DirectiveDefinition","EnumTypeDefinition","EnumValueDefinition","InputValueDefinition","InputObjectTypeDefinition","SchemaDefinition","OperationTypeDefinition","InterfaceTypeDefinition","UnionTypeDefinition","ScalarTypeDefinition"]);function NX(e,t,n){if(!t)return!1;switch(e.parser){case"flow":case"babel":case"babel-flow":case"babel-ts":case"typescript":case"acorn":case"espree":case"meriyah":case"__babel_estree":return function(e,t){return"DeclareExportDeclaration"!==t&&"TypeParameterDeclaration"!==e&&("Directive"===e||"TypeAlias"===e||"TSExportAssignment"===e||e.startsWith("Declare")||e.startsWith("TSDeclare")||e.endsWith("Statement")||e.endsWith("Declaration"))}(t.type,null==n?void 0:n.type);case"json":case"json5":case"jsonc":case"json-stringify":return DX.has(t.type);case"graphql":return FX.has(t.kind);case"vue":return"root"!==t.tag}return!1}function MX(e,t,n){let{rangeStart:i,rangeEnd:r,locStart:s,locEnd:o}=t;LQ.ok(r>i);let a=e.slice(i,r).search(/\S/u),l=-1===a;if(!l)for(i+=a;r>i&&!/\S/u.test(e[r-1]);--r);let c,g,u=ZX(n,i,t,((e,n)=>NX(t,e,n)),[],"rangeStart"),A=l?u:ZX(n,r,t,(e=>NX(t,e)),[],"rangeEnd");if(!u||!A)return{rangeStart:0,rangeEnd:0};if(SX(t)){let e=function(e,t){let n=[e.node,...e.parentNodes],i=new Set([t.node,...t.parentNodes]);return n.find((e=>DX.has(e.type)&&i.has(e)))}(u,A);c=e,g=e}else({startNode:c,endNode:g}=function(e,t,n){let{locStart:i,locEnd:r}=n,s=e.node,o=t.node;if(s===o)return{startNode:s,endNode:o};let a=i(e.node);for(let c of RX(t.parentNodes)){if(!(i(c)>=a))break;o=c}let l=r(t.node);for(let c of RX(e.parentNodes)){if(!(r(c)<=l))break;if(s=c,s===o)break}return{startNode:s,endNode:o}}(u,A,t));return{rangeStart:Math.min(s(c),s(g)),rangeEnd:Math.max(o(c),o(g))}}var WX="\ufeff",kX=Symbol("cursor");async function TX(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e||0===e.trim().length)return{formatted:"",cursorOffset:-1,comments:[]};let{ast:i,text:r}=await fX(e,t);t.cursorOffset>=0&&(t.cursorNode=GX(i,t));let s=await BX(i,t);n>0&&(s=lQ([rQ,s],n,t.tabWidth));let o=FQ(s,t);if(n>0){let e=o.formatted.trim();void 0!==o.cursorNodeStart&&(o.cursorNodeStart-=o.formatted.indexOf(e)),o.formatted=e+fH(t.endOfLine)}let a=t[Symbol.for("comments")];if(t.cursorOffset>=0){let e,n,i,s,l;if(t.cursorNode&&o.cursorNodeText?(e=t.locStart(t.cursorNode),n=r.slice(e,t.locEnd(t.cursorNode)),i=t.cursorOffset-e,s=o.cursorNodeStart,l=o.cursorNodeText):(e=0,n=r,i=t.cursorOffset,s=0,l=o.formatted),n===l)return{formatted:o.formatted,cursorOffset:s+i,comments:a};let c=n.split("");c.splice(i,0,kX);let g=function(e,t,n){return mH.diff(e,t,n)}(c,l.split("")),u=s;for(let t of g)if(t.removed){if(t.value.includes(kX))break}else u+=t.count;return{formatted:o.formatted,cursorOffset:u,comments:a}}return{formatted:o.formatted,cursorOffset:-1,comments:a}}function VX(e,t,n){return"number"!=typeof t||Number.isNaN(t)||t<0||t>e.length?n:t}function LX(e,t){let{cursorOffset:n,rangeStart:i,rangeEnd:r}=t;return n=VX(e,n,-1),i=VX(e,i,0),r=VX(e,r,e.length),{...t,cursorOffset:n,rangeStart:i,rangeEnd:r}}function HX(e,t){let{cursorOffset:n,rangeStart:i,rangeEnd:r,endOfLine:s}=LX(e,t),o=e.charAt(0)===WX;if(o&&(e=e.slice(1),n--,i--,r--),"auto"===s&&(s=function(e){let t=e.indexOf("\r");return t>=0?"\n"===e.charAt(t+1)?"crlf":"cr":"lf"}(e)),e.includes("\r")){let t=t=>yH(e.slice(0,Math.max(t,0)),"\r\n");n-=t(n),i-=t(i),r-=t(r),e=function(e){return aH(!1,e,/\r\n?/gu,"\n")}(e)}return{hasBOM:o,text:e,options:LX(e,{...t,cursorOffset:n,rangeStart:i,rangeEnd:r,endOfLine:s})}}async function QX(e,t){let n=await hX(t);return!n.hasPragma||n.hasPragma(e)}async function KX(e,t){let n,{hasBOM:i,text:r,options:s}=HX(e,await CX(t));return s.rangeStart>=s.rangeEnd&&""!==r||s.requirePragma&&!await QX(r,s)?{formatted:e,cursorOffset:t.cursorOffset,comments:[]}:(s.rangeStart>0||s.rangeEnd<r.length?n=await async function(e,t){let{ast:n,text:i}=await fX(e,t),{rangeStart:r,rangeEnd:s}=MX(i,t,n),o=i.slice(r,s),a=Math.min(r,i.lastIndexOf("\n",r)+1),l=i.slice(a,r).match(/^\s*/u)[0],c=kQ(l,t.tabWidth),g=await TX(o,{...t,rangeStart:0,rangeEnd:Number.POSITIVE_INFINITY,cursorOffset:t.cursorOffset>r&&t.cursorOffset<=s?t.cursorOffset-r:-1,endOfLine:"lf"},c),u=g.formatted.trimEnd(),{cursorOffset:A}=t;A>s?A+=u.length-o.length:g.cursorOffset>=0&&(A=g.cursorOffset+r);let d=i.slice(0,r)+u+i.slice(s);if("lf"!==t.endOfLine){let e=fH(t.endOfLine);A>=0&&"\r\n"===e&&(A+=yH(d.slice(0,A),"\n")),d=aH(!1,d,"\n",e)}return{formatted:d,cursorOffset:A,comments:g.comments}}(r,s):(!s.requirePragma&&s.insertPragma&&s.printer.insertPragma&&!await QX(r,s)&&(r=s.printer.insertPragma(r)),n=await TX(r,s)),i&&(n.formatted=WX+n.formatted,n.cursorOffset>=0&&n.cursorOffset++),n)}var XX={};OL(XX,{builders:()=>YX,printer:()=>zX,utils:()=>PX});var YX={join:aQ,line:nQ,softline:iQ,hardline:rQ,literalline:sQ,group:_H,conditionalGroup:function(e,t){return _H(e[0],{...t,expandedStates:e})},fill:OH,lineSuffix:JH,lineSuffixBoundary:jH,cursor:oQ,breakParent:qH,ifBreak:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return YH(e),""!==t&&YH(t),{type:RH,breakContents:e,flatContents:t,groupId:n.groupId}},trim:$H,indent:PH,indentIfBreak:function(e,t){return YH(e),{type:ZH,contents:e,groupId:t.groupId,negate:t.negate}},align:UH,addAlignmentToDoc:lQ,markAsRoot:function(e){return UH({type:"root"},e)},dedentToRoot:function(e){return UH(Number.NEGATIVE_INFINITY,e)},dedent:function(e){return UH(-1,e)},hardlineWithoutBreakParent:eQ,literallineWithoutBreakParent:tQ,label:function(e,t){return YH(t),e?{type:MH,label:e,contents:t}:t},concat:e=>e},zX={printDocToString:FQ},PX={willBreak:function(e){return IQ(e,pQ,!1)},traverseDoc:KH,findInDoc:IQ,mapDoc:hQ,removeLines:function(e){return hQ(e,mQ)},stripTrailingHardline:bQ,replaceEndOfLine:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sQ;return hQ(e,(e=>"string"==typeof e?aQ(t,e.split("\n")):e))},canBreak:function(e){return IQ(e,BQ,!1)}},UX="3.3.3",_X={};OL(_X,{addDanglingComment:()=>tK,addLeadingComment:()=>eK,addTrailingComment:()=>nK,getAlignmentSize:()=>kQ,getIndentSize:()=>$X,getMaxContinuousCount:()=>eY,getNextNonSpaceNonCommentCharacter:()=>tY,getNextNonSpaceNonCommentCharacterIndex:()=>sY,getStringWidth:()=>dQ,hasNewline:()=>_Q,hasNewlineInRange:()=>nY,hasSpaces:()=>iY,isNextLineEmpty:()=>aY,isNextLineEmptyAfterIndex:()=>qX,isPreviousLineEmpty:()=>oY,makeString:()=>rY,skip:()=>KQ,skipEverythingButNewLine:()=>PQ,skipInlineComment:()=>OX,skipNewline:()=>UQ,skipSpaces:()=>YQ,skipToLineEnd:()=>zQ,skipTrailingComment:()=>JX,skipWhitespace:()=>XQ});var OX=function(e,t){if(!1===t)return!1;if("/"===e.charAt(t)&&"*"===e.charAt(t+1))for(let n=t+2;n<e.length;++n)if("*"===e.charAt(n)&&"/"===e.charAt(n+1))return n+2;return t};var JX=function(e,t){return!1!==t&&("/"===e.charAt(t)&&"/"===e.charAt(t+1)?PQ(e,t):t)};var jX=function(e,t){let n=null,i=t;for(;i!==n;)n=i,i=YQ(e,i),i=OX(e,i),i=JX(e,i),i=UQ(e,i);return i};var qX=function(e,t){let n=null,i=t;for(;i!==n;)n=i,i=zQ(e,i),i=OX(e,i),i=YQ(e,i);return i=JX(e,i),i=UQ(e,i),!1!==i&&_Q(e,i)};var $X=function(e,t){let n=e.lastIndexOf("\n");return-1===n?0:kQ(e.slice(n+1).match(/^[\t ]*/u)[0],t)};var eY=function(e,t){let n=e.match(new RegExp("(".concat(function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}(t),")+"),"gu"));return null===n?0:n.reduce(((e,n)=>Math.max(e,n.length/t.length)),0)};var tY=function(e,t){let n=jX(e,t);return!1===n?"":e.charAt(n)};var nY=function(e,t,n){for(let i=t;i<n;++i)if("\n"===e.charAt(i))return!0;return!1};var iY=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return YQ(e,n.backwards?t-1:t,n)!==t};var rY=function(e,t,n){let i='"'===t?"'":'"',r=aH(!1,e,/\\(.)|(["'])/gsu,((e,r,s)=>r===i?r:s===t?"\\"+s:s||(n&&/^[^\n\r"'0-7\\bfnrt-vx\u2028\u2029]$/u.test(r)?r:"\\"+r)));return t+r+t};function sY(e,t){return 2===arguments.length||"number"==typeof t?jX(e,t):function(e,t,n){return jX(e,n(t))}(...arguments)}function oY(e,t){return 2===arguments.length||"number"==typeof t?AK(e,t):function(e,t,n){return AK(e,n(t))}(...arguments)}function aY(e,t){return 2===arguments.length||"number"==typeof t?qX(e,t):function(e,t,n){return qX(e,n(t))}(...arguments)}function lY(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return async function(){for(var n,i,r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];let a=null!==(n=s[t])&&void 0!==n?n:{},l=null!==(i=a.plugins)&&void 0!==i?i:[];return s[t]={...a,plugins:Array.isArray(l)?l:Object.values(l)},e(...s)}}var cY=lY(KX);async function gY(e,t){let{formatted:n}=await cY(e,{...t,cursorOffset:-1});return n}async function uY(e,t){return await gY(e,t)===e}var AY=lY(fK,0),dY={parse:lY((async function(e,t,n){let{text:i,options:r}=HX(e,await CX(t)),s=await fX(i,r);return n&&(n.preprocessForPrint&&(s.ast=await wX(s.ast,r)),n.massage&&(s.ast=EX(s.ast,r))),s})),formatAST:lY((async function(e,t){return t=await CX(t),FQ(await BX(e,t),t)})),formatDoc:lY((async function(e,t){let n=function(e){let t=Object.create(null),n=new Set;return function e(t,n,r){var s,o;if("string"==typeof t)return JSON.stringify(t);if(Array.isArray(t)){let n=t.map(e).filter(Boolean);return 1===n.length?n[0]:"[".concat(n.join(", "),"]")}if(t.type===NH){let e=(null==(s=null==r?void 0:r[n+1])?void 0:s.type)===WH;return t.literal?e?"literalline":"literallineWithoutBreakParent":t.hard?e?"hardline":"hardlineWithoutBreakParent":t.soft?"softline":"line"}if(t.type===WH)return(null==(o=null==r?void 0:r[n-1])?void 0:o.type)===NH&&r[n-1].hard?void 0:"breakParent";if(t.type===EH)return"trim";if(t.type===wH)return"indent("+e(t.contents)+")";if(t.type===GH)return t.n===Number.NEGATIVE_INFINITY?"dedentToRoot("+e(t.contents)+")":t.n<0?"dedent("+e(t.contents)+")":"root"===t.n.type?"markAsRoot("+e(t.contents)+")":"align("+JSON.stringify(t.n)+", "+e(t.contents)+")";if(t.type===RH)return"ifBreak("+e(t.breakContents)+(t.flatContents?", "+e(t.flatContents):"")+(t.groupId?(t.flatContents?"":', ""')+", { groupId: ".concat(i(t.groupId)," }"):"")+")";if(t.type===ZH){let n=[];t.negate&&n.push("negate: true"),t.groupId&&n.push("groupId: ".concat(i(t.groupId)));let r=n.length>0?", { ".concat(n.join(", ")," }"):"";return"indentIfBreak(".concat(e(t.contents)).concat(r,")")}if(t.type===xH){let n=[];t.break&&"propagated"!==t.break&&n.push("shouldBreak: true"),t.id&&n.push("id: ".concat(i(t.id)));let r=n.length>0?", { ".concat(n.join(", ")," }"):"";return t.expandedStates?"conditionalGroup([".concat(t.expandedStates.map((t=>e(t))).join(","),"]").concat(r,")"):"group(".concat(e(t.contents)).concat(r,")")}if(t.type===SH)return"fill([".concat(t.parts.map((t=>e(t))).join(", "),"])");if(t.type===DH)return"lineSuffix("+e(t.contents)+")";if(t.type===FH)return"lineSuffixBoundary";if(t.type===MH)return"label(".concat(JSON.stringify(t.label),", ").concat(e(t.contents),")");throw new Error("Unknown doc type "+t.type)}(cQ(e));function i(e){if("symbol"!=typeof e)return JSON.stringify(String(e));if(e in t)return t[e];let i=e.description||"symbol";for(let r=0;;r++){let s=i+(r>0?" #".concat(r):"");if(!n.has(s))return n.add(s),t[e]="Symbol.for(".concat(JSON.stringify(s),")")}}}(e),{formatted:i}=await KX(n,{...t,parser:"__js_expression"});return i})),printToDoc:lY((async function(e,t){t=await CX(t);let{ast:n}=await fX(e,t);return BX(n,t)})),printDocToString:lY((async function(e,t){return FQ(e,await CX(t))}))};n(840),n(194);const hY=t.memo((e=>{let{}=e;const t=Ix((e=>e.showVideoPoints)),n=Ix((e=>e.showTextTessellation)),i=Ix((e=>e.showRollercoaster));return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("ambientLight",{}),(0,I.jsx)(yx,{}),t&&(0,I.jsx)(ex,{}),n&&(0,I.jsx)(cx,{text:"Sepinaco",position:[0,0,0]}),i&&(0,I.jsx)(hx,{})]})})),IY=t.memo((e=>{let{}=e;return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(hY,{})})}));function pY(){const[e,n]=(0,t.useState)();return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(CY,{ref:n})})}const CY=(0,t.forwardRef)(((e,n)=>{const i=KI();return(0,t.useEffect)((()=>{null===i||void 0===i||i.play()}),[i]),i?(0,I.jsxs)("mesh",{ref:n,position:[0,0,-10],...e,children:[(0,I.jsx)("planeGeometry",{args:[16,10]}),(0,I.jsx)("meshBasicMaterial",{children:(0,I.jsx)("videoTexture",{attach:"map",args:[i],colorSpace:Xn})}),(0,I.jsxs)("mesh",{scale:[16.05,10.05,1],position:[0,0,-.01],children:[(0,I.jsx)("planeGeometry",{}),(0,I.jsx)("meshBasicMaterial",{color:"black"})]})]}):null}));function mY(){return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("color",{attach:"background",args:["#050505"]}),(0,I.jsx)("ambientLight",{}),(0,I.jsx)(pY,{}),(0,I.jsx)(yx,{})]})}function fY(e,n){const i=e+"Geometry";return t.forwardRef(((e,r)=>{let{args:s,children:o,...a}=e;const l=t.useRef(null);return t.useImperativeHandle(r,(()=>l.current)),t.useLayoutEffect((()=>{null==n||n(l.current)})),t.createElement("mesh",Db({ref:l},a),t.createElement(i,{attach:"geometry",args:s}),o)}))}const yY=fY("box");function bY(){const e=h((e=>e.xrmode)),n=Z((e=>e.sceneId));return(0,I.jsx)(t.Suspense,{fallback:(0,I.jsx)(yY,{"material-color":"red","material-wireframe":"true"}),children:(()=>{switch(n){case 0:return e?(0,I.jsx)(IY,{}):(0,I.jsx)(hY,{});case 1:return(0,I.jsx)(mY,{});default:return console.error("No se ha definido la Scene elegida, Scene: "+n),null}})()})}var BY=n(695),vY=n.n(BY);function wY(e){let{debounce:n,scroll:i,polyfill:r,offsetSize:s}=void 0===e?{debounce:0,scroll:!1,offsetSize:!1}:e;const o=r||("undefined"===typeof window?class{}:window.ResizeObserver);if(!o)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[a,l]=(0,t.useState)({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),c=(0,t.useRef)({element:null,scrollContainers:null,resizeObserver:null,lastBounds:a}),g=n?"number"===typeof n?n:n.scroll:null,u=n?"number"===typeof n?n:n.resize:null,A=(0,t.useRef)(!1);(0,t.useEffect)((()=>(A.current=!0,()=>{A.current=!1})));const[d,h,I]=(0,t.useMemo)((()=>{const e=()=>{if(!c.current.element)return;const{left:e,top:t,width:n,height:i,bottom:r,right:o,x:a,y:g}=c.current.element.getBoundingClientRect(),u={left:e,top:t,width:n,height:i,bottom:r,right:o,x:a,y:g};c.current.element instanceof HTMLElement&&s&&(u.height=c.current.element.offsetHeight,u.width=c.current.element.offsetWidth),Object.freeze(u),A.current&&!xY(c.current.lastBounds,u)&&l(c.current.lastBounds=u)};return[e,u?vY()(e,u):e,g?vY()(e,g):e]}),[l,s,g,u]);function p(){c.current.scrollContainers&&(c.current.scrollContainers.forEach((e=>e.removeEventListener("scroll",I,!0))),c.current.scrollContainers=null),c.current.resizeObserver&&(c.current.resizeObserver.disconnect(),c.current.resizeObserver=null)}function C(){c.current.element&&(c.current.resizeObserver=new o(I),c.current.resizeObserver.observe(c.current.element),i&&c.current.scrollContainers&&c.current.scrollContainers.forEach((e=>e.addEventListener("scroll",I,{capture:!0,passive:!0}))))}var m,f,y;return m=I,f=Boolean(i),(0,t.useEffect)((()=>{if(f){const e=m;return window.addEventListener("scroll",e,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",e,!0)}}}),[m,f]),y=h,(0,t.useEffect)((()=>{const e=y;return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[y]),(0,t.useEffect)((()=>{p(),C()}),[i,I,h]),(0,t.useEffect)((()=>p),[]),[e=>{e&&e!==c.current.element&&(p(),c.current.element=e,c.current.scrollContainers=GY(e),C())},a,d]}function GY(e){const t=[];if(!e||e===document.body)return t;const{overflow:n,overflowX:i,overflowY:r}=window.getComputedStyle(e);return[n,i,r].some((e=>"auto"===e||"scroll"===e))&&t.push(e),[...t,...GY(e.parentElement)]}const EY=["x","y","top","bottom","left","right","width","height"],xY=(e,t)=>EY.every((n=>e[n]===t[n]));var SY,RY,ZY=Object.defineProperty,DY=Object.defineProperties,FY=Object.getOwnPropertyDescriptors,NY=Object.getOwnPropertySymbols,MY=Object.prototype.hasOwnProperty,WY=Object.prototype.propertyIsEnumerable,kY=(e,t,n)=>t in e?ZY(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,TY=(e,t)=>{for(var n in t||(t={}))MY.call(t,n)&&kY(e,n,t[n]);if(NY)for(var n of NY(t))WY.call(t,n)&&kY(e,n,t[n]);return e};"undefined"===typeof window||!(null==(SY=window.document)?void 0:SY.createElement)&&"ReactNative"!==(null==(RY=window.navigator)?void 0:RY.product)?t.useEffect:t.useLayoutEffect;function VY(e,t,n){if(!e)return;if(!0===n(e))return e;let i=t?e.return:e.child;for(;i;){const e=VY(i,t,n);if(e)return e;i=t?null:i.sibling}}function LY(e){try{return Object.defineProperties(e,{_currentRenderer:{get:()=>null,set(){}},_currentRenderer2:{get:()=>null,set(){}}})}catch(Hx){return e}}const HY=console.error;console.error=function(){const e=[...arguments].join("");if(!(null==e?void 0:e.startsWith("Warning:"))||!e.includes("useContext"))return HY.apply(this,arguments);console.error=HY};const QY=LY(t.createContext(null));class KY extends t.Component{render(){return t.createElement(QY.Provider,{value:this._reactInternals},this.props.children)}}function XY(){const e=t.useContext(QY);if(null===e)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const n=t.useId();return t.useMemo((()=>{for(const t of[e,null==e?void 0:e.alternate]){if(!t)continue;const e=VY(t,!1,(e=>{let t=e.memoizedState;for(;t;){if(t.memoizedState===n)return!0;t=t.next}}));if(e)return e}}),[e,n])}function YY(){const e=function(){const e=XY(),[n]=t.useState((()=>new Map));n.clear();let i=e;for(;i;){if(i.type&&"object"===typeof i.type){const e=void 0===i.type._context&&i.type.Provider===i.type?i.type:i.type._context;e&&e!==QY&&!n.has(e)&&n.set(e,t.useContext(LY(e)))}i=i.return}return n}();return t.useMemo((()=>Array.from(e.keys()).reduce(((n,i)=>r=>t.createElement(n,null,t.createElement(i.Provider,((e,t)=>DY(e,FY(t)))(TY({},r),{value:e.get(i)})))),(e=>t.createElement(KY,TY({},e))))),[e])}const zY={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function PY(e){const{handlePointer:t}=Np(e);return{priority:1,enabled:!0,compute(e,t,n){t.pointer.set(e.offsetX/t.size.width*2-1,-e.offsetY/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)},connected:void 0,handlers:Object.keys(zY).reduce(((e,n)=>({...e,[n]:t(n)})),{}),update:()=>{var t;const{events:n,internal:i}=e.getState();null!=(t=i.lastEvent)&&t.current&&n.handlers&&n.handlers.onPointerMove(i.lastEvent.current)},connect:t=>{var n;const{set:i,events:r}=e.getState();null==r.disconnect||r.disconnect(),i((e=>({events:{...e.events,connected:t}}))),Object.entries(null!=(n=r.handlers)?n:[]).forEach((e=>{let[n,i]=e;const[r,s]=zY[n];t.addEventListener(r,i,{passive:s})}))},disconnect:()=>{const{set:t,events:n}=e.getState();var i;n.connected&&(Object.entries(null!=(i=n.handlers)?i:[]).forEach((e=>{let[t,i]=e;if(n&&n.connected instanceof HTMLElement){const[e]=zY[t];n.connected.removeEventListener(e,i)}})),t((e=>({events:{...e.events,connected:void 0}}))))}}}const UY=t.forwardRef((function(n,i){let{children:r,fallback:s,resize:o,style:a,gl:l,events:c=PY,eventSource:g,eventPrefix:u,shadows:A,linear:d,flat:h,legacy:p,orthographic:C,frameloop:m,dpr:f,performance:y,raycaster:b,camera:B,scene:v,onPointerMissed:w,onCreated:G,...E}=n;t.useMemo((()=>np(e)),[]);const x=YY(),[S,R]=wY({scroll:!0,debounce:{scroll:50,resize:0},...o}),Z=t.useRef(null),D=t.useRef(null);t.useImperativeHandle(i,(()=>Z.current));const F=cp(w),[N,M]=t.useState(!1),[W,k]=t.useState(!1);if(N)throw N;if(W)throw W;const T=t.useRef(null);lp((()=>{const e=Z.current;R.width>0&&R.height>0&&e&&(T.current||(T.current=oC(e)),T.current.configure({gl:l,events:c,shadows:A,linear:d,flat:h,legacy:p,orthographic:C,frameloop:m,dpr:f,performance:y,raycaster:b,camera:B,scene:v,size:R,onPointerMissed:function(){return null==F.current?void 0:F.current(...arguments)},onCreated:e=>{var t;null==e.events.connect||e.events.connect(g?(t=g)&&t.hasOwnProperty("current")?g.current:g:D.current),u&&e.setEvents({compute:(e,t)=>{const n=e[u+"X"],i=e[u+"Y"];t.pointer.set(n/t.size.width*2-1,-i/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),null==G||G(e)}}),T.current.render((0,I.jsx)(x,{children:(0,I.jsx)(up,{set:k,children:(0,I.jsx)(t.Suspense,{fallback:(0,I.jsx)(gp,{set:M}),children:r})})})))})),t.useEffect((()=>{const e=Z.current;if(e)return()=>lC(e)}),[]);const V=g?"none":"auto";return(0,I.jsx)("div",{ref:D,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:V,...a},...E,children:(0,I.jsx)("div",{ref:S,style:{width:"100%",height:"100%"},children:(0,I.jsx)("canvas",{ref:Z,style:{display:"block"},children:s})})})})),_Y=t.forwardRef((function(e,t){return(0,I.jsx)(KY,{children:(0,I.jsx)(UY,{...e,ref:t})})}));function OY(e){let{style:t={position:"absolute",top:"0",width:"100%",height:"100vh"},children:n}=e;return(0,I.jsx)(_Y,{style:{...t,backgroundColor:"black"},camera:{far:9999999},children:n})}const JY=Ym({foveation:1,frameRate:"high"});function jY(e){let{style:t={position:"absolute",top:"0",width:"100%",height:"100vh"},children:n}=e;return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("button",{onClick:()=>JY.enterVR(),style:{top:0,height:"5rem",position:"absolute",bottom:"24px",left:"50%",transform:"translateX(-50%)",padding:"12px 24px",border:"1px solid white",borderRadius:"4px",background:"rgba(0, 0, 0, 0.1)",color:"white",font:"0.8125rem sans-serif",outline:"none",zIndex:99999,cursor:"pointer"},children:"Enter VR"}),(0,I.jsx)(_Y,{style:{...t,backgroundColor:"black"},children:(0,I.jsx)(pb,{store:JY,children:n})})]})}function qY(){const e=h((e=>e.xrmode));return(0,I.jsx)(I.Fragment,{children:e?(0,I.jsxs)(jY,{style:{position:"relative",top:"0",width:"100%",height:"100vh"},children:[(0,I.jsx)(_E,{}),(0,I.jsx)(bY,{})]}):(0,I.jsxs)(OY,{style:{position:"relative",top:"0",width:"100%",height:"100vh"},children:[(0,I.jsx)(TE,{}),(0,I.jsx)(bY,{})]})})}function $Y(e){let{password:n="",children:i}=e;const[r,s]=(0,t.useState)(!1),[o,a]=(0,t.useState)(""),l=e=>{const t=e.target.value;a(t),t===n&&s(!0)};return r?(0,I.jsx)(I.Fragment,{children:i}):""===n?(0,I.jsx)(I.Fragment,{children:(0,I.jsx)("div",{className:"background-initial",style:{display:"flex",alignItems:"center",flexDirection:"column",width:"100%",height:"100vh",color:"white",backgroundColor:"#500050",backgroundImage:'url("images/portada.jpg")',backgroundSize:"cover",backgroundPosition:"center"},onClick:()=>s(!0),children:(0,I.jsx)("h1",{style:{cursor:"hover"},children:"Click to Start"})})}):(0,I.jsx)(I.Fragment,{children:(0,I.jsxs)("div",{className:"background-initial",style:{display:"flex",alignItems:"center",flexDirection:"column",width:"100%",height:"100vh",color:"white",backgroundColor:"#500050",backgroundImage:'url("images/portada.jpg")',backgroundSize:"cover",backgroundPosition:"center"},children:[(0,I.jsx)("h1",{style:{cursor:"hover"},children:"Enter Password"}),(0,I.jsx)("input",{type:"text",value:o,onChange:l})]})})}const ez=window.showVideo||!1;function tz(e){let{}=e;return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)($Y,{password:"",children:(0,I.jsx)(nz,{})})})}function nz(){const e=h((e=>e.displayVideoplayer)),[n,i]=(0,t.useState)(ez),r=(0,t.useCallback)((()=>{i((e=>!n))}),[n]),[s,o]=(0,t.useState)(!0);(0,t.useEffect)((()=>{function e(e){"2"===e.key&&(o(!0),i(!0)),"1"===e.key&&(o(!1),i(!1)),"3"===e.key&&(window.orbitControls.autoRotate=!window.orbitControls.autoRotate)}return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[]);return(0,I.jsx)("div",{id:"app-espinaco",style:{position:"relative",cursor:"cell"},children:(0,I.jsxs)(K,{showButton:n,children:[(0,I.jsx)(qY,{}),e&&(0,I.jsx)(w,{showUI:n}),(0,I.jsx)(P,{showUI:n}),(0,I.jsx)(_,{showUI:n}),(0,I.jsx)(Y,{showUI:n}),(0,I.jsx)(QI,{showUI:n}),(0,I.jsx)(XI,{showUI:n}),(0,I.jsx)(F,{showButton:n}),(0,I.jsx)(D,{showButton:s}),(0,I.jsx)(R,{showButton:s}),(0,I.jsx)(x,{showButton:s}),(0,I.jsx)(S,{showButton:s}),(0,I.jsx)("button",{onClick:r,style:{display:s?"block":"none",width:"50px",height:"50px",borderRadius:"25px",position:"absolute",bottom:"100px",right:"10px",background:"linear-gradient(90deg, #636363 0%, #000000 100%)",opacity:n?.8:.3,cursor:"pointer",color:"white"},children:"Menu"}),(0,I.jsx)("button",{onClick:()=>{s?(o(!1),i(!1)):(o(!0),i(!0))},style:{display:"block",width:"50px",height:"50px",borderRadius:"25px",position:"absolute",top:0,right:0,background:"linear-gradient(90deg, #636363 0%, #000000 100%)",opacity:s?.3:0,cursor:s?"pointer":"none",color:"white"},children:"Hidden"})]})})}function iz(e){let{}=e;return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(I.Fragment,{children:(0,I.jsxs)("div",{className:"main-container",children:[(0,I.jsx)("h1",{children:" App 2: Estudio de CSS "}),(0,I.jsx)("h1",{children:" App 2: Estudio de CSS "}),(0,I.jsx)("h1",{children:" App 2: Estudio de CSS "})]})})})}function rz(){const e=h((e=>e.appId));return(0,I.jsx)(I.Fragment,{children:(()=>{switch(e){case 0:return(0,I.jsx)(p,{});case 1:return(0,I.jsx)(tz,{});case 2:return(0,I.jsx)(iz,{});default:return console.error("No se ha definido la App elegida, App: "+e),(0,I.jsxs)("h1",{children:[" No existe una App con el id que has pasado, id: ",e," "]})}})()})}function sz(){return(0,I.jsx)(rz,{})}document.querySelectorAll(".ultimate-react-three-espinaco, #ultimate-react-three-espinaco").forEach((e=>{const n=i.createRoot(e);console.log(e.dataset.symbol),n.render((0,I.jsx)(t.StrictMode,{children:(0,I.jsx)(sz,{url:e.dataset.symbol})}))}))})()})();
//# sourceMappingURL=main.699a9d22.js.map